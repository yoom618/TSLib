Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.757295846939087
Epoch: 1, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.487 Vali Acc: 0.728 Test Loss: 1.487 Test Acc: 0.728
Validation loss decreased (inf --> -0.727763).  Saving model ...
Epoch: 2 cost time: 2.959296226501465
Epoch: 2, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.756 Vali Acc: 0.744 Test Loss: 0.756 Test Acc: 0.744
Validation loss decreased (-0.727763 --> -0.744437).  Saving model ...
Epoch: 3 cost time: 2.717802047729492
Epoch: 3, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 2.780163288116455
Epoch: 4, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.420 Vali Acc: 0.783 Test Loss: 0.420 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 3.0401082038879395
Epoch: 5, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 2.703427791595459
Epoch: 6, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.827774 --> -0.877775).  Saving model ...
Epoch: 7 cost time: 2.566439390182495
Epoch: 7, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3145668506622314
Epoch: 8, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.309 Vali Acc: 0.828 Test Loss: 0.309 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.613370656967163
Epoch: 9, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.269 Vali Acc: 0.850 Test Loss: 0.269 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.054109811782837
Epoch: 10, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8217644691467285
Epoch: 11, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0509722232818604
Epoch: 12, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.705244779586792
Epoch: 13, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 2.7171432971954346
Epoch: 14, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.361 Vali Acc: 0.883 Test Loss: 0.361 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.579490900039673
Epoch: 15, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4652695655822754
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.579622507095337
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 2.367316722869873
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 2.6258811950683594
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.343 Vali Acc: 0.878 Test Loss: 0.343 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.627370595932007
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 2.2121193408966064
Epoch: 21, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 22 cost time: 2.6643972396850586
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 2.989684820175171
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6128921508789062
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.5366311073303223
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.884459972381592
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.6866800785064697
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3291640281677246
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 2.3737354278564453
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 2.9613265991210938
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3292837142944336
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.0655877590179443
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.7763261795043945
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 34 cost time: 2.8586833477020264
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.6640100479125977
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.7920172214508057
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 37 cost time: 3.005326509475708
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.9919509887695312
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 39 cost time: 2.548064947128296
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.595777750015259
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.7417287826538086
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.52858567237854
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.84421443939209
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.011160135269165
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.6358234882354736
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.608443260192871
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.106616973876953
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.9326117038726807
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5594086
model size : 21.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.495139837265015
Epoch: 1, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.612 Vali Acc: 0.644 Test Loss: 1.612 Test Acc: 0.644
Validation loss decreased (inf --> -0.644428).  Saving model ...
Epoch: 2 cost time: 2.3371317386627197
Epoch: 2, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.063 Vali Acc: 0.733 Test Loss: 1.063 Test Acc: 0.733
Validation loss decreased (-0.644428 --> -0.733323).  Saving model ...
Epoch: 3 cost time: 2.5637624263763428
Epoch: 3, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.636 Vali Acc: 0.761 Test Loss: 0.636 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761105).  Saving model ...
Epoch: 4 cost time: 2.433166027069092
Epoch: 4, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.451 Vali Acc: 0.800 Test Loss: 0.451 Test Acc: 0.800
Validation loss decreased (-0.761105 --> -0.799995).  Saving model ...
Epoch: 5 cost time: 2.4749906063079834
Epoch: 5, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.389 Vali Acc: 0.800 Test Loss: 0.389 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.06962513923645
Epoch: 6, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 2.7508432865142822
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.343 Vali Acc: 0.806 Test Loss: 0.343 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 2.286242961883545
Epoch: 8, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 2.3307409286499023
Epoch: 9, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
Validation loss decreased (-0.838886 --> -0.872220).  Saving model ...
Epoch: 10 cost time: 2.225586414337158
Epoch: 10, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3919804096221924
Epoch: 11, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.281 Vali Acc: 0.844 Test Loss: 0.281 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8247618675231934
Epoch: 12, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.509268045425415
Epoch: 13, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.235 Vali Acc: 0.872 Test Loss: 0.235 Test Acc: 0.872
Validation loss decreased (-0.872220 --> -0.872220).  Saving model ...
Epoch: 14 cost time: 3.115041732788086
Epoch: 14, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
Validation loss decreased (-0.872220 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 3.0884125232696533
Epoch: 15, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7094311714172363
Epoch: 16, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.255 Vali Acc: 0.861 Test Loss: 0.255 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4535205364227295
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4925360679626465
Epoch: 18, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6644809246063232
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.294106960296631
Epoch: 20, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 3.6769864559173584
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6262013912200928
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.732806444168091
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 3.4051294326782227
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.015381813049316
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7303414344787598
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 3.4046216011047363
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8651013374328613
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.5021233558654785
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 3.061591625213623
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.0832014083862305
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.0205085277557373
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.691152572631836
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.3881921768188477
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.426842451095581
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.4838614463806152
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.8503270149230957
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.654998779296875
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.8478429317474365
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.521 Vali Acc: 0.889 Test Loss: 0.521 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 5483526
model size : 21.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.141131639480591
Epoch: 1, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.586 Vali Acc: 0.606 Test Loss: 1.586 Test Acc: 0.606
Validation loss decreased (inf --> -0.605540).  Saving model ...
Epoch: 2 cost time: 3.067599058151245
Epoch: 2, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.006 Vali Acc: 0.733 Test Loss: 1.006 Test Acc: 0.733
Validation loss decreased (-0.605540 --> -0.733323).  Saving model ...
Epoch: 3 cost time: 3.214731216430664
Epoch: 3, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.609 Vali Acc: 0.739 Test Loss: 0.609 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 2.9891011714935303
Epoch: 4, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.460 Vali Acc: 0.794 Test Loss: 0.460 Test Acc: 0.794
Validation loss decreased (-0.738883 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 2.9111673831939697
Epoch: 5, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.370 Vali Acc: 0.828 Test Loss: 0.370 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 3.1466622352600098
Epoch: 6, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.378 Vali Acc: 0.794 Test Loss: 0.378 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.09045147895813
Epoch: 7, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 3.0714261531829834
Epoch: 8, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.853158950805664
Epoch: 9, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.315 Vali Acc: 0.833 Test Loss: 0.315 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.877103090286255
Epoch: 10, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.232645273208618
Epoch: 11, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 3.021484136581421
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.295 Vali Acc: 0.828 Test Loss: 0.295 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4672367572784424
Epoch: 13, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.328976631164551
Epoch: 14, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 3.2154431343078613
Epoch: 15, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.246 Vali Acc: 0.872 Test Loss: 0.246 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.120318651199341
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.248 Vali Acc: 0.872 Test Loss: 0.248 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.085012912750244
Epoch: 17, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.553896188735962
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 3.3250834941864014
Epoch: 19, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 2.998807907104492
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.299 Vali Acc: 0.911 Test Loss: 0.299 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8239376544952393
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.948239803314209
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0585262775421143
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.118551254272461
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.04791522026062
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.739990234375
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5541276931762695
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.0321779251098633
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.381380319595337
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 5483558
model size : 21.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.677398204803467
Epoch: 1, Steps: 12 | Train Loss: 1.703 Vali Loss: 1.629 Vali Acc: 0.644 Test Loss: 1.629 Test Acc: 0.644
Validation loss decreased (inf --> -0.644428).  Saving model ...
Epoch: 2 cost time: 2.9679348468780518
Epoch: 2, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.171 Vali Acc: 0.756 Test Loss: 1.171 Test Acc: 0.756
Validation loss decreased (-0.644428 --> -0.755544).  Saving model ...
Epoch: 3 cost time: 2.951615333557129
Epoch: 3, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.740 Vali Acc: 0.733 Test Loss: 0.740 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9937326908111572
Epoch: 4, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.540 Vali Acc: 0.772 Test Loss: 0.540 Test Acc: 0.772
Validation loss decreased (-0.755544 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.8656063079833984
Epoch: 5, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.450 Vali Acc: 0.800 Test Loss: 0.450 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 3.044684648513794
Epoch: 6, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.420 Vali Acc: 0.794 Test Loss: 0.420 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1062192916870117
Epoch: 7, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
Validation loss decreased (-0.799995 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 3.3408095836639404
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.325 Vali Acc: 0.817 Test Loss: 0.325 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9986770153045654
Epoch: 9, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 3.215956449508667
Epoch: 10, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4901278018951416
Epoch: 11, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.297 Vali Acc: 0.833 Test Loss: 0.297 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5030319690704346
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.289 Vali Acc: 0.833 Test Loss: 0.289 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.839496374130249
Epoch: 13, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9384865760803223
Epoch: 14, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.370 Vali Acc: 0.883 Test Loss: 0.370 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 2.562437057495117
Epoch: 15, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 3.2098217010498047
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.211 Vali Acc: 0.883 Test Loss: 0.211 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 3.016721725463867
Epoch: 17, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 2.8162293434143066
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 3.1156535148620605
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.244 Vali Acc: 0.872 Test Loss: 0.244 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.726393938064575
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.224 Vali Acc: 0.878 Test Loss: 0.224 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1730918884277344
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2813968658447266
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.3674776554107666
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.3858561515808105
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1449389457702637
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1220033168792725
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.931612968444824
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 2.8898062705993652
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 2.745218515396118
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 30 cost time: 3.2390213012695312
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.755760431289673
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.50299334526062
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.716 Vali Acc: 0.889 Test Loss: 0.716 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3825082778930664
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.485846996307373
Epoch: 34, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3698413372039795
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.1566426753997803
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.8283851146698
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.3650460243225098
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.3826589584350586
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5446758
model size : 20.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.007483720779419
Epoch: 1, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.670 Vali Acc: 0.550 Test Loss: 1.670 Test Acc: 0.550
Validation loss decreased (inf --> -0.549983).  Saving model ...
Epoch: 2 cost time: 3.2186925411224365
Epoch: 2, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.230 Vali Acc: 0.750 Test Loss: 1.230 Test Acc: 0.750
Validation loss decreased (-0.549983 --> -0.749988).  Saving model ...
Epoch: 3 cost time: 2.976583242416382
Epoch: 3, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5784432888031006
Epoch: 4, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.593 Vali Acc: 0.772 Test Loss: 0.593 Test Acc: 0.772
Validation loss decreased (-0.749988 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 2.4490771293640137
Epoch: 5, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.481 Vali Acc: 0.783 Test Loss: 0.481 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 2.7957382202148438
Epoch: 6, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.850472927093506
Epoch: 7, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 3.1893718242645264
Epoch: 8, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 2.7901296615600586
Epoch: 9, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 3.004394769668579
Epoch: 10, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 3.1119155883789062
Epoch: 11, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 3.514449119567871
Epoch: 12, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.282 Vali Acc: 0.850 Test Loss: 0.282 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0766537189483643
Epoch: 13, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.274 Vali Acc: 0.856 Test Loss: 0.274 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.214120864868164
Epoch: 14, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.247 Vali Acc: 0.878 Test Loss: 0.247 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 3.044337272644043
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.231 Vali Acc: 0.867 Test Loss: 0.231 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0913848876953125
Epoch: 16, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 3.1707801818847656
Epoch: 17, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.242 Vali Acc: 0.883 Test Loss: 0.242 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2063024044036865
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.028472900390625
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.222 Vali Acc: 0.894 Test Loss: 0.222 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3219761848449707
Epoch: 20, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.186 Vali Acc: 0.894 Test Loss: 0.186 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2911224365234375
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.900 Test Loss: 0.208 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 22 cost time: 2.7630600929260254
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 3.0387942790985107
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.242 Vali Acc: 0.883 Test Loss: 0.242 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.105088710784912
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.1065285205841064
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.7646899223327637
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.775430679321289
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 2.57639479637146
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.924355983734131
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.7126424312591553
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6987855434417725
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 2.638155221939087
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 33 cost time: 2.5036137104034424
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.7959811687469482
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.7612173557281494
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.962252140045166
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.6273560523986816
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.14865779876709
Epoch: 38, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.9895455837249756
Epoch: 39, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.185 Vali Acc: 0.939 Test Loss: 0.185 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938887).  Saving model ...
Epoch: 40 cost time: 3.3591103553771973
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.147838592529297
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.1557538509368896
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 2.5931551456451416
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.0550618171691895
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.453206777572632
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.0286145210266113
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.7541611194610596
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.1499452590942383
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.9968760013580322
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.032863140106201
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5409958
model size : 20.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.426680088043213
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.730 Vali Acc: 0.489 Test Loss: 1.730 Test Acc: 0.489
Validation loss decreased (inf --> -0.488872).  Saving model ...
Epoch: 2 cost time: 3.2300217151641846
Epoch: 2, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.388 Vali Acc: 0.661 Test Loss: 1.388 Test Acc: 0.661
Validation loss decreased (-0.488872 --> -0.661097).  Saving model ...
Epoch: 3 cost time: 3.0643885135650635
Epoch: 3, Steps: 12 | Train Loss: 1.019 Vali Loss: 0.981 Vali Acc: 0.706 Test Loss: 0.981 Test Acc: 0.706
Validation loss decreased (-0.661097 --> -0.705546).  Saving model ...
Epoch: 4 cost time: 2.767045497894287
Epoch: 4, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.715 Vali Acc: 0.722 Test Loss: 0.715 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 2.8159265518188477
Epoch: 5, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.563 Vali Acc: 0.756 Test Loss: 0.563 Test Acc: 0.756
Validation loss decreased (-0.722215 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 2.8135056495666504
Epoch: 6, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 3.002971887588501
Epoch: 7, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.417 Vali Acc: 0.839 Test Loss: 0.417 Test Acc: 0.839
Validation loss decreased (-0.783329 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.8755407333374023
Epoch: 8, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.380 Vali Acc: 0.811 Test Loss: 0.380 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0432724952697754
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.928241014480591
Epoch: 10, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 11 cost time: 2.727221965789795
Epoch: 11, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 2.672600746154785
Epoch: 12, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.282 Vali Acc: 0.844 Test Loss: 0.282 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5162665843963623
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 2.678952932357788
Epoch: 14, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.257 Vali Acc: 0.878 Test Loss: 0.257 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.420400619506836
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888887).  Saving model ...
Epoch: 16 cost time: 2.604979991912842
Epoch: 16, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7730154991149902
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.054650068283081
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.194 Vali Acc: 0.911 Test Loss: 0.194 Test Acc: 0.911
Validation loss decreased (-0.888887 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 3.586637020111084
Epoch: 19, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.211 Vali Acc: 0.900 Test Loss: 0.211 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.848180055618286
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.185 Vali Acc: 0.906 Test Loss: 0.185 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8498470783233643
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.911 Test Loss: 0.150 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911110).  Saving model ...
Epoch: 22 cost time: 2.8684892654418945
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.900 Test Loss: 0.197 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.795663356781006
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.900 Test Loss: 0.183 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6284894943237305
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.807659387588501
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.928 Test Loss: 0.153 Test Acc: 0.928
Validation loss decreased (-0.911110 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 2.944004535675049
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 3.2529118061065674
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.6884748935699463
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8328635692596436
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.90987229347229
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.933 Test Loss: 0.146 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 31 cost time: 2.6687095165252686
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.994166374206543
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.9782166481018066
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.939 Test Loss: 0.138 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938888).  Saving model ...
Epoch: 34 cost time: 2.8204829692840576
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.185758352279663
Epoch: 35, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.5984272956848145
Epoch: 36, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.938888 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 2.8131957054138184
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.6574010848999023
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.928 Test Loss: 0.164 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.1390302181243896
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.928 Test Loss: 0.157 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.891753911972046
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.0365421772003174
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.0445809364318848
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.558558225631714
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.906 Test Loss: 0.172 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.988539457321167
Epoch: 44, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.917 Test Loss: 0.167 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.8394737243652344
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.273 Vali Acc: 0.928 Test Loss: 0.273 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.783237934112549
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5391622
model size : 20.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.351592063903809
Epoch: 1, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.709 Vali Acc: 0.472 Test Loss: 1.709 Test Acc: 0.472
Validation loss decreased (inf --> -0.472205).  Saving model ...
Epoch: 2 cost time: 2.5845346450805664
Epoch: 2, Steps: 12 | Train Loss: 1.419 Vali Loss: 1.402 Vali Acc: 0.622 Test Loss: 1.402 Test Acc: 0.622
Validation loss decreased (-0.472205 --> -0.622208).  Saving model ...
Epoch: 3 cost time: 2.8677937984466553
Epoch: 3, Steps: 12 | Train Loss: 1.054 Vali Loss: 0.982 Vali Acc: 0.667 Test Loss: 0.982 Test Acc: 0.667
Validation loss decreased (-0.622208 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 2.8926784992218018
Epoch: 4, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.728 Vali Acc: 0.706 Test Loss: 0.728 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 3.0166852474212646
Epoch: 5, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.589 Vali Acc: 0.744 Test Loss: 0.589 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 2.9724502563476562
Epoch: 6, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.503 Vali Acc: 0.772 Test Loss: 0.503 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 3.037046432495117
Epoch: 7, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.436 Vali Acc: 0.794 Test Loss: 0.436 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 3.122185468673706
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 2.9229977130889893
Epoch: 9, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.372 Vali Acc: 0.811 Test Loss: 0.372 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 2.9073455333709717
Epoch: 10, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 3.113309860229492
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 12 cost time: 2.521746873855591
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.72619891166687
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
Validation loss decreased (-0.838886 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 2.740050792694092
Epoch: 14, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.599850654602051
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.450953483581543
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 2.786651849746704
Epoch: 17, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.216 Vali Acc: 0.889 Test Loss: 0.216 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7663326263427734
Epoch: 18, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.229 Vali Acc: 0.883 Test Loss: 0.229 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8232457637786865
Epoch: 19, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 3.031521797180176
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.883 Test Loss: 0.229 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1567399501800537
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 2.923898220062256
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2524914741516113
Epoch: 23, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.517 Vali Acc: 0.883 Test Loss: 0.517 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.487464427947998
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 3.4016237258911133
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.771442413330078
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.203 Vali Acc: 0.900 Test Loss: 0.203 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9546518325805664
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.933 Test Loss: 0.166 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 28 cost time: 3.1893739700317383
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9063305854797363
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9619626998901367
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.922 Test Loss: 0.174 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.0200517177581787
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.233164072036743
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.6461431980133057
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.8282458782196045
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.0472142696380615
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.911 Test Loss: 0.182 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.6723313331604004
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.0629141330718994
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.653 Vali Acc: 0.878 Test Loss: 0.653 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 5391686
model size : 20.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.897790908813477
Epoch: 1, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.463 Vali Acc: 0.622 Test Loss: 1.463 Test Acc: 0.622
Validation loss decreased (inf --> -0.622208).  Saving model ...
Epoch: 2 cost time: 3.358105182647705
Epoch: 2, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.752 Vali Acc: 0.733 Test Loss: 0.752 Test Acc: 0.733
Validation loss decreased (-0.622208 --> -0.733326).  Saving model ...
Epoch: 3 cost time: 3.78253436088562
Epoch: 3, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
Validation loss decreased (-0.733326 --> -0.783328).  Saving model ...
Epoch: 4 cost time: 3.836632251739502
Epoch: 4, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.410 Vali Acc: 0.794 Test Loss: 0.410 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 3.1471474170684814
Epoch: 5, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 3.3897480964660645
Epoch: 6, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 3.5422420501708984
Epoch: 7, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.376 Vali Acc: 0.833 Test Loss: 0.376 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.468310832977295
Epoch: 8, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 3.1290316581726074
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.418 Vali Acc: 0.839 Test Loss: 0.418 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.88319730758667
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 3.721076726913452
Epoch: 11, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.297 Vali Acc: 0.839 Test Loss: 0.297 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4347193241119385
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
Validation loss decreased (-0.849997 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 3.343940019607544
Epoch: 13, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9702413082122803
Epoch: 14, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8592708110809326
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 3.288684606552124
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2063405513763428
Epoch: 17, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.998962640762329
Epoch: 18, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 3.2487008571624756
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 2.689643383026123
Epoch: 20, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.911 Test Loss: 0.205 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8577749729156494
Epoch: 21, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7569499015808105
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.433908939361572
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.5172529220581055
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.161045074462891
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.708622932434082
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.0142035484313965
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.8979413509368896
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7917473316192627
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 5572582
model size : 21.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.152953624725342
Epoch: 1, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.620 Vali Acc: 0.606 Test Loss: 1.620 Test Acc: 0.606
Validation loss decreased (inf --> -0.605539).  Saving model ...
Epoch: 2 cost time: 2.592465877532959
Epoch: 2, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
Validation loss decreased (-0.605539 --> -0.699989).  Saving model ...
Epoch: 3 cost time: 3.166635513305664
Epoch: 3, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 2.9968767166137695
Epoch: 4, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 2.429976463317871
Epoch: 5, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.317206621170044
Epoch: 6, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.2769083976745605
Epoch: 7, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 2.610321521759033
Epoch: 8, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7214081287384033
Epoch: 9, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.659121036529541
Epoch: 10, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.313 Vali Acc: 0.839 Test Loss: 0.313 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6842451095581055
Epoch: 11, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.097154140472412
Epoch: 12, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.276 Vali Acc: 0.883 Test Loss: 0.276 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.207350015640259
Epoch: 13, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 2.1351664066314697
Epoch: 14, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.883 Test Loss: 0.236 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9189682006835938
Epoch: 15, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 2.5037147998809814
Epoch: 16, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 17 cost time: 2.583536386489868
Epoch: 17, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.911 Test Loss: 0.205 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 2.7845184803009033
Epoch: 18, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.630889892578125
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.587502956390381
Epoch: 20, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.900 Test Loss: 0.195 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.560962438583374
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6963326930999756
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0585403442382812
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.50704026222229
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.911 Test Loss: 0.174 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7455341815948486
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 2.4993979930877686
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6506659984588623
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9855353832244873
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.7379119396209717
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0259017944335938
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.917 Test Loss: 0.173 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.176123857498169
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.922 Test Loss: 0.172 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922221).  Saving model ...
Epoch: 32 cost time: 2.350119113922119
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.928 Test Loss: 0.164 Test Acc: 0.928
Validation loss decreased (-0.922221 --> -0.927776).  Saving model ...
Epoch: 33 cost time: 2.3585331439971924
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.9295096397399902
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.3983547687530518
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.928 Test Loss: 0.166 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.3672564029693604
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 37 cost time: 2.2676587104797363
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.8487703800201416
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.829221725463867
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.911 Test Loss: 0.189 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.382082462310791
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.922 Test Loss: 0.179 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.5257530212402344
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.636099338531494
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.6496455669403076
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.05790638923645
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.928 Test Loss: 0.169 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.2721657752990723
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 2.92309308052063
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.814903497695923
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.951388359069824
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.0147738456726074
Epoch: 49, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.4255778789520264
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5462022
model size : 20.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.659957408905029
Epoch: 1, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.604 Vali Acc: 0.583 Test Loss: 1.604 Test Acc: 0.583
Validation loss decreased (inf --> -0.583317).  Saving model ...
Epoch: 2 cost time: 3.6927669048309326
Epoch: 2, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.034 Vali Acc: 0.711 Test Loss: 1.034 Test Acc: 0.711
Validation loss decreased (-0.583317 --> -0.711101).  Saving model ...
Epoch: 3 cost time: 3.067875862121582
Epoch: 3, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.624 Vali Acc: 0.767 Test Loss: 0.624 Test Acc: 0.767
Validation loss decreased (-0.711101 --> -0.766660).  Saving model ...
Epoch: 4 cost time: 3.379483938217163
Epoch: 4, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.483 Vali Acc: 0.794 Test Loss: 0.483 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 3.579385995864868
Epoch: 5, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 3.2824866771698
Epoch: 6, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 3.417113780975342
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.67824125289917
Epoch: 8, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 3.1019208431243896
Epoch: 9, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.300 Vali Acc: 0.833 Test Loss: 0.300 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.269806385040283
Epoch: 10, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 3.009188175201416
Epoch: 11, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.250 Vali Acc: 0.878 Test Loss: 0.250 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 3.206672191619873
Epoch: 12, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.274 Vali Acc: 0.856 Test Loss: 0.274 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2117741107940674
Epoch: 13, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 2.810039520263672
Epoch: 14, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.788065195083618
Epoch: 15, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 3.2177982330322266
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.221 Vali Acc: 0.883 Test Loss: 0.221 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4256348609924316
Epoch: 17, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
Validation loss decreased (-0.888886 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 3.201199769973755
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3747341632843018
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8106319904327393
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1067473888397217
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.883 Test Loss: 0.226 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.9511260986328125
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.119969367980957
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.117342710494995
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.783449172973633
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.083024024963379
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.361618757247925
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 5462054
model size : 20.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.033750057220459
Epoch: 1, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.645 Vali Acc: 0.600 Test Loss: 1.645 Test Acc: 0.600
Validation loss decreased (inf --> -0.599984).  Saving model ...
Epoch: 2 cost time: 2.6877830028533936
Epoch: 2, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.171 Vali Acc: 0.672 Test Loss: 1.171 Test Acc: 0.672
Validation loss decreased (-0.599984 --> -0.672211).  Saving model ...
Epoch: 3 cost time: 3.2816030979156494
Epoch: 3, Steps: 12 | Train Loss: 0.791 Vali Loss: 0.726 Vali Acc: 0.706 Test Loss: 0.726 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705548).  Saving model ...
Epoch: 4 cost time: 2.973414897918701
Epoch: 4, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.545 Vali Acc: 0.756 Test Loss: 0.545 Test Acc: 0.756
Validation loss decreased (-0.705548 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 3.1067898273468018
Epoch: 5, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.8591575622558594
Epoch: 6, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.391 Vali Acc: 0.806 Test Loss: 0.391 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 3.332040309906006
Epoch: 7, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 3.0294957160949707
Epoch: 8, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 3.438293933868408
Epoch: 9, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 3.0047154426574707
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 3.0901970863342285
Epoch: 11, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.273 Vali Acc: 0.856 Test Loss: 0.273 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 3.4247682094573975
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.920938014984131
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.413848876953125
Epoch: 14, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 3.19130539894104
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.245 Vali Acc: 0.872 Test Loss: 0.245 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.109930992126465
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 3.152512550354004
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 2.962679624557495
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.970264434814453
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4176645278930664
Epoch: 20, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9087941646575928
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 2.862222194671631
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.466 Vali Acc: 0.883 Test Loss: 0.466 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1329376697540283
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.328 Vali Acc: 0.883 Test Loss: 0.328 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9529011249542236
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.036101818084717
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2214927673339844
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3555524349212646
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.4561963081359863
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 3.2064599990844727
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.844667911529541
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.3557848930358887
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.7534520626068115
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.314728021621704
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.8338916301727295
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.545396566390991
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.223966121673584
Epoch: 36, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.289210081100464
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 3.393110990524292
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.2065014839172363
Epoch: 39, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.158 Vali Acc: 0.939 Test Loss: 0.158 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.0462207794189453
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.080223560333252
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.1564137935638428
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.2323014736175537
Epoch: 43, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.5194339752197266
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.330057382583618
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.2477023601531982
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.894 Test Loss: 0.396 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.602322816848755
Epoch: 47, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5425254
model size : 20.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.380892038345337
Epoch: 1, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.645 Vali Acc: 0.544 Test Loss: 1.645 Test Acc: 0.544
Validation loss decreased (inf --> -0.544428).  Saving model ...
Epoch: 2 cost time: 3.035538911819458
Epoch: 2, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.231 Vali Acc: 0.689 Test Loss: 1.231 Test Acc: 0.689
Validation loss decreased (-0.544428 --> -0.688877).  Saving model ...
Epoch: 3 cost time: 2.866976737976074
Epoch: 3, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.824 Vali Acc: 0.683 Test Loss: 0.824 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.216625928878784
Epoch: 4, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.604 Vali Acc: 0.744 Test Loss: 0.604 Test Acc: 0.744
Validation loss decreased (-0.688877 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 3.400557279586792
Epoch: 5, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.744438 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 3.381165027618408
Epoch: 6, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.439 Vali Acc: 0.789 Test Loss: 0.439 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 3.279270887374878
Epoch: 7, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 3.203432321548462
Epoch: 8, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.352 Vali Acc: 0.822 Test Loss: 0.352 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 3.0436336994171143
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 3.5178606510162354
Epoch: 10, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.6732211112976074
Epoch: 11, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 3.2910892963409424
Epoch: 12, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 3.4177024364471436
Epoch: 13, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8147153854370117
Epoch: 14, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 3.2268612384796143
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.247 Vali Acc: 0.878 Test Loss: 0.247 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 3.0245251655578613
Epoch: 16, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.230 Vali Acc: 0.878 Test Loss: 0.230 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 3.839759111404419
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 3.572528839111328
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 2.8798491954803467
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 3.1958210468292236
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9385104179382324
Epoch: 21, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.170 Vali Acc: 0.911 Test Loss: 0.170 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4296858310699463
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5524497032165527
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 3.136594772338867
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.218419313430786
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 3.480853319168091
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.6933634281158447
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.277541160583496
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 2.8338797092437744
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0758774280548096
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.0422871112823486
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3124513626098633
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.081779718399048
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.134018659591675
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.806079149246216
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.1920816898345947
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.402615547180176
Epoch: 37, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.4345569610595703
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5388454
model size : 20.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.685407638549805
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.732 Vali Acc: 0.372 Test Loss: 1.732 Test Acc: 0.372
Validation loss decreased (inf --> -0.372205).  Saving model ...
Epoch: 2 cost time: 3.053603410720825
Epoch: 2, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.411 Vali Acc: 0.639 Test Loss: 1.411 Test Acc: 0.639
Validation loss decreased (-0.372205 --> -0.638875).  Saving model ...
Epoch: 3 cost time: 3.1391103267669678
Epoch: 3, Steps: 12 | Train Loss: 1.075 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
Validation loss decreased (-0.638875 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 2.6815736293792725
Epoch: 4, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.717 Vali Acc: 0.722 Test Loss: 0.717 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 3.050873279571533
Epoch: 5, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.574 Vali Acc: 0.761 Test Loss: 0.574 Test Acc: 0.761
Validation loss decreased (-0.722215 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 2.958057165145874
Epoch: 6, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.504 Vali Acc: 0.767 Test Loss: 0.504 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 3.157299518585205
Epoch: 7, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.429 Vali Acc: 0.789 Test Loss: 0.429 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 8 cost time: 2.79850172996521
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.392 Vali Acc: 0.828 Test Loss: 0.392 Test Acc: 0.828
Validation loss decreased (-0.788885 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.4897568225860596
Epoch: 9, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8937511444091797
Epoch: 10, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.702047348022461
Epoch: 11, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.6731317043304443
Epoch: 12, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2719244956970215
Epoch: 13, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 2.0273959636688232
Epoch: 14, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 2.7391507625579834
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6055736541748047
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.248 Vali Acc: 0.878 Test Loss: 0.248 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 3.0039992332458496
Epoch: 17, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.251 Vali Acc: 0.861 Test Loss: 0.251 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9712531566619873
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.208 Vali Acc: 0.883 Test Loss: 0.208 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 19 cost time: 3.4445443153381348
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3371026515960693
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.179 Vali Acc: 0.900 Test Loss: 0.179 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 21 cost time: 3.746358871459961
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.170 Vali Acc: 0.917 Test Loss: 0.170 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 3.627894639968872
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.154 Vali Acc: 0.939 Test Loss: 0.154 Test Acc: 0.939
Validation loss decreased (-0.916665 --> -0.938887).  Saving model ...
Epoch: 23 cost time: 3.051632881164551
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.166 Vali Acc: 0.928 Test Loss: 0.166 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.654860496520996
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.0649936199188232
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.149 Vali Acc: 0.944 Test Loss: 0.149 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 2.8095552921295166
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.67559552192688
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.5367419719696045
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.933 Test Loss: 0.159 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.505706787109375
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.944 Test Loss: 0.151 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1852834224700928
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.7576098442077637
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.226268768310547
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.180839776992798
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.1322851181030273
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.524144172668457
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5370118
model size : 20.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.023917198181152
Epoch: 1, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.706 Vali Acc: 0.494 Test Loss: 1.706 Test Acc: 0.494
Validation loss decreased (inf --> -0.494427).  Saving model ...
Epoch: 2 cost time: 2.9798526763916016
Epoch: 2, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.411 Vali Acc: 0.633 Test Loss: 1.411 Test Acc: 0.633
Validation loss decreased (-0.494427 --> -0.633319).  Saving model ...
Epoch: 3 cost time: 3.249447822570801
Epoch: 3, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.036 Vali Acc: 0.672 Test Loss: 1.036 Test Acc: 0.672
Validation loss decreased (-0.633319 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 3.1353201866149902
Epoch: 4, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.774 Vali Acc: 0.694 Test Loss: 0.774 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 3.1430320739746094
Epoch: 5, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.611 Vali Acc: 0.711 Test Loss: 0.611 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711105).  Saving model ...
Epoch: 6 cost time: 3.323526620864868
Epoch: 6, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.711105 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 3.224602222442627
Epoch: 7, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.464 Vali Acc: 0.778 Test Loss: 0.464 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0103771686553955
Epoch: 8, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.409 Vali Acc: 0.822 Test Loss: 0.409 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 2.8894593715667725
Epoch: 9, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.373 Vali Acc: 0.806 Test Loss: 0.373 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.897505044937134
Epoch: 10, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 2.956296920776367
Epoch: 11, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 3.203843832015991
Epoch: 12, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 2.7563092708587646
Epoch: 13, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 3.2521631717681885
Epoch: 14, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.586247205734253
Epoch: 15, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.258 Vali Acc: 0.856 Test Loss: 0.258 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.975397825241089
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 3.1990039348602295
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.240 Vali Acc: 0.883 Test Loss: 0.240 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.29417085647583
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.215 Vali Acc: 0.878 Test Loss: 0.215 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.848961591720581
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 2.955538749694824
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.225 Vali Acc: 0.883 Test Loss: 0.225 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9009640216827393
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.2898054122924805
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 2.7168617248535156
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.180 Vali Acc: 0.911 Test Loss: 0.180 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.7699673175811768
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.1558656692504883
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.160 Vali Acc: 0.933 Test Loss: 0.160 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 26 cost time: 2.931190013885498
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3448538780212402
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.7020742893218994
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.9183177947998047
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.7952301502227783
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.3438687324523926
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3823375701904297
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.6508612632751465
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.537747383117676
Epoch: 34, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.784019708633423
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 5370182
model size : 20.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 10.444111108779907
Epoch: 1, Steps: 12 | Train Loss: 1.325 Vali Loss: 0.800 Vali Acc: 0.661 Test Loss: 0.800 Test Acc: 0.661
Validation loss decreased (inf --> -0.661103).  Saving model ...
Epoch: 2 cost time: 6.479557991027832
Epoch: 2, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.567 Vali Acc: 0.739 Test Loss: 0.567 Test Acc: 0.739
Validation loss decreased (-0.661103 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 7.197949409484863
Epoch: 3, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.430 Vali Acc: 0.778 Test Loss: 0.430 Test Acc: 0.778
Validation loss decreased (-0.738883 --> -0.777773).  Saving model ...
Epoch: 4 cost time: 6.663908958435059
Epoch: 4, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
Validation loss decreased (-0.777773 --> -0.838885).  Saving model ...
Epoch: 5 cost time: 7.136608839035034
Epoch: 5, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.500 Vali Acc: 0.806 Test Loss: 0.500 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.553046464920044
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.531 Vali Acc: 0.828 Test Loss: 0.531 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.914748668670654
Epoch: 7, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 7.664823770523071
Epoch: 8, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.237576484680176
Epoch: 9, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.801 Vali Acc: 0.789 Test Loss: 0.801 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.5002055168151855
Epoch: 10, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.208258867263794
Epoch: 11, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.525393962860107
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.474 Vali Acc: 0.872 Test Loss: 0.474 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872217).  Saving model ...
Epoch: 13 cost time: 6.447097063064575
Epoch: 13, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.872217 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 6.795628070831299
Epoch: 14, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.451 Vali Acc: 0.878 Test Loss: 0.451 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.534285306930542
Epoch: 15, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.354 Vali Acc: 0.894 Test Loss: 0.354 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.5854034423828125
Epoch: 16, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 6.019197225570679
Epoch: 17, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.374 Vali Acc: 0.906 Test Loss: 0.374 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.303658485412598
Epoch: 18, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.015390157699585
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.488 Vali Acc: 0.894 Test Loss: 0.488 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.290035009384155
Epoch: 20, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.210049390792847
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.883 Test Loss: 0.548 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.606206893920898
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.769 Vali Acc: 0.856 Test Loss: 0.769 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.527249336242676
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 5.748603105545044
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.917 Test Loss: 0.611 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.433939218521118
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.917 Test Loss: 0.515 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.60895037651062
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.911 Test Loss: 0.477 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.003784656524658
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.917 Test Loss: 0.481 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.278825521469116
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.571763277053833
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.922 Test Loss: 0.477 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.971667051315308
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.928 Test Loss: 0.462 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927773).  Saving model ...
Epoch: 31 cost time: 6.57725715637207
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.928 Test Loss: 0.451 Test Acc: 0.928
Validation loss decreased (-0.927773 --> -0.927773).  Saving model ...
Epoch: 32 cost time: 6.640318393707275
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.7573630809783936
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.922 Test Loss: 0.452 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.485951900482178
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.928 Test Loss: 0.433 Test Acc: 0.928
Validation loss decreased (-0.927773 --> -0.927773).  Saving model ...
Epoch: 35 cost time: 7.026339769363403
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.928 Test Loss: 0.458 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 7.857095003128052
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.928 Test Loss: 0.446 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 7.2680583000183105
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.928 Test Loss: 0.434 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 7.727057218551636
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.928 Test Loss: 0.444 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 7.455724477767944
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 7.151144742965698
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 7.130600929260254
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.922 Test Loss: 0.411 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 7.371912002563477
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 6.8906354904174805
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.917 Test Loss: 0.436 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 7.490875482559204
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 18818950
model size : 71.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.6323676109313965
Epoch: 1, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.033 Vali Acc: 0.733 Test Loss: 1.033 Test Acc: 0.733
Validation loss decreased (inf --> -0.733323).  Saving model ...
Epoch: 2 cost time: 4.252473592758179
Epoch: 2, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.485 Vali Acc: 0.772 Test Loss: 0.485 Test Acc: 0.772
Validation loss decreased (-0.733323 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 4.50172233581543
Epoch: 3, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.414 Vali Acc: 0.794 Test Loss: 0.414 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 4.815212249755859
Epoch: 4, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
Validation loss decreased (-0.794440 --> -0.849996).  Saving model ...
Epoch: 5 cost time: 5.103270769119263
Epoch: 5, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.400 Vali Acc: 0.839 Test Loss: 0.400 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.968393564224243
Epoch: 6, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.318 Vali Acc: 0.828 Test Loss: 0.318 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.438875675201416
Epoch: 7, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.26024603843689
Epoch: 8, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 9 cost time: 4.4791388511657715
Epoch: 9, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.855551 --> -0.899997).  Saving model ...
Epoch: 10 cost time: 4.481220483779907
Epoch: 10, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.633 Vali Acc: 0.872 Test Loss: 0.633 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.456697463989258
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.296487808227539
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.548193693161011
Epoch: 13, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.5956337451934814
Epoch: 14, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.574 Vali Acc: 0.872 Test Loss: 0.574 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.645869731903076
Epoch: 15, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.388188123703003
Epoch: 16, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 4.423415899276733
Epoch: 17, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.414 Vali Acc: 0.894 Test Loss: 0.414 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.346412181854248
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.152096509933472
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9472618103027344
Epoch: 20, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7866768836975098
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.262654066085815
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.963374376296997
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.7783517837524414
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.397 Vali Acc: 0.894 Test Loss: 0.397 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.377378225326538
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.426 Vali Acc: 0.872 Test Loss: 0.426 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.610141277313232
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 18339846
model size : 70.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.150392293930054
Epoch: 1, Steps: 12 | Train Loss: 1.381 Vali Loss: 0.957 Vali Acc: 0.717 Test Loss: 0.957 Test Acc: 0.717
Validation loss decreased (inf --> -0.716657).  Saving model ...
Epoch: 2 cost time: 5.051774024963379
Epoch: 2, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
Validation loss decreased (-0.716657 --> -0.783328).  Saving model ...
Epoch: 3 cost time: 4.405921936035156
Epoch: 3, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.385 Vali Acc: 0.794 Test Loss: 0.385 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794441).  Saving model ...
Epoch: 4 cost time: 3.984973907470703
Epoch: 4, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.345 Vali Acc: 0.817 Test Loss: 0.345 Test Acc: 0.817
Validation loss decreased (-0.794441 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 3.863931894302368
Epoch: 5, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.380 Vali Acc: 0.839 Test Loss: 0.380 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 4.088569641113281
Epoch: 6, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.409 Vali Acc: 0.828 Test Loss: 0.409 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.975977897644043
Epoch: 7, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
Validation loss decreased (-0.838885 --> -0.883331).  Saving model ...
Epoch: 8 cost time: 4.732823848724365
Epoch: 8, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.713 Vali Acc: 0.817 Test Loss: 0.713 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.756201267242432
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.759 Vali Acc: 0.811 Test Loss: 0.759 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.783299922943115
Epoch: 10, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888887).  Saving model ...
Epoch: 11 cost time: 4.364172697067261
Epoch: 11, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.346847772598267
Epoch: 12, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.336 Vali Acc: 0.872 Test Loss: 0.336 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.228018522262573
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 3.7099645137786865
Epoch: 14, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.934882879257202
Epoch: 15, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.379 Vali Acc: 0.883 Test Loss: 0.379 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.135549306869507
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.899998 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 4.265413045883179
Epoch: 17, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.849838972091675
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.796515226364136
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.392 Vali Acc: 0.911 Test Loss: 0.392 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.624020338058472
Epoch: 20, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 4.694324970245361
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.931687355041504
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.518575429916382
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.427102565765381
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 4.872187852859497
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.058923721313477
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.496965408325195
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.500549554824829
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.436161518096924
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.885665655136108
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.09282374382019
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.41304349899292
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.372 Vali Acc: 0.906 Test Loss: 0.372 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.379925727844238
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.666 Vali Acc: 0.878 Test Loss: 0.666 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.063042402267456
Epoch: 34, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.718 Vali Acc: 0.883 Test Loss: 0.718 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 18339974
model size : 70.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.619778394699097
Epoch: 1, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.176 Vali Acc: 0.683 Test Loss: 1.176 Test Acc: 0.683
Validation loss decreased (inf --> -0.683322).  Saving model ...
Epoch: 2 cost time: 3.859919786453247
Epoch: 2, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.612 Vali Acc: 0.728 Test Loss: 0.612 Test Acc: 0.728
Validation loss decreased (-0.683322 --> -0.727772).  Saving model ...
Epoch: 3 cost time: 4.326223850250244
Epoch: 3, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.465 Vali Acc: 0.750 Test Loss: 0.465 Test Acc: 0.750
Validation loss decreased (-0.727772 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 4.355170965194702
Epoch: 4, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.454 Vali Acc: 0.817 Test Loss: 0.454 Test Acc: 0.817
Validation loss decreased (-0.749995 --> -0.816662).  Saving model ...
Epoch: 5 cost time: 4.134141206741333
Epoch: 5, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.321 Vali Acc: 0.828 Test Loss: 0.321 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827775).  Saving model ...
Epoch: 6 cost time: 4.046442985534668
Epoch: 6, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.488 Vali Acc: 0.828 Test Loss: 0.488 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.00759220123291
Epoch: 7, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.362 Vali Acc: 0.800 Test Loss: 0.362 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7000348567962646
Epoch: 8, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.309 Vali Acc: 0.828 Test Loss: 0.309 Test Acc: 0.828
Validation loss decreased (-0.827775 --> -0.827775).  Saving model ...
Epoch: 9 cost time: 3.85449481010437
Epoch: 9, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.070799827575684
Epoch: 10, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
Validation loss decreased (-0.827775 --> -0.883329).  Saving model ...
Epoch: 11 cost time: 4.193598985671997
Epoch: 11, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 4.259273052215576
Epoch: 12, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.411458730697632
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.68061637878418
Epoch: 14, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 4.522972345352173
Epoch: 15, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 4.433478593826294
Epoch: 16, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.600416898727417
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.19976544380188
Epoch: 18, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.208877801895142
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.463 Vali Acc: 0.911 Test Loss: 0.463 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.538576126098633
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8857522010803223
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 3.689796209335327
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8475735187530518
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.950 Test Loss: 0.146 Test Acc: 0.950
Validation loss decreased (-0.922220 --> -0.949999).  Saving model ...
Epoch: 24 cost time: 4.615946292877197
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.266262531280518
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.976470947265625
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.928 Test Loss: 0.157 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5719950199127197
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.928 Test Loss: 0.143 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.5846776962280273
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.7605812549591064
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.175687313079834
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.494 Vali Acc: 0.894 Test Loss: 0.494 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.251590728759766
Epoch: 31, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.5380003452301025
Epoch: 32, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.244238615036011
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.825 Vali Acc: 0.839 Test Loss: 0.825 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 18192774
model size : 69.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.681262969970703
Epoch: 1, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.260 Vali Acc: 0.694 Test Loss: 1.260 Test Acc: 0.694
Validation loss decreased (inf --> -0.694432).  Saving model ...
Epoch: 2 cost time: 3.8828866481781006
Epoch: 2, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.634 Vali Acc: 0.756 Test Loss: 0.634 Test Acc: 0.756
Validation loss decreased (-0.694432 --> -0.755549).  Saving model ...
Epoch: 3 cost time: 3.721022605895996
Epoch: 3, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.460 Vali Acc: 0.767 Test Loss: 0.460 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 4.310317754745483
Epoch: 4, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.376 Vali Acc: 0.817 Test Loss: 0.376 Test Acc: 0.817
Validation loss decreased (-0.766662 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 3.5850138664245605
Epoch: 5, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 6 cost time: 3.570307493209839
Epoch: 6, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 3.3357772827148438
Epoch: 7, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 3.239642381668091
Epoch: 8, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.421915054321289
Epoch: 9, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 3.5957021713256836
Epoch: 10, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 3.760272741317749
Epoch: 11, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.316 Vali Acc: 0.883 Test Loss: 0.316 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 3.6847474575042725
Epoch: 12, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 3.999953269958496
Epoch: 13, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 3.8786063194274902
Epoch: 14, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 3.894054412841797
Epoch: 15, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.332 Vali Acc: 0.872 Test Loss: 0.332 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8397867679595947
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 4.1070716381073
Epoch: 17, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 4.170118093490601
Epoch: 18, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.493 Vali Acc: 0.906 Test Loss: 0.493 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.790565013885498
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.322645902633667
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.376 Vali Acc: 0.894 Test Loss: 0.376 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.766599655151367
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.8872697353363037
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.418 Vali Acc: 0.894 Test Loss: 0.418 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.722869873046875
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.616 Vali Acc: 0.883 Test Loss: 0.616 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.649380922317505
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.5069611072540283
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3938701152801514
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.039879083633423
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 18082438
model size : 69.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.403498888015747
Epoch: 1, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.416 Vali Acc: 0.672 Test Loss: 1.416 Test Acc: 0.672
Validation loss decreased (inf --> -0.672208).  Saving model ...
Epoch: 2 cost time: 3.0988259315490723
Epoch: 2, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.672208 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 2.952122449874878
Epoch: 3, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.516 Vali Acc: 0.756 Test Loss: 0.516 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 3.2019340991973877
Epoch: 4, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.395 Vali Acc: 0.789 Test Loss: 0.395 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 3.1847310066223145
Epoch: 5, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
Validation loss decreased (-0.788885 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 3.069844961166382
Epoch: 6, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2353718280792236
Epoch: 7, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4083950519561768
Epoch: 8, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.430 Vali Acc: 0.817 Test Loss: 0.430 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.848033905029297
Epoch: 9, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 3.740190029144287
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.879044532775879
Epoch: 11, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 3.412506103515625
Epoch: 12, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 2.947627305984497
Epoch: 13, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.205 Vali Acc: 0.900 Test Loss: 0.205 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 3.427031993865967
Epoch: 14, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6829676628112793
Epoch: 15, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.192 Vali Acc: 0.894 Test Loss: 0.192 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.510380983352661
Epoch: 16, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 17 cost time: 3.528831958770752
Epoch: 17, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.905554 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 3.5713438987731934
Epoch: 18, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 3.654975652694702
Epoch: 19, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9967219829559326
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.183 Vali Acc: 0.906 Test Loss: 0.183 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.998817205429077
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.92820405960083
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 2.792941093444824
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.305206298828125
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.336766242980957
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1276702880859375
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.471792221069336
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.3353798389434814
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 3.181037425994873
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.232 Vali Acc: 0.939 Test Loss: 0.232 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 3.187249183654785
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.855355978012085
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.613585948944092
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.410468339920044
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.238016128540039
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.374 Vali Acc: 0.906 Test Loss: 0.374 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.1448099613189697
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.2943649291992188
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.7993123531341553
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.168 Vali Acc: 0.922 Test Loss: 0.168 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.164384365081787
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.208453416824341
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 18009094
model size : 68.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.885982990264893
Epoch: 1, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.401 Vali Acc: 0.644 Test Loss: 1.401 Test Acc: 0.644
Validation loss decreased (inf --> -0.644430).  Saving model ...
Epoch: 2 cost time: 3.772926092147827
Epoch: 2, Steps: 12 | Train Loss: 0.938 Vali Loss: 0.818 Vali Acc: 0.683 Test Loss: 0.818 Test Acc: 0.683
Validation loss decreased (-0.644430 --> -0.683325).  Saving model ...
Epoch: 3 cost time: 3.76874041557312
Epoch: 3, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.545 Vali Acc: 0.733 Test Loss: 0.545 Test Acc: 0.733
Validation loss decreased (-0.683325 --> -0.733328).  Saving model ...
Epoch: 4 cost time: 3.924203395843506
Epoch: 4, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.418 Vali Acc: 0.778 Test Loss: 0.418 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777774).  Saving model ...
Epoch: 5 cost time: 3.6725451946258545
Epoch: 5, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
Validation loss decreased (-0.777774 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 3.9074177742004395
Epoch: 6, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 3.8195364475250244
Epoch: 7, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8792121410369873
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.309 Vali Acc: 0.828 Test Loss: 0.309 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.1934943199157715
Epoch: 9, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.833330 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 4.308733224868774
Epoch: 10, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.265 Vali Acc: 0.867 Test Loss: 0.265 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.957171678543091
Epoch: 11, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.345 Vali Acc: 0.872 Test Loss: 0.345 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.136433124542236
Epoch: 12, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888887).  Saving model ...
Epoch: 13 cost time: 3.370239496231079
Epoch: 13, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.222730875015259
Epoch: 14, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 3.050954580307007
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.534770965576172
Epoch: 16, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1920979022979736
Epoch: 17, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 3.47459077835083
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 19 cost time: 3.746189832687378
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.412 Vali Acc: 0.894 Test Loss: 0.412 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.716463804244995
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.292582035064697
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.954671859741211
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.388395071029663
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.43218994140625
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.826005458831787
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.928 Test Loss: 0.280 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.026663780212402
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.9994778633117676
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.8531532287597656
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 18009350
model size : 68.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.057842969894409
Epoch: 1, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.032 Vali Acc: 0.667 Test Loss: 1.032 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 3.9704294204711914
Epoch: 2, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.551 Vali Acc: 0.733 Test Loss: 0.551 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733328).  Saving model ...
Epoch: 3 cost time: 3.814208984375
Epoch: 3, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.490 Vali Acc: 0.778 Test Loss: 0.490 Test Acc: 0.778
Validation loss decreased (-0.733328 --> -0.777773).  Saving model ...
Epoch: 4 cost time: 4.107580900192261
Epoch: 4, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788883).  Saving model ...
Epoch: 5 cost time: 3.9533729553222656
Epoch: 5, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
Validation loss decreased (-0.788883 --> -0.844440).  Saving model ...
Epoch: 6 cost time: 4.457954168319702
Epoch: 6, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 3.9441049098968506
Epoch: 7, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.23080039024353
Epoch: 8, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.357 Vali Acc: 0.861 Test Loss: 0.357 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6000285148620605
Epoch: 9, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.251 Vali Acc: 0.856 Test Loss: 0.251 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5645503997802734
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 3.5881381034851074
Epoch: 11, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9198663234710693
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.655508279800415
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.346977472305298
Epoch: 14, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.431 Vali Acc: 0.839 Test Loss: 0.431 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.303807973861694
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.263742446899414
Epoch: 16, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.409 Vali Acc: 0.883 Test Loss: 0.409 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.25636887550354
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.424178600311279
Epoch: 18, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.7919883728027344
Epoch: 19, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.0159759521484375
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 3.770026683807373
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.301878213882446
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.107513427734375
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.26354455947876
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8243408203125
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 4.072184085845947
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.208829641342163
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.347695589065552
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6696407794952393
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3500781059265137
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.856588363647461
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.4325802326202393
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 33 cost time: 2.798898935317993
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.6947238445281982
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.8151650428771973
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.7365787029266357
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.9800174236297607
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.072977542877197
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.993870735168457
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.320767641067505
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.230147838592529
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.3877482414245605
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5460934
model size : 20.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.95342493057251
Epoch: 1, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.251 Vali Acc: 0.761 Test Loss: 1.251 Test Acc: 0.761
Validation loss decreased (inf --> -0.761099).  Saving model ...
Epoch: 2 cost time: 2.8087730407714844
Epoch: 2, Steps: 12 | Train Loss: 0.760 Vali Loss: 0.636 Vali Acc: 0.789 Test Loss: 0.636 Test Acc: 0.789
Validation loss decreased (-0.761099 --> -0.788883).  Saving model ...
Epoch: 3 cost time: 3.182670831680298
Epoch: 3, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.501 Vali Acc: 0.756 Test Loss: 0.501 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.922469139099121
Epoch: 4, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.445 Vali Acc: 0.783 Test Loss: 0.445 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.992915391921997
Epoch: 5, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.788883 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 3.0735840797424316
Epoch: 6, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 3.2418596744537354
Epoch: 7, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 3.2738120555877686
Epoch: 8, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 3.2047009468078613
Epoch: 9, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.979412317276001
Epoch: 10, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.872219 --> -0.911108).  Saving model ...
Epoch: 11 cost time: 2.751333713531494
Epoch: 11, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6775856018066406
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.016124963760376
Epoch: 13, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9710638523101807
Epoch: 14, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.918292284011841
Epoch: 15, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.678112268447876
Epoch: 16, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 17 cost time: 2.889484405517578
Epoch: 17, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0807230472564697
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 3.2162554264068604
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1090078353881836
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.912524938583374
Epoch: 21, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 3.0477662086486816
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9105448722839355
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8785924911499023
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0659327507019043
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.993793487548828
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.8503153324127197
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.8385443687438965
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.869504451751709
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.2282941341400146
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.100986957550049
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5221382
model size : 20.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.005568742752075
Epoch: 1, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.262 Vali Acc: 0.689 Test Loss: 1.262 Test Acc: 0.689
Validation loss decreased (inf --> -0.688876).  Saving model ...
Epoch: 2 cost time: 3.187073230743408
Epoch: 2, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.639 Vali Acc: 0.778 Test Loss: 0.639 Test Acc: 0.778
Validation loss decreased (-0.688876 --> -0.777771).  Saving model ...
Epoch: 3 cost time: 3.2015137672424316
Epoch: 3, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.439 Vali Acc: 0.817 Test Loss: 0.439 Test Acc: 0.817
Validation loss decreased (-0.777771 --> -0.816662).  Saving model ...
Epoch: 4 cost time: 2.8087871074676514
Epoch: 4, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.363 Vali Acc: 0.806 Test Loss: 0.363 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.964721918106079
Epoch: 5, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849997).  Saving model ...
Epoch: 6 cost time: 2.917025566101074
Epoch: 6, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 7 cost time: 2.6514670848846436
Epoch: 7, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5289151668548584
Epoch: 8, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 9 cost time: 2.9389843940734863
Epoch: 9, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.415 Vali Acc: 0.817 Test Loss: 0.415 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9366369247436523
Epoch: 10, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.953096389770508
Epoch: 11, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 3.0111796855926514
Epoch: 12, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.960017204284668
Epoch: 13, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.441 Vali Acc: 0.844 Test Loss: 0.441 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0724923610687256
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.054764747619629
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8558075428009033
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7480430603027344
Epoch: 17, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7155635356903076
Epoch: 18, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 2.6918227672576904
Epoch: 19, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.754746913909912
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4956517219543457
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 2.4917874336242676
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.71311092376709
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 2.707933187484741
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.224151134490967
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.186533212661743
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.933272361755371
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.7856290340423584
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 2.7899351119995117
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 2.68607759475708
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6347227096557617
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.214494466781616
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.509789228439331
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.378 Vali Acc: 0.894 Test Loss: 0.378 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.5297951698303223
Epoch: 34, Steps: 12 | Train Loss: 0.221 Vali Loss: 1.265 Vali Acc: 0.856 Test Loss: 1.265 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.3624961376190186
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.795 Vali Acc: 0.850 Test Loss: 0.795 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.406425952911377
Epoch: 36, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.600 Vali Acc: 0.839 Test Loss: 0.600 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.694779396057129
Epoch: 37, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.192 Vali Acc: 0.817 Test Loss: 1.192 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.751862049102783
Epoch: 38, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.896 Vali Acc: 0.856 Test Loss: 0.896 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.767742872238159
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.129 Vali Acc: 0.839 Test Loss: 1.129 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5221446
model size : 20.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.955230951309204
Epoch: 1, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.384 Vali Acc: 0.639 Test Loss: 1.384 Test Acc: 0.639
Validation loss decreased (inf --> -0.638875).  Saving model ...
Epoch: 2 cost time: 2.6975812911987305
Epoch: 2, Steps: 12 | Train Loss: 0.936 Vali Loss: 0.761 Vali Acc: 0.711 Test Loss: 0.761 Test Acc: 0.711
Validation loss decreased (-0.638875 --> -0.711104).  Saving model ...
Epoch: 3 cost time: 2.8193531036376953
Epoch: 3, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.496 Vali Acc: 0.800 Test Loss: 0.496 Test Acc: 0.800
Validation loss decreased (-0.711104 --> -0.799995).  Saving model ...
Epoch: 4 cost time: 2.4915640354156494
Epoch: 4, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.430 Vali Acc: 0.794 Test Loss: 0.430 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.546745777130127
Epoch: 5, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
Validation loss decreased (-0.799995 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 2.4003522396087646
Epoch: 6, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 2.3193130493164062
Epoch: 7, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 8 cost time: 2.354694128036499
Epoch: 8, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5973541736602783
Epoch: 9, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 10 cost time: 2.625356912612915
Epoch: 10, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4014179706573486
Epoch: 11, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.473724126815796
Epoch: 12, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.274 Vali Acc: 0.861 Test Loss: 0.274 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4862563610076904
Epoch: 13, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 2.4428627490997314
Epoch: 14, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 2.591240406036377
Epoch: 15, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.74007248878479
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6028060913085938
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4074556827545166
Epoch: 18, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4943621158599854
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4426143169403076
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.549609661102295
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 2.515496015548706
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.430213212966919
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3721489906311035
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7508459091186523
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6335391998291016
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.8291501998901367
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.7624874114990234
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 2.5637307167053223
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6165478229522705
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.50931715965271
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.520944595336914
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 2.5203397274017334
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.467926025390625
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.3245060443878174
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.284430742263794
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.492637872695923
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.5313479900360107
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.324279546737671
Epoch: 39, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.445563316345215
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.5721795558929443
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.4220449924468994
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 5147846
model size : 19.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.444089412689209
Epoch: 1, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.483 Vali Acc: 0.628 Test Loss: 1.483 Test Acc: 0.628
Validation loss decreased (inf --> -0.627763).  Saving model ...
Epoch: 2 cost time: 2.406055212020874
Epoch: 2, Steps: 12 | Train Loss: 1.057 Vali Loss: 0.894 Vali Acc: 0.694 Test Loss: 0.894 Test Acc: 0.694
Validation loss decreased (-0.627763 --> -0.694436).  Saving model ...
Epoch: 3 cost time: 2.399860382080078
Epoch: 3, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.566 Vali Acc: 0.767 Test Loss: 0.566 Test Acc: 0.767
Validation loss decreased (-0.694436 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 2.4755120277404785
Epoch: 4, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.458 Vali Acc: 0.756 Test Loss: 0.458 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.437981367111206
Epoch: 5, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.3675482273101807
Epoch: 6, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 2.244840145111084
Epoch: 7, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.3684651851654053
Epoch: 8, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.838885 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 2.450923442840576
Epoch: 9, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2765018939971924
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2270312309265137
Epoch: 11, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4360191822052
Epoch: 12, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.264 Vali Acc: 0.861 Test Loss: 0.264 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3532874584198
Epoch: 13, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.29335618019104
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.422971725463867
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.344478130340576
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.43266224861145
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.9258368015289307
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.346644401550293
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4637556076049805
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 2.476445198059082
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 2.353071451187134
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5705034732818604
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.469839096069336
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.933 Test Loss: 0.158 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 25 cost time: 2.4692842960357666
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.922 Test Loss: 0.181 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5126919746398926
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 2.59169602394104
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.567595958709717
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.517934560775757
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3932783603668213
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.586209297180176
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.4007487297058105
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.300361156463623
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.5760631561279297
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.429861068725586
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.3338310718536377
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5092678
model size : 19.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.3161163330078125
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.626 Vali Acc: 0.500 Test Loss: 1.626 Test Acc: 0.500
Validation loss decreased (inf --> -0.499984).  Saving model ...
Epoch: 2 cost time: 2.4902145862579346
Epoch: 2, Steps: 12 | Train Loss: 1.235 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.499984 --> -0.699989).  Saving model ...
Epoch: 3 cost time: 2.5405097007751465
Epoch: 3, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.706 Vali Acc: 0.728 Test Loss: 0.706 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 2.354914903640747
Epoch: 4, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.521 Vali Acc: 0.767 Test Loss: 0.521 Test Acc: 0.767
Validation loss decreased (-0.727771 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 2.443270444869995
Epoch: 5, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
Validation loss decreased (-0.766661 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.626014471054077
Epoch: 6, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.575345277786255
Epoch: 7, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.2672927379608154
Epoch: 8, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.492220163345337
Epoch: 9, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.308 Vali Acc: 0.811 Test Loss: 0.308 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1321425437927246
Epoch: 10, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 11 cost time: 2.3324408531188965
Epoch: 11, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.301 Vali Acc: 0.828 Test Loss: 0.301 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.326853036880493
Epoch: 12, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.275 Vali Acc: 0.861 Test Loss: 0.275 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.363250732421875
Epoch: 13, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872220).  Saving model ...
Epoch: 14 cost time: 2.3411285877227783
Epoch: 14, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5332369804382324
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
Validation loss decreased (-0.872220 --> -0.872220).  Saving model ...
Epoch: 16 cost time: 2.383159875869751
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.658766746520996
Epoch: 17, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.217 Vali Acc: 0.883 Test Loss: 0.217 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 2.7390761375427246
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 2.68742036819458
Epoch: 19, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 2.645906925201416
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 2.6929357051849365
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 2.6832244396209717
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.814847946166992
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6462466716766357
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7382988929748535
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.881385326385498
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.641204357147217
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.4372963905334473
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.494966745376587
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.4896957874298096
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.487743377685547
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 32 cost time: 2.3774688243865967
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.464400291442871
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4938251972198486
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.796369791030884
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.6201930046081543
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.6459314823150635
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.0079152584075928
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.5793254375457764
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.983299732208252
Epoch: 40, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.668086290359497
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.560 Vali Acc: 0.894 Test Loss: 0.560 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5056006
model size : 19.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.96556282043457
Epoch: 1, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.599 Vali Acc: 0.461 Test Loss: 1.599 Test Acc: 0.461
Validation loss decreased (inf --> -0.461095).  Saving model ...
Epoch: 2 cost time: 2.2767844200134277
Epoch: 2, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.103 Vali Acc: 0.700 Test Loss: 1.103 Test Acc: 0.700
Validation loss decreased (-0.461095 --> -0.699989).  Saving model ...
Epoch: 3 cost time: 2.7115283012390137
Epoch: 3, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 2.596588611602783
Epoch: 4, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.556 Vali Acc: 0.750 Test Loss: 0.556 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 2.3702480792999268
Epoch: 5, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.446 Vali Acc: 0.817 Test Loss: 0.446 Test Acc: 0.817
Validation loss decreased (-0.749994 --> -0.816662).  Saving model ...
Epoch: 6 cost time: 2.533231258392334
Epoch: 6, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.390 Vali Acc: 0.811 Test Loss: 0.390 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3957231044769287
Epoch: 7, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.2545042037963867
Epoch: 8, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 2.350714921951294
Epoch: 9, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4151649475097656
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.4326798915863037
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 2.33957576751709
Epoch: 12, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.303762912750244
Epoch: 13, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.509981155395508
Epoch: 14, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
Validation loss decreased (-0.866664 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 2.596972942352295
Epoch: 15, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7272074222564697
Epoch: 16, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8324878215789795
Epoch: 17, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.267855644226074
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 2.6084136962890625
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.187 Vali Acc: 0.911 Test Loss: 0.187 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 2.273183584213257
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 2.504997968673706
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.381941080093384
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 2.928164482116699
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8802366256713867
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.7963621616363525
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.7366576194763184
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5859978199005127
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.580547332763672
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3144664764404297
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.6453754901885986
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.414 Vali Acc: 0.894 Test Loss: 0.414 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.27760648727417
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.40851092338562
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5056134
model size : 19.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.659603595733643
Epoch: 1, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.295 Vali Acc: 0.633 Test Loss: 1.295 Test Acc: 0.633
Validation loss decreased (inf --> -0.633320).  Saving model ...
Epoch: 2 cost time: 3.141840696334839
Epoch: 2, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.709 Vali Acc: 0.744 Test Loss: 0.709 Test Acc: 0.744
Validation loss decreased (-0.633320 --> -0.744437).  Saving model ...
Epoch: 3 cost time: 3.4334068298339844
Epoch: 3, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.744437 --> -0.788884).  Saving model ...
Epoch: 4 cost time: 2.958847761154175
Epoch: 4, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.378 Vali Acc: 0.783 Test Loss: 0.378 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6981606483459473
Epoch: 5, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 3.4117228984832764
Epoch: 6, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.613035202026367
Epoch: 7, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2781083583831787
Epoch: 8, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
Validation loss decreased (-0.827774 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 3.375856876373291
Epoch: 9, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2278809547424316
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.400 Vali Acc: 0.839 Test Loss: 0.400 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9093716144561768
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 3.3371145725250244
Epoch: 12, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.386 Vali Acc: 0.883 Test Loss: 0.386 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883329).  Saving model ...
Epoch: 13 cost time: 2.9133670330047607
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
Validation loss decreased (-0.883329 --> -0.911109).  Saving model ...
Epoch: 14 cost time: 3.0990593433380127
Epoch: 14, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9615097045898438
Epoch: 15, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 3.2927582263946533
Epoch: 16, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 2.558044195175171
Epoch: 17, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 18 cost time: 2.573169708251953
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 19 cost time: 2.4983811378479004
Epoch: 19, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7714169025421143
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.433535575866699
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.807292938232422
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.906439781188965
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.935018539428711
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 25 cost time: 2.6651132106781006
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.301154136657715
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0003411769866943
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.169124126434326
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.871915578842163
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.969136953353882
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.557936429977417
Epoch: 31, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.307042360305786
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.0811166763305664
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.366 Vali Acc: 0.906 Test Loss: 0.366 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.4951589107513428
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1743334
model size : 6.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.022690296173096
Epoch: 1, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.495 Vali Acc: 0.689 Test Loss: 1.495 Test Acc: 0.689
Validation loss decreased (inf --> -0.688874).  Saving model ...
Epoch: 2 cost time: 2.3562815189361572
Epoch: 2, Steps: 12 | Train Loss: 1.111 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
Validation loss decreased (-0.688874 --> -0.722213).  Saving model ...
Epoch: 3 cost time: 2.997965097427368
Epoch: 3, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.623 Vali Acc: 0.772 Test Loss: 0.623 Test Acc: 0.772
Validation loss decreased (-0.722213 --> -0.772216).  Saving model ...
Epoch: 4 cost time: 2.4663045406341553
Epoch: 4, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.505 Vali Acc: 0.778 Test Loss: 0.505 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 2.225862503051758
Epoch: 5, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.99263596534729
Epoch: 6, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.371 Vali Acc: 0.817 Test Loss: 0.371 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.3543262481689453
Epoch: 7, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.481515645980835
Epoch: 8, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.327 Vali Acc: 0.822 Test Loss: 0.327 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9858198165893555
Epoch: 9, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.288 Vali Acc: 0.844 Test Loss: 0.288 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844442).  Saving model ...
Epoch: 10 cost time: 2.4560396671295166
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.844442 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 2.728806495666504
Epoch: 11, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.274 Vali Acc: 0.850 Test Loss: 0.274 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.57580304145813
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 2.1131162643432617
Epoch: 13, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.292 Vali Acc: 0.828 Test Loss: 0.292 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.963090658187866
Epoch: 14, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7388765811920166
Epoch: 15, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 2.300248384475708
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.300 Vali Acc: 0.839 Test Loss: 0.300 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0448906421661377
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 2.009854316711426
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1948962211608887
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 20 cost time: 2.426085948944092
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9811923503875732
Epoch: 21, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6636054515838623
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.210 Vali Acc: 0.900 Test Loss: 0.210 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 23 cost time: 2.8577840328216553
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7137088775634766
Epoch: 24, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.556368589401245
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 2.8711435794830322
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6674370765686035
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 2.6259124279022217
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.682755470275879
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.304166555404663
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.8241970539093018
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.330824851989746
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.906 Test Loss: 0.197 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.7427620887756348
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.911 Test Loss: 0.185 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.8338963985443115
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 2.9605162143707275
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.7993476390838623
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.6266684532165527
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.651815176010132
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.404445171356201
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 40 cost time: 2.494795560836792
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.6890900135040283
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.5616350173950195
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.7941908836364746
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.418104887008667
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.819182872772217
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.633610963821411
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.867004871368408
Epoch: 47, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.7439825534820557
Epoch: 48, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.0691356658935547
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1623558
model size : 6.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.270465135574341
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.496 Vali Acc: 0.650 Test Loss: 1.496 Test Acc: 0.650
Validation loss decreased (inf --> -0.649985).  Saving model ...
Epoch: 2 cost time: 2.6971518993377686
Epoch: 2, Steps: 12 | Train Loss: 1.098 Vali Loss: 0.907 Vali Acc: 0.728 Test Loss: 0.907 Test Acc: 0.728
Validation loss decreased (-0.649985 --> -0.727769).  Saving model ...
Epoch: 3 cost time: 2.615126132965088
Epoch: 3, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755549).  Saving model ...
Epoch: 4 cost time: 2.472989082336426
Epoch: 4, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.497 Vali Acc: 0.772 Test Loss: 0.497 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.420196056365967
Epoch: 5, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.406 Vali Acc: 0.806 Test Loss: 0.406 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.3626880645751953
Epoch: 6, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.328662395477295
Epoch: 7, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.349764108657837
Epoch: 8, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 2.35734224319458
Epoch: 9, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.084068775177002
Epoch: 10, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0597195625305176
Epoch: 11, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.916367530822754
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4791791439056396
Epoch: 13, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.3142311573028564
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.783536195755005
Epoch: 15, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.367 Vali Acc: 0.856 Test Loss: 0.367 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3985865116119385
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.343 Vali Acc: 0.883 Test Loss: 0.343 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.562429666519165
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 2.3195438385009766
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.040923833847046
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0066640377044678
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4986462593078613
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.958505868911743
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5774989128112793
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 24 cost time: 2.6312215328216553
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.477947235107422
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 2.789865493774414
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4953672885894775
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3891217708587646
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.528641700744629
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.342555522918701
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 2.279423713684082
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.8972277641296387
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.7498180866241455
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.933 Test Loss: 0.166 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933332).  Saving model ...
Epoch: 34 cost time: 2.7890167236328125
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.4920248985290527
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.426420211791992
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.6196420192718506
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.410198211669922
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.621479034423828
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.073429584503174
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.2591917514801025
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.255669593811035
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.634422540664673
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1623590
model size : 6.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.044785261154175
Epoch: 1, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.524 Vali Acc: 0.628 Test Loss: 1.524 Test Acc: 0.628
Validation loss decreased (inf --> -0.627763).  Saving model ...
Epoch: 2 cost time: 2.300682783126831
Epoch: 2, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.035 Vali Acc: 0.689 Test Loss: 1.035 Test Acc: 0.689
Validation loss decreased (-0.627763 --> -0.688879).  Saving model ...
Epoch: 3 cost time: 2.3471286296844482
Epoch: 3, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
Validation loss decreased (-0.688879 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 2.4143781661987305
Epoch: 4, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 2.630603790283203
Epoch: 5, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.429 Vali Acc: 0.783 Test Loss: 0.429 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4411075115203857
Epoch: 6, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.382 Vali Acc: 0.828 Test Loss: 0.382 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.2259953022003174
Epoch: 7, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.197502613067627
Epoch: 8, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 2.0264060497283936
Epoch: 9, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.371 Vali Acc: 0.806 Test Loss: 0.371 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8621468544006348
Epoch: 10, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.2984845638275146
Epoch: 11, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.416440486907959
Epoch: 12, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.302 Vali Acc: 0.867 Test Loss: 0.302 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 2.565253973007202
Epoch: 13, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9586310386657715
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.286 Vali Acc: 0.844 Test Loss: 0.286 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6061971187591553
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 2.2377893924713135
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5906763076782227
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.302652597427368
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 19 cost time: 2.6458585262298584
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.229 Vali Acc: 0.872 Test Loss: 0.229 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.668470621109009
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 2.040616989135742
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.222 Vali Acc: 0.894 Test Loss: 0.222 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.486701488494873
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.367528200149536
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.900 Test Loss: 0.200 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1488778591156006
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 2.0535335540771484
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 2.2455050945281982
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.911 Test Loss: 0.185 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 2.149693489074707
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.089022397994995
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.928 Test Loss: 0.173 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 1.8601479530334473
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.142861843109131
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.149475336074829
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.351027488708496
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 33 cost time: 2.541959047317505
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8458306789398193
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.922 Test Loss: 0.176 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.308039665222168
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.2775943279266357
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.231266498565674
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.939 Test Loss: 0.157 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 38 cost time: 1.9966914653778076
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.933 Test Loss: 0.165 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.1403653621673584
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0216333866119385
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.1202337741851807
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.054900646209717
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.138397455215454
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.4641683101654053
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.369086742401123
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.613089084625244
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.542 Vali Acc: 0.872 Test Loss: 0.542 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.624889612197876
Epoch: 47, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1586790
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.194246530532837
Epoch: 1, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.599 Vali Acc: 0.528 Test Loss: 1.599 Test Acc: 0.528
Validation loss decreased (inf --> -0.527762).  Saving model ...
Epoch: 2 cost time: 2.25150990486145
Epoch: 2, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.177 Vali Acc: 0.683 Test Loss: 1.177 Test Acc: 0.683
Validation loss decreased (-0.527762 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 2.0880041122436523
Epoch: 3, Steps: 12 | Train Loss: 0.918 Vali Loss: 0.817 Vali Acc: 0.744 Test Loss: 0.817 Test Acc: 0.744
Validation loss decreased (-0.683322 --> -0.744436).  Saving model ...
Epoch: 4 cost time: 1.9927785396575928
Epoch: 4, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.607 Vali Acc: 0.739 Test Loss: 0.607 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4734978675842285
Epoch: 5, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 2.0078885555267334
Epoch: 6, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.440 Vali Acc: 0.772 Test Loss: 0.440 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.106041193008423
Epoch: 7, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.784952163696289
Epoch: 8, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.8632481098175049
Epoch: 9, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.284858465194702
Epoch: 10, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 2.0547449588775635
Epoch: 11, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 2.1923670768737793
Epoch: 12, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.4701759815216064
Epoch: 13, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 1.972508192062378
Epoch: 14, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.9284992218017578
Epoch: 15, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0801944732666016
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0611791610717773
Epoch: 17, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.250 Vali Acc: 0.867 Test Loss: 0.250 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.128380060195923
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 2.336815357208252
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 2.1695661544799805
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 2.135335683822632
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 22 cost time: 2.1609044075012207
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 1.933553695678711
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4240992069244385
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9823601245880127
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.386103630065918
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5712571144104004
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 2.3712635040283203
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.911 Test Loss: 0.189 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.626896381378174
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2951462268829346
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.589113473892212
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 32 cost time: 2.751075029373169
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1924986839294434
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4378156661987305
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.6427626609802246
Epoch: 35, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.171 Vali Acc: 0.917 Test Loss: 0.171 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.3031511306762695
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.0430049896240234
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.939 Test Loss: 0.170 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 38 cost time: 2.497939109802246
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2767786979675293
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.939 Test Loss: 0.163 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 40 cost time: 2.341571807861328
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.22360897064209
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.2952284812927246
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.8528122901916504
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.3087997436523438
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.3036084175109863
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.8408522605895996
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.215381383895874
Epoch: 47, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.259831190109253
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.2418909072875977
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1559206
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.520618200302124
Epoch: 1, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.656 Vali Acc: 0.517 Test Loss: 1.656 Test Acc: 0.517
Validation loss decreased (inf --> -0.516650).  Saving model ...
Epoch: 2 cost time: 2.0517919063568115
Epoch: 2, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.346 Vali Acc: 0.700 Test Loss: 1.346 Test Acc: 0.700
Validation loss decreased (-0.516650 --> -0.699987).  Saving model ...
Epoch: 3 cost time: 2.2775368690490723
Epoch: 3, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.009 Vali Acc: 0.728 Test Loss: 1.009 Test Acc: 0.728
Validation loss decreased (-0.699987 --> -0.727768).  Saving model ...
Epoch: 4 cost time: 1.6266348361968994
Epoch: 4, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.784 Vali Acc: 0.722 Test Loss: 0.784 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1277236938476562
Epoch: 5, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9087741374969482
Epoch: 6, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.552 Vali Acc: 0.744 Test Loss: 0.552 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744439).  Saving model ...
Epoch: 7 cost time: 1.993328332901001
Epoch: 7, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.495 Vali Acc: 0.767 Test Loss: 0.495 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 1.8397367000579834
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.444 Vali Acc: 0.806 Test Loss: 0.444 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 2.2734715938568115
Epoch: 9, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.422 Vali Acc: 0.794 Test Loss: 0.422 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2574844360351562
Epoch: 10, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.382 Vali Acc: 0.811 Test Loss: 0.382 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.2578670978546143
Epoch: 11, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 2.4921157360076904
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 13 cost time: 2.3827571868896484
Epoch: 13, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 2.3864030838012695
Epoch: 14, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827775).  Saving model ...
Epoch: 15 cost time: 2.2047698497772217
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.295 Vali Acc: 0.844 Test Loss: 0.295 Test Acc: 0.844
Validation loss decreased (-0.827775 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 2.0301527976989746
Epoch: 16, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.3714499473571777
Epoch: 17, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.6536846160888672
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8547022342681885
Epoch: 19, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.271 Vali Acc: 0.844 Test Loss: 0.271 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8979227542877197
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 1.8973426818847656
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888887).  Saving model ...
Epoch: 22 cost time: 2.0376758575439453
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1886656284332275
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.102501392364502
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
Validation loss decreased (-0.888887 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 2.5452561378479004
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 2.5368404388427734
Epoch: 26, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.38444447517395
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.894 Test Loss: 0.220 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.022540807723999
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.265928030014038
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9063911437988281
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9386088848114014
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 2.0626630783081055
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 2.0606160163879395
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9357647895812988
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.855473518371582
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.944990873336792
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.950188398361206
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.9553980827331543
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.209963083267212
Epoch: 39, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.8848779201507568
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.2164111137390137
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.26749849319458
Epoch: 42, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1540870
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.102973699569702
Epoch: 1, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.695 Vali Acc: 0.428 Test Loss: 1.695 Test Acc: 0.428
Validation loss decreased (inf --> -0.427761).  Saving model ...
Epoch: 2 cost time: 2.592785358428955
Epoch: 2, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.399 Vali Acc: 0.661 Test Loss: 1.399 Test Acc: 0.661
Validation loss decreased (-0.427761 --> -0.661097).  Saving model ...
Epoch: 3 cost time: 2.049215793609619
Epoch: 3, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.075 Vali Acc: 0.706 Test Loss: 1.075 Test Acc: 0.706
Validation loss decreased (-0.661097 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 2.298743724822998
Epoch: 4, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.799 Vali Acc: 0.706 Test Loss: 0.799 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705548).  Saving model ...
Epoch: 5 cost time: 1.9917986392974854
Epoch: 5, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.637 Vali Acc: 0.728 Test Loss: 0.637 Test Acc: 0.728
Validation loss decreased (-0.705548 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 2.0119826793670654
Epoch: 6, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.551 Vali Acc: 0.756 Test Loss: 0.551 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.8844759464263916
Epoch: 7, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.489 Vali Acc: 0.761 Test Loss: 0.489 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 1.9315052032470703
Epoch: 8, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.436 Vali Acc: 0.772 Test Loss: 0.436 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772218).  Saving model ...
Epoch: 9 cost time: 2.014660358428955
Epoch: 9, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.772218 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 2.3857855796813965
Epoch: 10, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.385 Vali Acc: 0.800 Test Loss: 0.385 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8450682163238525
Epoch: 11, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.7012040615081787
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8207578659057617
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8007519245147705
Epoch: 14, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.321 Vali Acc: 0.828 Test Loss: 0.321 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0211212635040283
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 16 cost time: 2.1585512161254883
Epoch: 16, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 2.1871070861816406
Epoch: 17, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 18 cost time: 2.288156270980835
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 19 cost time: 2.6656103134155273
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 2.4107367992401123
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 21 cost time: 2.4272985458374023
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9487278461456299
Epoch: 22, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.7922232151031494
Epoch: 23, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.234 Vali Acc: 0.872 Test Loss: 0.234 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8267638683319092
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.245 Vali Acc: 0.878 Test Loss: 0.245 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1486737728118896
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.749302864074707
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.207 Vali Acc: 0.889 Test Loss: 0.207 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.084571361541748
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.870469331741333
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.894 Test Loss: 0.204 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0360090732574463
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.320300340652466
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 2.5432863235473633
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 32 cost time: 2.1688156127929688
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.41888427734375
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.906 Test Loss: 0.197 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.3584213256835938
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7453927993774414
Epoch: 35, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.129647731781006
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 2.079188108444214
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.035024404525757
Epoch: 38, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0766544342041016
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.796957015991211
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 1.5963902473449707
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.022066593170166
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.014491558074951
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.8248555660247803
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9702954292297363
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.0157971382141113
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.2760839462280273
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.982053279876709
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.0906999111175537
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.939 Test Loss: 0.202 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.1298296451568604
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1540934
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.031826972961426
Epoch: 1, Steps: 12 | Train Loss: 1.347 Vali Loss: 0.757 Vali Acc: 0.722 Test Loss: 0.757 Test Acc: 0.722
Validation loss decreased (inf --> -0.722215).  Saving model ...
Epoch: 2 cost time: 6.190624952316284
Epoch: 2, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.420 Vali Acc: 0.778 Test Loss: 0.420 Test Acc: 0.778
Validation loss decreased (-0.722215 --> -0.777774).  Saving model ...
Epoch: 3 cost time: 6.122966766357422
Epoch: 3, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.381 Vali Acc: 0.794 Test Loss: 0.381 Test Acc: 0.794
Validation loss decreased (-0.777774 --> -0.794441).  Saving model ...
Epoch: 4 cost time: 6.30574631690979
Epoch: 4, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
Validation loss decreased (-0.794441 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 6.517049551010132
Epoch: 5, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.1489293575286865
Epoch: 6, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.992159605026245
Epoch: 7, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.7369065284729
Epoch: 8, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
Validation loss decreased (-0.833329 --> -0.883330).  Saving model ...
Epoch: 9 cost time: 6.277859210968018
Epoch: 9, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.442392587661743
Epoch: 10, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.742 Vali Acc: 0.817 Test Loss: 0.742 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.252868890762329
Epoch: 11, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.323 Vali Acc: 0.867 Test Loss: 0.323 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.3662590980529785
Epoch: 12, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.331637859344482
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.420 Vali Acc: 0.878 Test Loss: 0.420 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.354448318481445
Epoch: 14, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.578 Vali Acc: 0.844 Test Loss: 0.578 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.706932067871094
Epoch: 15, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.798 Vali Acc: 0.839 Test Loss: 0.798 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.411192417144775
Epoch: 16, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.009 Vali Acc: 0.817 Test Loss: 1.009 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.5485100746154785
Epoch: 17, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.861 Vali Acc: 0.833 Test Loss: 0.861 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.2419493198394775
Epoch: 18, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 18782086
model size : 71.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.872379302978516
Epoch: 1, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.027 Vali Acc: 0.717 Test Loss: 1.027 Test Acc: 0.717
Validation loss decreased (inf --> -0.716656).  Saving model ...
Epoch: 2 cost time: 3.2743799686431885
Epoch: 2, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.528 Vali Acc: 0.750 Test Loss: 0.528 Test Acc: 0.750
Validation loss decreased (-0.716656 --> -0.749995).  Saving model ...
Epoch: 3 cost time: 3.380791425704956
Epoch: 3, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.401 Vali Acc: 0.789 Test Loss: 0.401 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 3.5533621311187744
Epoch: 4, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.284 Vali Acc: 0.844 Test Loss: 0.284 Test Acc: 0.844
Validation loss decreased (-0.788885 --> -0.844442).  Saving model ...
Epoch: 5 cost time: 3.54560923576355
Epoch: 5, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.598 Vali Acc: 0.794 Test Loss: 0.598 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.009467601776123
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.823054552078247
Epoch: 7, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8932266235351562
Epoch: 8, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.844442 --> -0.866663).  Saving model ...
Epoch: 9 cost time: 3.4894633293151855
Epoch: 9, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6915171146392822
Epoch: 10, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 3.599398612976074
Epoch: 11, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 4.112166166305542
Epoch: 12, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 4.090953826904297
Epoch: 13, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 4.274584770202637
Epoch: 14, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.126473903656006
Epoch: 15, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9946372509002686
Epoch: 16, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.576021432876587
Epoch: 17, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
Validation loss decreased (-0.905553 --> -0.938887).  Saving model ...
Epoch: 18 cost time: 4.025234699249268
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.657918691635132
Epoch: 19, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9363365173339844
Epoch: 20, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.956514596939087
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.885263681411743
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.051692485809326
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.9867641925811768
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.8005571365356445
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.9938313961029053
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.8242263793945312
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.475 Vali Acc: 0.883 Test Loss: 0.475 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 18302982
model size : 69.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.216570615768433
Epoch: 1, Steps: 12 | Train Loss: 1.473 Vali Loss: 0.967 Vali Acc: 0.711 Test Loss: 0.967 Test Acc: 0.711
Validation loss decreased (inf --> -0.711101).  Saving model ...
Epoch: 2 cost time: 4.247583627700806
Epoch: 2, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.485 Vali Acc: 0.733 Test Loss: 0.485 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733328).  Saving model ...
Epoch: 3 cost time: 4.048586368560791
Epoch: 3, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.484 Vali Acc: 0.800 Test Loss: 0.484 Test Acc: 0.800
Validation loss decreased (-0.733328 --> -0.799995).  Saving model ...
Epoch: 4 cost time: 4.205037832260132
Epoch: 4, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.077534914016724
Epoch: 5, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
Validation loss decreased (-0.799995 --> -0.838886).  Saving model ...
Epoch: 6 cost time: 4.0233635902404785
Epoch: 6, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.046682596206665
Epoch: 7, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.716 Vali Acc: 0.794 Test Loss: 0.716 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.267400503158569
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.369 Vali Acc: 0.872 Test Loss: 0.369 Test Acc: 0.872
Validation loss decreased (-0.838886 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 4.315088272094727
Epoch: 9, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.04765248298645
Epoch: 10, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.764 Vali Acc: 0.806 Test Loss: 0.764 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6697778701782227
Epoch: 11, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4102442264556885
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1563141345977783
Epoch: 13, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 3.6868345737457275
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9310483932495117
Epoch: 15, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 4.353483200073242
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.475 Vali Acc: 0.839 Test Loss: 0.475 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.113524436950684
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9038100242614746
Epoch: 18, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 3.7945899963378906
Epoch: 19, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 3.802837610244751
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 3.4653196334838867
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3596081733703613
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.011290073394775
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 4.290803909301758
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.242531061172485
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.872206926345825
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 3.9656429290771484
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.041213274002075
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6578712463378906
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.789870500564575
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.7945072650909424
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.939 Test Loss: 0.225 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.937335729598999
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.928142547607422
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 3.5678927898406982
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.907400369644165
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.03733229637146
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.931627035140991
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.11266565322876
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.385643482208252
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.576836585998535
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.3172340393066406
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.693455219268799
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.558856248855591
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 18303110
model size : 69.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.940980672836304
Epoch: 1, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.205 Vali Acc: 0.711 Test Loss: 1.205 Test Acc: 0.711
Validation loss decreased (inf --> -0.711099).  Saving model ...
Epoch: 2 cost time: 3.6399881839752197
Epoch: 2, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.611 Vali Acc: 0.694 Test Loss: 0.611 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5800132751464844
Epoch: 3, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.459 Vali Acc: 0.772 Test Loss: 0.459 Test Acc: 0.772
Validation loss decreased (-0.711099 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 3.6979424953460693
Epoch: 4, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.399 Vali Acc: 0.817 Test Loss: 0.399 Test Acc: 0.817
Validation loss decreased (-0.772218 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 3.5890650749206543
Epoch: 5, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.475 Vali Acc: 0.817 Test Loss: 0.475 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3927371501922607
Epoch: 6, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827775).  Saving model ...
Epoch: 7 cost time: 3.458974838256836
Epoch: 7, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
Validation loss decreased (-0.827775 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 3.294496536254883
Epoch: 8, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 3.400059700012207
Epoch: 9, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
Validation loss decreased (-0.849997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 3.7070984840393066
Epoch: 10, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6147634983062744
Epoch: 11, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.547632932662964
Epoch: 12, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.391 Vali Acc: 0.839 Test Loss: 0.391 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4425604343414307
Epoch: 13, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.370 Vali Acc: 0.872 Test Loss: 0.370 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1975362300872803
Epoch: 14, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.334970235824585
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.336282730102539
Epoch: 16, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.348 Vali Acc: 0.872 Test Loss: 0.348 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.455343723297119
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 3.409818172454834
Epoch: 18, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.759 Vali Acc: 0.883 Test Loss: 0.759 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2628891468048096
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 3.00244140625
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 2.9950759410858154
Epoch: 21, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2022452354431152
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2245874404907227
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3407747745513916
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 3.096853256225586
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.411 Vali Acc: 0.911 Test Loss: 0.411 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8412981033325195
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.698101758956909
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.494 Vali Acc: 0.911 Test Loss: 0.494 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7845399379730225
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.142120838165283
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.894 Test Loss: 0.489 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.632988929748535
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.7095353603363037
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.906 Test Loss: 0.469 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.6528868675231934
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.592897653579712
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.6053543090820312
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.767 Vali Acc: 0.900 Test Loss: 0.767 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 18155910
model size : 69.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.32444953918457
Epoch: 1, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.248 Vali Acc: 0.689 Test Loss: 1.248 Test Acc: 0.689
Validation loss decreased (inf --> -0.688876).  Saving model ...
Epoch: 2 cost time: 2.957256555557251
Epoch: 2, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.636 Vali Acc: 0.711 Test Loss: 0.636 Test Acc: 0.711
Validation loss decreased (-0.688876 --> -0.711105).  Saving model ...
Epoch: 3 cost time: 3.6229088306427
Epoch: 3, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.434 Vali Acc: 0.789 Test Loss: 0.434 Test Acc: 0.789
Validation loss decreased (-0.711105 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 3.574781656265259
Epoch: 4, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.788885 --> -0.838886).  Saving model ...
Epoch: 5 cost time: 3.8120651245117188
Epoch: 5, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.313 Vali Acc: 0.828 Test Loss: 0.313 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8819122314453125
Epoch: 6, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.327 Vali Acc: 0.828 Test Loss: 0.327 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7309412956237793
Epoch: 7, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.482 Vali Acc: 0.828 Test Loss: 0.482 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.410320520401001
Epoch: 8, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 3.44134521484375
Epoch: 9, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
Validation loss decreased (-0.861108 --> -0.905553).  Saving model ...
Epoch: 10 cost time: 3.0596396923065186
Epoch: 10, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0533812046051025
Epoch: 11, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.23144793510437
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.263653516769409
Epoch: 13, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3740627765655518
Epoch: 14, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6482744216918945
Epoch: 15, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.658539295196533
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.4493072032928467
Epoch: 17, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 3.5062975883483887
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3978819847106934
Epoch: 19, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5984668731689453
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 3.4970078468322754
Epoch: 21, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.367 Vali Acc: 0.883 Test Loss: 0.367 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7960240840911865
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.688035726547241
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.600 Vali Acc: 0.894 Test Loss: 0.600 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.796975612640381
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.751018524169922
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3641510009765625
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.8893203735351562
Epoch: 27, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.604 Vali Acc: 0.872 Test Loss: 0.604 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.032687187194824
Epoch: 28, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.0012261867523193
Epoch: 29, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.9871082305908203
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 18045574
model size : 69.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.6980299949646
Epoch: 1, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.374 Vali Acc: 0.656 Test Loss: 1.374 Test Acc: 0.656
Validation loss decreased (inf --> -0.655542).  Saving model ...
Epoch: 2 cost time: 3.470109701156616
Epoch: 2, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.759 Vali Acc: 0.706 Test Loss: 0.759 Test Acc: 0.706
Validation loss decreased (-0.655542 --> -0.705548).  Saving model ...
Epoch: 3 cost time: 3.345151662826538
Epoch: 3, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.523 Vali Acc: 0.772 Test Loss: 0.523 Test Acc: 0.772
Validation loss decreased (-0.705548 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 3.258028030395508
Epoch: 4, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.424 Vali Acc: 0.778 Test Loss: 0.424 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777774).  Saving model ...
Epoch: 5 cost time: 3.128689765930176
Epoch: 5, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
Validation loss decreased (-0.777774 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 2.4529151916503906
Epoch: 6, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.419004201889038
Epoch: 7, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.409 Vali Acc: 0.806 Test Loss: 0.409 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4183311462402344
Epoch: 8, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3163630962371826
Epoch: 9, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.378 Vali Acc: 0.856 Test Loss: 0.378 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5156409740448
Epoch: 10, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 3.3056447505950928
Epoch: 11, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.333 Vali Acc: 0.883 Test Loss: 0.333 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2082502841949463
Epoch: 12, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9802918434143066
Epoch: 13, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.201 Vali Acc: 0.900 Test Loss: 0.201 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899998).  Saving model ...
Epoch: 14 cost time: 2.5134117603302
Epoch: 14, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 3.3649656772613525
Epoch: 15, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5074219703674316
Epoch: 16, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.786586046218872
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8876242637634277
Epoch: 18, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6367344856262207
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5816402435302734
Epoch: 20, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.479295253753662
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6224172115325928
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9608514308929443
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7433571815490723
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.345 Vali Acc: 0.894 Test Loss: 0.345 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 17972230
model size : 68.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.718818664550781
Epoch: 1, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.435 Vali Acc: 0.678 Test Loss: 1.435 Test Acc: 0.678
Validation loss decreased (inf --> -0.677763).  Saving model ...
Epoch: 2 cost time: 2.773974895477295
Epoch: 2, Steps: 12 | Train Loss: 0.929 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
Validation loss decreased (-0.677763 --> -0.755548).  Saving model ...
Epoch: 3 cost time: 2.781170129776001
Epoch: 3, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.494 Vali Acc: 0.772 Test Loss: 0.494 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 3.1230015754699707
Epoch: 4, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.424 Vali Acc: 0.822 Test Loss: 0.424 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 3.3401906490325928
Epoch: 5, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.377 Vali Acc: 0.856 Test Loss: 0.377 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 3.435133457183838
Epoch: 6, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 3.7080581188201904
Epoch: 7, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.294 Vali Acc: 0.850 Test Loss: 0.294 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9048428535461426
Epoch: 8, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 3.5363917350769043
Epoch: 9, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.47263240814209
Epoch: 10, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9782848358154297
Epoch: 11, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 3.445718288421631
Epoch: 12, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 3.340128183364868
Epoch: 13, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 3.262587308883667
Epoch: 14, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.384547710418701
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 3.2316510677337646
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 3.2941935062408447
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 3.5236144065856934
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3831984996795654
Epoch: 19, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.20654034614563
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.427 Vali Acc: 0.883 Test Loss: 0.427 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.881963014602661
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.866952419281006
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.352 Vali Acc: 0.894 Test Loss: 0.352 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.702040672302246
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.5257537364959717
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 3.9502058029174805
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.471 Vali Acc: 0.894 Test Loss: 0.471 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8892343044281006
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.135683059692383
Epoch: 27, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.910 Vali Acc: 0.839 Test Loss: 0.910 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.233095645904541
Epoch: 28, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.941 Vali Acc: 0.856 Test Loss: 0.941 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.696874618530273
Epoch: 29, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.512 Vali Acc: 0.911 Test Loss: 0.512 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.205786943435669
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.059583425521851
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.314558744430542
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.323 Vali Acc: 0.922 Test Loss: 0.323 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.60591197013855
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.984912157058716
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.457 Vali Acc: 0.911 Test Loss: 0.457 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 17972486
model size : 68.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.668333530426025
Epoch: 1, Steps: 12 | Train Loss: 1.425 Vali Loss: 0.999 Vali Acc: 0.728 Test Loss: 0.999 Test Acc: 0.728
Validation loss decreased (inf --> -0.727768).  Saving model ...
Epoch: 2 cost time: 4.3089330196380615
Epoch: 2, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.521 Vali Acc: 0.767 Test Loss: 0.521 Test Acc: 0.767
Validation loss decreased (-0.727768 --> -0.766661).  Saving model ...
Epoch: 3 cost time: 4.419106960296631
Epoch: 3, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.433 Vali Acc: 0.794 Test Loss: 0.433 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 4.061430215835571
Epoch: 4, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.530 Vali Acc: 0.778 Test Loss: 0.530 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7362029552459717
Epoch: 5, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 4.233933687210083
Epoch: 6, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.33042573928833
Epoch: 7, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.566 Vali Acc: 0.828 Test Loss: 0.566 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827772).  Saving model ...
Epoch: 8 cost time: 3.9527101516723633
Epoch: 8, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.415 Vali Acc: 0.822 Test Loss: 0.415 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.342056512832642
Epoch: 9, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 4.204817056655884
Epoch: 10, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 3.7793385982513428
Epoch: 11, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 3.6521854400634766
Epoch: 12, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.212 Vali Acc: 0.889 Test Loss: 0.212 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888887).  Saving model ...
Epoch: 13 cost time: 4.1669838428497314
Epoch: 13, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.347 Vali Acc: 0.883 Test Loss: 0.347 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.4160566329956055
Epoch: 14, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.066187620162964
Epoch: 15, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 4.256437063217163
Epoch: 16, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.306936740875244
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 3.6342008113861084
Epoch: 18, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 3.5777363777160645
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 3.5608532428741455
Epoch: 20, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4798593521118164
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.786133289337158
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.076241731643677
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.911 Test Loss: 0.378 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.29500412940979
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 3.9490840435028076
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.154796361923218
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.827361583709717
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.9733572006225586
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.034546613693237
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.074143648147583
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.074709415435791
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.864323854446411
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.199143409729004
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.900371789932251
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 5442502
model size : 20.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.725755214691162
Epoch: 1, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.272 Vali Acc: 0.689 Test Loss: 1.272 Test Acc: 0.689
Validation loss decreased (inf --> -0.688876).  Saving model ...
Epoch: 2 cost time: 2.9839890003204346
Epoch: 2, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.633 Vali Acc: 0.717 Test Loss: 0.633 Test Acc: 0.717
Validation loss decreased (-0.688876 --> -0.716660).  Saving model ...
Epoch: 3 cost time: 2.451503276824951
Epoch: 3, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.466 Vali Acc: 0.806 Test Loss: 0.466 Test Acc: 0.806
Validation loss decreased (-0.716660 --> -0.805551).  Saving model ...
Epoch: 4 cost time: 2.7690157890319824
Epoch: 4, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.382 Vali Acc: 0.811 Test Loss: 0.382 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 3.1586544513702393
Epoch: 5, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.309 Vali Acc: 0.828 Test Loss: 0.309 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827775).  Saving model ...
Epoch: 6 cost time: 3.0447559356689453
Epoch: 6, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.372 Vali Acc: 0.794 Test Loss: 0.372 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.153752565383911
Epoch: 7, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.02970027923584
Epoch: 8, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.827775 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 2.773738145828247
Epoch: 9, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 10 cost time: 3.2389578819274902
Epoch: 10, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6682636737823486
Epoch: 11, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.900563955307007
Epoch: 12, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 2.6237411499023438
Epoch: 13, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.762906789779663
Epoch: 14, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 15 cost time: 2.6586222648620605
Epoch: 15, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2133495807647705
Epoch: 16, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.192554235458374
Epoch: 17, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0779976844787598
Epoch: 18, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.28607177734375
Epoch: 19, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1155221462249756
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.439 Vali Acc: 0.878 Test Loss: 0.439 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.392803430557251
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.374 Vali Acc: 0.878 Test Loss: 0.374 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.4101269245147705
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 3.0988128185272217
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1818809509277344
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2198238372802734
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.967346668243408
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.625 Vali Acc: 0.883 Test Loss: 0.625 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.079977035522461
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.351 Vali Acc: 0.872 Test Loss: 0.351 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.085529088973999
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.359 Vali Acc: 0.917 Test Loss: 0.359 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.163949489593506
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.452770948410034
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.0279505252838135
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 2.4257636070251465
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 2.942190408706665
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 34 cost time: 3.2975854873657227
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8822906017303467
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.9864585399627686
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.0737743377685547
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.1975457668304443
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.767117738723755
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.484090566635132
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.010 Vali Acc: 0.861 Test Loss: 1.010 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.7486345767974854
Epoch: 41, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.908 Vali Acc: 0.867 Test Loss: 0.908 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.660691976547241
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.796 Vali Acc: 0.867 Test Loss: 0.796 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.038026809692383
Epoch: 43, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.414 Vali Acc: 0.883 Test Loss: 0.414 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5202950
model size : 19.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.8226282596588135
Epoch: 1, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.228 Vali Acc: 0.700 Test Loss: 1.228 Test Acc: 0.700
Validation loss decreased (inf --> -0.699988).  Saving model ...
Epoch: 2 cost time: 3.015078544616699
Epoch: 2, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
Validation loss decreased (-0.699988 --> -0.761105).  Saving model ...
Epoch: 3 cost time: 3.0249383449554443
Epoch: 3, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.454 Vali Acc: 0.811 Test Loss: 0.454 Test Acc: 0.811
Validation loss decreased (-0.761105 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 2.935932159423828
Epoch: 4, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.396 Vali Acc: 0.811 Test Loss: 0.396 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 2.978060007095337
Epoch: 5, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 2.927537679672241
Epoch: 6, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
Validation loss decreased (-0.816663 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.891509532928467
Epoch: 7, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8625659942626953
Epoch: 8, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.971569776535034
Epoch: 9, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 2.714773654937744
Epoch: 10, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.352 Vali Acc: 0.856 Test Loss: 0.352 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.789475679397583
Epoch: 11, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.534757137298584
Epoch: 12, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6242737770080566
Epoch: 13, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7523834705352783
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 3.3428642749786377
Epoch: 15, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9820609092712402
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 3.0591344833374023
Epoch: 17, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 18 cost time: 3.1328368186950684
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9161272048950195
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5555989742279053
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0126616954803467
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.549642562866211
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9275193214416504
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.844059705734253
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.00634765625
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.755249500274658
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 3.0716896057128906
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 28 cost time: 3.0127999782562256
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.175506114959717
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.641091823577881
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.1578476428985596
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.6288833618164062
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.0017359256744385
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.7377593517303467
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.9064230918884277
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.492950439453125
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.3917806148529053
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 5203014
model size : 19.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.238746166229248
Epoch: 1, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.383 Vali Acc: 0.678 Test Loss: 1.383 Test Acc: 0.678
Validation loss decreased (inf --> -0.677764).  Saving model ...
Epoch: 2 cost time: 2.521577835083008
Epoch: 2, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.760 Vali Acc: 0.750 Test Loss: 0.760 Test Acc: 0.750
Validation loss decreased (-0.677764 --> -0.749992).  Saving model ...
Epoch: 3 cost time: 2.221766471862793
Epoch: 3, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.510 Vali Acc: 0.772 Test Loss: 0.510 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 2.4692118167877197
Epoch: 4, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.417 Vali Acc: 0.800 Test Loss: 0.417 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 2.504129648208618
Epoch: 5, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 2.54599928855896
Epoch: 6, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.376 Vali Acc: 0.811 Test Loss: 0.376 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4816699028015137
Epoch: 7, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 2.398226499557495
Epoch: 8, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 2.68196439743042
Epoch: 9, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 2.5993423461914062
Epoch: 10, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7643322944641113
Epoch: 11, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 2.6798532009124756
Epoch: 12, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 2.6015477180480957
Epoch: 13, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.465428113937378
Epoch: 14, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.6849570274353027
Epoch: 15, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 2.5073068141937256
Epoch: 16, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 2.4551069736480713
Epoch: 17, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 2.342582941055298
Epoch: 18, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 19 cost time: 2.7645065784454346
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4340150356292725
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.367158889770508
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.481430768966675
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.46282958984375
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.372 Vali Acc: 0.911 Test Loss: 0.372 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2771384716033936
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5347375869750977
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.6575727462768555
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.248605728149414
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4327311515808105
Epoch: 28, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 5129414
model size : 19.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.743928909301758
Epoch: 1, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.492 Vali Acc: 0.444 Test Loss: 1.492 Test Acc: 0.444
Validation loss decreased (inf --> -0.444430).  Saving model ...
Epoch: 2 cost time: 2.639573097229004
Epoch: 2, Steps: 12 | Train Loss: 1.094 Vali Loss: 0.939 Vali Acc: 0.728 Test Loss: 0.939 Test Acc: 0.728
Validation loss decreased (-0.444430 --> -0.727768).  Saving model ...
Epoch: 3 cost time: 2.7336699962615967
Epoch: 3, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.602 Vali Acc: 0.706 Test Loss: 0.602 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.920642852783203
Epoch: 4, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.491 Vali Acc: 0.756 Test Loss: 0.491 Test Acc: 0.756
Validation loss decreased (-0.727768 --> -0.755551).  Saving model ...
Epoch: 5 cost time: 2.559591293334961
Epoch: 5, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
Validation loss decreased (-0.755551 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.622974157333374
Epoch: 6, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.352 Vali Acc: 0.811 Test Loss: 0.352 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811108).  Saving model ...
Epoch: 7 cost time: 2.72599196434021
Epoch: 7, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
Validation loss decreased (-0.811108 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.4766907691955566
Epoch: 8, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5436766147613525
Epoch: 9, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 1.932549238204956
Epoch: 10, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0359890460968018
Epoch: 11, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9274935722351074
Epoch: 12, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 2.1283271312713623
Epoch: 13, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4570248126983643
Epoch: 14, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.6551074981689453
Epoch: 15, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8117709159851074
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6847856044769287
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.681030750274658
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
Validation loss decreased (-0.888886 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 2.5287468433380127
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.346 Vali Acc: 0.883 Test Loss: 0.346 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.419882297515869
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.47160267829895
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5930733680725098
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3842949867248535
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0238983631134033
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4097988605499268
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.42866587638855
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3531806468963623
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.678997039794922
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 2.54362154006958
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4108850955963135
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.6487441062927246
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.234290599822998
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.240612745285034
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.345 Vali Acc: 0.894 Test Loss: 0.345 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.401853561401367
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.911 Test Loss: 0.405 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.241136074066162
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.421029567718506
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.7091052532196045
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.446526050567627
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 5074246
model size : 19.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.886026620864868
Epoch: 1, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.550 Vali Acc: 0.511 Test Loss: 1.550 Test Acc: 0.511
Validation loss decreased (inf --> -0.511096).  Saving model ...
Epoch: 2 cost time: 2.0183486938476562
Epoch: 2, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.044 Vali Acc: 0.694 Test Loss: 1.044 Test Acc: 0.694
Validation loss decreased (-0.511096 --> -0.694434).  Saving model ...
Epoch: 3 cost time: 2.1417481899261475
Epoch: 3, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.704 Vali Acc: 0.706 Test Loss: 0.704 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705549).  Saving model ...
Epoch: 4 cost time: 1.9911532402038574
Epoch: 4, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.522 Vali Acc: 0.756 Test Loss: 0.522 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 2.5894784927368164
Epoch: 5, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.437 Vali Acc: 0.778 Test Loss: 0.437 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 2.398646831512451
Epoch: 6, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 2.4312326908111572
Epoch: 7, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.3058297634124756
Epoch: 8, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.356708288192749
Epoch: 9, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 2.6362650394439697
Epoch: 10, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 2.719891309738159
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.275 Vali Acc: 0.861 Test Loss: 0.275 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 2.4710750579833984
Epoch: 12, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.269 Vali Acc: 0.856 Test Loss: 0.269 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4347119331359863
Epoch: 13, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 2.62624454498291
Epoch: 14, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6601755619049072
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.65354585647583
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.267 Vali Acc: 0.856 Test Loss: 0.267 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.406541347503662
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 2.1536245346069336
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5926177501678467
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 2.4134867191314697
Epoch: 20, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 2.452228546142578
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2414610385894775
Epoch: 22, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 23 cost time: 2.577018976211548
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6994576454162598
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 2.455556869506836
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.189 Vali Acc: 0.900 Test Loss: 0.189 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4004085063934326
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.408128499984741
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.911 Test Loss: 0.182 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.575438976287842
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6084866523742676
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.906 Test Loss: 0.204 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.4553933143615723
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.3993468284606934
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.5849316120147705
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.38586163520813
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 34 cost time: 2.239365577697754
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9518723487854004
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.2657737731933594
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.478541374206543
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.5847911834716797
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.458157777786255
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.328721523284912
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.1161789894104004
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.143691301345825
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.4134581089019775
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 5037574
model size : 19.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.213876008987427
Epoch: 1, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.553 Vali Acc: 0.556 Test Loss: 1.553 Test Acc: 0.556
Validation loss decreased (inf --> -0.555540).  Saving model ...
Epoch: 2 cost time: 1.9854118824005127
Epoch: 2, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.067 Vali Acc: 0.711 Test Loss: 1.067 Test Acc: 0.711
Validation loss decreased (-0.555540 --> -0.711100).  Saving model ...
Epoch: 3 cost time: 2.182185173034668
Epoch: 3, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.698 Vali Acc: 0.728 Test Loss: 0.698 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 2.117766857147217
Epoch: 4, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.534 Vali Acc: 0.750 Test Loss: 0.534 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749995).  Saving model ...
Epoch: 5 cost time: 2.19708514213562
Epoch: 5, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
Validation loss decreased (-0.749995 --> -0.822218).  Saving model ...
Epoch: 6 cost time: 2.024005889892578
Epoch: 6, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.071387529373169
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.917311668395996
Epoch: 8, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 2.1445188522338867
Epoch: 9, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 2.060392379760742
Epoch: 10, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.131441116333008
Epoch: 11, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 2.347602367401123
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 2.2354657649993896
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 2.4406557083129883
Epoch: 14, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1755168437957764
Epoch: 15, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.2777585983276367
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.372 Vali Acc: 0.883 Test Loss: 0.372 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2599427700042725
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 18 cost time: 2.3303802013397217
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 19 cost time: 2.106497049331665
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.195127010345459
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.192 Vali Acc: 0.906 Test Loss: 0.192 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 21 cost time: 1.9467618465423584
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1665573120117188
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
Validation loss decreased (-0.905554 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 2.1101057529449463
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.894 Test Loss: 0.205 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0276222229003906
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.185854434967041
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0116631984710693
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.939 Test Loss: 0.148 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 1.8214173316955566
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8738510608673096
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8228416442871094
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.069927930831909
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.933 Test Loss: 0.155 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.3853559494018555
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.2237958908081055
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.0825841426849365
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.0949764251708984
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.178335666656494
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.1705965995788574
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 5037702
model size : 19.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.662215709686279
Epoch: 1, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.386 Vali Acc: 0.672 Test Loss: 1.386 Test Acc: 0.672
Validation loss decreased (inf --> -0.672208).  Saving model ...
Epoch: 2 cost time: 2.6017041206359863
Epoch: 2, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.722 Vali Acc: 0.689 Test Loss: 0.722 Test Acc: 0.689
Validation loss decreased (-0.672208 --> -0.688882).  Saving model ...
Epoch: 3 cost time: 2.5729751586914062
Epoch: 3, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.538 Vali Acc: 0.772 Test Loss: 0.538 Test Acc: 0.772
Validation loss decreased (-0.688882 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 2.849785804748535
Epoch: 4, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.434 Vali Acc: 0.778 Test Loss: 0.434 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 2.930403470993042
Epoch: 5, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 2.977184295654297
Epoch: 6, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.611 Vali Acc: 0.778 Test Loss: 0.611 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7391843795776367
Epoch: 7, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.349 Vali Acc: 0.839 Test Loss: 0.349 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.002887487411499
Epoch: 8, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.293 Vali Acc: 0.828 Test Loss: 0.293 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3025646209716797
Epoch: 9, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.264 Vali Acc: 0.872 Test Loss: 0.264 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872220).  Saving model ...
Epoch: 10 cost time: 2.29349422454834
Epoch: 10, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.354 Vali Acc: 0.878 Test Loss: 0.354 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 2.105802059173584
Epoch: 11, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0779318809509277
Epoch: 12, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.4246697425842285
Epoch: 13, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
Validation loss decreased (-0.877775 --> -0.911109).  Saving model ...
Epoch: 14 cost time: 2.657335042953491
Epoch: 14, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 2.1581711769104004
Epoch: 15, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 2.577226400375366
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7992427349090576
Epoch: 17, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8971567153930664
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.544971466064453
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.329 Vali Acc: 0.894 Test Loss: 0.329 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5516765117645264
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3938491344451904
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.647829294204712
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.285472869873047
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.556473731994629
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.346 Vali Acc: 0.906 Test Loss: 0.346 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8002004623413086
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1734118
model size : 6.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6567018032073975
Epoch: 1, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.456 Vali Acc: 0.661 Test Loss: 1.456 Test Acc: 0.661
Validation loss decreased (inf --> -0.661097).  Saving model ...
Epoch: 2 cost time: 2.0914080142974854
Epoch: 2, Steps: 12 | Train Loss: 1.084 Vali Loss: 0.920 Vali Acc: 0.706 Test Loss: 0.920 Test Acc: 0.706
Validation loss decreased (-0.661097 --> -0.705546).  Saving model ...
Epoch: 3 cost time: 2.168890953063965
Epoch: 3, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.605 Vali Acc: 0.767 Test Loss: 0.605 Test Acc: 0.767
Validation loss decreased (-0.705546 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 2.353135347366333
Epoch: 4, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.468 Vali Acc: 0.800 Test Loss: 0.468 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 5 cost time: 2.483231782913208
Epoch: 5, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.414 Vali Acc: 0.811 Test Loss: 0.414 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 2.332404136657715
Epoch: 6, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.389 Vali Acc: 0.794 Test Loss: 0.389 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3691303730010986
Epoch: 7, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.4568495750427246
Epoch: 8, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 2.5060973167419434
Epoch: 9, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6171529293060303
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.6293387413024902
Epoch: 11, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 2.3151021003723145
Epoch: 12, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.298489570617676
Epoch: 13, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 1.9326796531677246
Epoch: 14, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9098994731903076
Epoch: 15, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 1.9523329734802246
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.236626148223877
Epoch: 17, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1317107677459717
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.330145835876465
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.23006534576416
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.147937059402466
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 2.3063161373138428
Epoch: 22, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3318634033203125
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 2.6464455127716064
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.482778787612915
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2696728706359863
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 2.348210096359253
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.894 Test Loss: 0.287 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2969703674316406
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0033135414123535
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.6937098503112793
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 2.031593084335327
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 2.4265007972717285
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.922 Test Loss: 0.171 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922221).  Saving model ...
Epoch: 33 cost time: 2.6481471061706543
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.311464309692383
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
Validation loss decreased (-0.922221 --> -0.933332).  Saving model ...
Epoch: 35 cost time: 2.2578322887420654
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0530996322631836
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.1584408283233643
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.3066294193267822
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 39 cost time: 2.5313191413879395
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 2.4810309410095215
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.306986093521118
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.939 Test Loss: 0.173 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.081463575363159
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.2221531867980957
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8935964107513428
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.290487289428711
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.939 Test Loss: 0.181 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.2479259967803955
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.3291702270507812
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.956 Test Loss: 0.137 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 2.420578956604004
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.939 Test Loss: 0.166 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.2791810035705566
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.3801963329315186
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 1614342
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7618653774261475
Epoch: 1, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.462 Vali Acc: 0.622 Test Loss: 1.462 Test Acc: 0.622
Validation loss decreased (inf --> -0.622208).  Saving model ...
Epoch: 2 cost time: 1.8477354049682617
Epoch: 2, Steps: 12 | Train Loss: 1.077 Vali Loss: 0.905 Vali Acc: 0.711 Test Loss: 0.905 Test Acc: 0.711
Validation loss decreased (-0.622208 --> -0.711102).  Saving model ...
Epoch: 3 cost time: 1.966294527053833
Epoch: 3, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.624 Vali Acc: 0.700 Test Loss: 0.624 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9070639610290527
Epoch: 4, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.500 Vali Acc: 0.756 Test Loss: 0.500 Test Acc: 0.756
Validation loss decreased (-0.711102 --> -0.755551).  Saving model ...
Epoch: 5 cost time: 1.9481875896453857
Epoch: 5, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.409 Vali Acc: 0.800 Test Loss: 0.409 Test Acc: 0.800
Validation loss decreased (-0.755551 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.9729690551757812
Epoch: 6, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 2.204149007797241
Epoch: 7, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 2.2780888080596924
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.191436290740967
Epoch: 9, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 2.2353110313415527
Epoch: 10, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9269158840179443
Epoch: 11, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.293 Vali Acc: 0.839 Test Loss: 0.293 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0101563930511475
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.101494789123535
Epoch: 13, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.141158103942871
Epoch: 14, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 2.228992223739624
Epoch: 15, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.157747507095337
Epoch: 16, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2624385356903076
Epoch: 17, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.883 Test Loss: 0.226 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.982241153717041
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.8908774852752686
Epoch: 19, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9690766334533691
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1749627590179443
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.9577045440673828
Epoch: 22, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2146217823028564
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.894 Test Loss: 0.226 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1771585941314697
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0876665115356445
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.906 Test Loss: 0.188 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905554).  Saving model ...
Epoch: 26 cost time: 2.0253899097442627
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.895688533782959
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.396238088607788
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3285553455352783
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.1595914363861084
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2854793071746826
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3816442489624023
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2283830642700195
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.922 Test Loss: 0.165 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922221).  Saving model ...
Epoch: 34 cost time: 2.2384252548217773
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.928 Test Loss: 0.154 Test Acc: 0.928
Validation loss decreased (-0.922221 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 2.2272229194641113
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.928 Test Loss: 0.169 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2668392658233643
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.922 Test Loss: 0.170 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.638676166534424
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 2.2355663776397705
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.933 Test Loss: 0.152 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.184403419494629
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.3248791694641113
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.991713523864746
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.939 Test Loss: 0.161 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.283331871032715
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 2.01995849609375
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.922 Test Loss: 0.167 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.126157522201538
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.3073713779449463
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.03098726272583
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.143474817276001
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.9141058921813965
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.8954126834869385
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.0963921546936035
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 1614374
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9097237586975098
Epoch: 1, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.514 Vali Acc: 0.644 Test Loss: 1.514 Test Acc: 0.644
Validation loss decreased (inf --> -0.644429).  Saving model ...
Epoch: 2 cost time: 2.2738568782806396
Epoch: 2, Steps: 12 | Train Loss: 1.174 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.644429 --> -0.699990).  Saving model ...
Epoch: 3 cost time: 2.055427074432373
Epoch: 3, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.9243731498718262
Epoch: 4, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.511 Vali Acc: 0.744 Test Loss: 0.511 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9571490287780762
Epoch: 5, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.445 Vali Acc: 0.789 Test Loss: 0.445 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.7430050373077393
Epoch: 6, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.0925559997558594
Epoch: 7, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.352 Vali Acc: 0.817 Test Loss: 0.352 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.238607883453369
Epoch: 8, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.346 Vali Acc: 0.833 Test Loss: 0.346 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.9622986316680908
Epoch: 9, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8217625617980957
Epoch: 10, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.7869081497192383
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.285 Vali Acc: 0.850 Test Loss: 0.285 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.91245698928833
Epoch: 12, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 2.2082183361053467
Epoch: 13, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.307637929916382
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 2.2315824031829834
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.258 Vali Acc: 0.867 Test Loss: 0.258 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2694334983825684
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.243034839630127
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 2.1668779850006104
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 2.0822255611419678
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8288276195526123
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 2.061154365539551
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9339656829833984
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 2.1031410694122314
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2354516983032227
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3936500549316406
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.287210702896118
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1197690963745117
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.2928810119628906
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3393335342407227
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.2423977851867676
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2249183654785156
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.033003330230713
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.900 Test Loss: 0.218 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1577574
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6725969314575195
Epoch: 1, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.586 Vali Acc: 0.550 Test Loss: 1.586 Test Acc: 0.550
Validation loss decreased (inf --> -0.549984).  Saving model ...
Epoch: 2 cost time: 1.9396281242370605
Epoch: 2, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.167 Vali Acc: 0.661 Test Loss: 1.167 Test Acc: 0.661
Validation loss decreased (-0.549984 --> -0.661099).  Saving model ...
Epoch: 3 cost time: 1.9246492385864258
Epoch: 3, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.806 Vali Acc: 0.706 Test Loss: 0.806 Test Acc: 0.706
Validation loss decreased (-0.661099 --> -0.705547).  Saving model ...
Epoch: 4 cost time: 2.1793644428253174
Epoch: 4, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.603 Vali Acc: 0.739 Test Loss: 0.603 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738883).  Saving model ...
Epoch: 5 cost time: 2.2072672843933105
Epoch: 5, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.511 Vali Acc: 0.767 Test Loss: 0.511 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 2.3308846950531006
Epoch: 6, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.440 Vali Acc: 0.811 Test Loss: 0.440 Test Acc: 0.811
Validation loss decreased (-0.766662 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 2.0554654598236084
Epoch: 7, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.404 Vali Acc: 0.822 Test Loss: 0.404 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.8428912162780762
Epoch: 8, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.9349353313446045
Epoch: 9, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 1.941399335861206
Epoch: 10, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 1.8381142616271973
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.9055039882659912
Epoch: 12, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6734328269958496
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8406410217285156
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9208922386169434
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 2.0614733695983887
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 1.7544758319854736
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.231 Vali Acc: 0.883 Test Loss: 0.231 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 1.8838014602661133
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.8138456344604492
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.235 Vali Acc: 0.867 Test Loss: 0.235 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.272458791732788
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 21 cost time: 2.2891602516174316
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.236 Vali Acc: 0.883 Test Loss: 0.236 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9353523254394531
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 1.9380040168762207
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6824145317077637
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0556750297546387
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 2.1552038192749023
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.900 Test Loss: 0.208 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7073004245758057
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8967480659484863
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8393659591674805
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.900 Test Loss: 0.208 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8663532733917236
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 1.950378656387329
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7369475364685059
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8732540607452393
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8116257190704346
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7309796810150146
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.119321584701538
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5157616138458252
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7448065280914307
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8139300346374512
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.939 Test Loss: 0.168 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 40 cost time: 1.956017017364502
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7578651905059814
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.910292387008667
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.939 Test Loss: 0.243 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9543287754058838
Epoch: 43, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.9612820148468018
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.156813859939575
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.124314308166504
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.8253979682922363
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.9089398384094238
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.9357430934906006
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1549990
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.515937328338623
Epoch: 1, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.639 Vali Acc: 0.372 Test Loss: 1.639 Test Acc: 0.372
Validation loss decreased (inf --> -0.372206).  Saving model ...
Epoch: 2 cost time: 1.6494288444519043
Epoch: 2, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.342 Vali Acc: 0.578 Test Loss: 1.342 Test Acc: 0.578
Validation loss decreased (-0.372206 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 1.6884374618530273
Epoch: 3, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.021 Vali Acc: 0.694 Test Loss: 1.021 Test Acc: 0.694
Validation loss decreased (-0.577764 --> -0.694434).  Saving model ...
Epoch: 4 cost time: 1.8669040203094482
Epoch: 4, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.762 Vali Acc: 0.711 Test Loss: 0.762 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 2.1160125732421875
Epoch: 5, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.632 Vali Acc: 0.728 Test Loss: 0.632 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 2.0958423614501953
Epoch: 6, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.545 Vali Acc: 0.750 Test Loss: 0.545 Test Acc: 0.750
Validation loss decreased (-0.727771 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 2.0969815254211426
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.488 Vali Acc: 0.772 Test Loss: 0.488 Test Acc: 0.772
Validation loss decreased (-0.749995 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.7403018474578857
Epoch: 8, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.7001726627349854
Epoch: 9, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 1.8342862129211426
Epoch: 10, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.373 Vali Acc: 0.806 Test Loss: 0.373 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7866830825805664
Epoch: 11, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.7308599948883057
Epoch: 12, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.319 Vali Acc: 0.867 Test Loss: 0.319 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 1.6612308025360107
Epoch: 13, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.63486909866333
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8284764289855957
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.72792387008667
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7588129043579102
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.272 Vali Acc: 0.856 Test Loss: 0.272 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7799296379089355
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9763174057006836
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.9531769752502441
Epoch: 20, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9390478134155273
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8689696788787842
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0595269203186035
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 2.0641613006591797
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8474013805389404
Epoch: 25, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.794835090637207
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.815967321395874
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7446842193603516
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6997833251953125
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6048007011413574
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 1.558135986328125
Epoch: 31, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6718776226043701
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1002635955810547
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0917210578918457
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9519553184509277
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.912886381149292
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8158550262451172
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.8451910018920898
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9173831939697266
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 40 cost time: 1.8882129192352295
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.939 Test Loss: 0.202 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 41 cost time: 1.8774878978729248
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9316809177398682
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5651116371154785
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6348605155944824
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.7772588729858398
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.696300745010376
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.9656686782836914
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.8706820011138916
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.020689010620117
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.9786722660064697
Epoch: 50, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1531654
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.71616530418396
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.658 Vali Acc: 0.444 Test Loss: 1.658 Test Acc: 0.444
Validation loss decreased (inf --> -0.444428).  Saving model ...
Epoch: 2 cost time: 1.631967306137085
Epoch: 2, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.384 Vali Acc: 0.656 Test Loss: 1.384 Test Acc: 0.656
Validation loss decreased (-0.444428 --> -0.655542).  Saving model ...
Epoch: 3 cost time: 1.5678961277008057
Epoch: 3, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.050 Vali Acc: 0.667 Test Loss: 1.050 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 1.233346939086914
Epoch: 4, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.798 Vali Acc: 0.672 Test Loss: 0.798 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672214).  Saving model ...
Epoch: 5 cost time: 1.947683572769165
Epoch: 5, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.645 Vali Acc: 0.739 Test Loss: 0.645 Test Acc: 0.739
Validation loss decreased (-0.672214 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.8673388957977295
Epoch: 6, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.738882 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 2.0734362602233887
Epoch: 7, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.485 Vali Acc: 0.772 Test Loss: 0.485 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.162191390991211
Epoch: 8, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.438 Vali Acc: 0.794 Test Loss: 0.438 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.9827704429626465
Epoch: 9, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 2.1186816692352295
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 2.076319456100464
Epoch: 11, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 1.9758987426757812
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7913391590118408
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8182008266448975
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7341570854187012
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.79262113571167
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8144340515136719
Epoch: 17, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6906771659851074
Epoch: 18, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.274 Vali Acc: 0.844 Test Loss: 0.274 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8355669975280762
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7232143878936768
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 1.6906037330627441
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.9275217056274414
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.058662176132202
Epoch: 23, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.9363384246826172
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8172352313995361
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6559524536132812
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.9134085178375244
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8861579895019531
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 1.9492504596710205
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.992626428604126
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 1.8652596473693848
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7264165878295898
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.036766529083252
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7528486251831055
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8325588703155518
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6133296489715576
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.552147388458252
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6013751029968262
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8971800804138184
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.9061458110809326
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1531718
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.8020339012146
Epoch: 1, Steps: 12 | Train Loss: 1.196 Vali Loss: 0.726 Vali Acc: 0.733 Test Loss: 0.726 Test Acc: 0.733
Validation loss decreased (inf --> -0.733326).  Saving model ...
Epoch: 2 cost time: 6.06186842918396
Epoch: 2, Steps: 12 | Train Loss: 0.487 Vali Loss: 1.092 Vali Acc: 0.767 Test Loss: 1.092 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766656).  Saving model ...
Epoch: 3 cost time: 6.1501288414001465
Epoch: 3, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.921 Vali Acc: 0.783 Test Loss: 0.921 Test Acc: 0.783
Validation loss decreased (-0.766656 --> -0.783324).  Saving model ...
Epoch: 4 cost time: 6.315152883529663
Epoch: 4, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.983 Vali Acc: 0.789 Test Loss: 0.983 Test Acc: 0.789
Validation loss decreased (-0.783324 --> -0.788879).  Saving model ...
Epoch: 5 cost time: 5.877966403961182
Epoch: 5, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.477 Vali Acc: 0.806 Test Loss: 1.477 Test Acc: 0.806
Validation loss decreased (-0.788879 --> -0.805541).  Saving model ...
Epoch: 6 cost time: 5.750782251358032
Epoch: 6, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.364 Vali Acc: 0.844 Test Loss: 1.364 Test Acc: 0.844
Validation loss decreased (-0.805541 --> -0.844431).  Saving model ...
Epoch: 7 cost time: 5.4100871086120605
Epoch: 7, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.477 Vali Acc: 0.806 Test Loss: 1.477 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.767043113708496
Epoch: 8, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.722 Vali Acc: 0.783 Test Loss: 1.722 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.2611916065216064
Epoch: 9, Steps: 12 | Train Loss: 0.358 Vali Loss: 1.067 Vali Acc: 0.817 Test Loss: 1.067 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.032810926437378
Epoch: 10, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.081 Vali Acc: 0.839 Test Loss: 1.081 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.5427117347717285
Epoch: 11, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.940 Vali Acc: 0.822 Test Loss: 0.940 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.63519024848938
Epoch: 12, Steps: 12 | Train Loss: 0.761 Vali Loss: 2.161 Vali Acc: 0.772 Test Loss: 2.161 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.615052223205566
Epoch: 13, Steps: 12 | Train Loss: 0.609 Vali Loss: 1.896 Vali Acc: 0.794 Test Loss: 1.896 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.14863920211792
Epoch: 14, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.177 Vali Acc: 0.844 Test Loss: 1.177 Test Acc: 0.844
Validation loss decreased (-0.844431 --> -0.844433).  Saving model ...
Epoch: 15 cost time: 5.479779481887817
Epoch: 15, Steps: 12 | Train Loss: 0.511 Vali Loss: 2.293 Vali Acc: 0.833 Test Loss: 2.293 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.604823112487793
Epoch: 16, Steps: 12 | Train Loss: 0.131 Vali Loss: 2.160 Vali Acc: 0.844 Test Loss: 2.160 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.632155656814575
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 1.935 Vali Acc: 0.822 Test Loss: 1.935 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.523791551589966
Epoch: 18, Steps: 12 | Train Loss: 0.255 Vali Loss: 2.674 Vali Acc: 0.822 Test Loss: 2.674 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.739416837692261
Epoch: 19, Steps: 12 | Train Loss: 0.394 Vali Loss: 2.921 Vali Acc: 0.822 Test Loss: 2.921 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.970617294311523
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.826 Vali Acc: 0.861 Test Loss: 1.826 Test Acc: 0.861
Validation loss decreased (-0.844433 --> -0.861093).  Saving model ...
Epoch: 21 cost time: 5.971777677536011
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 2.484 Vali Acc: 0.850 Test Loss: 2.484 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.913399696350098
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.800 Vali Acc: 0.872 Test Loss: 1.800 Test Acc: 0.872
Validation loss decreased (-0.861093 --> -0.872204).  Saving model ...
Epoch: 23 cost time: 5.80623459815979
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.496 Vali Acc: 0.883 Test Loss: 1.496 Test Acc: 0.883
Validation loss decreased (-0.872204 --> -0.883318).  Saving model ...
Epoch: 24 cost time: 6.0052807331085205
Epoch: 24, Steps: 12 | Train Loss: 0.151 Vali Loss: 2.900 Vali Acc: 0.856 Test Loss: 2.900 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.117331266403198
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 2.157 Vali Acc: 0.883 Test Loss: 2.157 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.824816703796387
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 2.376 Vali Acc: 0.856 Test Loss: 2.376 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.8280041217803955
Epoch: 27, Steps: 12 | Train Loss: 0.530 Vali Loss: 2.746 Vali Acc: 0.833 Test Loss: 2.746 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.624122858047485
Epoch: 28, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.519 Vali Acc: 0.900 Test Loss: 1.519 Test Acc: 0.900
Validation loss decreased (-0.883318 --> -0.899985).  Saving model ...
Epoch: 29 cost time: 5.842889785766602
Epoch: 29, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.537 Vali Acc: 0.894 Test Loss: 1.537 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.071398973464966
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.866 Vali Acc: 0.872 Test Loss: 1.866 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.038127183914185
Epoch: 31, Steps: 12 | Train Loss: 0.276 Vali Loss: 3.971 Vali Acc: 0.800 Test Loss: 3.971 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.70131778717041
Epoch: 32, Steps: 12 | Train Loss: 0.273 Vali Loss: 1.966 Vali Acc: 0.883 Test Loss: 1.966 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.698718547821045
Epoch: 33, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.452 Vali Acc: 0.883 Test Loss: 1.452 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.739726543426514
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 2.045 Vali Acc: 0.878 Test Loss: 2.045 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.779598236083984
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 6.126 Vali Acc: 0.794 Test Loss: 6.126 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 5.850166320800781
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 3.950 Vali Acc: 0.833 Test Loss: 3.950 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 5.813525676727295
Epoch: 37, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.670 Vali Acc: 0.867 Test Loss: 1.670 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.466395139694214
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.856 Test Loss: 1.833 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 15841030
model size : 60.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.801939010620117
Epoch: 1, Steps: 12 | Train Loss: 1.189 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
Validation loss decreased (inf --> -0.722216).  Saving model ...
Epoch: 2 cost time: 3.1891465187072754
Epoch: 2, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.543 Vali Acc: 0.772 Test Loss: 0.543 Test Acc: 0.772
Validation loss decreased (-0.722216 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 3.115084171295166
Epoch: 3, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.436 Vali Acc: 0.778 Test Loss: 0.436 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 4 cost time: 3.097134828567505
Epoch: 4, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.469 Vali Acc: 0.794 Test Loss: 0.469 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 3.3677830696105957
Epoch: 5, Steps: 12 | Train Loss: 0.288 Vali Loss: 1.036 Vali Acc: 0.811 Test Loss: 1.036 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811101).  Saving model ...
Epoch: 6 cost time: 2.942904472351074
Epoch: 6, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.384 Vali Acc: 0.839 Test Loss: 0.384 Test Acc: 0.839
Validation loss decreased (-0.811101 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 2.6060245037078857
Epoch: 7, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2812366485595703
Epoch: 8, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.984 Vali Acc: 0.833 Test Loss: 0.984 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.367021083831787
Epoch: 9, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.702 Vali Acc: 0.844 Test Loss: 0.702 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844437).  Saving model ...
Epoch: 10 cost time: 3.3250741958618164
Epoch: 10, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2828023433685303
Epoch: 11, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.443 Vali Acc: 0.911 Test Loss: 0.443 Test Acc: 0.911
Validation loss decreased (-0.844437 --> -0.911107).  Saving model ...
Epoch: 12 cost time: 3.194291353225708
Epoch: 12, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.534461259841919
Epoch: 13, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.564 Vali Acc: 0.878 Test Loss: 0.564 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.47062087059021
Epoch: 14, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.718 Vali Acc: 0.861 Test Loss: 0.718 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5076591968536377
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 1.001 Vali Acc: 0.822 Test Loss: 1.001 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.315249443054199
Epoch: 16, Steps: 12 | Train Loss: 0.333 Vali Loss: 2.755 Vali Acc: 0.789 Test Loss: 2.755 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.604017972946167
Epoch: 17, Steps: 12 | Train Loss: 0.324 Vali Loss: 1.422 Vali Acc: 0.828 Test Loss: 1.422 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3992908000946045
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.280 Vali Acc: 0.850 Test Loss: 1.280 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.622807025909424
Epoch: 19, Steps: 12 | Train Loss: 0.199 Vali Loss: 3.365 Vali Acc: 0.739 Test Loss: 3.365 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.899404525756836
Epoch: 20, Steps: 12 | Train Loss: 0.273 Vali Loss: 2.303 Vali Acc: 0.789 Test Loss: 2.303 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.094919443130493
Epoch: 21, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.182 Vali Acc: 0.861 Test Loss: 1.182 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 14882822
model size : 56.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.851512670516968
Epoch: 1, Steps: 12 | Train Loss: 1.275 Vali Loss: 0.593 Vali Acc: 0.761 Test Loss: 0.593 Test Acc: 0.761
Validation loss decreased (inf --> -0.761105).  Saving model ...
Epoch: 2 cost time: 3.1978843212127686
Epoch: 2, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
Validation loss decreased (-0.761105 --> -0.838886).  Saving model ...
Epoch: 3 cost time: 3.121680498123169
Epoch: 3, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.445 Vali Acc: 0.828 Test Loss: 0.445 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.189115285873413
Epoch: 4, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849996).  Saving model ...
Epoch: 5 cost time: 3.361894369125366
Epoch: 5, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.731 Vali Acc: 0.811 Test Loss: 0.731 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.337364435195923
Epoch: 6, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.262838363647461
Epoch: 7, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3431949615478516
Epoch: 8, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.799 Vali Acc: 0.839 Test Loss: 0.799 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.348924160003662
Epoch: 9, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866662).  Saving model ...
Epoch: 10 cost time: 3.2450997829437256
Epoch: 10, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.588 Vali Acc: 0.839 Test Loss: 0.588 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.421976327896118
Epoch: 11, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2526302337646484
Epoch: 12, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.867 Vali Acc: 0.844 Test Loss: 0.867 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1018283367156982
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
Validation loss decreased (-0.866662 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 3.2314810752868652
Epoch: 14, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2097911834716797
Epoch: 15, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3120553493499756
Epoch: 16, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.294415235519409
Epoch: 17, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.818 Vali Acc: 0.894 Test Loss: 0.818 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3130722045898438
Epoch: 18, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.956 Vali Acc: 0.850 Test Loss: 0.956 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.3581738471984863
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.981 Vali Acc: 0.850 Test Loss: 0.981 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.37016224861145
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.690 Vali Acc: 0.883 Test Loss: 0.690 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.29961895942688
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.070 Vali Acc: 0.867 Test Loss: 1.070 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4154295921325684
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.256 Vali Acc: 0.828 Test Loss: 1.256 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.009530782699585
Epoch: 23, Steps: 12 | Train Loss: 0.381 Vali Loss: 1.298 Vali Acc: 0.867 Test Loss: 1.298 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 14883078
model size : 56.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4987733364105225
Epoch: 1, Steps: 12 | Train Loss: 1.304 Vali Loss: 0.678 Vali Acc: 0.756 Test Loss: 0.678 Test Acc: 0.756
Validation loss decreased (inf --> -0.755549).  Saving model ...
Epoch: 2 cost time: 2.2868494987487793
Epoch: 2, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.467 Vali Acc: 0.772 Test Loss: 0.467 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772218).  Saving model ...
Epoch: 3 cost time: 2.534349203109741
Epoch: 3, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.687 Vali Acc: 0.772 Test Loss: 0.687 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.595844030380249
Epoch: 4, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
Validation loss decreased (-0.772218 --> -0.827772).  Saving model ...
Epoch: 5 cost time: 2.4407706260681152
Epoch: 5, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.686 Vali Acc: 0.806 Test Loss: 0.686 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4587883949279785
Epoch: 6, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.517 Vali Acc: 0.811 Test Loss: 0.517 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.413571357727051
Epoch: 7, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.741 Vali Acc: 0.817 Test Loss: 0.741 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.126878261566162
Epoch: 8, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 2.3336102962493896
Epoch: 9, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.447 Vali Acc: 0.828 Test Loss: 0.447 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.347909688949585
Epoch: 10, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.481 Vali Acc: 0.839 Test Loss: 0.481 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3877665996551514
Epoch: 11, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6297740936279297
Epoch: 12, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7382471561431885
Epoch: 13, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5839030742645264
Epoch: 14, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.5251362323760986
Epoch: 15, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 2.55025315284729
Epoch: 16, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.561089277267456
Epoch: 17, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6008522510528564
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.463958263397217
Epoch: 19, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3422255516052246
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.487 Vali Acc: 0.894 Test Loss: 0.487 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.432342529296875
Epoch: 21, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4847028255462646
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.720712184906006
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.767948865890503
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.883 Test Loss: 0.354 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7304623126983643
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 14588678
model size : 55.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.454092502593994
Epoch: 1, Steps: 12 | Train Loss: 1.438 Vali Loss: 0.794 Vali Acc: 0.722 Test Loss: 0.794 Test Acc: 0.722
Validation loss decreased (inf --> -0.722214).  Saving model ...
Epoch: 2 cost time: 2.3233320713043213
Epoch: 2, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.457 Vali Acc: 0.778 Test Loss: 0.457 Test Acc: 0.778
Validation loss decreased (-0.722214 --> -0.777773).  Saving model ...
Epoch: 3 cost time: 2.5913147926330566
Epoch: 3, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.328 Vali Acc: 0.828 Test Loss: 0.328 Test Acc: 0.828
Validation loss decreased (-0.777773 --> -0.827774).  Saving model ...
Epoch: 4 cost time: 2.4759790897369385
Epoch: 4, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 5 cost time: 2.5209689140319824
Epoch: 5, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.470867156982422
Epoch: 6, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.386 Vali Acc: 0.856 Test Loss: 0.386 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.653813123703003
Epoch: 7, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 8 cost time: 2.3500053882598877
Epoch: 8, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.397824764251709
Epoch: 9, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.503 Vali Acc: 0.839 Test Loss: 0.503 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4512739181518555
Epoch: 10, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3150761127471924
Epoch: 11, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.509453773498535
Epoch: 12, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 2.502558708190918
Epoch: 13, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.037022590637207
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.409 Vali Acc: 0.883 Test Loss: 0.409 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 15 cost time: 2.4387967586517334
Epoch: 15, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.439211845397949
Epoch: 16, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.461 Vali Acc: 0.894 Test Loss: 0.461 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 17 cost time: 2.56197452545166
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 2.4434244632720947
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.323 Vali Acc: 0.872 Test Loss: 0.323 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4885616302490234
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.850 Vali Acc: 0.850 Test Loss: 0.850 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.410348415374756
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.482163429260254
Epoch: 21, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.590291976928711
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 2.632594347000122
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.496 Vali Acc: 0.889 Test Loss: 0.496 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6567795276641846
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 2.721224546432495
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.696 Vali Acc: 0.894 Test Loss: 0.696 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6140713691711426
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4958508014678955
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.894 Test Loss: 0.501 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2476353645324707
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.443 Vali Acc: 0.883 Test Loss: 0.443 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2176339626312256
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.245072364807129
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.348236560821533
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.844 Vali Acc: 0.839 Test Loss: 0.844 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.5159835815429688
Epoch: 32, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.960 Vali Acc: 0.850 Test Loss: 0.960 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.52947735786438
Epoch: 33, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.883 Vali Acc: 0.872 Test Loss: 0.883 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.5928900241851807
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.032 Vali Acc: 0.850 Test Loss: 1.032 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 14404870
model size : 55.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.858985185623169
Epoch: 1, Steps: 12 | Train Loss: 1.429 Vali Loss: 0.908 Vali Acc: 0.756 Test Loss: 0.908 Test Acc: 0.756
Validation loss decreased (inf --> -0.755546).  Saving model ...
Epoch: 2 cost time: 2.349729299545288
Epoch: 2, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.471 Vali Acc: 0.767 Test Loss: 0.471 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766662).  Saving model ...
Epoch: 3 cost time: 2.5049657821655273
Epoch: 3, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 4 cost time: 2.221410036087036
Epoch: 4, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 5 cost time: 2.391702890396118
Epoch: 5, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.326 Vali Acc: 0.822 Test Loss: 0.326 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.155240774154663
Epoch: 6, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 7 cost time: 2.423306703567505
Epoch: 7, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4714853763580322
Epoch: 8, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.369 Vali Acc: 0.878 Test Loss: 0.369 Test Acc: 0.878
Validation loss decreased (-0.849996 --> -0.877774).  Saving model ...
Epoch: 9 cost time: 2.4355714321136475
Epoch: 9, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.398 Vali Acc: 0.867 Test Loss: 0.398 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.28178071975708
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3151869773864746
Epoch: 11, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.235 Vali Acc: 0.878 Test Loss: 0.235 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 2.2548539638519287
Epoch: 12, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2593202590942383
Epoch: 13, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.296 Vali Acc: 0.883 Test Loss: 0.296 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 2.354621171951294
Epoch: 14, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.395 Vali Acc: 0.878 Test Loss: 0.395 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4184086322784424
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 2.4393746852874756
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3577518463134766
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2485973834991455
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.437 Vali Acc: 0.872 Test Loss: 0.437 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4396157264709473
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.894441 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 2.518505096435547
Epoch: 20, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.467 Vali Acc: 0.894 Test Loss: 0.467 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3703815937042236
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3408920764923096
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3832907676696777
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.370 Vali Acc: 0.878 Test Loss: 0.370 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3349416255950928
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.485 Vali Acc: 0.872 Test Loss: 0.485 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.430572986602783
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4658236503601074
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2849643230438232
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.344123125076294
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.524 Vali Acc: 0.894 Test Loss: 0.524 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4514167308807373
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 14258182
model size : 54.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8479747772216797
Epoch: 1, Steps: 12 | Train Loss: 1.489 Vali Loss: 0.944 Vali Acc: 0.739 Test Loss: 0.944 Test Acc: 0.739
Validation loss decreased (inf --> -0.738879).  Saving model ...
Epoch: 2 cost time: 2.1185898780822754
Epoch: 2, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.552 Vali Acc: 0.772 Test Loss: 0.552 Test Acc: 0.772
Validation loss decreased (-0.738879 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 2.2502849102020264
Epoch: 3, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.417 Vali Acc: 0.772 Test Loss: 0.417 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 2.080751657485962
Epoch: 4, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
Validation loss decreased (-0.772218 --> -0.844441).  Saving model ...
Epoch: 5 cost time: 2.4401657581329346
Epoch: 5, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4160706996917725
Epoch: 6, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 7 cost time: 2.268094301223755
Epoch: 7, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.380 Vali Acc: 0.839 Test Loss: 0.380 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3998305797576904
Epoch: 8, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.389 Vali Acc: 0.856 Test Loss: 0.389 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2261173725128174
Epoch: 9, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.290 Vali Acc: 0.828 Test Loss: 0.290 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4651153087615967
Epoch: 10, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.466142416000366
Epoch: 11, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 2.706228017807007
Epoch: 12, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.369 Vali Acc: 0.872 Test Loss: 0.369 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4006097316741943
Epoch: 13, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4207139015197754
Epoch: 14, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.410273551940918
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 2.469528913497925
Epoch: 16, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2560923099517822
Epoch: 17, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2865352630615234
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3480091094970703
Epoch: 19, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.883 Test Loss: 0.245 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3357045650482178
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.502657175064087
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3366100788116455
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.473804473876953
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.4889795780181885
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.6197009086608887
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.440 Vali Acc: 0.906 Test Loss: 0.440 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 14221830
model size : 54.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.623266220092773
Epoch: 1, Steps: 12 | Train Loss: 1.208 Vali Loss: 0.621 Vali Acc: 0.711 Test Loss: 0.621 Test Acc: 0.711
Validation loss decreased (inf --> -0.711105).  Saving model ...
Epoch: 2 cost time: 3.2097008228302
Epoch: 2, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.581 Vali Acc: 0.756 Test Loss: 0.581 Test Acc: 0.756
Validation loss decreased (-0.711105 --> -0.755550).  Saving model ...
Epoch: 3 cost time: 3.1395890712738037
Epoch: 3, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.480 Vali Acc: 0.811 Test Loss: 0.480 Test Acc: 0.811
Validation loss decreased (-0.755550 --> -0.811106).  Saving model ...
Epoch: 4 cost time: 3.1312286853790283
Epoch: 4, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 5 cost time: 3.0456392765045166
Epoch: 5, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.079586982727051
Epoch: 6, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.731 Vali Acc: 0.811 Test Loss: 0.731 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3070261478424072
Epoch: 7, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.363208770751953
Epoch: 8, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
Validation loss decreased (-0.838885 --> -0.905553).  Saving model ...
Epoch: 9 cost time: 3.3468129634857178
Epoch: 9, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.923 Vali Acc: 0.867 Test Loss: 0.923 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.345093250274658
Epoch: 10, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.715 Vali Acc: 0.839 Test Loss: 0.715 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.322352409362793
Epoch: 11, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.385 Vali Acc: 0.878 Test Loss: 0.385 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2910780906677246
Epoch: 12, Steps: 12 | Train Loss: 0.323 Vali Loss: 1.205 Vali Acc: 0.817 Test Loss: 1.205 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.053903341293335
Epoch: 13, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0895042419433594
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.006399154663086
Epoch: 15, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.860 Vali Acc: 0.833 Test Loss: 0.860 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.437386989593506
Epoch: 16, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.412907600402832
Epoch: 17, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.741 Vali Acc: 0.878 Test Loss: 0.741 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.4979143142700195
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 4774790
model size : 18.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5345566272735596
Epoch: 1, Steps: 12 | Train Loss: 1.292 Vali Loss: 0.782 Vali Acc: 0.689 Test Loss: 0.782 Test Acc: 0.689
Validation loss decreased (inf --> -0.688881).  Saving model ...
Epoch: 2 cost time: 1.9338064193725586
Epoch: 2, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.463 Vali Acc: 0.761 Test Loss: 0.463 Test Acc: 0.761
Validation loss decreased (-0.688881 --> -0.761106).  Saving model ...
Epoch: 3 cost time: 2.05641508102417
Epoch: 3, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.410 Vali Acc: 0.828 Test Loss: 0.410 Test Acc: 0.828
Validation loss decreased (-0.761106 --> -0.827774).  Saving model ...
Epoch: 4 cost time: 1.9795827865600586
Epoch: 4, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 5 cost time: 2.0204098224639893
Epoch: 5, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.493 Vali Acc: 0.800 Test Loss: 0.493 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.002318859100342
Epoch: 6, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1578009128570557
Epoch: 7, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.505 Vali Acc: 0.817 Test Loss: 0.505 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.872053623199463
Epoch: 8, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9000592231750488
Epoch: 9, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 2.082954168319702
Epoch: 10, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9296393394470215
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.510 Vali Acc: 0.828 Test Loss: 0.510 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8532252311706543
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.383 Vali Acc: 0.844 Test Loss: 0.383 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.01603627204895
Epoch: 13, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.913435697555542
Epoch: 14, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.410 Vali Acc: 0.867 Test Loss: 0.410 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9999866485595703
Epoch: 15, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.257370710372925
Epoch: 16, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1745574474334717
Epoch: 17, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2009456157684326
Epoch: 18, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.1588339805603027
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.141800880432129
Epoch: 20, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9005506038665771
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0097930431365967
Epoch: 22, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.450 Vali Acc: 0.861 Test Loss: 0.450 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.009448289871216
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.743 Vali Acc: 0.844 Test Loss: 0.743 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9739201068878174
Epoch: 24, Steps: 12 | Train Loss: 0.417 Vali Loss: 1.536 Vali Acc: 0.761 Test Loss: 1.536 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9612560272216797
Epoch: 25, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.605 Vali Acc: 0.894 Test Loss: 0.605 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894438).  Saving model ...
Epoch: 26 cost time: 2.038478136062622
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.570 Vali Acc: 0.883 Test Loss: 0.570 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9696481227874756
Epoch: 27, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.462 Vali Acc: 0.872 Test Loss: 0.462 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9641060829162598
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.173692226409912
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9797565937042236
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9212141036987305
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1075899600982666
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.867 Test Loss: 0.670 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7543320655822754
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.861 Test Loss: 0.681 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.871171474456787
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.861 Test Loss: 0.747 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.0049376487731934
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.861 Test Loss: 0.707 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 4295686
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.913874387741089
Epoch: 1, Steps: 12 | Train Loss: 1.328 Vali Loss: 0.724 Vali Acc: 0.717 Test Loss: 0.724 Test Acc: 0.717
Validation loss decreased (inf --> -0.716659).  Saving model ...
Epoch: 2 cost time: 2.0728342533111572
Epoch: 2, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.475 Vali Acc: 0.800 Test Loss: 0.475 Test Acc: 0.800
Validation loss decreased (-0.716659 --> -0.799995).  Saving model ...
Epoch: 3 cost time: 1.9910118579864502
Epoch: 3, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849996).  Saving model ...
Epoch: 4 cost time: 1.9648947715759277
Epoch: 4, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.390 Vali Acc: 0.822 Test Loss: 0.390 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0663034915924072
Epoch: 5, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.430 Vali Acc: 0.856 Test Loss: 0.430 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 6 cost time: 1.7891032695770264
Epoch: 6, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.696056842803955
Epoch: 7, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7763426303863525
Epoch: 8, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7939441204071045
Epoch: 9, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.708 Vali Acc: 0.833 Test Loss: 0.708 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6948530673980713
Epoch: 10, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 11 cost time: 1.9305152893066406
Epoch: 11, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.10426664352417
Epoch: 12, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9525206089019775
Epoch: 13, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.872 Vali Acc: 0.822 Test Loss: 0.872 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9191410541534424
Epoch: 14, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.912546157836914
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.366 Vali Acc: 0.872 Test Loss: 0.366 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.9917981624603271
Epoch: 16, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877772).  Saving model ...
Epoch: 17 cost time: 2.0799074172973633
Epoch: 17, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.389 Vali Acc: 0.894 Test Loss: 0.389 Test Acc: 0.894
Validation loss decreased (-0.877772 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 2.0470712184906006
Epoch: 18, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.9772334098815918
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.87611722946167
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.966768503189087
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9747498035430908
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.939237117767334
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 1.9082849025726318
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9878716468811035
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1451404094696045
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.883 Test Loss: 0.318 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.89579439163208
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.127736806869507
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0416793823242188
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.196546792984009
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.110442876815796
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.1224873065948486
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0697550773620605
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 4295814
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.819439649581909
Epoch: 1, Steps: 12 | Train Loss: 1.457 Vali Loss: 0.874 Vali Acc: 0.733 Test Loss: 0.874 Test Acc: 0.733
Validation loss decreased (inf --> -0.733325).  Saving model ...
Epoch: 2 cost time: 1.4590904712677002
Epoch: 2, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
Validation loss decreased (-0.733325 --> -0.783328).  Saving model ...
Epoch: 3 cost time: 1.4844684600830078
Epoch: 3, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.407 Vali Acc: 0.800 Test Loss: 0.407 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 1.5957975387573242
Epoch: 4, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 1.5482704639434814
Epoch: 5, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6292693614959717
Epoch: 6, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.4421520233154297
Epoch: 7, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.5120713710784912
Epoch: 8, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.365 Vali Acc: 0.844 Test Loss: 0.365 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4848072528839111
Epoch: 9, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.4916000366210938
Epoch: 10, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.439 Vali Acc: 0.861 Test Loss: 0.439 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.395446538925171
Epoch: 11, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 1.646306037902832
Epoch: 12, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.4075775146484375
Epoch: 13, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5303781032562256
Epoch: 14, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 1.473846197128296
Epoch: 15, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 1.5769717693328857
Epoch: 16, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6194305419921875
Epoch: 17, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.5663847923278809
Epoch: 18, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.664764165878296
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5615530014038086
Epoch: 20, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.6835434436798096
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5183770656585693
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 1.4492413997650146
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4440717697143555
Epoch: 24, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.631 Vali Acc: 0.856 Test Loss: 0.631 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4307382106781006
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.534 Vali Acc: 0.878 Test Loss: 0.534 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3955378532409668
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.406 Vali Acc: 0.883 Test Loss: 0.406 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3834824562072754
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3571906089782715
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5390024185180664
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5848498344421387
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.325 Vali Acc: 0.928 Test Loss: 0.325 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927775).  Saving model ...
Epoch: 31 cost time: 1.6568248271942139
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6099560260772705
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 33 cost time: 1.6053190231323242
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.553525447845459
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.511 Vali Acc: 0.906 Test Loss: 0.511 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5063655376434326
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5801947116851807
Epoch: 36, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5283699035644531
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.517 Vali Acc: 0.911 Test Loss: 0.517 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5093989372253418
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5659143924713135
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.917 Test Loss: 0.449 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3611507415771484
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5919394493103027
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4891016483306885
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 4148614
model size : 15.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.169205665588379
Epoch: 1, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (inf --> -0.649990).  Saving model ...
Epoch: 2 cost time: 1.322904109954834
Epoch: 2, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
Validation loss decreased (-0.649990 --> -0.761105).  Saving model ...
Epoch: 3 cost time: 1.4130876064300537
Epoch: 3, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.466 Vali Acc: 0.767 Test Loss: 0.466 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 1.4294006824493408
Epoch: 4, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.358 Vali Acc: 0.839 Test Loss: 0.358 Test Acc: 0.839
Validation loss decreased (-0.766662 --> -0.838885).  Saving model ...
Epoch: 5 cost time: 1.5133061408996582
Epoch: 5, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 6 cost time: 1.5720720291137695
Epoch: 6, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.404 Vali Acc: 0.822 Test Loss: 0.404 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5541021823883057
Epoch: 7, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.377 Vali Acc: 0.844 Test Loss: 0.377 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6430749893188477
Epoch: 8, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.564791202545166
Epoch: 9, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.439 Vali Acc: 0.811 Test Loss: 0.439 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6020212173461914
Epoch: 10, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5636096000671387
Epoch: 11, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.50654935836792
Epoch: 12, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.4668898582458496
Epoch: 13, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872218).  Saving model ...
Epoch: 14 cost time: 1.515441656112671
Epoch: 14, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.872218 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 1.5636630058288574
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4390735626220703
Epoch: 16, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.488070011138916
Epoch: 17, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.362515926361084
Epoch: 18, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 1.460092306137085
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6713180541992188
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5731122493743896
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6562952995300293
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5783920288085938
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5638940334320068
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5718929767608643
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5233042240142822
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5634667873382568
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5712392330169678
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.883 Test Loss: 0.242 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 4056710
model size : 15.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.935511350631714
Epoch: 1, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
Validation loss decreased (inf --> -0.699988).  Saving model ...
Epoch: 2 cost time: 1.420095682144165
Epoch: 2, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.629 Vali Acc: 0.711 Test Loss: 0.629 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711105).  Saving model ...
Epoch: 3 cost time: 1.4607677459716797
Epoch: 3, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.442 Vali Acc: 0.811 Test Loss: 0.442 Test Acc: 0.811
Validation loss decreased (-0.711105 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 1.5024302005767822
Epoch: 4, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.374 Vali Acc: 0.844 Test Loss: 0.374 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 5 cost time: 1.4329252243041992
Epoch: 5, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 6 cost time: 1.408463716506958
Epoch: 6, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.373 Vali Acc: 0.811 Test Loss: 0.373 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4169094562530518
Epoch: 7, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.422 Vali Acc: 0.828 Test Loss: 0.422 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4898061752319336
Epoch: 8, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 1.382059097290039
Epoch: 9, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.396122694015503
Epoch: 10, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3396954536437988
Epoch: 11, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3933265209197998
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
Validation loss decreased (-0.855553 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 1.446352243423462
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4164390563964844
Epoch: 14, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4596257209777832
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5126070976257324
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5168263912200928
Epoch: 17, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.238 Vali Acc: 0.867 Test Loss: 0.238 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5128214359283447
Epoch: 18, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.203 Vali Acc: 0.911 Test Loss: 0.203 Test Acc: 0.911
Validation loss decreased (-0.883331 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 1.544870376586914
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3568840026855469
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.45926833152771
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3793199062347412
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.255 Vali Acc: 0.867 Test Loss: 0.255 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4415693283081055
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.365356206893921
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 1.5710878372192383
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.917 Test Loss: 0.170 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 1.5566675662994385
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3799586296081543
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.906 Test Loss: 0.181 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5002267360687256
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5148577690124512
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.911 Test Loss: 0.184 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4614777565002441
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.394836187362671
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3905854225158691
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3068933486938477
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4072620868682861
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3896980285644531
Epoch: 35, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 3983366
model size : 15.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8745205402374268
Epoch: 1, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.185 Vali Acc: 0.617 Test Loss: 1.185 Test Acc: 0.617
Validation loss decreased (inf --> -0.616655).  Saving model ...
Epoch: 2 cost time: 1.450463056564331
Epoch: 2, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.633 Vali Acc: 0.772 Test Loss: 0.633 Test Acc: 0.772
Validation loss decreased (-0.616655 --> -0.772216).  Saving model ...
Epoch: 3 cost time: 1.3960139751434326
Epoch: 3, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.482 Vali Acc: 0.794 Test Loss: 0.482 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 1.4520432949066162
Epoch: 4, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.421 Vali Acc: 0.806 Test Loss: 0.421 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.3876769542694092
Epoch: 5, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.437 Vali Acc: 0.817 Test Loss: 0.437 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 6 cost time: 1.4589025974273682
Epoch: 6, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
Validation loss decreased (-0.816662 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 1.4263391494750977
Epoch: 7, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4372880458831787
Epoch: 8, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 1.54266357421875
Epoch: 9, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.4365818500518799
Epoch: 10, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.260 Vali Acc: 0.861 Test Loss: 0.260 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861109).  Saving model ...
Epoch: 11 cost time: 1.4428863525390625
Epoch: 11, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3359782695770264
Epoch: 12, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
Validation loss decreased (-0.861109 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 1.4058291912078857
Epoch: 13, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.4888222217559814
Epoch: 14, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4417681694030762
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5054078102111816
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4253454208374023
Epoch: 17, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.284 Vali Acc: 0.844 Test Loss: 0.284 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.502537727355957
Epoch: 18, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.236 Vali Acc: 0.889 Test Loss: 0.236 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 19 cost time: 1.4774417877197266
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
Validation loss decreased (-0.888887 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 1.437011480331421
Epoch: 20, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.247 Vali Acc: 0.878 Test Loss: 0.247 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.408557415008545
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.4437637329101562
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.405 Vali Acc: 0.894 Test Loss: 0.405 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4474623203277588
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.250 Vali Acc: 0.867 Test Loss: 0.250 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.368683099746704
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.161 Vali Acc: 0.922 Test Loss: 0.161 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922221).  Saving model ...
Epoch: 25 cost time: 1.4798831939697266
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.894 Test Loss: 0.193 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.435025691986084
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.911 Test Loss: 0.184 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4710988998413086
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.933 Test Loss: 0.143 Test Acc: 0.933
Validation loss decreased (-0.922221 --> -0.933332).  Saving model ...
Epoch: 28 cost time: 1.3718643188476562
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.928 Test Loss: 0.159 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4522292613983154
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.922 Test Loss: 0.179 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3815743923187256
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.911 Test Loss: 0.155 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3919649124145508
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.917 Test Loss: 0.146 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.419795036315918
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.928 Test Loss: 0.158 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4547441005706787
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.427595615386963
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.559962272644043
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.567354440689087
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.5286478996276855
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 3965190
model size : 15.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7778570652008057
Epoch: 1, Steps: 12 | Train Loss: 1.380 Vali Loss: 0.733 Vali Acc: 0.722 Test Loss: 0.733 Test Acc: 0.722
Validation loss decreased (inf --> -0.722215).  Saving model ...
Epoch: 2 cost time: 2.211063861846924
Epoch: 2, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.534 Vali Acc: 0.772 Test Loss: 0.534 Test Acc: 0.772
Validation loss decreased (-0.722215 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 2.2897958755493164
Epoch: 3, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.504 Vali Acc: 0.817 Test Loss: 0.504 Test Acc: 0.817
Validation loss decreased (-0.772217 --> -0.816662).  Saving model ...
Epoch: 4 cost time: 2.218674421310425
Epoch: 4, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.544 Vali Acc: 0.794 Test Loss: 0.544 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2218968868255615
Epoch: 5, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.484 Vali Acc: 0.789 Test Loss: 0.484 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2782413959503174
Epoch: 6, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.556 Vali Acc: 0.806 Test Loss: 0.556 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.309828519821167
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
Validation loss decreased (-0.816662 --> -0.855550).  Saving model ...
Epoch: 8 cost time: 2.298825979232788
Epoch: 8, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2118406295776367
Epoch: 9, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1823081970214844
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.479 Vali Acc: 0.828 Test Loss: 0.479 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.319347381591797
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.468 Vali Acc: 0.811 Test Loss: 0.468 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2345948219299316
Epoch: 12, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.254927635192871
Epoch: 13, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.22870135307312
Epoch: 14, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.271921396255493
Epoch: 15, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2025973796844482
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.490 Vali Acc: 0.828 Test Loss: 0.490 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.211569309234619
Epoch: 17, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 1600966
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1696364879608154
Epoch: 1, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (inf --> -0.699990).  Saving model ...
Epoch: 2 cost time: 1.8337507247924805
Epoch: 2, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.558 Vali Acc: 0.739 Test Loss: 0.558 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 1.7987124919891357
Epoch: 3, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.411 Vali Acc: 0.783 Test Loss: 0.411 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.8056960105895996
Epoch: 4, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.429 Vali Acc: 0.806 Test Loss: 0.429 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.7923927307128906
Epoch: 5, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.358 Vali Acc: 0.800 Test Loss: 0.358 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.811011552810669
Epoch: 6, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.86734938621521
Epoch: 7, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.471 Vali Acc: 0.811 Test Loss: 0.471 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.804875373840332
Epoch: 8, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.526 Vali Acc: 0.817 Test Loss: 0.526 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9776551723480225
Epoch: 9, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.8275063037872314
Epoch: 10, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.8234810829162598
Epoch: 11, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 1.6890637874603271
Epoch: 12, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5639734268188477
Epoch: 13, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 14 cost time: 1.7143287658691406
Epoch: 14, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6532714366912842
Epoch: 15, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.289 Vali Acc: 0.844 Test Loss: 0.289 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7608418464660645
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 1.7376987934112549
Epoch: 17, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7285270690917969
Epoch: 18, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.253 Vali Acc: 0.883 Test Loss: 0.253 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 19 cost time: 1.7421975135803223
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6836905479431152
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.8443539142608643
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7748868465423584
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7591257095336914
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7781500816345215
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7106003761291504
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8617558479309082
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 1.7354776859283447
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7496488094329834
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.943183183670044
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7094054222106934
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 1.7802205085754395
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 1.7892577648162842
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 33 cost time: 1.769798755645752
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.770448923110962
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7362489700317383
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7514116764068604
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.8309509754180908
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7816946506500244
Epoch: 38, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.417 Vali Acc: 0.872 Test Loss: 0.417 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.8699150085449219
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.399 Vali Acc: 0.878 Test Loss: 0.399 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.793686866760254
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.428 Vali Acc: 0.872 Test Loss: 0.428 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.8388521671295166
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.878 Test Loss: 0.387 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.7525343894958496
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 1361414
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.518044948577881
Epoch: 1, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.002 Vali Acc: 0.722 Test Loss: 1.002 Test Acc: 0.722
Validation loss decreased (inf --> -0.722212).  Saving model ...
Epoch: 2 cost time: 1.81880521774292
Epoch: 2, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.544 Vali Acc: 0.778 Test Loss: 0.544 Test Acc: 0.778
Validation loss decreased (-0.722212 --> -0.777772).  Saving model ...
Epoch: 3 cost time: 1.795712947845459
Epoch: 3, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.449 Vali Acc: 0.772 Test Loss: 0.449 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7303574085235596
Epoch: 4, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.371 Vali Acc: 0.800 Test Loss: 0.371 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 1.745591163635254
Epoch: 5, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.7570581436157227
Epoch: 6, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.402 Vali Acc: 0.822 Test Loss: 0.402 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.7095332145690918
Epoch: 7, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.7996199131011963
Epoch: 8, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.8187742233276367
Epoch: 9, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.374 Vali Acc: 0.856 Test Loss: 0.374 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.76668119430542
Epoch: 10, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.265 Vali Acc: 0.867 Test Loss: 0.265 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 1.931548833847046
Epoch: 11, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9045381546020508
Epoch: 12, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.372 Vali Acc: 0.861 Test Loss: 0.372 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8748977184295654
Epoch: 13, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.9347865581512451
Epoch: 14, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7576932907104492
Epoch: 15, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6774976253509521
Epoch: 16, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.7138700485229492
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 1.805074691772461
Epoch: 18, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.365 Vali Acc: 0.878 Test Loss: 0.365 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7705941200256348
Epoch: 19, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.7101879119873047
Epoch: 20, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.382 Vali Acc: 0.856 Test Loss: 0.382 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8123865127563477
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7560102939605713
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6100139617919922
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 1.6066670417785645
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6391668319702148
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6430814266204834
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7163267135620117
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8539068698883057
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8830645084381104
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8537137508392334
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8306572437286377
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8190712928771973
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8471739292144775
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1361478
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0988056659698486
Epoch: 1, Steps: 12 | Train Loss: 1.582 Vali Loss: 1.170 Vali Acc: 0.706 Test Loss: 1.170 Test Acc: 0.706
Validation loss decreased (inf --> -0.705544).  Saving model ...
Epoch: 2 cost time: 1.3803105354309082
Epoch: 2, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.596 Vali Acc: 0.761 Test Loss: 0.596 Test Acc: 0.761
Validation loss decreased (-0.705544 --> -0.761105).  Saving model ...
Epoch: 3 cost time: 1.4812238216400146
Epoch: 3, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.462 Vali Acc: 0.772 Test Loss: 0.462 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 1.4499118328094482
Epoch: 4, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.4809949398040771
Epoch: 5, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
Validation loss decreased (-0.811107 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 1.4603767395019531
Epoch: 6, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6267180442810059
Epoch: 7, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5119154453277588
Epoch: 8, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 1.636277675628662
Epoch: 9, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4263195991516113
Epoch: 10, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5908706188201904
Epoch: 11, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4238598346710205
Epoch: 12, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.401646614074707
Epoch: 13, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.508774757385254
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.254 Vali Acc: 0.867 Test Loss: 0.254 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4287502765655518
Epoch: 15, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5091111660003662
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.530545949935913
Epoch: 17, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.244 Vali Acc: 0.883 Test Loss: 0.244 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4231822490692139
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.440 Vali Acc: 0.889 Test Loss: 0.440 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.485957384109497
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.4704222679138184
Epoch: 20, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.559605360031128
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5465452671051025
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.521770715713501
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.233 Vali Acc: 0.878 Test Loss: 0.233 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4008667469024658
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.894 Test Loss: 0.220 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5166926383972168
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 1.0410959720611572
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.883 Test Loss: 0.229 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5046429634094238
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4085626602172852
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 1.5192162990570068
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.911 Test Loss: 0.180 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3709444999694824
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4980177879333496
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.906 Test Loss: 0.185 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5547380447387695
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4972245693206787
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.57027006149292
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.917 Test Loss: 0.164 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.64913010597229
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6018757820129395
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5940768718719482
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 1.4954969882965088
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.922 Test Loss: 0.174 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5418176651000977
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.928 Test Loss: 0.175 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6610729694366455
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 1.5384035110473633
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.457491397857666
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.586376667022705
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4636542797088623
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6235804557800293
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.5847501754760742
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.5811452865600586
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4462928771972656
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.922 Test Loss: 0.178 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5400841236114502
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4796745777130127
Epoch: 50, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.171 Vali Acc: 0.922 Test Loss: 0.171 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1287878
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.013302803039551
Epoch: 1, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.303 Vali Acc: 0.611 Test Loss: 1.303 Test Acc: 0.611
Validation loss decreased (inf --> -0.611098).  Saving model ...
Epoch: 2 cost time: 1.3431291580200195
Epoch: 2, Steps: 12 | Train Loss: 0.853 Vali Loss: 0.711 Vali Acc: 0.728 Test Loss: 0.711 Test Acc: 0.728
Validation loss decreased (-0.611098 --> -0.727771).  Saving model ...
Epoch: 3 cost time: 1.3258843421936035
Epoch: 3, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
Validation loss decreased (-0.727771 --> -0.788884).  Saving model ...
Epoch: 4 cost time: 1.3677639961242676
Epoch: 4, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.422 Vali Acc: 0.822 Test Loss: 0.422 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 1.403548240661621
Epoch: 5, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.383 Vali Acc: 0.828 Test Loss: 0.383 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.4187588691711426
Epoch: 6, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4151322841644287
Epoch: 7, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.508427381515503
Epoch: 8, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4317545890808105
Epoch: 9, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4393203258514404
Epoch: 10, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.494403600692749
Epoch: 11, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 1.4997048377990723
Epoch: 12, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4516210556030273
Epoch: 13, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 1.395984172821045
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3955879211425781
Epoch: 15, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.4041714668273926
Epoch: 16, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3987252712249756
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 1.4252328872680664
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4688172340393066
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.5072870254516602
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.409287452697754
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.62522554397583
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.5759062767028809
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5086421966552734
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.424760341644287
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905554).  Saving model ...
Epoch: 26 cost time: 1.4297595024108887
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.911 Test Loss: 0.186 Test Acc: 0.911
Validation loss decreased (-0.905554 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 1.38307523727417
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3461642265319824
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3628582954406738
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.889 Test Loss: 0.200 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3700661659240723
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.894 Test Loss: 0.212 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.324178695678711
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.334984540939331
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.883 Test Loss: 0.208 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3396494388580322
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.372706413269043
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.906 Test Loss: 0.178 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3049592971801758
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3311803340911865
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1241926
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.115238666534424
Epoch: 1, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.446 Vali Acc: 0.572 Test Loss: 1.446 Test Acc: 0.572
Validation loss decreased (inf --> -0.572208).  Saving model ...
Epoch: 2 cost time: 1.3758995532989502
Epoch: 2, Steps: 12 | Train Loss: 0.997 Vali Loss: 0.844 Vali Acc: 0.733 Test Loss: 0.844 Test Acc: 0.733
Validation loss decreased (-0.572208 --> -0.733325).  Saving model ...
Epoch: 3 cost time: 1.1101346015930176
Epoch: 3, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.594 Vali Acc: 0.744 Test Loss: 0.594 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.4515724182128906
Epoch: 4, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.466 Vali Acc: 0.778 Test Loss: 0.466 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 1.3826117515563965
Epoch: 5, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.406 Vali Acc: 0.800 Test Loss: 0.406 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.3612449169158936
Epoch: 6, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.4366278648376465
Epoch: 7, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3775391578674316
Epoch: 8, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.364166259765625
Epoch: 9, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.342 Vali Acc: 0.844 Test Loss: 0.342 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.417306661605835
Epoch: 10, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.301 Vali Acc: 0.833 Test Loss: 0.301 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.304311990737915
Epoch: 11, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.307 Vali Acc: 0.839 Test Loss: 0.307 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4735996723175049
Epoch: 12, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.2786502838134766
Epoch: 13, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4423632621765137
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.3507497310638428
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4109954833984375
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.315 Vali Acc: 0.833 Test Loss: 0.315 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2659153938293457
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 1.459836721420288
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.3832247257232666
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.284 Vali Acc: 0.844 Test Loss: 0.284 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.444166660308838
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.4658958911895752
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4706087112426758
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.174659013748169
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3548741340637207
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.861 Test Loss: 0.251 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2658805847167969
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.3635883331298828
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 1.242649793624878
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 28 cost time: 1.363361120223999
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 29 cost time: 1.3876211643218994
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.889 Test Loss: 0.209 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.554166555404663
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5149774551391602
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.894 Test Loss: 0.197 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.438014030456543
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 1.5148098468780518
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.167 Vali Acc: 0.922 Test Loss: 0.167 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922221).  Saving model ...
Epoch: 34 cost time: 1.536264181137085
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
Validation loss decreased (-0.922221 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 1.5576744079589844
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4592506885528564
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.900 Test Loss: 0.202 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5454094409942627
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3862218856811523
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4938273429870605
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4820141792297363
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.900 Test Loss: 0.200 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2675795555114746
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.911 Test Loss: 0.192 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.32682204246521
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4116320610046387
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.911 Test Loss: 0.189 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.365307092666626
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.883 Test Loss: 0.193 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 1205254
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.858422040939331
Epoch: 1, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.480 Vali Acc: 0.556 Test Loss: 1.480 Test Acc: 0.556
Validation loss decreased (inf --> -0.555541).  Saving model ...
Epoch: 2 cost time: 1.4384024143218994
Epoch: 2, Steps: 12 | Train Loss: 1.129 Vali Loss: 0.896 Vali Acc: 0.689 Test Loss: 0.896 Test Acc: 0.689
Validation loss decreased (-0.555541 --> -0.688880).  Saving model ...
Epoch: 3 cost time: 1.3881609439849854
Epoch: 3, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
Validation loss decreased (-0.688880 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 1.467846393585205
Epoch: 4, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.507 Vali Acc: 0.767 Test Loss: 0.507 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 1.3272340297698975
Epoch: 5, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.422 Vali Acc: 0.811 Test Loss: 0.422 Test Acc: 0.811
Validation loss decreased (-0.766662 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.477839469909668
Epoch: 6, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.377 Vali Acc: 0.800 Test Loss: 0.377 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3682861328125
Epoch: 7, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.4516103267669678
Epoch: 8, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.4523956775665283
Epoch: 9, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.509415626525879
Epoch: 10, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.522301435470581
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.4240756034851074
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 13 cost time: 1.3605093955993652
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4457173347473145
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 1.3867688179016113
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.259 Vali Acc: 0.872 Test Loss: 0.259 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872220).  Saving model ...
Epoch: 16 cost time: 1.416412353515625
Epoch: 16, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.3882598876953125
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.259 Vali Acc: 0.872 Test Loss: 0.259 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4300825595855713
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.3860905170440674
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4017250537872314
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.244 Vali Acc: 0.867 Test Loss: 0.244 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4944140911102295
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4748096466064453
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.249 Vali Acc: 0.867 Test Loss: 0.249 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.387089729309082
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 24 cost time: 1.3004271984100342
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.205 Vali Acc: 0.900 Test Loss: 0.205 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 1.4498867988586426
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4904296398162842
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 1.4404118061065674
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.883 Test Loss: 0.223 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.389686107635498
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 1.4269390106201172
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.4779067039489746
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3955745697021484
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.900 Test Loss: 0.188 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3987951278686523
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.922 Test Loss: 0.182 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 1.4563264846801758
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.906 Test Loss: 0.157 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.391110897064209
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 1.5117714405059814
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.906 Test Loss: 0.170 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4858942031860352
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.928 Test Loss: 0.173 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4392950534820557
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.906 Test Loss: 0.170 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4201509952545166
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.345001220703125
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.911 Test Loss: 0.160 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2980830669403076
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.922 Test Loss: 0.166 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3893847465515137
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2332470417022705
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.917 Test Loss: 0.159 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1908307075500488
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.917 Test Loss: 0.158 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3982162475585938
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.906 Test Loss: 0.161 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1196166
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.046280860900879
Epoch: 1, Steps: 12 | Train Loss: 1.423 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (inf --> -0.722212).  Saving model ...
Epoch: 2 cost time: 1.7702116966247559
Epoch: 2, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.518 Vali Acc: 0.750 Test Loss: 0.518 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749995).  Saving model ...
Epoch: 3 cost time: 1.8945538997650146
Epoch: 3, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.458 Vali Acc: 0.783 Test Loss: 0.458 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.6529324054718018
Epoch: 4, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.400 Vali Acc: 0.789 Test Loss: 0.400 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 1.9068303108215332
Epoch: 5, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.416 Vali Acc: 0.800 Test Loss: 0.416 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.884326696395874
Epoch: 6, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 1.8352417945861816
Epoch: 7, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.010958194732666
Epoch: 8, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.466 Vali Acc: 0.811 Test Loss: 0.466 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.902240514755249
Epoch: 9, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.524 Vali Acc: 0.806 Test Loss: 0.524 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9499115943908691
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.604 Vali Acc: 0.811 Test Loss: 0.604 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7679548263549805
Epoch: 11, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
Validation loss decreased (-0.822219 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.9153623580932617
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6075847148895264
Epoch: 13, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.861108 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 1.5528619289398193
Epoch: 14, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.485642910003662
Epoch: 15, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4690618515014648
Epoch: 16, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7141048908233643
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.412 Vali Acc: 0.883 Test Loss: 0.412 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6504130363464355
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7595272064208984
Epoch: 19, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7474558353424072
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.974635124206543
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7083027362823486
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8482975959777832
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 603878
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0591204166412354
Epoch: 1, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.338 Vali Acc: 0.683 Test Loss: 1.338 Test Acc: 0.683
Validation loss decreased (inf --> -0.683320).  Saving model ...
Epoch: 2 cost time: 1.5946359634399414
Epoch: 2, Steps: 12 | Train Loss: 0.863 Vali Loss: 0.755 Vali Acc: 0.706 Test Loss: 0.755 Test Acc: 0.706
Validation loss decreased (-0.683320 --> -0.705548).  Saving model ...
Epoch: 3 cost time: 1.7069838047027588
Epoch: 3, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.553 Vali Acc: 0.744 Test Loss: 0.553 Test Acc: 0.744
Validation loss decreased (-0.705548 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.5214087963104248
Epoch: 4, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.461 Vali Acc: 0.817 Test Loss: 0.461 Test Acc: 0.817
Validation loss decreased (-0.744439 --> -0.816662).  Saving model ...
Epoch: 5 cost time: 1.6929376125335693
Epoch: 5, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.419 Vali Acc: 0.811 Test Loss: 0.419 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.656872034072876
Epoch: 6, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.7606780529022217
Epoch: 7, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 1.6080124378204346
Epoch: 8, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6959788799285889
Epoch: 9, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.397104263305664
Epoch: 10, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.336 Vali Acc: 0.800 Test Loss: 0.336 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2148363590240479
Epoch: 11, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.278395652770996
Epoch: 12, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.358 Vali Acc: 0.828 Test Loss: 0.358 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2420940399169922
Epoch: 13, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.1957433223724365
Epoch: 14, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4339253902435303
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.431445837020874
Epoch: 16, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4648423194885254
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.679234504699707
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.747040033340454
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7671306133270264
Epoch: 20, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7029991149902344
Epoch: 21, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.6559593677520752
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5923206806182861
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.655717372894287
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.867 Test Loss: 0.243 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7089731693267822
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.257 Vali Acc: 0.878 Test Loss: 0.257 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5810675621032715
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7798035144805908
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 1.6079058647155762
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.872 Test Loss: 0.243 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5936341285705566
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.531696081161499
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4506416320800781
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5692243576049805
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.894 Test Loss: 0.236 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5775532722473145
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6299619674682617
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5303702354431152
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.883 Test Loss: 0.232 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.6082143783569336
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4810445308685303
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 484102
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9169015884399414
Epoch: 1, Steps: 12 | Train Loss: 1.707 Vali Loss: 1.358 Vali Acc: 0.517 Test Loss: 1.358 Test Acc: 0.517
Validation loss decreased (inf --> -0.516653).  Saving model ...
Epoch: 2 cost time: 1.3855342864990234
Epoch: 2, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.704 Vali Acc: 0.728 Test Loss: 0.704 Test Acc: 0.728
Validation loss decreased (-0.516653 --> -0.727771).  Saving model ...
Epoch: 3 cost time: 1.419219970703125
Epoch: 3, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.509 Vali Acc: 0.772 Test Loss: 0.509 Test Acc: 0.772
Validation loss decreased (-0.727771 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 1.5237977504730225
Epoch: 4, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.456 Vali Acc: 0.761 Test Loss: 0.456 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3443715572357178
Epoch: 5, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
Validation loss decreased (-0.772217 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.2085320949554443
Epoch: 6, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.380 Vali Acc: 0.806 Test Loss: 0.380 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.330138921737671
Epoch: 7, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.368 Vali Acc: 0.828 Test Loss: 0.368 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.3176991939544678
Epoch: 8, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.418 Vali Acc: 0.794 Test Loss: 0.418 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2721121311187744
Epoch: 9, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.2793641090393066
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.313 Vali Acc: 0.839 Test Loss: 0.313 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.361881971359253
Epoch: 11, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5489575862884521
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4938080310821533
Epoch: 13, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4244475364685059
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.331772804260254
Epoch: 15, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.422839641571045
Epoch: 16, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.295522689819336
Epoch: 17, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.2230234146118164
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.19022798538208
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.1564035415649414
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.176853895187378
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.1824634075164795
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.3709759712219238
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4523003101348877
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6579890251159668
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.471541166305542
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 1.3996071815490723
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4858105182647705
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5146658420562744
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 30 cost time: 1.4176244735717773
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3990256786346436
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 1.2996494770050049
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3385307788848877
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5106873512268066
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2707288265228271
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5064899921417236
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.894 Test Loss: 0.210 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3139491081237793
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.894 Test Loss: 0.211 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3431947231292725
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.390366792678833
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 1.354034662246704
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4561703205108643
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3041644096374512
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 1.1655783653259277
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.248692274093628
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.202298641204834
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2494981288909912
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 47 cost time: 1.1121766567230225
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.216522216796875
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3589608669281006
Epoch: 49, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.3494205474853516
Epoch: 50, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 484134
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7048325538635254
Epoch: 1, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.393 Vali Acc: 0.594 Test Loss: 1.393 Test Acc: 0.594
Validation loss decreased (inf --> -0.594431).  Saving model ...
Epoch: 2 cost time: 1.2260196208953857
Epoch: 2, Steps: 12 | Train Loss: 0.968 Vali Loss: 0.836 Vali Acc: 0.706 Test Loss: 0.836 Test Acc: 0.706
Validation loss decreased (-0.594431 --> -0.705547).  Saving model ...
Epoch: 3 cost time: 1.2241945266723633
Epoch: 3, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.576 Vali Acc: 0.744 Test Loss: 0.576 Test Acc: 0.744
Validation loss decreased (-0.705547 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.4629628658294678
Epoch: 4, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.483 Vali Acc: 0.778 Test Loss: 0.483 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 1.373114824295044
Epoch: 5, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.418 Vali Acc: 0.800 Test Loss: 0.418 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.3082525730133057
Epoch: 6, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.399 Vali Acc: 0.806 Test Loss: 0.399 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.249680757522583
Epoch: 7, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.4842009544372559
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 1.68638277053833
Epoch: 9, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.347 Vali Acc: 0.817 Test Loss: 0.347 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.497718095779419
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5431981086730957
Epoch: 11, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.3702292442321777
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.325 Vali Acc: 0.817 Test Loss: 0.325 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.44708251953125
Epoch: 13, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.313 Vali Acc: 0.839 Test Loss: 0.313 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.422614336013794
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.353170394897461
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5418081283569336
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.464740514755249
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.584106206893921
Epoch: 18, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5831289291381836
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.5608630180358887
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.6223347187042236
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 1.6770718097686768
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.273 Vali Acc: 0.850 Test Loss: 0.273 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7348213195800781
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.267 Vali Acc: 0.856 Test Loss: 0.267 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.437608003616333
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7572476863861084
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.269 Vali Acc: 0.856 Test Loss: 0.269 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4569385051727295
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.878 Test Loss: 0.242 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4994289875030518
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.883 Test Loss: 0.224 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 28 cost time: 1.5586764812469482
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 1.6023838520050049
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.209 Vali Acc: 0.889 Test Loss: 0.209 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6319301128387451
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6649205684661865
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.237 Vali Acc: 0.872 Test Loss: 0.237 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7182278633117676
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 1.4492592811584473
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4075360298156738
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.878 Test Loss: 0.217 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1923046112060547
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.894 Test Loss: 0.218 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3468492031097412
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.900 Test Loss: 0.211 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3944480419158936
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2420659065246582
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.900 Test Loss: 0.202 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4001367092132568
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.911 Test Loss: 0.191 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.368891954421997
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5937321186065674
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.917 Test Loss: 0.170 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.562793254852295
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 43 cost time: 1.5443682670593262
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4393489360809326
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.911 Test Loss: 0.192 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.632312297821045
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.911 Test Loss: 0.173 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.6844367980957031
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.7314352989196777
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.900 Test Loss: 0.175 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.7288565635681152
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.928 Test Loss: 0.168 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 49 cost time: 1.4022717475891113
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.928 Test Loss: 0.166 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 50 cost time: 1.6827523708343506
Epoch: 50, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 447334
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.265273332595825
Epoch: 1, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.363 Vali Acc: 0.667 Test Loss: 1.363 Test Acc: 0.667
Validation loss decreased (inf --> -0.666653).  Saving model ...
Epoch: 2 cost time: 1.404299259185791
Epoch: 2, Steps: 12 | Train Loss: 1.112 Vali Loss: 0.888 Vali Acc: 0.733 Test Loss: 0.888 Test Acc: 0.733
Validation loss decreased (-0.666653 --> -0.733324).  Saving model ...
Epoch: 3 cost time: 1.5125021934509277
Epoch: 3, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.652 Vali Acc: 0.739 Test Loss: 0.652 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 1.3610942363739014
Epoch: 4, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.545 Vali Acc: 0.756 Test Loss: 0.545 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.5835604667663574
Epoch: 5, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.476 Vali Acc: 0.783 Test Loss: 0.476 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.2657058238983154
Epoch: 6, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.443 Vali Acc: 0.806 Test Loss: 0.443 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 1.5117549896240234
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 1.3929274082183838
Epoch: 8, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5814919471740723
Epoch: 9, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.5030736923217773
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.6396684646606445
Epoch: 11, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.4859075546264648
Epoch: 12, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4946610927581787
Epoch: 13, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.345 Vali Acc: 0.844 Test Loss: 0.345 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3942804336547852
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4025709629058838
Epoch: 15, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 1.6048579216003418
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.289 Vali Acc: 0.839 Test Loss: 0.289 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4113233089447021
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.616576910018921
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4270195960998535
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 1.540717363357544
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 1.4881892204284668
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7448523044586182
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 1.484339714050293
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 24 cost time: 1.2418792247772217
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.3473248481750488
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4774243831634521
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 1.5488388538360596
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.861 Test Loss: 0.231 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4794554710388184
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 29 cost time: 1.5801267623901367
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5179803371429443
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 31 cost time: 1.5954453945159912
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6925196647644043
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.346 Vali Acc: 0.872 Test Loss: 0.346 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.718264102935791
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 34 cost time: 1.6534180641174316
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.894 Test Loss: 0.212 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7114017009735107
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 36 cost time: 1.5646898746490479
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4675405025482178
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.720329999923706
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 1.5556228160858154
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.470750331878662
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7375884056091309
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.894 Test Loss: 0.208 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7645635604858398
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7274916172027588
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.900 Test Loss: 0.191 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.8316264152526855
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6712932586669922
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.6462750434875488
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.5107061862945557
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.906 Test Loss: 0.181 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.6018242835998535
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 1.4133961200714111
Epoch: 49, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2044777870178223
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.911 Test Loss: 0.183 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 424358
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4539098739624023
Epoch: 1, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.550 Vali Acc: 0.450 Test Loss: 1.550 Test Acc: 0.450
Validation loss decreased (inf --> -0.449984).  Saving model ...
Epoch: 2 cost time: 0.9475235939025879
Epoch: 2, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.099 Vali Acc: 0.683 Test Loss: 1.099 Test Acc: 0.683
Validation loss decreased (-0.449984 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 1.1994318962097168
Epoch: 3, Steps: 12 | Train Loss: 0.894 Vali Loss: 0.780 Vali Acc: 0.722 Test Loss: 0.780 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722214).  Saving model ...
Epoch: 4 cost time: 1.0220072269439697
Epoch: 4, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.625 Vali Acc: 0.733 Test Loss: 0.625 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733327).  Saving model ...
Epoch: 5 cost time: 1.496781349182129
Epoch: 5, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.526 Vali Acc: 0.772 Test Loss: 0.526 Test Acc: 0.772
Validation loss decreased (-0.733327 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 1.4412355422973633
Epoch: 6, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 1.501051902770996
Epoch: 7, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.458 Vali Acc: 0.778 Test Loss: 0.458 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6380822658538818
Epoch: 8, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.485011100769043
Epoch: 9, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.399 Vali Acc: 0.817 Test Loss: 0.399 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.6445367336273193
Epoch: 10, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.573458194732666
Epoch: 11, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.358 Vali Acc: 0.817 Test Loss: 0.358 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.544022560119629
Epoch: 12, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 1.3914616107940674
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 1.3325660228729248
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5658750534057617
Epoch: 15, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4036881923675537
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4695351123809814
Epoch: 17, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.3854858875274658
Epoch: 18, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.312 Vali Acc: 0.839 Test Loss: 0.312 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3985493183135986
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 1.5425748825073242
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4311909675598145
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7562310695648193
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3423635959625244
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.567988634109497
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.272 Vali Acc: 0.850 Test Loss: 0.272 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3371140956878662
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.370805263519287
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.235 Vali Acc: 0.867 Test Loss: 0.235 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3915624618530273
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3331756591796875
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.5270075798034668
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 30 cost time: 1.4019737243652344
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.211 Vali Acc: 0.878 Test Loss: 0.211 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3240149021148682
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.894 Test Loss: 0.204 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 32 cost time: 1.3402326107025146
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.894 Test Loss: 0.199 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 33 cost time: 1.3413591384887695
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.889 Test Loss: 0.193 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5424301624298096
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.878 Test Loss: 0.194 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3580515384674072
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 36 cost time: 1.5196895599365234
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.181 Vali Acc: 0.906 Test Loss: 0.181 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 37 cost time: 1.3454856872558594
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4921083450317383
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.900 Test Loss: 0.174 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.463531255722046
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.900 Test Loss: 0.175 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4219985008239746
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.894 Test Loss: 0.175 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5262808799743652
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.889 Test Loss: 0.209 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3551251888275146
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.166 Vali Acc: 0.900 Test Loss: 0.166 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.503868818283081
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.911 Test Loss: 0.157 Test Acc: 0.911
Validation loss decreased (-0.905554 --> -0.911110).  Saving model ...
Epoch: 44 cost time: 1.3444194793701172
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.900 Test Loss: 0.161 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.4474213123321533
Epoch: 45, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.5439789295196533
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.889 Test Loss: 0.186 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3381423950195312
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.906 Test Loss: 0.164 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.5742268562316895
Epoch: 48, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.894 Test Loss: 0.209 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4547994136810303
Epoch: 49, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.911110 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 1.592012643814087
Epoch: 50, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.171 Vali Acc: 0.900 Test Loss: 0.171 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 406022
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.190990447998047
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.651 Vali Acc: 0.300 Test Loss: 1.651 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.5061323642730713
Epoch: 2, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.239 Vali Acc: 0.661 Test Loss: 1.239 Test Acc: 0.661
Validation loss decreased (-0.299983 --> -0.661099).  Saving model ...
Epoch: 3 cost time: 1.6534593105316162
Epoch: 3, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.877 Vali Acc: 0.700 Test Loss: 0.877 Test Acc: 0.700
Validation loss decreased (-0.661099 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 1.5104269981384277
Epoch: 4, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.695 Vali Acc: 0.706 Test Loss: 0.695 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705549).  Saving model ...
Epoch: 5 cost time: 1.8807215690612793
Epoch: 5, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.574 Vali Acc: 0.739 Test Loss: 0.574 Test Acc: 0.739
Validation loss decreased (-0.705549 --> -0.738883).  Saving model ...
Epoch: 6 cost time: 1.403923511505127
Epoch: 6, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.506 Vali Acc: 0.756 Test Loss: 0.506 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.6247131824493408
Epoch: 7, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.458 Vali Acc: 0.800 Test Loss: 0.458 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 1.4321582317352295
Epoch: 8, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.434 Vali Acc: 0.822 Test Loss: 0.434 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 1.3180019855499268
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.399 Vali Acc: 0.811 Test Loss: 0.399 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3334429264068604
Epoch: 10, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.4261503219604492
Epoch: 11, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4455840587615967
Epoch: 12, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3844633102416992
Epoch: 13, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4539742469787598
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.3420681953430176
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.4458272457122803
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.2126753330230713
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 1.330502986907959
Epoch: 18, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3147506713867188
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.5458471775054932
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6571061611175537
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.5103576183319092
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5968189239501953
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 24 cost time: 1.5535774230957031
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5644259452819824
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 26 cost time: 1.4828109741210938
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.243 Vali Acc: 0.878 Test Loss: 0.243 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5320632457733154
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4959347248077393
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4958679676055908
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 30 cost time: 1.52341890335083
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.203 Vali Acc: 0.900 Test Loss: 0.203 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 31 cost time: 1.4476006031036377
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.204 Vali Acc: 0.906 Test Loss: 0.204 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 32 cost time: 1.4551477432250977
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4223742485046387
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916665).  Saving model ...
Epoch: 34 cost time: 1.4550423622131348
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4190247058868408
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4001696109771729
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.906 Test Loss: 0.188 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.364985704421997
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3100340366363525
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4752254486083984
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.906 Test Loss: 0.206 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4159901142120361
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5880775451660156
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.906 Test Loss: 0.187 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.385848045349121
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.5698926448822021
Epoch: 43, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 401478
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.445576190948486
Epoch: 1, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.505 Vali Acc: 0.672 Test Loss: 1.505 Test Acc: 0.672
Validation loss decreased (inf --> -0.672207).  Saving model ...
Epoch: 2 cost time: 2.739060640335083
Epoch: 2, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.815 Vali Acc: 0.728 Test Loss: 0.815 Test Acc: 0.728
Validation loss decreased (-0.672207 --> -0.727770).  Saving model ...
Epoch: 3 cost time: 2.6304759979248047
Epoch: 3, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.497 Vali Acc: 0.750 Test Loss: 0.497 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 2.7890617847442627
Epoch: 4, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.404 Vali Acc: 0.817 Test Loss: 0.404 Test Acc: 0.817
Validation loss decreased (-0.749995 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 2.815088987350464
Epoch: 5, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.478 Vali Acc: 0.806 Test Loss: 0.478 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.021423101425171
Epoch: 6, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.557 Vali Acc: 0.778 Test Loss: 0.557 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0553176403045654
Epoch: 7, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 2.762086868286133
Epoch: 8, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.999725818634033
Epoch: 9, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.772122621536255
Epoch: 10, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9224932193756104
Epoch: 11, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8887476921081543
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1795499324798584
Epoch: 13, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 3.089127540588379
Epoch: 14, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.217 Vali Acc: 0.889 Test Loss: 0.217 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 15 cost time: 3.0485823154449463
Epoch: 15, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.045759439468384
Epoch: 16, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.194 Vali Acc: 0.911 Test Loss: 0.194 Test Acc: 0.911
Validation loss decreased (-0.888887 --> -0.911109).  Saving model ...
Epoch: 17 cost time: 2.9128684997558594
Epoch: 17, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.242 Vali Acc: 0.878 Test Loss: 0.242 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.673497438430786
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8359203338623047
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6224920749664307
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 2.5853312015533447
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5330002307891846
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 2.168207883834839
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.585848093032837
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.9077682495117188
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.709376573562622
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1957757472991943
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.124913215637207
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.2086315155029297
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.0825560092926025
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.122751235961914
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.795400381088257
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2992102
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0098021030426025
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.647 Vali Acc: 0.611 Test Loss: 1.647 Test Acc: 0.611
Validation loss decreased (inf --> -0.611095).  Saving model ...
Epoch: 2 cost time: 2.289093494415283
Epoch: 2, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.132 Vali Acc: 0.711 Test Loss: 1.132 Test Acc: 0.711
Validation loss decreased (-0.611095 --> -0.711100).  Saving model ...
Epoch: 3 cost time: 2.540327310562134
Epoch: 3, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
Validation loss decreased (-0.711100 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 2.7180843353271484
Epoch: 4, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.488 Vali Acc: 0.806 Test Loss: 0.488 Test Acc: 0.806
Validation loss decreased (-0.738882 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 2.471742868423462
Epoch: 5, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.395 Vali Acc: 0.811 Test Loss: 0.395 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 2.6129214763641357
Epoch: 6, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.3862414360046387
Epoch: 7, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 2.470064878463745
Epoch: 8, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4548351764678955
Epoch: 9, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5153777599334717
Epoch: 10, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.417994499206543
Epoch: 11, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.861108 --> -0.911109).  Saving model ...
Epoch: 12 cost time: 2.3369486331939697
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.340 Vali Acc: 0.883 Test Loss: 0.340 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.359891414642334
Epoch: 13, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3663625717163086
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.319 Vali Acc: 0.867 Test Loss: 0.319 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.347125291824341
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.22478985786438
Epoch: 16, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4104769229888916
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 2.3378262519836426
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4714722633361816
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5400078296661377
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8066935539245605
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.736769676208496
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6245265007019043
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.53227162361145
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.664151906967163
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 2.466737747192383
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 2.653057336807251
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.497018337249756
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.387765407562256
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.480207920074463
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.4706079959869385
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.242696762084961
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.1878232955932617
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.911 Test Loss: 0.203 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.0973541736602783
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0842339992523193
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.390976905822754
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 37 cost time: 2.5946309566497803
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.455329179763794
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.4012413024902344
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.617396116256714
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.911 Test Loss: 0.179 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.6561901569366455
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.8167831897735596
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.653215169906616
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.6093101501464844
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.4612345695495605
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.4697728157043457
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2881542
model size : 11.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6438071727752686
Epoch: 1, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.587 Vali Acc: 0.633 Test Loss: 1.587 Test Acc: 0.633
Validation loss decreased (inf --> -0.633317).  Saving model ...
Epoch: 2 cost time: 2.4415969848632812
Epoch: 2, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.633317 --> -0.699990).  Saving model ...
Epoch: 3 cost time: 2.642603635787964
Epoch: 3, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.612 Vali Acc: 0.744 Test Loss: 0.612 Test Acc: 0.744
Validation loss decreased (-0.699990 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 2.6681859493255615
Epoch: 4, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.474 Vali Acc: 0.772 Test Loss: 0.474 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.712369918823242
Epoch: 5, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.431 Vali Acc: 0.789 Test Loss: 0.431 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 2.7480554580688477
Epoch: 6, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.3693201541900635
Epoch: 7, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.3695595264434814
Epoch: 8, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5185739994049072
Epoch: 9, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.336 Vali Acc: 0.789 Test Loss: 0.336 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.562474489212036
Epoch: 10, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4899938106536865
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.268 Vali Acc: 0.856 Test Loss: 0.268 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 2.2893905639648438
Epoch: 12, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 2.3344123363494873
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.189577341079712
Epoch: 14, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.490163803100586
Epoch: 15, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3943474292755127
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2382848262786865
Epoch: 17, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.878 Test Loss: 0.229 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.530993938446045
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.220 Vali Acc: 0.883 Test Loss: 0.220 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7807424068450928
Epoch: 19, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 2.776737689971924
Epoch: 20, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 2.824359655380249
Epoch: 21, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7337257862091064
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.563913345336914
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 2.6577792167663574
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7713704109191895
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 2.7593166828155518
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 2.9813499450683594
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.894 Test Loss: 0.219 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5803558826446533
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.455047845840454
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.894 Test Loss: 0.212 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2824764251708984
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.906 Test Loss: 0.195 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2469403743743896
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 2.2962703704833984
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.911 Test Loss: 0.183 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.146838903427124
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.911 Test Loss: 0.186 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.2319552898406982
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.922 Test Loss: 0.187 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 2.5422089099884033
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.906 Test Loss: 0.194 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.4508097171783447
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 37 cost time: 2.433248996734619
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.3896498680114746
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.8243846893310547
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 2.6634762287139893
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.6530392169952393
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.7189948558807373
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.911 Test Loss: 0.188 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.7528140544891357
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 44 cost time: 2.5563528537750244
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.620370864868164
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.911 Test Loss: 0.183 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.341121196746826
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.2806038856506348
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.491497278213501
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.922 Test Loss: 0.169 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.40511155128479
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.544534683227539
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2881574
model size : 11.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.058151960372925
Epoch: 1, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.631 Vali Acc: 0.633 Test Loss: 1.631 Test Acc: 0.633
Validation loss decreased (inf --> -0.633317).  Saving model ...
Epoch: 2 cost time: 2.353661298751831
Epoch: 2, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.194 Vali Acc: 0.739 Test Loss: 1.194 Test Acc: 0.739
Validation loss decreased (-0.633317 --> -0.738877).  Saving model ...
Epoch: 3 cost time: 2.418015241622925
Epoch: 3, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.724 Vali Acc: 0.767 Test Loss: 0.724 Test Acc: 0.767
Validation loss decreased (-0.738877 --> -0.766659).  Saving model ...
Epoch: 4 cost time: 2.393171548843384
Epoch: 4, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.521 Vali Acc: 0.778 Test Loss: 0.521 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 2.485137462615967
Epoch: 5, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.435 Vali Acc: 0.789 Test Loss: 0.435 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 2.327953815460205
Epoch: 6, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.401 Vali Acc: 0.839 Test Loss: 0.401 Test Acc: 0.839
Validation loss decreased (-0.788885 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 2.295334577560425
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.348 Vali Acc: 0.811 Test Loss: 0.348 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.399477958679199
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.089850902557373
Epoch: 9, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.8450665473937988
Epoch: 10, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 2.1549689769744873
Epoch: 11, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 2.3776962757110596
Epoch: 12, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.287 Vali Acc: 0.867 Test Loss: 0.287 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.444042205810547
Epoch: 13, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.254 Vali Acc: 0.867 Test Loss: 0.254 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.601151704788208
Epoch: 14, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.276 Vali Acc: 0.872 Test Loss: 0.276 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5548200607299805
Epoch: 15, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.259 Vali Acc: 0.856 Test Loss: 0.259 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.509223699569702
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.268 Vali Acc: 0.861 Test Loss: 0.268 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5113303661346436
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 2.6192922592163086
Epoch: 18, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 2.6399331092834473
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.741701364517212
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.889 Test Loss: 0.211 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.552286148071289
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905554).  Saving model ...
Epoch: 22 cost time: 2.452298164367676
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.675907850265503
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.435678720474243
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2793452739715576
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 2.263551712036133
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
Validation loss decreased (-0.916663 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 2.152902126312256
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.183868169784546
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.436 Vali Acc: 0.872 Test Loss: 0.436 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.279589891433716
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.198298215866089
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.427 Vali Acc: 0.894 Test Loss: 0.427 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.388701915740967
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.5309712886810303
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.5579910278320312
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.454054832458496
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.3437840938568115
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.6515486240386963
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2844774
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.860534429550171
Epoch: 1, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.658 Vali Acc: 0.522 Test Loss: 1.658 Test Acc: 0.522
Validation loss decreased (inf --> -0.522206).  Saving model ...
Epoch: 2 cost time: 2.209862470626831
Epoch: 2, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.234 Vali Acc: 0.644 Test Loss: 1.234 Test Acc: 0.644
Validation loss decreased (-0.522206 --> -0.644432).  Saving model ...
Epoch: 3 cost time: 2.160651922225952
Epoch: 3, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.837 Vali Acc: 0.706 Test Loss: 0.837 Test Acc: 0.706
Validation loss decreased (-0.644432 --> -0.705547).  Saving model ...
Epoch: 4 cost time: 2.020156145095825
Epoch: 4, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.617 Vali Acc: 0.767 Test Loss: 0.617 Test Acc: 0.767
Validation loss decreased (-0.705547 --> -0.766660).  Saving model ...
Epoch: 5 cost time: 2.2409744262695312
Epoch: 5, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.491 Vali Acc: 0.750 Test Loss: 0.491 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.369537830352783
Epoch: 6, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.399 Vali Acc: 0.856 Test Loss: 0.399 Test Acc: 0.856
Validation loss decreased (-0.766660 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.27445125579834
Epoch: 7, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.377460241317749
Epoch: 8, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.380406618118286
Epoch: 9, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5005600452423096
Epoch: 10, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 2.0185978412628174
Epoch: 11, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 2.027963399887085
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4944286346435547
Epoch: 13, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872220).  Saving model ...
Epoch: 14 cost time: 2.2727270126342773
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.237959861755371
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.1862452030181885
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4004249572753906
Epoch: 17, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 2.2060952186584473
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.225 Vali Acc: 0.883 Test Loss: 0.225 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.099519968032837
Epoch: 19, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.238 Vali Acc: 0.878 Test Loss: 0.238 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.126041889190674
Epoch: 20, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 2.0441062450408936
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 2.126199960708618
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3959577083587646
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.437321186065674
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 2.3746376037597656
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.917 Test Loss: 0.164 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 2.527249813079834
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6219074726104736
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.911 Test Loss: 0.189 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.459768295288086
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 2.5089566707611084
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5543181896209717
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.565721035003662
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.928 Test Loss: 0.203 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 32 cost time: 2.702376365661621
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.6391494274139404
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.499230146408081
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.511765241622925
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.3722920417785645
Epoch: 36, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.281184196472168
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 2.3426990509033203
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3728301525115967
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0612475872039795
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.1812639236450195
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.299 Vali Acc: 0.939 Test Loss: 0.299 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 42 cost time: 2.304582118988037
Epoch: 42, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.238619327545166
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.939 Test Loss: 0.197 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 44 cost time: 2.339822769165039
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.3058090209960938
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.939 Test Loss: 0.192 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 46 cost time: 2.407041549682617
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.5121116638183594
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.6502583026885986
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.334 Vali Acc: 0.922 Test Loss: 0.334 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.644651412963867
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.906 Test Loss: 0.335 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.6270151138305664
Epoch: 50, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2807974
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.885152578353882
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.711 Vali Acc: 0.406 Test Loss: 1.711 Test Acc: 0.406
Validation loss decreased (inf --> -0.405538).  Saving model ...
Epoch: 2 cost time: 2.2965378761291504
Epoch: 2, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.392 Vali Acc: 0.694 Test Loss: 1.392 Test Acc: 0.694
Validation loss decreased (-0.405538 --> -0.694431).  Saving model ...
Epoch: 3 cost time: 2.2225804328918457
Epoch: 3, Steps: 12 | Train Loss: 1.068 Vali Loss: 0.985 Vali Acc: 0.706 Test Loss: 0.985 Test Acc: 0.706
Validation loss decreased (-0.694431 --> -0.705546).  Saving model ...
Epoch: 4 cost time: 2.3476505279541016
Epoch: 4, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.714 Vali Acc: 0.744 Test Loss: 0.714 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 2.31609845161438
Epoch: 5, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.556 Vali Acc: 0.778 Test Loss: 0.556 Test Acc: 0.778
Validation loss decreased (-0.744437 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 2.4228599071502686
Epoch: 6, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 2.2109270095825195
Epoch: 7, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.422 Vali Acc: 0.822 Test Loss: 0.422 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 2.3229899406433105
Epoch: 8, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.377 Vali Acc: 0.828 Test Loss: 0.377 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.2468748092651367
Epoch: 9, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.359 Vali Acc: 0.828 Test Loss: 0.359 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 2.390709638595581
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827775).  Saving model ...
Epoch: 11 cost time: 2.407517671585083
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.827775 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 2.1911873817443848
Epoch: 12, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 2.2458250522613525
Epoch: 13, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 2.0488789081573486
Epoch: 14, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.279 Vali Acc: 0.850 Test Loss: 0.279 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0319299697875977
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 2.014235258102417
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.253 Vali Acc: 0.878 Test Loss: 0.253 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 2.0108516216278076
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 2.2106335163116455
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.247 Vali Acc: 0.872 Test Loss: 0.247 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0339791774749756
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 2.000176429748535
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 2.2301559448242188
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4203689098358154
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.211 Vali Acc: 0.894 Test Loss: 0.211 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 2.231580972671509
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.207 Vali Acc: 0.883 Test Loss: 0.207 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2835917472839355
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.872 Test Loss: 0.229 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2771196365356445
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 2.4181246757507324
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 2.2364509105682373
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.048797845840454
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 1.9522252082824707
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9954509735107422
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.3283438682556152
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 2.190897226333618
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 2.1534953117370605
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949999).  Saving model ...
Epoch: 34 cost time: 2.1396894454956055
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1746556758880615
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.301862955093384
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.4107184410095215
Epoch: 37, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.31565260887146
Epoch: 38, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.1326262950897217
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.149252414703369
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.099301338195801
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.0205512046813965
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.283 Vali Acc: 0.939 Test Loss: 0.283 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.084642171859741
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 2789638
model size : 10.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.799147367477417
Epoch: 1, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.709 Vali Acc: 0.439 Test Loss: 1.709 Test Acc: 0.439
Validation loss decreased (inf --> -0.438872).  Saving model ...
Epoch: 2 cost time: 2.2906877994537354
Epoch: 2, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.423 Vali Acc: 0.683 Test Loss: 1.423 Test Acc: 0.683
Validation loss decreased (-0.438872 --> -0.683319).  Saving model ...
Epoch: 3 cost time: 2.4536986351013184
Epoch: 3, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.052 Vali Acc: 0.717 Test Loss: 1.052 Test Acc: 0.717
Validation loss decreased (-0.683319 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 2.3234879970550537
Epoch: 4, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.88041090965271
Epoch: 5, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.716656 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 2.2363879680633545
Epoch: 6, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 2.2339985370635986
Epoch: 7, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.456 Vali Acc: 0.800 Test Loss: 0.456 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 2.316877603530884
Epoch: 8, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.411 Vali Acc: 0.794 Test Loss: 0.411 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3289501667022705
Epoch: 9, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.799995 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.3196918964385986
Epoch: 10, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.349 Vali Acc: 0.828 Test Loss: 0.349 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2862720489501953
Epoch: 11, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 2.3129312992095947
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 2.2508552074432373
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 2.2670652866363525
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.215620279312134
Epoch: 15, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.445539712905884
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.355 Vali Acc: 0.856 Test Loss: 0.355 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.472505807876587
Epoch: 17, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 2.0937037467956543
Epoch: 18, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.135380506515503
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 20 cost time: 2.044492721557617
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 2.046449899673462
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0106985569000244
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.268 Vali Acc: 0.861 Test Loss: 0.268 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.190066337585449
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 24 cost time: 2.3671295642852783
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 2.339437961578369
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.209620952606201
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 27 cost time: 2.570768117904663
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.186 Vali Acc: 0.906 Test Loss: 0.186 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 28 cost time: 2.3384249210357666
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.883 Test Loss: 0.223 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3379366397857666
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3386034965515137
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.201422691345215
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
Validation loss decreased (-0.905554 --> -0.911108).  Saving model ...
Epoch: 32 cost time: 2.26668119430542
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 33 cost time: 2.2598047256469727
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.3635358810424805
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.1004114151000977
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.123110771179199
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.2644617557525635
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.1672720909118652
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.3812172412872314
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.4421210289001465
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.455082654953003
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.353973627090454
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 2.2798473834991455
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.2629952430725098
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.012427568435669
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 46 cost time: 2.101954221725464
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 47 cost time: 2.1130995750427246
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 2.12082576751709
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.0850424766540527
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.0713627338409424
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2789702
model size : 10.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.318372488021851
Epoch: 1, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.475 Vali Acc: 0.639 Test Loss: 1.475 Test Acc: 0.639
Validation loss decreased (inf --> -0.638874).  Saving model ...
Epoch: 2 cost time: 2.7449424266815186
Epoch: 2, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.786 Vali Acc: 0.717 Test Loss: 0.786 Test Acc: 0.717
Validation loss decreased (-0.638874 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 2.798436403274536
Epoch: 3, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.497 Vali Acc: 0.744 Test Loss: 0.497 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 2.4053945541381836
Epoch: 4, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.420 Vali Acc: 0.778 Test Loss: 0.420 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777774).  Saving model ...
Epoch: 5 cost time: 2.4625697135925293
Epoch: 5, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.465 Vali Acc: 0.800 Test Loss: 0.465 Test Acc: 0.800
Validation loss decreased (-0.777774 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 2.480689525604248
Epoch: 6, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.8304858207702637
Epoch: 7, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855553).  Saving model ...
Epoch: 8 cost time: 2.7375872135162354
Epoch: 8, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.356 Vali Acc: 0.833 Test Loss: 0.356 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9058759212493896
Epoch: 9, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9803640842437744
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.867715835571289
Epoch: 11, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.240 Vali Acc: 0.872 Test Loss: 0.240 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 2.994835376739502
Epoch: 12, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.356 Vali Acc: 0.878 Test Loss: 0.356 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 2.8026623725891113
Epoch: 13, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.236 Vali Acc: 0.878 Test Loss: 0.236 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 2.9574522972106934
Epoch: 14, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883329).  Saving model ...
Epoch: 15 cost time: 2.564901351928711
Epoch: 15, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
Validation loss decreased (-0.883329 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 2.4696741104125977
Epoch: 16, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.338 Vali Acc: 0.872 Test Loss: 0.338 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.507967233657837
Epoch: 17, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
Validation loss decreased (-0.899998 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 2.2066009044647217
Epoch: 18, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.316014289855957
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3103396892547607
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8422398567199707
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.780362129211426
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.888761520385742
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.9625136852264404
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.9390997886657715
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8600504398345947
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.825395345687866
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2970598
model size : 11.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.976026773452759
Epoch: 1, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.602 Vali Acc: 0.617 Test Loss: 1.602 Test Acc: 0.617
Validation loss decreased (inf --> -0.616651).  Saving model ...
Epoch: 2 cost time: 2.5582454204559326
Epoch: 2, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.118 Vali Acc: 0.706 Test Loss: 1.118 Test Acc: 0.706
Validation loss decreased (-0.616651 --> -0.705544).  Saving model ...
Epoch: 3 cost time: 2.4364938735961914
Epoch: 3, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
Validation loss decreased (-0.705544 --> -0.755549).  Saving model ...
Epoch: 4 cost time: 2.4447274208068848
Epoch: 4, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 2.662998914718628
Epoch: 5, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.762485980987549
Epoch: 6, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 2.631678819656372
Epoch: 7, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.2815749645233154
Epoch: 8, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 2.274672031402588
Epoch: 9, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
Validation loss decreased (-0.838886 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.3777599334716797
Epoch: 10, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1832404136657715
Epoch: 11, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 2.4498116970062256
Epoch: 12, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 2.4815971851348877
Epoch: 13, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3427700996398926
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 2.717534065246582
Epoch: 15, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6828296184539795
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6240053176879883
Epoch: 17, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.510901927947998
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4614803791046143
Epoch: 19, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 2.460866689682007
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 21 cost time: 2.6253950595855713
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5458149909973145
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5196986198425293
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5833847522735596
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.803736448287964
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7134735584259033
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 2.6710658073425293
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8937935829162598
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.5779879093170166
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.731135606765747
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.52327299118042
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.4548890590667725
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.1832826137542725
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.2682840824127197
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.4102602005004883
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.3789634704589844
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2860038
model size : 11.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.172748327255249
Epoch: 1, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.598 Vali Acc: 0.622 Test Loss: 1.598 Test Acc: 0.622
Validation loss decreased (inf --> -0.622206).  Saving model ...
Epoch: 2 cost time: 2.6936869621276855
Epoch: 2, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
Validation loss decreased (-0.622206 --> -0.716656).  Saving model ...
Epoch: 3 cost time: 2.7301127910614014
Epoch: 3, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.634 Vali Acc: 0.739 Test Loss: 0.634 Test Acc: 0.739
Validation loss decreased (-0.716656 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 2.675438404083252
Epoch: 4, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.463 Vali Acc: 0.772 Test Loss: 0.463 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 2.6068711280822754
Epoch: 5, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.400 Vali Acc: 0.800 Test Loss: 0.400 Test Acc: 0.800
Validation loss decreased (-0.772218 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.6077940464019775
Epoch: 6, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.597574472427368
Epoch: 7, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 2.4104862213134766
Epoch: 8, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 2.369307041168213
Epoch: 9, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 2.37489652633667
Epoch: 10, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.4502806663513184
Epoch: 11, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8597493171691895
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 2.849071979522705
Epoch: 13, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7916340827941895
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8384594917297363
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.6667144298553467
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.872 Test Loss: 0.241 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5545003414154053
Epoch: 17, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4273109436035156
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5005111694335938
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 2.5942296981811523
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4565908908843994
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.717909097671509
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 2.5431947708129883
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.202 Vali Acc: 0.894 Test Loss: 0.202 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6760339736938477
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.619171380996704
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.791454315185547
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.9115254878997803
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.766380548477173
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 2.9467599391937256
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 2.6380326747894287
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.7229275703430176
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.911 Test Loss: 0.205 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8910114765167236
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 2.7323455810546875
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.900 Test Loss: 0.198 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.7115273475646973
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.906 Test Loss: 0.199 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6840524673461914
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.766479015350342
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.928 Test Loss: 0.175 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 37 cost time: 2.9195401668548584
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.906 Test Loss: 0.182 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.7996628284454346
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.906 Test Loss: 0.187 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.88616681098938
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.545074939727783
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.4546046257019043
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.6352906227111816
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.307875156402588
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.906 Test Loss: 0.197 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.3322551250457764
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.922 Test Loss: 0.182 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.3382885456085205
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.512202501296997
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2860070
model size : 11.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.092405557632446
Epoch: 1, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.653 Vali Acc: 0.522 Test Loss: 1.653 Test Acc: 0.522
Validation loss decreased (inf --> -0.522206).  Saving model ...
Epoch: 2 cost time: 2.720823287963867
Epoch: 2, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.173 Vali Acc: 0.672 Test Loss: 1.173 Test Acc: 0.672
Validation loss decreased (-0.522206 --> -0.672210).  Saving model ...
Epoch: 3 cost time: 2.6322884559631348
Epoch: 3, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.754 Vali Acc: 0.756 Test Loss: 0.754 Test Acc: 0.756
Validation loss decreased (-0.672210 --> -0.755548).  Saving model ...
Epoch: 4 cost time: 2.5711703300476074
Epoch: 4, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.530 Vali Acc: 0.800 Test Loss: 0.530 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799995).  Saving model ...
Epoch: 5 cost time: 2.5741918087005615
Epoch: 5, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.445 Vali Acc: 0.789 Test Loss: 0.445 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.828721284866333
Epoch: 6, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.391 Vali Acc: 0.822 Test Loss: 0.391 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 2.2543280124664307
Epoch: 7, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.357 Vali Acc: 0.828 Test Loss: 0.357 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 2.1452555656433105
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.319 Vali Acc: 0.811 Test Loss: 0.319 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.180213212966919
Epoch: 9, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 2.3288867473602295
Epoch: 10, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.2258810997009277
Epoch: 11, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3611226081848145
Epoch: 12, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.403 Vali Acc: 0.839 Test Loss: 0.403 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6697981357574463
Epoch: 13, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.549022674560547
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 2.7948591709136963
Epoch: 15, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 2.4075207710266113
Epoch: 16, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.5727808475494385
Epoch: 17, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.263 Vali Acc: 0.850 Test Loss: 0.263 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5460550785064697
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 2.34918212890625
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.238 Vali Acc: 0.872 Test Loss: 0.238 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5500094890594482
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.192168712615967
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.894441 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 2.5317323207855225
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2468600273132324
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.288567066192627
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 2.3126022815704346
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2137491703033447
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3535571098327637
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2262589931488037
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.7726705074310303
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.493591070175171
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.4865241050720215
Epoch: 31, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.5104141235351562
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 2.3604652881622314
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2693958282470703
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.501864433288574
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.6515250205993652
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.41626238822937
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.572420358657837
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.3965463638305664
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.352550506591797
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.639 Vali Acc: 0.883 Test Loss: 0.639 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.7387313842773438
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.583216905593872
Epoch: 42, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.405 Vali Acc: 0.911 Test Loss: 0.405 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2823270
model size : 10.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.097523927688599
Epoch: 1, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.695 Vali Acc: 0.433 Test Loss: 1.695 Test Acc: 0.433
Validation loss decreased (inf --> -0.433316).  Saving model ...
Epoch: 2 cost time: 2.684962272644043
Epoch: 2, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.281 Vali Acc: 0.661 Test Loss: 1.281 Test Acc: 0.661
Validation loss decreased (-0.433316 --> -0.661098).  Saving model ...
Epoch: 3 cost time: 2.4483165740966797
Epoch: 3, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.861 Vali Acc: 0.678 Test Loss: 0.861 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677769).  Saving model ...
Epoch: 4 cost time: 2.305595874786377
Epoch: 4, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.629 Vali Acc: 0.744 Test Loss: 0.629 Test Acc: 0.744
Validation loss decreased (-0.677769 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 2.4634318351745605
Epoch: 5, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.505 Vali Acc: 0.761 Test Loss: 0.505 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 2.23447322845459
Epoch: 6, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.428 Vali Acc: 0.783 Test Loss: 0.428 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 2.2837719917297363
Epoch: 7, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.397 Vali Acc: 0.800 Test Loss: 0.397 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 2.347567319869995
Epoch: 8, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.401048183441162
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.778181791305542
Epoch: 10, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 2.6442670822143555
Epoch: 11, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.645021438598633
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 2.692678451538086
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 2.495652914047241
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.271 Vali Acc: 0.878 Test Loss: 0.271 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.308095693588257
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.272 Vali Acc: 0.856 Test Loss: 0.272 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0483999252319336
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.252 Vali Acc: 0.872 Test Loss: 0.252 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1700079441070557
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.257 Vali Acc: 0.872 Test Loss: 0.257 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5227320194244385
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.240 Vali Acc: 0.878 Test Loss: 0.240 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 2.436069965362549
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4951555728912354
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.222 Vali Acc: 0.894 Test Loss: 0.222 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 2.5628502368927
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.393 Vali Acc: 0.872 Test Loss: 0.393 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6040430068969727
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 2.603759527206421
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.66344952583313
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 2.648395538330078
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7027833461761475
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 2.3554627895355225
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.169206380844116
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2926197052001953
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3128347396850586
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.1141254901885986
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.292843818664551
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.0416884422302246
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 2.035952568054199
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 2.1943838596343994
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.3767216205596924
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.5928561687469482
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.829705238342285
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 2.669983386993408
Epoch: 39, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 2.6513094902038574
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 41 cost time: 2.6929562091827393
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.620819568634033
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.436398506164551
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.6013996601104736
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.5670387744903564
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.480696201324463
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.546799421310425
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.4701340198516846
Epoch: 48, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.5316760540008545
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.508554220199585
Epoch: 50, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2786470
model size : 10.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7714202404022217
Epoch: 1, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.738 Vali Acc: 0.267 Test Loss: 1.738 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 2.0294454097747803
Epoch: 2, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.421 Vali Acc: 0.622 Test Loss: 1.421 Test Acc: 0.622
Validation loss decreased (-0.266649 --> -0.622208).  Saving model ...
Epoch: 3 cost time: 2.0789196491241455
Epoch: 3, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.023 Vali Acc: 0.678 Test Loss: 1.023 Test Acc: 0.678
Validation loss decreased (-0.622208 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 1.9335436820983887
Epoch: 4, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.750 Vali Acc: 0.694 Test Loss: 0.750 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 1.911452293395996
Epoch: 5, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.617 Vali Acc: 0.711 Test Loss: 0.617 Test Acc: 0.711
Validation loss decreased (-0.694437 --> -0.711105).  Saving model ...
Epoch: 6 cost time: 2.4557714462280273
Epoch: 6, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.516 Vali Acc: 0.778 Test Loss: 0.516 Test Acc: 0.778
Validation loss decreased (-0.711105 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 2.1208460330963135
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.444 Vali Acc: 0.806 Test Loss: 0.444 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.504274606704712
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 2.633943796157837
Epoch: 9, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.280660390853882
Epoch: 10, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 2.65397310256958
Epoch: 11, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4037957191467285
Epoch: 12, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.340 Vali Acc: 0.856 Test Loss: 0.340 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.2506766319274902
Epoch: 13, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.499799966812134
Epoch: 14, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.282 Vali Acc: 0.844 Test Loss: 0.282 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.480870246887207
Epoch: 15, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 2.5853772163391113
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 17 cost time: 2.346569061279297
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.252 Vali Acc: 0.867 Test Loss: 0.252 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 2.2553367614746094
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 19 cost time: 2.2966079711914062
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.872 Test Loss: 0.243 Test Acc: 0.872
Validation loss decreased (-0.872220 --> -0.872220).  Saving model ...
Epoch: 20 cost time: 2.3560361862182617
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.223 Vali Acc: 0.883 Test Loss: 0.223 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 2.6719181537628174
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3989768028259277
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.218 Vali Acc: 0.894 Test Loss: 0.218 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 2.3521854877471924
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 2.3197154998779297
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.210 Vali Acc: 0.883 Test Loss: 0.210 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.313190460205078
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 2.3344876766204834
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.255584239959717
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4678971767425537
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2042150497436523
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.215993881225586
Epoch: 30, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.3027546405792236
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3222079277038574
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 2.5067102909088135
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2455878257751465
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.4347128868103027
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 36 cost time: 2.488422155380249
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.4349021911621094
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.482724189758301
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.3794825077056885
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.5827269554138184
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.449007034301758
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 42 cost time: 2.3422465324401855
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.697334051132202
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.350889205932617
Epoch: 44, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.4110209941864014
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.463618278503418
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.3117635250091553
Epoch: 47, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.5646932125091553
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.198671817779541
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.4052891731262207
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2768134
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.90108323097229
Epoch: 1, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.744 Vali Acc: 0.339 Test Loss: 1.744 Test Acc: 0.339
Validation loss decreased (inf --> -0.338871).  Saving model ...
Epoch: 2 cost time: 2.1745445728302
Epoch: 2, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.450 Vali Acc: 0.628 Test Loss: 1.450 Test Acc: 0.628
Validation loss decreased (-0.338871 --> -0.627763).  Saving model ...
Epoch: 3 cost time: 2.3308792114257812
Epoch: 3, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.061 Vali Acc: 0.672 Test Loss: 1.061 Test Acc: 0.672
Validation loss decreased (-0.627763 --> -0.672212).  Saving model ...
Epoch: 4 cost time: 2.1832330226898193
Epoch: 4, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.794 Vali Acc: 0.728 Test Loss: 0.794 Test Acc: 0.728
Validation loss decreased (-0.672212 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 2.325939416885376
Epoch: 5, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.631 Vali Acc: 0.728 Test Loss: 0.631 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 2.1540682315826416
Epoch: 6, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.562 Vali Acc: 0.756 Test Loss: 0.562 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 2.245137929916382
Epoch: 7, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.482 Vali Acc: 0.772 Test Loss: 0.482 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 2.5734193325042725
Epoch: 8, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 2.5087454319000244
Epoch: 9, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.386 Vali Acc: 0.833 Test Loss: 0.386 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 2.368009328842163
Epoch: 10, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.374 Vali Acc: 0.822 Test Loss: 0.374 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4687347412109375
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 2.536738872528076
Epoch: 12, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 2.6053006649017334
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 2.5394887924194336
Epoch: 14, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.483583450317383
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 2.573814868927002
Epoch: 16, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.538672685623169
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 2.652486562728882
Epoch: 18, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.46917462348938
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.412414789199829
Epoch: 20, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 2.5054118633270264
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 2.2320308685302734
Epoch: 22, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 2.2647039890289307
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 2.3082542419433594
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.213 Vali Acc: 0.894 Test Loss: 0.213 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.221742868423462
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.458109140396118
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.207 Vali Acc: 0.894 Test Loss: 0.207 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.34340238571167
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.09639048576355
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 2.11608624458313
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2882723808288574
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.906 Test Loss: 0.214 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.2791035175323486
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 2.2077739238739014
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.900 Test Loss: 0.199 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2787888050079346
Epoch: 33, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.900 Test Loss: 0.186 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4044995307922363
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 2.3258755207061768
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.1135494709014893
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.911 Test Loss: 0.181 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.267643928527832
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.5562376976013184
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.462874412536621
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.307936668395996
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.233018398284912
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.4965269565582275
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.906 Test Loss: 0.191 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.4617812633514404
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.3707587718963623
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2768198
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.095874547958374
Epoch: 1, Steps: 12 | Train Loss: 1.454 Vali Loss: 0.783 Vali Acc: 0.694 Test Loss: 0.783 Test Acc: 0.694
Validation loss decreased (inf --> -0.694437).  Saving model ...
Epoch: 2 cost time: 4.291843891143799
Epoch: 2, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.464 Vali Acc: 0.789 Test Loss: 0.464 Test Acc: 0.789
Validation loss decreased (-0.694437 --> -0.788884).  Saving model ...
Epoch: 3 cost time: 4.513753414154053
Epoch: 3, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805552).  Saving model ...
Epoch: 4 cost time: 4.457648754119873
Epoch: 4, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.459 Vali Acc: 0.767 Test Loss: 0.459 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.466510057449341
Epoch: 5, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844440).  Saving model ...
Epoch: 6 cost time: 4.372477293014526
Epoch: 6, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 7 cost time: 4.516736745834351
Epoch: 7, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.451 Vali Acc: 0.856 Test Loss: 0.451 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855551).  Saving model ...
Epoch: 8 cost time: 4.632336616516113
Epoch: 8, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 4.718951225280762
Epoch: 9, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.380575895309448
Epoch: 10, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 4.831786394119263
Epoch: 11, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.555613040924072
Epoch: 12, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.822488307952881
Epoch: 13, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.341 Vali Acc: 0.872 Test Loss: 0.341 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.648111581802368
Epoch: 14, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.454 Vali Acc: 0.872 Test Loss: 0.454 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.228849172592163
Epoch: 15, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.4960691928863525
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.58245062828064
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 4.371511697769165
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.434 Vali Acc: 0.883 Test Loss: 0.434 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.600590229034424
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.653993844985962
Epoch: 20, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.598291635513306
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.653757095336914
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.906 Test Loss: 0.416 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.385166645050049
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.660073757171631
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.894 Test Loss: 0.389 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.600620269775391
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.894 Test Loss: 0.381 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.499171257019043
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.608325481414795
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 10033030
model size : 38.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.587498664855957
Epoch: 1, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.031 Vali Acc: 0.689 Test Loss: 1.031 Test Acc: 0.689
Validation loss decreased (inf --> -0.688879).  Saving model ...
Epoch: 2 cost time: 3.4366884231567383
Epoch: 2, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
Validation loss decreased (-0.688879 --> -0.783328).  Saving model ...
Epoch: 3 cost time: 3.4602062702178955
Epoch: 3, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.511 Vali Acc: 0.772 Test Loss: 0.511 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4024667739868164
Epoch: 4, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.435 Vali Acc: 0.789 Test Loss: 0.435 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 3.343143939971924
Epoch: 5, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.443 Vali Acc: 0.806 Test Loss: 0.443 Test Acc: 0.806
Validation loss decreased (-0.788885 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 3.2478110790252686
Epoch: 6, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 3.27429461479187
Epoch: 7, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.534 Vali Acc: 0.817 Test Loss: 0.534 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.098871946334839
Epoch: 8, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.329 Vali Acc: 0.822 Test Loss: 0.329 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.025512456893921
Epoch: 9, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 3.086609363555908
Epoch: 10, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.408 Vali Acc: 0.844 Test Loss: 0.408 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.70882248878479
Epoch: 11, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 3.2754759788513184
Epoch: 12, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 13 cost time: 3.2172956466674805
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 14 cost time: 3.2006359100341797
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.470 Vali Acc: 0.828 Test Loss: 0.470 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1664159297943115
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2857604026794434
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.481731653213501
Epoch: 17, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.2253167629241943
Epoch: 18, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.271880865097046
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.422100067138672
Epoch: 20, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.872 Test Loss: 0.355 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6770386695861816
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.883 Test Loss: 0.468 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.3758013248443604
Epoch: 22, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.696 Vali Acc: 0.872 Test Loss: 0.696 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2342541217803955
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.894 Test Loss: 0.392 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 9553926
model size : 36.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.549112558364868
Epoch: 1, Steps: 12 | Train Loss: 1.453 Vali Loss: 0.983 Vali Acc: 0.711 Test Loss: 0.983 Test Acc: 0.711
Validation loss decreased (inf --> -0.711101).  Saving model ...
Epoch: 2 cost time: 3.1877312660217285
Epoch: 2, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.542 Vali Acc: 0.744 Test Loss: 0.542 Test Acc: 0.744
Validation loss decreased (-0.711101 --> -0.744439).  Saving model ...
Epoch: 3 cost time: 3.3619141578674316
Epoch: 3, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.412 Vali Acc: 0.772 Test Loss: 0.412 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 3.158263683319092
Epoch: 4, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
Validation loss decreased (-0.772218 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 3.183936834335327
Epoch: 5, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.337 Vali Acc: 0.817 Test Loss: 0.337 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.186073064804077
Epoch: 6, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2923500537872314
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 3.1874489784240723
Epoch: 8, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.287893295288086
Epoch: 9, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.363 Vali Acc: 0.878 Test Loss: 0.363 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 10 cost time: 3.290414333343506
Epoch: 10, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 3.4475581645965576
Epoch: 11, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 12 cost time: 3.414670705795288
Epoch: 12, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.467003107070923
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.587 Vali Acc: 0.883 Test Loss: 0.587 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2885067462921143
Epoch: 14, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3966422080993652
Epoch: 15, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.374 Vali Acc: 0.878 Test Loss: 0.374 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.420961856842041
Epoch: 16, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.4345457553863525
Epoch: 17, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.432 Vali Acc: 0.872 Test Loss: 0.432 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.4809229373931885
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3733317852020264
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.762 Vali Acc: 0.878 Test Loss: 0.762 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.1931207180023193
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9602131843566895
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.624 Vali Acc: 0.856 Test Loss: 0.624 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 9554054
model size : 36.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.470959901809692
Epoch: 1, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.172 Vali Acc: 0.644 Test Loss: 1.172 Test Acc: 0.644
Validation loss decreased (inf --> -0.644433).  Saving model ...
Epoch: 2 cost time: 3.015432596206665
Epoch: 2, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (-0.644433 --> -0.722216).  Saving model ...
Epoch: 3 cost time: 2.768190622329712
Epoch: 3, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.435 Vali Acc: 0.783 Test Loss: 0.435 Test Acc: 0.783
Validation loss decreased (-0.722216 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 2.8768668174743652
Epoch: 4, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.345 Vali Acc: 0.800 Test Loss: 0.345 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799997).  Saving model ...
Epoch: 5 cost time: 2.9695558547973633
Epoch: 5, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
Validation loss decreased (-0.799997 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 3.0295310020446777
Epoch: 6, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.294 Vali Acc: 0.833 Test Loss: 0.294 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 2.9981658458709717
Epoch: 7, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 8 cost time: 3.0177581310272217
Epoch: 8, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
Validation loss decreased (-0.838886 --> -0.883331).  Saving model ...
Epoch: 9 cost time: 3.0465707778930664
Epoch: 9, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.430 Vali Acc: 0.817 Test Loss: 0.430 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0471723079681396
Epoch: 10, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 3.040224313735962
Epoch: 11, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.095470666885376
Epoch: 12, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1120264530181885
Epoch: 13, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 3.1365158557891846
Epoch: 14, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.894441 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 3.0105650424957275
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.408 Vali Acc: 0.883 Test Loss: 0.408 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9735779762268066
Epoch: 16, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.001847743988037
Epoch: 17, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.769488573074341
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 2.893852949142456
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.933 Test Loss: 0.168 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 20 cost time: 2.9365601539611816
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.929635763168335
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.823246479034424
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.403 Vali Acc: 0.906 Test Loss: 0.403 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0461134910583496
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.012423038482666
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.906 Test Loss: 0.365 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8020646572113037
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.592 Vali Acc: 0.889 Test Loss: 0.592 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.889819383621216
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.814573287963867
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.964306116104126
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.9284210205078125
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.928 Test Loss: 0.316 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 9406854
model size : 36.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.678473234176636
Epoch: 1, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.271 Vali Acc: 0.722 Test Loss: 1.271 Test Acc: 0.722
Validation loss decreased (inf --> -0.722210).  Saving model ...
Epoch: 2 cost time: 2.9512879848480225
Epoch: 2, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.640 Vali Acc: 0.744 Test Loss: 0.640 Test Acc: 0.744
Validation loss decreased (-0.722210 --> -0.744438).  Saving model ...
Epoch: 3 cost time: 2.930286169052124
Epoch: 3, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.479 Vali Acc: 0.750 Test Loss: 0.479 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 2.8471686840057373
Epoch: 4, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 2.734649658203125
Epoch: 5, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.354 Vali Acc: 0.783 Test Loss: 0.354 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.638065814971924
Epoch: 6, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.423 Vali Acc: 0.817 Test Loss: 0.423 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 2.681664228439331
Epoch: 7, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.347 Vali Acc: 0.806 Test Loss: 0.347 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4124388694763184
Epoch: 8, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.308 Vali Acc: 0.839 Test Loss: 0.308 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 2.6158831119537354
Epoch: 9, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 2.796332597732544
Epoch: 10, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.844441 --> -0.899998).  Saving model ...
Epoch: 11 cost time: 2.646738052368164
Epoch: 11, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.899905204772949
Epoch: 12, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.662036418914795
Epoch: 13, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8036608695983887
Epoch: 14, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8144924640655518
Epoch: 15, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8120851516723633
Epoch: 16, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.765834331512451
Epoch: 17, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.384 Vali Acc: 0.883 Test Loss: 0.384 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.738333225250244
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 2.7893056869506836
Epoch: 19, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7747437953948975
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.974720001220703
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7789156436920166
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.737452268600464
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8035037517547607
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8264214992523193
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.352 Vali Acc: 0.883 Test Loss: 0.352 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.9120302200317383
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.8022103309631348
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 2.8482391834259033
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.817084550857544
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.390 Vali Acc: 0.911 Test Loss: 0.390 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9188072681427
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.372 Vali Acc: 0.894 Test Loss: 0.372 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.705021381378174
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.894 Test Loss: 0.495 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.477402448654175
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.529958724975586
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.6183626651763916
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.6505556106567383
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.5391407012939453
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 2.5869340896606445
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.939 Test Loss: 0.263 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938886).  Saving model ...
Epoch: 38 cost time: 2.5620670318603516
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.5364632606506348
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.759565591812134
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.667851209640503
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.400913953781128
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.396169424057007
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.3970119953155518
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.391780376434326
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.749189853668213
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.9009833335876465
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 9296518
model size : 35.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.299067258834839
Epoch: 1, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.411 Vali Acc: 0.644 Test Loss: 1.411 Test Acc: 0.644
Validation loss decreased (inf --> -0.644430).  Saving model ...
Epoch: 2 cost time: 2.650408983230591
Epoch: 2, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.777 Vali Acc: 0.678 Test Loss: 0.777 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677770).  Saving model ...
Epoch: 3 cost time: 2.6849429607391357
Epoch: 3, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.545 Vali Acc: 0.778 Test Loss: 0.545 Test Acc: 0.778
Validation loss decreased (-0.677770 --> -0.777772).  Saving model ...
Epoch: 4 cost time: 2.531324625015259
Epoch: 4, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.422 Vali Acc: 0.794 Test Loss: 0.422 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 2.407485008239746
Epoch: 5, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.353 Vali Acc: 0.806 Test Loss: 0.353 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 2.5538265705108643
Epoch: 6, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.668916940689087
Epoch: 7, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.674820899963379
Epoch: 8, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 2.770556688308716
Epoch: 9, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 2.643800973892212
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.264 Vali Acc: 0.856 Test Loss: 0.264 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.762855291366577
Epoch: 11, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.81366229057312
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.793660879135132
Epoch: 13, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8161723613739014
Epoch: 14, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.644362211227417
Epoch: 15, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 2.819765567779541
Epoch: 16, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 2.8244197368621826
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.891054630279541
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6899569034576416
Epoch: 19, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 2.4744246006011963
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.514359951019287
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5743682384490967
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.174 Vali Acc: 0.928 Test Loss: 0.174 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 2.6017658710479736
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.656890869140625
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.636467456817627
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.538708209991455
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.9546234607696533
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.7741615772247314
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.7758946418762207
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7271430492401123
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.826826572418213
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.7600274085998535
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 9223174
model size : 35.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7069852352142334
Epoch: 1, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.399 Vali Acc: 0.617 Test Loss: 1.399 Test Acc: 0.617
Validation loss decreased (inf --> -0.616653).  Saving model ...
Epoch: 2 cost time: 2.578528642654419
Epoch: 2, Steps: 12 | Train Loss: 1.017 Vali Loss: 0.794 Vali Acc: 0.717 Test Loss: 0.794 Test Acc: 0.717
Validation loss decreased (-0.616653 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 2.451343297958374
Epoch: 3, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.535 Vali Acc: 0.761 Test Loss: 0.535 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761106).  Saving model ...
Epoch: 4 cost time: 2.438594102859497
Epoch: 4, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.415 Vali Acc: 0.800 Test Loss: 0.415 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 2.6279773712158203
Epoch: 5, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 6 cost time: 2.5739738941192627
Epoch: 6, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 2.757840633392334
Epoch: 7, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 2.5724549293518066
Epoch: 8, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 2.5073416233062744
Epoch: 9, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6391687393188477
Epoch: 10, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.264 Vali Acc: 0.872 Test Loss: 0.264 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6531801223754883
Epoch: 11, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.261 Vali Acc: 0.856 Test Loss: 0.261 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7173662185668945
Epoch: 12, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 2.689533233642578
Epoch: 13, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 2.695882558822632
Epoch: 14, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.693399429321289
Epoch: 15, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.561457872390747
Epoch: 16, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 17 cost time: 2.541353940963745
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.45542573928833
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5321829319000244
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 2.54475474357605
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4079649448394775
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 2.728804111480713
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.294 Vali Acc: 0.911 Test Loss: 0.294 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.644686698913574
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7245309352874756
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.369 Vali Acc: 0.894 Test Loss: 0.369 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6086783409118652
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.418 Vali Acc: 0.894 Test Loss: 0.418 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.654592514038086
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.7141525745391846
Epoch: 27, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.802393674850464
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.426 Vali Acc: 0.906 Test Loss: 0.426 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.7427260875701904
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.619833469390869
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.506497621536255
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.506 Vali Acc: 0.883 Test Loss: 0.506 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 9223430
model size : 35.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.318668603897095
Epoch: 1, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.021 Vali Acc: 0.694 Test Loss: 1.021 Test Acc: 0.694
Validation loss decreased (inf --> -0.694434).  Saving model ...
Epoch: 2 cost time: 2.883270025253296
Epoch: 2, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.585 Vali Acc: 0.711 Test Loss: 0.585 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711105).  Saving model ...
Epoch: 3 cost time: 2.936502695083618
Epoch: 3, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.417 Vali Acc: 0.800 Test Loss: 0.417 Test Acc: 0.800
Validation loss decreased (-0.711105 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 2.836284637451172
Epoch: 4, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.573 Vali Acc: 0.772 Test Loss: 0.573 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8840909004211426
Epoch: 5, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.376 Vali Acc: 0.833 Test Loss: 0.376 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 3.0001888275146484
Epoch: 6, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 3.0515310764312744
Epoch: 7, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.408 Vali Acc: 0.867 Test Loss: 0.408 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 2.977961540222168
Epoch: 8, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.365 Vali Acc: 0.839 Test Loss: 0.365 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.038656234741211
Epoch: 9, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.269 Vali Acc: 0.856 Test Loss: 0.269 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0925252437591553
Epoch: 10, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.464 Vali Acc: 0.856 Test Loss: 0.464 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.892225742340088
Epoch: 11, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.530 Vali Acc: 0.811 Test Loss: 0.530 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.838347911834717
Epoch: 12, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.838529348373413
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8037807941436768
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.767958641052246
Epoch: 15, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7373883724212646
Epoch: 16, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 2.589505195617676
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.560 Vali Acc: 0.883 Test Loss: 0.560 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6982269287109375
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 2.669093370437622
Epoch: 19, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9522018432617188
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9663002490997314
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.019821882247925
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9748826026916504
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0069332122802734
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.91540265083313
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8828041553497314
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.654681921005249
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.8435308933258057
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 3034054
model size : 11.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.656186819076538
Epoch: 1, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.285 Vali Acc: 0.733 Test Loss: 1.285 Test Acc: 0.733
Validation loss decreased (inf --> -0.733320).  Saving model ...
Epoch: 2 cost time: 2.4024033546447754
Epoch: 2, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.648 Vali Acc: 0.767 Test Loss: 0.648 Test Acc: 0.767
Validation loss decreased (-0.733320 --> -0.766660).  Saving model ...
Epoch: 3 cost time: 2.3842861652374268
Epoch: 3, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 2.090108871459961
Epoch: 4, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 2.060020923614502
Epoch: 5, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.385 Vali Acc: 0.839 Test Loss: 0.385 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 2.3521041870117188
Epoch: 6, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.299 Vali Acc: 0.833 Test Loss: 0.299 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.312922716140747
Epoch: 7, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
Validation loss decreased (-0.838885 --> -0.877775).  Saving model ...
Epoch: 8 cost time: 2.6317055225372314
Epoch: 8, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.397 Vali Acc: 0.839 Test Loss: 0.397 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.615023612976074
Epoch: 9, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6058409214019775
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 2.2811126708984375
Epoch: 11, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.3357880115509033
Epoch: 12, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 2.3230772018432617
Epoch: 13, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.300520658493042
Epoch: 14, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3529505729675293
Epoch: 15, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.263620615005493
Epoch: 16, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
Validation loss decreased (-0.894441 --> -0.927776).  Saving model ...
Epoch: 17 cost time: 2.4938113689422607
Epoch: 17, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.303680181503296
Epoch: 18, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4270617961883545
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.608593463897705
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4987120628356934
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.429838180541992
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.598386526107788
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3965206146240234
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 2.3021275997161865
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5436604022979736
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.939 Test Loss: 0.181 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 2.3396494388580322
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4161770343780518
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3380675315856934
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3078627586364746
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.3722341060638428
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.3974177837371826
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.2533717155456543
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9592230319976807
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.939 Test Loss: 0.182 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.400230646133423
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.4293100833892822
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2794502
model size : 10.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.666358709335327
Epoch: 1, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.293 Vali Acc: 0.728 Test Loss: 1.293 Test Acc: 0.728
Validation loss decreased (inf --> -0.727765).  Saving model ...
Epoch: 2 cost time: 2.382235527038574
Epoch: 2, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
Validation loss decreased (-0.727765 --> -0.738882).  Saving model ...
Epoch: 3 cost time: 2.4062840938568115
Epoch: 3, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.477 Vali Acc: 0.778 Test Loss: 0.477 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777773).  Saving model ...
Epoch: 4 cost time: 2.3813655376434326
Epoch: 4, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.420 Vali Acc: 0.789 Test Loss: 0.420 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 5 cost time: 2.205024480819702
Epoch: 5, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.476 Vali Acc: 0.772 Test Loss: 0.476 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3710906505584717
Epoch: 6, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
Validation loss decreased (-0.788885 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 2.2432875633239746
Epoch: 7, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 8 cost time: 2.3650379180908203
Epoch: 8, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.306 Vali Acc: 0.828 Test Loss: 0.306 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 9 cost time: 2.35137677192688
Epoch: 9, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.827775 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 2.3685762882232666
Epoch: 10, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.233 Vali Acc: 0.872 Test Loss: 0.233 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872220).  Saving model ...
Epoch: 11 cost time: 2.346662759780884
Epoch: 11, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.872220 --> -0.899997).  Saving model ...
Epoch: 12 cost time: 2.4466047286987305
Epoch: 12, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 13 cost time: 2.428710460662842
Epoch: 13, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4752321243286133
Epoch: 14, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.438 Vali Acc: 0.894 Test Loss: 0.438 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.410775899887085
Epoch: 15, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5779569149017334
Epoch: 16, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3305447101593018
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4771575927734375
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.456815719604492
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2861173152923584
Epoch: 20, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.419 Vali Acc: 0.894 Test Loss: 0.419 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.227496385574341
Epoch: 21, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.12628173828125
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2794566
model size : 10.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0852062702178955
Epoch: 1, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.373 Vali Acc: 0.739 Test Loss: 1.373 Test Acc: 0.739
Validation loss decreased (inf --> -0.738875).  Saving model ...
Epoch: 2 cost time: 1.9318702220916748
Epoch: 2, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.751 Vali Acc: 0.733 Test Loss: 0.751 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.584775686264038
Epoch: 3, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.501 Vali Acc: 0.750 Test Loss: 0.501 Test Acc: 0.750
Validation loss decreased (-0.738875 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 2.2764925956726074
Epoch: 4, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.388 Vali Acc: 0.800 Test Loss: 0.388 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 2.322874069213867
Epoch: 5, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 6 cost time: 2.6073474884033203
Epoch: 6, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.319 Vali Acc: 0.856 Test Loss: 0.319 Test Acc: 0.856
Validation loss decreased (-0.822219 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.4459426403045654
Epoch: 7, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 8 cost time: 2.288687229156494
Epoch: 8, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.442 Vali Acc: 0.806 Test Loss: 0.442 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3349151611328125
Epoch: 9, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 2.484294891357422
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2109596729278564
Epoch: 11, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.182776689529419
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.317 Vali Acc: 0.861 Test Loss: 0.317 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.478536605834961
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0896286964416504
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 2.1939547061920166
Epoch: 15, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.238 Vali Acc: 0.883 Test Loss: 0.238 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.235365390777588
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 1.937305212020874
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9066007137298584
Epoch: 18, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.085972785949707
Epoch: 19, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.188302516937256
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2032582759857178
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 2.154660940170288
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.182272434234619
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.171 Vali Acc: 0.928 Test Loss: 0.171 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 24 cost time: 2.2581686973571777
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.557281017303467
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.939 Test Loss: 0.170 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 26 cost time: 2.338749885559082
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.335 Vali Acc: 0.894 Test Loss: 0.335 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.466904878616333
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.479522943496704
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.928 Test Loss: 0.175 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2492709159851074
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1247520446777344
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.939 Test Loss: 0.181 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2136950492858887
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.115345001220703
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8861448764801025
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.911 Test Loss: 0.203 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.1676836013793945
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.3312699794769287
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2720966
model size : 10.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.592421770095825
Epoch: 1, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.432 Vali Acc: 0.656 Test Loss: 1.432 Test Acc: 0.656
Validation loss decreased (inf --> -0.655541).  Saving model ...
Epoch: 2 cost time: 1.8304386138916016
Epoch: 2, Steps: 12 | Train Loss: 1.049 Vali Loss: 0.879 Vali Acc: 0.728 Test Loss: 0.879 Test Acc: 0.728
Validation loss decreased (-0.655541 --> -0.727769).  Saving model ...
Epoch: 3 cost time: 1.6850512027740479
Epoch: 3, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.612 Vali Acc: 0.700 Test Loss: 0.612 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8564717769622803
Epoch: 4, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.477 Vali Acc: 0.789 Test Loss: 0.477 Test Acc: 0.789
Validation loss decreased (-0.727769 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 1.7370128631591797
Epoch: 5, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 2.081268310546875
Epoch: 6, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.370 Vali Acc: 0.800 Test Loss: 0.370 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.133976936340332
Epoch: 7, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 2.13214373588562
Epoch: 8, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1072049140930176
Epoch: 9, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 2.1806678771972656
Epoch: 10, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.988034963607788
Epoch: 11, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0250978469848633
Epoch: 12, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 2.231052875518799
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9517719745635986
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.356 Vali Acc: 0.856 Test Loss: 0.356 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.908031702041626
Epoch: 15, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 2.04240083694458
Epoch: 16, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.920780897140503
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.308 Vali Acc: 0.878 Test Loss: 0.308 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.047210931777954
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1191742420196533
Epoch: 19, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.966996192932129
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9718670845031738
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.107452869415283
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9914867877960205
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0848169326782227
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.242962598800659
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.006337881088257
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.048088788986206
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2647862434387207
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.039381504058838
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2665798
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5309863090515137
Epoch: 1, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.569 Vali Acc: 0.589 Test Loss: 1.569 Test Acc: 0.589
Validation loss decreased (inf --> -0.588873).  Saving model ...
Epoch: 2 cost time: 1.913301944732666
Epoch: 2, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.075 Vali Acc: 0.717 Test Loss: 1.075 Test Acc: 0.717
Validation loss decreased (-0.588873 --> -0.716656).  Saving model ...
Epoch: 3 cost time: 1.8544037342071533
Epoch: 3, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.703 Vali Acc: 0.733 Test Loss: 0.703 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 2.0369625091552734
Epoch: 4, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.9500327110290527
Epoch: 5, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.456 Vali Acc: 0.800 Test Loss: 0.456 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 2.1942696571350098
Epoch: 6, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
Validation loss decreased (-0.799995 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 2.251096248626709
Epoch: 7, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.344 Vali Acc: 0.856 Test Loss: 0.344 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 2.1297414302825928
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.344 Vali Acc: 0.822 Test Loss: 0.344 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2636194229125977
Epoch: 9, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.188577651977539
Epoch: 10, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.305 Vali Acc: 0.817 Test Loss: 0.305 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0193378925323486
Epoch: 11, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 2.074467182159424
Epoch: 12, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.8583779335021973
Epoch: 13, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.252 Vali Acc: 0.867 Test Loss: 0.252 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 1.941530466079712
Epoch: 14, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9734549522399902
Epoch: 15, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0359673500061035
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.257 Vali Acc: 0.861 Test Loss: 0.257 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9913480281829834
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.257 Vali Acc: 0.856 Test Loss: 0.257 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1690523624420166
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 2.0609946250915527
Epoch: 19, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.9999215602874756
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.241 Vali Acc: 0.867 Test Loss: 0.241 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.073439359664917
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0108604431152344
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 2.1519217491149902
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2224109172821045
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0445704460144043
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.050163745880127
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.025909185409546
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8601670265197754
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.800764560699463
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6913957595825195
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9877264499664307
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9449377059936523
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.894 Test Loss: 0.366 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 2629126
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5728893280029297
Epoch: 1, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.541 Vali Acc: 0.606 Test Loss: 1.541 Test Acc: 0.606
Validation loss decreased (inf --> -0.605540).  Saving model ...
Epoch: 2 cost time: 1.783193588256836
Epoch: 2, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.053 Vali Acc: 0.694 Test Loss: 1.053 Test Acc: 0.694
Validation loss decreased (-0.605540 --> -0.694434).  Saving model ...
Epoch: 3 cost time: 1.9727647304534912
Epoch: 3, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
Validation loss decreased (-0.694434 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 2.1109092235565186
Epoch: 4, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.530 Vali Acc: 0.761 Test Loss: 0.530 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.9668569564819336
Epoch: 5, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.457 Vali Acc: 0.783 Test Loss: 0.457 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.9433887004852295
Epoch: 6, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.9292964935302734
Epoch: 7, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.924797773361206
Epoch: 8, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8148078918457031
Epoch: 9, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.8234131336212158
Epoch: 10, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.028435468673706
Epoch: 11, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 2.1176679134368896
Epoch: 12, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.764495849609375
Epoch: 13, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 1.8865165710449219
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 1.9365887641906738
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.743800163269043
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9006297588348389
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.826080083847046
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 19 cost time: 1.7945976257324219
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0283052921295166
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9638338088989258
Epoch: 21, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9552874565124512
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 2.0611367225646973
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.016472816467285
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.929992914199829
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9392578601837158
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0992789268493652
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.392 Vali Acc: 0.906 Test Loss: 0.392 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8839824199676514
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9409184455871582
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8739757537841797
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9016621112823486
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 32 cost time: 1.965674638748169
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9397051334381104
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9286901950836182
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8530051708221436
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9716203212738037
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8248717784881592
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.1153218746185303
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.978482961654663
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.983241081237793
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0279526710510254
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9300930500030518
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.0293476581573486
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0412142276763916
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.0680220127105713
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.030471086502075
Epoch: 46, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.1406617164611816
Epoch: 47, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.8916504383087158
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.8407294750213623
Epoch: 49, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 2629254
model size : 10.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.649549961090088
Epoch: 1, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.304 Vali Acc: 0.656 Test Loss: 1.304 Test Acc: 0.656
Validation loss decreased (inf --> -0.655543).  Saving model ...
Epoch: 2 cost time: 1.9834134578704834
Epoch: 2, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.698 Vali Acc: 0.756 Test Loss: 0.698 Test Acc: 0.756
Validation loss decreased (-0.655543 --> -0.755549).  Saving model ...
Epoch: 3 cost time: 2.1372385025024414
Epoch: 3, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.509 Vali Acc: 0.733 Test Loss: 0.509 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.067389726638794
Epoch: 4, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.477 Vali Acc: 0.767 Test Loss: 0.477 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 1.9930882453918457
Epoch: 5, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
Validation loss decreased (-0.766662 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 2.3784162998199463
Epoch: 6, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.341 Vali Acc: 0.872 Test Loss: 0.341 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 7 cost time: 2.0163307189941406
Epoch: 7, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.278 Vali Acc: 0.856 Test Loss: 0.278 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9931325912475586
Epoch: 8, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.053644895553589
Epoch: 9, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7376854419708252
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8631994724273682
Epoch: 11, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.345 Vali Acc: 0.828 Test Loss: 0.345 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.702868938446045
Epoch: 12, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7428483963012695
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 1.607003927230835
Epoch: 14, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.761505365371704
Epoch: 15, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.731809139251709
Epoch: 16, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.940197229385376
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 1.8431909084320068
Epoch: 18, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.342 Vali Acc: 0.894 Test Loss: 0.342 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.845041036605835
Epoch: 19, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.194070816040039
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 21 cost time: 2.0790975093841553
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 22 cost time: 1.9403307437896729
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1834065914154053
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1371452808380127
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.910611867904663
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9304780960083008
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.035606861114502
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.394 Vali Acc: 0.911 Test Loss: 0.394 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9738495349884033
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.124372720718384
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.067636728286743
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0167648792266846
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 1021414
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.893066167831421
Epoch: 1, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.502 Vali Acc: 0.683 Test Loss: 1.502 Test Acc: 0.683
Validation loss decreased (inf --> -0.683318).  Saving model ...
Epoch: 2 cost time: 1.7126169204711914
Epoch: 2, Steps: 12 | Train Loss: 1.079 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
Validation loss decreased (-0.683318 --> -0.699990).  Saving model ...
Epoch: 3 cost time: 1.6242949962615967
Epoch: 3, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.629 Vali Acc: 0.761 Test Loss: 0.629 Test Acc: 0.761
Validation loss decreased (-0.699990 --> -0.761105).  Saving model ...
Epoch: 4 cost time: 1.6442606449127197
Epoch: 4, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.501 Vali Acc: 0.767 Test Loss: 0.501 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 1.6426427364349365
Epoch: 5, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.428 Vali Acc: 0.783 Test Loss: 0.428 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.681147575378418
Epoch: 6, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.392 Vali Acc: 0.806 Test Loss: 0.392 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805552).  Saving model ...
Epoch: 7 cost time: 1.429750919342041
Epoch: 7, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
Validation loss decreased (-0.805552 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.7735481262207031
Epoch: 8, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866663).  Saving model ...
Epoch: 9 cost time: 1.615173578262329
Epoch: 9, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.638519525527954
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7374036312103271
Epoch: 11, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.6059906482696533
Epoch: 12, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6009302139282227
Epoch: 13, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7827939987182617
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6120879650115967
Epoch: 15, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.5894622802734375
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8670191764831543
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.615926742553711
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6991946697235107
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.8895776271820068
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.867 Test Loss: 0.245 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7724108695983887
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.255 Vali Acc: 0.867 Test Loss: 0.255 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8374617099761963
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.990596055984497
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.672071933746338
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7425899505615234
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8938863277435303
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 1.8372573852539062
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6129815578460693
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7390716075897217
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6302719116210938
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6643025875091553
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5074148178100586
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7207098007202148
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 34 cost time: 1.605243444442749
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8018872737884521
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.706049919128418
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.544529676437378
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5032291412353516
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 39 cost time: 1.5002989768981934
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7429933547973633
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.671224594116211
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7470154762268066
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.9504425525665283
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.7528173923492432
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7161104679107666
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.7428364753723145
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 1.7236664295196533
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 1.570103406906128
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.631645917892456
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6960515975952148
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 901638
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3418338298797607
Epoch: 1, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.475 Vali Acc: 0.628 Test Loss: 1.475 Test Acc: 0.628
Validation loss decreased (inf --> -0.627763).  Saving model ...
Epoch: 2 cost time: 1.7112321853637695
Epoch: 2, Steps: 12 | Train Loss: 1.102 Vali Loss: 0.895 Vali Acc: 0.756 Test Loss: 0.895 Test Acc: 0.756
Validation loss decreased (-0.627763 --> -0.755547).  Saving model ...
Epoch: 3 cost time: 1.685777187347412
Epoch: 3, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8610169887542725
Epoch: 4, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 1.631704330444336
Epoch: 5, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.446 Vali Acc: 0.767 Test Loss: 0.446 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.662468433380127
Epoch: 6, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.407 Vali Acc: 0.806 Test Loss: 0.407 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 1.5848379135131836
Epoch: 7, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.343 Vali Acc: 0.800 Test Loss: 0.343 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9914255142211914
Epoch: 8, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.6302976608276367
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6780829429626465
Epoch: 10, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.374 Vali Acc: 0.822 Test Loss: 0.374 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7127442359924316
Epoch: 11, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.7288098335266113
Epoch: 12, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6488947868347168
Epoch: 13, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8470921516418457
Epoch: 14, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.6638283729553223
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7470245361328125
Epoch: 16, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.293 Vali Acc: 0.817 Test Loss: 0.293 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7379207611083984
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 1.6818370819091797
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5260071754455566
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7054145336151123
Epoch: 20, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.252 Vali Acc: 0.883 Test Loss: 0.252 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 1.6801106929779053
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.771623134613037
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.6435120105743408
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 1.7915961742401123
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9380826950073242
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8502943515777588
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.8278987407684326
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8205313682556152
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9226787090301514
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.353 Vali Acc: 0.872 Test Loss: 0.353 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7524113655090332
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.800 Vali Acc: 0.817 Test Loss: 0.800 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7407143115997314
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.730412483215332
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9069700241088867
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5890939235687256
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6932728290557861
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.922 Test Loss: 0.321 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 1.6974053382873535
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7921490669250488
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7081868648529053
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7620530128479004
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.6708626747131348
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.7530694007873535
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.650451421737671
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6127581596374512
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.573901653289795
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 1.6955938339233398
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4878818988800049
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4427950382232666
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3894038200378418
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 49 cost time: 1.4790420532226562
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2998950481414795
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 901670
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3378050327301025
Epoch: 1, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.536 Vali Acc: 0.550 Test Loss: 1.536 Test Acc: 0.550
Validation loss decreased (inf --> -0.549985).  Saving model ...
Epoch: 2 cost time: 1.8331489562988281
Epoch: 2, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.042 Vali Acc: 0.706 Test Loss: 1.042 Test Acc: 0.706
Validation loss decreased (-0.549985 --> -0.705545).  Saving model ...
Epoch: 3 cost time: 1.7447166442871094
Epoch: 3, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.700 Vali Acc: 0.722 Test Loss: 0.700 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.658057689666748
Epoch: 4, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.547 Vali Acc: 0.767 Test Loss: 0.547 Test Acc: 0.767
Validation loss decreased (-0.722215 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 1.6453709602355957
Epoch: 5, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.457 Vali Acc: 0.772 Test Loss: 0.457 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772218).  Saving model ...
Epoch: 6 cost time: 1.673638105392456
Epoch: 6, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
Validation loss decreased (-0.772218 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 1.4940533638000488
Epoch: 7, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4893081188201904
Epoch: 8, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.7251338958740234
Epoch: 9, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6586599349975586
Epoch: 10, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.5831594467163086
Epoch: 11, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.641991376876831
Epoch: 12, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5766069889068604
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 1.544571876525879
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.538238525390625
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5426795482635498
Epoch: 16, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.833 Test Loss: 0.279 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6250557899475098
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.8464858531951904
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.222 Vali Acc: 0.883 Test Loss: 0.222 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6359519958496094
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.630021095275879
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.332 Vali Acc: 0.894 Test Loss: 0.332 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 1.876600742340088
Epoch: 21, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.225 Vali Acc: 0.878 Test Loss: 0.225 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7415201663970947
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.71779465675354
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.212 Vali Acc: 0.894 Test Loss: 0.212 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.9068684577941895
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7049076557159424
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.6244518756866455
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6836481094360352
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.6960008144378662
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 1.5139708518981934
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5808250904083252
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5239081382751465
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5443785190582275
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2278244495391846
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2230446338653564
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.628169059753418
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.6357982158660889
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5404934883117676
Epoch: 37, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7392632961273193
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 864870
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8878533840179443
Epoch: 1, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.594 Vali Acc: 0.556 Test Loss: 1.594 Test Acc: 0.556
Validation loss decreased (inf --> -0.555540).  Saving model ...
Epoch: 2 cost time: 1.4480860233306885
Epoch: 2, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.172 Vali Acc: 0.728 Test Loss: 1.172 Test Acc: 0.728
Validation loss decreased (-0.555540 --> -0.727766).  Saving model ...
Epoch: 3 cost time: 1.4745550155639648
Epoch: 3, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
Validation loss decreased (-0.727766 --> -0.761103).  Saving model ...
Epoch: 4 cost time: 1.6352002620697021
Epoch: 4, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.605 Vali Acc: 0.744 Test Loss: 0.605 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5860114097595215
Epoch: 5, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.5418663024902344
Epoch: 6, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.429 Vali Acc: 0.783 Test Loss: 0.429 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6432232856750488
Epoch: 7, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.788884 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.6832828521728516
Epoch: 8, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.656799077987671
Epoch: 9, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6621980667114258
Epoch: 10, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 1.6409995555877686
Epoch: 11, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6592812538146973
Epoch: 12, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.6762757301330566
Epoch: 13, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 1.5933125019073486
Epoch: 14, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 1.5831186771392822
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.513000249862671
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6076295375823975
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.467782974243164
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.4943900108337402
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5728936195373535
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.389 Vali Acc: 0.828 Test Loss: 0.389 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.588780164718628
Epoch: 21, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.558462381362915
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.56416654586792
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4671995639801025
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5910675525665283
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.582413673400879
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 1.6579477787017822
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.7012641429901123
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 1.8787660598754883
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8138244152069092
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7145915031433105
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6229462623596191
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 1.7811822891235352
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.586376667022705
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.939 Test Loss: 0.185 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 1.617849588394165
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4619169235229492
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4481194019317627
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6678156852722168
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5873291492462158
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5387167930603027
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5366566181182861
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.5761845111846924
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4793498516082764
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.6091327667236328
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.922 Test Loss: 0.173 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 837286
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.113140821456909
Epoch: 1, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.665 Vali Acc: 0.411 Test Loss: 1.665 Test Acc: 0.411
Validation loss decreased (inf --> -0.411094).  Saving model ...
Epoch: 2 cost time: 1.6115453243255615
Epoch: 2, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.357 Vali Acc: 0.656 Test Loss: 1.357 Test Acc: 0.656
Validation loss decreased (-0.411094 --> -0.655542).  Saving model ...
Epoch: 3 cost time: 1.463731050491333
Epoch: 3, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
Validation loss decreased (-0.655542 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.4775946140289307
Epoch: 4, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.771 Vali Acc: 0.733 Test Loss: 0.771 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 1.3488335609436035
Epoch: 5, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.633 Vali Acc: 0.744 Test Loss: 0.633 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 1.357795238494873
Epoch: 6, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.545 Vali Acc: 0.728 Test Loss: 0.545 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6173298358917236
Epoch: 7, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.482 Vali Acc: 0.772 Test Loss: 0.482 Test Acc: 0.772
Validation loss decreased (-0.744438 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.5108067989349365
Epoch: 8, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.452 Vali Acc: 0.778 Test Loss: 0.452 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.5496485233306885
Epoch: 9, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 1.5344905853271484
Epoch: 10, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.521674394607544
Epoch: 11, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.621154546737671
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5365676879882812
Epoch: 13, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 1.6673636436462402
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.6943600177764893
Epoch: 15, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6541082859039307
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 1.6394927501678467
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6018579006195068
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.55889892578125
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.701479196548462
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5300662517547607
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6089897155761719
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.441415548324585
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4386329650878906
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.6161577701568604
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4913129806518555
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 1.4496169090270996
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4339451789855957
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.4162702560424805
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4887161254882812
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.215 Vali Acc: 0.889 Test Loss: 0.215 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6963579654693604
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 32 cost time: 1.725266695022583
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 33 cost time: 1.6988270282745361
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6458358764648438
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7892048358917236
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7171556949615479
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7149059772491455
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.551781177520752
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6074070930480957
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.906 Test Loss: 0.201 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.707862377166748
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4715754985809326
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6063239574432373
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 818950
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.434418201446533
Epoch: 1, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.709 Vali Acc: 0.333 Test Loss: 1.709 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 1.7044134140014648
Epoch: 2, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.432 Vali Acc: 0.611 Test Loss: 1.432 Test Acc: 0.611
Validation loss decreased (-0.333316 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 1.7198598384857178
Epoch: 3, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.089 Vali Acc: 0.722 Test Loss: 1.089 Test Acc: 0.722
Validation loss decreased (-0.611097 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 1.6103105545043945
Epoch: 4, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.836 Vali Acc: 0.694 Test Loss: 0.836 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5154852867126465
Epoch: 5, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.678 Vali Acc: 0.739 Test Loss: 0.678 Test Acc: 0.739
Validation loss decreased (-0.722211 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.4899117946624756
Epoch: 6, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.5418047904968262
Epoch: 7, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 8 cost time: 1.488351821899414
Epoch: 8, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.458 Vali Acc: 0.794 Test Loss: 0.458 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.6300837993621826
Epoch: 9, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 1.4832916259765625
Epoch: 10, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.384 Vali Acc: 0.817 Test Loss: 0.384 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 1.4887211322784424
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.5731546878814697
Epoch: 12, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 1.5558841228485107
Epoch: 13, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.327 Vali Acc: 0.844 Test Loss: 0.327 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.4026298522949219
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.5770657062530518
Epoch: 15, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.6413524150848389
Epoch: 16, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 17 cost time: 1.4044947624206543
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.4487316608428955
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 1.6310687065124512
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.7046422958374023
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.6564092636108398
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6405425071716309
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.266 Vali Acc: 0.861 Test Loss: 0.266 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6124277114868164
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.256 Vali Acc: 0.867 Test Loss: 0.256 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7525544166564941
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6024901866912842
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 26 cost time: 1.643176555633545
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 27 cost time: 1.5106134414672852
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 1.3983852863311768
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4604318141937256
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 1.6554689407348633
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4001593589782715
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5760579109191895
Epoch: 32, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.421459436416626
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.253 Vali Acc: 0.878 Test Loss: 0.253 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.62640380859375
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.889 Test Loss: 0.214 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4247782230377197
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.883 Test Loss: 0.235 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5266304016113281
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6675031185150146
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.739137887954712
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6683263778686523
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7459702491760254
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6187715530395508
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 42 cost time: 1.6197943687438965
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5968661308288574
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5268535614013672
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 45 cost time: 1.567708969116211
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 46 cost time: 1.476628065109253
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 1.563676118850708
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5019786357879639
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.5735292434692383
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.50990891456604
Epoch: 50, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 819014
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.908565282821655
Epoch: 1, Steps: 12 | Train Loss: 1.371 Vali Loss: 0.799 Vali Acc: 0.706 Test Loss: 0.799 Test Acc: 0.706
Validation loss decreased (inf --> -0.705548).  Saving model ...
Epoch: 2 cost time: 4.027822494506836
Epoch: 2, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.461 Vali Acc: 0.783 Test Loss: 0.461 Test Acc: 0.783
Validation loss decreased (-0.705548 --> -0.783329).  Saving model ...
Epoch: 3 cost time: 3.7079873085021973
Epoch: 3, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.481 Vali Acc: 0.772 Test Loss: 0.481 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.719524621963501
Epoch: 4, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822219).  Saving model ...
Epoch: 5 cost time: 4.008021116256714
Epoch: 5, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.509 Vali Acc: 0.794 Test Loss: 0.509 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.83896803855896
Epoch: 6, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.417 Vali Acc: 0.811 Test Loss: 0.417 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.831389904022217
Epoch: 7, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
Validation loss decreased (-0.822219 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 4.209933757781982
Epoch: 8, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.395 Vali Acc: 0.872 Test Loss: 0.395 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872218).  Saving model ...
Epoch: 9 cost time: 4.329005241394043
Epoch: 9, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.369 Vali Acc: 0.878 Test Loss: 0.369 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 10 cost time: 4.569623708724976
Epoch: 10, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 11 cost time: 4.37610387802124
Epoch: 11, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.137911319732666
Epoch: 12, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.417 Vali Acc: 0.894 Test Loss: 0.417 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.210099697113037
Epoch: 13, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.924213409423828
Epoch: 14, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 15 cost time: 3.79118013381958
Epoch: 15, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.211982488632202
Epoch: 16, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.051586151123047
Epoch: 17, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.483321189880371
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.586 Vali Acc: 0.889 Test Loss: 0.586 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.472709655761719
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 4.078046798706055
Epoch: 20, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 4.021266460418701
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 4.006263256072998
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.260660171508789
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.131585597991943
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.0833539962768555
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.0107481479644775
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.906 Test Loss: 0.376 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.270678281784058
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.13987398147583
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.202584743499756
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.168962478637695
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.911 Test Loss: 0.343 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.320805549621582
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 9996166
model size : 38.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.9915382862091064
Epoch: 1, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.040 Vali Acc: 0.678 Test Loss: 1.040 Test Acc: 0.678
Validation loss decreased (inf --> -0.677767).  Saving model ...
Epoch: 2 cost time: 2.9169745445251465
Epoch: 2, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
Validation loss decreased (-0.677767 --> -0.749995).  Saving model ...
Epoch: 3 cost time: 2.8417248725891113
Epoch: 3, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.429 Vali Acc: 0.794 Test Loss: 0.429 Test Acc: 0.794
Validation loss decreased (-0.749995 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 2.6551270484924316
Epoch: 4, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.449 Vali Acc: 0.817 Test Loss: 0.449 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816662).  Saving model ...
Epoch: 5 cost time: 2.413806915283203
Epoch: 5, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.451 Vali Acc: 0.806 Test Loss: 0.451 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5072131156921387
Epoch: 6, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 2.711336135864258
Epoch: 7, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 3.2373645305633545
Epoch: 8, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.481 Vali Acc: 0.817 Test Loss: 0.481 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1108670234680176
Epoch: 9, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.369 Vali Acc: 0.839 Test Loss: 0.369 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 2.957348585128784
Epoch: 10, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.392 Vali Acc: 0.856 Test Loss: 0.392 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.915609359741211
Epoch: 11, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.968099594116211
Epoch: 12, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0246691703796387
Epoch: 13, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.780845880508423
Epoch: 14, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 2.7295010089874268
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.386 Vali Acc: 0.883 Test Loss: 0.386 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883329).  Saving model ...
Epoch: 16 cost time: 2.88732647895813
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8117446899414062
Epoch: 17, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.883329 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 2.9394233226776123
Epoch: 18, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1644935607910156
Epoch: 19, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.131112575531006
Epoch: 20, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 21 cost time: 2.958498239517212
Epoch: 21, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9423818588256836
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.431 Vali Acc: 0.878 Test Loss: 0.431 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.141078472137451
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.70646071434021
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.9603452682495117
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.894 Test Loss: 0.378 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.903088092803955
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.894 Test Loss: 0.351 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.82055926322937
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7749876976013184
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.7880146503448486
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.169229745864868
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.878 Test Loss: 0.705 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 9517062
model size : 36.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.109813928604126
Epoch: 1, Steps: 12 | Train Loss: 1.461 Vali Loss: 0.982 Vali Acc: 0.694 Test Loss: 0.982 Test Acc: 0.694
Validation loss decreased (inf --> -0.694435).  Saving model ...
Epoch: 2 cost time: 3.1541748046875
Epoch: 2, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.496 Vali Acc: 0.761 Test Loss: 0.496 Test Acc: 0.761
Validation loss decreased (-0.694435 --> -0.761106).  Saving model ...
Epoch: 3 cost time: 3.18867564201355
Epoch: 3, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
Validation loss decreased (-0.761106 --> -0.844441).  Saving model ...
Epoch: 4 cost time: 3.060652732849121
Epoch: 4, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.019667863845825
Epoch: 5, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.471 Vali Acc: 0.800 Test Loss: 0.471 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7012758255004883
Epoch: 6, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.269538164138794
Epoch: 7, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.844441 --> -0.877774).  Saving model ...
Epoch: 8 cost time: 3.3420119285583496
Epoch: 8, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.229428768157959
Epoch: 9, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 3.106309175491333
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.328345537185669
Epoch: 11, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.354 Vali Acc: 0.878 Test Loss: 0.354 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.075690746307373
Epoch: 12, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.371 Vali Acc: 0.883 Test Loss: 0.371 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.211522340774536
Epoch: 13, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 2.9606921672821045
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.980921506881714
Epoch: 15, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 2.8769257068634033
Epoch: 16, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 3.1196205615997314
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 3.207108974456787
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.894 Test Loss: 0.342 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.161715030670166
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 20 cost time: 3.4587807655334473
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3727128505706787
Epoch: 21, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1330018043518066
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.215235948562622
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.406 Vali Acc: 0.928 Test Loss: 0.406 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 24 cost time: 3.1205263137817383
Epoch: 24, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.788 Vali Acc: 0.861 Test Loss: 0.788 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.8355393409729004
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.811755657196045
Epoch: 26, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.415 Vali Acc: 0.844 Test Loss: 1.415 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3410775661468506
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.792 Vali Acc: 0.861 Test Loss: 0.792 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2824881076812744
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 2.712 Vali Acc: 0.689 Test Loss: 2.712 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3569397926330566
Epoch: 29, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.3350956439971924
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.730 Vali Acc: 0.828 Test Loss: 1.730 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.508125066757202
Epoch: 31, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.884 Vali Acc: 0.867 Test Loss: 0.884 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.1923015117645264
Epoch: 32, Steps: 12 | Train Loss: 0.341 Vali Loss: 2.047 Vali Acc: 0.839 Test Loss: 2.047 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.0313732624053955
Epoch: 33, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.656 Vali Acc: 0.878 Test Loss: 0.656 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 9517190
model size : 36.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.752410411834717
Epoch: 1, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.185 Vali Acc: 0.694 Test Loss: 1.185 Test Acc: 0.694
Validation loss decreased (inf --> -0.694433).  Saving model ...
Epoch: 2 cost time: 3.019726276397705
Epoch: 2, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.618 Vali Acc: 0.694 Test Loss: 0.618 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694438).  Saving model ...
Epoch: 3 cost time: 2.9717249870300293
Epoch: 3, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.504 Vali Acc: 0.750 Test Loss: 0.504 Test Acc: 0.750
Validation loss decreased (-0.694438 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 2.849588632583618
Epoch: 4, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.483 Vali Acc: 0.783 Test Loss: 0.483 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 2.572026491165161
Epoch: 5, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
Validation loss decreased (-0.783328 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 2.791438341140747
Epoch: 6, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.511852502822876
Epoch: 7, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.277488946914673
Epoch: 8, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.518314838409424
Epoch: 9, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.395 Vali Acc: 0.867 Test Loss: 0.395 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 2.6243882179260254
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.633402109146118
Epoch: 11, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9995596408843994
Epoch: 12, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.9109463691711426
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 2.8980727195739746
Epoch: 14, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8138275146484375
Epoch: 15, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.826321840286255
Epoch: 16, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.722118377685547
Epoch: 17, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.698369026184082
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.407315969467163
Epoch: 19, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6636099815368652
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5931143760681152
Epoch: 21, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.445 Vali Acc: 0.872 Test Loss: 0.445 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6208786964416504
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0288169384002686
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 9369990
model size : 35.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.599240303039551
Epoch: 1, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.308 Vali Acc: 0.633 Test Loss: 1.308 Test Acc: 0.633
Validation loss decreased (inf --> -0.633320).  Saving model ...
Epoch: 2 cost time: 2.6424479484558105
Epoch: 2, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.673 Vali Acc: 0.706 Test Loss: 0.673 Test Acc: 0.706
Validation loss decreased (-0.633320 --> -0.705549).  Saving model ...
Epoch: 3 cost time: 2.4156112670898438
Epoch: 3, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.483 Vali Acc: 0.756 Test Loss: 0.483 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755551).  Saving model ...
Epoch: 4 cost time: 2.479822874069214
Epoch: 4, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.401 Vali Acc: 0.800 Test Loss: 0.401 Test Acc: 0.800
Validation loss decreased (-0.755551 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 2.5519018173217773
Epoch: 5, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.359 Vali Acc: 0.800 Test Loss: 0.359 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.881436586380005
Epoch: 6, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.417 Vali Acc: 0.828 Test Loss: 0.417 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.9553427696228027
Epoch: 7, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.854320526123047
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 3.0298819541931152
Epoch: 9, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9612338542938232
Epoch: 10, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.286 Vali Acc: 0.833 Test Loss: 0.286 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7226016521453857
Epoch: 11, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 2.7826027870178223
Epoch: 12, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.870405673980713
Epoch: 13, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.455 Vali Acc: 0.844 Test Loss: 0.455 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.540423631668091
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7817893028259277
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8215525150299072
Epoch: 16, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 2.9470067024230957
Epoch: 17, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.877885580062866
Epoch: 18, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8509764671325684
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 3.1346824169158936
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.816209316253662
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 2.5909292697906494
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 2.6205127239227295
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 2.5663318634033203
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.581472396850586
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.416 Vali Acc: 0.894 Test Loss: 0.416 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.6751902103424072
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.711909770965576
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.971513271331787
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.393 Vali Acc: 0.867 Test Loss: 0.393 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.953524112701416
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.491 Vali Acc: 0.894 Test Loss: 0.491 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.6117873191833496
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.7370498180389404
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.8176114559173584
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.6363954544067383
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 9259654
model size : 35.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.4893271923065186
Epoch: 1, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.428 Vali Acc: 0.622 Test Loss: 1.428 Test Acc: 0.622
Validation loss decreased (inf --> -0.622208).  Saving model ...
Epoch: 2 cost time: 2.7358837127685547
Epoch: 2, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
Validation loss decreased (-0.622208 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 2.881134271621704
Epoch: 3, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 2.844050884246826
Epoch: 4, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.407 Vali Acc: 0.783 Test Loss: 0.407 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 2.654500961303711
Epoch: 5, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.378 Vali Acc: 0.806 Test Loss: 0.378 Test Acc: 0.806
Validation loss decreased (-0.783329 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 2.7461156845092773
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.6349494457244873
Epoch: 7, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.398 Vali Acc: 0.828 Test Loss: 0.398 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4547016620635986
Epoch: 8, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5916662216186523
Epoch: 9, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.675995349884033
Epoch: 10, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.290 Vali Acc: 0.883 Test Loss: 0.290 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 2.5439207553863525
Epoch: 11, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.534755229949951
Epoch: 12, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.325 Vali Acc: 0.883 Test Loss: 0.325 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.709749937057495
Epoch: 13, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9200806617736816
Epoch: 14, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.343 Vali Acc: 0.872 Test Loss: 0.343 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.794907569885254
Epoch: 15, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7349720001220703
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.883330 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 2.776441812515259
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.704761028289795
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.757805824279785
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6265435218811035
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6540629863739014
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4726693630218506
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9044315814971924
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5761260986328125
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4858319759368896
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 3.0682756900787354
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.65055775642395
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9135801792144775
Epoch: 28, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.7458314895629883
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9026436805725098
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.85891056060791
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.7462410926818848
Epoch: 32, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.8428993225097656
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.924936294555664
Epoch: 34, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.789 Vali Acc: 0.861 Test Loss: 0.789 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.595463991165161
Epoch: 35, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.630 Vali Acc: 0.889 Test Loss: 0.630 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 9186310
model size : 35.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.242709636688232
Epoch: 1, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.433 Vali Acc: 0.589 Test Loss: 1.433 Test Acc: 0.589
Validation loss decreased (inf --> -0.588875).  Saving model ...
Epoch: 2 cost time: 2.1551730632781982
Epoch: 2, Steps: 12 | Train Loss: 0.941 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
Validation loss decreased (-0.588875 --> -0.716659).  Saving model ...
Epoch: 3 cost time: 2.204829692840576
Epoch: 3, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.540 Vali Acc: 0.756 Test Loss: 0.540 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 2.5676112174987793
Epoch: 4, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.426 Vali Acc: 0.783 Test Loss: 0.426 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 2.6538333892822266
Epoch: 5, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 2.6673049926757812
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.405 Vali Acc: 0.833 Test Loss: 0.405 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 2.6327016353607178
Epoch: 7, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5915017127990723
Epoch: 8, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.315 Vali Acc: 0.883 Test Loss: 0.315 Test Acc: 0.883
Validation loss decreased (-0.833329 --> -0.883330).  Saving model ...
Epoch: 9 cost time: 2.6195709705352783
Epoch: 9, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 10 cost time: 2.372133731842041
Epoch: 10, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4449830055236816
Epoch: 11, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5317420959472656
Epoch: 12, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 2.209415912628174
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.389 Vali Acc: 0.878 Test Loss: 0.389 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2591168880462646
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.372 Vali Acc: 0.856 Test Loss: 0.372 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1252079010009766
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4993999004364014
Epoch: 16, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 2.7008650302886963
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 2.6678390502929688
Epoch: 18, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 19 cost time: 2.7350451946258545
Epoch: 19, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.849966287612915
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.652292013168335
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.677079439163208
Epoch: 22, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6145412921905518
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.446018695831299
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.342 Vali Acc: 0.911 Test Loss: 0.342 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 2.4867162704467773
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.406564950942993
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 2.2568342685699463
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.807 Vali Acc: 0.883 Test Loss: 0.807 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8114545345306396
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9039266109466553
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.403 Vali Acc: 0.883 Test Loss: 0.403 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.873267889022827
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.657 Vali Acc: 0.883 Test Loss: 0.657 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.9030160903930664
Epoch: 31, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.958277702331543
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.924206018447876
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.5290472507476807
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.5143842697143555
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.490373134613037
Epoch: 36, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.505 Vali Acc: 0.911 Test Loss: 0.505 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.542281150817871
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.515578508377075
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.4596171379089355
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.906 Test Loss: 0.383 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.660930633544922
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.911 Test Loss: 0.348 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.745807409286499
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.5813238620758057
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 9186566
model size : 35.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.715938091278076
Epoch: 1, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.014 Vali Acc: 0.711 Test Loss: 1.014 Test Acc: 0.711
Validation loss decreased (inf --> -0.711101).  Saving model ...
Epoch: 2 cost time: 2.8147358894348145
Epoch: 2, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.592 Vali Acc: 0.711 Test Loss: 0.592 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711105).  Saving model ...
Epoch: 3 cost time: 2.725851535797119
Epoch: 3, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.552 Vali Acc: 0.756 Test Loss: 0.552 Test Acc: 0.756
Validation loss decreased (-0.711105 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 2.896001100540161
Epoch: 4, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.755550 --> -0.833330).  Saving model ...
Epoch: 5 cost time: 2.9076459407806396
Epoch: 5, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.409 Vali Acc: 0.839 Test Loss: 0.409 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 2.5345003604888916
Epoch: 6, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872220).  Saving model ...
Epoch: 7 cost time: 2.7350406646728516
Epoch: 7, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.892951488494873
Epoch: 8, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 2.782712936401367
Epoch: 9, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.445 Vali Acc: 0.856 Test Loss: 0.445 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0078628063201904
Epoch: 10, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 11 cost time: 2.984124183654785
Epoch: 11, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.371 Vali Acc: 0.872 Test Loss: 0.371 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9974236488342285
Epoch: 12, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7960054874420166
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8650429248809814
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.639939308166504
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.654 Vali Acc: 0.861 Test Loss: 0.654 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9649322032928467
Epoch: 16, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0345945358276367
Epoch: 17, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 18 cost time: 2.516066312789917
Epoch: 18, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8939030170440674
Epoch: 19, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9450390338897705
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.883 Test Loss: 0.302 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8650295734405518
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.1072380542755127
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 2.9101548194885254
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 2.778825283050537
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.93951678276062
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8300070762634277
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.8335018157958984
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.8495066165924072
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 2.9108049869537354
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6361308097839355
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.8750739097595215
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.7655723094940186
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 2.8200762271881104
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.9528307914733887
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 35 cost time: 2.9631004333496094
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.8930702209472656
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.8592231273651123
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.9412171840667725
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.8631203174591064
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 40 cost time: 2.850336790084839
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.8664462566375732
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 42 cost time: 2.903942584991455
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.8136935234069824
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.712008237838745
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.753073215484619
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.7034456729888916
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 47 cost time: 3.1184844970703125
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.044747829437256
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.9293251037597656
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.8718698024749756
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 3015622
model size : 11.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.345367193222046
Epoch: 1, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.253 Vali Acc: 0.683 Test Loss: 1.253 Test Acc: 0.683
Validation loss decreased (inf --> -0.683321).  Saving model ...
Epoch: 2 cost time: 2.4415688514709473
Epoch: 2, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
Validation loss decreased (-0.683321 --> -0.749994).  Saving model ...
Epoch: 3 cost time: 2.3420979976654053
Epoch: 3, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.473 Vali Acc: 0.794 Test Loss: 0.473 Test Acc: 0.794
Validation loss decreased (-0.749994 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 2.4595372676849365
Epoch: 4, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.469 Vali Acc: 0.772 Test Loss: 0.469 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.499011754989624
Epoch: 5, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.435 Vali Acc: 0.783 Test Loss: 0.435 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6184639930725098
Epoch: 6, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822217).  Saving model ...
Epoch: 7 cost time: 2.4933290481567383
Epoch: 7, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.464 Vali Acc: 0.811 Test Loss: 0.464 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3868629932403564
Epoch: 8, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
Validation loss decreased (-0.822217 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 2.395700454711914
Epoch: 9, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.406 Vali Acc: 0.839 Test Loss: 0.406 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.250941753387451
Epoch: 10, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 2.294656991958618
Epoch: 11, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2930970191955566
Epoch: 12, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.877775 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 2.3133206367492676
Epoch: 13, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5791923999786377
Epoch: 14, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 15 cost time: 2.3405961990356445
Epoch: 15, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6118216514587402
Epoch: 16, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5699946880340576
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5966081619262695
Epoch: 18, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.631115674972534
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 2.495062828063965
Epoch: 20, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5513558387756348
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6144907474517822
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.894 Test Loss: 0.335 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3781118392944336
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3069400787353516
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4844882488250732
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7849385738372803
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8074376583099365
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.5858285427093506
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.37650203704834
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2776070
model size : 10.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.173285961151123
Epoch: 1, Steps: 12 | Train Loss: 1.542 Vali Loss: 1.271 Vali Acc: 0.756 Test Loss: 1.271 Test Acc: 0.756
Validation loss decreased (inf --> -0.755543).  Saving model ...
Epoch: 2 cost time: 2.571772575378418
Epoch: 2, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.643 Vali Acc: 0.733 Test Loss: 0.643 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2893457412719727
Epoch: 3, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.471 Vali Acc: 0.772 Test Loss: 0.471 Test Acc: 0.772
Validation loss decreased (-0.755543 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 2.2715003490448
Epoch: 4, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.431 Vali Acc: 0.800 Test Loss: 0.431 Test Acc: 0.800
Validation loss decreased (-0.772218 --> -0.799996).  Saving model ...
Epoch: 5 cost time: 2.4517874717712402
Epoch: 5, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.356 Vali Acc: 0.817 Test Loss: 0.356 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 2.4134938716888428
Epoch: 6, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.359 Vali Acc: 0.806 Test Loss: 0.359 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4151556491851807
Epoch: 7, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 2.3041768074035645
Epoch: 8, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4223172664642334
Epoch: 9, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.56585955619812
Epoch: 10, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
Validation loss decreased (-0.866664 --> -0.899997).  Saving model ...
Epoch: 11 cost time: 2.0265772342681885
Epoch: 11, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1592354774475098
Epoch: 12, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.365 Vali Acc: 0.844 Test Loss: 0.365 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.267282009124756
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.503 Vali Acc: 0.839 Test Loss: 0.503 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.247438907623291
Epoch: 14, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.184577226638794
Epoch: 15, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3421175479888916
Epoch: 16, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3810417652130127
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.40307879447937
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6057772636413574
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 20 cost time: 2.5331742763519287
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7407312393188477
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.292297124862671
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4004082679748535
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.334822654724121
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.402 Vali Acc: 0.894 Test Loss: 0.402 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.205714225769043
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.390 Vali Acc: 0.894 Test Loss: 0.390 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.317204713821411
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.296485662460327
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 2.40608549118042
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.306698799133301
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4824016094207764
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.593752145767212
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.448782205581665
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.4448297023773193
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.928 Test Loss: 0.275 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.6155078411102295
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.287529706954956
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.32087779045105
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.0831992626190186
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2776134
model size : 10.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.203611135482788
Epoch: 1, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.386 Vali Acc: 0.628 Test Loss: 1.386 Test Acc: 0.628
Validation loss decreased (inf --> -0.627764).  Saving model ...
Epoch: 2 cost time: 2.2221100330352783
Epoch: 2, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.766 Vali Acc: 0.739 Test Loss: 0.766 Test Acc: 0.739
Validation loss decreased (-0.627764 --> -0.738881).  Saving model ...
Epoch: 3 cost time: 2.7218210697174072
Epoch: 3, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.521 Vali Acc: 0.772 Test Loss: 0.521 Test Acc: 0.772
Validation loss decreased (-0.738881 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 2.511079788208008
Epoch: 4, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.461 Vali Acc: 0.778 Test Loss: 0.461 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 2.3564155101776123
Epoch: 5, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.329313039779663
Epoch: 6, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
Validation loss decreased (-0.799996 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.3779211044311523
Epoch: 7, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.256864309310913
Epoch: 8, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2009236812591553
Epoch: 9, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.154595136642456
Epoch: 10, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.908559799194336
Epoch: 11, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1705071926116943
Epoch: 12, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 2.3725836277008057
Epoch: 13, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 2.297797918319702
Epoch: 14, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 2.1850855350494385
Epoch: 15, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 2.5138399600982666
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4866650104522705
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.41610050201416
Epoch: 18, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.418511390686035
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2463269233703613
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.186627149581909
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 2.3205666542053223
Epoch: 22, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.875971794128418
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.065584182739258
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.135615825653076
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3194010257720947
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 2.137643337249756
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2166905403137207
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9568331241607666
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2342123985290527
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.3593063354492188
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.086465358734131
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.034022808074951
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.928 Test Loss: 0.164 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.0752861499786377
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.386 Vali Acc: 0.906 Test Loss: 0.386 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9871363639831543
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.053363084793091
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2702534
model size : 10.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0649168491363525
Epoch: 1, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.470 Vali Acc: 0.539 Test Loss: 1.470 Test Acc: 0.539
Validation loss decreased (inf --> -0.538874).  Saving model ...
Epoch: 2 cost time: 2.107598066329956
Epoch: 2, Steps: 12 | Train Loss: 1.060 Vali Loss: 0.902 Vali Acc: 0.711 Test Loss: 0.902 Test Acc: 0.711
Validation loss decreased (-0.538874 --> -0.711102).  Saving model ...
Epoch: 3 cost time: 1.9925305843353271
Epoch: 3, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.590 Vali Acc: 0.744 Test Loss: 0.590 Test Acc: 0.744
Validation loss decreased (-0.711102 --> -0.744439).  Saving model ...
Epoch: 4 cost time: 1.9328930377960205
Epoch: 4, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.454 Vali Acc: 0.767 Test Loss: 0.454 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 1.9685051441192627
Epoch: 5, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.9301481246948242
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.378 Vali Acc: 0.789 Test Loss: 0.378 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8443458080291748
Epoch: 7, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
Validation loss decreased (-0.794440 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 2.0869975090026855
Epoch: 8, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1390373706817627
Epoch: 9, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9244117736816406
Epoch: 10, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.257 Vali Acc: 0.878 Test Loss: 0.257 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 2.13761830329895
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1001808643341064
Epoch: 12, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.233011245727539
Epoch: 13, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.250 Vali Acc: 0.883 Test Loss: 0.250 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 2.322871208190918
Epoch: 14, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.267 Vali Acc: 0.872 Test Loss: 0.267 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.10448956489563
Epoch: 15, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.231 Vali Acc: 0.878 Test Loss: 0.231 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.926307201385498
Epoch: 16, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.021806478500366
Epoch: 17, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.231 Vali Acc: 0.883 Test Loss: 0.231 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 1.7778773307800293
Epoch: 18, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 1.958876371383667
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 1.799084186553955
Epoch: 20, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1265339851379395
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1156527996063232
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2303693294525146
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.142873764038086
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2502388954162598
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1759626865386963
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 2.122065782546997
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2388830184936523
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6966099739074707
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7267770767211914
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 1.6935110092163086
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6692302227020264
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.939 Test Loss: 0.212 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 33 cost time: 1.7590572834014893
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2080695629119873
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8779337406158447
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.3202285766601562
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.260175943374634
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.315 Vali Acc: 0.928 Test Loss: 0.315 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.0968680381774902
Epoch: 38, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.3606202602386475
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.0098328590393066
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.1532742977142334
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.096477746963501
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 43 cost time: 1.9322872161865234
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8932530879974365
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.9401490688323975
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.8689391613006592
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.0774548053741455
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.893763542175293
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.1843101978302
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.176912546157837
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2647366
model size : 10.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.25369930267334
Epoch: 1, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.560 Vali Acc: 0.572 Test Loss: 1.560 Test Acc: 0.572
Validation loss decreased (inf --> -0.572207).  Saving model ...
Epoch: 2 cost time: 1.8861331939697266
Epoch: 2, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.050 Vali Acc: 0.700 Test Loss: 1.050 Test Acc: 0.700
Validation loss decreased (-0.572207 --> -0.699990).  Saving model ...
Epoch: 3 cost time: 1.777557134628296
Epoch: 3, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.688 Vali Acc: 0.722 Test Loss: 0.688 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722215).  Saving model ...
Epoch: 4 cost time: 1.799257516860962
Epoch: 4, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.505 Vali Acc: 0.772 Test Loss: 0.505 Test Acc: 0.772
Validation loss decreased (-0.722215 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 1.6821110248565674
Epoch: 5, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.7581911087036133
Epoch: 6, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.403 Vali Acc: 0.794 Test Loss: 0.403 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 2.2121777534484863
Epoch: 7, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.9473135471343994
Epoch: 8, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 2.054288625717163
Epoch: 9, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.926384449005127
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0832629203796387
Epoch: 11, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 1.9269988536834717
Epoch: 12, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.240 Vali Acc: 0.867 Test Loss: 0.240 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.9714677333831787
Epoch: 13, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9348254203796387
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7057642936706543
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.267 Vali Acc: 0.850 Test Loss: 0.267 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9031851291656494
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.249 Vali Acc: 0.867 Test Loss: 0.249 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7751219272613525
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.256 Vali Acc: 0.867 Test Loss: 0.256 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6578328609466553
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.240 Vali Acc: 0.872 Test Loss: 0.240 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 19 cost time: 1.8107609748840332
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.272 Vali Acc: 0.839 Test Loss: 0.272 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0651447772979736
Epoch: 20, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1972737312316895
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 2.065382242202759
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0783326625823975
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899998).  Saving model ...
Epoch: 24 cost time: 2.124189615249634
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8401474952697754
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.894 Test Loss: 0.205 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7002344131469727
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9390172958374023
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.369 Vali Acc: 0.872 Test Loss: 0.369 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9229371547698975
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 29 cost time: 1.8200786113739014
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.019157648086548
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.9326066970825195
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0046722888946533
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8297617435455322
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9625144004821777
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.0942792892456055
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 2.2004685401916504
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7626898288726807
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 38 cost time: 1.823070764541626
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.903559684753418
Epoch: 39, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9266858100891113
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.9551777839660645
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.0767502784729004
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.442 Vali Acc: 0.889 Test Loss: 0.442 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.9500088691711426
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9944713115692139
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.0514891147613525
Epoch: 45, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.659 Vali Acc: 0.883 Test Loss: 0.659 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.7703933715820312
Epoch: 46, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.669 Vali Acc: 0.872 Test Loss: 0.669 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.9831643104553223
Epoch: 47, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.335 Vali Acc: 0.894 Test Loss: 0.335 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2610694
model size : 10.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.07550573348999
Epoch: 1, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.602 Vali Acc: 0.594 Test Loss: 1.602 Test Acc: 0.594
Validation loss decreased (inf --> -0.594428).  Saving model ...
Epoch: 2 cost time: 1.701167106628418
Epoch: 2, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.094 Vali Acc: 0.706 Test Loss: 1.094 Test Acc: 0.706
Validation loss decreased (-0.594428 --> -0.705545).  Saving model ...
Epoch: 3 cost time: 1.8940649032592773
Epoch: 3, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.716 Vali Acc: 0.744 Test Loss: 0.716 Test Acc: 0.744
Validation loss decreased (-0.705545 --> -0.744437).  Saving model ...
Epoch: 4 cost time: 1.9289448261260986
Epoch: 4, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.552 Vali Acc: 0.744 Test Loss: 0.552 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.976787805557251
Epoch: 5, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.455 Vali Acc: 0.794 Test Loss: 0.455 Test Acc: 0.794
Validation loss decreased (-0.744439 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 2.185549020767212
Epoch: 6, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 2.0676074028015137
Epoch: 7, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
Validation loss decreased (-0.805551 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.9460842609405518
Epoch: 8, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.087775707244873
Epoch: 9, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 1.9087927341461182
Epoch: 10, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6712408065795898
Epoch: 11, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 1.7919042110443115
Epoch: 12, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 1.812741994857788
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8657636642456055
Epoch: 14, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9787991046905518
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.7642450332641602
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.390 Vali Acc: 0.883 Test Loss: 0.390 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883329).  Saving model ...
Epoch: 17 cost time: 1.906662940979004
Epoch: 17, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9971692562103271
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.158607006072998
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.217 Vali Acc: 0.889 Test Loss: 0.217 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888887).  Saving model ...
Epoch: 20 cost time: 2.007342576980591
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0575449466705322
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
Validation loss decreased (-0.888887 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 1.8669462203979492
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7709567546844482
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.727372169494629
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7736947536468506
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.00632905960083
Epoch: 26, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9507358074188232
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9960119724273682
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 1.9874577522277832
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0201103687286377
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.2219650745391846
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.090860605239868
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0503015518188477
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.168645143508911
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.1170201301574707
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.0892550945281982
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.812621831893921
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.03650164604187
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2610822
model size : 10.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.258429050445557
Epoch: 1, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.322 Vali Acc: 0.717 Test Loss: 1.322 Test Acc: 0.717
Validation loss decreased (inf --> -0.716653).  Saving model ...
Epoch: 2 cost time: 2.1314568519592285
Epoch: 2, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.711 Vali Acc: 0.761 Test Loss: 0.711 Test Acc: 0.761
Validation loss decreased (-0.716653 --> -0.761104).  Saving model ...
Epoch: 3 cost time: 2.224604845046997
Epoch: 3, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.528 Vali Acc: 0.739 Test Loss: 0.528 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.238278388977051
Epoch: 4, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.423 Vali Acc: 0.828 Test Loss: 0.423 Test Acc: 0.828
Validation loss decreased (-0.761104 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 2.1751275062561035
Epoch: 5, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3189311027526855
Epoch: 6, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.318 Vali Acc: 0.817 Test Loss: 0.318 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0964038372039795
Epoch: 7, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 8 cost time: 2.124948740005493
Epoch: 8, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.367 Vali Acc: 0.861 Test Loss: 0.367 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 1.8253698348999023
Epoch: 9, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8824665546417236
Epoch: 10, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.368 Vali Acc: 0.872 Test Loss: 0.368 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.8139638900756836
Epoch: 11, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.890089750289917
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3225433826446533
Epoch: 13, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.0911080837249756
Epoch: 14, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1748340129852295
Epoch: 15, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 2.3687846660614014
Epoch: 16, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0677974224090576
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3068630695343018
Epoch: 18, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927775).  Saving model ...
Epoch: 19 cost time: 2.1513729095458984
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0530502796173096
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.001512050628662
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8979511260986328
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.108468532562256
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 24 cost time: 1.950378179550171
Epoch: 24, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9665067195892334
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 2.0450165271759033
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1583750247955322
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.089110851287842
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.939 Test Loss: 0.243 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 29 cost time: 2.284299612045288
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3020663261413574
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.176821231842041
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 32 cost time: 2.3342363834381104
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8399925231933594
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9412400722503662
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0611140727996826
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.1823232173919678
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.795856237411499
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 2.091782808303833
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.235410451889038
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.348367929458618
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.4029757976531982
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.186486005783081
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.3505184650421143
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.1865224838256836
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.9366796016693115
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.111079216003418
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.90523362159729
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1012198
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4219114780426025
Epoch: 1, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.495 Vali Acc: 0.644 Test Loss: 1.495 Test Acc: 0.644
Validation loss decreased (inf --> -0.644429).  Saving model ...
Epoch: 2 cost time: 1.8218519687652588
Epoch: 2, Steps: 12 | Train Loss: 1.134 Vali Loss: 0.943 Vali Acc: 0.689 Test Loss: 0.943 Test Acc: 0.689
Validation loss decreased (-0.644429 --> -0.688879).  Saving model ...
Epoch: 3 cost time: 1.7934589385986328
Epoch: 3, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.628 Vali Acc: 0.728 Test Loss: 0.628 Test Acc: 0.728
Validation loss decreased (-0.688879 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.8966703414916992
Epoch: 4, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.480 Vali Acc: 0.772 Test Loss: 0.480 Test Acc: 0.772
Validation loss decreased (-0.727771 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.04950213432312
Epoch: 5, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.6577014923095703
Epoch: 6, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.374 Vali Acc: 0.794 Test Loss: 0.374 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6951193809509277
Epoch: 7, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.7639317512512207
Epoch: 8, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.360 Vali Acc: 0.800 Test Loss: 0.360 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6563599109649658
Epoch: 9, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.8019499778747559
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 2.0518064498901367
Epoch: 11, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 1.7663519382476807
Epoch: 12, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.8900823593139648
Epoch: 13, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.247 Vali Acc: 0.878 Test Loss: 0.247 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 1.9676198959350586
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.298 Vali Acc: 0.839 Test Loss: 0.298 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.928971529006958
Epoch: 15, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.720841407775879
Epoch: 16, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 1.9562873840332031
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8666355609893799
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.368 Vali Acc: 0.894 Test Loss: 0.368 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 1.7274091243743896
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.8690965175628662
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0395689010620117
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8357388973236084
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.82133150100708
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.883 Test Loss: 0.218 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6464166641235352
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 1.9788949489593506
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9263687133789062
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8072600364685059
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 1.8814384937286377
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7761685848236084
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.854600429534912
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7749874591827393
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.791877269744873
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.733412265777588
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8252406120300293
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5442368984222412
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9075818061828613
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 1.8617262840270996
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7620015144348145
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8578755855560303
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9661729335784912
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.8466401100158691
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8720991611480713
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8130278587341309
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.098619222640991
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.7604856491088867
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7988595962524414
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 892422
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.237781524658203
Epoch: 1, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.467 Vali Acc: 0.667 Test Loss: 1.467 Test Acc: 0.667
Validation loss decreased (inf --> -0.666652).  Saving model ...
Epoch: 2 cost time: 1.9704499244689941
Epoch: 2, Steps: 12 | Train Loss: 1.084 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
Validation loss decreased (-0.666652 --> -0.722213).  Saving model ...
Epoch: 3 cost time: 1.9233667850494385
Epoch: 3, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.615 Vali Acc: 0.711 Test Loss: 0.615 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0186007022857666
Epoch: 4, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.489 Vali Acc: 0.778 Test Loss: 0.489 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 1.9481394290924072
Epoch: 5, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.445 Vali Acc: 0.767 Test Loss: 0.445 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7903900146484375
Epoch: 6, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.398 Vali Acc: 0.800 Test Loss: 0.398 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 2.0233800411224365
Epoch: 7, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 2.1576085090637207
Epoch: 8, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.373 Vali Acc: 0.800 Test Loss: 0.373 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 1.68013334274292
Epoch: 9, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 1.69871187210083
Epoch: 10, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.492405652999878
Epoch: 11, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861107).  Saving model ...
Epoch: 12 cost time: 1.661510944366455
Epoch: 12, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.6133754253387451
Epoch: 13, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 1.7159581184387207
Epoch: 14, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.6691856384277344
Epoch: 15, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 1.9386186599731445
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9656391143798828
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.00563907623291
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.989542007446289
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.9651691913604736
Epoch: 20, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 2.084960460662842
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.264 Vali Acc: 0.872 Test Loss: 0.264 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9029037952423096
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.286 Vali Acc: 0.861 Test Loss: 0.286 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.680286169052124
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 24 cost time: 1.6569864749908447
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 1.6259713172912598
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7017745971679688
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.6862964630126953
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.740907907485962
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.817272424697876
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 2.013747453689575
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.755983591079712
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.081822395324707
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 2.0561718940734863
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9342424869537354
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0051310062408447
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5792529582977295
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 37 cost time: 1.7565438747406006
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7201130390167236
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.373600959777832
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8743488788604736
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.374 Vali Acc: 0.906 Test Loss: 0.374 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7100374698638916
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6417608261108398
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.646143913269043
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.946990728378296
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.844763994216919
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.609264850616455
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 892454
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7879340648651123
Epoch: 1, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.516 Vali Acc: 0.561 Test Loss: 1.516 Test Acc: 0.561
Validation loss decreased (inf --> -0.561096).  Saving model ...
Epoch: 2 cost time: 1.728044033050537
Epoch: 2, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.045 Vali Acc: 0.717 Test Loss: 1.045 Test Acc: 0.717
Validation loss decreased (-0.561096 --> -0.716656).  Saving model ...
Epoch: 3 cost time: 1.6098153591156006
Epoch: 3, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
Validation loss decreased (-0.716656 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.5940608978271484
Epoch: 4, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 1.7550573348999023
Epoch: 5, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.433 Vali Acc: 0.789 Test Loss: 0.433 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 1.855588674545288
Epoch: 6, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.7810697555541992
Epoch: 7, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.356 Vali Acc: 0.833 Test Loss: 0.356 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.8260364532470703
Epoch: 8, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.598149061203003
Epoch: 9, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.640984058380127
Epoch: 10, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.6166305541992188
Epoch: 11, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4942047595977783
Epoch: 12, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8355393409729004
Epoch: 13, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5898497104644775
Epoch: 14, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8737819194793701
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.986004114151001
Epoch: 16, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.828211784362793
Epoch: 17, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.794997215270996
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.230 Vali Acc: 0.867 Test Loss: 0.230 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.803553819656372
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.268 Vali Acc: 0.861 Test Loss: 0.268 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8173038959503174
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.8802149295806885
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8385305404663086
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8240156173706055
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.620832920074463
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5888357162475586
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.191 Vali Acc: 0.911 Test Loss: 0.191 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 1.5724706649780273
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 1.7255537509918213
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 1.8735196590423584
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.922 Test Loss: 0.160 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7786145210266113
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8768384456634521
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.900 Test Loss: 0.208 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7219455242156982
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7235462665557861
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.763486385345459
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6672723293304443
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7173593044281006
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5480425357818604
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.906 Test Loss: 0.206 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8368024826049805
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 855654
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.372020244598389
Epoch: 1, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.592 Vali Acc: 0.539 Test Loss: 1.592 Test Acc: 0.539
Validation loss decreased (inf --> -0.538873).  Saving model ...
Epoch: 2 cost time: 1.4826114177703857
Epoch: 2, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.166 Vali Acc: 0.611 Test Loss: 1.166 Test Acc: 0.611
Validation loss decreased (-0.538873 --> -0.611099).  Saving model ...
Epoch: 3 cost time: 1.7492470741271973
Epoch: 3, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.827 Vali Acc: 0.700 Test Loss: 0.827 Test Acc: 0.700
Validation loss decreased (-0.611099 --> -0.699992).  Saving model ...
Epoch: 4 cost time: 1.7906532287597656
Epoch: 4, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.622 Vali Acc: 0.761 Test Loss: 0.622 Test Acc: 0.761
Validation loss decreased (-0.699992 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 1.7240960597991943
Epoch: 5, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.518 Vali Acc: 0.750 Test Loss: 0.518 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6010897159576416
Epoch: 6, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
Validation loss decreased (-0.761105 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.5901329517364502
Epoch: 7, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.394 Vali Acc: 0.822 Test Loss: 0.394 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.6989352703094482
Epoch: 8, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.4483075141906738
Epoch: 9, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 10 cost time: 1.7752621173858643
Epoch: 10, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
Validation loss decreased (-0.838886 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 1.55836820602417
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.550105094909668
Epoch: 12, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4924297332763672
Epoch: 13, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 1.4368371963500977
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5034992694854736
Epoch: 15, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.251 Vali Acc: 0.867 Test Loss: 0.251 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 1.4674086570739746
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.234 Vali Acc: 0.872 Test Loss: 0.234 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872220).  Saving model ...
Epoch: 17 cost time: 1.5242412090301514
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 1.664247751235962
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.247 Vali Acc: 0.867 Test Loss: 0.247 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4990830421447754
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.6967813968658447
Epoch: 20, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6183123588562012
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8828141689300537
Epoch: 22, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.248 Vali Acc: 0.878 Test Loss: 0.248 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6649887561798096
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.8853673934936523
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8156554698944092
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 1.6358559131622314
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6945247650146484
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6554994583129883
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.572077989578247
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5602152347564697
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 1.598275899887085
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 1.7003669738769531
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.928 Test Loss: 0.162 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 33 cost time: 1.5962138175964355
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6921005249023438
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8986711502075195
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.569321870803833
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6087498664855957
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.651139736175537
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6131746768951416
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.0763492584228516
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.7267465591430664
Epoch: 41, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6068034172058105
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 828070
model size : 3.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7048301696777344
Epoch: 1, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.651 Vali Acc: 0.311 Test Loss: 1.651 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 1.702125072479248
Epoch: 2, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.362 Vali Acc: 0.622 Test Loss: 1.362 Test Acc: 0.622
Validation loss decreased (-0.311095 --> -0.622209).  Saving model ...
Epoch: 3 cost time: 1.6419322490692139
Epoch: 3, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.029 Vali Acc: 0.706 Test Loss: 1.029 Test Acc: 0.706
Validation loss decreased (-0.622209 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 1.6642160415649414
Epoch: 4, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.790 Vali Acc: 0.739 Test Loss: 0.790 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 1.6884562969207764
Epoch: 5, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7604377269744873
Epoch: 6, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.552 Vali Acc: 0.756 Test Loss: 0.552 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.678175926208496
Epoch: 7, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.490 Vali Acc: 0.767 Test Loss: 0.490 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 1.7775001525878906
Epoch: 8, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.435 Vali Acc: 0.789 Test Loss: 0.435 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 9 cost time: 1.6855254173278809
Epoch: 9, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.532289981842041
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 1.6753184795379639
Epoch: 11, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 1.429382562637329
Epoch: 12, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 1.5016050338745117
Epoch: 13, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.320 Vali Acc: 0.822 Test Loss: 0.320 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5748155117034912
Epoch: 14, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.558328628540039
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.8380134105682373
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.279 Vali Acc: 0.856 Test Loss: 0.279 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 17 cost time: 1.6754465103149414
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 18 cost time: 1.8905012607574463
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8457489013671875
Epoch: 19, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.6701102256774902
Epoch: 20, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.793395757675171
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6070544719696045
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.6092402935028076
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.245 Vali Acc: 0.867 Test Loss: 0.245 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8802533149719238
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 25 cost time: 1.5920381546020508
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.226 Vali Acc: 0.872 Test Loss: 0.226 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5752439498901367
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 27 cost time: 1.5733778476715088
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.6290335655212402
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.221 Vali Acc: 0.889 Test Loss: 0.221 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4689381122589111
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.196 Vali Acc: 0.906 Test Loss: 0.196 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6582105159759521
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.900 Test Loss: 0.211 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6561462879180908
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 1.7092633247375488
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.940129280090332
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8076612949371338
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.989321231842041
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 1.654604434967041
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7852766513824463
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6935665607452393
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6999421119689941
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 1.5270287990570068
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7600414752960205
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7405929565429688
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5508487224578857
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7101047039031982
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7433600425720215
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.7400588989257812
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9738430976867676
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.0293972492218018
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.9125304222106934
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 809734
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2824652194976807
Epoch: 1, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.666 Vali Acc: 0.439 Test Loss: 1.666 Test Acc: 0.439
Validation loss decreased (inf --> -0.438872).  Saving model ...
Epoch: 2 cost time: 1.6608390808105469
Epoch: 2, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.383 Vali Acc: 0.617 Test Loss: 1.383 Test Acc: 0.617
Validation loss decreased (-0.438872 --> -0.616653).  Saving model ...
Epoch: 3 cost time: 1.636397361755371
Epoch: 3, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.091 Vali Acc: 0.683 Test Loss: 1.091 Test Acc: 0.683
Validation loss decreased (-0.616653 --> -0.683322).  Saving model ...
Epoch: 4 cost time: 1.482121229171753
Epoch: 4, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.843 Vali Acc: 0.700 Test Loss: 0.843 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 1.47621750831604
Epoch: 5, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.687 Vali Acc: 0.756 Test Loss: 0.687 Test Acc: 0.756
Validation loss decreased (-0.699992 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 1.4864113330841064
Epoch: 6, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.575 Vali Acc: 0.744 Test Loss: 0.575 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5071256160736084
Epoch: 7, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.502 Vali Acc: 0.772 Test Loss: 0.502 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 1.5609111785888672
Epoch: 8, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.92134690284729
Epoch: 9, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.403 Vali Acc: 0.806 Test Loss: 0.403 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 10 cost time: 1.6303870677947998
Epoch: 10, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 1.8280889987945557
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 12 cost time: 1.6664478778839111
Epoch: 12, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 1.7141752243041992
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.7235798835754395
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
Validation loss decreased (-0.827774 --> -0.866663).  Saving model ...
Epoch: 15 cost time: 1.6820495128631592
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9327409267425537
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 17 cost time: 1.5701382160186768
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6698310375213623
Epoch: 18, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 19 cost time: 1.63808274269104
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7256388664245605
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 1.4575154781341553
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8213846683502197
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.253 Vali Acc: 0.878 Test Loss: 0.253 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.640934705734253
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.252 Vali Acc: 0.872 Test Loss: 0.252 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8638372421264648
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7892060279846191
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.8397018909454346
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.750610113143921
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 28 cost time: 1.8134608268737793
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6770446300506592
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7956736087799072
Epoch: 30, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 1.6695876121520996
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 1.6392574310302734
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.586634874343872
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 34 cost time: 1.4794151782989502
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.189 Vali Acc: 0.906 Test Loss: 0.189 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4245140552520752
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.889 Test Loss: 0.212 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3446216583251953
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.521684169769287
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.367840051651001
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5645771026611328
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.745023488998413
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8589973449707031
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.906 Test Loss: 0.206 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.840975046157837
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.9181389808654785
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 809798
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.752984046936035
Epoch: 1, Steps: 12 | Train Loss: 1.072 Vali Loss: 0.537 Vali Acc: 0.767 Test Loss: 0.537 Test Acc: 0.767
Validation loss decreased (inf --> -0.766661).  Saving model ...
Epoch: 2 cost time: 4.224706649780273
Epoch: 2, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
Validation loss decreased (-0.766661 --> -0.822217).  Saving model ...
Epoch: 3 cost time: 4.519023895263672
Epoch: 3, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.060 Vali Acc: 0.806 Test Loss: 1.060 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.432055950164795
Epoch: 4, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.879917621612549
Epoch: 5, Steps: 12 | Train Loss: 1.575 Vali Loss: 1.802 Vali Acc: 0.761 Test Loss: 1.802 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.768613576889038
Epoch: 6, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.975 Vali Acc: 0.750 Test Loss: 1.975 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.487214088439941
Epoch: 7, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.499 Vali Acc: 0.789 Test Loss: 1.499 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.445160627365112
Epoch: 8, Steps: 12 | Train Loss: 1.001 Vali Loss: 2.376 Vali Acc: 0.783 Test Loss: 2.376 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.7147581577301025
Epoch: 9, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.691 Vali Acc: 0.778 Test Loss: 1.691 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.461138963699341
Epoch: 10, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.841 Vali Acc: 0.806 Test Loss: 1.841 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.549760341644287
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 1.242 Vali Acc: 0.850 Test Loss: 1.242 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849988).  Saving model ...
Epoch: 12 cost time: 4.496144533157349
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 3.262 Vali Acc: 0.778 Test Loss: 3.262 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.255002021789551
Epoch: 13, Steps: 12 | Train Loss: 0.632 Vali Loss: 2.517 Vali Acc: 0.833 Test Loss: 2.517 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.6678307056427
Epoch: 14, Steps: 12 | Train Loss: 0.473 Vali Loss: 2.724 Vali Acc: 0.794 Test Loss: 2.724 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.897641897201538
Epoch: 15, Steps: 12 | Train Loss: 0.370 Vali Loss: 2.153 Vali Acc: 0.844 Test Loss: 2.153 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.927688360214233
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 2.973 Vali Acc: 0.839 Test Loss: 2.973 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.898860692977905
Epoch: 17, Steps: 12 | Train Loss: 0.382 Vali Loss: 1.532 Vali Acc: 0.867 Test Loss: 1.532 Test Acc: 0.867
Validation loss decreased (-0.849988 --> -0.866651).  Saving model ...
Epoch: 18 cost time: 5.083980560302734
Epoch: 18, Steps: 12 | Train Loss: 0.348 Vali Loss: 1.910 Vali Acc: 0.822 Test Loss: 1.910 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.72529673576355
Epoch: 19, Steps: 12 | Train Loss: 0.327 Vali Loss: 3.781 Vali Acc: 0.783 Test Loss: 3.781 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.418332815170288
Epoch: 20, Steps: 12 | Train Loss: 0.548 Vali Loss: 2.024 Vali Acc: 0.806 Test Loss: 2.024 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.282461404800415
Epoch: 21, Steps: 12 | Train Loss: 0.758 Vali Loss: 3.207 Vali Acc: 0.800 Test Loss: 3.207 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.0175676345825195
Epoch: 22, Steps: 12 | Train Loss: 0.359 Vali Loss: 1.769 Vali Acc: 0.828 Test Loss: 1.769 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.561366081237793
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.779 Vali Acc: 0.878 Test Loss: 1.779 Test Acc: 0.878
Validation loss decreased (-0.866651 --> -0.877760).  Saving model ...
Epoch: 24 cost time: 4.869126558303833
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.724 Vali Acc: 0.872 Test Loss: 1.724 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.688318252563477
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.742 Vali Acc: 0.878 Test Loss: 1.742 Test Acc: 0.878
Validation loss decreased (-0.877760 --> -0.877760).  Saving model ...
Epoch: 26 cost time: 4.834106206893921
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 2.424 Vali Acc: 0.889 Test Loss: 2.424 Test Acc: 0.889
Validation loss decreased (-0.877760 --> -0.888865).  Saving model ...
Epoch: 27 cost time: 4.856929779052734
Epoch: 27, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.572 Vali Acc: 0.861 Test Loss: 1.572 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.946885108947754
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.427 Vali Acc: 0.878 Test Loss: 1.427 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.62261962890625
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.326 Vali Acc: 0.889 Test Loss: 1.326 Test Acc: 0.889
Validation loss decreased (-0.888865 --> -0.888876).  Saving model ...
Epoch: 30 cost time: 4.625597238540649
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.790 Vali Acc: 0.889 Test Loss: 1.790 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.550926923751831
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.266 Vali Acc: 0.878 Test Loss: 1.266 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.70330286026001
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.511 Vali Acc: 0.889 Test Loss: 1.511 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.744771957397461
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 2.032 Vali Acc: 0.850 Test Loss: 2.032 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.676951169967651
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.939 Vali Acc: 0.861 Test Loss: 1.939 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.606622934341431
Epoch: 35, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.246 Vali Acc: 0.906 Test Loss: 1.246 Test Acc: 0.906
Validation loss decreased (-0.888876 --> -0.905543).  Saving model ...
Epoch: 36 cost time: 5.002549648284912
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.982 Vali Acc: 0.867 Test Loss: 1.982 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.7743237018585205
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.658 Vali Acc: 0.878 Test Loss: 1.658 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.32518196105957
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.794 Vali Acc: 0.878 Test Loss: 1.794 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.37227201461792
Epoch: 39, Steps: 12 | Train Loss: 0.053 Vali Loss: 3.002 Vali Acc: 0.794 Test Loss: 3.002 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.185824871063232
Epoch: 40, Steps: 12 | Train Loss: 0.278 Vali Loss: 2.513 Vali Acc: 0.867 Test Loss: 2.513 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.5528199672698975
Epoch: 41, Steps: 12 | Train Loss: 0.152 Vali Loss: 2.670 Vali Acc: 0.844 Test Loss: 2.670 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.89033579826355
Epoch: 42, Steps: 12 | Train Loss: 0.150 Vali Loss: 3.869 Vali Acc: 0.839 Test Loss: 3.869 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 5.073452711105347
Epoch: 43, Steps: 12 | Train Loss: 0.077 Vali Loss: 2.919 Vali Acc: 0.833 Test Loss: 2.919 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.004475831985474
Epoch: 44, Steps: 12 | Train Loss: 0.057 Vali Loss: 2.666 Vali Acc: 0.856 Test Loss: 2.666 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.610260486602783
Epoch: 45, Steps: 12 | Train Loss: 0.195 Vali Loss: 6.384 Vali Acc: 0.783 Test Loss: 6.384 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 8935174
model size : 34.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.842034339904785
Epoch: 1, Steps: 12 | Train Loss: 1.313 Vali Loss: 0.575 Vali Acc: 0.767 Test Loss: 0.575 Test Acc: 0.767
Validation loss decreased (inf --> -0.766661).  Saving model ...
Epoch: 2 cost time: 3.119093656539917
Epoch: 2, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.618 Vali Acc: 0.739 Test Loss: 0.618 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.100163221359253
Epoch: 3, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.552 Vali Acc: 0.817 Test Loss: 0.552 Test Acc: 0.817
Validation loss decreased (-0.766661 --> -0.816661).  Saving model ...
Epoch: 4 cost time: 3.441725492477417
Epoch: 4, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.769 Vali Acc: 0.778 Test Loss: 0.769 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.490274667739868
Epoch: 5, Steps: 12 | Train Loss: 0.376 Vali Loss: 1.055 Vali Acc: 0.761 Test Loss: 1.055 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2720282077789307
Epoch: 6, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
Validation loss decreased (-0.816661 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 3.208852767944336
Epoch: 7, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.38845157623291
Epoch: 8, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.090527057647705
Epoch: 9, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.801 Vali Acc: 0.822 Test Loss: 0.801 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.335892915725708
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 3.1338980197906494
Epoch: 11, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.402 Vali Acc: 0.878 Test Loss: 0.402 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 3.1676697731018066
Epoch: 12, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.986721992492676
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.876913547515869
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.724 Vali Acc: 0.817 Test Loss: 0.724 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.928952932357788
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.733 Vali Acc: 0.883 Test Loss: 0.733 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883326).  Saving model ...
Epoch: 16 cost time: 2.585801601409912
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.419 Vali Acc: 0.767 Test Loss: 1.419 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9694807529449463
Epoch: 17, Steps: 12 | Train Loss: 0.322 Vali Loss: 3.315 Vali Acc: 0.733 Test Loss: 3.315 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.092015027999878
Epoch: 18, Steps: 12 | Train Loss: 0.705 Vali Loss: 2.197 Vali Acc: 0.817 Test Loss: 2.197 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3917980194091797
Epoch: 19, Steps: 12 | Train Loss: 0.622 Vali Loss: 1.668 Vali Acc: 0.794 Test Loss: 1.668 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4521145820617676
Epoch: 20, Steps: 12 | Train Loss: 0.417 Vali Loss: 2.434 Vali Acc: 0.789 Test Loss: 2.434 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.17905330657959
Epoch: 21, Steps: 12 | Train Loss: 0.751 Vali Loss: 2.699 Vali Acc: 0.811 Test Loss: 2.699 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.4108214378356934
Epoch: 22, Steps: 12 | Train Loss: 0.308 Vali Loss: 1.503 Vali Acc: 0.844 Test Loss: 1.503 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.006760597229004
Epoch: 23, Steps: 12 | Train Loss: 0.378 Vali Loss: 1.410 Vali Acc: 0.867 Test Loss: 1.410 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9547877311706543
Epoch: 24, Steps: 12 | Train Loss: 0.368 Vali Loss: 1.054 Vali Acc: 0.883 Test Loss: 1.054 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.6891846656799316
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.889 Test Loss: 0.859 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888880).  Saving model ...
Epoch: 26 cost time: 2.907191514968872
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.059 Vali Acc: 0.883 Test Loss: 1.059 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8619894981384277
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.867 Test Loss: 1.394 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.297687530517578
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.244 Vali Acc: 0.861 Test Loss: 1.244 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2993600368499756
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.130 Vali Acc: 0.889 Test Loss: 1.130 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.342730760574341
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.517 Vali Acc: 0.889 Test Loss: 1.517 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.3462135791778564
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.179 Vali Acc: 0.867 Test Loss: 1.179 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.1298668384552
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.991 Vali Acc: 0.894 Test Loss: 0.991 Test Acc: 0.894
Validation loss decreased (-0.888880 --> -0.894435).  Saving model ...
Epoch: 33 cost time: 3.194061279296875
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.883 Test Loss: 1.222 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2961199283599854
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.920 Vali Acc: 0.883 Test Loss: 0.920 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.926854372024536
Epoch: 35, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.882 Vali Acc: 0.856 Test Loss: 1.882 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.911818265914917
Epoch: 36, Steps: 12 | Train Loss: 0.273 Vali Loss: 1.161 Vali Acc: 0.883 Test Loss: 1.161 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.890453815460205
Epoch: 37, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.817 Vali Acc: 0.872 Test Loss: 0.817 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.0594751834869385
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.065 Vali Acc: 0.878 Test Loss: 1.065 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.185701847076416
Epoch: 39, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.380 Vali Acc: 0.856 Test Loss: 1.380 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.3909218311309814
Epoch: 40, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.006 Vali Acc: 0.894 Test Loss: 1.006 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.156273126602173
Epoch: 41, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.124 Vali Acc: 0.889 Test Loss: 1.124 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.1302454471588135
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.906 Test Loss: 0.691 Test Acc: 0.906
Validation loss decreased (-0.894435 --> -0.905549).  Saving model ...
Epoch: 43 cost time: 3.2000391483306885
Epoch: 43, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.587 Vali Acc: 0.844 Test Loss: 1.587 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.365034580230713
Epoch: 44, Steps: 12 | Train Loss: 0.416 Vali Loss: 1.157 Vali Acc: 0.856 Test Loss: 1.157 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.133620262145996
Epoch: 45, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.456 Vali Acc: 0.872 Test Loss: 1.456 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.131563186645508
Epoch: 46, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.503 Vali Acc: 0.861 Test Loss: 1.503 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.804126739501953
Epoch: 47, Steps: 12 | Train Loss: 0.569 Vali Loss: 1.247 Vali Acc: 0.861 Test Loss: 1.247 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.722299098968506
Epoch: 48, Steps: 12 | Train Loss: 0.137 Vali Loss: 2.753 Vali Acc: 0.811 Test Loss: 2.753 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.7269365787506104
Epoch: 49, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.755 Vali Acc: 0.856 Test Loss: 1.755 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.5886571407318115
Epoch: 50, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.499 Vali Acc: 0.856 Test Loss: 1.499 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 7976966
model size : 30.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.051728963851929
Epoch: 1, Steps: 12 | Train Loss: 1.212 Vali Loss: 0.637 Vali Acc: 0.694 Test Loss: 0.637 Test Acc: 0.694
Validation loss decreased (inf --> -0.694438).  Saving model ...
Epoch: 2 cost time: 3.0054771900177
Epoch: 2, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.441 Vali Acc: 0.778 Test Loss: 0.441 Test Acc: 0.778
Validation loss decreased (-0.694438 --> -0.777773).  Saving model ...
Epoch: 3 cost time: 3.2732980251312256
Epoch: 3, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.445 Vali Acc: 0.811 Test Loss: 0.445 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 2.9806504249572754
Epoch: 4, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.617 Vali Acc: 0.794 Test Loss: 0.617 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.891350507736206
Epoch: 5, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.811107 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 2.81587553024292
Epoch: 6, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.829 Vali Acc: 0.844 Test Loss: 0.829 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.762033700942993
Epoch: 7, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.921 Vali Acc: 0.822 Test Loss: 0.921 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.80741810798645
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.972 Vali Acc: 0.811 Test Loss: 0.972 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.934251070022583
Epoch: 9, Steps: 12 | Train Loss: 0.359 Vali Loss: 1.120 Vali Acc: 0.828 Test Loss: 1.120 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8900749683380127
Epoch: 10, Steps: 12 | Train Loss: 0.299 Vali Loss: 1.017 Vali Acc: 0.828 Test Loss: 1.017 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0148353576660156
Epoch: 11, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.722 Vali Acc: 0.856 Test Loss: 0.722 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855548).  Saving model ...
Epoch: 12 cost time: 3.0448355674743652
Epoch: 12, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.559 Vali Acc: 0.783 Test Loss: 1.559 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.823673963546753
Epoch: 13, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.213 Vali Acc: 0.783 Test Loss: 1.213 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7612111568450928
Epoch: 14, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.758 Vali Acc: 0.828 Test Loss: 1.758 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7170491218566895
Epoch: 15, Steps: 12 | Train Loss: 0.453 Vali Loss: 1.171 Vali Acc: 0.850 Test Loss: 1.171 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8076889514923096
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 2.385 Vali Acc: 0.833 Test Loss: 2.385 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6166937351226807
Epoch: 17, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.423 Vali Acc: 0.833 Test Loss: 1.423 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7513458728790283
Epoch: 18, Steps: 12 | Train Loss: 0.310 Vali Loss: 1.650 Vali Acc: 0.811 Test Loss: 1.650 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.819504737854004
Epoch: 19, Steps: 12 | Train Loss: 0.378 Vali Loss: 1.009 Vali Acc: 0.828 Test Loss: 1.009 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.591583728790283
Epoch: 20, Steps: 12 | Train Loss: 0.190 Vali Loss: 1.359 Vali Acc: 0.828 Test Loss: 1.359 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4580931663513184
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.604 Vali Acc: 0.828 Test Loss: 1.604 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 7977222
model size : 30.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.242934465408325
Epoch: 1, Steps: 12 | Train Loss: 1.384 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
Validation loss decreased (inf --> -0.727771).  Saving model ...
Epoch: 2 cost time: 2.5593557357788086
Epoch: 2, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.452 Vali Acc: 0.789 Test Loss: 0.452 Test Acc: 0.789
Validation loss decreased (-0.727771 --> -0.788884).  Saving model ...
Epoch: 3 cost time: 2.618098735809326
Epoch: 3, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.481 Vali Acc: 0.828 Test Loss: 0.481 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827773).  Saving model ...
Epoch: 4 cost time: 2.5668447017669678
Epoch: 4, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5922091007232666
Epoch: 5, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.827773 --> -0.849997).  Saving model ...
Epoch: 6 cost time: 2.3015053272247314
Epoch: 6, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 7 cost time: 2.185730218887329
Epoch: 7, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.130978584289551
Epoch: 8, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.631 Vali Acc: 0.839 Test Loss: 0.631 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.394986391067505
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.227919816970825
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.222285509109497
Epoch: 11, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5456228256225586
Epoch: 12, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5074920654296875
Epoch: 13, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.658372640609741
Epoch: 14, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.603 Vali Acc: 0.867 Test Loss: 0.603 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4793591499328613
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.504 Vali Acc: 0.894 Test Loss: 0.504 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894439).  Saving model ...
Epoch: 16 cost time: 2.5839667320251465
Epoch: 16, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.566 Vali Acc: 0.883 Test Loss: 0.566 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.481571674346924
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6817450523376465
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.873 Vali Acc: 0.839 Test Loss: 0.873 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5249664783477783
Epoch: 19, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.902 Vali Acc: 0.844 Test Loss: 0.902 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.323873281478882
Epoch: 20, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.147 Vali Acc: 0.839 Test Loss: 1.147 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3838798999786377
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 4.181 Vali Acc: 0.689 Test Loss: 4.181 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.255918502807617
Epoch: 22, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.605 Vali Acc: 0.894 Test Loss: 0.605 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.389211654663086
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.667 Vali Acc: 0.867 Test Loss: 0.667 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2972254753112793
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.895 Vali Acc: 0.850 Test Loss: 0.895 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.173461675643921
Epoch: 25, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.019 Vali Acc: 0.889 Test Loss: 1.019 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 7682822
model size : 29.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3287851810455322
Epoch: 1, Steps: 12 | Train Loss: 1.329 Vali Loss: 0.747 Vali Acc: 0.733 Test Loss: 0.747 Test Acc: 0.733
Validation loss decreased (inf --> -0.733326).  Saving model ...
Epoch: 2 cost time: 1.9378933906555176
Epoch: 2, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.482 Vali Acc: 0.767 Test Loss: 0.482 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766662).  Saving model ...
Epoch: 3 cost time: 2.2357981204986572
Epoch: 3, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805552).  Saving model ...
Epoch: 4 cost time: 2.282541513442993
Epoch: 4, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 2.31670880317688
Epoch: 5, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 6 cost time: 2.296616554260254
Epoch: 6, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.196666955947876
Epoch: 7, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.518 Vali Acc: 0.817 Test Loss: 0.518 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3137383460998535
Epoch: 8, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.434 Vali Acc: 0.828 Test Loss: 0.434 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.208388328552246
Epoch: 9, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2642128467559814
Epoch: 10, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2187156677246094
Epoch: 11, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1111578941345215
Epoch: 12, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.340 Vali Acc: 0.883 Test Loss: 0.340 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 2.197694778442383
Epoch: 13, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3471453189849854
Epoch: 14, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.242873430252075
Epoch: 15, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.391 Vali Acc: 0.844 Test Loss: 0.391 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.304389476776123
Epoch: 16, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4252781867980957
Epoch: 17, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.433 Vali Acc: 0.872 Test Loss: 0.433 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1372101306915283
Epoch: 18, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.1690938472747803
Epoch: 19, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.323 Vali Acc: 0.878 Test Loss: 0.323 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.050792694091797
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.584 Vali Acc: 0.889 Test Loss: 0.584 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.006465196609497
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9916126728057861
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 2.124159097671509
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.161559820175171
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 2.4133033752441406
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2431087493896484
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.493 Vali Acc: 0.883 Test Loss: 0.493 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.223724365234375
Epoch: 27, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5486249923706055
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.370161294937134
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 30 cost time: 2.4048049449920654
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.4246535301208496
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1680707931518555
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.894 Test Loss: 0.416 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2491614818573
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1913368701934814
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.906 Test Loss: 0.468 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8320801258087158
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.135263442993164
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.3543193340301514
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.240499973297119
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.252805709838867
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 7499014
model size : 28.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6939234733581543
Epoch: 1, Steps: 12 | Train Loss: 1.488 Vali Loss: 0.919 Vali Acc: 0.678 Test Loss: 0.919 Test Acc: 0.678
Validation loss decreased (inf --> -0.677769).  Saving model ...
Epoch: 2 cost time: 1.9713048934936523
Epoch: 2, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.513 Vali Acc: 0.756 Test Loss: 0.513 Test Acc: 0.756
Validation loss decreased (-0.677769 --> -0.755550).  Saving model ...
Epoch: 3 cost time: 2.097144603729248
Epoch: 3, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.403 Vali Acc: 0.778 Test Loss: 0.403 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777774).  Saving model ...
Epoch: 4 cost time: 2.1048178672790527
Epoch: 4, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.343 Vali Acc: 0.839 Test Loss: 0.343 Test Acc: 0.839
Validation loss decreased (-0.777774 --> -0.838885).  Saving model ...
Epoch: 5 cost time: 2.286867380142212
Epoch: 5, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 2.169837713241577
Epoch: 6, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.420 Vali Acc: 0.828 Test Loss: 0.420 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.131300210952759
Epoch: 7, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.348 Vali Acc: 0.839 Test Loss: 0.348 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0260088443756104
Epoch: 8, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2005035877227783
Epoch: 9, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 2.1763830184936523
Epoch: 10, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.29142165184021
Epoch: 11, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.215294361114502
Epoch: 12, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.973670244216919
Epoch: 13, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1829633712768555
Epoch: 14, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.414 Vali Acc: 0.883 Test Loss: 0.414 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883329).  Saving model ...
Epoch: 15 cost time: 2.057486057281494
Epoch: 15, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0766549110412598
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.027796983718872
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2967631816864014
Epoch: 18, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 2.13258695602417
Epoch: 19, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 2.0880608558654785
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.269925117492676
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.184105396270752
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 2.0971648693084717
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.122152328491211
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.906 Test Loss: 0.297 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 2.1908679008483887
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1917688846588135
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.448 Vali Acc: 0.894 Test Loss: 0.448 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0033669471740723
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 2.3204421997070312
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2242507934570312
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3330585956573486
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2303051948547363
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.1987810134887695
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.093653678894043
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.906 Test Loss: 0.342 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.9398787021636963
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.152 Vali Acc: 0.839 Test Loss: 1.152 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.094533681869507
Epoch: 35, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9163379669189453
Epoch: 36, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.370 Vali Acc: 0.750 Test Loss: 1.370 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.976372480392456
Epoch: 37, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 7352326
model size : 28.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7706339359283447
Epoch: 1, Steps: 12 | Train Loss: 1.472 Vali Loss: 0.930 Vali Acc: 0.744 Test Loss: 0.930 Test Acc: 0.744
Validation loss decreased (inf --> -0.744435).  Saving model ...
Epoch: 2 cost time: 2.165628671646118
Epoch: 2, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.524 Vali Acc: 0.772 Test Loss: 0.524 Test Acc: 0.772
Validation loss decreased (-0.744435 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 2.1616604328155518
Epoch: 3, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.376 Vali Acc: 0.800 Test Loss: 0.376 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 1.929853916168213
Epoch: 4, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 2.0636448860168457
Epoch: 5, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 6 cost time: 2.1138815879821777
Epoch: 6, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.349 Vali Acc: 0.822 Test Loss: 0.349 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0711214542388916
Epoch: 7, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.291 Vali Acc: 0.844 Test Loss: 0.291 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0610768795013428
Epoch: 8, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.457 Vali Acc: 0.839 Test Loss: 0.457 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1684019565582275
Epoch: 9, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.232114315032959
Epoch: 10, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2078521251678467
Epoch: 11, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 2.1548163890838623
Epoch: 12, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.365 Vali Acc: 0.844 Test Loss: 0.365 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.176788091659546
Epoch: 13, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.192091703414917
Epoch: 14, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.3026320934295654
Epoch: 15, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 2.0549025535583496
Epoch: 16, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.475 Vali Acc: 0.883 Test Loss: 0.475 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0792665481567383
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9531383514404297
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0415947437286377
Epoch: 19, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2402658462524414
Epoch: 20, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 2.2809548377990723
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3597989082336426
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.212797164916992
Epoch: 23, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1313772201538086
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.262169599533081
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2080695629119873
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9884264469146729
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0953269004821777
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9901065826416016
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9599266052246094
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 7315974
model size : 28.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9304096698760986
Epoch: 1, Steps: 12 | Train Loss: 1.243 Vali Loss: 0.639 Vali Acc: 0.689 Test Loss: 0.639 Test Acc: 0.689
Validation loss decreased (inf --> -0.688882).  Saving model ...
Epoch: 2 cost time: 2.28053617477417
Epoch: 2, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
Validation loss decreased (-0.688882 --> -0.788883).  Saving model ...
Epoch: 3 cost time: 2.062883138656616
Epoch: 3, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.579 Vali Acc: 0.767 Test Loss: 0.579 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.057065010070801
Epoch: 4, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.778 Vali Acc: 0.822 Test Loss: 0.778 Test Acc: 0.822
Validation loss decreased (-0.788883 --> -0.822214).  Saving model ...
Epoch: 5 cost time: 1.8348045349121094
Epoch: 5, Steps: 12 | Train Loss: 0.295 Vali Loss: 1.238 Vali Acc: 0.789 Test Loss: 1.238 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9509742259979248
Epoch: 6, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.797 Vali Acc: 0.811 Test Loss: 0.797 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8517065048217773
Epoch: 7, Steps: 12 | Train Loss: 0.297 Vali Loss: 1.155 Vali Acc: 0.828 Test Loss: 1.155 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827766).  Saving model ...
Epoch: 8 cost time: 1.9741172790527344
Epoch: 8, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.701 Vali Acc: 0.828 Test Loss: 0.701 Test Acc: 0.828
Validation loss decreased (-0.827766 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 2.0436954498291016
Epoch: 9, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.368 Vali Acc: 0.833 Test Loss: 1.368 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833320).  Saving model ...
Epoch: 10 cost time: 2.0602006912231445
Epoch: 10, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
Validation loss decreased (-0.833320 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 2.052367687225342
Epoch: 11, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.915 Vali Acc: 0.844 Test Loss: 0.915 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844435).  Saving model ...
Epoch: 12 cost time: 2.331455707550049
Epoch: 12, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.526 Vali Acc: 0.883 Test Loss: 0.526 Test Acc: 0.883
Validation loss decreased (-0.844435 --> -0.883328).  Saving model ...
Epoch: 13 cost time: 2.197472095489502
Epoch: 13, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.583 Vali Acc: 0.867 Test Loss: 0.583 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.217966079711914
Epoch: 14, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.692 Vali Acc: 0.867 Test Loss: 0.692 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.145573139190674
Epoch: 15, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.759 Vali Acc: 0.883 Test Loss: 0.759 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2150497436523438
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 17 cost time: 2.1646840572357178
Epoch: 17, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.121 Vali Acc: 0.750 Test Loss: 1.121 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.024191379547119
Epoch: 18, Steps: 12 | Train Loss: 0.387 Vali Loss: 1.271 Vali Acc: 0.850 Test Loss: 1.271 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.041834831237793
Epoch: 19, Steps: 12 | Train Loss: 0.551 Vali Loss: 1.948 Vali Acc: 0.783 Test Loss: 1.948 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.060148239135742
Epoch: 20, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.999 Vali Acc: 0.867 Test Loss: 0.999 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1678032875061035
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.094 Vali Acc: 0.861 Test Loss: 1.094 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.165680170059204
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.705 Vali Acc: 0.878 Test Loss: 0.705 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.177726984024048
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.755 Vali Acc: 0.894 Test Loss: 0.755 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894437).  Saving model ...
Epoch: 24 cost time: 2.1959900856018066
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.161 Vali Acc: 0.878 Test Loss: 1.161 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1586954593658447
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.337 Vali Acc: 0.872 Test Loss: 1.337 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1179444789886475
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.064 Vali Acc: 0.878 Test Loss: 1.064 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9576530456542969
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.914 Vali Acc: 0.883 Test Loss: 0.914 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9378151893615723
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.911 Test Loss: 0.747 Test Acc: 0.911
Validation loss decreased (-0.894437 --> -0.911104).  Saving model ...
Epoch: 29 cost time: 2.067112684249878
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.962 Vali Acc: 0.900 Test Loss: 0.962 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.044692277908325
Epoch: 30, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.614 Vali Acc: 0.922 Test Loss: 0.614 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922216).  Saving model ...
Epoch: 31 cost time: 2.014512777328491
Epoch: 31, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.817 Vali Acc: 0.889 Test Loss: 0.817 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.04331111907959
Epoch: 32, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.533 Vali Acc: 0.911 Test Loss: 0.533 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.067627429962158
Epoch: 33, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.672 Vali Acc: 0.878 Test Loss: 0.672 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.1157538890838623
Epoch: 34, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.847 Vali Acc: 0.900 Test Loss: 0.847 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.1943554878234863
Epoch: 35, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.050 Vali Acc: 0.906 Test Loss: 1.050 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.107269763946533
Epoch: 36, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.483 Vali Acc: 0.867 Test Loss: 1.483 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.0771543979644775
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.146 Vali Acc: 0.900 Test Loss: 1.146 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.2925758361816406
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.1336264610290527
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.878 Test Loss: 1.309 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.1344103813171387
Epoch: 40, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2894726
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.21416974067688
Epoch: 1, Steps: 12 | Train Loss: 1.313 Vali Loss: 0.739 Vali Acc: 0.728 Test Loss: 0.739 Test Acc: 0.728
Validation loss decreased (inf --> -0.727770).  Saving model ...
Epoch: 2 cost time: 1.7211549282073975
Epoch: 2, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
Validation loss decreased (-0.727770 --> -0.783328).  Saving model ...
Epoch: 3 cost time: 1.6289303302764893
Epoch: 3, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 1.8111627101898193
Epoch: 4, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.727675199508667
Epoch: 5, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822217).  Saving model ...
Epoch: 6 cost time: 1.855569839477539
Epoch: 6, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.468 Vali Acc: 0.817 Test Loss: 0.468 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.74519944190979
Epoch: 7, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.435 Vali Acc: 0.828 Test Loss: 0.435 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827773).  Saving model ...
Epoch: 8 cost time: 1.9460361003875732
Epoch: 8, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
Validation loss decreased (-0.827773 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.7599048614501953
Epoch: 9, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.588 Vali Acc: 0.817 Test Loss: 0.588 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7582128047943115
Epoch: 10, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4454891681671143
Epoch: 11, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.849995 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 1.6695704460144043
Epoch: 12, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7919223308563232
Epoch: 13, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.761376142501831
Epoch: 14, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.098 Vali Acc: 0.806 Test Loss: 1.098 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7541134357452393
Epoch: 15, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.806 Vali Acc: 0.850 Test Loss: 0.806 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8236634731292725
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.890995740890503
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.819 Vali Acc: 0.817 Test Loss: 0.819 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8683602809906006
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.387 Vali Acc: 0.894 Test Loss: 0.387 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 19 cost time: 1.9287843704223633
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9261555671691895
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8643207550048828
Epoch: 21, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.370 Vali Acc: 0.911 Test Loss: 0.370 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911107).  Saving model ...
Epoch: 22 cost time: 1.871429443359375
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.889 Test Loss: 0.573 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.715139389038086
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7519254684448242
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.883 Test Loss: 0.414 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.701598882675171
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6032805442810059
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.700394868850708
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.906 Test Loss: 0.408 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5354340076446533
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6387667655944824
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.726412296295166
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6892902851104736
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2415622
model size : 9.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.473846435546875
Epoch: 1, Steps: 12 | Train Loss: 1.362 Vali Loss: 0.752 Vali Acc: 0.728 Test Loss: 0.752 Test Acc: 0.728
Validation loss decreased (inf --> -0.727770).  Saving model ...
Epoch: 2 cost time: 1.764983892440796
Epoch: 2, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.450 Vali Acc: 0.772 Test Loss: 0.450 Test Acc: 0.772
Validation loss decreased (-0.727770 --> -0.772218).  Saving model ...
Epoch: 3 cost time: 1.6954798698425293
Epoch: 3, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
Validation loss decreased (-0.772218 --> -0.827774).  Saving model ...
Epoch: 4 cost time: 1.7358033657073975
Epoch: 4, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8670179843902588
Epoch: 5, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.374 Vali Acc: 0.844 Test Loss: 0.374 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.7762949466705322
Epoch: 6, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 7 cost time: 1.7330033779144287
Epoch: 7, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7528724670410156
Epoch: 8, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.566023826599121
Epoch: 9, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.303 Vali Acc: 0.839 Test Loss: 0.303 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3656513690948486
Epoch: 10, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5757830142974854
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 1.6411852836608887
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 1.5546021461486816
Epoch: 13, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.829296350479126
Epoch: 14, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8400425910949707
Epoch: 15, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7391574382781982
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.460 Vali Acc: 0.906 Test Loss: 0.460 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905551).  Saving model ...
Epoch: 17 cost time: 1.680866003036499
Epoch: 17, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7615196704864502
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8434793949127197
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6441280841827393
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6017348766326904
Epoch: 21, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6467571258544922
Epoch: 22, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.894 Test Loss: 0.515 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6186506748199463
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.624159574508667
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6523165702819824
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.446 Vali Acc: 0.894 Test Loss: 0.446 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.911780834197998
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2415750
model size : 9.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1283862590789795
Epoch: 1, Steps: 12 | Train Loss: 1.415 Vali Loss: 0.921 Vali Acc: 0.683 Test Loss: 0.921 Test Acc: 0.683
Validation loss decreased (inf --> -0.683324).  Saving model ...
Epoch: 2 cost time: 1.4312934875488281
Epoch: 2, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.538 Vali Acc: 0.739 Test Loss: 0.538 Test Acc: 0.739
Validation loss decreased (-0.683324 --> -0.738884).  Saving model ...
Epoch: 3 cost time: 1.369126796722412
Epoch: 3, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.412 Vali Acc: 0.806 Test Loss: 0.412 Test Acc: 0.806
Validation loss decreased (-0.738884 --> -0.805551).  Saving model ...
Epoch: 4 cost time: 1.3861048221588135
Epoch: 4, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.361 Vali Acc: 0.806 Test Loss: 0.361 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 1.4549663066864014
Epoch: 5, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.430 Vali Acc: 0.806 Test Loss: 0.430 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2557086944580078
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3522839546203613
Epoch: 7, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3565711975097656
Epoch: 8, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.586 Vali Acc: 0.817 Test Loss: 0.586 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 1.2984929084777832
Epoch: 9, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
Validation loss decreased (-0.816661 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 1.4518189430236816
Epoch: 10, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.4057137966156006
Epoch: 11, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3994688987731934
Epoch: 12, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2535591125488281
Epoch: 13, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.248582124710083
Epoch: 14, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.872219 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.289412021636963
Epoch: 15, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.480 Vali Acc: 0.894 Test Loss: 0.480 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2198467254638672
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2098684310913086
Epoch: 17, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1650879383087158
Epoch: 18, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0691263675689697
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.231245517730713
Epoch: 20, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.169602870941162
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 1.3581182956695557
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.496471881866455
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 1.3109288215637207
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.319469690322876
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.438269853591919
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3536252975463867
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.574277639389038
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.366682767868042
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 1.39455246925354
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4682352542877197
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2124524116516113
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 1.312274694442749
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.326864242553711
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.365816354751587
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 1.3434882164001465
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4625699520111084
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.526651382446289
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5666711330413818
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4250407218933105
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4130783081054688
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.4998552799224854
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.423246145248413
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.4046359062194824
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3782896995544434
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 2268550
model size : 8.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1237151622772217
Epoch: 1, Steps: 12 | Train Loss: 1.384 Vali Loss: 0.975 Vali Acc: 0.694 Test Loss: 0.975 Test Acc: 0.694
Validation loss decreased (inf --> -0.694435).  Saving model ...
Epoch: 2 cost time: 1.4492144584655762
Epoch: 2, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.528 Vali Acc: 0.744 Test Loss: 0.528 Test Acc: 0.744
Validation loss decreased (-0.694435 --> -0.744439).  Saving model ...
Epoch: 3 cost time: 1.425328016281128
Epoch: 3, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.384 Vali Acc: 0.811 Test Loss: 0.384 Test Acc: 0.811
Validation loss decreased (-0.744439 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 1.3021235466003418
Epoch: 4, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.387 Vali Acc: 0.800 Test Loss: 0.387 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4324541091918945
Epoch: 5, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838886).  Saving model ...
Epoch: 6 cost time: 1.3106155395507812
Epoch: 6, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.312 Vali Acc: 0.839 Test Loss: 0.312 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 1.2642943859100342
Epoch: 7, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.342 Vali Acc: 0.822 Test Loss: 0.342 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2096672058105469
Epoch: 8, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.480 Vali Acc: 0.806 Test Loss: 0.480 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.193016529083252
Epoch: 9, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 1.1679496765136719
Epoch: 10, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 1.3689789772033691
Epoch: 11, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 1.2757422924041748
Epoch: 12, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.390 Vali Acc: 0.844 Test Loss: 0.390 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.442812204360962
Epoch: 13, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3294594287872314
Epoch: 14, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.480410099029541
Epoch: 15, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4485461711883545
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.340 Vali Acc: 0.878 Test Loss: 0.340 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3868539333343506
Epoch: 17, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.4524106979370117
Epoch: 18, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.5050568580627441
Epoch: 19, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.3953337669372559
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.483537197113037
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4002435207366943
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4380061626434326
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3579914569854736
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3658759593963623
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.3734652996063232
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3558931350708008
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3744020462036133
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.439 Vali Acc: 0.894 Test Loss: 0.439 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3679521083831787
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.308159589767456
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3977713584899902
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.371657133102417
Epoch: 32, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4002482891082764
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3119933605194092
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3579728603363037
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2176646
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.915318489074707
Epoch: 1, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.129 Vali Acc: 0.744 Test Loss: 1.129 Test Acc: 0.744
Validation loss decreased (inf --> -0.744433).  Saving model ...
Epoch: 2 cost time: 1.3669660091400146
Epoch: 2, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
Validation loss decreased (-0.744433 --> -0.749994).  Saving model ...
Epoch: 3 cost time: 1.2814011573791504
Epoch: 3, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.456 Vali Acc: 0.772 Test Loss: 0.456 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 1.3729970455169678
Epoch: 4, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.402 Vali Acc: 0.817 Test Loss: 0.402 Test Acc: 0.817
Validation loss decreased (-0.772218 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.3662762641906738
Epoch: 5, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.3120231628417969
Epoch: 6, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 1.4261393547058105
Epoch: 7, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3851816654205322
Epoch: 8, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.516 Vali Acc: 0.794 Test Loss: 0.516 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3489494323730469
Epoch: 9, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.431 Vali Acc: 0.817 Test Loss: 0.431 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4388198852539062
Epoch: 10, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3927416801452637
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.393089771270752
Epoch: 12, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.3450636863708496
Epoch: 13, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 1.3351449966430664
Epoch: 14, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3314056396484375
Epoch: 15, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.203033208847046
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2562346458435059
Epoch: 17, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.2048547267913818
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.340 Vali Acc: 0.872 Test Loss: 0.340 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 1.3311383724212646
Epoch: 19, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.277 Vali Acc: 0.861 Test Loss: 0.277 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3069682121276855
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.330219030380249
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.3952064514160156
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3839716911315918
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3620953559875488
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3830268383026123
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.320169448852539
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.878 Test Loss: 0.282 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.332153558731079
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2621798515319824
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3014514446258545
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3163225650787354
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.299940824508667
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.883 Test Loss: 0.250 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2103302
model size : 8.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9347753524780273
Epoch: 1, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.271 Vali Acc: 0.583 Test Loss: 1.271 Test Acc: 0.583
Validation loss decreased (inf --> -0.583321).  Saving model ...
Epoch: 2 cost time: 1.312650203704834
Epoch: 2, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.658 Vali Acc: 0.744 Test Loss: 0.658 Test Acc: 0.744
Validation loss decreased (-0.583321 --> -0.744438).  Saving model ...
Epoch: 3 cost time: 1.3496320247650146
Epoch: 3, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.487 Vali Acc: 0.783 Test Loss: 0.487 Test Acc: 0.783
Validation loss decreased (-0.744438 --> -0.783328).  Saving model ...
Epoch: 4 cost time: 1.390632152557373
Epoch: 4, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.404 Vali Acc: 0.806 Test Loss: 0.404 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 1.295619249343872
Epoch: 5, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.171933889389038
Epoch: 6, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2842402458190918
Epoch: 7, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.313 Vali Acc: 0.833 Test Loss: 0.313 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.0991730690002441
Epoch: 8, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.0812065601348877
Epoch: 9, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 1.26470947265625
Epoch: 10, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2098724842071533
Epoch: 11, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.37406325340271
Epoch: 12, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4248955249786377
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 1.3649802207946777
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2609410285949707
Epoch: 15, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.334 Vali Acc: 0.878 Test Loss: 0.334 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2585158348083496
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 1.229346752166748
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.248 Vali Acc: 0.872 Test Loss: 0.248 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2153897285461426
Epoch: 18, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.1733407974243164
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.2986791133880615
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2679531574249268
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3296422958374023
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2858765125274658
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.224 Vali Acc: 0.894 Test Loss: 0.224 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2000813484191895
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3161189556121826
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.4185209274291992
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 1.3629388809204102
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3826663494110107
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3924148082733154
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.352987289428711
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4494924545288086
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.337571382522583
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 1.2906267642974854
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4225826263427734
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3204538822174072
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.34584641456604
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3944652080535889
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.917 Test Loss: 0.174 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3850674629211426
Epoch: 38, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.387725830078125
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3798305988311768
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.933 Test Loss: 0.143 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 41 cost time: 1.342545986175537
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3482627868652344
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.310802936553955
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3119442462921143
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.312957525253296
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3188724517822266
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.392 Vali Acc: 0.911 Test Loss: 0.392 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2230720520019531
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.236732006072998
Epoch: 48, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2675034999847412
Epoch: 49, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3152894973754883
Epoch: 50, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 2085126
model size : 8.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.592931032180786
Epoch: 1, Steps: 12 | Train Loss: 1.316 Vali Loss: 0.766 Vali Acc: 0.706 Test Loss: 0.766 Test Acc: 0.706
Validation loss decreased (inf --> -0.705548).  Saving model ...
Epoch: 2 cost time: 1.9268162250518799
Epoch: 2, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.498 Vali Acc: 0.761 Test Loss: 0.498 Test Acc: 0.761
Validation loss decreased (-0.705548 --> -0.761106).  Saving model ...
Epoch: 3 cost time: 1.9897964000701904
Epoch: 3, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.755 Vali Acc: 0.778 Test Loss: 0.755 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777770).  Saving model ...
Epoch: 4 cost time: 1.826249361038208
Epoch: 4, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.425 Vali Acc: 0.806 Test Loss: 0.425 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 2.106011152267456
Epoch: 5, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.548 Vali Acc: 0.806 Test Loss: 0.548 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8394322395324707
Epoch: 6, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 1.834967851638794
Epoch: 7, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.456 Vali Acc: 0.828 Test Loss: 0.456 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7457380294799805
Epoch: 8, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 1.8316516876220703
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.426 Vali Acc: 0.828 Test Loss: 0.426 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6747345924377441
Epoch: 10, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6521494388580322
Epoch: 11, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877773).  Saving model ...
Epoch: 12 cost time: 1.6881992816925049
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.414 Vali Acc: 0.878 Test Loss: 0.414 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.8157052993774414
Epoch: 13, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.359 Vali Acc: 0.844 Test Loss: 0.359 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.865513563156128
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9418251514434814
Epoch: 15, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.895341157913208
Epoch: 16, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.422 Vali Acc: 0.872 Test Loss: 0.422 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9427833557128906
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9425077438354492
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0002787113189697
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.884281873703003
Epoch: 20, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8615987300872803
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.956650972366333
Epoch: 22, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8573341369628906
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.053048610687256
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.376 Vali Acc: 0.878 Test Loss: 0.376 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8412935733795166
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1054150
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1966044902801514
Epoch: 1, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.039 Vali Acc: 0.706 Test Loss: 1.039 Test Acc: 0.706
Validation loss decreased (inf --> -0.705545).  Saving model ...
Epoch: 2 cost time: 1.5796656608581543
Epoch: 2, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.541 Vali Acc: 0.728 Test Loss: 0.541 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727772).  Saving model ...
Epoch: 3 cost time: 1.5153131484985352
Epoch: 3, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.439 Vali Acc: 0.811 Test Loss: 0.439 Test Acc: 0.811
Validation loss decreased (-0.727772 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 1.4586563110351562
Epoch: 4, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5147886276245117
Epoch: 5, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6107521057128906
Epoch: 6, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.3938570022583008
Epoch: 7, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 1.84837007522583
Epoch: 8, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.5711236000061035
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.344 Vali Acc: 0.867 Test Loss: 0.344 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 1.7914950847625732
Epoch: 10, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.384 Vali Acc: 0.806 Test Loss: 0.384 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7297296524047852
Epoch: 11, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9072372913360596
Epoch: 12, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.5944528579711914
Epoch: 13, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4924488067626953
Epoch: 14, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5558645725250244
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 1.4983735084533691
Epoch: 16, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.348 Vali Acc: 0.894 Test Loss: 0.348 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 1.6249167919158936
Epoch: 17, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7980623245239258
Epoch: 18, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.7001104354858398
Epoch: 19, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9024198055267334
Epoch: 20, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.8264057636260986
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7833623886108398
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.246 Vali Acc: 0.883 Test Loss: 0.246 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8141601085662842
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.615267276763916
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7704048156738281
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6643977165222168
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.469 Vali Acc: 0.861 Test Loss: 0.469 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.532433271408081
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6336164474487305
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.342 Vali Acc: 0.856 Test Loss: 0.342 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5109362602233887
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7075674533843994
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 31 cost time: 1.4526846408843994
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 32 cost time: 1.679485559463501
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7910590171813965
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9239935874938965
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7811267375946045
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9356756210327148
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6370849609375
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.9006164073944092
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7566585540771484
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.861703872680664
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.652726650238037
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 814598
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5288589000701904
Epoch: 1, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.008 Vali Acc: 0.728 Test Loss: 1.008 Test Acc: 0.728
Validation loss decreased (inf --> -0.727768).  Saving model ...
Epoch: 2 cost time: 1.8215274810791016
Epoch: 2, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.554 Vali Acc: 0.728 Test Loss: 0.554 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727772).  Saving model ...
Epoch: 3 cost time: 1.9995481967926025
Epoch: 3, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.727772 --> -0.833329).  Saving model ...
Epoch: 4 cost time: 1.5853939056396484
Epoch: 4, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7092642784118652
Epoch: 5, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.393 Vali Acc: 0.806 Test Loss: 0.393 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5696213245391846
Epoch: 6, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8446283340454102
Epoch: 7, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.304 Vali Acc: 0.822 Test Loss: 0.304 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3411900997161865
Epoch: 8, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
Validation loss decreased (-0.833329 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 1.7588117122650146
Epoch: 9, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.340 Vali Acc: 0.817 Test Loss: 0.340 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9341745376586914
Epoch: 10, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 1.9964687824249268
Epoch: 11, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.278 Vali Acc: 0.844 Test Loss: 0.278 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9631462097167969
Epoch: 12, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.407 Vali Acc: 0.883 Test Loss: 0.407 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.884399175643921
Epoch: 13, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8607101440429688
Epoch: 14, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0480237007141113
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9112820625305176
Epoch: 16, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9443674087524414
Epoch: 17, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8416876792907715
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9381370544433594
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.280 Vali Acc: 0.878 Test Loss: 0.280 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8789920806884766
Epoch: 20, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 814662
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.993091583251953
Epoch: 1, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.122 Vali Acc: 0.683 Test Loss: 1.122 Test Acc: 0.683
Validation loss decreased (inf --> -0.683322).  Saving model ...
Epoch: 2 cost time: 1.479794979095459
Epoch: 2, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.592 Vali Acc: 0.733 Test Loss: 0.592 Test Acc: 0.733
Validation loss decreased (-0.683322 --> -0.733327).  Saving model ...
Epoch: 3 cost time: 1.5788419246673584
Epoch: 3, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.465 Vali Acc: 0.789 Test Loss: 0.465 Test Acc: 0.789
Validation loss decreased (-0.733327 --> -0.788884).  Saving model ...
Epoch: 4 cost time: 1.6401846408843994
Epoch: 4, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.389 Vali Acc: 0.806 Test Loss: 0.389 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 1.473623514175415
Epoch: 5, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.450 Vali Acc: 0.778 Test Loss: 0.450 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5374815464019775
Epoch: 6, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.379 Vali Acc: 0.822 Test Loss: 0.379 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.269775152206421
Epoch: 7, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.5101618766784668
Epoch: 8, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
Validation loss decreased (-0.827774 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 1.4569380283355713
Epoch: 9, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4985597133636475
Epoch: 10, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 11 cost time: 1.5909419059753418
Epoch: 11, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.446 Vali Acc: 0.811 Test Loss: 0.446 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5524446964263916
Epoch: 12, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.341 Vali Acc: 0.883 Test Loss: 0.341 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.462423324584961
Epoch: 13, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5834410190582275
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6457042694091797
Epoch: 15, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5097734928131104
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.745539903640747
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.335057020187378
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.271 Vali Acc: 0.850 Test Loss: 0.271 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5958778858184814
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.466426134109497
Epoch: 20, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.337 Vali Acc: 0.883 Test Loss: 0.337 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3981459140777588
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.883 Test Loss: 0.240 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 1.4499242305755615
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4869046211242676
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 1.4973435401916504
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5339763164520264
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 26 cost time: 1.6204805374145508
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.637585163116455
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.635385274887085
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5018730163574219
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5952527523040771
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.5088729858398438
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.569291591644287
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4509437084197998
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4679288864135742
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4315385818481445
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5203256607055664
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4570021629333496
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5737888813018799
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.51615571975708
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.593277931213379
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 741062
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9654581546783447
Epoch: 1, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.281 Vali Acc: 0.656 Test Loss: 1.281 Test Acc: 0.656
Validation loss decreased (inf --> -0.655543).  Saving model ...
Epoch: 2 cost time: 1.319016695022583
Epoch: 2, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.685 Vali Acc: 0.700 Test Loss: 0.685 Test Acc: 0.700
Validation loss decreased (-0.655543 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 1.4579882621765137
Epoch: 3, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.503 Vali Acc: 0.750 Test Loss: 0.503 Test Acc: 0.750
Validation loss decreased (-0.699993 --> -0.749995).  Saving model ...
Epoch: 4 cost time: 1.3358485698699951
Epoch: 4, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
Validation loss decreased (-0.749995 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 1.5592949390411377
Epoch: 5, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.396 Vali Acc: 0.772 Test Loss: 0.396 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4379518032073975
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.349 Vali Acc: 0.839 Test Loss: 0.349 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 1.4934840202331543
Epoch: 7, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3967680931091309
Epoch: 8, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.326 Vali Acc: 0.828 Test Loss: 0.326 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5099265575408936
Epoch: 9, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.4804160594940186
Epoch: 10, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.475468635559082
Epoch: 11, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.312 Vali Acc: 0.833 Test Loss: 0.312 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4124813079833984
Epoch: 12, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4398369789123535
Epoch: 13, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4618258476257324
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 15 cost time: 1.3673877716064453
Epoch: 15, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1981139183044434
Epoch: 16, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.286 Vali Acc: 0.850 Test Loss: 0.286 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.231107234954834
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
Validation loss decreased (-0.872220 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 1.3230068683624268
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.300 Vali Acc: 0.867 Test Loss: 0.300 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2907192707061768
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2968089580535889
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.366 Vali Acc: 0.867 Test Loss: 0.366 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3602705001831055
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3978025913238525
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.250070333480835
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3919801712036133
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 1.4384427070617676
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6046240329742432
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 27 cost time: 1.446500301361084
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
Validation loss decreased (-0.905554 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.4942948818206787
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4102303981781006
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.894 Test Loss: 0.212 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5818374156951904
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3809409141540527
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4125087261199951
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4205279350280762
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3248164653778076
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5199401378631592
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3153491020202637
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3518853187561035
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 695110
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6890153884887695
Epoch: 1, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.390 Vali Acc: 0.583 Test Loss: 1.390 Test Acc: 0.583
Validation loss decreased (inf --> -0.583319).  Saving model ...
Epoch: 2 cost time: 1.4862072467803955
Epoch: 2, Steps: 12 | Train Loss: 1.025 Vali Loss: 0.837 Vali Acc: 0.711 Test Loss: 0.837 Test Acc: 0.711
Validation loss decreased (-0.583319 --> -0.711103).  Saving model ...
Epoch: 3 cost time: 1.3401334285736084
Epoch: 3, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.595 Vali Acc: 0.756 Test Loss: 0.595 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.3238909244537354
Epoch: 4, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.496 Vali Acc: 0.761 Test Loss: 0.496 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.3751022815704346
Epoch: 5, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
Validation loss decreased (-0.761106 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.3647117614746094
Epoch: 6, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.386 Vali Acc: 0.800 Test Loss: 0.386 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.42354416847229
Epoch: 7, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1954972743988037
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.3863227367401123
Epoch: 9, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.344 Vali Acc: 0.828 Test Loss: 0.344 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.438570499420166
Epoch: 10, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.3293085098266602
Epoch: 11, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.363837718963623
Epoch: 12, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.501842975616455
Epoch: 13, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.306 Vali Acc: 0.861 Test Loss: 0.306 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 1.5095539093017578
Epoch: 14, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3225843906402588
Epoch: 15, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4867751598358154
Epoch: 16, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 1.4356050491333008
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3448188304901123
Epoch: 18, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3835828304290771
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3725495338439941
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.287 Vali Acc: 0.839 Test Loss: 0.287 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4622762203216553
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.194979190826416
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.380188226699829
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
Validation loss decreased (-0.861108 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.2268757820129395
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2068469524383545
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3483965396881104
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3377420902252197
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3069560527801514
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.259 Vali Acc: 0.872 Test Loss: 0.259 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4483411312103271
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6770195960998535
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 1.2241501808166504
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4605352878570557
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3835041522979736
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 1.3868253231048584
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3451347351074219
Epoch: 35, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3952031135559082
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4069104194641113
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.249396562576294
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.894 Test Loss: 0.219 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3965466022491455
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 1.3319242000579834
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3785219192504883
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.5423953533172607
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4471063613891602
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 1.4182593822479248
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.474125862121582
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3130125999450684
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.329566240310669
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 48 cost time: 1.3408584594726562
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2848644256591797
Epoch: 49, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2360262870788574
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 658438
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.250415325164795
Epoch: 1, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.479 Vali Acc: 0.561 Test Loss: 1.479 Test Acc: 0.561
Validation loss decreased (inf --> -0.561096).  Saving model ...
Epoch: 2 cost time: 1.426988124847412
Epoch: 2, Steps: 12 | Train Loss: 1.112 Vali Loss: 0.905 Vali Acc: 0.689 Test Loss: 0.905 Test Acc: 0.689
Validation loss decreased (-0.561096 --> -0.688880).  Saving model ...
Epoch: 3 cost time: 1.3749370574951172
Epoch: 3, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.611 Vali Acc: 0.739 Test Loss: 0.611 Test Acc: 0.739
Validation loss decreased (-0.688880 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 1.524914026260376
Epoch: 4, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.500 Vali Acc: 0.772 Test Loss: 0.500 Test Acc: 0.772
Validation loss decreased (-0.738883 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 1.3864176273345947
Epoch: 5, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.436 Vali Acc: 0.794 Test Loss: 0.436 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.461658239364624
Epoch: 6, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.385 Vali Acc: 0.828 Test Loss: 0.385 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.2406044006347656
Epoch: 7, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.399 Vali Acc: 0.794 Test Loss: 0.399 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3581013679504395
Epoch: 8, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.327596664428711
Epoch: 9, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.328 Vali Acc: 0.833 Test Loss: 0.328 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3884174823760986
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.27858304977417
Epoch: 11, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4620318412780762
Epoch: 12, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.294 Vali Acc: 0.867 Test Loss: 0.294 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.4073948860168457
Epoch: 13, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.4489045143127441
Epoch: 14, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4513378143310547
Epoch: 15, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.4740984439849854
Epoch: 16, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4406919479370117
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5596239566802979
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5170528888702393
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.368251085281372
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.2593247890472412
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3012042045593262
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 23 cost time: 1.202082872390747
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
Validation loss decreased (-0.888887 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.2528343200683594
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3223276138305664
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.3398146629333496
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.213 Vali Acc: 0.906 Test Loss: 0.213 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4354894161224365
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4100730419158936
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5611517429351807
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 30 cost time: 1.44758939743042
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 1.5899324417114258
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4736738204956055
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6079764366149902
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.180 Vali Acc: 0.911 Test Loss: 0.180 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3622214794158936
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.906 Test Loss: 0.195 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.556915044784546
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3226819038391113
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4720406532287598
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.911 Test Loss: 0.191 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3445093631744385
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.894 Test Loss: 0.191 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5247740745544434
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.365264892578125
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 649350
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1519479751586914
Epoch: 1, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.021 Vali Acc: 0.694 Test Loss: 1.021 Test Acc: 0.694
Validation loss decreased (inf --> -0.694434).  Saving model ...
Epoch: 2 cost time: 1.404839038848877
Epoch: 2, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.522 Vali Acc: 0.772 Test Loss: 0.522 Test Acc: 0.772
Validation loss decreased (-0.694434 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 1.6516244411468506
Epoch: 3, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.431 Vali Acc: 0.811 Test Loss: 0.431 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 1.4635562896728516
Epoch: 4, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.335 Vali Acc: 0.822 Test Loss: 0.335 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 5 cost time: 1.2820243835449219
Epoch: 5, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.453 Vali Acc: 0.839 Test Loss: 0.453 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838884).  Saving model ...
Epoch: 6 cost time: 1.2176039218902588
Epoch: 6, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.386 Vali Acc: 0.839 Test Loss: 0.386 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 1.4837374687194824
Epoch: 7, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.838885 --> -0.894442).  Saving model ...
Epoch: 8 cost time: 1.3501338958740234
Epoch: 8, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3620326519012451
Epoch: 9, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2977886199951172
Epoch: 10, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 11 cost time: 1.1820180416107178
Epoch: 11, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.392632007598877
Epoch: 12, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5332069396972656
Epoch: 13, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.42216157913208
Epoch: 14, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4098515510559082
Epoch: 15, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.425565481185913
Epoch: 16, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.236 Vali Acc: 0.872 Test Loss: 0.236 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4779820442199707
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6775224208831787
Epoch: 18, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.475036859512329
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7010180950164795
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 428774
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7112877368927
Epoch: 1, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.345 Vali Acc: 0.656 Test Loss: 1.345 Test Acc: 0.656
Validation loss decreased (inf --> -0.655542).  Saving model ...
Epoch: 2 cost time: 1.067929744720459
Epoch: 2, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.729 Vali Acc: 0.728 Test Loss: 0.729 Test Acc: 0.728
Validation loss decreased (-0.655542 --> -0.727770).  Saving model ...
Epoch: 3 cost time: 1.0353362560272217
Epoch: 3, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
Validation loss decreased (-0.727770 --> -0.761106).  Saving model ...
Epoch: 4 cost time: 1.2130155563354492
Epoch: 4, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.447 Vali Acc: 0.783 Test Loss: 0.447 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.235320806503296
Epoch: 5, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.392 Vali Acc: 0.783 Test Loss: 0.392 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.3560683727264404
Epoch: 6, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.376 Vali Acc: 0.794 Test Loss: 0.376 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794441).  Saving model ...
Epoch: 7 cost time: 1.2147588729858398
Epoch: 7, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
Validation loss decreased (-0.794441 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 1.3489553928375244
Epoch: 8, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.40040922164917
Epoch: 9, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.1900513172149658
Epoch: 10, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3084299564361572
Epoch: 11, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.0741450786590576
Epoch: 12, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2115979194641113
Epoch: 13, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.189490795135498
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1265983581542969
Epoch: 15, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3342199325561523
Epoch: 16, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.311 Vali Acc: 0.867 Test Loss: 0.311 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 17 cost time: 1.2076008319854736
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.303253173828125
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 19 cost time: 1.3238003253936768
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.192934513092041
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3429312705993652
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1091389656066895
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 1.5196521282196045
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.289 Vali Acc: 0.844 Test Loss: 0.289 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3653771877288818
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.349668025970459
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.404160976409912
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 27 cost time: 1.3329627513885498
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 1.369974136352539
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2241346836090088
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3563988208770752
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1537933349609375
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.278958797454834
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.302323341369629
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.234 Vali Acc: 0.883 Test Loss: 0.234 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0638103485107422
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3192479610443115
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2268457412719727
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.233933687210083
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 38 cost time: 1.0503454208374023
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1567294597625732
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
Validation loss decreased (-0.888887 --> -0.894441).  Saving model ...
Epoch: 40 cost time: 1.249258041381836
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 41 cost time: 1.0315299034118652
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.883 Test Loss: 0.240 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1509828567504883
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1140036582946777
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2776703834533691
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3077044486999512
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9663212299346924
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2756822109222412
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3397655487060547
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2395570278167725
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.2951507568359375
Epoch: 50, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 308998
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8541488647460938
Epoch: 1, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.246 Vali Acc: 0.683 Test Loss: 1.246 Test Acc: 0.683
Validation loss decreased (inf --> -0.683321).  Saving model ...
Epoch: 2 cost time: 1.3428599834442139
Epoch: 2, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.696 Vali Acc: 0.761 Test Loss: 0.696 Test Acc: 0.761
Validation loss decreased (-0.683321 --> -0.761104).  Saving model ...
Epoch: 3 cost time: 1.3665924072265625
Epoch: 3, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.522 Vali Acc: 0.744 Test Loss: 0.522 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2055397033691406
Epoch: 4, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
Validation loss decreased (-0.761104 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.254063606262207
Epoch: 5, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.392 Vali Acc: 0.794 Test Loss: 0.392 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1579523086547852
Epoch: 6, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 1.2548511028289795
Epoch: 7, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
Validation loss decreased (-0.822219 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 1.2170138359069824
Epoch: 8, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2401409149169922
Epoch: 9, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 10 cost time: 1.11332368850708
Epoch: 10, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 1.0656254291534424
Epoch: 11, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.405 Vali Acc: 0.817 Test Loss: 0.405 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1009721755981445
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0991218090057373
Epoch: 13, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.0511627197265625
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 1.1097502708435059
Epoch: 15, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0262548923492432
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.135037899017334
Epoch: 17, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.131396770477295
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.232475996017456
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.296 Vali Acc: 0.856 Test Loss: 0.296 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2290029525756836
Epoch: 20, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.2423994541168213
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.176748275756836
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 23 cost time: 1.2752416133880615
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.1346104145050049
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.154069423675537
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1562366485595703
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 1.1415793895721436
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 1.0925877094268799
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0465104579925537
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2197787761688232
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1255426406860352
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3066515922546387
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.399 Vali Acc: 0.883 Test Loss: 0.399 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1896305084228516
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.889 Test Loss: 0.241 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3296403884887695
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.221670150756836
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.3192310333251953
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2261667251586914
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 309030
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.366809606552124
Epoch: 1, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.413 Vali Acc: 0.556 Test Loss: 1.413 Test Acc: 0.556
Validation loss decreased (inf --> -0.555541).  Saving model ...
Epoch: 2 cost time: 1.0096378326416016
Epoch: 2, Steps: 12 | Train Loss: 1.025 Vali Loss: 0.820 Vali Acc: 0.733 Test Loss: 0.820 Test Acc: 0.733
Validation loss decreased (-0.555541 --> -0.733325).  Saving model ...
Epoch: 3 cost time: 1.0372929573059082
Epoch: 3, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.572 Vali Acc: 0.778 Test Loss: 0.572 Test Acc: 0.778
Validation loss decreased (-0.733325 --> -0.777772).  Saving model ...
Epoch: 4 cost time: 1.0183885097503662
Epoch: 4, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.490 Vali Acc: 0.772 Test Loss: 0.490 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.176522970199585
Epoch: 5, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.428 Vali Acc: 0.822 Test Loss: 0.428 Test Acc: 0.822
Validation loss decreased (-0.777772 --> -0.822218).  Saving model ...
Epoch: 6 cost time: 1.2352888584136963
Epoch: 6, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.389 Vali Acc: 0.822 Test Loss: 0.389 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.2808074951171875
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 8 cost time: 1.2771937847137451
Epoch: 8, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.2169432640075684
Epoch: 9, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.156691551208496
Epoch: 10, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1311492919921875
Epoch: 11, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1679162979125977
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 1.0365855693817139
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0637030601501465
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.326 Vali Acc: 0.828 Test Loss: 0.326 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1765174865722656
Epoch: 15, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0917754173278809
Epoch: 16, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.403 Vali Acc: 0.822 Test Loss: 0.403 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0640993118286133
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.373 Vali Acc: 0.844 Test Loss: 0.373 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.162060022354126
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.318 Vali Acc: 0.822 Test Loss: 0.318 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1216316223144531
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 1.1784532070159912
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.304586410522461
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 1.2321803569793701
Epoch: 22, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2381582260131836
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.323 Vali Acc: 0.883 Test Loss: 0.323 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1911475658416748
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1451501846313477
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.270 Vali Acc: 0.883 Test Loss: 0.270 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 26 cost time: 1.1334071159362793
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 1.0876247882843018
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9845833778381348
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 0.9066102504730225
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 0.9537632465362549
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.958765983581543
Epoch: 31, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 0.9954338073730469
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.0788989067077637
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.085787296295166
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2571868896484375
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2386198043823242
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2249574661254883
Epoch: 37, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.883 Test Loss: 0.243 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1305291652679443
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1879160404205322
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0664606094360352
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 1.0991227626800537
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0596189498901367
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1315653324127197
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0027744770050049
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 45 cost time: 1.196561336517334
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 1.0955994129180908
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927775).  Saving model ...
Epoch: 47 cost time: 1.2180466651916504
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.135279655456543
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.287092685699463
Epoch: 49, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.210350513458252
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.894 Test Loss: 0.188 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 272230
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.561434745788574
Epoch: 1, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.487 Vali Acc: 0.489 Test Loss: 1.487 Test Acc: 0.489
Validation loss decreased (inf --> -0.488874).  Saving model ...
Epoch: 2 cost time: 0.9985301494598389
Epoch: 2, Steps: 12 | Train Loss: 1.115 Vali Loss: 0.948 Vali Acc: 0.683 Test Loss: 0.948 Test Acc: 0.683
Validation loss decreased (-0.488874 --> -0.683324).  Saving model ...
Epoch: 3 cost time: 1.0920684337615967
Epoch: 3, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.683 Vali Acc: 0.728 Test Loss: 0.683 Test Acc: 0.728
Validation loss decreased (-0.683324 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 0.9338562488555908
Epoch: 4, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.561 Vali Acc: 0.756 Test Loss: 0.561 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 1.157209873199463
Epoch: 5, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.466 Vali Acc: 0.778 Test Loss: 0.466 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.1128301620483398
Epoch: 6, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.417 Vali Acc: 0.789 Test Loss: 0.417 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 1.1344764232635498
Epoch: 7, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.386 Vali Acc: 0.839 Test Loss: 0.386 Test Acc: 0.839
Validation loss decreased (-0.788885 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.1193959712982178
Epoch: 8, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2880358695983887
Epoch: 9, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.164567232131958
Epoch: 10, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.0646860599517822
Epoch: 11, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 1.1042132377624512
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.1061666011810303
Epoch: 13, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 1.0824806690216064
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.0755608081817627
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1060678958892822
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0884366035461426
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9875645637512207
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 1.1045846939086914
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1038727760314941
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.188405990600586
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 1.1476795673370361
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.321 Vali Acc: 0.839 Test Loss: 0.321 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2531440258026123
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.205319881439209
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.273 Vali Acc: 0.867 Test Loss: 0.273 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2000644207000732
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.261 Vali Acc: 0.867 Test Loss: 0.261 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1207170486450195
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1387887001037598
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.261 Vali Acc: 0.867 Test Loss: 0.261 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1675939559936523
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.9647126197814941
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0402631759643555
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0135753154754639
Epoch: 31, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9251799583435059
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.101050853729248
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0395588874816895
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.883 Test Loss: 0.224 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9705474376678467
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1448237895965576
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.14152193069458
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2683992385864258
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 39 cost time: 1.0700578689575195
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.209 Vali Acc: 0.883 Test Loss: 0.209 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.092055320739746
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 41 cost time: 1.1263487339019775
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0916645526885986
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9313910007476807
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9648058414459229
Epoch: 44, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.889 Test Loss: 0.211 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1750245094299316
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.894 Test Loss: 0.191 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1278865337371826
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 47 cost time: 1.257256269454956
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.894 Test Loss: 0.200 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1508989334106445
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2215631008148193
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.906 Test Loss: 0.198 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905554).  Saving model ...
Epoch: 50 cost time: 1.1246471405029297
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 249254
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3645756244659424
Epoch: 1, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.595 Vali Acc: 0.383 Test Loss: 1.595 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 1.00492262840271
Epoch: 2, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.144 Vali Acc: 0.656 Test Loss: 1.144 Test Acc: 0.656
Validation loss decreased (-0.383317 --> -0.655544).  Saving model ...
Epoch: 3 cost time: 1.0509493350982666
Epoch: 3, Steps: 12 | Train Loss: 0.896 Vali Loss: 0.789 Vali Acc: 0.711 Test Loss: 0.789 Test Acc: 0.711
Validation loss decreased (-0.655544 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 0.9970095157623291
Epoch: 4, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.630 Vali Acc: 0.744 Test Loss: 0.630 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744438).  Saving model ...
Epoch: 5 cost time: 1.137632131576538
Epoch: 5, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.744438 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.0108940601348877
Epoch: 6, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.0358970165252686
Epoch: 7, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 1.0223324298858643
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 1.208721399307251
Epoch: 9, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.379 Vali Acc: 0.800 Test Loss: 0.379 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.180527925491333
Epoch: 10, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.348 Vali Acc: 0.856 Test Loss: 0.348 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.1331863403320312
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0014336109161377
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.1267564296722412
Epoch: 13, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 1.0961840152740479
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.318 Vali Acc: 0.856 Test Loss: 0.318 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.048046588897705
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.1371994018554688
Epoch: 16, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.03190279006958
Epoch: 17, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0302681922912598
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.2203254699707031
Epoch: 19, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.010472297668457
Epoch: 20, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0604221820831299
Epoch: 21, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2034056186676025
Epoch: 22, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.281 Vali Acc: 0.872 Test Loss: 0.281 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1008312702178955
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.276 Vali Acc: 0.850 Test Loss: 0.276 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2184932231903076
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0357556343078613
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1118240356445312
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9797711372375488
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.861 Test Loss: 0.268 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1347479820251465
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 1.15256667137146
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1529829502105713
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.9924585819244385
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.230 Vali Acc: 0.872 Test Loss: 0.230 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0449986457824707
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.227 Vali Acc: 0.906 Test Loss: 0.227 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 1.1493711471557617
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.883 Test Loss: 0.218 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0179946422576904
Epoch: 34, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.081066608428955
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.207 Vali Acc: 0.894 Test Loss: 0.207 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0630342960357666
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.906 Test Loss: 0.192 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905554).  Saving model ...
Epoch: 37 cost time: 1.1077609062194824
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.900 Test Loss: 0.192 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0755524635314941
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916665).  Saving model ...
Epoch: 39 cost time: 1.0964763164520264
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.911 Test Loss: 0.183 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.106583833694458
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.911 Test Loss: 0.196 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0408506393432617
Epoch: 41, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.894 Test Loss: 0.184 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.990271806716919
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.894 Test Loss: 0.196 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1009232997894287
Epoch: 43, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.900 Test Loss: 0.173 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1102542877197266
Epoch: 44, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.889 Test Loss: 0.196 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0440242290496826
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.889 Test Loss: 0.192 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0755317211151123
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.900 Test Loss: 0.182 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1789512634277344
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.906 Test Loss: 0.186 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1947810649871826
Epoch: 48, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.182 Vali Acc: 0.900 Test Loss: 0.182 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 230918
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5016748905181885
Epoch: 1, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.582 Vali Acc: 0.378 Test Loss: 1.582 Test Acc: 0.378
Validation loss decreased (inf --> -0.377762).  Saving model ...
Epoch: 2 cost time: 1.0837934017181396
Epoch: 2, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.195 Vali Acc: 0.650 Test Loss: 1.195 Test Acc: 0.650
Validation loss decreased (-0.377762 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 1.2152776718139648
Epoch: 3, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.879 Vali Acc: 0.672 Test Loss: 0.879 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672213).  Saving model ...
Epoch: 4 cost time: 1.1877102851867676
Epoch: 4, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
Validation loss decreased (-0.672213 --> -0.716660).  Saving model ...
Epoch: 5 cost time: 1.0301921367645264
Epoch: 5, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.599 Vali Acc: 0.728 Test Loss: 0.599 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 1.0839173793792725
Epoch: 6, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.530 Vali Acc: 0.767 Test Loss: 0.530 Test Acc: 0.767
Validation loss decreased (-0.727772 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 1.0213165283203125
Epoch: 7, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.479 Vali Acc: 0.778 Test Loss: 0.479 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 0.9225163459777832
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.437 Vali Acc: 0.811 Test Loss: 0.437 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 0.9685461521148682
Epoch: 9, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9845473766326904
Epoch: 10, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.394 Vali Acc: 0.811 Test Loss: 0.394 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 0.9997878074645996
Epoch: 11, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 1.0086047649383545
Epoch: 12, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 13 cost time: 1.0640006065368652
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 1.1277601718902588
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 15 cost time: 1.1602911949157715
Epoch: 15, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1230449676513672
Epoch: 16, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.1559739112854004
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.341 Vali Acc: 0.856 Test Loss: 0.341 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.084031581878662
Epoch: 18, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0954515933990479
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0795204639434814
Epoch: 20, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 21 cost time: 1.0830905437469482
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 1.095320463180542
Epoch: 22, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2148139476776123
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 1.1074962615966797
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.127781867980957
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1643974781036377
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 27 cost time: 1.1140391826629639
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.872 Test Loss: 0.282 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1933462619781494
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 1.1081933975219727
Epoch: 29, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.079582691192627
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1057133674621582
Epoch: 31, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1002888679504395
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.251 Vali Acc: 0.872 Test Loss: 0.251 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.086435317993164
Epoch: 33, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0428516864776611
Epoch: 34, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.021045446395874
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.883 Test Loss: 0.235 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9498453140258789
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 0.9511480331420898
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9879879951477051
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9608395099639893
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 40 cost time: 1.0039236545562744
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.894 Test Loss: 0.220 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.976038932800293
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0392096042633057
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.230 Vali Acc: 0.894 Test Loss: 0.230 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.107985019683838
Epoch: 43, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 44 cost time: 1.058678150177002
Epoch: 44, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.883 Test Loss: 0.206 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0578672885894775
Epoch: 45, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.894 Test Loss: 0.204 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0452394485473633
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.911 Test Loss: 0.203 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 47 cost time: 1.0251731872558594
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 48 cost time: 1.073965072631836
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.911 Test Loss: 0.190 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9801361560821533
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.900 Test Loss: 0.189 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9583632946014404
Epoch: 50, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 226374
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.039927959442139
Epoch: 1, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.494 Vali Acc: 0.722 Test Loss: 1.494 Test Acc: 0.722
Validation loss decreased (inf --> -0.722207).  Saving model ...
Epoch: 2 cost time: 2.331655740737915
Epoch: 2, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.806 Vali Acc: 0.728 Test Loss: 0.806 Test Acc: 0.728
Validation loss decreased (-0.722207 --> -0.727770).  Saving model ...
Epoch: 3 cost time: 2.2460436820983887
Epoch: 3, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.487 Vali Acc: 0.778 Test Loss: 0.487 Test Acc: 0.778
Validation loss decreased (-0.727770 --> -0.777773).  Saving model ...
Epoch: 4 cost time: 2.3188769817352295
Epoch: 4, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
Validation loss decreased (-0.777773 --> -0.833329).  Saving model ...
Epoch: 5 cost time: 2.381465196609497
Epoch: 5, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.312 Vali Acc: 0.817 Test Loss: 0.312 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1285276412963867
Epoch: 6, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 1.9638350009918213
Epoch: 7, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1165621280670166
Epoch: 8, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.334 Vali Acc: 0.872 Test Loss: 0.334 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 1.9188780784606934
Epoch: 9, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.395 Vali Acc: 0.806 Test Loss: 0.395 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0403194427490234
Epoch: 10, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1177730560302734
Epoch: 11, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.197 Vali Acc: 0.894 Test Loss: 0.197 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 2.0808398723602295
Epoch: 12, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5451059341430664
Epoch: 13, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
Validation loss decreased (-0.894442 --> -0.927776).  Saving model ...
Epoch: 14 cost time: 2.5700981616973877
Epoch: 14, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.367 Vali Acc: 0.883 Test Loss: 0.367 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.751314878463745
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.434985637664795
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4425408840179443
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.082519054412842
Epoch: 18, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2678184509277344
Epoch: 19, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2643532752990723
Epoch: 20, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1999258995056152
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5414679050445557
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.310 Vali Acc: 0.906 Test Loss: 0.310 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.4593992233276367
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 1691110
model size : 6.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2669010162353516
Epoch: 1, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.598 Vali Acc: 0.633 Test Loss: 1.598 Test Acc: 0.633
Validation loss decreased (inf --> -0.633317).  Saving model ...
Epoch: 2 cost time: 1.8517870903015137
Epoch: 2, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.106 Vali Acc: 0.711 Test Loss: 1.106 Test Acc: 0.711
Validation loss decreased (-0.633317 --> -0.711100).  Saving model ...
Epoch: 3 cost time: 1.9159605503082275
Epoch: 3, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.690 Vali Acc: 0.711 Test Loss: 0.690 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711104).  Saving model ...
Epoch: 4 cost time: 2.226088762283325
Epoch: 4, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.495 Vali Acc: 0.772 Test Loss: 0.495 Test Acc: 0.772
Validation loss decreased (-0.711104 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.5224854946136475
Epoch: 5, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822218).  Saving model ...
Epoch: 6 cost time: 2.536252021789551
Epoch: 6, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 2.3915915489196777
Epoch: 7, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.364 Vali Acc: 0.839 Test Loss: 0.364 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.461266040802002
Epoch: 8, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.335 Vali Acc: 0.817 Test Loss: 0.335 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3539984226226807
Epoch: 9, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 2.2339539527893066
Epoch: 10, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 2.2360355854034424
Epoch: 11, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.116990327835083
Epoch: 12, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 2.1276357173919678
Epoch: 13, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 2.2149574756622314
Epoch: 14, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.2100777626037598
Epoch: 15, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.274 Vali Acc: 0.844 Test Loss: 0.274 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4307355880737305
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.420 Vali Acc: 0.867 Test Loss: 0.420 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.571723699569702
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.389224052429199
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.248 Vali Acc: 0.878 Test Loss: 0.248 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 2.0193748474121094
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 20 cost time: 2.2437241077423096
Epoch: 20, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 21 cost time: 2.2275049686431885
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.14353084564209
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 2.2518558502197266
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 2.438591480255127
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 2.5761656761169434
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2696056365966797
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.435856342315674
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.445 Vali Acc: 0.883 Test Loss: 0.445 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.1459810733795166
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 2.080091714859009
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.115178346633911
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1662726402282715
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.271667003631592
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.439248561859131
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.748549461364746
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.65395188331604
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.566976308822632
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.4751136302948
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.018150806427002
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1580550
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8025918006896973
Epoch: 1, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.589 Vali Acc: 0.667 Test Loss: 1.589 Test Acc: 0.667
Validation loss decreased (inf --> -0.666651).  Saving model ...
Epoch: 2 cost time: 2.4863576889038086
Epoch: 2, Steps: 12 | Train Loss: 1.145 Vali Loss: 1.039 Vali Acc: 0.667 Test Loss: 1.039 Test Acc: 0.667
Validation loss decreased (-0.666651 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 2.3724350929260254
Epoch: 3, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
Validation loss decreased (-0.666656 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 2.43753981590271
Epoch: 4, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.495 Vali Acc: 0.761 Test Loss: 0.495 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 2.2129623889923096
Epoch: 5, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.1339221000671387
Epoch: 6, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 2.0782461166381836
Epoch: 7, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0351102352142334
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 2.0602951049804688
Epoch: 9, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0916643142700195
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 2.2455430030822754
Epoch: 11, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.286 Vali Acc: 0.850 Test Loss: 0.286 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.282956123352051
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.367319107055664
Epoch: 13, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.356766700744629
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.274 Vali Acc: 0.839 Test Loss: 0.274 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1865625381469727
Epoch: 15, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 2.0585153102874756
Epoch: 16, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888887).  Saving model ...
Epoch: 17 cost time: 1.873641014099121
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
Validation loss decreased (-0.888887 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.862097978591919
Epoch: 18, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 1.952998161315918
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9765374660491943
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.883 Test Loss: 0.221 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9300947189331055
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.911 Test Loss: 0.190 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 2.074746608734131
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0398478507995605
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8662190437316895
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.206 Vali Acc: 0.906 Test Loss: 0.206 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6324889659881592
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.911 Test Loss: 0.202 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7629013061523438
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9584619998931885
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.316 Vali Acc: 0.906 Test Loss: 0.316 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1369998455047607
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1337409019470215
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 2.2442820072174072
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3246102333068848
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933332).  Saving model ...
Epoch: 32 cost time: 2.2562785148620605
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.209974527359009
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.1521706581115723
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.064842700958252
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.1002633571624756
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.086268186569214
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.225865602493286
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.1169488430023193
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.2176411151885986
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.2287685871124268
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1580582
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.727727174758911
Epoch: 1, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.687 Vali Acc: 0.467 Test Loss: 1.687 Test Acc: 0.467
Validation loss decreased (inf --> -0.466650).  Saving model ...
Epoch: 2 cost time: 2.2791800498962402
Epoch: 2, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.241 Vali Acc: 0.717 Test Loss: 1.241 Test Acc: 0.717
Validation loss decreased (-0.466650 --> -0.716654).  Saving model ...
Epoch: 3 cost time: 2.541630983352661
Epoch: 3, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.769 Vali Acc: 0.772 Test Loss: 0.769 Test Acc: 0.772
Validation loss decreased (-0.716654 --> -0.772215).  Saving model ...
Epoch: 4 cost time: 2.5656545162200928
Epoch: 4, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.567 Vali Acc: 0.778 Test Loss: 0.567 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777772).  Saving model ...
Epoch: 5 cost time: 2.6898529529571533
Epoch: 5, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.469 Vali Acc: 0.767 Test Loss: 0.469 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4244987964630127
Epoch: 6, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 2.468343734741211
Epoch: 7, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.363 Vali Acc: 0.800 Test Loss: 0.363 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3864734172821045
Epoch: 8, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.3825764656066895
Epoch: 9, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 10 cost time: 2.187817335128784
Epoch: 10, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.253939151763916
Epoch: 11, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.286 Vali Acc: 0.839 Test Loss: 0.286 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3202285766601562
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 2.349222183227539
Epoch: 13, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.310 Vali Acc: 0.839 Test Loss: 0.310 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3548481464385986
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.444740056991577
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4492990970611572
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.3924036026000977
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1495630741119385
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 2.3083884716033936
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.379605531692505
Epoch: 20, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 2.3159801959991455
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.136545419692993
Epoch: 22, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 2.5884878635406494
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4732093811035156
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.553856372833252
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.466858148574829
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.4028255939483643
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 2.417146921157837
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4146411418914795
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4291772842407227
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 2.433995485305786
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 2.524749517440796
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.50080943107605
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.2945120334625244
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.2978672981262207
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2591536045074463
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.38506817817688
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.4116952419281006
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.338063955307007
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.386815309524536
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.3739912509918213
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1543782
model size : 6.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.41068172454834
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.640 Vali Acc: 0.478 Test Loss: 1.640 Test Acc: 0.478
Validation loss decreased (inf --> -0.477761).  Saving model ...
Epoch: 2 cost time: 2.14003849029541
Epoch: 2, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.266 Vali Acc: 0.678 Test Loss: 1.266 Test Acc: 0.678
Validation loss decreased (-0.477761 --> -0.677765).  Saving model ...
Epoch: 3 cost time: 2.322287082672119
Epoch: 3, Steps: 12 | Train Loss: 0.966 Vali Loss: 0.860 Vali Acc: 0.722 Test Loss: 0.860 Test Acc: 0.722
Validation loss decreased (-0.677765 --> -0.722214).  Saving model ...
Epoch: 4 cost time: 2.2089827060699463
Epoch: 4, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761105).  Saving model ...
Epoch: 5 cost time: 2.4111220836639404
Epoch: 5, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.516 Vali Acc: 0.794 Test Loss: 0.516 Test Acc: 0.794
Validation loss decreased (-0.761105 --> -0.794439).  Saving model ...
Epoch: 6 cost time: 2.2636141777038574
Epoch: 6, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.471 Vali Acc: 0.778 Test Loss: 0.471 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2135934829711914
Epoch: 7, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.409 Vali Acc: 0.822 Test Loss: 0.409 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.9559311866760254
Epoch: 8, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.8869433403015137
Epoch: 9, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.338 Vali Acc: 0.856 Test Loss: 0.338 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 2.0426995754241943
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.0713000297546387
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.33242130279541
Epoch: 12, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.291 Vali Acc: 0.844 Test Loss: 0.291 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.291131019592285
Epoch: 13, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 14 cost time: 2.3283421993255615
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2124500274658203
Epoch: 15, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2080187797546387
Epoch: 16, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 2.0745043754577637
Epoch: 17, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 2.3429148197174072
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.236 Vali Acc: 0.872 Test Loss: 0.236 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 19 cost time: 2.1664462089538574
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 20 cost time: 2.2610249519348145
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.334 Vali Acc: 0.867 Test Loss: 0.334 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1599905490875244
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.240 Vali Acc: 0.878 Test Loss: 0.240 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3017115592956543
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4996535778045654
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 2.3402066230773926
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1360058784484863
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 26 cost time: 2.217655658721924
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0603842735290527
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 2.0497584342956543
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1918113231658936
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1840949058532715
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.214975357055664
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916663).  Saving model ...
Epoch: 32 cost time: 2.277432441711426
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.316603660583496
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.2143912315368652
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.2767231464385986
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.259547472000122
Epoch: 36, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.338 Vali Acc: 0.872 Test Loss: 0.338 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.1494839191436768
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.916663 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 2.194650650024414
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 2.1185455322265625
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.911 Test Loss: 0.200 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2797460556030273
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.1299290657043457
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.4914309978485107
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.200289726257324
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.248521566390991
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.0619475841522217
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.8815224170684814
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.042562246322632
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.032355308532715
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1506982
model size : 5.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5959198474884033
Epoch: 1, Steps: 12 | Train Loss: 1.721 Vali Loss: 1.698 Vali Acc: 0.406 Test Loss: 1.698 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 2.3493125438690186
Epoch: 2, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.377 Vali Acc: 0.694 Test Loss: 1.377 Test Acc: 0.694
Validation loss decreased (-0.405539 --> -0.694431).  Saving model ...
Epoch: 3 cost time: 2.2951407432556152
Epoch: 3, Steps: 12 | Train Loss: 1.086 Vali Loss: 0.996 Vali Acc: 0.739 Test Loss: 0.996 Test Acc: 0.739
Validation loss decreased (-0.694431 --> -0.738879).  Saving model ...
Epoch: 4 cost time: 2.0906717777252197
Epoch: 4, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.731 Vali Acc: 0.728 Test Loss: 0.731 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1497280597686768
Epoch: 5, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.582 Vali Acc: 0.778 Test Loss: 0.582 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 2.0371949672698975
Epoch: 6, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.501 Vali Acc: 0.756 Test Loss: 0.501 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.004000663757324
Epoch: 7, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.439 Vali Acc: 0.794 Test Loss: 0.439 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 2.0757334232330322
Epoch: 8, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.390 Vali Acc: 0.800 Test Loss: 0.390 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 9 cost time: 2.1465930938720703
Epoch: 9, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 2.1128902435302734
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 2.0171854496002197
Epoch: 11, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.327 Vali Acc: 0.872 Test Loss: 0.327 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.9449424743652344
Epoch: 12, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.312 Vali Acc: 0.850 Test Loss: 0.312 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.034717559814453
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0257461071014404
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.268 Vali Acc: 0.867 Test Loss: 0.268 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.056891679763794
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.264 Vali Acc: 0.861 Test Loss: 0.264 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.176665782928467
Epoch: 16, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 17 cost time: 2.1603283882141113
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 2.1361939907073975
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888887).  Saving model ...
Epoch: 19 cost time: 2.0893313884735107
Epoch: 19, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3644330501556396
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.241 Vali Acc: 0.872 Test Loss: 0.241 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.052833318710327
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.212 Vali Acc: 0.894 Test Loss: 0.212 Test Acc: 0.894
Validation loss decreased (-0.888887 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 2.215564012527466
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.107433795928955
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4148454666137695
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2295966148376465
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.146807909011841
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 27 cost time: 2.2870938777923584
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.146059036254883
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9571428298950195
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.079698324203491
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.911 Test Loss: 0.205 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 31 cost time: 1.9901301860809326
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.906 Test Loss: 0.189 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1077535152435303
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0858407020568848
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.32015061378479
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.245424270629883
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.164024829864502
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.2761781215667725
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 2.2056076526641846
Epoch: 38, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.203 Vali Acc: 0.911 Test Loss: 0.203 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.1413519382476807
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.1955435276031494
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.1606595516204834
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.0751864910125732
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.1292612552642822
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.1934115886688232
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.13051700592041
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.1276869773864746
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.1737446784973145
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1488646
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.612999677658081
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.714 Vali Acc: 0.389 Test Loss: 1.714 Test Acc: 0.389
Validation loss decreased (inf --> -0.388872).  Saving model ...
Epoch: 2 cost time: 2.209587335586548
Epoch: 2, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.439 Vali Acc: 0.650 Test Loss: 1.439 Test Acc: 0.650
Validation loss decreased (-0.388872 --> -0.649986).  Saving model ...
Epoch: 3 cost time: 2.3050105571746826
Epoch: 3, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.069 Vali Acc: 0.689 Test Loss: 1.069 Test Acc: 0.689
Validation loss decreased (-0.649986 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 2.101137161254883
Epoch: 4, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.813 Vali Acc: 0.683 Test Loss: 0.813 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.053833246231079
Epoch: 5, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 2.0545897483825684
Epoch: 6, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.548 Vali Acc: 0.767 Test Loss: 0.548 Test Acc: 0.767
Validation loss decreased (-0.722216 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 2.0878419876098633
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.483 Vali Acc: 0.778 Test Loss: 0.483 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 2.0622811317443848
Epoch: 8, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.427 Vali Acc: 0.794 Test Loss: 0.427 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 2.2956008911132812
Epoch: 9, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.394 Vali Acc: 0.806 Test Loss: 0.394 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 10 cost time: 2.265991687774658
Epoch: 10, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.358 Vali Acc: 0.856 Test Loss: 0.358 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.2353713512420654
Epoch: 11, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.344158411026001
Epoch: 12, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3641903400421143
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.106090545654297
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 2.1739296913146973
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.745934247970581
Epoch: 16, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.9890718460083008
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8473920822143555
Epoch: 18, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.044910192489624
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.278 Vali Acc: 0.850 Test Loss: 0.278 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0890135765075684
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.260 Vali Acc: 0.872 Test Loss: 0.260 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.225466728210449
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2534074783325195
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.253 Vali Acc: 0.856 Test Loss: 0.253 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.210399866104126
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0388286113739014
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 2.2499895095825195
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1571407318115234
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.229 Vali Acc: 0.872 Test Loss: 0.229 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0947861671447754
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 2.377645254135132
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.867 Test Loss: 0.271 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2541823387145996
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.318881034851074
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2705814838409424
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.355869770050049
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.1901297569274902
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.2725703716278076
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.316 Vali Acc: 0.894 Test Loss: 0.316 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.3605973720550537
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7483735084533691
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8777148723602295
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1488710
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.056276798248291
Epoch: 1, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.485 Vali Acc: 0.700 Test Loss: 1.485 Test Acc: 0.700
Validation loss decreased (inf --> -0.699985).  Saving model ...
Epoch: 2 cost time: 2.6307432651519775
Epoch: 2, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.792 Vali Acc: 0.733 Test Loss: 0.792 Test Acc: 0.733
Validation loss decreased (-0.699985 --> -0.733325).  Saving model ...
Epoch: 3 cost time: 2.32804274559021
Epoch: 3, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.537 Vali Acc: 0.739 Test Loss: 0.537 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738884).  Saving model ...
Epoch: 4 cost time: 2.517622470855713
Epoch: 4, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.501 Vali Acc: 0.772 Test Loss: 0.501 Test Acc: 0.772
Validation loss decreased (-0.738884 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.417466640472412
Epoch: 5, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.428 Vali Acc: 0.800 Test Loss: 0.428 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.1751458644866943
Epoch: 6, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 2.4845218658447266
Epoch: 7, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866664).  Saving model ...
Epoch: 8 cost time: 2.573685646057129
Epoch: 8, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.676798105239868
Epoch: 9, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.623089551925659
Epoch: 10, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 2.776193141937256
Epoch: 11, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 2.2361295223236084
Epoch: 12, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.247 Vali Acc: 0.872 Test Loss: 0.247 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.122711658477783
Epoch: 13, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 2.226869583129883
Epoch: 14, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.596 Vali Acc: 0.856 Test Loss: 0.596 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3590219020843506
Epoch: 15, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.692 Vali Acc: 0.811 Test Loss: 0.692 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1465091705322266
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.411088228225708
Epoch: 17, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7935962677001953
Epoch: 18, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0484390258789062
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9480443000793457
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6468734741210938
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.598 Vali Acc: 0.861 Test Loss: 0.598 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.381535291671753
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.333599328994751
Epoch: 23, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.297 Vali Acc: 0.894 Test Loss: 0.297 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1669606
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6854681968688965
Epoch: 1, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.663 Vali Acc: 0.578 Test Loss: 1.663 Test Acc: 0.578
Validation loss decreased (inf --> -0.577761).  Saving model ...
Epoch: 2 cost time: 2.2716329097747803
Epoch: 2, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.152 Vali Acc: 0.717 Test Loss: 1.152 Test Acc: 0.717
Validation loss decreased (-0.577761 --> -0.716655).  Saving model ...
Epoch: 3 cost time: 2.341501235961914
Epoch: 3, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.719 Vali Acc: 0.706 Test Loss: 0.719 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9108021259307861
Epoch: 4, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.525 Vali Acc: 0.772 Test Loss: 0.525 Test Acc: 0.772
Validation loss decreased (-0.716655 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 2.2513747215270996
Epoch: 5, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.428 Vali Acc: 0.778 Test Loss: 0.428 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 2.489790201187134
Epoch: 6, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.777773 --> -0.849996).  Saving model ...
Epoch: 7 cost time: 2.512850761413574
Epoch: 7, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4308531284332275
Epoch: 8, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.343 Vali Acc: 0.806 Test Loss: 0.343 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4741902351379395
Epoch: 9, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 2.6836984157562256
Epoch: 10, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.365431308746338
Epoch: 11, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.298 Vali Acc: 0.878 Test Loss: 0.298 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 2.2182259559631348
Epoch: 12, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.246 Vali Acc: 0.861 Test Loss: 0.246 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.424267292022705
Epoch: 13, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.267 Vali Acc: 0.844 Test Loss: 0.267 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4764018058776855
Epoch: 14, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
Validation loss decreased (-0.877775 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 2.595726251602173
Epoch: 15, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.563572406768799
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.256 Vali Acc: 0.861 Test Loss: 0.256 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2448105812072754
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.330 Vali Acc: 0.867 Test Loss: 0.330 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4132847785949707
Epoch: 18, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 2.329511880874634
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 2.559509038925171
Epoch: 20, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8143057823181152
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.265869140625
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.363 Vali Acc: 0.883 Test Loss: 0.363 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2722771167755127
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 2.1183383464813232
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2006757259368896
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.353386402130127
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.332 Vali Acc: 0.883 Test Loss: 0.332 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.663364887237549
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.732356071472168
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933332).  Saving model ...
Epoch: 29 cost time: 2.713106632232666
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5645480155944824
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.5403554439544678
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 32 cost time: 2.7062737941741943
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.4054086208343506
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.928 Test Loss: 0.187 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.383091688156128
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.5843911170959473
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.259460687637329
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.367983341217041
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.560436964035034
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.6901791095733643
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.577440023422241
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.933332 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 2.446763038635254
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.406890869140625
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.397637367248535
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.6042068004608154
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.5928099155426025
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.163018226623535
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.3365797996520996
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.384779214859009
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.8201794624328613
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.6204118728637695
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 1559046
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.99198055267334
Epoch: 1, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.610 Vali Acc: 0.589 Test Loss: 1.610 Test Acc: 0.589
Validation loss decreased (inf --> -0.588873).  Saving model ...
Epoch: 2 cost time: 2.138648509979248
Epoch: 2, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.051 Vali Acc: 0.722 Test Loss: 1.051 Test Acc: 0.722
Validation loss decreased (-0.588873 --> -0.722212).  Saving model ...
Epoch: 3 cost time: 1.9863560199737549
Epoch: 3, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 2.3063225746154785
Epoch: 4, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.508 Vali Acc: 0.744 Test Loss: 0.508 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 2.188260555267334
Epoch: 5, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.440 Vali Acc: 0.806 Test Loss: 0.440 Test Acc: 0.806
Validation loss decreased (-0.744439 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 1.9689631462097168
Epoch: 6, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.439 Vali Acc: 0.794 Test Loss: 0.439 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2917137145996094
Epoch: 7, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.1140737533569336
Epoch: 8, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.3454623222351074
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.571790933609009
Epoch: 10, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883331).  Saving model ...
Epoch: 11 cost time: 2.4332938194274902
Epoch: 11, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.399 Vali Acc: 0.839 Test Loss: 0.399 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.31453537940979
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2800002098083496
Epoch: 13, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2311851978302
Epoch: 14, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.305140733718872
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.3372530937194824
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.535 Vali Acc: 0.817 Test Loss: 0.535 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.309818744659424
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.510645627975464
Epoch: 18, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3770954608917236
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3991661071777344
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 2.5068717002868652
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6240992546081543
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3777265548706055
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 2.2685792446136475
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.894 Test Loss: 0.219 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.050703525543213
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0135316848754883
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 2.224208116531372
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 2.1395010948181152
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.680811643600464
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.6406493186950684
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.644491195678711
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.816016674041748
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.5695836544036865
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.1404740810394287
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.165823221206665
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.307218551635742
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.379694938659668
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1559078
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3206937313079834
Epoch: 1, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.635 Vali Acc: 0.572 Test Loss: 1.635 Test Acc: 0.572
Validation loss decreased (inf --> -0.572206).  Saving model ...
Epoch: 2 cost time: 1.9121568202972412
Epoch: 2, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.176 Vali Acc: 0.678 Test Loss: 1.176 Test Acc: 0.678
Validation loss decreased (-0.572206 --> -0.677766).  Saving model ...
Epoch: 3 cost time: 2.1397557258605957
Epoch: 3, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.759 Vali Acc: 0.744 Test Loss: 0.759 Test Acc: 0.744
Validation loss decreased (-0.677766 --> -0.744437).  Saving model ...
Epoch: 4 cost time: 2.265683650970459
Epoch: 4, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.555 Vali Acc: 0.767 Test Loss: 0.555 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 1.9902868270874023
Epoch: 5, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.458 Vali Acc: 0.811 Test Loss: 0.458 Test Acc: 0.811
Validation loss decreased (-0.766661 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.9275085926055908
Epoch: 6, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.416 Vali Acc: 0.800 Test Loss: 0.416 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9726107120513916
Epoch: 7, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 2.0528054237365723
Epoch: 8, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1400465965270996
Epoch: 9, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.332 Vali Acc: 0.806 Test Loss: 0.332 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1007392406463623
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.310 Vali Acc: 0.867 Test Loss: 0.310 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.1679365634918213
Epoch: 11, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.343 Vali Acc: 0.817 Test Loss: 0.343 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2053911685943604
Epoch: 12, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3401424884796143
Epoch: 13, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3523218631744385
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.394127607345581
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.359 Vali Acc: 0.839 Test Loss: 0.359 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0737314224243164
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 2.0155444145202637
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.832688331604004
Epoch: 18, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.271 Vali Acc: 0.856 Test Loss: 0.271 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8128116130828857
Epoch: 19, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.836426019668579
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8570587635040283
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 1.9512906074523926
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 2.0432631969451904
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.280205488204956
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 2.313647747039795
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 2.3975746631622314
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.208406925201416
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 2.0452253818511963
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1094605922698975
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.009521484375
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1023125648498535
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.2976579666137695
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.4063379764556885
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.286001682281494
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.1290485858917236
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2782909870147705
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.1888911724090576
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1522278
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.562570571899414
Epoch: 1, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.652 Vali Acc: 0.478 Test Loss: 1.652 Test Acc: 0.478
Validation loss decreased (inf --> -0.477761).  Saving model ...
Epoch: 2 cost time: 2.0250847339630127
Epoch: 2, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.249 Vali Acc: 0.650 Test Loss: 1.249 Test Acc: 0.650
Validation loss decreased (-0.477761 --> -0.649988).  Saving model ...
Epoch: 3 cost time: 2.254183053970337
Epoch: 3, Steps: 12 | Train Loss: 0.953 Vali Loss: 0.852 Vali Acc: 0.728 Test Loss: 0.852 Test Acc: 0.728
Validation loss decreased (-0.649988 --> -0.727769).  Saving model ...
Epoch: 4 cost time: 2.2643544673919678
Epoch: 4, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 2.338003158569336
Epoch: 5, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 6 cost time: 2.2029459476470947
Epoch: 6, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 2.1343834400177
Epoch: 7, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 2.1994574069976807
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 1.9886927604675293
Epoch: 9, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 10 cost time: 2.1398918628692627
Epoch: 10, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 2.070561647415161
Epoch: 11, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1173012256622314
Epoch: 12, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.297 Vali Acc: 0.844 Test Loss: 0.297 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.013439416885376
Epoch: 13, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0074188709259033
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.315 Vali Acc: 0.833 Test Loss: 0.315 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0769832134246826
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 2.1176130771636963
Epoch: 16, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.303 Vali Acc: 0.856 Test Loss: 0.303 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.201408624649048
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.237 Vali Acc: 0.878 Test Loss: 0.237 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.9002320766448975
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.2198288440704346
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.293 Vali Acc: 0.844 Test Loss: 0.293 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2063865661621094
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.240 Vali Acc: 0.883 Test Loss: 0.240 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1051032543182373
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 22 cost time: 2.1199839115142822
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.057368040084839
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.223 Vali Acc: 0.894 Test Loss: 0.223 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0673325061798096
Epoch: 24, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.017524003982544
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4004104137420654
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.212 Vali Acc: 0.900 Test Loss: 0.212 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 27 cost time: 2.3548333644866943
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 2.332974433898926
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3180806636810303
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 2.1696362495422363
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.906 Test Loss: 0.190 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.16599178314209
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 2.0802249908447266
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.982846975326538
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 1.813636064529419
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.922 Test Loss: 0.158 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922221).  Saving model ...
Epoch: 35 cost time: 1.8876841068267822
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
Validation loss decreased (-0.922221 --> -0.927776).  Saving model ...
Epoch: 36 cost time: 1.7403678894042969
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.16033673286438
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.2382540702819824
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.192824602127075
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 2.347795009613037
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.196467161178589
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.1293768882751465
Epoch: 42, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9756414890289307
Epoch: 43, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.086758852005005
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.164491891860962
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.325 Vali Acc: 0.906 Test Loss: 0.325 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.016735315322876
Epoch: 46, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.046639919281006
Epoch: 47, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.0396668910980225
Epoch: 48, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.281440258026123
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1485478
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.693513870239258
Epoch: 1, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.706 Vali Acc: 0.494 Test Loss: 1.706 Test Acc: 0.494
Validation loss decreased (inf --> -0.494427).  Saving model ...
Epoch: 2 cost time: 1.8863089084625244
Epoch: 2, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.394 Vali Acc: 0.644 Test Loss: 1.394 Test Acc: 0.644
Validation loss decreased (-0.494427 --> -0.644431).  Saving model ...
Epoch: 3 cost time: 1.3118197917938232
Epoch: 3, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.015 Vali Acc: 0.689 Test Loss: 1.015 Test Acc: 0.689
Validation loss decreased (-0.644431 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 2.1041955947875977
Epoch: 4, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.735 Vali Acc: 0.728 Test Loss: 0.735 Test Acc: 0.728
Validation loss decreased (-0.688879 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 2.1963534355163574
Epoch: 5, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.589 Vali Acc: 0.767 Test Loss: 0.589 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 2.0143983364105225
Epoch: 6, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.506 Vali Acc: 0.778 Test Loss: 0.506 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 2.293802499771118
Epoch: 7, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.457 Vali Acc: 0.789 Test Loss: 0.457 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 2.274765729904175
Epoch: 8, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.426 Vali Acc: 0.806 Test Loss: 0.426 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 9 cost time: 2.3291194438934326
Epoch: 9, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 2.2874503135681152
Epoch: 10, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 2.3998568058013916
Epoch: 11, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.334031581878662
Epoch: 12, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 2.247082233428955
Epoch: 13, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.310 Vali Acc: 0.828 Test Loss: 0.310 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.121492624282837
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0215210914611816
Epoch: 15, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1948294639587402
Epoch: 16, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.292 Vali Acc: 0.839 Test Loss: 0.292 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9963223934173584
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.276 Vali Acc: 0.856 Test Loss: 0.276 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 18 cost time: 1.9951272010803223
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872220).  Saving model ...
Epoch: 19 cost time: 2.05523943901062
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.266 Vali Acc: 0.872 Test Loss: 0.266 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9548838138580322
Epoch: 20, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.246 Vali Acc: 0.856 Test Loss: 0.246 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6045551300048828
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 2.295305013656616
Epoch: 22, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3368923664093018
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.230 Vali Acc: 0.894 Test Loss: 0.230 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 2.2772228717803955
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.035820245742798
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.889 Test Loss: 0.215 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3005542755126953
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.2599518299102783
Epoch: 27, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.894 Test Loss: 0.199 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3397011756896973
Epoch: 28, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.906 Test Loss: 0.212 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3531887531280518
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.215 Vali Acc: 0.894 Test Loss: 0.215 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.5539586544036865
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.5472137928009033
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.4583334922790527
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.3572981357574463
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.399203062057495
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.5462756156921387
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9897282123565674
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 37 cost time: 1.9550278186798096
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8393754959106445
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9322504997253418
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.0551981925964355
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.474848747253418
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.608703136444092
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 2.4870903491973877
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.572540283203125
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.5771050453186035
Epoch: 45, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.4163880348205566
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.316988229751587
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.282930374145508
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.0925543308258057
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.8462841510772705
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1467142
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.840301513671875
Epoch: 1, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.733 Vali Acc: 0.367 Test Loss: 1.733 Test Acc: 0.367
Validation loss decreased (inf --> -0.366649).  Saving model ...
Epoch: 2 cost time: 2.3564913272857666
Epoch: 2, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.450 Vali Acc: 0.678 Test Loss: 1.450 Test Acc: 0.678
Validation loss decreased (-0.366649 --> -0.677763).  Saving model ...
Epoch: 3 cost time: 2.25632381439209
Epoch: 3, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.082 Vali Acc: 0.717 Test Loss: 1.082 Test Acc: 0.717
Validation loss decreased (-0.677763 --> -0.716656).  Saving model ...
Epoch: 4 cost time: 2.0108225345611572
Epoch: 4, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.800 Vali Acc: 0.728 Test Loss: 0.800 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 2.1493756771087646
Epoch: 5, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.640 Vali Acc: 0.739 Test Loss: 0.640 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 2.1828227043151855
Epoch: 6, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.546 Vali Acc: 0.750 Test Loss: 0.546 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 2.115485429763794
Epoch: 7, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.485 Vali Acc: 0.761 Test Loss: 0.485 Test Acc: 0.761
Validation loss decreased (-0.749995 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 2.212622880935669
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.431 Vali Acc: 0.794 Test Loss: 0.431 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 2.1156184673309326
Epoch: 9, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.390 Vali Acc: 0.806 Test Loss: 0.390 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 10 cost time: 2.252514362335205
Epoch: 10, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 2.0312390327453613
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 1.989330530166626
Epoch: 12, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0950663089752197
Epoch: 13, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2069506645202637
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5111236572265625
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.282 Vali Acc: 0.867 Test Loss: 0.282 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4919967651367188
Epoch: 16, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 2.3751108646392822
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.235 Vali Acc: 0.883 Test Loss: 0.235 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 2.3534724712371826
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.198824644088745
Epoch: 19, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.240 Vali Acc: 0.883 Test Loss: 0.240 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.905390977859497
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 21 cost time: 1.8800551891326904
Epoch: 21, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.250 Vali Acc: 0.861 Test Loss: 0.250 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8174242973327637
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.939819574356079
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1970720291137695
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.421027898788452
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.894 Test Loss: 0.224 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3816487789154053
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.232 Vali Acc: 0.878 Test Loss: 0.232 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.378962993621826
Epoch: 27, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.312910556793213
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 29 cost time: 2.3327245712280273
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1822118759155273
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.023656129837036
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.203 Vali Acc: 0.900 Test Loss: 0.203 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.928203821182251
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 2.1633574962615967
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0244576930999756
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.312062978744507
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 36 cost time: 2.3850910663604736
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 37 cost time: 2.3284177780151367
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 2.2849037647247314
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.1385159492492676
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.960057258605957
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8673138618469238
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9975636005401611
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.2003180980682373
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9964771270751953
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.1933109760284424
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.059329032897949
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.332834005355835
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1467206
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.378490447998047
Epoch: 1, Steps: 12 | Train Loss: 1.329 Vali Loss: 0.747 Vali Acc: 0.733 Test Loss: 0.747 Test Acc: 0.733
Validation loss decreased (inf --> -0.733326).  Saving model ...
Epoch: 2 cost time: 3.041935682296753
Epoch: 2, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.577 Vali Acc: 0.756 Test Loss: 0.577 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755550).  Saving model ...
Epoch: 3 cost time: 2.9881668090820312
Epoch: 3, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.879 Vali Acc: 0.756 Test Loss: 0.879 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3459484577178955
Epoch: 4, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.420 Vali Acc: 0.811 Test Loss: 0.420 Test Acc: 0.811
Validation loss decreased (-0.755550 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 3.123474597930908
Epoch: 5, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.464 Vali Acc: 0.806 Test Loss: 0.464 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9090232849121094
Epoch: 6, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 3.0710043907165527
Epoch: 7, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.482 Vali Acc: 0.828 Test Loss: 0.482 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1458654403686523
Epoch: 8, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.543 Vali Acc: 0.817 Test Loss: 0.543 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3519811630249023
Epoch: 9, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.713 Vali Acc: 0.833 Test Loss: 0.713 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4421820640563965
Epoch: 10, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.343 Vali Acc: 0.867 Test Loss: 0.343 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866663).  Saving model ...
Epoch: 11 cost time: 3.3822975158691406
Epoch: 11, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.035 Vali Acc: 0.828 Test Loss: 1.035 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2749242782592773
Epoch: 12, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3616185188293457
Epoch: 13, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.539 Vali Acc: 0.817 Test Loss: 0.539 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.082210063934326
Epoch: 14, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1120729446411133
Epoch: 15, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.309 Vali Acc: 0.872 Test Loss: 0.309 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 3.2507050037384033
Epoch: 16, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 3.575514554977417
Epoch: 17, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.150451183319092
Epoch: 18, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 3.2602124214172363
Epoch: 19, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.889 Test Loss: 0.614 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1621413230895996
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.867435932159424
Epoch: 21, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.146389961242676
Epoch: 22, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 2.744899034500122
Epoch: 23, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 2.832509756088257
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.894 Test Loss: 0.448 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.289915084838867
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.324080467224121
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.894 Test Loss: 0.416 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.430628538131714
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2046868801116943
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 3.1204049587249756
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2732555866241455
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.3843283653259277
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 3.5529367923736572
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.505469799041748
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 3.3635833263397217
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.068392038345337
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.9529101848602295
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.042185068130493
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.4117441177368164
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.314227342605591
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.3591976165771484
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.4297521114349365
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.370241641998291
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.4425625801086426
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 3.314473867416382
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 3.443357467651367
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 3.2233076095581055
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.367891788482666
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 3.113325834274292
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.163059711456299
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.260166645050049
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 5640070
model size : 21.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.515097141265869
Epoch: 1, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.018 Vali Acc: 0.717 Test Loss: 1.018 Test Acc: 0.717
Validation loss decreased (inf --> -0.716656).  Saving model ...
Epoch: 2 cost time: 2.8787193298339844
Epoch: 2, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.531 Vali Acc: 0.772 Test Loss: 0.531 Test Acc: 0.772
Validation loss decreased (-0.716656 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 2.830352544784546
Epoch: 3, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 2.7975895404815674
Epoch: 4, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 2.9041659832000732
Epoch: 5, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.347 Vali Acc: 0.806 Test Loss: 0.347 Test Acc: 0.806
Validation loss decreased (-0.805552 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 2.924065589904785
Epoch: 6, Steps: 12 | Train Loss: 0.446 Vali Loss: 1.030 Vali Acc: 0.767 Test Loss: 1.030 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6400868892669678
Epoch: 7, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 2.71785306930542
Epoch: 8, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.699065685272217
Epoch: 9, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.723222255706787
Epoch: 10, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 2.5877327919006348
Epoch: 11, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.397 Vali Acc: 0.828 Test Loss: 0.397 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8608555793762207
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 2.8883705139160156
Epoch: 13, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 2.949187994003296
Epoch: 14, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.874847173690796
Epoch: 15, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9200830459594727
Epoch: 16, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 17 cost time: 3.0556304454803467
Epoch: 17, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.873335123062134
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.499 Vali Acc: 0.878 Test Loss: 0.499 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8054561614990234
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8058106899261475
Epoch: 20, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8631045818328857
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 2.7844860553741455
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8136649131774902
Epoch: 23, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.507 Vali Acc: 0.906 Test Loss: 0.507 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.673792600631714
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.906 Test Loss: 0.433 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5695390701293945
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5059356689453125
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.419 Vali Acc: 0.883 Test Loss: 0.419 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.8148608207702637
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.744818925857544
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.712 Vali Acc: 0.878 Test Loss: 0.712 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.9009616374969482
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.878 Test Loss: 0.479 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.8435027599334717
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.872 Test Loss: 0.433 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.8964695930480957
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 5160966
model size : 19.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.38251256942749
Epoch: 1, Steps: 12 | Train Loss: 1.414 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
Validation loss decreased (inf --> -0.733324).  Saving model ...
Epoch: 2 cost time: 2.530564308166504
Epoch: 2, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
Validation loss decreased (-0.733324 --> -0.788884).  Saving model ...
Epoch: 3 cost time: 2.8126680850982666
Epoch: 3, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.384 Vali Acc: 0.806 Test Loss: 0.384 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805552).  Saving model ...
Epoch: 4 cost time: 2.874812364578247
Epoch: 4, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.410 Vali Acc: 0.794 Test Loss: 0.410 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7537851333618164
Epoch: 5, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
Validation loss decreased (-0.805552 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 2.9856173992156982
Epoch: 6, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.468 Vali Acc: 0.839 Test Loss: 0.468 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838884).  Saving model ...
Epoch: 7 cost time: 2.739314556121826
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.299 Vali Acc: 0.839 Test Loss: 0.299 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838886).  Saving model ...
Epoch: 8 cost time: 2.727719783782959
Epoch: 8, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844439).  Saving model ...
Epoch: 9 cost time: 2.735933303833008
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.405 Vali Acc: 0.872 Test Loss: 0.405 Test Acc: 0.872
Validation loss decreased (-0.844439 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 2.7748098373413086
Epoch: 10, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9474809169769287
Epoch: 11, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877773).  Saving model ...
Epoch: 12 cost time: 2.844412326812744
Epoch: 12, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.466 Vali Acc: 0.844 Test Loss: 0.466 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6539359092712402
Epoch: 13, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.72141695022583
Epoch: 14, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.548 Vali Acc: 0.889 Test Loss: 0.548 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 2.9552090167999268
Epoch: 15, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.754289150238037
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7643277645111084
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 2.8493258953094482
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.846208095550537
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.640 Vali Acc: 0.889 Test Loss: 0.640 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.810098171234131
Epoch: 20, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.836418390274048
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.606 Vali Acc: 0.906 Test Loss: 0.606 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8315415382385254
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9959843158721924
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.9689483642578125
Epoch: 24, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.9984383583068848
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.96699857711792
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.911 Test Loss: 0.415 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9659583568573
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922218).  Saving model ...
Epoch: 28 cost time: 2.7848074436187744
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.734506845474243
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.906 Test Loss: 0.400 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.665036201477051
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.7087347507476807
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.690582513809204
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.9743237495422363
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.910940647125244
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.911940097808838
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.9261722564697266
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.911 Test Loss: 0.364 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.7524242401123047
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.911 Test Loss: 0.367 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 5161094
model size : 19.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.039802074432373
Epoch: 1, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.203 Vali Acc: 0.717 Test Loss: 1.203 Test Acc: 0.717
Validation loss decreased (inf --> -0.716655).  Saving model ...
Epoch: 2 cost time: 2.7861132621765137
Epoch: 2, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.589 Vali Acc: 0.739 Test Loss: 0.589 Test Acc: 0.739
Validation loss decreased (-0.716655 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 2.8892922401428223
Epoch: 3, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.437 Vali Acc: 0.767 Test Loss: 0.437 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 2.6202175617218018
Epoch: 4, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.350 Vali Acc: 0.806 Test Loss: 0.350 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805552).  Saving model ...
Epoch: 5 cost time: 2.588376760482788
Epoch: 5, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.298 Vali Acc: 0.817 Test Loss: 0.298 Test Acc: 0.817
Validation loss decreased (-0.805552 --> -0.816664).  Saving model ...
Epoch: 6 cost time: 2.6778554916381836
Epoch: 6, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.816664 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 2.7927653789520264
Epoch: 7, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.318 Vali Acc: 0.822 Test Loss: 0.318 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8654303550720215
Epoch: 8, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.279 Vali Acc: 0.850 Test Loss: 0.279 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 2.801384925842285
Epoch: 9, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 2.7614855766296387
Epoch: 10, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6757750511169434
Epoch: 11, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.837355852127075
Epoch: 12, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8926429748535156
Epoch: 13, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7907519340515137
Epoch: 14, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 2.8431155681610107
Epoch: 15, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8624520301818848
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.838000774383545
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6328482627868652
Epoch: 18, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.304227113723755
Epoch: 19, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.399 Vali Acc: 0.883 Test Loss: 0.399 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5507466793060303
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.946472644805908
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.452 Vali Acc: 0.856 Test Loss: 0.452 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.908220052719116
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.848 Vali Acc: 0.817 Test Loss: 0.848 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8431284427642822
Epoch: 23, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.865 Vali Acc: 0.839 Test Loss: 0.865 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.833228826522827
Epoch: 24, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.877 Vali Acc: 0.867 Test Loss: 0.877 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 5013894
model size : 19.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9485907554626465
Epoch: 1, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.291 Vali Acc: 0.650 Test Loss: 1.291 Test Acc: 0.650
Validation loss decreased (inf --> -0.649987).  Saving model ...
Epoch: 2 cost time: 2.5737619400024414
Epoch: 2, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.661 Vali Acc: 0.700 Test Loss: 0.661 Test Acc: 0.700
Validation loss decreased (-0.649987 --> -0.699993).  Saving model ...
Epoch: 3 cost time: 2.4551548957824707
Epoch: 3, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.478 Vali Acc: 0.756 Test Loss: 0.478 Test Acc: 0.756
Validation loss decreased (-0.699993 --> -0.755551).  Saving model ...
Epoch: 4 cost time: 2.3816721439361572
Epoch: 4, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.392 Vali Acc: 0.794 Test Loss: 0.392 Test Acc: 0.794
Validation loss decreased (-0.755551 --> -0.794441).  Saving model ...
Epoch: 5 cost time: 1.9871106147766113
Epoch: 5, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.794441 --> -0.838886).  Saving model ...
Epoch: 6 cost time: 2.234226703643799
Epoch: 6, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 2.350412130355835
Epoch: 7, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.392 Vali Acc: 0.839 Test Loss: 0.392 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5498204231262207
Epoch: 8, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5518670082092285
Epoch: 9, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 2.499401807785034
Epoch: 10, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.373 Vali Acc: 0.872 Test Loss: 0.373 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5884811878204346
Epoch: 11, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5636844635009766
Epoch: 12, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.524214267730713
Epoch: 13, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 2.576549530029297
Epoch: 14, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.432 Vali Acc: 0.878 Test Loss: 0.432 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5216891765594482
Epoch: 15, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.365 Vali Acc: 0.872 Test Loss: 0.365 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5985589027404785
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.568105459213257
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 2.584047794342041
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.661559581756592
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.510251522064209
Epoch: 20, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 2.37076735496521
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 2.2803680896759033
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.41371750831604
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.509080171585083
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 2.594867706298828
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.673391103744507
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6937832832336426
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 2.614692449569702
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 2.640164852142334
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.939 Test Loss: 0.250 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938886).  Saving model ...
Epoch: 30 cost time: 2.492757797241211
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.491 Vali Acc: 0.911 Test Loss: 0.491 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.551184892654419
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.55240797996521
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.6451830863952637
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.7572267055511475
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.6163032054901123
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.5375897884368896
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.50419020652771
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.928 Test Loss: 0.257 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.4999048709869385
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.591909646987915
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 4903558
model size : 18.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9230995178222656
Epoch: 1, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.428 Vali Acc: 0.639 Test Loss: 1.428 Test Acc: 0.639
Validation loss decreased (inf --> -0.638875).  Saving model ...
Epoch: 2 cost time: 2.4729275703430176
Epoch: 2, Steps: 12 | Train Loss: 0.970 Vali Loss: 0.791 Vali Acc: 0.739 Test Loss: 0.791 Test Acc: 0.739
Validation loss decreased (-0.638875 --> -0.738881).  Saving model ...
Epoch: 3 cost time: 2.719871759414673
Epoch: 3, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.540 Vali Acc: 0.722 Test Loss: 0.540 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.716574192047119
Epoch: 4, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.412 Vali Acc: 0.811 Test Loss: 0.412 Test Acc: 0.811
Validation loss decreased (-0.738881 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 2.5283052921295166
Epoch: 5, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.366 Vali Acc: 0.800 Test Loss: 0.366 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7052149772644043
Epoch: 6, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.340 Vali Acc: 0.811 Test Loss: 0.340 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811108).  Saving model ...
Epoch: 7 cost time: 2.616379976272583
Epoch: 7, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
Validation loss decreased (-0.811108 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 2.29594087600708
Epoch: 8, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.288 Vali Acc: 0.844 Test Loss: 0.288 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3941688537597656
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.300 Vali Acc: 0.822 Test Loss: 0.300 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4786829948425293
Epoch: 10, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 2.4461591243743896
Epoch: 11, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.531944990158081
Epoch: 12, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.866664 --> -0.905553).  Saving model ...
Epoch: 13 cost time: 2.5120623111724854
Epoch: 13, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.487377166748047
Epoch: 14, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.228 Vali Acc: 0.878 Test Loss: 0.228 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5820460319519043
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.505913019180298
Epoch: 16, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.333 Vali Acc: 0.894 Test Loss: 0.333 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6206109523773193
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.519946336746216
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5311777591705322
Epoch: 19, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.576617479324341
Epoch: 20, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4205026626586914
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4501209259033203
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 2.27876877784729
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.354727029800415
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2911386489868164
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.377230644226074
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5489423274993896
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 2.658588171005249
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5234854221343994
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.475586414337158
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.4395558834075928
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.523205518722534
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.44144344329834
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.374751091003418
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.5073249340057373
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.5057625770568848
Epoch: 36, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.431 Vali Acc: 0.883 Test Loss: 0.431 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.459930658340454
Epoch: 37, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 4830214
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8801748752593994
Epoch: 1, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.429 Vali Acc: 0.694 Test Loss: 1.429 Test Acc: 0.694
Validation loss decreased (inf --> -0.694430).  Saving model ...
Epoch: 2 cost time: 2.469257116317749
Epoch: 2, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
Validation loss decreased (-0.694430 --> -0.749992).  Saving model ...
Epoch: 3 cost time: 2.535679817199707
Epoch: 3, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.540 Vali Acc: 0.744 Test Loss: 0.540 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5354316234588623
Epoch: 4, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.410 Vali Acc: 0.822 Test Loss: 0.410 Test Acc: 0.822
Validation loss decreased (-0.749992 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 2.5116307735443115
Epoch: 5, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 2.3422865867614746
Epoch: 6, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.318 Vali Acc: 0.833 Test Loss: 0.318 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4396910667419434
Epoch: 7, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.356 Vali Acc: 0.828 Test Loss: 0.356 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.417635202407837
Epoch: 8, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.286062002182007
Epoch: 9, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.3412442207336426
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 2.4000275135040283
Epoch: 11, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 2.5415217876434326
Epoch: 12, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2603437900543213
Epoch: 13, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.371 Vali Acc: 0.872 Test Loss: 0.371 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1785593032836914
Epoch: 14, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 2.2166881561279297
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.227754592895508
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4893229007720947
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4941725730895996
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4674232006073
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.224 Vali Acc: 0.900 Test Loss: 0.224 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.526507616043091
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.906 Test Loss: 0.199 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.475757360458374
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.237 Vali Acc: 0.894 Test Loss: 0.237 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3943517208099365
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3589463233947754
Epoch: 23, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.928 Test Loss: 0.234 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 2.4743404388427734
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5484914779663086
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.407747745513916
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 2.417809009552002
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.123053550720215
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2487168312072754
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1978533267974854
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.287759780883789
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.498662233352661
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.509251594543457
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.489 Vali Acc: 0.906 Test Loss: 0.489 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.577789306640625
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.624159336090088
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.382 Vali Acc: 0.883 Test Loss: 0.382 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.5102951526641846
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.487 Vali Acc: 0.883 Test Loss: 0.487 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 4830470
model size : 18.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7114310264587402
Epoch: 1, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.079 Vali Acc: 0.667 Test Loss: 1.079 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 2.3385419845581055
Epoch: 2, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.637 Vali Acc: 0.678 Test Loss: 0.637 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677771).  Saving model ...
Epoch: 3 cost time: 2.361044406890869
Epoch: 3, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.557 Vali Acc: 0.733 Test Loss: 0.557 Test Acc: 0.733
Validation loss decreased (-0.677771 --> -0.733328).  Saving model ...
Epoch: 4 cost time: 2.043714761734009
Epoch: 4, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.434 Vali Acc: 0.806 Test Loss: 0.434 Test Acc: 0.806
Validation loss decreased (-0.733328 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.9774980545043945
Epoch: 5, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.139723300933838
Epoch: 6, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 2.210660457611084
Epoch: 7, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4301774501800537
Epoch: 8, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.490769386291504
Epoch: 9, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.250 Vali Acc: 0.900 Test Loss: 0.250 Test Acc: 0.900
Validation loss decreased (-0.838886 --> -0.899997).  Saving model ...
Epoch: 10 cost time: 2.3641514778137207
Epoch: 10, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4581351280212402
Epoch: 11, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.491 Vali Acc: 0.883 Test Loss: 0.491 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1216580867767334
Epoch: 12, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 2.229020595550537
Epoch: 13, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.243849754333496
Epoch: 14, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3112030029296875
Epoch: 15, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.468 Vali Acc: 0.883 Test Loss: 0.468 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.385335922241211
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.366 Vali Acc: 0.906 Test Loss: 0.366 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5122032165527344
Epoch: 17, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.454969644546509
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.447239637374878
Epoch: 19, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.41330623626709
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.200622320175171
Epoch: 21, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 2.200176477432251
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.883 Test Loss: 0.508 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0560808181762695
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.906 Test Loss: 0.286 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.012981414794922
Epoch: 24, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.304269313812256
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3310155868530273
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3463447093963623
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2482025623321533
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4982728958129883
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 2.2878434658050537
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2521073818206787
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.906 Test Loss: 0.324 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.217724084854126
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2121167182922363
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.249321699142456
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.3489389419555664
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 36 cost time: 2.216630220413208
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0466110706329346
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.083284854888916
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 1.9469003677368164
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.170830488204956
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.067049264907837
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.1997034549713135
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.928 Test Loss: 0.276 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.3179259300231934
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.928 Test Loss: 0.289 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.4074547290802
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.928 Test Loss: 0.275 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.4977874755859375
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.2986786365509033
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.148768901824951
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 1.9372563362121582
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.2213733196258545
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.928 Test Loss: 0.293 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.25740122795105
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1820614
model size : 7.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8842062950134277
Epoch: 1, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.269 Vali Acc: 0.706 Test Loss: 1.269 Test Acc: 0.706
Validation loss decreased (inf --> -0.705543).  Saving model ...
Epoch: 2 cost time: 1.7852039337158203
Epoch: 2, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.638 Vali Acc: 0.733 Test Loss: 0.638 Test Acc: 0.733
Validation loss decreased (-0.705543 --> -0.733327).  Saving model ...
Epoch: 3 cost time: 1.5981636047363281
Epoch: 3, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.440 Vali Acc: 0.783 Test Loss: 0.440 Test Acc: 0.783
Validation loss decreased (-0.733327 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 1.5799012184143066
Epoch: 4, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 1.7404260635375977
Epoch: 5, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.8696229457855225
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8900485038757324
Epoch: 7, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 1.8930385112762451
Epoch: 8, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.344 Vali Acc: 0.883 Test Loss: 0.344 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 9 cost time: 1.9760193824768066
Epoch: 9, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8918712139129639
Epoch: 10, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.278 Vali Acc: 0.872 Test Loss: 0.278 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0194456577301025
Epoch: 11, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.254 Vali Acc: 0.878 Test Loss: 0.254 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8671770095825195
Epoch: 12, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8789808750152588
Epoch: 13, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.8504104614257812
Epoch: 14, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.900954008102417
Epoch: 15, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 1.8142991065979004
Epoch: 16, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9162547588348389
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.459 Vali Acc: 0.894 Test Loss: 0.459 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9022941589355469
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 1.728576421737671
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 1.7132604122161865
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6091439723968506
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6912879943847656
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.840484380722046
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8882677555084229
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.400 Vali Acc: 0.894 Test Loss: 0.400 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9787993431091309
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0068399906158447
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0804834365844727
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9839448928833008
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 1.9882268905639648
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.895246982574463
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 1.9211068153381348
Epoch: 31, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9311320781707764
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8883295059204102
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8507721424102783
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.0964365005493164
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.824662685394287
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8437111377716064
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7995240688323975
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8588411808013916
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6969668865203857
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1581062
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1550235748291016
Epoch: 1, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.286 Vali Acc: 0.700 Test Loss: 1.286 Test Acc: 0.700
Validation loss decreased (inf --> -0.699987).  Saving model ...
Epoch: 2 cost time: 2.037748336791992
Epoch: 2, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.651 Vali Acc: 0.772 Test Loss: 0.651 Test Acc: 0.772
Validation loss decreased (-0.699987 --> -0.772216).  Saving model ...
Epoch: 3 cost time: 2.056044101715088
Epoch: 3, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.482 Vali Acc: 0.750 Test Loss: 0.482 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0707828998565674
Epoch: 4, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
Validation loss decreased (-0.772216 --> -0.811107).  Saving model ...
Epoch: 5 cost time: 1.8760650157928467
Epoch: 5, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 1.894979476928711
Epoch: 6, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.287 Vali Acc: 0.839 Test Loss: 0.287 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 1.8300752639770508
Epoch: 7, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.423 Vali Acc: 0.817 Test Loss: 0.423 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8161883354187012
Epoch: 8, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.280 Vali Acc: 0.844 Test Loss: 0.280 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844442).  Saving model ...
Epoch: 9 cost time: 1.3991191387176514
Epoch: 9, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
Validation loss decreased (-0.844442 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 1.8126416206359863
Epoch: 10, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 1.8952131271362305
Epoch: 11, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8284900188446045
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8753397464752197
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 14 cost time: 1.9536948204040527
Epoch: 14, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8949296474456787
Epoch: 15, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8084990978240967
Epoch: 16, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.060135841369629
Epoch: 17, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.003000497817993
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2062618732452393
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0782458782196045
Epoch: 20, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.474 Vali Acc: 0.878 Test Loss: 0.474 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0504186153411865
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 2.007321357727051
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 1.9041287899017334
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9628965854644775
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8610436916351318
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9487321376800537
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.886542558670044
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9645402431488037
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9053964614868164
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.857043743133545
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9724335670471191
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8815982341766357
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1581126
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0985171794891357
Epoch: 1, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.427 Vali Acc: 0.644 Test Loss: 1.427 Test Acc: 0.644
Validation loss decreased (inf --> -0.644430).  Saving model ...
Epoch: 2 cost time: 2.082113265991211
Epoch: 2, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.812 Vali Acc: 0.722 Test Loss: 0.812 Test Acc: 0.722
Validation loss decreased (-0.644430 --> -0.722214).  Saving model ...
Epoch: 3 cost time: 2.1286492347717285
Epoch: 3, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.551 Vali Acc: 0.739 Test Loss: 0.551 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738883).  Saving model ...
Epoch: 4 cost time: 2.2069220542907715
Epoch: 4, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.427 Vali Acc: 0.778 Test Loss: 0.427 Test Acc: 0.778
Validation loss decreased (-0.738883 --> -0.777774).  Saving model ...
Epoch: 5 cost time: 2.230086326599121
Epoch: 5, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
Validation loss decreased (-0.777774 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 2.1483123302459717
Epoch: 6, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.417 Vali Acc: 0.822 Test Loss: 0.417 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.025797128677368
Epoch: 7, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.468 Vali Acc: 0.806 Test Loss: 0.468 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0087125301361084
Epoch: 8, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.392 Vali Acc: 0.828 Test Loss: 0.392 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.053196907043457
Epoch: 9, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0229151248931885
Epoch: 10, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 1.77480149269104
Epoch: 11, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8426389694213867
Epoch: 12, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.767019510269165
Epoch: 13, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.324 Vali Acc: 0.883 Test Loss: 0.324 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.833099365234375
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.429 Vali Acc: 0.856 Test Loss: 0.429 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.85982346534729
Epoch: 15, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 1.8733537197113037
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2027220726013184
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.185265302658081
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2298521995544434
Epoch: 19, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 2.157827854156494
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.287 Vali Acc: 0.883 Test Loss: 0.287 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.030268430709839
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 2.0472676753997803
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9470319747924805
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 1.947228193283081
Epoch: 24, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.175654411315918
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.146120071411133
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.2468574047088623
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1108062267303467
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.886728286743164
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.922147512435913
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9026591777801514
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8366680145263672
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.142007827758789
Epoch: 33, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1507526
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2346346378326416
Epoch: 1, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.525 Vali Acc: 0.594 Test Loss: 1.525 Test Acc: 0.594
Validation loss decreased (inf --> -0.594429).  Saving model ...
Epoch: 2 cost time: 1.6896812915802002
Epoch: 2, Steps: 12 | Train Loss: 1.119 Vali Loss: 0.928 Vali Acc: 0.706 Test Loss: 0.928 Test Acc: 0.706
Validation loss decreased (-0.594429 --> -0.705546).  Saving model ...
Epoch: 3 cost time: 1.6948256492614746
Epoch: 3, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
Validation loss decreased (-0.705546 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 1.637373924255371
Epoch: 4, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.462 Vali Acc: 0.772 Test Loss: 0.462 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772218).  Saving model ...
Epoch: 5 cost time: 1.7798864841461182
Epoch: 5, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.377 Vali Acc: 0.817 Test Loss: 0.377 Test Acc: 0.817
Validation loss decreased (-0.772218 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 1.796337604522705
Epoch: 6, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7521882057189941
Epoch: 7, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.8451592922210693
Epoch: 8, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.7506992816925049
Epoch: 9, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4974608421325684
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.269 Vali Acc: 0.850 Test Loss: 0.269 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.4681963920593262
Epoch: 11, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 1.4992420673370361
Epoch: 12, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.355 Vali Acc: 0.878 Test Loss: 0.355 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.5114085674285889
Epoch: 13, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.5516877174377441
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8837873935699463
Epoch: 15, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.280 Vali Acc: 0.856 Test Loss: 0.280 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7320194244384766
Epoch: 16, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 1.7382309436798096
Epoch: 17, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 1.5585250854492188
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7102410793304443
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.250 Vali Acc: 0.878 Test Loss: 0.250 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6482532024383545
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7930397987365723
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6186373233795166
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7454171180725098
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.342 Vali Acc: 0.906 Test Loss: 0.342 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7854552268981934
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7821056842803955
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.80704665184021
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6507313251495361
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.681281566619873
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7560696601867676
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6183414459228516
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5579650402069092
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6064610481262207
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6180667877197266
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 1.602154016494751
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 1.8156540393829346
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6514966487884521
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.763552188873291
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6350107192993164
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 1.6551437377929688
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6857643127441406
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.851902723312378
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.702904462814331
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7511820793151855
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.7520055770874023
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7748644351959229
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.7547128200531006
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.7556915283203125
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 1.740365743637085
Epoch: 48, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.675755262374878
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.7907402515411377
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 1452358
model size : 5.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1220993995666504
Epoch: 1, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.556 Vali Acc: 0.650 Test Loss: 1.556 Test Acc: 0.650
Validation loss decreased (inf --> -0.649984).  Saving model ...
Epoch: 2 cost time: 1.7053005695343018
Epoch: 2, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.065 Vali Acc: 0.722 Test Loss: 1.065 Test Acc: 0.722
Validation loss decreased (-0.649984 --> -0.722212).  Saving model ...
Epoch: 3 cost time: 1.5348138809204102
Epoch: 3, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.693 Vali Acc: 0.717 Test Loss: 0.693 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7613308429718018
Epoch: 4, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.722212 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 1.7981188297271729
Epoch: 5, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 1.9005944728851318
Epoch: 6, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.377 Vali Acc: 0.811 Test Loss: 0.377 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.6862528324127197
Epoch: 7, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
Validation loss decreased (-0.811107 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.7678492069244385
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.6933646202087402
Epoch: 9, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.637535810470581
Epoch: 10, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.6630754470825195
Epoch: 11, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 1.6618010997772217
Epoch: 12, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.258 Vali Acc: 0.867 Test Loss: 0.258 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 1.6867971420288086
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7327635288238525
Epoch: 14, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.299 Vali Acc: 0.883 Test Loss: 0.299 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.7223567962646484
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6029181480407715
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6843538284301758
Epoch: 17, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 18 cost time: 1.6127312183380127
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.4753453731536865
Epoch: 19, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4734587669372559
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.244 Vali Acc: 0.867 Test Loss: 0.244 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6256403923034668
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.656106948852539
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.231 Vali Acc: 0.883 Test Loss: 0.231 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6505558490753174
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6940062046051025
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.894 Test Loss: 0.209 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 1.8043951988220215
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 26 cost time: 1.6385042667388916
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.719264268875122
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6912178993225098
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6722497940063477
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5525808334350586
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6864783763885498
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 1.8118078708648682
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6338348388671875
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6498770713806152
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6122634410858154
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4385020732879639
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5895321369171143
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5723743438720703
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5335252285003662
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.6776008605957031
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.726137638092041
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1415686
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.978766918182373
Epoch: 1, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.573 Vali Acc: 0.567 Test Loss: 1.573 Test Acc: 0.567
Validation loss decreased (inf --> -0.566651).  Saving model ...
Epoch: 2 cost time: 1.575913906097412
Epoch: 2, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.108 Vali Acc: 0.733 Test Loss: 1.108 Test Acc: 0.733
Validation loss decreased (-0.566651 --> -0.733322).  Saving model ...
Epoch: 3 cost time: 1.6064205169677734
Epoch: 3, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.729 Vali Acc: 0.733 Test Loss: 0.729 Test Acc: 0.733
Validation loss decreased (-0.733322 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.7280480861663818
Epoch: 4, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.733326 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 1.7744643688201904
Epoch: 5, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.453 Vali Acc: 0.794 Test Loss: 0.453 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 1.7540473937988281
Epoch: 6, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
Validation loss decreased (-0.794440 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 1.6545178890228271
Epoch: 7, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6761703491210938
Epoch: 8, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.326 Vali Acc: 0.811 Test Loss: 0.326 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.681835651397705
Epoch: 9, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.6573097705841064
Epoch: 10, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 11 cost time: 1.5626652240753174
Epoch: 11, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4040422439575195
Epoch: 12, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3976287841796875
Epoch: 13, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5814812183380127
Epoch: 14, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5509154796600342
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7211389541625977
Epoch: 16, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 1.7312653064727783
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6775856018066406
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6491045951843262
Epoch: 19, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.6125950813293457
Epoch: 20, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.7027993202209473
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6459248065948486
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.7111787796020508
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7589213848114014
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8022830486297607
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.283 Vali Acc: 0.906 Test Loss: 0.283 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.684065580368042
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6584410667419434
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.617567777633667
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6498374938964844
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.435 Vali Acc: 0.878 Test Loss: 0.435 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7851176261901855
Epoch: 30, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 1.479994535446167
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.522195816040039
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.600250244140625
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.601820468902588
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6004843711853027
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.666494607925415
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 1.7778422832489014
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 38 cost time: 1.6275627613067627
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6540515422821045
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 1.7484893798828125
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.7832305431365967
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7336926460266113
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7771315574645996
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.717865228652954
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7094488143920898
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5717518329620361
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.365 Vali Acc: 0.894 Test Loss: 0.365 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.6986207962036133
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.709049940109253
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.720923662185669
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 50 cost time: 1.6992056369781494
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 1415814
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6269748210906982
Epoch: 1, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.347 Vali Acc: 0.672 Test Loss: 1.347 Test Acc: 0.672
Validation loss decreased (inf --> -0.672209).  Saving model ...
Epoch: 2 cost time: 1.4166412353515625
Epoch: 2, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.732 Vali Acc: 0.728 Test Loss: 0.732 Test Acc: 0.728
Validation loss decreased (-0.672209 --> -0.727770).  Saving model ...
Epoch: 3 cost time: 1.5512559413909912
Epoch: 3, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755550).  Saving model ...
Epoch: 4 cost time: 1.4472239017486572
Epoch: 4, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.412 Vali Acc: 0.806 Test Loss: 0.412 Test Acc: 0.806
Validation loss decreased (-0.755550 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.429443359375
Epoch: 5, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.382 Vali Acc: 0.811 Test Loss: 0.382 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.6330573558807373
Epoch: 6, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 1.6740999221801758
Epoch: 7, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 1.7091472148895264
Epoch: 8, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 9 cost time: 1.4995441436767578
Epoch: 9, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.274 Vali Acc: 0.839 Test Loss: 0.274 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6111540794372559
Epoch: 10, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.570838451385498
Epoch: 11, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4217965602874756
Epoch: 12, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 13 cost time: 1.576341152191162
Epoch: 13, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4994680881500244
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4876735210418701
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.219 Vali Acc: 0.894 Test Loss: 0.219 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5657448768615723
Epoch: 16, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6291861534118652
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4329161643981934
Epoch: 18, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4403250217437744
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.387871503829956
Epoch: 20, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 1.3204352855682373
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.3287711143493652
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 1.396960973739624
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.516573190689087
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6588776111602783
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.588453769683838
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.661695957183838
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 1.5767765045166016
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5698587894439697
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4521050453186035
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5730171203613281
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4167580604553223
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.485896348953247
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.894 Test Loss: 0.388 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5557904243469238
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5973639488220215
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.6859710216522217
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6147639751434326
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 660454
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.593290328979492
Epoch: 1, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.508 Vali Acc: 0.683 Test Loss: 1.508 Test Acc: 0.683
Validation loss decreased (inf --> -0.683318).  Saving model ...
Epoch: 2 cost time: 1.230255126953125
Epoch: 2, Steps: 12 | Train Loss: 1.111 Vali Loss: 0.981 Vali Acc: 0.739 Test Loss: 0.981 Test Acc: 0.739
Validation loss decreased (-0.683318 --> -0.738879).  Saving model ...
Epoch: 3 cost time: 1.2289650440216064
Epoch: 3, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.618 Vali Acc: 0.772 Test Loss: 0.618 Test Acc: 0.772
Validation loss decreased (-0.738879 --> -0.772216).  Saving model ...
Epoch: 4 cost time: 1.3812620639801025
Epoch: 4, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799995).  Saving model ...
Epoch: 5 cost time: 1.350074052810669
Epoch: 5, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.394 Vali Acc: 0.811 Test Loss: 0.394 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 1.2276790142059326
Epoch: 6, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 1.2289965152740479
Epoch: 7, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 1.1699566841125488
Epoch: 8, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 1.1250536441802979
Epoch: 9, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1656038761138916
Epoch: 10, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.311 Vali Acc: 0.861 Test Loss: 0.311 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.386228084564209
Epoch: 11, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.286 Vali Acc: 0.850 Test Loss: 0.286 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3498477935791016
Epoch: 12, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.329 Vali Acc: 0.856 Test Loss: 0.329 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2638180255889893
Epoch: 13, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 1.4558429718017578
Epoch: 14, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3644592761993408
Epoch: 15, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3473081588745117
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3810229301452637
Epoch: 17, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4064750671386719
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2784473896026611
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.250 Vali Acc: 0.861 Test Loss: 0.250 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4437017440795898
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4879939556121826
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.4576921463012695
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 1.38535475730896
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4397087097167969
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 1.534494400024414
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 1.4312779903411865
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922219).  Saving model ...
Epoch: 27 cost time: 1.3637914657592773
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 1.2946248054504395
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3511989116668701
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2878258228302002
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.261582612991333
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.381 Vali Acc: 0.894 Test Loss: 0.381 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3089795112609863
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4385852813720703
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.928 Test Loss: 0.203 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 34 cost time: 1.5561614036560059
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.449019432067871
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.36039137840271
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4251093864440918
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4983563423156738
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4324936866760254
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 1.4648873805999756
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4159698486328125
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.44118332862854
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4735262393951416
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.928 Test Loss: 0.226 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4746053218841553
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3385660648345947
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4423565864562988
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.928 Test Loss: 0.232 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.422206163406372
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.4553589820861816
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.340977668762207
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 540678
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9129486083984375
Epoch: 1, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.476 Vali Acc: 0.739 Test Loss: 1.476 Test Acc: 0.739
Validation loss decreased (inf --> -0.738874).  Saving model ...
Epoch: 2 cost time: 1.3986167907714844
Epoch: 2, Steps: 12 | Train Loss: 1.093 Vali Loss: 0.910 Vali Acc: 0.744 Test Loss: 0.910 Test Acc: 0.744
Validation loss decreased (-0.738874 --> -0.744435).  Saving model ...
Epoch: 3 cost time: 1.403961420059204
Epoch: 3, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.605 Vali Acc: 0.767 Test Loss: 0.605 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 1.4239158630371094
Epoch: 4, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.474 Vali Acc: 0.772 Test Loss: 0.474 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 1.459409475326538
Epoch: 5, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.419 Vali Acc: 0.761 Test Loss: 0.419 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4662013053894043
Epoch: 6, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.396 Vali Acc: 0.828 Test Loss: 0.396 Test Acc: 0.828
Validation loss decreased (-0.772217 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.4804797172546387
Epoch: 7, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.350 Vali Acc: 0.794 Test Loss: 0.350 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.450110673904419
Epoch: 8, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.451233148574829
Epoch: 9, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.3892672061920166
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4442548751831055
Epoch: 11, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3258490562438965
Epoch: 12, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.365668773651123
Epoch: 13, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3928463459014893
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.251 Vali Acc: 0.872 Test Loss: 0.251 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4055876731872559
Epoch: 15, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.282 Vali Acc: 0.844 Test Loss: 0.282 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.39681077003479
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5417137145996094
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 1.4163804054260254
Epoch: 18, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.371241569519043
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.325 Vali Acc: 0.867 Test Loss: 0.325 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2836034297943115
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.322746992111206
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
Validation loss decreased (-0.899996 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.2996087074279785
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.508805274963379
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.900 Test Loss: 0.199 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3888375759124756
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 25 cost time: 1.3009347915649414
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.894 Test Loss: 0.226 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4119017124176025
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4672343730926514
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5002758502960205
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.512347936630249
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4962286949157715
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4690613746643066
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5222902297973633
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4745638370513916
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4804635047912598
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 540710
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.707756280899048
Epoch: 1, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.509 Vali Acc: 0.578 Test Loss: 1.509 Test Acc: 0.578
Validation loss decreased (inf --> -0.577763).  Saving model ...
Epoch: 2 cost time: 1.2501194477081299
Epoch: 2, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.028 Vali Acc: 0.678 Test Loss: 1.028 Test Acc: 0.678
Validation loss decreased (-0.577763 --> -0.677767).  Saving model ...
Epoch: 3 cost time: 1.2878406047821045
Epoch: 3, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 1.2679188251495361
Epoch: 4, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.538 Vali Acc: 0.761 Test Loss: 0.538 Test Acc: 0.761
Validation loss decreased (-0.716660 --> -0.761106).  Saving model ...
Epoch: 5 cost time: 1.235633373260498
Epoch: 5, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.450 Vali Acc: 0.778 Test Loss: 0.450 Test Acc: 0.778
Validation loss decreased (-0.761106 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.3499906063079834
Epoch: 6, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.419 Vali Acc: 0.789 Test Loss: 0.419 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 7 cost time: 1.3117916584014893
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.788885 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.4037747383117676
Epoch: 8, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.318 Vali Acc: 0.822 Test Loss: 0.318 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4198153018951416
Epoch: 9, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.4766120910644531
Epoch: 10, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.292 Vali Acc: 0.839 Test Loss: 0.292 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3649625778198242
Epoch: 11, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.285 Vali Acc: 0.856 Test Loss: 0.285 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 12 cost time: 1.3767602443695068
Epoch: 12, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4501943588256836
Epoch: 13, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
Validation loss decreased (-0.855553 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 1.3979032039642334
Epoch: 14, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.297 Vali Acc: 0.850 Test Loss: 0.297 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2848610877990723
Epoch: 15, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 1.3952300548553467
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.262 Vali Acc: 0.861 Test Loss: 0.262 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3460924625396729
Epoch: 17, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.234 Vali Acc: 0.850 Test Loss: 0.234 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3379547595977783
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3963909149169922
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 20 cost time: 1.4190499782562256
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3912324905395508
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.237 Vali Acc: 0.878 Test Loss: 0.237 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3835289478302002
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.210 Vali Acc: 0.878 Test Loss: 0.210 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3434967994689941
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2725205421447754
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 1.2462587356567383
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1874043941497803
Epoch: 26, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2280049324035645
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.261364459991455
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.894 Test Loss: 0.225 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.300602912902832
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 30 cost time: 1.368943214416504
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4382834434509277
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4083964824676514
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 33 cost time: 1.4044163227081299
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4003403186798096
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3711626529693604
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.357863426208496
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.363368272781372
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.307152271270752
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3789539337158203
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3919663429260254
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.425370693206787
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4524815082550049
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 503910
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5593979358673096
Epoch: 1, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.601 Vali Acc: 0.450 Test Loss: 1.601 Test Acc: 0.450
Validation loss decreased (inf --> -0.449984).  Saving model ...
Epoch: 2 cost time: 1.2206618785858154
Epoch: 2, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.201 Vali Acc: 0.600 Test Loss: 1.201 Test Acc: 0.600
Validation loss decreased (-0.449984 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.2531979084014893
Epoch: 3, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.844 Vali Acc: 0.661 Test Loss: 0.844 Test Acc: 0.661
Validation loss decreased (-0.599988 --> -0.661103).  Saving model ...
Epoch: 4 cost time: 1.190788984298706
Epoch: 4, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.634 Vali Acc: 0.728 Test Loss: 0.634 Test Acc: 0.728
Validation loss decreased (-0.661103 --> -0.727771).  Saving model ...
Epoch: 5 cost time: 1.1580753326416016
Epoch: 5, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.517 Vali Acc: 0.778 Test Loss: 0.517 Test Acc: 0.778
Validation loss decreased (-0.727771 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 1.3088228702545166
Epoch: 6, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.448 Vali Acc: 0.806 Test Loss: 0.448 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 1.3864233493804932
Epoch: 7, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.400 Vali Acc: 0.800 Test Loss: 0.400 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3902199268341064
Epoch: 8, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.3486077785491943
Epoch: 9, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.350 Vali Acc: 0.833 Test Loss: 0.350 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.2856311798095703
Epoch: 10, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.3278868198394775
Epoch: 11, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.316 Vali Acc: 0.828 Test Loss: 0.316 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3193678855895996
Epoch: 12, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.2957732677459717
Epoch: 13, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 1.2978427410125732
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.284 Vali Acc: 0.844 Test Loss: 0.284 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3438925743103027
Epoch: 15, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.3753814697265625
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4360268115997314
Epoch: 17, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3845453262329102
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.3834638595581055
Epoch: 19, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.227 Vali Acc: 0.878 Test Loss: 0.227 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3737602233886719
Epoch: 20, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2937870025634766
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3332083225250244
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1430141925811768
Epoch: 23, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1845262050628662
Epoch: 24, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 1.1616685390472412
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 1.2920591831207275
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 1.2912943363189697
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.002274990081787
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.431128978729248
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4378387928009033
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3960890769958496
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.911 Test Loss: 0.207 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3306701183319092
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.922 Test Loss: 0.179 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 1.2739200592041016
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2583074569702148
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.308253288269043
Epoch: 35, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3208510875701904
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 1.4017527103424072
Epoch: 37, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4119596481323242
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.380392074584961
Epoch: 39, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4550247192382812
Epoch: 40, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.5458502769470215
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4145336151123047
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 43 cost time: 1.3766601085662842
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.922 Test Loss: 0.181 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3824050426483154
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.906 Test Loss: 0.207 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3514430522918701
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.116642951965332
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.209949254989624
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2486522197723389
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.356440544128418
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3182439804077148
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 476326
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.550680160522461
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.730 Vali Acc: 0.261 Test Loss: 1.730 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 1.3631994724273682
Epoch: 2, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.423 Vali Acc: 0.611 Test Loss: 1.423 Test Acc: 0.611
Validation loss decreased (-0.261094 --> -0.611097).  Saving model ...
Epoch: 3 cost time: 1.2894670963287354
Epoch: 3, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.079 Vali Acc: 0.683 Test Loss: 1.079 Test Acc: 0.683
Validation loss decreased (-0.611097 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 1.3667001724243164
Epoch: 4, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.812 Vali Acc: 0.694 Test Loss: 0.812 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694436).  Saving model ...
Epoch: 5 cost time: 1.3214836120605469
Epoch: 5, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.653 Vali Acc: 0.706 Test Loss: 0.653 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705549).  Saving model ...
Epoch: 6 cost time: 1.3868300914764404
Epoch: 6, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.554 Vali Acc: 0.756 Test Loss: 0.554 Test Acc: 0.756
Validation loss decreased (-0.705549 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 1.2535364627838135
Epoch: 7, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.488 Vali Acc: 0.744 Test Loss: 0.488 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.298537015914917
Epoch: 8, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.436 Vali Acc: 0.811 Test Loss: 0.436 Test Acc: 0.811
Validation loss decreased (-0.755550 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 1.354457139968872
Epoch: 9, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.296910285949707
Epoch: 10, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.380 Vali Acc: 0.811 Test Loss: 0.380 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.2704966068267822
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 12 cost time: 1.3106019496917725
Epoch: 12, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 1.3514513969421387
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 14 cost time: 1.2987568378448486
Epoch: 14, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 1.2929580211639404
Epoch: 15, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2574803829193115
Epoch: 16, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 17 cost time: 1.3236689567565918
Epoch: 17, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.190864086151123
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 19 cost time: 1.36515212059021
Epoch: 19, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.1939384937286377
Epoch: 20, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3624460697174072
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3725311756134033
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 23 cost time: 1.3021469116210938
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3691506385803223
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4804191589355469
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.334127426147461
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 1.3086206912994385
Epoch: 27, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.265 Vali Acc: 0.878 Test Loss: 0.265 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3151872158050537
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3199832439422607
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.246 Vali Acc: 0.878 Test Loss: 0.246 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3130512237548828
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3626625537872314
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 32 cost time: 1.3506174087524414
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 33 cost time: 1.294569969177246
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.38736891746521
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 35 cost time: 1.1800117492675781
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1560468673706055
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1142752170562744
Epoch: 37, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1389238834381104
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 1.1527395248413086
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 1.314408302307129
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.400484323501587
Epoch: 41, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4290125370025635
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.4457554817199707
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3771770000457764
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3229622840881348
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3301098346710205
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.238530158996582
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3503103256225586
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 1.3411884307861328
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2785682678222656
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 457990
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.541422128677368
Epoch: 1, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.703 Vali Acc: 0.378 Test Loss: 1.703 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 1.3101122379302979
Epoch: 2, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.437 Vali Acc: 0.594 Test Loss: 1.437 Test Acc: 0.594
Validation loss decreased (-0.377761 --> -0.594430).  Saving model ...
Epoch: 3 cost time: 1.3800313472747803
Epoch: 3, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.110 Vali Acc: 0.661 Test Loss: 1.110 Test Acc: 0.661
Validation loss decreased (-0.594430 --> -0.661100).  Saving model ...
Epoch: 4 cost time: 1.2563838958740234
Epoch: 4, Steps: 12 | Train Loss: 0.934 Vali Loss: 0.858 Vali Acc: 0.689 Test Loss: 0.858 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688880).  Saving model ...
Epoch: 5 cost time: 1.2499415874481201
Epoch: 5, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.690 Vali Acc: 0.700 Test Loss: 0.690 Test Acc: 0.700
Validation loss decreased (-0.688880 --> -0.699993).  Saving model ...
Epoch: 6 cost time: 1.2665793895721436
Epoch: 6, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.585 Vali Acc: 0.744 Test Loss: 0.585 Test Acc: 0.744
Validation loss decreased (-0.699993 --> -0.744439).  Saving model ...
Epoch: 7 cost time: 1.3218796253204346
Epoch: 7, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 8 cost time: 1.323542833328247
Epoch: 8, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.458 Vali Acc: 0.789 Test Loss: 0.458 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 1.231140375137329
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.423 Vali Acc: 0.789 Test Loss: 0.423 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 10 cost time: 1.3666281700134277
Epoch: 10, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.389 Vali Acc: 0.800 Test Loss: 0.389 Test Acc: 0.800
Validation loss decreased (-0.788885 --> -0.799996).  Saving model ...
Epoch: 11 cost time: 1.342073917388916
Epoch: 11, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.382 Vali Acc: 0.811 Test Loss: 0.382 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 1.3276684284210205
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 13 cost time: 1.2866315841674805
Epoch: 13, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 1.325073003768921
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 15 cost time: 1.347208023071289
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3593370914459229
Epoch: 16, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.399505853652954
Epoch: 17, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.298 Vali Acc: 0.839 Test Loss: 0.298 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4025764465332031
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.298 Vali Acc: 0.839 Test Loss: 0.298 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4168283939361572
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 1.3241863250732422
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 1.3737027645111084
Epoch: 21, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.288 Vali Acc: 0.844 Test Loss: 0.288 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3753087520599365
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 23 cost time: 1.3266403675079346
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1758060455322266
Epoch: 24, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.340 Vali Acc: 0.883 Test Loss: 0.340 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883330).  Saving model ...
Epoch: 25 cost time: 1.1854968070983887
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.285146713256836
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2017419338226318
Epoch: 27, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.271 Vali Acc: 0.850 Test Loss: 0.271 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2321124076843262
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2555434703826904
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.234806776046753
Epoch: 30, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.253 Vali Acc: 0.861 Test Loss: 0.253 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2558608055114746
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 32 cost time: 1.2402355670928955
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.282374382019043
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.240 Vali Acc: 0.878 Test Loss: 0.240 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2576625347137451
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2535936832427979
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3051161766052246
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3458399772644043
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 1.3944904804229736
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.350776195526123
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.46195387840271
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.210 Vali Acc: 0.900 Test Loss: 0.210 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4387364387512207
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 42 cost time: 1.325502872467041
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.900 Test Loss: 0.221 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2618398666381836
Epoch: 43, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3035194873809814
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1358604431152344
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2462971210479736
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.301076889038086
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.261803150177002
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3944432735443115
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4640085697174072
Epoch: 50, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 458054
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.150984287261963
Epoch: 1, Steps: 12 | Train Loss: 1.306 Vali Loss: 0.814 Vali Acc: 0.667 Test Loss: 0.814 Test Acc: 0.667
Validation loss decreased (inf --> -0.666659).  Saving model ...
Epoch: 2 cost time: 2.9218738079071045
Epoch: 2, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
Validation loss decreased (-0.666659 --> -0.783329).  Saving model ...
Epoch: 3 cost time: 2.9669079780578613
Epoch: 3, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9801547527313232
Epoch: 4, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822217).  Saving model ...
Epoch: 5 cost time: 2.9304556846618652
Epoch: 5, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9052724838256836
Epoch: 6, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.636545181274414
Epoch: 7, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
Validation loss decreased (-0.822217 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 2.8571295738220215
Epoch: 8, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.483 Vali Acc: 0.806 Test Loss: 0.483 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.769507884979248
Epoch: 9, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.349 Vali Acc: 0.872 Test Loss: 0.349 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 2.8833794593811035
Epoch: 10, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7151336669921875
Epoch: 11, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.847799062728882
Epoch: 12, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883329).  Saving model ...
Epoch: 13 cost time: 2.9058806896209717
Epoch: 13, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0446603298187256
Epoch: 14, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.486 Vali Acc: 0.856 Test Loss: 0.486 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.963210344314575
Epoch: 15, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.885 Vali Acc: 0.839 Test Loss: 0.885 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0341405868530273
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894441).  Saving model ...
Epoch: 17 cost time: 2.8614022731781006
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.803 Vali Acc: 0.856 Test Loss: 0.803 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.877030372619629
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2411184310913086
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.634 Vali Acc: 0.883 Test Loss: 0.634 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.27780818939209
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.676 Vali Acc: 0.878 Test Loss: 0.676 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7622947692871094
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.622 Vali Acc: 0.872 Test Loss: 0.622 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4479293823242188
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.856 Test Loss: 0.976 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1831374168395996
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.719 Vali Acc: 0.856 Test Loss: 0.719 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.9559199810028076
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.809412717819214
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.978 Vali Acc: 0.856 Test Loss: 0.978 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9286224842071533
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 2.997194766998291
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.883 Test Loss: 0.567 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0035197734832764
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.883 Test Loss: 0.532 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9652953147888184
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.894 Test Loss: 0.510 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0820610523223877
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.05513334274292
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.1433115005493164
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.906 Test Loss: 0.512 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905550).  Saving model ...
Epoch: 33 cost time: 3.2825746536254883
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.911 Test Loss: 0.501 Test Acc: 0.911
Validation loss decreased (-0.905550 --> -0.911106).  Saving model ...
Epoch: 34 cost time: 3.160374164581299
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.911 Test Loss: 0.515 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.0176429748535156
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.911 Test Loss: 0.520 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.966062068939209
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.911 Test Loss: 0.502 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.6991827487945557
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.917 Test Loss: 0.483 Test Acc: 0.917
Validation loss decreased (-0.911106 --> -0.916662).  Saving model ...
Epoch: 38 cost time: 2.7997987270355225
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.922 Test Loss: 0.478 Test Acc: 0.922
Validation loss decreased (-0.916662 --> -0.922217).  Saving model ...
Epoch: 39 cost time: 2.840559482574463
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.922 Test Loss: 0.474 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 40 cost time: 3.012882947921753
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.922 Test Loss: 0.484 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.4695935249328613
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.917 Test Loss: 0.518 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4997808933258057
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.922 Test Loss: 0.500 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.6171088218688965
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.922 Test Loss: 0.506 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.1919097900390625
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.922 Test Loss: 0.491 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.0577893257141113
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.922 Test Loss: 0.500 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.005796432495117
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.922 Test Loss: 0.496 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.9770402908325195
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.922 Test Loss: 0.505 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.966845989227295
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.922 Test Loss: 0.497 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.0141282081604004
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.922 Test Loss: 0.494 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 5603206
model size : 21.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9236154556274414
Epoch: 1, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.069 Vali Acc: 0.694 Test Loss: 1.069 Test Acc: 0.694
Validation loss decreased (inf --> -0.694434).  Saving model ...
Epoch: 2 cost time: 2.544433355331421
Epoch: 2, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.526 Vali Acc: 0.750 Test Loss: 0.526 Test Acc: 0.750
Validation loss decreased (-0.694434 --> -0.749995).  Saving model ...
Epoch: 3 cost time: 2.4430038928985596
Epoch: 3, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.380 Vali Acc: 0.800 Test Loss: 0.380 Test Acc: 0.800
Validation loss decreased (-0.749995 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 2.5040438175201416
Epoch: 4, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.514 Vali Acc: 0.811 Test Loss: 0.514 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811106).  Saving model ...
Epoch: 5 cost time: 2.7417728900909424
Epoch: 5, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
Validation loss decreased (-0.811106 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 2.695586919784546
Epoch: 6, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 2.7159900665283203
Epoch: 7, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 8 cost time: 2.65569806098938
Epoch: 8, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6995506286621094
Epoch: 9, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7624924182891846
Epoch: 10, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.352 Vali Acc: 0.883 Test Loss: 0.352 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 2.819230556488037
Epoch: 11, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 2.8558385372161865
Epoch: 12, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.346 Vali Acc: 0.872 Test Loss: 0.346 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7767691612243652
Epoch: 13, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 2.556974411010742
Epoch: 14, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 2.3864099979400635
Epoch: 15, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4073946475982666
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.425 Vali Acc: 0.867 Test Loss: 0.425 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4397337436676025
Epoch: 17, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.618 Vali Acc: 0.906 Test Loss: 0.618 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905549).  Saving model ...
Epoch: 18 cost time: 2.7663161754608154
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.547 Vali Acc: 0.883 Test Loss: 0.547 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7163844108581543
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
Validation loss decreased (-0.905549 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 2.8201212882995605
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.478 Vali Acc: 0.906 Test Loss: 0.478 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6757678985595703
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.403 Vali Acc: 0.917 Test Loss: 0.403 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.692387342453003
Epoch: 22, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.713362216949463
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7788095474243164
Epoch: 24, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.922218 --> -0.927775).  Saving model ...
Epoch: 25 cost time: 2.5897610187530518
Epoch: 25, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 2.6867363452911377
Epoch: 26, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 27 cost time: 2.6625468730926514
Epoch: 27, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.454728364944458
Epoch: 28, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.5140771865844727
Epoch: 29, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.529904365539551
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.6693196296691895
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.7546489238739014
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.782668352127075
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 34 cost time: 2.6700279712677
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 35 cost time: 2.65545654296875
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.6562180519104004
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.648136615753174
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.708366632461548
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 2.702948808670044
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.8202147483825684
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.939 Test Loss: 0.253 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 41 cost time: 2.6453254222869873
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.939 Test Loss: 0.243 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938886).  Saving model ...
Epoch: 42 cost time: 2.6237735748291016
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.939 Test Loss: 0.261 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.526674270629883
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.939 Test Loss: 0.250 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.603412389755249
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.5384292602539062
Epoch: 45, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.939 Test Loss: 0.254 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.165950059890747
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.5541913509368896
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.033864736557007
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.939 Test Loss: 0.255 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.020261287689209
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.025193214416504
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.939 Test Loss: 0.257 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 5124102
model size : 19.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.513887882232666
Epoch: 1, Steps: 12 | Train Loss: 1.447 Vali Loss: 0.965 Vali Acc: 0.767 Test Loss: 0.965 Test Acc: 0.767
Validation loss decreased (inf --> -0.766657).  Saving model ...
Epoch: 2 cost time: 2.9047021865844727
Epoch: 2, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.510 Vali Acc: 0.756 Test Loss: 0.510 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9079761505126953
Epoch: 3, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.372 Vali Acc: 0.833 Test Loss: 0.372 Test Acc: 0.833
Validation loss decreased (-0.766657 --> -0.833330).  Saving model ...
Epoch: 4 cost time: 2.957667350769043
Epoch: 4, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 5 cost time: 2.8123159408569336
Epoch: 5, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0804383754730225
Epoch: 6, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 3.041837692260742
Epoch: 7, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 8 cost time: 2.95892596244812
Epoch: 8, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.489 Vali Acc: 0.867 Test Loss: 0.489 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.029930830001831
Epoch: 9, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.399 Vali Acc: 0.883 Test Loss: 0.399 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883329).  Saving model ...
Epoch: 10 cost time: 2.9363391399383545
Epoch: 10, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.912716865539551
Epoch: 11, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.372 Vali Acc: 0.883 Test Loss: 0.372 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 2.959324836730957
Epoch: 12, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9940125942230225
Epoch: 13, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9757142066955566
Epoch: 14, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 2.949458360671997
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 2.7405059337615967
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.899994 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 2.8819572925567627
Epoch: 17, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.914375066757202
Epoch: 18, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.916114568710327
Epoch: 19, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0591013431549072
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.028853178024292
Epoch: 21, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1076221466064453
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.086798667907715
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.372 Vali Acc: 0.906 Test Loss: 0.372 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.0355265140533447
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.446 Vali Acc: 0.906 Test Loss: 0.446 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0676207542419434
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.1476173400878906
Epoch: 26, Steps: 12 | Train Loss: 0.412 Vali Loss: 1.480 Vali Acc: 0.806 Test Loss: 1.480 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 5124230
model size : 19.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.527447700500488
Epoch: 1, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.194 Vali Acc: 0.661 Test Loss: 1.194 Test Acc: 0.661
Validation loss decreased (inf --> -0.661099).  Saving model ...
Epoch: 2 cost time: 2.7591543197631836
Epoch: 2, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.588 Vali Acc: 0.744 Test Loss: 0.588 Test Acc: 0.744
Validation loss decreased (-0.661099 --> -0.744439).  Saving model ...
Epoch: 3 cost time: 2.863438129425049
Epoch: 3, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.424 Vali Acc: 0.789 Test Loss: 0.424 Test Acc: 0.789
Validation loss decreased (-0.744439 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 2.848606586456299
Epoch: 4, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
Validation loss decreased (-0.788885 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 2.8729188442230225
Epoch: 5, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.015340805053711
Epoch: 6, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.277 Vali Acc: 0.850 Test Loss: 0.277 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 3.132364511489868
Epoch: 7, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9904775619506836
Epoch: 8, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.394 Vali Acc: 0.867 Test Loss: 0.394 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 9 cost time: 2.986037015914917
Epoch: 9, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.527 Vali Acc: 0.811 Test Loss: 0.527 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.129894733428955
Epoch: 10, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.206815004348755
Epoch: 11, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.866663 --> -0.894442).  Saving model ...
Epoch: 12 cost time: 3.091169834136963
Epoch: 12, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.158658027648926
Epoch: 13, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2568273544311523
Epoch: 14, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 3.112226724624634
Epoch: 15, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 3.1175386905670166
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 2.8845109939575195
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.002924919128418
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.009793281555176
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.232978105545044
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2424559593200684
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.386 Vali Acc: 0.883 Test Loss: 0.386 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0480663776397705
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 3.1641528606414795
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 2.92326283454895
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 25 cost time: 2.8888187408447266
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.900 Test Loss: 0.681 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.001619338989258
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.890782356262207
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.035170078277588
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.979527235031128
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.454 Vali Acc: 0.906 Test Loss: 0.454 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.960620641708374
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.0064194202423096
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.0072484016418457
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.906 Test Loss: 0.705 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.9799351692199707
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.046363592147827
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 4977030
model size : 19.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.382627487182617
Epoch: 1, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.272 Vali Acc: 0.739 Test Loss: 1.272 Test Acc: 0.739
Validation loss decreased (inf --> -0.738876).  Saving model ...
Epoch: 2 cost time: 2.9012980461120605
Epoch: 2, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9800286293029785
Epoch: 3, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.441 Vali Acc: 0.783 Test Loss: 0.441 Test Acc: 0.783
Validation loss decreased (-0.738876 --> -0.783329).  Saving model ...
Epoch: 4 cost time: 2.9316439628601074
Epoch: 4, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.431 Vali Acc: 0.778 Test Loss: 0.431 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9626331329345703
Epoch: 5, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.383 Vali Acc: 0.811 Test Loss: 0.383 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 2.888704299926758
Epoch: 6, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.412 Vali Acc: 0.800 Test Loss: 0.412 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.962172746658325
Epoch: 7, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 2.9742302894592285
Epoch: 8, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.833330 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 2.7719717025756836
Epoch: 9, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.686906099319458
Epoch: 10, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6647989749908447
Epoch: 11, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8140547275543213
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.784078359603882
Epoch: 13, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.209 Vali Acc: 0.889 Test Loss: 0.209 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888887).  Saving model ...
Epoch: 14 cost time: 2.763080358505249
Epoch: 14, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8254432678222656
Epoch: 15, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.888887 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 3.0103530883789062
Epoch: 16, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.082045316696167
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.335 Vali Acc: 0.872 Test Loss: 0.335 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.030561923980713
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9777157306671143
Epoch: 19, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.822 Vali Acc: 0.867 Test Loss: 0.822 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9650681018829346
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9682085514068604
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 3.1647441387176514
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0308101177215576
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.769662380218506
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.911 Test Loss: 0.200 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.715968132019043
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6088290214538574
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.853355646133423
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.773406744003296
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 2.8405141830444336
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.832890510559082
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.9355578422546387
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.8296637535095215
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.7447314262390137
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 34 cost time: 2.791360378265381
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.0207595825195312
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.8482563495635986
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.770171642303467
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.5577054023742676
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.6877477169036865
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.7905731201171875
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.679271697998047
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.0195021629333496
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.9042022228240967
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 4866694
model size : 18.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.37851357460022
Epoch: 1, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.419 Vali Acc: 0.689 Test Loss: 1.419 Test Acc: 0.689
Validation loss decreased (inf --> -0.688875).  Saving model ...
Epoch: 2 cost time: 2.9750356674194336
Epoch: 2, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.781 Vali Acc: 0.700 Test Loss: 0.781 Test Acc: 0.700
Validation loss decreased (-0.688875 --> -0.699992).  Saving model ...
Epoch: 3 cost time: 2.9080235958099365
Epoch: 3, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.514 Vali Acc: 0.761 Test Loss: 0.514 Test Acc: 0.761
Validation loss decreased (-0.699992 --> -0.761106).  Saving model ...
Epoch: 4 cost time: 2.9075491428375244
Epoch: 4, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
Validation loss decreased (-0.761106 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 2.854273796081543
Epoch: 5, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 2.8603146076202393
Epoch: 6, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.9174082279205322
Epoch: 7, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.358 Vali Acc: 0.856 Test Loss: 0.358 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 2.72883677482605
Epoch: 8, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.562135696411133
Epoch: 9, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 2.6814181804656982
Epoch: 10, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.303 Vali Acc: 0.817 Test Loss: 0.303 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8373630046844482
Epoch: 11, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 2.7710981369018555
Epoch: 12, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.770153522491455
Epoch: 13, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 14 cost time: 2.8702149391174316
Epoch: 14, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.397 Vali Acc: 0.878 Test Loss: 0.397 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8339455127716064
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.647387981414795
Epoch: 16, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.894439697265625
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 2.7821528911590576
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9170026779174805
Epoch: 19, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.977231025695801
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 2.9282472133636475
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.94694185256958
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8207433223724365
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.780518054962158
Epoch: 24, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8196041584014893
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.8464889526367188
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9571478366851807
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.8753159046173096
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.8857529163360596
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 30 cost time: 2.9244296550750732
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.868260622024536
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8451695442199707
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.7273385524749756
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.6417078971862793
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.7777628898620605
Epoch: 35, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.738140344619751
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.8267629146575928
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.6967406272888184
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.6452724933624268
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 4793350
model size : 18.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.109685659408569
Epoch: 1, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.395 Vali Acc: 0.689 Test Loss: 1.395 Test Acc: 0.689
Validation loss decreased (inf --> -0.688875).  Saving model ...
Epoch: 2 cost time: 2.7847023010253906
Epoch: 2, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
Validation loss decreased (-0.688875 --> -0.738881).  Saving model ...
Epoch: 3 cost time: 2.8111467361450195
Epoch: 3, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.533 Vali Acc: 0.772 Test Loss: 0.533 Test Acc: 0.772
Validation loss decreased (-0.738881 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 2.8380277156829834
Epoch: 4, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.409 Vali Acc: 0.806 Test Loss: 0.409 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 2.937687873840332
Epoch: 5, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 6 cost time: 2.9794437885284424
Epoch: 6, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.430 Vali Acc: 0.794 Test Loss: 0.430 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7724997997283936
Epoch: 7, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.661749839782715
Epoch: 8, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.9452946186065674
Epoch: 9, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.318 Vali Acc: 0.822 Test Loss: 0.318 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9140262603759766
Epoch: 10, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.793344020843506
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 2.6528522968292236
Epoch: 12, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.4208528995513916
Epoch: 13, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888887).  Saving model ...
Epoch: 14 cost time: 2.487128973007202
Epoch: 14, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.324 Vali Acc: 0.844 Test Loss: 0.324 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.698511838912964
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.216 Vali Acc: 0.878 Test Loss: 0.216 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7841272354125977
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.683690071105957
Epoch: 17, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899998).  Saving model ...
Epoch: 18 cost time: 2.7646067142486572
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.229 Vali Acc: 0.906 Test Loss: 0.229 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 2.848792314529419
Epoch: 19, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 2.786611557006836
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9324562549591064
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8974153995513916
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.847515344619751
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.86319899559021
Epoch: 24, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8510937690734863
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9304113388061523
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.708444356918335
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.731386661529541
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 2.749439239501953
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.923929452896118
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.0598580837249756
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.156742811203003
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.035977840423584
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.059725522994995
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.9245901107788086
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 36 cost time: 3.106760025024414
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.902881145477295
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 38 cost time: 2.906383991241455
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.7833921909332275
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.597996711730957
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.320 Vali Acc: 0.928 Test Loss: 0.320 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.683339834213257
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.664046049118042
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 2.771243095397949
Epoch: 43, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.504 Vali Acc: 0.917 Test Loss: 0.504 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.859158992767334
Epoch: 44, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.435 Vali Acc: 0.911 Test Loss: 0.435 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.95145845413208
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.9968948364257812
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.452 Vali Acc: 0.894 Test Loss: 0.452 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.9897210597991943
Epoch: 47, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.567 Vali Acc: 0.889 Test Loss: 0.567 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.030395746231079
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.9294447898864746
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.9661331176757812
Epoch: 50, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.411 Vali Acc: 0.906 Test Loss: 0.411 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 4793606
model size : 18.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0419602394104
Epoch: 1, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.049 Vali Acc: 0.672 Test Loss: 1.049 Test Acc: 0.672
Validation loss decreased (inf --> -0.672212).  Saving model ...
Epoch: 2 cost time: 2.829869508743286
Epoch: 2, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.616 Vali Acc: 0.711 Test Loss: 0.616 Test Acc: 0.711
Validation loss decreased (-0.672212 --> -0.711105).  Saving model ...
Epoch: 3 cost time: 2.673072338104248
Epoch: 3, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
Validation loss decreased (-0.711105 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 2.4914073944091797
Epoch: 4, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
Validation loss decreased (-0.749994 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 2.458364963531494
Epoch: 5, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.462 Vali Acc: 0.794 Test Loss: 0.462 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.604236602783203
Epoch: 6, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.432 Vali Acc: 0.828 Test Loss: 0.432 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827773).  Saving model ...
Epoch: 7 cost time: 2.610898733139038
Epoch: 7, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.412 Vali Acc: 0.800 Test Loss: 0.412 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.549431085586548
Epoch: 8, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.391 Vali Acc: 0.883 Test Loss: 0.391 Test Acc: 0.883
Validation loss decreased (-0.827773 --> -0.883329).  Saving model ...
Epoch: 9 cost time: 2.638758420944214
Epoch: 9, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5950396060943604
Epoch: 10, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.288 Vali Acc: 0.861 Test Loss: 0.288 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4976820945739746
Epoch: 11, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.367 Vali Acc: 0.878 Test Loss: 0.367 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4422574043273926
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5130527019500732
Epoch: 13, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.637328863143921
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 2.824265241622925
Epoch: 15, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.422 Vali Acc: 0.878 Test Loss: 0.422 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8362340927124023
Epoch: 16, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8185627460479736
Epoch: 17, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 2.8424012660980225
Epoch: 18, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 2.7292916774749756
Epoch: 19, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.669562816619873
Epoch: 20, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.317 Vali Acc: 0.906 Test Loss: 0.317 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4954910278320312
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.4921748638153076
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.66560435295105
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 2.6439273357391357
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.448 Vali Acc: 0.872 Test Loss: 0.448 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.561123847961426
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5469605922698975
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.725533962249756
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6396453380584717
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 2.8553364276885986
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7517035007476807
Epoch: 30, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.911 Test Loss: 0.377 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.7876393795013428
Epoch: 31, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.565629005432129
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.911 Test Loss: 0.299 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.5618977546691895
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 2.6523046493530273
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.625657796859741
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.0408613681793213
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.3442158699035645
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.3035473823547363
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.3602962493896484
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.8237757682800293
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.6345388889312744
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.8721487522125244
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.8226444721221924
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1802182
model size : 6.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.0600831508636475
Epoch: 1, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.253 Vali Acc: 0.661 Test Loss: 1.253 Test Acc: 0.661
Validation loss decreased (inf --> -0.661099).  Saving model ...
Epoch: 2 cost time: 2.5979790687561035
Epoch: 2, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.652 Vali Acc: 0.733 Test Loss: 0.652 Test Acc: 0.733
Validation loss decreased (-0.661099 --> -0.733327).  Saving model ...
Epoch: 3 cost time: 2.554075002670288
Epoch: 3, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.472 Vali Acc: 0.772 Test Loss: 0.472 Test Acc: 0.772
Validation loss decreased (-0.733327 --> -0.772218).  Saving model ...
Epoch: 4 cost time: 2.543901205062866
Epoch: 4, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.374 Vali Acc: 0.783 Test Loss: 0.374 Test Acc: 0.783
Validation loss decreased (-0.772218 --> -0.783330).  Saving model ...
Epoch: 5 cost time: 2.3791871070861816
Epoch: 5, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
Validation loss decreased (-0.783330 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 2.236400604248047
Epoch: 6, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 2.318814516067505
Epoch: 7, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3674185276031494
Epoch: 8, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 2.5559353828430176
Epoch: 9, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 10 cost time: 2.3789384365081787
Epoch: 10, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.411 Vali Acc: 0.872 Test Loss: 0.411 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3765604496002197
Epoch: 11, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3706748485565186
Epoch: 12, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3097894191741943
Epoch: 13, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.474 Vali Acc: 0.828 Test Loss: 0.474 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.388928174972534
Epoch: 14, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 2.3014023303985596
Epoch: 15, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 2.1272733211517334
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 2.183122396469116
Epoch: 17, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3280410766601562
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4530975818634033
Epoch: 19, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5878446102142334
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5635571479797363
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2345802783966064
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5174877643585205
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.436262845993042
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3964381217956543
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.521577835083008
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1562630
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.708624839782715
Epoch: 1, Steps: 12 | Train Loss: 1.578 Vali Loss: 1.296 Vali Acc: 0.639 Test Loss: 1.296 Test Acc: 0.639
Validation loss decreased (inf --> -0.638876).  Saving model ...
Epoch: 2 cost time: 2.205449342727661
Epoch: 2, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.654 Vali Acc: 0.761 Test Loss: 0.654 Test Acc: 0.761
Validation loss decreased (-0.638876 --> -0.761105).  Saving model ...
Epoch: 3 cost time: 2.1751856803894043
Epoch: 3, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.466 Vali Acc: 0.767 Test Loss: 0.466 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 2.179490566253662
Epoch: 4, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.394 Vali Acc: 0.783 Test Loss: 0.394 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 2.2014596462249756
Epoch: 5, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
Validation loss decreased (-0.783329 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.9755017757415771
Epoch: 6, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.386 Vali Acc: 0.839 Test Loss: 0.386 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.996368646621704
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.362 Vali Acc: 0.800 Test Loss: 0.362 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.156592845916748
Epoch: 8, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.318 Vali Acc: 0.872 Test Loss: 0.318 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 2.1879401206970215
Epoch: 9, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1064627170562744
Epoch: 10, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
Validation loss decreased (-0.872219 --> -0.905553).  Saving model ...
Epoch: 11 cost time: 1.969372034072876
Epoch: 11, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.262 Vali Acc: 0.883 Test Loss: 0.262 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9351449012756348
Epoch: 12, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0007786750793457
Epoch: 13, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9631459712982178
Epoch: 14, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9686815738677979
Epoch: 15, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.367 Vali Acc: 0.878 Test Loss: 0.367 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1470348834991455
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.192340135574341
Epoch: 17, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.231760263442993
Epoch: 18, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 2.295492172241211
Epoch: 19, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.190871000289917
Epoch: 20, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2569544315338135
Epoch: 21, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.269153594970703
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.477030038833618
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2373158931732178
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4507431983947754
Epoch: 25, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.286770820617676
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.4186787605285645
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.2252471446990967
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1562694
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8829762935638428
Epoch: 1, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.393 Vali Acc: 0.717 Test Loss: 1.393 Test Acc: 0.717
Validation loss decreased (inf --> -0.716653).  Saving model ...
Epoch: 2 cost time: 2.168464422225952
Epoch: 2, Steps: 12 | Train Loss: 0.945 Vali Loss: 0.775 Vali Acc: 0.772 Test Loss: 0.775 Test Acc: 0.772
Validation loss decreased (-0.716653 --> -0.772214).  Saving model ...
Epoch: 3 cost time: 1.9942703247070312
Epoch: 3, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799995).  Saving model ...
Epoch: 4 cost time: 1.9867026805877686
Epoch: 4, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.419 Vali Acc: 0.828 Test Loss: 0.419 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 5 cost time: 2.0035715103149414
Epoch: 5, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.379 Vali Acc: 0.800 Test Loss: 0.379 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0204248428344727
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 7 cost time: 2.0106277465820312
Epoch: 7, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.310 Vali Acc: 0.828 Test Loss: 0.310 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.009549379348755
Epoch: 8, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9417476654052734
Epoch: 9, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.286 Vali Acc: 0.883 Test Loss: 0.286 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 10 cost time: 2.173995018005371
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.374 Vali Acc: 0.856 Test Loss: 0.374 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.982417106628418
Epoch: 11, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.148324728012085
Epoch: 12, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.248 Vali Acc: 0.878 Test Loss: 0.248 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1242659091949463
Epoch: 13, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905552).  Saving model ...
Epoch: 14 cost time: 1.8703348636627197
Epoch: 14, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.230 Vali Acc: 0.894 Test Loss: 0.230 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.002986192703247
Epoch: 15, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.905552 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 1.947248935699463
Epoch: 16, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8864645957946777
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.01666259765625
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.370 Vali Acc: 0.883 Test Loss: 0.370 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9410791397094727
Epoch: 19, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.144940137863159
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1747357845306396
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 2.2213926315307617
Epoch: 22, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2470157146453857
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2434284687042236
Epoch: 24, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2543044090270996
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2333953380584717
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.262343406677246
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1929426193237305
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.153585910797119
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.2860748767852783
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 2.0123705863952637
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0924465656280518
Epoch: 32, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.939 Test Loss: 0.188 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 33 cost time: 2.0185508728027344
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9019787311553955
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9371871948242188
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0033013820648193
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.087052345275879
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.0411601066589355
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.0591537952423096
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.1602890491485596
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 2.2036678791046143
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.219832420349121
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.1579389572143555
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.270230531692505
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.153559923171997
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.167118787765503
Epoch: 46, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.1334688663482666
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.928 Test Loss: 0.228 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.1602156162261963
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.92378568649292
Epoch: 49, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.229945659637451
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1489094
model size : 5.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.224756956100464
Epoch: 1, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.440 Vali Acc: 0.628 Test Loss: 1.440 Test Acc: 0.628
Validation loss decreased (inf --> -0.627763).  Saving model ...
Epoch: 2 cost time: 2.1559112071990967
Epoch: 2, Steps: 12 | Train Loss: 1.036 Vali Loss: 0.879 Vali Acc: 0.722 Test Loss: 0.879 Test Acc: 0.722
Validation loss decreased (-0.627763 --> -0.722213).  Saving model ...
Epoch: 3 cost time: 2.2326271533966064
Epoch: 3, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.574 Vali Acc: 0.733 Test Loss: 0.574 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733328).  Saving model ...
Epoch: 4 cost time: 2.1363563537597656
Epoch: 4, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.441 Vali Acc: 0.767 Test Loss: 0.441 Test Acc: 0.767
Validation loss decreased (-0.733328 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 1.8501887321472168
Epoch: 5, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.400 Vali Acc: 0.789 Test Loss: 0.400 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 1.8868012428283691
Epoch: 6, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
Validation loss decreased (-0.788885 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.0058698654174805
Epoch: 7, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.372 Vali Acc: 0.800 Test Loss: 0.372 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0679140090942383
Epoch: 8, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.310 Vali Acc: 0.861 Test Loss: 0.310 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 9 cost time: 1.7874925136566162
Epoch: 9, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8843967914581299
Epoch: 10, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.8545925617218018
Epoch: 11, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9167773723602295
Epoch: 12, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 2.030362129211426
Epoch: 13, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.257 Vali Acc: 0.867 Test Loss: 0.257 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8585453033447266
Epoch: 14, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1999638080596924
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 2.1050868034362793
Epoch: 16, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927775).  Saving model ...
Epoch: 17 cost time: 2.011611223220825
Epoch: 17, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9973852634429932
Epoch: 18, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.021383285522461
Epoch: 19, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1319618225097656
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1940252780914307
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0555715560913086
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1527554988861084
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1213037967681885
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.004910469055176
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9815905094146729
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 1433926
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.260876178741455
Epoch: 1, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.571 Vali Acc: 0.617 Test Loss: 1.571 Test Acc: 0.617
Validation loss decreased (inf --> -0.616651).  Saving model ...
Epoch: 2 cost time: 2.00321626663208
Epoch: 2, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.080 Vali Acc: 0.706 Test Loss: 1.080 Test Acc: 0.706
Validation loss decreased (-0.616651 --> -0.705545).  Saving model ...
Epoch: 3 cost time: 1.8974347114562988
Epoch: 3, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.695 Vali Acc: 0.733 Test Loss: 0.695 Test Acc: 0.733
Validation loss decreased (-0.705545 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.9693973064422607
Epoch: 4, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
Validation loss decreased (-0.733326 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 1.8752429485321045
Epoch: 5, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.427 Vali Acc: 0.806 Test Loss: 0.427 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 1.7202463150024414
Epoch: 6, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.5823571681976318
Epoch: 7, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.6919994354248047
Epoch: 8, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.7477574348449707
Epoch: 9, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.736562967300415
Epoch: 10, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8123886585235596
Epoch: 11, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.7367627620697021
Epoch: 12, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.300 Vali Acc: 0.856 Test Loss: 0.300 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6939153671264648
Epoch: 13, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 1.7658138275146484
Epoch: 14, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8895552158355713
Epoch: 15, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.10823917388916
Epoch: 16, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9963114261627197
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 1.9621403217315674
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1277647018432617
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 20 cost time: 1.8991048336029053
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.990203857421875
Epoch: 21, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0126311779022217
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0422167778015137
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.835416555404663
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 1.99005126953125
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8571176528930664
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 1.8675060272216797
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7486381530761719
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6919474601745605
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.842634677886963
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7899727821350098
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.920670509338379
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.035139322280884
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9332003593444824
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.947650671005249
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6931986808776855
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1397254
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.452307939529419
Epoch: 1, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.557 Vali Acc: 0.639 Test Loss: 1.557 Test Acc: 0.639
Validation loss decreased (inf --> -0.638873).  Saving model ...
Epoch: 2 cost time: 1.828226089477539
Epoch: 2, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.091 Vali Acc: 0.656 Test Loss: 1.091 Test Acc: 0.656
Validation loss decreased (-0.638873 --> -0.655545).  Saving model ...
Epoch: 3 cost time: 1.8144333362579346
Epoch: 3, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
Validation loss decreased (-0.655545 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 1.7754449844360352
Epoch: 4, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.548 Vali Acc: 0.767 Test Loss: 0.548 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 1.863105297088623
Epoch: 5, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.461 Vali Acc: 0.789 Test Loss: 0.461 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 1.9724972248077393
Epoch: 6, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.400 Vali Acc: 0.828 Test Loss: 0.400 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 1.875058889389038
Epoch: 7, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.8253271579742432
Epoch: 8, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.8409292697906494
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.329 Vali Acc: 0.839 Test Loss: 0.329 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.874875783920288
Epoch: 10, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 1.9373297691345215
Epoch: 11, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 1.9393219947814941
Epoch: 12, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 1.9936022758483887
Epoch: 13, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.025804281234741
Epoch: 14, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.350 Vali Acc: 0.872 Test Loss: 0.350 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.019556999206543
Epoch: 15, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 2.032515525817871
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.315 Vali Acc: 0.861 Test Loss: 0.315 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8787956237792969
Epoch: 17, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0420663356781006
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9811162948608398
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.251 Vali Acc: 0.861 Test Loss: 0.251 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9556457996368408
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9308836460113525
Epoch: 21, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 1.711338996887207
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.9305171966552734
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.221 Vali Acc: 0.906 Test Loss: 0.221 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9608025550842285
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9221935272216797
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9665920734405518
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7620420455932617
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.617069959640503
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6386706829071045
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.7769708633422852
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.788792371749878
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9598824977874756
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 1.8478693962097168
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.789294958114624
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7662768363952637
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8484165668487549
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.0613584518432617
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 2.0344090461730957
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.039797067642212
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 1.9320127964019775
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 41 cost time: 1.774202585220337
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 2.07249116897583
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.042070150375366
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.9667809009552002
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.104313373565674
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.024374485015869
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.9544355869293213
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.8762171268463135
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.8741588592529297
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.778472900390625
Epoch: 50, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1397382
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.304084539413452
Epoch: 1, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.271 Vali Acc: 0.733 Test Loss: 1.271 Test Acc: 0.733
Validation loss decreased (inf --> -0.733321).  Saving model ...
Epoch: 2 cost time: 1.8302595615386963
Epoch: 2, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.697 Vali Acc: 0.767 Test Loss: 0.697 Test Acc: 0.767
Validation loss decreased (-0.733321 --> -0.766660).  Saving model ...
Epoch: 3 cost time: 1.702120065689087
Epoch: 3, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.510 Vali Acc: 0.750 Test Loss: 0.510 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7157256603240967
Epoch: 4, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.410 Vali Acc: 0.806 Test Loss: 0.410 Test Acc: 0.806
Validation loss decreased (-0.766660 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 1.63606595993042
Epoch: 5, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
Validation loss decreased (-0.805551 --> -0.849997).  Saving model ...
Epoch: 6 cost time: 1.5919666290283203
Epoch: 6, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.316 Vali Acc: 0.817 Test Loss: 0.316 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.672680139541626
Epoch: 7, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6921448707580566
Epoch: 8, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 1.5706920623779297
Epoch: 9, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6440167427062988
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.397 Vali Acc: 0.856 Test Loss: 0.397 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5999011993408203
Epoch: 11, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5088040828704834
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.234 Vali Acc: 0.894 Test Loss: 0.234 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 13 cost time: 1.5527269840240479
Epoch: 13, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 1.6644773483276367
Epoch: 14, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.652085304260254
Epoch: 15, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.700016736984253
Epoch: 16, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.277 Vali Acc: 0.867 Test Loss: 0.277 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6573035717010498
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 1.8892652988433838
Epoch: 18, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.463 Vali Acc: 0.917 Test Loss: 0.463 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 1.9185855388641357
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.910444974899292
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.809412956237793
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7572669982910156
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7786247730255127
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8253047466278076
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8699872493743896
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7350730895996094
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.466 Vali Acc: 0.894 Test Loss: 0.466 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7998833656311035
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8243937492370605
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8763909339904785
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7230677604675293
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.484 Vali Acc: 0.906 Test Loss: 0.484 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 651238
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.745210886001587
Epoch: 1, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.556 Vali Acc: 0.617 Test Loss: 1.556 Test Acc: 0.617
Validation loss decreased (inf --> -0.616651).  Saving model ...
Epoch: 2 cost time: 1.5005106925964355
Epoch: 2, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.000 Vali Acc: 0.706 Test Loss: 1.000 Test Acc: 0.706
Validation loss decreased (-0.616651 --> -0.705546).  Saving model ...
Epoch: 3 cost time: 1.4559757709503174
Epoch: 3, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.4642667770385742
Epoch: 4, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.488 Vali Acc: 0.778 Test Loss: 0.488 Test Acc: 0.778
Validation loss decreased (-0.727771 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 1.4951496124267578
Epoch: 5, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.444 Vali Acc: 0.761 Test Loss: 0.444 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4414989948272705
Epoch: 6, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.381 Vali Acc: 0.800 Test Loss: 0.381 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 1.5516948699951172
Epoch: 7, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 1.5668690204620361
Epoch: 8, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.5459887981414795
Epoch: 9, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.341 Vali Acc: 0.828 Test Loss: 0.341 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.530078649520874
Epoch: 10, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.296 Vali Acc: 0.822 Test Loss: 0.296 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5616838932037354
Epoch: 11, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.290 Vali Acc: 0.844 Test Loss: 0.290 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844442).  Saving model ...
Epoch: 12 cost time: 1.6674327850341797
Epoch: 12, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
Validation loss decreased (-0.844442 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.6628859043121338
Epoch: 13, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.270 Vali Acc: 0.861 Test Loss: 0.270 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 1.5246539115905762
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 1.5696845054626465
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6960806846618652
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4985325336456299
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4621388912200928
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.3645439147949219
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.376230239868164
Epoch: 20, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.412719488143921
Epoch: 21, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4211623668670654
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 1.5370259284973145
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5504579544067383
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.239 Vali Acc: 0.883 Test Loss: 0.239 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5662152767181396
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7243273258209229
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.734391450881958
Epoch: 27, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6877918243408203
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.72853422164917
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 30 cost time: 1.5503380298614502
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6760599613189697
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6050496101379395
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 1.48881196975708
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5215601921081543
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.530102252960205
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 1.5787856578826904
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 37 cost time: 1.4364004135131836
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5007898807525635
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4528229236602783
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5854578018188477
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.53277587890625
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4616177082061768
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.5284504890441895
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.5145483016967773
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.5387818813323975
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4372715950012207
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 531462
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8552117347717285
Epoch: 1, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.497 Vali Acc: 0.650 Test Loss: 1.497 Test Acc: 0.650
Validation loss decreased (inf --> -0.649985).  Saving model ...
Epoch: 2 cost time: 1.63726806640625
Epoch: 2, Steps: 12 | Train Loss: 1.102 Vali Loss: 0.943 Vali Acc: 0.683 Test Loss: 0.943 Test Acc: 0.683
Validation loss decreased (-0.649985 --> -0.683324).  Saving model ...
Epoch: 3 cost time: 1.6575114727020264
Epoch: 3, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.644 Vali Acc: 0.744 Test Loss: 0.644 Test Acc: 0.744
Validation loss decreased (-0.683324 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.4593532085418701
Epoch: 4, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.481 Vali Acc: 0.778 Test Loss: 0.481 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 1.4971222877502441
Epoch: 5, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.413 Vali Acc: 0.789 Test Loss: 0.413 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 1.5028023719787598
Epoch: 6, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
Validation loss decreased (-0.788885 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.5465600490570068
Epoch: 7, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.6070632934570312
Epoch: 8, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.578139066696167
Epoch: 9, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.315 Vali Acc: 0.828 Test Loss: 0.315 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5046977996826172
Epoch: 10, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 1.5233190059661865
Epoch: 11, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.291 Vali Acc: 0.844 Test Loss: 0.291 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4700162410736084
Epoch: 12, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6817102432250977
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.359 Vali Acc: 0.872 Test Loss: 0.359 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.58723783493042
Epoch: 14, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.262 Vali Acc: 0.861 Test Loss: 0.262 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4999163150787354
Epoch: 15, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.268 Vali Acc: 0.872 Test Loss: 0.268 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872220).  Saving model ...
Epoch: 16 cost time: 1.4585108757019043
Epoch: 16, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.254 Vali Acc: 0.872 Test Loss: 0.254 Test Acc: 0.872
Validation loss decreased (-0.872220 --> -0.872220).  Saving model ...
Epoch: 17 cost time: 1.4387013912200928
Epoch: 17, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.872220 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.4520983695983887
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.244 Vali Acc: 0.878 Test Loss: 0.244 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5166316032409668
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.723388433456421
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.259 Vali Acc: 0.867 Test Loss: 0.259 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.684394121170044
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6539607048034668
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.653322696685791
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6397597789764404
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6091246604919434
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5003528594970703
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5336682796478271
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.911 Test Loss: 0.216 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 531494
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1994521617889404
Epoch: 1, Steps: 12 | Train Loss: 1.783 Vali Loss: 1.606 Vali Acc: 0.517 Test Loss: 1.606 Test Acc: 0.517
Validation loss decreased (inf --> -0.516651).  Saving model ...
Epoch: 2 cost time: 1.4460384845733643
Epoch: 2, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.102 Vali Acc: 0.683 Test Loss: 1.102 Test Acc: 0.683
Validation loss decreased (-0.516651 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 1.5553786754608154
Epoch: 3, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.720 Vali Acc: 0.717 Test Loss: 0.720 Test Acc: 0.717
Validation loss decreased (-0.683322 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 1.4802525043487549
Epoch: 4, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.534 Vali Acc: 0.728 Test Loss: 0.534 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727772).  Saving model ...
Epoch: 5 cost time: 1.58668851852417
Epoch: 5, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.460 Vali Acc: 0.772 Test Loss: 0.460 Test Acc: 0.772
Validation loss decreased (-0.727772 --> -0.772218).  Saving model ...
Epoch: 6 cost time: 1.5040738582611084
Epoch: 6, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.399 Vali Acc: 0.817 Test Loss: 0.399 Test Acc: 0.817
Validation loss decreased (-0.772218 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.663426160812378
Epoch: 7, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 1.5549159049987793
Epoch: 8, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6560842990875244
Epoch: 9, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.6058058738708496
Epoch: 10, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.626652479171753
Epoch: 11, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.322 Vali Acc: 0.822 Test Loss: 0.322 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4612257480621338
Epoch: 12, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 1.4842076301574707
Epoch: 13, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4800820350646973
Epoch: 14, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.307 Vali Acc: 0.844 Test Loss: 0.307 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4836392402648926
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.4372756481170654
Epoch: 16, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.250 Vali Acc: 0.856 Test Loss: 0.250 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.40873384475708
Epoch: 17, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.867 Test Loss: 0.258 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4159672260284424
Epoch: 18, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 19 cost time: 1.511958122253418
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.234 Vali Acc: 0.889 Test Loss: 0.234 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5008904933929443
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5534615516662598
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6419425010681152
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.404 Vali Acc: 0.906 Test Loss: 0.404 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905552).  Saving model ...
Epoch: 23 cost time: 1.6749215126037598
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.552586317062378
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.457292079925537
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5231406688690186
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.4996187686920166
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 1.6529443264007568
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5857224464416504
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.6952359676361084
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7635784149169922
Epoch: 31, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5885376930236816
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5542161464691162
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5892822742462158
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 1.5162088871002197
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 1.5129036903381348
Epoch: 36, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4978845119476318
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5492231845855713
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 39 cost time: 1.4547350406646729
Epoch: 39, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5113849639892578
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6689445972442627
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7189788818359375
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5929250717163086
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 1.5577986240386963
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5096099376678467
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.454145908355713
Epoch: 46, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4683866500854492
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6438491344451904
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.698918342590332
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.7162599563598633
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 494694
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7938694953918457
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.638 Vali Acc: 0.400 Test Loss: 1.638 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.4572701454162598
Epoch: 2, Steps: 12 | Train Loss: 1.396 Vali Loss: 1.211 Vali Acc: 0.622 Test Loss: 1.211 Test Acc: 0.622
Validation loss decreased (-0.399984 --> -0.622210).  Saving model ...
Epoch: 3 cost time: 1.458317518234253
Epoch: 3, Steps: 12 | Train Loss: 0.961 Vali Loss: 0.852 Vali Acc: 0.717 Test Loss: 0.852 Test Acc: 0.717
Validation loss decreased (-0.622210 --> -0.716658).  Saving model ...
Epoch: 4 cost time: 1.3850429058074951
Epoch: 4, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
Validation loss decreased (-0.716658 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.346489429473877
Epoch: 5, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 1.360234260559082
Epoch: 6, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.463 Vali Acc: 0.772 Test Loss: 0.463 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4571967124938965
Epoch: 7, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 1.4890713691711426
Epoch: 8, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.375 Vali Acc: 0.800 Test Loss: 0.375 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4221370220184326
Epoch: 9, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.347 Vali Acc: 0.839 Test Loss: 0.347 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 1.5535085201263428
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4782905578613281
Epoch: 11, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4434351921081543
Epoch: 12, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 1.439150094985962
Epoch: 13, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.4365713596343994
Epoch: 14, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.262 Vali Acc: 0.861 Test Loss: 0.262 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4892597198486328
Epoch: 15, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.266 Vali Acc: 0.861 Test Loss: 0.266 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5934906005859375
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.268 Vali Acc: 0.883 Test Loss: 0.268 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 17 cost time: 1.6262352466583252
Epoch: 17, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5317435264587402
Epoch: 18, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.49324369430542
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 1.4870822429656982
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.248 Vali Acc: 0.872 Test Loss: 0.248 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2603118419647217
Epoch: 21, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.385990858078003
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.243 Vali Acc: 0.872 Test Loss: 0.243 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.315828561782837
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.228 Vali Acc: 0.883 Test Loss: 0.228 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4268646240234375
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4221131801605225
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 1.3635141849517822
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 1.360050916671753
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.416487693786621
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.242 Vali Acc: 0.906 Test Loss: 0.242 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.536414384841919
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 1.5987918376922607
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4296393394470215
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3853588104248047
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4392859935760498
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4592411518096924
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5301482677459717
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5436687469482422
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6274511814117432
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.563316822052002
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 39 cost time: 1.4339556694030762
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.41194486618042
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.450190782546997
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.245718240737915
Epoch: 42, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 43 cost time: 1.4215078353881836
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 1.4843096733093262
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.939 Test Loss: 0.179 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 45 cost time: 1.465345859527588
Epoch: 45, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.4434475898742676
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3987021446228027
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.469543695449829
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.6404774188995361
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.5676038265228271
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 467110
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8955326080322266
Epoch: 1, Steps: 12 | Train Loss: 1.798 Vali Loss: 1.687 Vali Acc: 0.439 Test Loss: 1.687 Test Acc: 0.439
Validation loss decreased (inf --> -0.438872).  Saving model ...
Epoch: 2 cost time: 1.352315902709961
Epoch: 2, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.403 Vali Acc: 0.672 Test Loss: 1.403 Test Acc: 0.672
Validation loss decreased (-0.438872 --> -0.672208).  Saving model ...
Epoch: 3 cost time: 1.5437328815460205
Epoch: 3, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.063 Vali Acc: 0.683 Test Loss: 1.063 Test Acc: 0.683
Validation loss decreased (-0.672208 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 1.5135931968688965
Epoch: 4, Steps: 12 | Train Loss: 0.893 Vali Loss: 0.801 Vali Acc: 0.728 Test Loss: 0.801 Test Acc: 0.728
Validation loss decreased (-0.683323 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 1.434765338897705
Epoch: 5, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.645 Vali Acc: 0.733 Test Loss: 0.645 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 1.4984190464019775
Epoch: 6, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.558 Vali Acc: 0.761 Test Loss: 0.558 Test Acc: 0.761
Validation loss decreased (-0.733327 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 1.3559048175811768
Epoch: 7, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.490 Vali Acc: 0.767 Test Loss: 0.490 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 1.3640108108520508
Epoch: 8, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.438 Vali Acc: 0.828 Test Loss: 0.438 Test Acc: 0.828
Validation loss decreased (-0.766662 --> -0.827773).  Saving model ...
Epoch: 9 cost time: 1.3681817054748535
Epoch: 9, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.403 Vali Acc: 0.800 Test Loss: 0.403 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4281277656555176
Epoch: 10, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.332564115524292
Epoch: 11, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4188148975372314
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.340 Vali Acc: 0.844 Test Loss: 0.340 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 1.4986319541931152
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.5252130031585693
Epoch: 14, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.320 Vali Acc: 0.839 Test Loss: 0.320 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4234261512756348
Epoch: 15, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.5182831287384033
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.295 Vali Acc: 0.850 Test Loss: 0.295 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5591235160827637
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.4824743270874023
Epoch: 18, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4089937210083008
Epoch: 19, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.335017204284668
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.35355806350708
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.246 Vali Acc: 0.856 Test Loss: 0.246 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.354382038116455
Epoch: 22, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3878791332244873
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 24 cost time: 1.349410057067871
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.273 Vali Acc: 0.856 Test Loss: 0.273 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3643968105316162
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4368185997009277
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4497501850128174
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6306793689727783
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4311203956604004
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4520909786224365
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 1.303997278213501
Epoch: 31, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.391096591949463
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 33 cost time: 1.4272561073303223
Epoch: 33, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3044812679290771
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.248 Vali Acc: 0.878 Test Loss: 0.248 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.373342514038086
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3834152221679688
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 37 cost time: 1.378497838973999
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.906 Test Loss: 0.230 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 38 cost time: 1.4050095081329346
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 39 cost time: 1.482337236404419
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5452253818511963
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5153143405914307
Epoch: 41, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5031123161315918
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.906 Test Loss: 0.225 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6239650249481201
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4630396366119385
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.333833932876587
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4224512577056885
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.4398927688598633
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.4307661056518555
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 448774
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8432161808013916
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.724 Vali Acc: 0.361 Test Loss: 1.724 Test Acc: 0.361
Validation loss decreased (inf --> -0.361094).  Saving model ...
Epoch: 2 cost time: 1.4262490272521973
Epoch: 2, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.462 Vali Acc: 0.611 Test Loss: 1.462 Test Acc: 0.611
Validation loss decreased (-0.361094 --> -0.611096).  Saving model ...
Epoch: 3 cost time: 1.4339172840118408
Epoch: 3, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.125 Vali Acc: 0.672 Test Loss: 1.125 Test Acc: 0.672
Validation loss decreased (-0.611096 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.4572317600250244
Epoch: 4, Steps: 12 | Train Loss: 0.912 Vali Loss: 0.882 Vali Acc: 0.678 Test Loss: 0.882 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677769).  Saving model ...
Epoch: 5 cost time: 1.4172945022583008
Epoch: 5, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.699 Vali Acc: 0.739 Test Loss: 0.699 Test Acc: 0.739
Validation loss decreased (-0.677769 --> -0.738882).  Saving model ...
Epoch: 6 cost time: 1.4789891242980957
Epoch: 6, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.590 Vali Acc: 0.739 Test Loss: 0.590 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.4607911109924316
Epoch: 7, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.510 Vali Acc: 0.761 Test Loss: 0.510 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 1.4879169464111328
Epoch: 8, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.450 Vali Acc: 0.794 Test Loss: 0.450 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 1.604149341583252
Epoch: 9, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.6053943634033203
Epoch: 10, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 1.540308952331543
Epoch: 11, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.374 Vali Acc: 0.822 Test Loss: 0.374 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5759406089782715
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.350 Vali Acc: 0.839 Test Loss: 0.350 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.5038299560546875
Epoch: 13, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.5132999420166016
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.324 Vali Acc: 0.817 Test Loss: 0.324 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4940385818481445
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.4713432788848877
Epoch: 16, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.423583984375
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.5200531482696533
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 1.5513856410980225
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6393768787384033
Epoch: 20, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2778384685516357
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.272 Vali Acc: 0.850 Test Loss: 0.272 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.288431167602539
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2312288284301758
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2715437412261963
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.276 Vali Acc: 0.867 Test Loss: 0.276 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2566108703613281
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.262 Vali Acc: 0.856 Test Loss: 0.262 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4447238445281982
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4881343841552734
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.319 Vali Acc: 0.883 Test Loss: 0.319 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4984943866729736
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 448838
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.059245586395264
Epoch: 1, Steps: 12 | Train Loss: 1.016 Vali Loss: 0.481 Vali Acc: 0.767 Test Loss: 0.481 Test Acc: 0.767
Validation loss decreased (inf --> -0.766662).  Saving model ...
Epoch: 2 cost time: 2.666168689727783
Epoch: 2, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799995).  Saving model ...
Epoch: 3 cost time: 2.685908794403076
Epoch: 3, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.077 Vali Acc: 0.783 Test Loss: 1.077 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.668092966079712
Epoch: 4, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
Validation loss decreased (-0.799995 --> -0.866662).  Saving model ...
Epoch: 5 cost time: 2.7514538764953613
Epoch: 5, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.046 Vali Acc: 0.828 Test Loss: 1.046 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6128835678100586
Epoch: 6, Steps: 12 | Train Loss: 0.418 Vali Loss: 1.406 Vali Acc: 0.811 Test Loss: 1.406 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3187904357910156
Epoch: 7, Steps: 12 | Train Loss: 0.345 Vali Loss: 2.178 Vali Acc: 0.756 Test Loss: 2.178 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0537331104278564
Epoch: 8, Steps: 12 | Train Loss: 0.663 Vali Loss: 2.371 Vali Acc: 0.794 Test Loss: 2.371 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2580692768096924
Epoch: 9, Steps: 12 | Train Loss: 1.055 Vali Loss: 3.018 Vali Acc: 0.772 Test Loss: 3.018 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3142852783203125
Epoch: 10, Steps: 12 | Train Loss: 0.762 Vali Loss: 1.620 Vali Acc: 0.828 Test Loss: 1.620 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.401627540588379
Epoch: 11, Steps: 12 | Train Loss: 1.058 Vali Loss: 3.312 Vali Acc: 0.761 Test Loss: 3.312 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4232301712036133
Epoch: 12, Steps: 12 | Train Loss: 0.222 Vali Loss: 2.077 Vali Acc: 0.806 Test Loss: 2.077 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4695825576782227
Epoch: 13, Steps: 12 | Train Loss: 0.902 Vali Loss: 2.986 Vali Acc: 0.756 Test Loss: 2.986 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6731317043304443
Epoch: 14, Steps: 12 | Train Loss: 0.610 Vali Loss: 4.051 Vali Acc: 0.750 Test Loss: 4.051 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 5482246
model size : 21.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1664721965789795
Epoch: 1, Steps: 12 | Train Loss: 1.161 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
Validation loss decreased (inf --> -0.755550).  Saving model ...
Epoch: 2 cost time: 2.017015218734741
Epoch: 2, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
Validation loss decreased (-0.755550 --> -0.805552).  Saving model ...
Epoch: 3 cost time: 2.0708789825439453
Epoch: 3, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
Validation loss decreased (-0.805552 --> -0.849997).  Saving model ...
Epoch: 4 cost time: 2.0706937313079834
Epoch: 4, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.828293800354004
Epoch: 5, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.899 Vali Acc: 0.767 Test Loss: 0.899 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7826175689697266
Epoch: 6, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7597486972808838
Epoch: 7, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866662).  Saving model ...
Epoch: 8 cost time: 1.7953171730041504
Epoch: 8, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9314537048339844
Epoch: 9, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.986938714981079
Epoch: 10, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9364941120147705
Epoch: 11, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.075634241104126
Epoch: 12, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 13 cost time: 1.9906435012817383
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.747 Vali Acc: 0.861 Test Loss: 0.747 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0591793060302734
Epoch: 14, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9911952018737793
Epoch: 15, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.960 Vali Acc: 0.833 Test Loss: 0.960 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9987890720367432
Epoch: 16, Steps: 12 | Train Loss: 0.339 Vali Loss: 1.017 Vali Acc: 0.822 Test Loss: 1.017 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.050978183746338
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.196 Vali Acc: 0.839 Test Loss: 1.196 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.087761163711548
Epoch: 18, Steps: 12 | Train Loss: 0.592 Vali Loss: 2.292 Vali Acc: 0.794 Test Loss: 2.292 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0510988235473633
Epoch: 19, Steps: 12 | Train Loss: 0.720 Vali Loss: 1.582 Vali Acc: 0.822 Test Loss: 1.582 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0732290744781494
Epoch: 20, Steps: 12 | Train Loss: 0.292 Vali Loss: 1.618 Vali Acc: 0.800 Test Loss: 1.618 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.01208758354187
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.661 Vali Acc: 0.822 Test Loss: 1.661 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.738682746887207
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.900 Vali Acc: 0.839 Test Loss: 1.900 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 4524038
model size : 17.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3185887336730957
Epoch: 1, Steps: 12 | Train Loss: 1.252 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.716661).  Saving model ...
Epoch: 2 cost time: 1.9490516185760498
Epoch: 2, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.568 Vali Acc: 0.778 Test Loss: 0.568 Test Acc: 0.778
Validation loss decreased (-0.716661 --> -0.777772).  Saving model ...
Epoch: 3 cost time: 2.090848445892334
Epoch: 3, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.572 Vali Acc: 0.778 Test Loss: 0.572 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.030017852783203
Epoch: 4, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
Validation loss decreased (-0.777772 --> -0.838886).  Saving model ...
Epoch: 5 cost time: 2.10101056098938
Epoch: 5, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 2.092642307281494
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.052 Vali Acc: 0.794 Test Loss: 1.052 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.163827896118164
Epoch: 7, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.812 Vali Acc: 0.811 Test Loss: 0.812 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.139638662338257
Epoch: 8, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.830 Vali Acc: 0.811 Test Loss: 0.830 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0588631629943848
Epoch: 9, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.000 Vali Acc: 0.789 Test Loss: 1.000 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1141769886016846
Epoch: 10, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.995926856994629
Epoch: 11, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.994 Vali Acc: 0.833 Test Loss: 0.994 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.051112174987793
Epoch: 12, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.365 Vali Acc: 0.911 Test Loss: 0.365 Test Acc: 0.911
Validation loss decreased (-0.861106 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 1.756406545639038
Epoch: 13, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.699 Vali Acc: 0.794 Test Loss: 1.699 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.796571969985962
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 1.047 Vali Acc: 0.811 Test Loss: 1.047 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8518869876861572
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.780 Vali Acc: 0.794 Test Loss: 0.780 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7074899673461914
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.720 Vali Acc: 0.800 Test Loss: 1.720 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.002978563308716
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.420 Vali Acc: 0.839 Test Loss: 1.420 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9412832260131836
Epoch: 18, Steps: 12 | Train Loss: 0.365 Vali Loss: 1.469 Vali Acc: 0.861 Test Loss: 1.469 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9233577251434326
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.257 Vali Acc: 0.867 Test Loss: 1.257 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.018941879272461
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0951087474823
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 2.456 Vali Acc: 0.833 Test Loss: 2.456 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.108818769454956
Epoch: 22, Steps: 12 | Train Loss: 0.485 Vali Loss: 1.082 Vali Acc: 0.856 Test Loss: 1.082 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 4524294
model size : 17.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.209676504135132
Epoch: 1, Steps: 12 | Train Loss: 1.309 Vali Loss: 0.728 Vali Acc: 0.689 Test Loss: 0.728 Test Acc: 0.689
Validation loss decreased (inf --> -0.688882).  Saving model ...
Epoch: 2 cost time: 1.9485342502593994
Epoch: 2, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.432 Vali Acc: 0.783 Test Loss: 0.432 Test Acc: 0.783
Validation loss decreased (-0.688882 --> -0.783329).  Saving model ...
Epoch: 3 cost time: 1.9106545448303223
Epoch: 3, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.428 Vali Acc: 0.811 Test Loss: 0.428 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 4 cost time: 1.9266533851623535
Epoch: 4, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.292 Vali Acc: 0.833 Test Loss: 0.292 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 5 cost time: 1.7219491004943848
Epoch: 5, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 1.785332202911377
Epoch: 6, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7254481315612793
Epoch: 7, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.690 Vali Acc: 0.811 Test Loss: 0.690 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7540733814239502
Epoch: 8, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.849996 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.8823528289794922
Epoch: 9, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.820542335510254
Epoch: 10, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.959 Vali Acc: 0.839 Test Loss: 0.959 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8124876022338867
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.857 Vali Acc: 0.828 Test Loss: 0.857 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9632775783538818
Epoch: 12, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.836 Vali Acc: 0.839 Test Loss: 0.836 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8930368423461914
Epoch: 13, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.367 Vali Acc: 0.872 Test Loss: 0.367 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.95949387550354
Epoch: 14, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9381811618804932
Epoch: 15, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.463 Vali Acc: 0.883 Test Loss: 0.463 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8933064937591553
Epoch: 16, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.948580026626587
Epoch: 17, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.019521951675415
Epoch: 18, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 4229894
model size : 16.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0294182300567627
Epoch: 1, Steps: 12 | Train Loss: 1.315 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
Validation loss decreased (inf --> -0.722214).  Saving model ...
Epoch: 2 cost time: 1.6152567863464355
Epoch: 2, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
Validation loss decreased (-0.722214 --> -0.805551).  Saving model ...
Epoch: 3 cost time: 1.656810998916626
Epoch: 3, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 4 cost time: 1.6567473411560059
Epoch: 4, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.71439790725708
Epoch: 5, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.344 Vali Acc: 0.839 Test Loss: 0.344 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 6 cost time: 1.7611134052276611
Epoch: 6, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.398 Vali Acc: 0.828 Test Loss: 0.398 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6792399883270264
Epoch: 7, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 1.9075262546539307
Epoch: 8, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.391 Vali Acc: 0.878 Test Loss: 0.391 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 9 cost time: 1.8878765106201172
Epoch: 9, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8696842193603516
Epoch: 10, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 1.8765177726745605
Epoch: 11, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.8823599815368652
Epoch: 12, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8369956016540527
Epoch: 13, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8667151927947998
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.525 Vali Acc: 0.883 Test Loss: 0.525 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.84993577003479
Epoch: 15, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8714988231658936
Epoch: 16, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8583002090454102
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7105932235717773
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.472 Vali Acc: 0.867 Test Loss: 0.472 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6506407260894775
Epoch: 19, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.431 Vali Acc: 0.894 Test Loss: 0.431 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5602467060089111
Epoch: 20, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6265530586242676
Epoch: 21, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 4046086
model size : 15.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.025009870529175
Epoch: 1, Steps: 12 | Train Loss: 1.392 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
Validation loss decreased (inf --> -0.711102).  Saving model ...
Epoch: 2 cost time: 1.739297866821289
Epoch: 2, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.486 Vali Acc: 0.761 Test Loss: 0.486 Test Acc: 0.761
Validation loss decreased (-0.711102 --> -0.761106).  Saving model ...
Epoch: 3 cost time: 1.7476787567138672
Epoch: 3, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.556 Vali Acc: 0.772 Test Loss: 0.556 Test Acc: 0.772
Validation loss decreased (-0.761106 --> -0.772217).  Saving model ...
Epoch: 4 cost time: 1.6956334114074707
Epoch: 4, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.438 Vali Acc: 0.783 Test Loss: 0.438 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.5969674587249756
Epoch: 5, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.783329 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.7369155883789062
Epoch: 6, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.329 Vali Acc: 0.822 Test Loss: 0.329 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.670933723449707
Epoch: 7, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6964092254638672
Epoch: 8, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7350056171417236
Epoch: 9, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.333 Vali Acc: 0.839 Test Loss: 0.333 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7688548564910889
Epoch: 10, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.334 Vali Acc: 0.822 Test Loss: 0.334 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6800816059112549
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866661).  Saving model ...
Epoch: 12 cost time: 1.6888542175292969
Epoch: 12, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4284985065460205
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5353612899780273
Epoch: 14, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4184966087341309
Epoch: 15, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 1.4932475090026855
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5583393573760986
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6358451843261719
Epoch: 18, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.335 Vali Acc: 0.872 Test Loss: 0.335 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6863534450531006
Epoch: 19, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 1.723728895187378
Epoch: 20, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 1.734750747680664
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6849565505981445
Epoch: 22, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.7517383098602295
Epoch: 23, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7207951545715332
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.894 Test Loss: 0.264 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.763533592224121
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7096209526062012
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.700727939605713
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6855504512786865
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7720627784729004
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.548234462738037
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5816726684570312
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 32 cost time: 1.2514495849609375
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5370070934295654
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.878 Test Loss: 0.255 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4404311180114746
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5306675434112549
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4472970962524414
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6448400020599365
Epoch: 37, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7402002811431885
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7463304996490479
Epoch: 39, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 40 cost time: 1.7659049034118652
Epoch: 40, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.82796049118042
Epoch: 41, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8273818492889404
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7816674709320068
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7472398281097412
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.900 Test Loss: 0.243 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7408370971679688
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.7472968101501465
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7863655090332031
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.7711272239685059
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.6505415439605713
Epoch: 49, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.883 Test Loss: 0.424 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 3899398
model size : 14.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.102041721343994
Epoch: 1, Steps: 12 | Train Loss: 1.567 Vali Loss: 0.967 Vali Acc: 0.683 Test Loss: 0.967 Test Acc: 0.683
Validation loss decreased (inf --> -0.683324).  Saving model ...
Epoch: 2 cost time: 1.5979969501495361
Epoch: 2, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.538 Vali Acc: 0.772 Test Loss: 0.538 Test Acc: 0.772
Validation loss decreased (-0.683324 --> -0.772217).  Saving model ...
Epoch: 3 cost time: 1.6327431201934814
Epoch: 3, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.377 Vali Acc: 0.822 Test Loss: 0.377 Test Acc: 0.822
Validation loss decreased (-0.772217 --> -0.822218).  Saving model ...
Epoch: 4 cost time: 1.7614436149597168
Epoch: 4, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7392642498016357
Epoch: 5, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861108).  Saving model ...
Epoch: 6 cost time: 1.7426836490631104
Epoch: 6, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.285 Vali Acc: 0.839 Test Loss: 0.285 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7939207553863525
Epoch: 7, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7352440357208252
Epoch: 8, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7288448810577393
Epoch: 9, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.7971677780151367
Epoch: 10, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7046570777893066
Epoch: 11, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7432196140289307
Epoch: 12, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7793841361999512
Epoch: 13, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.271 Vali Acc: 0.867 Test Loss: 0.271 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 14 cost time: 1.6613450050354004
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 1.7487611770629883
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.877774 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 1.8246824741363525
Epoch: 16, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.426 Vali Acc: 0.894 Test Loss: 0.426 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.580460548400879
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7034475803375244
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6463706493377686
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.215 Vali Acc: 0.894 Test Loss: 0.215 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6017916202545166
Epoch: 20, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6792659759521484
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 1.7981925010681152
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 1.807389259338379
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.801546335220337
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9398133754730225
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.855698585510254
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.826521396636963
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7431926727294922
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7804040908813477
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7880995273590088
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7765614986419678
Epoch: 31, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7493259906768799
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 3863046
model size : 14.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9455268383026123
Epoch: 1, Steps: 12 | Train Loss: 1.196 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
Validation loss decreased (inf --> -0.716661).  Saving model ...
Epoch: 2 cost time: 1.6461477279663086
Epoch: 2, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.469 Vali Acc: 0.772 Test Loss: 0.469 Test Acc: 0.772
Validation loss decreased (-0.716661 --> -0.772218).  Saving model ...
Epoch: 3 cost time: 1.6916389465332031
Epoch: 3, Steps: 12 | Train Loss: 0.891 Vali Loss: 0.749 Vali Acc: 0.756 Test Loss: 0.749 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.947927713394165
Epoch: 4, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.852 Vali Acc: 0.772 Test Loss: 0.852 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9665720462799072
Epoch: 5, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.769 Vali Acc: 0.811 Test Loss: 0.769 Test Acc: 0.811
Validation loss decreased (-0.772218 --> -0.811103).  Saving model ...
Epoch: 6 cost time: 2.0481269359588623
Epoch: 6, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.642 Vali Acc: 0.794 Test Loss: 0.642 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9086346626281738
Epoch: 7, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.881 Vali Acc: 0.856 Test Loss: 0.881 Test Acc: 0.856
Validation loss decreased (-0.811103 --> -0.855547).  Saving model ...
Epoch: 8 cost time: 1.858593463897705
Epoch: 8, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.774 Vali Acc: 0.817 Test Loss: 0.774 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.905484676361084
Epoch: 9, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.567 Vali Acc: 0.750 Test Loss: 1.567 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7952048778533936
Epoch: 10, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.899 Vali Acc: 0.833 Test Loss: 0.899 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8367516994476318
Epoch: 11, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
Validation loss decreased (-0.855547 --> -0.872218).  Saving model ...
Epoch: 12 cost time: 1.6503417491912842
Epoch: 12, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.960 Vali Acc: 0.867 Test Loss: 0.960 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9084088802337646
Epoch: 13, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.748 Vali Acc: 0.867 Test Loss: 0.748 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9639112949371338
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 1.355 Vali Acc: 0.850 Test Loss: 1.355 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8787355422973633
Epoch: 15, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.833 Vali Acc: 0.861 Test Loss: 0.833 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9098362922668457
Epoch: 16, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.579 Vali Acc: 0.911 Test Loss: 0.579 Test Acc: 0.911
Validation loss decreased (-0.872218 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 1.777500867843628
Epoch: 17, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.386 Vali Acc: 0.828 Test Loss: 1.386 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6857612133026123
Epoch: 18, Steps: 12 | Train Loss: 0.323 Vali Loss: 1.768 Vali Acc: 0.789 Test Loss: 1.768 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7251925468444824
Epoch: 19, Steps: 12 | Train Loss: 0.324 Vali Loss: 1.151 Vali Acc: 0.811 Test Loss: 1.151 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7350678443908691
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.469 Vali Acc: 0.839 Test Loss: 1.469 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6434361934661865
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 2.535 Vali Acc: 0.794 Test Loss: 2.535 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9174697399139404
Epoch: 22, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.936 Vali Acc: 0.856 Test Loss: 0.936 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8711907863616943
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.458 Vali Acc: 0.844 Test Loss: 1.458 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0637826919555664
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.129 Vali Acc: 0.878 Test Loss: 1.129 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9755809307098389
Epoch: 25, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.317 Vali Acc: 0.850 Test Loss: 1.317 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9272937774658203
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.328 Vali Acc: 0.878 Test Loss: 1.328 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1954694
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8229947090148926
Epoch: 1, Steps: 12 | Train Loss: 1.283 Vali Loss: 0.763 Vali Acc: 0.706 Test Loss: 0.763 Test Acc: 0.706
Validation loss decreased (inf --> -0.705548).  Saving model ...
Epoch: 2 cost time: 1.7503390312194824
Epoch: 2, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.448 Vali Acc: 0.761 Test Loss: 0.448 Test Acc: 0.761
Validation loss decreased (-0.705548 --> -0.761107).  Saving model ...
Epoch: 3 cost time: 1.732924461364746
Epoch: 3, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.373 Vali Acc: 0.794 Test Loss: 0.373 Test Acc: 0.794
Validation loss decreased (-0.761107 --> -0.794441).  Saving model ...
Epoch: 4 cost time: 1.6685192584991455
Epoch: 4, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.641 Vali Acc: 0.822 Test Loss: 0.641 Test Acc: 0.822
Validation loss decreased (-0.794441 --> -0.822216).  Saving model ...
Epoch: 5 cost time: 1.8256936073303223
Epoch: 5, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833330).  Saving model ...
Epoch: 6 cost time: 1.5617058277130127
Epoch: 6, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.475 Vali Acc: 0.828 Test Loss: 0.475 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.620772123336792
Epoch: 7, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.497 Vali Acc: 0.806 Test Loss: 0.497 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5361218452453613
Epoch: 8, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5955686569213867
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844440).  Saving model ...
Epoch: 10 cost time: 1.5537042617797852
Epoch: 10, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872216).  Saving model ...
Epoch: 11 cost time: 1.8127472400665283
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8271687030792236
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8749351501464844
Epoch: 13, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.837735891342163
Epoch: 14, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
Validation loss decreased (-0.872216 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 1.7962350845336914
Epoch: 15, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.854 Vali Acc: 0.833 Test Loss: 0.854 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7977488040924072
Epoch: 16, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.407 Vali Acc: 0.872 Test Loss: 0.407 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8237099647521973
Epoch: 17, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.709 Vali Acc: 0.839 Test Loss: 0.709 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7614657878875732
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.745 Vali Acc: 0.856 Test Loss: 0.745 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7903928756713867
Epoch: 19, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8025381565093994
Epoch: 20, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7820549011230469
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6863040924072266
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7590150833129883
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7635161876678467
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.872 Test Loss: 0.469 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1475590
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.148101806640625
Epoch: 1, Steps: 12 | Train Loss: 1.380 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
Validation loss decreased (inf --> -0.749992).  Saving model ...
Epoch: 2 cost time: 1.7334234714508057
Epoch: 2, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.473 Vali Acc: 0.756 Test Loss: 0.473 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755551).  Saving model ...
Epoch: 3 cost time: 1.8189635276794434
Epoch: 3, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.428 Vali Acc: 0.800 Test Loss: 0.428 Test Acc: 0.800
Validation loss decreased (-0.755551 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 1.7673139572143555
Epoch: 4, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 5 cost time: 1.8177733421325684
Epoch: 5, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.72271728515625
Epoch: 6, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.431 Vali Acc: 0.850 Test Loss: 0.431 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849996).  Saving model ...
Epoch: 7 cost time: 1.7748150825500488
Epoch: 7, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7549853324890137
Epoch: 8, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.377 Vali Acc: 0.883 Test Loss: 0.377 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 9 cost time: 1.7371392250061035
Epoch: 9, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7334322929382324
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.814781904220581
Epoch: 11, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8999667167663574
Epoch: 12, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 1.73270845413208
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.750 Vali Acc: 0.817 Test Loss: 0.750 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8011367321014404
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6370148658752441
Epoch: 15, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.840 Vali Acc: 0.811 Test Loss: 0.840 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7099571228027344
Epoch: 16, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.867 Vali Acc: 0.822 Test Loss: 0.867 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5776004791259766
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.504 Vali Acc: 0.878 Test Loss: 0.504 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5851142406463623
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.678 Vali Acc: 0.822 Test Loss: 0.678 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5334198474884033
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6857399940490723
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.821 Vali Acc: 0.856 Test Loss: 0.821 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.746546745300293
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.611 Vali Acc: 0.867 Test Loss: 0.611 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7581608295440674
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1475718
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.884009838104248
Epoch: 1, Steps: 12 | Train Loss: 1.403 Vali Loss: 0.900 Vali Acc: 0.711 Test Loss: 0.900 Test Acc: 0.711
Validation loss decreased (inf --> -0.711102).  Saving model ...
Epoch: 2 cost time: 1.703395128250122
Epoch: 2, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.547 Vali Acc: 0.739 Test Loss: 0.547 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738883).  Saving model ...
Epoch: 3 cost time: 1.7098262310028076
Epoch: 3, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.452 Vali Acc: 0.778 Test Loss: 0.452 Test Acc: 0.778
Validation loss decreased (-0.738883 --> -0.777773).  Saving model ...
Epoch: 4 cost time: 1.7578673362731934
Epoch: 4, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.413 Vali Acc: 0.817 Test Loss: 0.413 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816663).  Saving model ...
Epoch: 5 cost time: 1.6944959163665771
Epoch: 5, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 1.7550294399261475
Epoch: 6, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.425 Vali Acc: 0.817 Test Loss: 0.425 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6507596969604492
Epoch: 7, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.615980863571167
Epoch: 8, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6113216876983643
Epoch: 9, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6262316703796387
Epoch: 10, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
Validation loss decreased (-0.849995 --> -0.883330).  Saving model ...
Epoch: 11 cost time: 1.5382084846496582
Epoch: 11, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.288 Vali Acc: 0.844 Test Loss: 0.288 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5475316047668457
Epoch: 12, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.319 Vali Acc: 0.878 Test Loss: 0.319 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4588260650634766
Epoch: 13, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 1.5702288150787354
Epoch: 14, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.577709436416626
Epoch: 15, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8005883693695068
Epoch: 16, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.323 Vali Acc: 0.867 Test Loss: 0.323 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.856931209564209
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 1.7066903114318848
Epoch: 18, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7233831882476807
Epoch: 19, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.799267053604126
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.811439037322998
Epoch: 21, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7239787578582764
Epoch: 22, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.397 Vali Acc: 0.878 Test Loss: 0.397 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8563191890716553
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7921204566955566
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.346 Vali Acc: 0.906 Test Loss: 0.346 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7114875316619873
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6397953033447266
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6394116878509521
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1328518
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.789365291595459
Epoch: 1, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.011 Vali Acc: 0.717 Test Loss: 1.011 Test Acc: 0.717
Validation loss decreased (inf --> -0.716657).  Saving model ...
Epoch: 2 cost time: 1.564671277999878
Epoch: 2, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.539 Vali Acc: 0.756 Test Loss: 0.539 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755550).  Saving model ...
Epoch: 3 cost time: 1.5725617408752441
Epoch: 3, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.504 Vali Acc: 0.750 Test Loss: 0.504 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6905817985534668
Epoch: 4, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.427 Vali Acc: 0.817 Test Loss: 0.427 Test Acc: 0.817
Validation loss decreased (-0.755550 --> -0.816662).  Saving model ...
Epoch: 5 cost time: 1.769425868988037
Epoch: 5, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.405 Vali Acc: 0.806 Test Loss: 0.405 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8121719360351562
Epoch: 6, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 1.696150541305542
Epoch: 7, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 8 cost time: 1.871142864227295
Epoch: 8, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.311 Vali Acc: 0.828 Test Loss: 0.311 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 9 cost time: 1.8274338245391846
Epoch: 9, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.314 Vali Acc: 0.822 Test Loss: 0.314 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8428905010223389
Epoch: 10, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.827775 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 1.784282922744751
Epoch: 11, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8068082332611084
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.8286261558532715
Epoch: 13, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.4844696521759033
Epoch: 14, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7056212425231934
Epoch: 15, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.358 Vali Acc: 0.883 Test Loss: 0.358 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.623655080795288
Epoch: 16, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.72214674949646
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5402171611785889
Epoch: 18, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5683445930480957
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5609018802642822
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6032207012176514
Epoch: 21, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7947001457214355
Epoch: 22, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.323 Vali Acc: 0.883 Test Loss: 0.323 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7668421268463135
Epoch: 23, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 1236614
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0849573612213135
Epoch: 1, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.236 Vali Acc: 0.678 Test Loss: 1.236 Test Acc: 0.678
Validation loss decreased (inf --> -0.677765).  Saving model ...
Epoch: 2 cost time: 1.719161033630371
Epoch: 2, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.644 Vali Acc: 0.728 Test Loss: 0.644 Test Acc: 0.728
Validation loss decreased (-0.677765 --> -0.727771).  Saving model ...
Epoch: 3 cost time: 1.7072389125823975
Epoch: 3, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
Validation loss decreased (-0.727771 --> -0.788884).  Saving model ...
Epoch: 4 cost time: 1.643399715423584
Epoch: 4, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822219).  Saving model ...
Epoch: 5 cost time: 1.5414350032806396
Epoch: 5, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 1.5465829372406006
Epoch: 6, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.352 Vali Acc: 0.817 Test Loss: 0.352 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6364948749542236
Epoch: 7, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 8 cost time: 1.5529868602752686
Epoch: 8, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5799908638000488
Epoch: 9, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.496551513671875
Epoch: 10, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 11 cost time: 1.4615771770477295
Epoch: 11, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5225765705108643
Epoch: 12, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5543434619903564
Epoch: 13, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.373 Vali Acc: 0.878 Test Loss: 0.373 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5724682807922363
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.306 Vali Acc: 0.844 Test Loss: 0.306 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7170581817626953
Epoch: 15, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6354882717132568
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6706883907318115
Epoch: 17, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.271 Vali Acc: 0.856 Test Loss: 0.271 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6238102912902832
Epoch: 18, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.710395336151123
Epoch: 19, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.6632485389709473
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.6648907661437988
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.272 Vali Acc: 0.883 Test Loss: 0.272 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.684154748916626
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.7331929206848145
Epoch: 23, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.684168815612793
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 1.252854824066162
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5333685874938965
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6154804229736328
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.594238042831421
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5392467975616455
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.906 Test Loss: 0.226 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4532575607299805
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5187654495239258
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5494368076324463
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 1.6155388355255127
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6613729000091553
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6764800548553467
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 36 cost time: 1.6742985248565674
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6545474529266357
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6730384826660156
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7286112308502197
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.624950647354126
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.651045799255371
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.7085070610046387
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 43 cost time: 1.664670467376709
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.911 Test Loss: 0.212 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 44 cost time: 1.5495967864990234
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5700323581695557
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.621279001235962
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5551259517669678
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6563010215759277
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 1.4687955379486084
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.900 Test Loss: 0.206 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5186471939086914
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1163270
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.921682834625244
Epoch: 1, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.213 Vali Acc: 0.667 Test Loss: 1.213 Test Acc: 0.667
Validation loss decreased (inf --> -0.666655).  Saving model ...
Epoch: 2 cost time: 1.658172607421875
Epoch: 2, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.651 Vali Acc: 0.733 Test Loss: 0.651 Test Acc: 0.733
Validation loss decreased (-0.666655 --> -0.733327).  Saving model ...
Epoch: 3 cost time: 1.6601440906524658
Epoch: 3, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
Validation loss decreased (-0.733327 --> -0.783328).  Saving model ...
Epoch: 4 cost time: 1.7292263507843018
Epoch: 4, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.442 Vali Acc: 0.767 Test Loss: 0.442 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.797715187072754
Epoch: 5, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
Validation loss decreased (-0.783328 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.6506786346435547
Epoch: 6, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.332 Vali Acc: 0.839 Test Loss: 0.332 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 7 cost time: 1.7379908561706543
Epoch: 7, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6557464599609375
Epoch: 8, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855553).  Saving model ...
Epoch: 9 cost time: 1.5690295696258545
Epoch: 9, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5530750751495361
Epoch: 10, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.492870807647705
Epoch: 11, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 1.5493004322052002
Epoch: 12, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.261 Vali Acc: 0.844 Test Loss: 0.261 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.574122428894043
Epoch: 13, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.6662695407867432
Epoch: 14, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.5344350337982178
Epoch: 15, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 1.449761152267456
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.465085506439209
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5350382328033447
Epoch: 18, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 19 cost time: 1.5493505001068115
Epoch: 19, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5332274436950684
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4205458164215088
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3478991985321045
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.328906536102295
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 1.4538207054138184
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.236 Vali Acc: 0.878 Test Loss: 0.236 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5577964782714844
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.900 Test Loss: 0.233 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7949373722076416
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.8017528057098389
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7762057781219482
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.231 Vali Acc: 0.883 Test Loss: 0.231 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7291748523712158
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6829335689544678
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.889 Test Loss: 0.216 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7027812004089355
Epoch: 31, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6973960399627686
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 33 cost time: 1.6072752475738525
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5673127174377441
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.301 Vali Acc: 0.867 Test Loss: 0.301 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5799148082733154
Epoch: 35, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.547602891921997
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5523641109466553
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5501618385314941
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4537475109100342
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3812780380249023
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922219).  Saving model ...
Epoch: 41 cost time: 1.3203802108764648
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3387115001678467
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5279052257537842
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6794054508209229
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 1.710219383239746
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7046260833740234
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7146375179290771
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.552074670791626
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.911 Test Loss: 0.205 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5952403545379639
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.6120374202728271
Epoch: 50, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1145094
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6985323429107666
Epoch: 1, Steps: 12 | Train Loss: 1.382 Vali Loss: 0.780 Vali Acc: 0.656 Test Loss: 0.780 Test Acc: 0.656
Validation loss decreased (inf --> -0.655548).  Saving model ...
Epoch: 2 cost time: 1.2111327648162842
Epoch: 2, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
Validation loss decreased (-0.655548 --> -0.716661).  Saving model ...
Epoch: 3 cost time: 1.2743723392486572
Epoch: 3, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
Validation loss decreased (-0.716661 --> -0.833330).  Saving model ...
Epoch: 4 cost time: 1.0443177223205566
Epoch: 4, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2036528587341309
Epoch: 5, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2550957202911377
Epoch: 6, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.411 Vali Acc: 0.817 Test Loss: 0.411 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3141465187072754
Epoch: 7, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855550).  Saving model ...
Epoch: 8 cost time: 1.2759664058685303
Epoch: 8, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4537222385406494
Epoch: 9, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.398 Vali Acc: 0.856 Test Loss: 0.398 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 1.3754515647888184
Epoch: 10, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3514735698699951
Epoch: 11, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.376504898071289
Epoch: 12, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4653356075286865
Epoch: 13, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.381 Vali Acc: 0.844 Test Loss: 0.381 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4701285362243652
Epoch: 14, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 1.3742382526397705
Epoch: 15, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.380 Vali Acc: 0.856 Test Loss: 0.380 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4561538696289062
Epoch: 16, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4775896072387695
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877773).  Saving model ...
Epoch: 18 cost time: 1.462449550628662
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4650375843048096
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2366468906402588
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.390 Vali Acc: 0.878 Test Loss: 0.390 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 21 cost time: 1.2799334526062012
Epoch: 21, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2527949810028076
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 23 cost time: 1.277435302734375
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.419 Vali Acc: 0.856 Test Loss: 0.419 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1717536449432373
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 25 cost time: 1.2030515670776367
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.883329 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.2780718803405762
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.2650971412658691
Epoch: 27, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3302626609802246
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.894 Test Loss: 0.362 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3960599899291992
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.894 Test Loss: 0.368 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4871673583984375
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3870444297790527
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4244592189788818
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4500784873962402
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5170063972473145
Epoch: 34, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4973106384277344
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3997504711151123
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 780742
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5721917152404785
Epoch: 1, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.031 Vali Acc: 0.700 Test Loss: 1.031 Test Acc: 0.700
Validation loss decreased (inf --> -0.699990).  Saving model ...
Epoch: 2 cost time: 1.1051971912384033
Epoch: 2, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.590 Vali Acc: 0.733 Test Loss: 0.590 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733327).  Saving model ...
Epoch: 3 cost time: 1.2602126598358154
Epoch: 3, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
Validation loss decreased (-0.733327 --> -0.827774).  Saving model ...
Epoch: 4 cost time: 1.313720703125
Epoch: 4, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.261258602142334
Epoch: 5, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 6 cost time: 1.2061784267425537
Epoch: 6, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.325 Vali Acc: 0.828 Test Loss: 0.325 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2869186401367188
Epoch: 7, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.307 Vali Acc: 0.828 Test Loss: 0.307 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1898362636566162
Epoch: 8, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.321 Vali Acc: 0.856 Test Loss: 0.321 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1452422142028809
Epoch: 9, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.374 Vali Acc: 0.872 Test Loss: 0.374 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872218).  Saving model ...
Epoch: 10 cost time: 1.2473695278167725
Epoch: 10, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3450229167938232
Epoch: 11, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2867891788482666
Epoch: 12, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2784106731414795
Epoch: 13, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.360 Vali Acc: 0.883 Test Loss: 0.360 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.278318166732788
Epoch: 14, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.317 Vali Acc: 0.878 Test Loss: 0.317 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3363704681396484
Epoch: 15, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.377 Vali Acc: 0.872 Test Loss: 0.377 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3426034450531006
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2310972213745117
Epoch: 17, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.351 Vali Acc: 0.856 Test Loss: 0.351 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2553930282592773
Epoch: 18, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.387441635131836
Epoch: 19, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 1.197096347808838
Epoch: 20, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.288 Vali Acc: 0.883 Test Loss: 0.288 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.1438570022583008
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 1.236297845840454
Epoch: 22, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 1.2089390754699707
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.2482004165649414
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2618000507354736
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2073984146118164
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 1.125389814376831
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.24363374710083
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2539641857147217
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2393617630004883
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2064805030822754
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2864844799041748
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2799177169799805
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2646522521972656
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2150938510894775
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.334458827972412
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 541190
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3336551189422607
Epoch: 1, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.020 Vali Acc: 0.722 Test Loss: 1.020 Test Acc: 0.722
Validation loss decreased (inf --> -0.722212).  Saving model ...
Epoch: 2 cost time: 1.1315813064575195
Epoch: 2, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.722212 --> -0.783328).  Saving model ...
Epoch: 3 cost time: 1.2029752731323242
Epoch: 3, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.431 Vali Acc: 0.789 Test Loss: 0.431 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788885).  Saving model ...
Epoch: 4 cost time: 1.0675737857818604
Epoch: 4, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.381 Vali Acc: 0.794 Test Loss: 0.381 Test Acc: 0.794
Validation loss decreased (-0.788885 --> -0.794441).  Saving model ...
Epoch: 5 cost time: 1.2161638736724854
Epoch: 5, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
Validation loss decreased (-0.794441 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 1.1658329963684082
Epoch: 6, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 1.2731554508209229
Epoch: 7, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855551).  Saving model ...
Epoch: 8 cost time: 1.294351577758789
Epoch: 8, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.183762788772583
Epoch: 9, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 1.2726197242736816
Epoch: 10, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3026924133300781
Epoch: 11, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.346 Vali Acc: 0.872 Test Loss: 0.346 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1288831233978271
Epoch: 12, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.321 Vali Acc: 0.844 Test Loss: 0.321 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1524271965026855
Epoch: 13, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.348 Vali Acc: 0.883 Test Loss: 0.348 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 1.2406699657440186
Epoch: 14, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 1.3853628635406494
Epoch: 15, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.285 Vali Acc: 0.850 Test Loss: 0.285 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3299155235290527
Epoch: 16, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.274867057800293
Epoch: 17, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2687206268310547
Epoch: 18, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.3351843357086182
Epoch: 19, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1779577732086182
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.24342942237854
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2961673736572266
Epoch: 22, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.254720687866211
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2489345073699951
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1715912818908691
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2223975658416748
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 1.1037218570709229
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.153270959854126
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1842679977416992
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.2501976490020752
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3388855457305908
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2416973114013672
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2474861145019531
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2459018230438232
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3103618621826172
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2847819328308105
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.271796464920044
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2128818035125732
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.906 Test Loss: 0.264 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2283329963684082
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 541254
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.640747547149658
Epoch: 1, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.152 Vali Acc: 0.694 Test Loss: 1.152 Test Acc: 0.694
Validation loss decreased (inf --> -0.694433).  Saving model ...
Epoch: 2 cost time: 1.1579625606536865
Epoch: 2, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716661).  Saving model ...
Epoch: 3 cost time: 1.168123722076416
Epoch: 3, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.465 Vali Acc: 0.794 Test Loss: 0.465 Test Acc: 0.794
Validation loss decreased (-0.716661 --> -0.794440).  Saving model ...
Epoch: 4 cost time: 1.0724766254425049
Epoch: 4, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.461 Vali Acc: 0.772 Test Loss: 0.461 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.052062749862671
Epoch: 5, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.469 Vali Acc: 0.794 Test Loss: 0.469 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0003972053527832
Epoch: 6, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.525 Vali Acc: 0.794 Test Loss: 0.525 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.011744499206543
Epoch: 7, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.426 Vali Acc: 0.789 Test Loss: 0.426 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1369407176971436
Epoch: 8, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.419 Vali Acc: 0.817 Test Loss: 0.419 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816662).  Saving model ...
Epoch: 9 cost time: 1.0922696590423584
Epoch: 9, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.329 Vali Acc: 0.861 Test Loss: 0.329 Test Acc: 0.861
Validation loss decreased (-0.816662 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 1.1407575607299805
Epoch: 10, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1133694648742676
Epoch: 11, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.316 Vali Acc: 0.833 Test Loss: 0.316 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.159538745880127
Epoch: 12, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.1100187301635742
Epoch: 13, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.320 Vali Acc: 0.822 Test Loss: 0.320 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2067549228668213
Epoch: 14, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2322361469268799
Epoch: 15, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.284 Vali Acc: 0.839 Test Loss: 0.284 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1624755859375
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2336325645446777
Epoch: 17, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.064643144607544
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1026437282562256
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.268 Vali Acc: 0.850 Test Loss: 0.268 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.108253002166748
Epoch: 20, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1580770015716553
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.1798131465911865
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.264 Vali Acc: 0.850 Test Loss: 0.264 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2148277759552002
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.2556860446929932
Epoch: 24, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1933789253234863
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 1.1584796905517578
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1336607933044434
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 1.0957517623901367
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.272 Vali Acc: 0.872 Test Loss: 0.272 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1050961017608643
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 30 cost time: 1.0688681602478027
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1399054527282715
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1019744873046875
Epoch: 32, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1136798858642578
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.894 Test Loss: 0.262 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1269598007202148
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2113080024719238
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2147021293640137
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.286442756652832
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.076723575592041
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 39 cost time: 1.1275203227996826
Epoch: 39, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1181066036224365
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 41 cost time: 1.1626169681549072
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.107356071472168
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1537046432495117
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1824615001678467
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.906 Test Loss: 0.255 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1522243022918701
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2456591129302979
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2457330226898193
Epoch: 47, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.190805435180664
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1105377674102783
Epoch: 49, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1349906921386719
Epoch: 50, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 467654
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.238339900970459
Epoch: 1, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.252 Vali Acc: 0.622 Test Loss: 1.252 Test Acc: 0.622
Validation loss decreased (inf --> -0.622210).  Saving model ...
Epoch: 2 cost time: 1.0628254413604736
Epoch: 2, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.683 Vali Acc: 0.711 Test Loss: 0.683 Test Acc: 0.711
Validation loss decreased (-0.622210 --> -0.711104).  Saving model ...
Epoch: 3 cost time: 1.0218546390533447
Epoch: 3, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
Validation loss decreased (-0.711104 --> -0.799995).  Saving model ...
Epoch: 4 cost time: 1.0033330917358398
Epoch: 4, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.420 Vali Acc: 0.822 Test Loss: 0.420 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 1.0362601280212402
Epoch: 5, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 1.0784237384796143
Epoch: 6, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.157438039779663
Epoch: 7, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.079498291015625
Epoch: 8, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.309 Vali Acc: 0.844 Test Loss: 0.309 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 1.141317367553711
Epoch: 9, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 10 cost time: 1.1243188381195068
Epoch: 10, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.045170545578003
Epoch: 11, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.151216745376587
Epoch: 12, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.1512398719787598
Epoch: 13, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0958685874938965
Epoch: 14, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.351 Vali Acc: 0.844 Test Loss: 0.351 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0703914165496826
Epoch: 15, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.1262593269348145
Epoch: 16, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0102331638336182
Epoch: 17, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0543365478515625
Epoch: 18, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.236 Vali Acc: 0.872 Test Loss: 0.236 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0179071426391602
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0105268955230713
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.9895565509796143
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0211987495422363
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.969820499420166
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1173651218414307
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1196997165679932
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0224218368530273
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1292424201965332
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0610885620117188
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0674686431884766
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0388543605804443
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 421702
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.408679723739624
Epoch: 1, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.472 Vali Acc: 0.606 Test Loss: 1.472 Test Acc: 0.606
Validation loss decreased (inf --> -0.605541).  Saving model ...
Epoch: 2 cost time: 1.103792667388916
Epoch: 2, Steps: 12 | Train Loss: 1.014 Vali Loss: 0.846 Vali Acc: 0.728 Test Loss: 0.846 Test Acc: 0.728
Validation loss decreased (-0.605541 --> -0.727769).  Saving model ...
Epoch: 3 cost time: 1.0068292617797852
Epoch: 3, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.597 Vali Acc: 0.772 Test Loss: 0.597 Test Acc: 0.772
Validation loss decreased (-0.727769 --> -0.772216).  Saving model ...
Epoch: 4 cost time: 0.9869256019592285
Epoch: 4, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.477 Vali Acc: 0.772 Test Loss: 0.477 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 0.9145417213439941
Epoch: 5, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.414 Vali Acc: 0.783 Test Loss: 0.414 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 0.9352431297302246
Epoch: 6, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
Validation loss decreased (-0.783329 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 0.9437096118927002
Epoch: 7, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 0.9234442710876465
Epoch: 8, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 0.9502487182617188
Epoch: 9, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.915419340133667
Epoch: 10, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.927196741104126
Epoch: 11, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9621014595031738
Epoch: 12, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.320 Vali Acc: 0.867 Test Loss: 0.320 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 0.9106137752532959
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8965198993682861
Epoch: 14, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9804160594940186
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 0.886955738067627
Epoch: 16, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 0.9678764343261719
Epoch: 17, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.285 Vali Acc: 0.850 Test Loss: 0.285 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9752075672149658
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.0196843147277832
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 1.0325894355773926
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.284 Vali Acc: 0.878 Test Loss: 0.284 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.059736728668213
Epoch: 21, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.117882490158081
Epoch: 22, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.292 Vali Acc: 0.883 Test Loss: 0.292 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0674362182617188
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0000519752502441
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.867 Test Loss: 0.250 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.009253978729248
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 0.9993326663970947
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0390782356262207
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0085721015930176
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8543365001678467
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9418234825134277
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9250650405883789
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9748435020446777
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.878 Test Loss: 0.249 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9428014755249023
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8930566310882568
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 35 cost time: 1.0243816375732422
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 0.9668674468994141
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 37 cost time: 0.918194055557251
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.247 Vali Acc: 0.883 Test Loss: 0.247 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8876988887786865
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8040640354156494
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8789157867431641
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.883 Test Loss: 0.233 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8601677417755127
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.946556806564331
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9927878379821777
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 44 cost time: 0.8672747611999512
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.230 Vali Acc: 0.889 Test Loss: 0.230 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8120884895324707
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8485310077667236
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.906 Test Loss: 0.236 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 47 cost time: 0.8778152465820312
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 48 cost time: 0.8796248435974121
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 49 cost time: 0.8920347690582275
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9376907348632812
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.906 Test Loss: 0.214 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 385030
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2469875812530518
Epoch: 1, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.444 Vali Acc: 0.617 Test Loss: 1.444 Test Acc: 0.617
Validation loss decreased (inf --> -0.616652).  Saving model ...
Epoch: 2 cost time: 1.0408577919006348
Epoch: 2, Steps: 12 | Train Loss: 1.099 Vali Loss: 0.874 Vali Acc: 0.733 Test Loss: 0.874 Test Acc: 0.733
Validation loss decreased (-0.616652 --> -0.733325).  Saving model ...
Epoch: 3 cost time: 1.0217981338500977
Epoch: 3, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.607 Vali Acc: 0.767 Test Loss: 0.607 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 0.9762823581695557
Epoch: 4, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.494 Vali Acc: 0.767 Test Loss: 0.494 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 1.0068371295928955
Epoch: 5, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.430 Vali Acc: 0.817 Test Loss: 0.430 Test Acc: 0.817
Validation loss decreased (-0.766662 --> -0.816662).  Saving model ...
Epoch: 6 cost time: 1.026075839996338
Epoch: 6, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 1.06689453125
Epoch: 7, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0357451438903809
Epoch: 8, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.344 Vali Acc: 0.817 Test Loss: 0.344 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0379269123077393
Epoch: 9, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 1.0344982147216797
Epoch: 10, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.0299177169799805
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8811912536621094
Epoch: 12, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 0.99538254737854
Epoch: 13, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.996380090713501
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.288 Vali Acc: 0.856 Test Loss: 0.288 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9775612354278564
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.285 Vali Acc: 0.833 Test Loss: 0.285 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0010929107666016
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 1.0913562774658203
Epoch: 17, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.302 Vali Acc: 0.872 Test Loss: 0.302 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 1.0942511558532715
Epoch: 18, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0575425624847412
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.273 Vali Acc: 0.878 Test Loss: 0.273 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 1.1068341732025146
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 1.148242473602295
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.267 Vali Acc: 0.867 Test Loss: 0.267 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1407806873321533
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.126171588897705
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.262 Vali Acc: 0.856 Test Loss: 0.262 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0785791873931885
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0234363079071045
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 1.1474182605743408
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0042786598205566
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.349 Vali Acc: 0.894 Test Loss: 0.349 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8762619495391846
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9679570198059082
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.256 Vali Acc: 0.878 Test Loss: 0.256 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.032841682434082
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0338311195373535
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1279826164245605
Epoch: 32, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1468911170959473
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0500283241271973
Epoch: 34, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0429058074951172
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.878 Test Loss: 0.250 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 375942
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2573065757751465
Epoch: 1, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
Validation loss decreased (inf --> -0.749990).  Saving model ...
Epoch: 2 cost time: 1.159339189529419
Epoch: 2, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761106).  Saving model ...
Epoch: 3 cost time: 1.114349126815796
Epoch: 3, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.406 Vali Acc: 0.800 Test Loss: 0.406 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799996).  Saving model ...
Epoch: 4 cost time: 0.9624874591827393
Epoch: 4, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822218).  Saving model ...
Epoch: 5 cost time: 1.063206672668457
Epoch: 5, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838886).  Saving model ...
Epoch: 6 cost time: 1.097348928451538
Epoch: 6, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0433573722839355
Epoch: 7, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 1.0244321823120117
Epoch: 8, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0429887771606445
Epoch: 9, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.340 Vali Acc: 0.839 Test Loss: 0.340 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0007238388061523
Epoch: 10, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 1.033632755279541
Epoch: 11, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.0262231826782227
Epoch: 12, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 1.0248703956604004
Epoch: 13, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 1.0011627674102783
Epoch: 14, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.025632619857788
Epoch: 15, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0575363636016846
Epoch: 16, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0062739849090576
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.337 Vali Acc: 0.856 Test Loss: 0.337 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9443285465240479
Epoch: 18, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.329 Vali Acc: 0.844 Test Loss: 0.329 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9871659278869629
Epoch: 19, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.115272045135498
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0944290161132812
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.263 Vali Acc: 0.872 Test Loss: 0.263 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0447940826416016
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1181766986846924
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.1548516750335693
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.072432279586792
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.088083267211914
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0585694313049316
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.878 Test Loss: 0.236 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0497848987579346
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.992642879486084
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.878 Test Loss: 0.232 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0240025520324707
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 31 cost time: 1.0695013999938965
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0284090042114258
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0372047424316406
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9732091426849365
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.894 Test Loss: 0.248 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.001993179321289
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.894 Test Loss: 0.233 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.920889139175415
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9692847728729248
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0339686870574951
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.883 Test Loss: 0.256 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0656802654266357
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0464668273925781
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 341222
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3468525409698486
Epoch: 1, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.325 Vali Acc: 0.617 Test Loss: 1.325 Test Acc: 0.617
Validation loss decreased (inf --> -0.616653).  Saving model ...
Epoch: 2 cost time: 1.1353890895843506
Epoch: 2, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.757 Vali Acc: 0.700 Test Loss: 0.757 Test Acc: 0.700
Validation loss decreased (-0.616653 --> -0.699992).  Saving model ...
Epoch: 3 cost time: 1.0026304721832275
Epoch: 3, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.536 Vali Acc: 0.767 Test Loss: 0.536 Test Acc: 0.767
Validation loss decreased (-0.699992 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 1.0072710514068604
Epoch: 4, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.453 Vali Acc: 0.783 Test Loss: 0.453 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783329).  Saving model ...
Epoch: 5 cost time: 1.0185458660125732
Epoch: 5, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.417 Vali Acc: 0.822 Test Loss: 0.417 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822218).  Saving model ...
Epoch: 6 cost time: 1.0740110874176025
Epoch: 6, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.382 Vali Acc: 0.822 Test Loss: 0.382 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 1.076645851135254
Epoch: 7, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.417 Vali Acc: 0.822 Test Loss: 0.417 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9464597702026367
Epoch: 8, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.395 Vali Acc: 0.806 Test Loss: 0.395 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9702427387237549
Epoch: 9, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.364 Vali Acc: 0.822 Test Loss: 0.364 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 0.9349815845489502
Epoch: 10, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 1.0127627849578857
Epoch: 11, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.381 Vali Acc: 0.817 Test Loss: 0.381 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0140600204467773
Epoch: 12, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9078402519226074
Epoch: 13, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.323 Vali Acc: 0.872 Test Loss: 0.323 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 1.019723892211914
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0052084922790527
Epoch: 15, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.285 Vali Acc: 0.850 Test Loss: 0.285 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0018250942230225
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9766495227813721
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.303 Vali Acc: 0.828 Test Loss: 0.303 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.071136474609375
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0878655910491943
Epoch: 19, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.310 Vali Acc: 0.828 Test Loss: 0.310 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.121595859527588
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 1.17960786819458
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9578826427459717
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0768043994903564
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.286 Vali Acc: 0.872 Test Loss: 0.286 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 1.1256754398345947
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 1.0624783039093018
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0612592697143555
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 27 cost time: 1.0568311214447021
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 28 cost time: 1.0451483726501465
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9437515735626221
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0526857376098633
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.964019775390625
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.018559455871582
Epoch: 32, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.021740436553955
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9120326042175293
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.046720266342163
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.343 Vali Acc: 0.867 Test Loss: 0.343 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9746978282928467
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.883 Test Loss: 0.309 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.993227481842041
Epoch: 37, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 221446
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4182398319244385
Epoch: 1, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.284 Vali Acc: 0.650 Test Loss: 1.284 Test Acc: 0.650
Validation loss decreased (inf --> -0.649987).  Saving model ...
Epoch: 2 cost time: 1.0394716262817383
Epoch: 2, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.709 Vali Acc: 0.767 Test Loss: 0.709 Test Acc: 0.767
Validation loss decreased (-0.649987 --> -0.766660).  Saving model ...
Epoch: 3 cost time: 1.094895362854004
Epoch: 3, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.513 Vali Acc: 0.767 Test Loss: 0.513 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766662).  Saving model ...
Epoch: 4 cost time: 0.9989612102508545
Epoch: 4, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.457 Vali Acc: 0.789 Test Loss: 0.457 Test Acc: 0.789
Validation loss decreased (-0.766662 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 0.9199123382568359
Epoch: 5, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.439 Vali Acc: 0.778 Test Loss: 0.439 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.987654447555542
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.451 Vali Acc: 0.800 Test Loss: 0.451 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 0.9426805973052979
Epoch: 7, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 0.9253940582275391
Epoch: 8, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 0.807215690612793
Epoch: 9, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.033107042312622
Epoch: 10, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0002894401550293
Epoch: 11, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 1.0096464157104492
Epoch: 12, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0155410766601562
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.317 Vali Acc: 0.844 Test Loss: 0.317 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0062141418457031
Epoch: 14, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9847679138183594
Epoch: 15, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9054503440856934
Epoch: 16, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.283 Vali Acc: 0.872 Test Loss: 0.283 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 0.9553685188293457
Epoch: 17, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 0.9791810512542725
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.266 Vali Acc: 0.878 Test Loss: 0.266 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 1.054389476776123
Epoch: 19, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.270 Vali Acc: 0.867 Test Loss: 0.270 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.037377119064331
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0470571517944336
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9844233989715576
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.1151716709136963
Epoch: 23, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0026264190673828
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 1.018502950668335
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.281 Vali Acc: 0.856 Test Loss: 0.281 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0113258361816406
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9941341876983643
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0137417316436768
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.034391164779663
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1098425388336182
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0128462314605713
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.003777265548706
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.9432635307312012
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 34 cost time: 0.9720625877380371
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 35 cost time: 0.9002628326416016
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.906 Test Loss: 0.282 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0076911449432373
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9647026062011719
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 38 cost time: 0.9781785011291504
Epoch: 38, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9132614135742188
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9730603694915771
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.048518419265747
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.031254768371582
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0729575157165527
Epoch: 43, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8802266120910645
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.020796537399292
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0872957706451416
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0290114879608154
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.900 Test Loss: 0.239 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 221478
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4497947692871094
Epoch: 1, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.397 Vali Acc: 0.644 Test Loss: 1.397 Test Acc: 0.644
Validation loss decreased (inf --> -0.644430).  Saving model ...
Epoch: 2 cost time: 1.0525033473968506
Epoch: 2, Steps: 12 | Train Loss: 0.999 Vali Loss: 0.824 Vali Acc: 0.706 Test Loss: 0.824 Test Acc: 0.706
Validation loss decreased (-0.644430 --> -0.705547).  Saving model ...
Epoch: 3 cost time: 1.0918827056884766
Epoch: 3, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.577 Vali Acc: 0.767 Test Loss: 0.577 Test Acc: 0.767
Validation loss decreased (-0.705547 --> -0.766661).  Saving model ...
Epoch: 4 cost time: 0.9875485897064209
Epoch: 4, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 1.0306527614593506
Epoch: 5, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.424 Vali Acc: 0.800 Test Loss: 0.424 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 0.9885342121124268
Epoch: 6, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.394 Vali Acc: 0.800 Test Loss: 0.394 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 7 cost time: 0.9752616882324219
Epoch: 7, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
Validation loss decreased (-0.799996 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 1.0181121826171875
Epoch: 8, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9848105907440186
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.333 Vali Acc: 0.828 Test Loss: 0.333 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9855067729949951
Epoch: 10, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.336 Vali Acc: 0.800 Test Loss: 0.336 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0937004089355469
Epoch: 11, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1260662078857422
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 1.114914894104004
Epoch: 13, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.310 Vali Acc: 0.828 Test Loss: 0.310 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0765933990478516
Epoch: 14, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.315 Vali Acc: 0.844 Test Loss: 0.315 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1587247848510742
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.210742473602295
Epoch: 16, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0785000324249268
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.294 Vali Acc: 0.878 Test Loss: 0.294 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 1.034193515777588
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.276 Vali Acc: 0.861 Test Loss: 0.276 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0290498733520508
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0269396305084229
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0824902057647705
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 0.9883155822753906
Epoch: 22, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.309 Vali Acc: 0.844 Test Loss: 0.309 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0496125221252441
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 24 cost time: 1.0874199867248535
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1136581897735596
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.0581884384155273
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.1031792163848877
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.280 Vali Acc: 0.861 Test Loss: 0.280 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1257362365722656
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.076422929763794
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0455963611602783
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8906159400939941
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1028144359588623
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0903782844543457
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1143760681152344
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1360387802124023
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0347800254821777
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.861 Test Loss: 0.294 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 184678
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1667613983154297
Epoch: 1, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.501 Vali Acc: 0.539 Test Loss: 1.501 Test Acc: 0.539
Validation loss decreased (inf --> -0.538874).  Saving model ...
Epoch: 2 cost time: 0.8797032833099365
Epoch: 2, Steps: 12 | Train Loss: 1.157 Vali Loss: 0.982 Vali Acc: 0.661 Test Loss: 0.982 Test Acc: 0.661
Validation loss decreased (-0.538874 --> -0.661101).  Saving model ...
Epoch: 3 cost time: 1.0059657096862793
Epoch: 3, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.682 Vali Acc: 0.744 Test Loss: 0.682 Test Acc: 0.744
Validation loss decreased (-0.661101 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 1.003197193145752
Epoch: 4, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.554 Vali Acc: 0.794 Test Loss: 0.554 Test Acc: 0.794
Validation loss decreased (-0.744438 --> -0.794439).  Saving model ...
Epoch: 5 cost time: 1.0490381717681885
Epoch: 5, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.488 Vali Acc: 0.767 Test Loss: 0.488 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9799442291259766
Epoch: 6, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.450 Vali Acc: 0.794 Test Loss: 0.450 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 1.0096487998962402
Epoch: 7, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.403 Vali Acc: 0.806 Test Loss: 0.403 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 1.1025662422180176
Epoch: 8, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.382 Vali Acc: 0.800 Test Loss: 0.382 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0355517864227295
Epoch: 9, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 1.032895565032959
Epoch: 10, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.361 Vali Acc: 0.839 Test Loss: 0.361 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 0.9806721210479736
Epoch: 11, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.13352370262146
Epoch: 12, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.331 Vali Acc: 0.833 Test Loss: 0.331 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1111199855804443
Epoch: 13, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 14 cost time: 1.0237061977386475
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0222506523132324
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 16 cost time: 1.086237907409668
Epoch: 16, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
Validation loss decreased (-0.838886 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 1.115952730178833
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.0181009769439697
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.317 Vali Acc: 0.839 Test Loss: 0.317 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0673508644104004
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9491820335388184
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.314 Vali Acc: 0.872 Test Loss: 0.314 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 0.9688622951507568
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.085824728012085
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.305 Vali Acc: 0.839 Test Loss: 0.305 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0546135902404785
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 24 cost time: 1.091048240661621
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.089001178741455
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 1.024651288986206
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.987511157989502
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.295 Vali Acc: 0.878 Test Loss: 0.295 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0761244297027588
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0257165431976318
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.335 Vali Acc: 0.883 Test Loss: 0.335 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0773651599884033
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9696321487426758
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 32 cost time: 1.007112741470337
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9623837471008301
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0498449802398682
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1667892932891846
Epoch: 35, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0677967071533203
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.867 Test Loss: 0.280 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1790673732757568
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 1.0974993705749512
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.268 Vali Acc: 0.894 Test Loss: 0.268 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.138317584991455
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9553465843200684
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.015491008758545
Epoch: 41, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.009664535522461
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.001352071762085
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.249 Vali Acc: 0.878 Test Loss: 0.249 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.034705638885498
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0560576915740967
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.961085319519043
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9531781673431396
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 161702
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.102699041366577
Epoch: 1, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.647 Vali Acc: 0.317 Test Loss: 1.647 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 0.9666872024536133
Epoch: 2, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.165 Vali Acc: 0.633 Test Loss: 1.165 Test Acc: 0.633
Validation loss decreased (-0.316650 --> -0.633322).  Saving model ...
Epoch: 3 cost time: 0.9716365337371826
Epoch: 3, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.830 Vali Acc: 0.672 Test Loss: 0.830 Test Acc: 0.672
Validation loss decreased (-0.633322 --> -0.672214).  Saving model ...
Epoch: 4 cost time: 0.9818265438079834
Epoch: 4, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.659 Vali Acc: 0.739 Test Loss: 0.659 Test Acc: 0.739
Validation loss decreased (-0.672214 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 1.0663223266601562
Epoch: 5, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.567 Vali Acc: 0.744 Test Loss: 0.567 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 6 cost time: 1.0642962455749512
Epoch: 6, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
Validation loss decreased (-0.744439 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 1.060067892074585
Epoch: 7, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.452 Vali Acc: 0.772 Test Loss: 0.452 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.121460199356079
Epoch: 8, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.0830998420715332
Epoch: 9, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.402 Vali Acc: 0.811 Test Loss: 0.402 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0391058921813965
Epoch: 10, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.0001299381256104
Epoch: 11, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 1.0145952701568604
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.064626932144165
Epoch: 13, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.346 Vali Acc: 0.844 Test Loss: 0.346 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.049917459487915
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.030867576599121
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.1262075901031494
Epoch: 16, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.319 Vali Acc: 0.839 Test Loss: 0.319 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.028179407119751
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.315 Vali Acc: 0.833 Test Loss: 0.315 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9762711524963379
Epoch: 18, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9752886295318604
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 1.0029189586639404
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0156283378601074
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9448249340057373
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 23 cost time: 0.9798324108123779
Epoch: 23, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.305 Vali Acc: 0.856 Test Loss: 0.305 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9538149833679199
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 25 cost time: 1.0234551429748535
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.295 Vali Acc: 0.844 Test Loss: 0.295 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9391663074493408
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 27 cost time: 1.0577290058135986
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.060600757598877
Epoch: 28, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0716137886047363
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 30 cost time: 1.0671813488006592
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.290 Vali Acc: 0.856 Test Loss: 0.290 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1096866130828857
Epoch: 31, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.260 Vali Acc: 0.878 Test Loss: 0.260 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 32 cost time: 1.0213148593902588
Epoch: 32, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.256 Vali Acc: 0.867 Test Loss: 0.256 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0336270332336426
Epoch: 33, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.074622392654419
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0538980960845947
Epoch: 35, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 1.0508620738983154
Epoch: 36, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9997913837432861
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 38 cost time: 1.1139500141143799
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.250 Vali Acc: 0.872 Test Loss: 0.250 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0627596378326416
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 40 cost time: 0.9976868629455566
Epoch: 40, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.242 Vali Acc: 0.872 Test Loss: 0.242 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0065946578979492
Epoch: 41, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.244 Vali Acc: 0.872 Test Loss: 0.244 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9378986358642578
Epoch: 42, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.877906322479248
Epoch: 43, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.878 Test Loss: 0.246 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.010479211807251
Epoch: 44, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.240 Vali Acc: 0.889 Test Loss: 0.240 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9973702430725098
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.872 Test Loss: 0.242 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9879636764526367
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9358205795288086
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.883 Test Loss: 0.232 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.985837459564209
Epoch: 48, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 49 cost time: 1.091888666152954
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.889 Test Loss: 0.216 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0209777355194092
Epoch: 50, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 143366
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1802029609680176
Epoch: 1, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.579 Vali Acc: 0.461 Test Loss: 1.579 Test Acc: 0.461
Validation loss decreased (inf --> -0.461095).  Saving model ...
Epoch: 2 cost time: 0.9054796695709229
Epoch: 2, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.184 Vali Acc: 0.667 Test Loss: 1.184 Test Acc: 0.667
Validation loss decreased (-0.461095 --> -0.666655).  Saving model ...
Epoch: 3 cost time: 0.9204621315002441
Epoch: 3, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.861 Vali Acc: 0.706 Test Loss: 0.861 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705547).  Saving model ...
Epoch: 4 cost time: 0.962425708770752
Epoch: 4, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.680 Vali Acc: 0.761 Test Loss: 0.680 Test Acc: 0.761
Validation loss decreased (-0.705547 --> -0.761104).  Saving model ...
Epoch: 5 cost time: 1.045907735824585
Epoch: 5, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.573 Vali Acc: 0.767 Test Loss: 0.573 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 1.0356180667877197
Epoch: 6, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.766661 --> -0.783328).  Saving model ...
Epoch: 7 cost time: 1.0583391189575195
Epoch: 7, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.475 Vali Acc: 0.789 Test Loss: 0.475 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 0.9249477386474609
Epoch: 8, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.431 Vali Acc: 0.811 Test Loss: 0.431 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 0.9708380699157715
Epoch: 9, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9737792015075684
Epoch: 10, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.393 Vali Acc: 0.817 Test Loss: 0.393 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 0.9449644088745117
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 0.9662196636199951
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 0.8377711772918701
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 14 cost time: 0.9748833179473877
Epoch: 14, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 0.9377191066741943
Epoch: 15, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 0.9662115573883057
Epoch: 16, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.323 Vali Acc: 0.856 Test Loss: 0.323 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 0.8783063888549805
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.323 Vali Acc: 0.844 Test Loss: 0.323 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.935307502746582
Epoch: 18, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 0.9723162651062012
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.0388755798339844
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1266820430755615
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.293 Vali Acc: 0.856 Test Loss: 0.293 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0489628314971924
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9919686317443848
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.950603723526001
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 1.0002758502960205
Epoch: 25, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.285 Vali Acc: 0.861 Test Loss: 0.285 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9736857414245605
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.289 Vali Acc: 0.872 Test Loss: 0.289 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9640939235687256
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8935778141021729
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 29 cost time: 0.894486665725708
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.867 Test Loss: 0.275 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.949763298034668
Epoch: 30, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9332425594329834
Epoch: 31, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8256306648254395
Epoch: 32, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.830312967300415
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.262 Vali Acc: 0.878 Test Loss: 0.262 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8724501132965088
Epoch: 34, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8146109580993652
Epoch: 35, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.271 Vali Acc: 0.872 Test Loss: 0.271 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8328917026519775
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 37 cost time: 0.7479383945465088
Epoch: 37, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9724030494689941
Epoch: 38, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.247 Vali Acc: 0.872 Test Loss: 0.247 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9413673877716064
Epoch: 39, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9124875068664551
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 41 cost time: 0.8902809619903564
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.239 Vali Acc: 0.883 Test Loss: 0.239 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8231611251831055
Epoch: 42, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 43 cost time: 0.911170482635498
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0099997520446777
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.227 Vali Acc: 0.894 Test Loss: 0.227 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.983712911605835
Epoch: 45, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9408516883850098
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.894 Test Loss: 0.231 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8295993804931641
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.224 Vali Acc: 0.906 Test Loss: 0.224 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 48 cost time: 0.8099575042724609
Epoch: 48, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.811622142791748
Epoch: 49, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8610143661499023
Epoch: 50, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_ModernTCN_UEA_ftM_sl51_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 138822
model size : 0.55MB
