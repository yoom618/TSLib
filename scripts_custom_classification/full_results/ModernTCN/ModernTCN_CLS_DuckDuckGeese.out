2025-04-27 13:23:11.925392: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:23:11.943773: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745760191.966100   37120 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745760191.972874   37120 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:23:11.995476: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.566256046295166
Epoch: 1, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.479 Vali Acc: 0.340 Test Loss: 1.479 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 2.790198802947998
Epoch: 2, Steps: 4 | Train Loss: 0.890 Vali Loss: 2.464 Vali Acc: 0.360 Test Loss: 2.464 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359975).  Saving model ...
Epoch: 3 cost time: 2.7899255752563477
Epoch: 3, Steps: 4 | Train Loss: 0.519 Vali Loss: 2.587 Vali Acc: 0.480 Test Loss: 2.587 Test Acc: 0.480
Validation loss decreased (-0.359975 --> -0.479974).  Saving model ...
Epoch: 4 cost time: 2.8155016899108887
Epoch: 4, Steps: 4 | Train Loss: 0.168 Vali Loss: 8.437 Vali Acc: 0.440 Test Loss: 8.437 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.796888589859009
Epoch: 5, Steps: 4 | Train Loss: 0.168 Vali Loss: 10.936 Vali Acc: 0.440 Test Loss: 10.936 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7660887241363525
Epoch: 6, Steps: 4 | Train Loss: 0.007 Vali Loss: 9.660 Vali Acc: 0.360 Test Loss: 9.660 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7515041828155518
Epoch: 7, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.169 Vali Acc: 0.480 Test Loss: 8.169 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.768439292907715
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.913 Vali Acc: 0.520 Test Loss: 8.913 Test Acc: 0.520
Validation loss decreased (-0.479974 --> -0.519911).  Saving model ...
Epoch: 9 cost time: 2.834747314453125
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.418 Vali Acc: 0.460 Test Loss: 9.418 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7814266681671143
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 11.304 Vali Acc: 0.480 Test Loss: 11.304 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7906107902526855
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.598 Vali Acc: 0.500 Test Loss: 12.598 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.780134439468384
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.022 Vali Acc: 0.440 Test Loss: 14.022 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7776408195495605
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.618 Vali Acc: 0.440 Test Loss: 15.618 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.773655891418457
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.098 Vali Acc: 0.420 Test Loss: 16.098 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.757108449935913
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.584 Vali Acc: 0.420 Test Loss: 16.584 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7749202251434326
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.781 Vali Acc: 0.400 Test Loss: 16.781 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7905571460723877
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.422 Vali Acc: 0.420 Test Loss: 16.422 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7717552185058594
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.374 Vali Acc: 0.420 Test Loss: 16.374 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1463192581
model size : 5583.63MB
2025-04-27 13:26:16.483552: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:26:16.502643: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745760376.524699   45809 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745760376.531516   45809 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:26:16.554293: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.303433418273926
Epoch: 1, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.512 Vali Acc: 0.360 Test Loss: 1.512 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 2.368978261947632
Epoch: 2, Steps: 4 | Train Loss: 1.022 Vali Loss: 2.002 Vali Acc: 0.360 Test Loss: 2.002 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3718931674957275
Epoch: 3, Steps: 4 | Train Loss: 0.348 Vali Loss: 3.003 Vali Acc: 0.260 Test Loss: 3.003 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3485522270202637
Epoch: 4, Steps: 4 | Train Loss: 0.120 Vali Loss: 3.999 Vali Acc: 0.400 Test Loss: 3.999 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399960).  Saving model ...
Epoch: 5 cost time: 2.395195484161377
Epoch: 5, Steps: 4 | Train Loss: 0.308 Vali Loss: 4.775 Vali Acc: 0.440 Test Loss: 4.775 Test Acc: 0.440
Validation loss decreased (-0.399960 --> -0.439952).  Saving model ...
Epoch: 6 cost time: 2.403944969177246
Epoch: 6, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.424 Vali Acc: 0.380 Test Loss: 6.424 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.338085651397705
Epoch: 7, Steps: 4 | Train Loss: 0.055 Vali Loss: 6.492 Vali Acc: 0.420 Test Loss: 6.492 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3595564365386963
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.530 Vali Acc: 0.440 Test Loss: 6.530 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.353452205657959
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.844 Vali Acc: 0.460 Test Loss: 7.844 Test Acc: 0.460
Validation loss decreased (-0.439952 --> -0.459922).  Saving model ...
Epoch: 10 cost time: 2.412478446960449
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.675 Vali Acc: 0.420 Test Loss: 8.675 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3318634033203125
Epoch: 11, Steps: 4 | Train Loss: 0.024 Vali Loss: 7.901 Vali Acc: 0.440 Test Loss: 7.901 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.432563066482544
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.651 Vali Acc: 0.500 Test Loss: 7.651 Test Acc: 0.500
Validation loss decreased (-0.459922 --> -0.499923).  Saving model ...
Epoch: 13 cost time: 2.4074480533599854
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.877 Vali Acc: 0.500 Test Loss: 7.877 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3552374839782715
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.085 Vali Acc: 0.540 Test Loss: 8.085 Test Acc: 0.540
Validation loss decreased (-0.499923 --> -0.539919).  Saving model ...
Epoch: 15 cost time: 2.3940980434417725
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.338 Vali Acc: 0.540 Test Loss: 8.338 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3746867179870605
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.500 Vali Acc: 0.540 Test Loss: 7.500 Test Acc: 0.540
Validation loss decreased (-0.539919 --> -0.539925).  Saving model ...
Epoch: 17 cost time: 2.4013078212738037
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.365 Vali Acc: 0.520 Test Loss: 7.365 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3944664001464844
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.748 Vali Acc: 0.520 Test Loss: 7.748 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3487327098846436
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.700 Vali Acc: 0.520 Test Loss: 7.700 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3707287311553955
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.302 Vali Acc: 0.500 Test Loss: 8.302 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.353099822998047
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.861 Vali Acc: 0.500 Test Loss: 8.861 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3812530040740967
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.292 Vali Acc: 0.480 Test Loss: 8.292 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.356842517852783
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.785 Vali Acc: 0.480 Test Loss: 8.785 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3646228313446045
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.139 Vali Acc: 0.480 Test Loss: 9.139 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3547306060791016
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.423 Vali Acc: 0.460 Test Loss: 9.423 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.3747141361236572
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.557 Vali Acc: 0.460 Test Loss: 9.557 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1456736805
model size : 5559.01MB
2025-04-27 13:30:22.033044: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:30:22.051899: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745760622.073494   58145 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745760622.080094   58145 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:30:22.102118: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1608150005340576
Epoch: 1, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.565 Vali Acc: 0.260 Test Loss: 1.565 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.339179039001465
Epoch: 2, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.633 Vali Acc: 0.380 Test Loss: 1.633 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 2.3468732833862305
Epoch: 3, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.964 Vali Acc: 0.400 Test Loss: 1.964 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399980).  Saving model ...
Epoch: 4 cost time: 2.3112807273864746
Epoch: 4, Steps: 4 | Train Loss: 0.150 Vali Loss: 3.227 Vali Acc: 0.480 Test Loss: 3.227 Test Acc: 0.480
Validation loss decreased (-0.399980 --> -0.479968).  Saving model ...
Epoch: 5 cost time: 2.3216164112091064
Epoch: 5, Steps: 4 | Train Loss: 0.083 Vali Loss: 3.999 Vali Acc: 0.440 Test Loss: 3.999 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3188765048980713
Epoch: 6, Steps: 4 | Train Loss: 0.014 Vali Loss: 4.739 Vali Acc: 0.400 Test Loss: 4.739 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2949774265289307
Epoch: 7, Steps: 4 | Train Loss: 0.028 Vali Loss: 3.544 Vali Acc: 0.520 Test Loss: 3.544 Test Acc: 0.520
Validation loss decreased (-0.479968 --> -0.519965).  Saving model ...
Epoch: 8 cost time: 2.3441083431243896
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.300 Vali Acc: 0.400 Test Loss: 3.300 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.278794288635254
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.392 Vali Acc: 0.440 Test Loss: 3.392 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3024110794067383
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.709 Vali Acc: 0.420 Test Loss: 3.709 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3015637397766113
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.938 Vali Acc: 0.460 Test Loss: 3.938 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3051717281341553
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.130 Vali Acc: 0.460 Test Loss: 4.130 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.305359363555908
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.279 Vali Acc: 0.460 Test Loss: 4.279 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2782785892486572
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.297 Vali Acc: 0.460 Test Loss: 4.297 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.332763910293579
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.051 Vali Acc: 0.420 Test Loss: 4.051 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.30558180809021
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.868 Vali Acc: 0.440 Test Loss: 3.868 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.331193447113037
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.880 Vali Acc: 0.440 Test Loss: 3.880 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1453724229
model size : 5547.51MB
2025-04-27 13:33:30.035252: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:33:30.054122: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745760810.076469   66478 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745760810.083181   66478 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:33:30.105268: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2526533603668213
Epoch: 1, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.593 Vali Acc: 0.260 Test Loss: 1.593 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.2961201667785645
Epoch: 2, Steps: 4 | Train Loss: 0.931 Vali Loss: 1.716 Vali Acc: 0.280 Test Loss: 1.716 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 2.3029232025146484
Epoch: 3, Steps: 4 | Train Loss: 0.370 Vali Loss: 1.808 Vali Acc: 0.460 Test Loss: 1.808 Test Acc: 0.460
Validation loss decreased (-0.279983 --> -0.459982).  Saving model ...
Epoch: 4 cost time: 2.300319194793701
Epoch: 4, Steps: 4 | Train Loss: 0.133 Vali Loss: 2.266 Vali Acc: 0.440 Test Loss: 2.266 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2735092639923096
Epoch: 5, Steps: 4 | Train Loss: 0.064 Vali Loss: 2.632 Vali Acc: 0.440 Test Loss: 2.632 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.258413791656494
Epoch: 6, Steps: 4 | Train Loss: 0.040 Vali Loss: 3.034 Vali Acc: 0.360 Test Loss: 3.034 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2926583290100098
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.700 Vali Acc: 0.420 Test Loss: 3.700 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2483744621276855
Epoch: 8, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.909 Vali Acc: 0.500 Test Loss: 3.909 Test Acc: 0.500
Validation loss decreased (-0.459982 --> -0.499961).  Saving model ...
Epoch: 9 cost time: 2.267451524734497
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.181 Vali Acc: 0.460 Test Loss: 5.181 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2690608501434326
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.904 Vali Acc: 0.460 Test Loss: 5.904 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.260981559753418
Epoch: 11, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.006 Vali Acc: 0.540 Test Loss: 5.006 Test Acc: 0.540
Validation loss decreased (-0.499961 --> -0.539950).  Saving model ...
Epoch: 12 cost time: 2.283078670501709
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.479 Vali Acc: 0.440 Test Loss: 4.479 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2852585315704346
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.938 Vali Acc: 0.400 Test Loss: 4.938 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.256714105606079
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.076 Vali Acc: 0.480 Test Loss: 5.076 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2847788333892822
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.794 Vali Acc: 0.480 Test Loss: 5.794 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.257814645767212
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.239 Vali Acc: 0.460 Test Loss: 6.239 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.279456615447998
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.616 Vali Acc: 0.460 Test Loss: 6.616 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.258812665939331
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.654 Vali Acc: 0.460 Test Loss: 6.654 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.265308380126953
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.601 Vali Acc: 0.460 Test Loss: 6.601 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2380664348602295
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.015 Vali Acc: 0.480 Test Loss: 6.015 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2819907665252686
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.102 Vali Acc: 0.440 Test Loss: 6.102 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1452863621
model size : 5544.23MB
2025-04-27 13:36:50.203272: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:36:50.222716: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745761010.244415   76489 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745761010.251076   76489 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:36:50.272745: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1536874771118164
Epoch: 1, Steps: 4 | Train Loss: 1.583 Vali Loss: 1.602 Vali Acc: 0.320 Test Loss: 1.602 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 2.269714117050171
Epoch: 2, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.570 Vali Acc: 0.360 Test Loss: 1.570 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 2.2571325302124023
Epoch: 3, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.543 Vali Acc: 0.460 Test Loss: 1.543 Test Acc: 0.460
Validation loss decreased (-0.359984 --> -0.459985).  Saving model ...
Epoch: 4 cost time: 2.2487385272979736
Epoch: 4, Steps: 4 | Train Loss: 0.253 Vali Loss: 2.130 Vali Acc: 0.460 Test Loss: 2.130 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2296929359436035
Epoch: 5, Steps: 4 | Train Loss: 0.086 Vali Loss: 2.129 Vali Acc: 0.540 Test Loss: 2.129 Test Acc: 0.540
Validation loss decreased (-0.459985 --> -0.539979).  Saving model ...
Epoch: 6 cost time: 2.248814344406128
Epoch: 6, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.479 Vali Acc: 0.560 Test Loss: 2.479 Test Acc: 0.560
Validation loss decreased (-0.539979 --> -0.559975).  Saving model ...
Epoch: 7 cost time: 2.2643017768859863
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.392 Vali Acc: 0.520 Test Loss: 2.392 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2069265842437744
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.591 Vali Acc: 0.480 Test Loss: 2.591 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.227813720703125
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.233 Vali Acc: 0.460 Test Loss: 3.233 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2057247161865234
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.483 Vali Acc: 0.540 Test Loss: 3.483 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.222219467163086
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.272 Vali Acc: 0.520 Test Loss: 3.272 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2094576358795166
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.528 Vali Acc: 0.520 Test Loss: 3.528 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2434511184692383
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.030 Vali Acc: 0.500 Test Loss: 4.030 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.230987787246704
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.474 Vali Acc: 0.480 Test Loss: 4.474 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2494351863861084
Epoch: 15, Steps: 4 | Train Loss: 0.099 Vali Loss: 4.251 Vali Acc: 0.460 Test Loss: 4.251 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.210238456726074
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.560 Vali Acc: 0.480 Test Loss: 4.560 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1451142469
model size : 5537.67MB
2025-04-27 13:39:52.040088: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:39:52.059426: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745761192.082078   84358 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745761192.088760   84358 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:39:52.111120: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1521377563476562
Epoch: 1, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.565 Vali Acc: 0.300 Test Loss: 1.565 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.2667198181152344
Epoch: 2, Steps: 4 | Train Loss: 1.255 Vali Loss: 1.526 Vali Acc: 0.320 Test Loss: 1.526 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 2.2705204486846924
Epoch: 3, Steps: 4 | Train Loss: 0.622 Vali Loss: 1.619 Vali Acc: 0.420 Test Loss: 1.619 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419984).  Saving model ...
Epoch: 4 cost time: 2.264918327331543
Epoch: 4, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.595 Vali Acc: 0.580 Test Loss: 1.595 Test Acc: 0.580
Validation loss decreased (-0.419984 --> -0.579984).  Saving model ...
Epoch: 5 cost time: 2.2424120903015137
Epoch: 5, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.973 Vali Acc: 0.480 Test Loss: 1.973 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.234665632247925
Epoch: 6, Steps: 4 | Train Loss: 0.116 Vali Loss: 2.326 Vali Acc: 0.520 Test Loss: 2.326 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.217808723449707
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.216 Vali Acc: 0.500 Test Loss: 2.216 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2250452041625977
Epoch: 8, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.129 Vali Acc: 0.560 Test Loss: 2.129 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.206589937210083
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.187 Vali Acc: 0.560 Test Loss: 2.187 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2339870929718018
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.434 Vali Acc: 0.560 Test Loss: 2.434 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2169981002807617
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.592 Vali Acc: 0.540 Test Loss: 2.592 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2193264961242676
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.654 Vali Acc: 0.500 Test Loss: 2.654 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.201157331466675
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.641 Vali Acc: 0.560 Test Loss: 2.641 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.227741003036499
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.723 Vali Acc: 0.560 Test Loss: 2.723 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1450712485
model size : 5536.02MB
2025-04-27 13:42:31.441743: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:42:31.460179: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745761351.484433   91269 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745761351.491024   91269 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:42:31.512687: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.126840591430664
Epoch: 1, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.495 Vali Acc: 0.240 Test Loss: 1.495 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 2.2301535606384277
Epoch: 2, Steps: 4 | Train Loss: 1.301 Vali Loss: 1.596 Vali Acc: 0.380 Test Loss: 1.596 Test Acc: 0.380
Validation loss decreased (-0.239985 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 2.2159647941589355
Epoch: 3, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.544 Vali Acc: 0.480 Test Loss: 1.544 Test Acc: 0.480
Validation loss decreased (-0.379984 --> -0.479985).  Saving model ...
Epoch: 4 cost time: 2.220606565475464
Epoch: 4, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.600 Vali Acc: 0.520 Test Loss: 1.600 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519984).  Saving model ...
Epoch: 5 cost time: 2.2520217895507812
Epoch: 5, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.956 Vali Acc: 0.520 Test Loss: 1.956 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.164336919784546
Epoch: 6, Steps: 4 | Train Loss: 0.082 Vali Loss: 2.162 Vali Acc: 0.520 Test Loss: 2.162 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.201850652694702
Epoch: 7, Steps: 4 | Train Loss: 0.027 Vali Loss: 2.219 Vali Acc: 0.500 Test Loss: 2.219 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1943578720092773
Epoch: 8, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.732 Vali Acc: 0.520 Test Loss: 2.732 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1876463890075684
Epoch: 9, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.778 Vali Acc: 0.500 Test Loss: 2.778 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.208770275115967
Epoch: 10, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.914 Vali Acc: 0.520 Test Loss: 2.914 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2047605514526367
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.181 Vali Acc: 0.480 Test Loss: 3.181 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.20462703704834
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.334 Vali Acc: 0.480 Test Loss: 3.334 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1975176334381104
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.655 Vali Acc: 0.500 Test Loss: 3.655 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2004566192626953
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.703 Vali Acc: 0.520 Test Loss: 3.703 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1450282533
model size : 5534.38MB
2025-04-27 13:58:13.349369: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 13:58:13.368559: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745762293.391717  106381 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745762293.398786  106381 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 13:58:13.421768: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.678746461868286
Epoch: 1, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.539 Vali Acc: 0.340 Test Loss: 1.539 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 2.933137893676758
Epoch: 2, Steps: 4 | Train Loss: 1.256 Vali Loss: 3.427 Vali Acc: 0.420 Test Loss: 3.427 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419966).  Saving model ...
Epoch: 3 cost time: 2.904560089111328
Epoch: 3, Steps: 4 | Train Loss: 0.676 Vali Loss: 3.986 Vali Acc: 0.440 Test Loss: 3.986 Test Acc: 0.440
Validation loss decreased (-0.419966 --> -0.439960).  Saving model ...
Epoch: 4 cost time: 2.9096553325653076
Epoch: 4, Steps: 4 | Train Loss: 1.334 Vali Loss: 7.114 Vali Acc: 0.440 Test Loss: 7.114 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.846442699432373
Epoch: 5, Steps: 4 | Train Loss: 0.055 Vali Loss: 7.606 Vali Acc: 0.380 Test Loss: 7.606 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8674001693725586
Epoch: 6, Steps: 4 | Train Loss: 0.103 Vali Loss: 8.113 Vali Acc: 0.500 Test Loss: 8.113 Test Acc: 0.500
Validation loss decreased (-0.439960 --> -0.499919).  Saving model ...
Epoch: 7 cost time: 2.866492509841919
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.589 Vali Acc: 0.460 Test Loss: 7.589 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8568716049194336
Epoch: 8, Steps: 4 | Train Loss: 0.010 Vali Loss: 8.234 Vali Acc: 0.460 Test Loss: 8.234 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8706271648406982
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.539 Vali Acc: 0.440 Test Loss: 12.539 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8746984004974365
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 17.220 Vali Acc: 0.440 Test Loss: 17.220 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.89907169342041
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.224 Vali Acc: 0.400 Test Loss: 16.224 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.862022876739502
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 17.705 Vali Acc: 0.420 Test Loss: 17.705 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.875643730163574
Epoch: 13, Steps: 4 | Train Loss: 0.052 Vali Loss: 13.107 Vali Acc: 0.380 Test Loss: 13.107 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.869267225265503
Epoch: 14, Steps: 4 | Train Loss: 0.143 Vali Loss: 12.258 Vali Acc: 0.480 Test Loss: 12.258 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8729584217071533
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.763 Vali Acc: 0.440 Test Loss: 14.763 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.861743927001953
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.145 Vali Acc: 0.440 Test Loss: 16.145 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1462676101
model size : 5581.66MB
2025-04-27 14:01:15.394396: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:01:15.413036: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745762475.434884  114258 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745762475.441622  114258 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:01:15.463949: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2817165851593018
Epoch: 1, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.501 Vali Acc: 0.440 Test Loss: 1.501 Test Acc: 0.440
Validation loss decreased (inf --> -0.439985).  Saving model ...
Epoch: 2 cost time: 2.49352765083313
Epoch: 2, Steps: 4 | Train Loss: 1.182 Vali Loss: 1.708 Vali Acc: 0.380 Test Loss: 1.708 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4406614303588867
Epoch: 3, Steps: 4 | Train Loss: 0.478 Vali Loss: 2.138 Vali Acc: 0.420 Test Loss: 2.138 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.433972120285034
Epoch: 4, Steps: 4 | Train Loss: 0.191 Vali Loss: 4.122 Vali Acc: 0.460 Test Loss: 4.122 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459959).  Saving model ...
Epoch: 5 cost time: 2.483522415161133
Epoch: 5, Steps: 4 | Train Loss: 0.365 Vali Loss: 3.979 Vali Acc: 0.440 Test Loss: 3.979 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4362447261810303
Epoch: 6, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.356 Vali Acc: 0.480 Test Loss: 4.356 Test Acc: 0.480
Validation loss decreased (-0.459959 --> -0.479956).  Saving model ...
Epoch: 7 cost time: 2.509611129760742
Epoch: 7, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.181 Vali Acc: 0.480 Test Loss: 6.181 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4617979526519775
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.678 Vali Acc: 0.540 Test Loss: 6.678 Test Acc: 0.540
Validation loss decreased (-0.479956 --> -0.539933).  Saving model ...
Epoch: 9 cost time: 2.4875643253326416
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.804 Vali Acc: 0.440 Test Loss: 6.804 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4616150856018066
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.145 Vali Acc: 0.500 Test Loss: 7.145 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.459444761276245
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.211 Vali Acc: 0.560 Test Loss: 7.211 Test Acc: 0.560
Validation loss decreased (-0.539933 --> -0.559928).  Saving model ...
Epoch: 12 cost time: 2.486713171005249
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.792 Vali Acc: 0.520 Test Loss: 7.792 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.435041666030884
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.230 Vali Acc: 0.520 Test Loss: 8.230 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4362406730651855
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.476 Vali Acc: 0.540 Test Loss: 8.476 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4692234992980957
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.731 Vali Acc: 0.560 Test Loss: 8.731 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4353654384613037
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.001 Vali Acc: 0.560 Test Loss: 9.001 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.444425582885742
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.989 Vali Acc: 0.560 Test Loss: 8.989 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.46108078956604
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.134 Vali Acc: 0.560 Test Loss: 9.134 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.467611074447632
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.157 Vali Acc: 0.560 Test Loss: 9.157 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.446451187133789
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.232 Vali Acc: 0.560 Test Loss: 9.232 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4507975578308105
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.248 Vali Acc: 0.560 Test Loss: 9.248 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1456220325
model size : 5557.04MB
2025-04-27 14:04:45.843687: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:04:45.862942: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745762685.885362  124338 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745762685.892084  124338 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:04:45.914652: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.121535301208496
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.583 Vali Acc: 0.260 Test Loss: 1.583 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.3914098739624023
Epoch: 2, Steps: 4 | Train Loss: 1.229 Vali Loss: 1.431 Vali Acc: 0.380 Test Loss: 1.431 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 2.406059503555298
Epoch: 3, Steps: 4 | Train Loss: 0.348 Vali Loss: 1.811 Vali Acc: 0.420 Test Loss: 1.811 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419982).  Saving model ...
Epoch: 4 cost time: 2.3871259689331055
Epoch: 4, Steps: 4 | Train Loss: 0.162 Vali Loss: 2.055 Vali Acc: 0.460 Test Loss: 2.055 Test Acc: 0.460
Validation loss decreased (-0.419982 --> -0.459979).  Saving model ...
Epoch: 5 cost time: 2.3909730911254883
Epoch: 5, Steps: 4 | Train Loss: 0.066 Vali Loss: 2.632 Vali Acc: 0.440 Test Loss: 2.632 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.364497661590576
Epoch: 6, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.303 Vali Acc: 0.400 Test Loss: 3.303 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3327131271362305
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.439 Vali Acc: 0.420 Test Loss: 3.439 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3481836318969727
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.788 Vali Acc: 0.440 Test Loss: 3.788 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.355410575866699
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.213 Vali Acc: 0.420 Test Loss: 4.213 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3351495265960693
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.506 Vali Acc: 0.420 Test Loss: 4.506 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3493502140045166
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.701 Vali Acc: 0.440 Test Loss: 4.701 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3593666553497314
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.910 Vali Acc: 0.420 Test Loss: 4.910 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3385517597198486
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.876 Vali Acc: 0.400 Test Loss: 4.876 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.339090585708618
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.023 Vali Acc: 0.400 Test Loss: 5.023 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 1453207749
model size : 5545.54MB
2025-04-27 14:07:27.337676: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:07:27.356307: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745762847.379219  131276 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745762847.385960  131276 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:07:27.408392: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.221836805343628
Epoch: 1, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.492 Vali Acc: 0.380 Test Loss: 1.492 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 2.378938674926758
Epoch: 2, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.610 Vali Acc: 0.400 Test Loss: 1.610 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 2.354645013809204
Epoch: 3, Steps: 4 | Train Loss: 0.388 Vali Loss: 1.849 Vali Acc: 0.420 Test Loss: 1.849 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419982).  Saving model ...
Epoch: 4 cost time: 2.366344690322876
Epoch: 4, Steps: 4 | Train Loss: 0.134 Vali Loss: 2.165 Vali Acc: 0.440 Test Loss: 2.165 Test Acc: 0.440
Validation loss decreased (-0.419982 --> -0.439978).  Saving model ...
Epoch: 5 cost time: 2.3553977012634277
Epoch: 5, Steps: 4 | Train Loss: 0.055 Vali Loss: 3.321 Vali Acc: 0.520 Test Loss: 3.321 Test Acc: 0.520
Validation loss decreased (-0.439978 --> -0.519967).  Saving model ...
Epoch: 6 cost time: 2.3677854537963867
Epoch: 6, Steps: 4 | Train Loss: 0.027 Vali Loss: 3.775 Vali Acc: 0.560 Test Loss: 3.775 Test Acc: 0.560
Validation loss decreased (-0.519967 --> -0.559962).  Saving model ...
Epoch: 7 cost time: 2.3433456420898438
Epoch: 7, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.955 Vali Acc: 0.520 Test Loss: 3.955 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3240911960601807
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.601 Vali Acc: 0.480 Test Loss: 4.601 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.324206590652466
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.252 Vali Acc: 0.480 Test Loss: 5.252 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3549106121063232
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.712 Vali Acc: 0.460 Test Loss: 5.712 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3136415481567383
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.696 Vali Acc: 0.480 Test Loss: 5.696 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.332526683807373
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 4.668 Vali Acc: 0.540 Test Loss: 4.668 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.327000141143799
Epoch: 13, Steps: 4 | Train Loss: 0.021 Vali Loss: 4.769 Vali Acc: 0.600 Test Loss: 4.769 Test Acc: 0.600
Validation loss decreased (-0.559962 --> -0.599952).  Saving model ...
Epoch: 14 cost time: 2.357091188430786
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.386 Vali Acc: 0.480 Test Loss: 5.386 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3394837379455566
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.899 Vali Acc: 0.440 Test Loss: 5.899 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3090169429779053
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.268 Vali Acc: 0.440 Test Loss: 6.268 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.334672212600708
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.471 Vali Acc: 0.460 Test Loss: 6.471 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3106749057769775
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.539 Vali Acc: 0.460 Test Loss: 6.539 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3138680458068848
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.007 Vali Acc: 0.540 Test Loss: 6.007 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.325270175933838
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.606 Vali Acc: 0.580 Test Loss: 6.606 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.311265230178833
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.008 Vali Acc: 0.480 Test Loss: 7.008 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.311522960662842
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.714 Vali Acc: 0.440 Test Loss: 7.714 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3211586475372314
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.696 Vali Acc: 0.520 Test Loss: 6.696 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1452347141
model size : 5542.26MB
2025-04-27 14:11:46.146799: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:11:46.165995: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745763106.188434  142499 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745763106.195308  142499 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:11:46.217960: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1129629611968994
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.524 Vali Acc: 0.280 Test Loss: 1.524 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 2.286602735519409
Epoch: 2, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.402 Vali Acc: 0.400 Test Loss: 1.402 Test Acc: 0.400
Validation loss decreased (-0.279985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 2.308924436569214
Epoch: 3, Steps: 4 | Train Loss: 0.732 Vali Loss: 1.614 Vali Acc: 0.500 Test Loss: 1.614 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 2.292405605316162
Epoch: 4, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.833 Vali Acc: 0.420 Test Loss: 1.833 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.235412120819092
Epoch: 5, Steps: 4 | Train Loss: 0.117 Vali Loss: 2.153 Vali Acc: 0.500 Test Loss: 2.153 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2670300006866455
Epoch: 6, Steps: 4 | Train Loss: 0.093 Vali Loss: 2.350 Vali Acc: 0.520 Test Loss: 2.350 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519976).  Saving model ...
Epoch: 7 cost time: 2.2898974418640137
Epoch: 7, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.583 Vali Acc: 0.540 Test Loss: 2.583 Test Acc: 0.540
Validation loss decreased (-0.519976 --> -0.539974).  Saving model ...
Epoch: 8 cost time: 2.2544710636138916
Epoch: 8, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.985 Vali Acc: 0.540 Test Loss: 2.985 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2638461589813232
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.700 Vali Acc: 0.480 Test Loss: 3.700 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2214741706848145
Epoch: 10, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.377 Vali Acc: 0.540 Test Loss: 3.377 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2375123500823975
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.497 Vali Acc: 0.520 Test Loss: 3.497 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.264535427093506
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.600 Vali Acc: 0.520 Test Loss: 3.600 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2337000370025635
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.840 Vali Acc: 0.520 Test Loss: 3.840 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2650582790374756
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.078 Vali Acc: 0.520 Test Loss: 4.078 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.240535020828247
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.265 Vali Acc: 0.520 Test Loss: 4.265 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2552835941314697
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.458 Vali Acc: 0.520 Test Loss: 4.458 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2656149864196777
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.385 Vali Acc: 0.460 Test Loss: 4.385 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1450625989
model size : 5535.70MB
2025-04-27 14:15:02.776370: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:15:02.795223: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745763302.816928  150881 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745763302.823641  150881 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:15:02.845669: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0736045837402344
Epoch: 1, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.584 Vali Acc: 0.200 Test Loss: 1.584 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.259854555130005
Epoch: 2, Steps: 4 | Train Loss: 1.229 Vali Loss: 1.438 Vali Acc: 0.400 Test Loss: 1.438 Test Acc: 0.400
Validation loss decreased (-0.199984 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 2.2787201404571533
Epoch: 3, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.481 Vali Acc: 0.480 Test Loss: 1.481 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479985).  Saving model ...
Epoch: 4 cost time: 2.301102876663208
Epoch: 4, Steps: 4 | Train Loss: 0.379 Vali Loss: 1.625 Vali Acc: 0.520 Test Loss: 1.625 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519984).  Saving model ...
Epoch: 5 cost time: 2.272343158721924
Epoch: 5, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.749 Vali Acc: 0.440 Test Loss: 1.749 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2580888271331787
Epoch: 6, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.731 Vali Acc: 0.520 Test Loss: 1.731 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.223137855529785
Epoch: 7, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.845 Vali Acc: 0.480 Test Loss: 1.845 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.253596305847168
Epoch: 8, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.957 Vali Acc: 0.560 Test Loss: 1.957 Test Acc: 0.560
Validation loss decreased (-0.519984 --> -0.559980).  Saving model ...
Epoch: 9 cost time: 2.293062448501587
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.264 Vali Acc: 0.460 Test Loss: 2.264 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.24657940864563
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.492 Vali Acc: 0.420 Test Loss: 2.492 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.240447759628296
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.684 Vali Acc: 0.460 Test Loss: 2.684 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.24868106842041
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.866 Vali Acc: 0.460 Test Loss: 2.866 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2212002277374268
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.022 Vali Acc: 0.460 Test Loss: 3.022 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.257356643676758
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.963 Vali Acc: 0.500 Test Loss: 2.963 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.241952419281006
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.857 Vali Acc: 0.500 Test Loss: 2.857 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.22758150100708
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.929 Vali Acc: 0.540 Test Loss: 2.929 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2501447200775146
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.952 Vali Acc: 0.520 Test Loss: 2.952 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.233794689178467
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.737 Vali Acc: 0.560 Test Loss: 2.737 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1450196005
model size : 5534.05MB
2025-04-27 14:18:09.305123: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:18:09.323956: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745763489.346851  159599 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745763489.353624  159599 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:18:09.376188: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1337735652923584
Epoch: 1, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.622 Vali Acc: 0.160 Test Loss: 1.622 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.2672641277313232
Epoch: 2, Steps: 4 | Train Loss: 1.244 Vali Loss: 1.459 Vali Acc: 0.460 Test Loss: 1.459 Test Acc: 0.460
Validation loss decreased (-0.159984 --> -0.459985).  Saving model ...
Epoch: 3 cost time: 2.3604917526245117
Epoch: 3, Steps: 4 | Train Loss: 0.576 Vali Loss: 1.580 Vali Acc: 0.460 Test Loss: 1.580 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.235809087753296
Epoch: 4, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.619 Vali Acc: 0.560 Test Loss: 1.619 Test Acc: 0.560
Validation loss decreased (-0.459985 --> -0.559984).  Saving model ...
Epoch: 5 cost time: 2.2855560779571533
Epoch: 5, Steps: 4 | Train Loss: 0.369 Vali Loss: 2.015 Vali Acc: 0.560 Test Loss: 2.015 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2510156631469727
Epoch: 6, Steps: 4 | Train Loss: 0.092 Vali Loss: 2.246 Vali Acc: 0.580 Test Loss: 2.246 Test Acc: 0.580
Validation loss decreased (-0.559984 --> -0.579978).  Saving model ...
Epoch: 7 cost time: 2.302083730697632
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.713 Vali Acc: 0.480 Test Loss: 2.713 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.243035316467285
Epoch: 8, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.440 Vali Acc: 0.500 Test Loss: 3.440 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.265486240386963
Epoch: 9, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.880 Vali Acc: 0.500 Test Loss: 3.880 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2379000186920166
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.846 Vali Acc: 0.440 Test Loss: 3.846 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2357053756713867
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.798 Vali Acc: 0.460 Test Loss: 3.798 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.247504949569702
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.663 Vali Acc: 0.500 Test Loss: 3.663 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2372207641601562
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.691 Vali Acc: 0.540 Test Loss: 3.691 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.231898307800293
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.401 Vali Acc: 0.560 Test Loss: 3.401 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2098584175109863
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.438 Vali Acc: 0.580 Test Loss: 3.438 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2274162769317627
Epoch: 16, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.145 Vali Acc: 0.600 Test Loss: 3.145 Test Acc: 0.600
Validation loss decreased (-0.579978 --> -0.599969).  Saving model ...
Epoch: 17 cost time: 2.258676767349243
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.301 Vali Acc: 0.580 Test Loss: 3.301 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2036423683166504
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.628 Vali Acc: 0.560 Test Loss: 3.628 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2325801849365234
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.068 Vali Acc: 0.540 Test Loss: 4.068 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2156078815460205
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.377 Vali Acc: 0.540 Test Loss: 4.377 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.231797456741333
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.431 Vali Acc: 0.540 Test Loss: 4.431 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.214406728744507
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.114 Vali Acc: 0.540 Test Loss: 4.114 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.211554765701294
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.119 Vali Acc: 0.540 Test Loss: 4.119 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2224502563476562
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.192 Vali Acc: 0.520 Test Loss: 4.192 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2175533771514893
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.230 Vali Acc: 0.540 Test Loss: 4.230 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.202354669570923
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.017 Vali Acc: 0.520 Test Loss: 4.017 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1449766053
model size : 5532.41MB
2025-04-27 14:29:29.390070: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:29:29.407257: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764169.428913  176602 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764169.435508  176602 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:29:29.456529: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 25.370875120162964
Epoch: 1, Steps: 50 | Train Loss: 28.501 Vali Loss: 25.099 Vali Acc: 0.340 Test Loss: 25.099 Test Acc: 0.340
Validation loss decreased (inf --> -0.339749).  Saving model ...
Epoch: 2 cost time: 24.16549301147461
Epoch: 2, Steps: 50 | Train Loss: 7.737 Vali Loss: 80.526 Vali Acc: 0.340 Test Loss: 80.526 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.145013570785522
Epoch: 3, Steps: 50 | Train Loss: 2.307 Vali Loss: 82.928 Vali Acc: 0.460 Test Loss: 82.928 Test Acc: 0.460
Validation loss decreased (-0.339749 --> -0.459171).  Saving model ...
Epoch: 4 cost time: 24.176029682159424
Epoch: 4, Steps: 50 | Train Loss: 0.000 Vali Loss: 90.129 Vali Acc: 0.540 Test Loss: 90.129 Test Acc: 0.540
Validation loss decreased (-0.459171 --> -0.539099).  Saving model ...
Epoch: 5 cost time: 24.19043803215027
Epoch: 5, Steps: 50 | Train Loss: 0.000 Vali Loss: 104.053 Vali Acc: 0.520 Test Loss: 104.053 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.12437677383423
Epoch: 6, Steps: 50 | Train Loss: 0.000 Vali Loss: 75.489 Vali Acc: 0.520 Test Loss: 75.489 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.13121771812439
Epoch: 7, Steps: 50 | Train Loss: 0.000 Vali Loss: 85.349 Vali Acc: 0.520 Test Loss: 85.349 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.19798707962036
Epoch: 8, Steps: 50 | Train Loss: 0.000 Vali Loss: 98.176 Vali Acc: 0.520 Test Loss: 98.176 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 24.14003276824951
Epoch: 9, Steps: 50 | Train Loss: 0.000 Vali Loss: 105.482 Vali Acc: 0.500 Test Loss: 105.482 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 24.133097648620605
Epoch: 10, Steps: 50 | Train Loss: 0.000 Vali Loss: 123.033 Vali Acc: 0.500 Test Loss: 123.033 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 24.118088245391846
Epoch: 11, Steps: 50 | Train Loss: 0.000 Vali Loss: 95.122 Vali Acc: 0.520 Test Loss: 95.122 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 24.179944038391113
Epoch: 12, Steps: 50 | Train Loss: 0.000 Vali Loss: 111.730 Vali Acc: 0.520 Test Loss: 111.730 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 24.109185695648193
Epoch: 13, Steps: 50 | Train Loss: 0.000 Vali Loss: 79.013 Vali Acc: 0.540 Test Loss: 79.013 Test Acc: 0.540
Validation loss decreased (-0.539099 --> -0.539210).  Saving model ...
Epoch: 14 cost time: 24.190545320510864
Epoch: 14, Steps: 50 | Train Loss: 0.000 Vali Loss: 48.237 Vali Acc: 0.500 Test Loss: 48.237 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.119179248809814
Epoch: 15, Steps: 50 | Train Loss: 0.000 Vali Loss: 104.745 Vali Acc: 0.500 Test Loss: 104.745 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.156927347183228
Epoch: 16, Steps: 50 | Train Loss: 0.000 Vali Loss: 79.340 Vali Acc: 0.520 Test Loss: 79.340 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 24.155075550079346
Epoch: 17, Steps: 50 | Train Loss: 0.000 Vali Loss: 97.212 Vali Acc: 0.520 Test Loss: 97.212 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.15558362007141
Epoch: 18, Steps: 50 | Train Loss: 0.000 Vali Loss: 101.639 Vali Acc: 0.500 Test Loss: 101.639 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.166093111038208
Epoch: 19, Steps: 50 | Train Loss: 0.000 Vali Loss: 80.567 Vali Acc: 0.540 Test Loss: 80.567 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 24.153043508529663
Epoch: 20, Steps: 50 | Train Loss: 0.000 Vali Loss: 79.965 Vali Acc: 0.520 Test Loss: 79.965 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 24.130977392196655
Epoch: 21, Steps: 50 | Train Loss: 0.000 Vali Loss: 99.818 Vali Acc: 0.520 Test Loss: 99.818 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 24.116581439971924
Epoch: 22, Steps: 50 | Train Loss: 0.000 Vali Loss: 70.659 Vali Acc: 0.480 Test Loss: 70.659 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 24.130935430526733
Epoch: 23, Steps: 50 | Train Loss: 0.000 Vali Loss: 80.298 Vali Acc: 0.520 Test Loss: 80.298 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2054905093
model size : 7841.48MB
2025-04-27 14:30:02.207077: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:30:02.226127: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764202.249071  177013 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764202.255915  177013 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:30:02.278716: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 25.4775447845459
Epoch: 1, Steps: 50 | Train Loss: 21.285 Vali Loss: 41.596 Vali Acc: 0.400 Test Loss: 41.596 Test Acc: 0.400
Validation loss decreased (inf --> -0.399584).  Saving model ...
Epoch: 2 cost time: 24.308091163635254
Epoch: 2, Steps: 50 | Train Loss: 16.971 Vali Loss: 34.633 Vali Acc: 0.320 Test Loss: 34.633 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.238712787628174
Epoch: 3, Steps: 50 | Train Loss: 9.006 Vali Loss: 41.165 Vali Acc: 0.480 Test Loss: 41.165 Test Acc: 0.480
Validation loss decreased (-0.399584 --> -0.479588).  Saving model ...
Epoch: 4 cost time: 24.335150957107544
Epoch: 4, Steps: 50 | Train Loss: 2.055 Vali Loss: 99.843 Vali Acc: 0.360 Test Loss: 99.843 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.268157243728638
Epoch: 5, Steps: 50 | Train Loss: 13.675 Vali Loss: 148.319 Vali Acc: 0.360 Test Loss: 148.319 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.220818042755127
Epoch: 6, Steps: 50 | Train Loss: 25.534 Vali Loss: 193.941 Vali Acc: 0.300 Test Loss: 193.941 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.25385594367981
Epoch: 7, Steps: 50 | Train Loss: 75.520 Vali Loss: 515.087 Vali Acc: 0.280 Test Loss: 515.087 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.292124271392822
Epoch: 8, Steps: 50 | Train Loss: 874.510 Vali Loss: 896.790 Vali Acc: 0.260 Test Loss: 896.790 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 24.238828897476196
Epoch: 9, Steps: 50 | Train Loss: 87.923 Vali Loss: 710.748 Vali Acc: 0.260 Test Loss: 710.748 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.264254331588745
Epoch: 10, Steps: 50 | Train Loss: 132.954 Vali Loss: 1145.136 Vali Acc: 0.240 Test Loss: 1145.136 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.24710249900818
Epoch: 11, Steps: 50 | Train Loss: 43.315 Vali Loss: 2359.711 Vali Acc: 0.220 Test Loss: 2359.711 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.235800743103027
Epoch: 12, Steps: 50 | Train Loss: 163.564 Vali Loss: 1311.346 Vali Acc: 0.200 Test Loss: 1311.346 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 24.220527410507202
Epoch: 13, Steps: 50 | Train Loss: 31.244 Vali Loss: 2778.112 Vali Acc: 0.200 Test Loss: 2778.112 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2050601861
model size : 7825.07MB
2025-04-27 14:30:35.095722: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:30:35.112819: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764235.134416  177429 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764235.140989  177429 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:30:35.162009: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.266336441040039
Epoch: 1, Steps: 7 | Train Loss: 1.518 Vali Loss: 3.501 Vali Acc: 0.300 Test Loss: 3.501 Test Acc: 0.300
Validation loss decreased (inf --> -0.299965).  Saving model ...
Epoch: 2 cost time: 4.3586437702178955
Epoch: 2, Steps: 7 | Train Loss: 1.717 Vali Loss: 6.168 Vali Acc: 0.280 Test Loss: 6.168 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.342136383056641
Epoch: 3, Steps: 7 | Train Loss: 0.153 Vali Loss: 10.955 Vali Acc: 0.480 Test Loss: 10.955 Test Acc: 0.480
Validation loss decreased (-0.299965 --> -0.479890).  Saving model ...
Epoch: 4 cost time: 4.36089301109314
Epoch: 4, Steps: 7 | Train Loss: 0.287 Vali Loss: 12.479 Vali Acc: 0.380 Test Loss: 12.479 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.333020925521851
Epoch: 5, Steps: 7 | Train Loss: 0.245 Vali Loss: 14.597 Vali Acc: 0.500 Test Loss: 14.597 Test Acc: 0.500
Validation loss decreased (-0.479890 --> -0.499854).  Saving model ...
Epoch: 6 cost time: 4.357640743255615
Epoch: 6, Steps: 7 | Train Loss: 0.309 Vali Loss: 21.965 Vali Acc: 0.420 Test Loss: 21.965 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.319920063018799
Epoch: 7, Steps: 7 | Train Loss: 0.271 Vali Loss: 23.165 Vali Acc: 0.420 Test Loss: 23.165 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.326772689819336
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 19.955 Vali Acc: 0.440 Test Loss: 19.955 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.322113275527954
Epoch: 9, Steps: 7 | Train Loss: 0.583 Vali Loss: 17.848 Vali Acc: 0.440 Test Loss: 17.848 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.344516038894653
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 20.942 Vali Acc: 0.400 Test Loss: 20.942 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.322509050369263
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 14.579 Vali Acc: 0.360 Test Loss: 14.579 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.3142523765563965
Epoch: 12, Steps: 7 | Train Loss: 0.070 Vali Loss: 19.558 Vali Acc: 0.460 Test Loss: 19.558 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.326781749725342
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 27.715 Vali Acc: 0.460 Test Loss: 27.715 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.323103427886963
Epoch: 14, Steps: 7 | Train Loss: 0.335 Vali Loss: 31.183 Vali Acc: 0.420 Test Loss: 31.183 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.326900482177734
Epoch: 15, Steps: 7 | Train Loss: 0.142 Vali Loss: 26.929 Vali Acc: 0.440 Test Loss: 26.929 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 2044578053
model size : 7802.09MB
2025-04-27 14:31:07.022875: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:31:07.042101: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764267.064523  177836 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764267.071400  177836 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:31:07.094104: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 15.306779861450195
Epoch: 1, Steps: 25 | Train Loss: 7.291 Vali Loss: 15.095 Vali Acc: 0.340 Test Loss: 15.095 Test Acc: 0.340
Validation loss decreased (inf --> -0.339849).  Saving model ...
Epoch: 2 cost time: 14.156352043151855
Epoch: 2, Steps: 25 | Train Loss: 5.739 Vali Loss: 23.491 Vali Acc: 0.420 Test Loss: 23.491 Test Acc: 0.420
Validation loss decreased (-0.339849 --> -0.419765).  Saving model ...
Epoch: 3 cost time: 14.170783996582031
Epoch: 3, Steps: 25 | Train Loss: 3.519 Vali Loss: 31.309 Vali Acc: 0.420 Test Loss: 31.309 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.135289669036865
Epoch: 4, Steps: 25 | Train Loss: 0.021 Vali Loss: 41.543 Vali Acc: 0.380 Test Loss: 41.543 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.119882345199585
Epoch: 5, Steps: 25 | Train Loss: 2.040 Vali Loss: 35.746 Vali Acc: 0.300 Test Loss: 35.746 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.128815412521362
Epoch: 6, Steps: 25 | Train Loss: 2.042 Vali Loss: 25.624 Vali Acc: 0.420 Test Loss: 25.624 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.127298355102539
Epoch: 7, Steps: 25 | Train Loss: 2.191 Vali Loss: 53.302 Vali Acc: 0.400 Test Loss: 53.302 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 14.136515855789185
Epoch: 8, Steps: 25 | Train Loss: 3.757 Vali Loss: 39.090 Vali Acc: 0.340 Test Loss: 39.090 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.126906871795654
Epoch: 9, Steps: 25 | Train Loss: 3.111 Vali Loss: 31.600 Vali Acc: 0.480 Test Loss: 31.600 Test Acc: 0.480
Validation loss decreased (-0.419765 --> -0.479684).  Saving model ...
Epoch: 10 cost time: 14.150110006332397
Epoch: 10, Steps: 25 | Train Loss: 2.617 Vali Loss: 55.043 Vali Acc: 0.360 Test Loss: 55.043 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.149832725524902
Epoch: 11, Steps: 25 | Train Loss: 9.369 Vali Loss: 93.762 Vali Acc: 0.420 Test Loss: 93.762 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.107929468154907
Epoch: 12, Steps: 25 | Train Loss: 13.805 Vali Loss: 160.875 Vali Acc: 0.220 Test Loss: 160.875 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.132308959960938
Epoch: 13, Steps: 25 | Train Loss: 14.738 Vali Loss: 148.602 Vali Acc: 0.340 Test Loss: 148.602 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.148396730422974
Epoch: 14, Steps: 25 | Train Loss: 41.839 Vali Loss: 347.746 Vali Acc: 0.320 Test Loss: 347.746 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.110227823257446
Epoch: 15, Steps: 25 | Train Loss: 20.335 Vali Loss: 220.205 Vali Acc: 0.480 Test Loss: 220.205 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.132202863693237
Epoch: 16, Steps: 25 | Train Loss: 9.939 Vali Loss: 250.627 Vali Acc: 0.240 Test Loss: 250.627 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.138002157211304
Epoch: 17, Steps: 25 | Train Loss: 78.172 Vali Loss: 181.299 Vali Acc: 0.280 Test Loss: 181.299 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 14.12778115272522
Epoch: 18, Steps: 25 | Train Loss: 22.291 Vali Loss: 312.725 Vali Acc: 0.240 Test Loss: 312.725 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 14.129802942276001
Epoch: 19, Steps: 25 | Train Loss: 19.865 Vali Loss: 295.836 Vali Acc: 0.280 Test Loss: 295.836 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 2042858117
model size : 7795.53MB
2025-04-27 14:31:39.645239: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:31:39.662205: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764299.683919  178244 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764299.690435  178244 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:31:39.711687: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 15.206241130828857
Epoch: 1, Steps: 25 | Train Loss: 3.778 Vali Loss: 8.042 Vali Acc: 0.420 Test Loss: 8.042 Test Acc: 0.420
Validation loss decreased (inf --> -0.419920).  Saving model ...
Epoch: 2 cost time: 14.10154938697815
Epoch: 2, Steps: 25 | Train Loss: 2.100 Vali Loss: 16.402 Vali Acc: 0.420 Test Loss: 16.402 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.063429355621338
Epoch: 3, Steps: 25 | Train Loss: 0.376 Vali Loss: 30.995 Vali Acc: 0.360 Test Loss: 30.995 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.05446195602417
Epoch: 4, Steps: 25 | Train Loss: 1.739 Vali Loss: 25.294 Vali Acc: 0.380 Test Loss: 25.294 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.081162452697754
Epoch: 5, Steps: 25 | Train Loss: 2.225 Vali Loss: 41.542 Vali Acc: 0.420 Test Loss: 41.542 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.104206323623657
Epoch: 6, Steps: 25 | Train Loss: 2.567 Vali Loss: 53.022 Vali Acc: 0.400 Test Loss: 53.022 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.057910680770874
Epoch: 7, Steps: 25 | Train Loss: 1.421 Vali Loss: 32.572 Vali Acc: 0.460 Test Loss: 32.572 Test Acc: 0.460
Validation loss decreased (-0.419920 --> -0.459674).  Saving model ...
Epoch: 8 cost time: 14.135951042175293
Epoch: 8, Steps: 25 | Train Loss: 0.827 Vali Loss: 42.304 Vali Acc: 0.420 Test Loss: 42.304 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.062529802322388
Epoch: 9, Steps: 25 | Train Loss: 0.900 Vali Loss: 40.837 Vali Acc: 0.440 Test Loss: 40.837 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.077306747436523
Epoch: 10, Steps: 25 | Train Loss: 0.490 Vali Loss: 57.119 Vali Acc: 0.540 Test Loss: 57.119 Test Acc: 0.540
Validation loss decreased (-0.459674 --> -0.539429).  Saving model ...
Epoch: 11 cost time: 14.087996482849121
Epoch: 11, Steps: 25 | Train Loss: 20.596 Vali Loss: 55.465 Vali Acc: 0.440 Test Loss: 55.465 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.069596290588379
Epoch: 12, Steps: 25 | Train Loss: 0.011 Vali Loss: 130.295 Vali Acc: 0.340 Test Loss: 130.295 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.046873331069946
Epoch: 13, Steps: 25 | Train Loss: 12.184 Vali Loss: 164.478 Vali Acc: 0.360 Test Loss: 164.478 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.07233715057373
Epoch: 14, Steps: 25 | Train Loss: 20.434 Vali Loss: 67.450 Vali Acc: 0.380 Test Loss: 67.450 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.055629253387451
Epoch: 15, Steps: 25 | Train Loss: 48.767 Vali Loss: 373.335 Vali Acc: 0.300 Test Loss: 373.335 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.077031135559082
Epoch: 16, Steps: 25 | Train Loss: 62.232 Vali Loss: 100.133 Vali Acc: 0.280 Test Loss: 100.133 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.057533264160156
Epoch: 17, Steps: 25 | Train Loss: 58.109 Vali Loss: 340.374 Vali Acc: 0.300 Test Loss: 340.374 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.079123258590698
Epoch: 18, Steps: 25 | Train Loss: 59.284 Vali Loss: 293.795 Vali Acc: 0.380 Test Loss: 293.795 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.079332113265991
Epoch: 19, Steps: 25 | Train Loss: 79.755 Vali Loss: 348.022 Vali Acc: 0.360 Test Loss: 348.022 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 14.093250513076782
Epoch: 20, Steps: 25 | Train Loss: 30.619 Vali Loss: 653.024 Vali Acc: 0.200 Test Loss: 653.024 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2040277509
model size : 7785.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3067829608917236
Epoch: 1, Steps: 4 | Train Loss: 1.745 Vali Loss: 1.632 Vali Acc: 0.260 Test Loss: 1.632 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.528675079345703
Epoch: 2, Steps: 4 | Train Loss: 1.317 Vali Loss: 5.413 Vali Acc: 0.360 Test Loss: 5.413 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359946).  Saving model ...
Epoch: 3 cost time: 2.502772331237793
Epoch: 3, Steps: 4 | Train Loss: 0.186 Vali Loss: 10.231 Vali Acc: 0.300 Test Loss: 10.231 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5040462017059326
Epoch: 4, Steps: 4 | Train Loss: 0.258 Vali Loss: 13.299 Vali Acc: 0.460 Test Loss: 13.299 Test Acc: 0.460
Validation loss decreased (-0.359946 --> -0.459867).  Saving model ...
Epoch: 5 cost time: 2.5443503856658936
Epoch: 5, Steps: 4 | Train Loss: 0.019 Vali Loss: 23.393 Vali Acc: 0.280 Test Loss: 23.393 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.521266222000122
Epoch: 6, Steps: 4 | Train Loss: 0.964 Vali Loss: 24.806 Vali Acc: 0.300 Test Loss: 24.806 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4808220863342285
Epoch: 7, Steps: 4 | Train Loss: 0.052 Vali Loss: 29.179 Vali Acc: 0.520 Test Loss: 29.179 Test Acc: 0.520
Validation loss decreased (-0.459867 --> -0.519708).  Saving model ...
Epoch: 8 cost time: 2.5171234607696533
Epoch: 8, Steps: 4 | Train Loss: 0.024 Vali Loss: 38.668 Vali Acc: 0.500 Test Loss: 38.668 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4915812015533447
Epoch: 9, Steps: 4 | Train Loss: 2.636 Vali Loss: 27.289 Vali Acc: 0.500 Test Loss: 27.289 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4771173000335693
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 33.071 Vali Acc: 0.420 Test Loss: 33.071 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.494420289993286
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 41.303 Vali Acc: 0.400 Test Loss: 41.303 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.507324457168579
Epoch: 12, Steps: 4 | Train Loss: 0.342 Vali Loss: 45.638 Vali Acc: 0.400 Test Loss: 45.638 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4950661659240723
Epoch: 13, Steps: 4 | Train Loss: 0.132 Vali Loss: 34.106 Vali Acc: 0.440 Test Loss: 34.106 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5393800735473633
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.948 Vali Acc: 0.500 Test Loss: 23.948 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.465684652328491
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 20.302 Vali Acc: 0.460 Test Loss: 20.302 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4876601696014404
Epoch: 16, Steps: 4 | Train Loss: 0.111 Vali Loss: 35.258 Vali Acc: 0.420 Test Loss: 35.258 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4719221591949463
Epoch: 17, Steps: 4 | Train Loss: 0.155 Vali Loss: 55.562 Vali Acc: 0.420 Test Loss: 55.562 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1001885893
model size : 3823.22MB
2025-04-27 14:34:53.400935: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:34:53.421048: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764493.443287  186793 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764493.450116  186793 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:34:53.473940: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.864232301712036
Epoch: 1, Steps: 4 | Train Loss: 1.767 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 2.027794599533081
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 3.311 Vali Acc: 0.420 Test Loss: 3.311 Test Acc: 0.420
Validation loss decreased (-0.299985 --> -0.419967).  Saving model ...
Epoch: 3 cost time: 2.0592498779296875
Epoch: 3, Steps: 4 | Train Loss: 0.261 Vali Loss: 6.699 Vali Acc: 0.420 Test Loss: 6.699 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.982215404510498
Epoch: 4, Steps: 4 | Train Loss: 0.126 Vali Loss: 11.624 Vali Acc: 0.380 Test Loss: 11.624 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9724063873291016
Epoch: 5, Steps: 4 | Train Loss: 0.379 Vali Loss: 11.359 Vali Acc: 0.400 Test Loss: 11.359 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.001537322998047
Epoch: 6, Steps: 4 | Train Loss: 0.082 Vali Loss: 11.989 Vali Acc: 0.320 Test Loss: 11.989 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.002418041229248
Epoch: 7, Steps: 4 | Train Loss: 0.071 Vali Loss: 12.868 Vali Acc: 0.400 Test Loss: 12.868 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9823815822601318
Epoch: 8, Steps: 4 | Train Loss: 0.013 Vali Loss: 20.834 Vali Acc: 0.400 Test Loss: 20.834 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9687092304229736
Epoch: 9, Steps: 4 | Train Loss: 0.027 Vali Loss: 26.500 Vali Acc: 0.440 Test Loss: 26.500 Test Acc: 0.440
Validation loss decreased (-0.419967 --> -0.439735).  Saving model ...
Epoch: 10 cost time: 2.0347840785980225
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.954 Vali Acc: 0.460 Test Loss: 25.954 Test Acc: 0.460
Validation loss decreased (-0.439735 --> -0.459740).  Saving model ...
Epoch: 11 cost time: 2.0335326194763184
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.577 Vali Acc: 0.460 Test Loss: 25.577 Test Acc: 0.460
Validation loss decreased (-0.459740 --> -0.459744).  Saving model ...
Epoch: 12 cost time: 2.0375547409057617
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 26.109 Vali Acc: 0.480 Test Loss: 26.109 Test Acc: 0.480
Validation loss decreased (-0.459744 --> -0.479739).  Saving model ...
Epoch: 13 cost time: 2.051812171936035
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.532 Vali Acc: 0.440 Test Loss: 25.532 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.007321357727051
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 25.092 Vali Acc: 0.500 Test Loss: 25.092 Test Acc: 0.500
Validation loss decreased (-0.479739 --> -0.499749).  Saving model ...
Epoch: 15 cost time: 2.02718448638916
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.513 Vali Acc: 0.520 Test Loss: 24.513 Test Acc: 0.520
Validation loss decreased (-0.499749 --> -0.519755).  Saving model ...
Epoch: 16 cost time: 2.069672107696533
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.484 Vali Acc: 0.520 Test Loss: 24.484 Test Acc: 0.520
Validation loss decreased (-0.519755 --> -0.519755).  Saving model ...
Epoch: 17 cost time: 2.042475461959839
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.644 Vali Acc: 0.480 Test Loss: 24.644 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9939768314361572
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.788 Vali Acc: 0.460 Test Loss: 22.788 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0129613876342773
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.809 Vali Acc: 0.460 Test Loss: 22.809 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0038106441497803
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.639 Vali Acc: 0.480 Test Loss: 23.639 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.996037483215332
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.808 Vali Acc: 0.480 Test Loss: 23.808 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9887354373931885
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.762 Vali Acc: 0.480 Test Loss: 23.762 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.015279531478882
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.315 Vali Acc: 0.500 Test Loss: 24.315 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0035860538482666
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.981 Vali Acc: 0.480 Test Loss: 23.981 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9957776069641113
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.377 Vali Acc: 0.480 Test Loss: 24.377 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9736950397491455
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.650 Vali Acc: 0.500 Test Loss: 24.650 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 989404741
model size : 3775.61MB
2025-04-27 14:38:44.789404: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:38:44.808628: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764724.831305  199026 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764724.838097  199026 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:38:44.860738: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7876806259155273
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.626 Vali Acc: 0.320 Test Loss: 1.626 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.851179838180542
Epoch: 2, Steps: 4 | Train Loss: 1.027 Vali Loss: 2.859 Vali Acc: 0.380 Test Loss: 2.859 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379971).  Saving model ...
Epoch: 3 cost time: 1.861440658569336
Epoch: 3, Steps: 4 | Train Loss: 0.179 Vali Loss: 4.178 Vali Acc: 0.420 Test Loss: 4.178 Test Acc: 0.420
Validation loss decreased (-0.379971 --> -0.419958).  Saving model ...
Epoch: 4 cost time: 1.8502006530761719
Epoch: 4, Steps: 4 | Train Loss: 0.027 Vali Loss: 7.873 Vali Acc: 0.360 Test Loss: 7.873 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8345022201538086
Epoch: 5, Steps: 4 | Train Loss: 0.004 Vali Loss: 9.671 Vali Acc: 0.420 Test Loss: 9.671 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8048491477966309
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.736 Vali Acc: 0.440 Test Loss: 8.736 Test Acc: 0.440
Validation loss decreased (-0.419958 --> -0.439913).  Saving model ...
Epoch: 7 cost time: 1.8898887634277344
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.465 Vali Acc: 0.420 Test Loss: 9.465 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8333849906921387
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 10.555 Vali Acc: 0.440 Test Loss: 10.555 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8321738243103027
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.567 Vali Acc: 0.400 Test Loss: 11.567 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.822420597076416
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.034 Vali Acc: 0.420 Test Loss: 12.034 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8075971603393555
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.899 Vali Acc: 0.400 Test Loss: 11.899 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8224475383758545
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.253 Vali Acc: 0.380 Test Loss: 12.253 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.793738603591919
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.491 Vali Acc: 0.380 Test Loss: 12.491 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8208551406860352
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.946 Vali Acc: 0.400 Test Loss: 12.946 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8075425624847412
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.956 Vali Acc: 0.400 Test Loss: 12.956 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8209881782531738
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.589 Vali Acc: 0.380 Test Loss: 13.589 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 983379589
model size : 3752.62MB
2025-04-27 14:40:52.293783: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:40:52.313158: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764852.336377  206525 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764852.343363  206525 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:40:52.366299: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8010807037353516
Epoch: 1, Steps: 4 | Train Loss: 1.510 Vali Loss: 1.707 Vali Acc: 0.360 Test Loss: 1.707 Test Acc: 0.360
Validation loss decreased (inf --> -0.359983).  Saving model ...
Epoch: 2 cost time: 1.8550164699554443
Epoch: 2, Steps: 4 | Train Loss: 1.198 Vali Loss: 2.558 Vali Acc: 0.420 Test Loss: 2.558 Test Acc: 0.420
Validation loss decreased (-0.359983 --> -0.419974).  Saving model ...
Epoch: 3 cost time: 1.8650023937225342
Epoch: 3, Steps: 4 | Train Loss: 0.287 Vali Loss: 4.305 Vali Acc: 0.500 Test Loss: 4.305 Test Acc: 0.500
Validation loss decreased (-0.419974 --> -0.499957).  Saving model ...
Epoch: 4 cost time: 1.8412060737609863
Epoch: 4, Steps: 4 | Train Loss: 0.046 Vali Loss: 5.464 Vali Acc: 0.440 Test Loss: 5.464 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.826206922531128
Epoch: 5, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.167 Vali Acc: 0.440 Test Loss: 8.167 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.797814130783081
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.980 Vali Acc: 0.460 Test Loss: 9.980 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.788226842880249
Epoch: 7, Steps: 4 | Train Loss: 0.064 Vali Loss: 8.850 Vali Acc: 0.380 Test Loss: 8.850 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8077490329742432
Epoch: 8, Steps: 4 | Train Loss: 0.011 Vali Loss: 7.914 Vali Acc: 0.420 Test Loss: 7.914 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7876977920532227
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 11.137 Vali Acc: 0.400 Test Loss: 11.137 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7926726341247559
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 12.176 Vali Acc: 0.420 Test Loss: 12.176 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8062801361083984
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.475 Vali Acc: 0.420 Test Loss: 14.475 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8181564807891846
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.376 Vali Acc: 0.420 Test Loss: 16.376 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.807992696762085
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 17.824 Vali Acc: 0.400 Test Loss: 17.824 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 981227973
model size : 3744.42MB
2025-04-27 14:42:35.131834: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:42:35.150586: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745764955.173114  212644 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745764955.180210  212644 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:42:35.202649: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.666748285293579
Epoch: 1, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.530 Vali Acc: 0.380 Test Loss: 1.530 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 1.8166866302490234
Epoch: 2, Steps: 4 | Train Loss: 1.196 Vali Loss: 1.878 Vali Acc: 0.340 Test Loss: 1.878 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.79144287109375
Epoch: 3, Steps: 4 | Train Loss: 0.196 Vali Loss: 2.618 Vali Acc: 0.360 Test Loss: 2.618 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7785558700561523
Epoch: 4, Steps: 4 | Train Loss: 0.135 Vali Loss: 4.188 Vali Acc: 0.420 Test Loss: 4.188 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419958).  Saving model ...
Epoch: 5 cost time: 1.8160581588745117
Epoch: 5, Steps: 4 | Train Loss: 0.081 Vali Loss: 4.368 Vali Acc: 0.440 Test Loss: 4.368 Test Acc: 0.440
Validation loss decreased (-0.419958 --> -0.439956).  Saving model ...
Epoch: 6 cost time: 1.817617416381836
Epoch: 6, Steps: 4 | Train Loss: 0.007 Vali Loss: 5.669 Vali Acc: 0.540 Test Loss: 5.669 Test Acc: 0.540
Validation loss decreased (-0.439956 --> -0.539943).  Saving model ...
Epoch: 7 cost time: 1.7880444526672363
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.666 Vali Acc: 0.480 Test Loss: 6.666 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7771694660186768
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.412 Vali Acc: 0.400 Test Loss: 7.412 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7945356369018555
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.016 Vali Acc: 0.460 Test Loss: 8.016 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7927091121673584
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.479 Vali Acc: 0.460 Test Loss: 8.479 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7870090007781982
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 7.229 Vali Acc: 0.500 Test Loss: 7.229 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7934885025024414
Epoch: 12, Steps: 4 | Train Loss: 0.036 Vali Loss: 7.169 Vali Acc: 0.480 Test Loss: 7.169 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8139681816101074
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.432 Vali Acc: 0.540 Test Loss: 8.432 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7826037406921387
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.417 Vali Acc: 0.520 Test Loss: 9.417 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7724659442901611
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 9.070 Vali Acc: 0.540 Test Loss: 9.070 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.758852243423462
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.951 Vali Acc: 0.560 Test Loss: 8.951 Test Acc: 0.560
Validation loss decreased (-0.539943 --> -0.559910).  Saving model ...
Epoch: 17 cost time: 1.8384244441986084
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.076 Vali Acc: 0.500 Test Loss: 9.076 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7803003787994385
Epoch: 18, Steps: 4 | Train Loss: 0.018 Vali Loss: 12.141 Vali Acc: 0.500 Test Loss: 12.141 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7758362293243408
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.148 Vali Acc: 0.480 Test Loss: 15.148 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7612204551696777
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 18.835 Vali Acc: 0.440 Test Loss: 18.835 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.774148941040039
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.182 Vali Acc: 0.400 Test Loss: 22.182 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7471156120300293
Epoch: 22, Steps: 4 | Train Loss: 0.034 Vali Loss: 23.606 Vali Acc: 0.460 Test Loss: 23.606 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7665154933929443
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 18.324 Vali Acc: 0.460 Test Loss: 18.324 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7972280979156494
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 20.351 Vali Acc: 0.420 Test Loss: 20.351 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8033447265625
Epoch: 25, Steps: 4 | Train Loss: 0.018 Vali Loss: 14.773 Vali Acc: 0.480 Test Loss: 14.773 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.797224521636963
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 12.353 Vali Acc: 0.340 Test Loss: 12.353 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 978216069
model size : 3732.93MB
2025-04-27 14:45:31.450406: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:45:31.470011: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765131.492808  224505 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765131.499653  224505 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:45:31.522082: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.676755666732788
Epoch: 1, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.428 Vali Acc: 0.400 Test Loss: 1.428 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.8153035640716553
Epoch: 2, Steps: 4 | Train Loss: 1.227 Vali Loss: 1.803 Vali Acc: 0.380 Test Loss: 1.803 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7711694240570068
Epoch: 3, Steps: 4 | Train Loss: 0.374 Vali Loss: 2.134 Vali Acc: 0.380 Test Loss: 2.134 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.784142017364502
Epoch: 4, Steps: 4 | Train Loss: 0.150 Vali Loss: 3.888 Vali Acc: 0.320 Test Loss: 3.888 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7800664901733398
Epoch: 5, Steps: 4 | Train Loss: 0.067 Vali Loss: 4.702 Vali Acc: 0.440 Test Loss: 4.702 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439953).  Saving model ...
Epoch: 6 cost time: 1.8085482120513916
Epoch: 6, Steps: 4 | Train Loss: 0.012 Vali Loss: 5.738 Vali Acc: 0.420 Test Loss: 5.738 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7472114562988281
Epoch: 7, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.997 Vali Acc: 0.400 Test Loss: 6.997 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7597472667694092
Epoch: 8, Steps: 4 | Train Loss: 1.505 Vali Loss: 6.921 Vali Acc: 0.420 Test Loss: 6.921 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7700817584991455
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.424 Vali Acc: 0.400 Test Loss: 6.424 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7846739292144775
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 7.082 Vali Acc: 0.420 Test Loss: 7.082 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7614521980285645
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.148 Vali Acc: 0.400 Test Loss: 8.148 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8141155242919922
Epoch: 12, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.973 Vali Acc: 0.440 Test Loss: 6.973 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7878563404083252
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.825 Vali Acc: 0.360 Test Loss: 6.825 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7423067092895508
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.123 Vali Acc: 0.380 Test Loss: 7.123 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7383832931518555
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 9.476 Vali Acc: 0.400 Test Loss: 9.476 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 977356101
model size : 3729.65MB
2025-04-27 14:47:15.795596: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:47:15.814786: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765235.837279  231442 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765235.844146  231442 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:47:15.867096: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.617276430130005
Epoch: 1, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.521 Vali Acc: 0.440 Test Loss: 1.521 Test Acc: 0.440
Validation loss decreased (inf --> -0.439985).  Saving model ...
Epoch: 2 cost time: 1.7631561756134033
Epoch: 2, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.495 Vali Acc: 0.460 Test Loss: 1.495 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459985).  Saving model ...
Epoch: 3 cost time: 1.7490310668945312
Epoch: 3, Steps: 4 | Train Loss: 0.414 Vali Loss: 1.823 Vali Acc: 0.500 Test Loss: 1.823 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499982).  Saving model ...
Epoch: 4 cost time: 1.8097026348114014
Epoch: 4, Steps: 4 | Train Loss: 0.425 Vali Loss: 2.290 Vali Acc: 0.540 Test Loss: 2.290 Test Acc: 0.540
Validation loss decreased (-0.499982 --> -0.539977).  Saving model ...
Epoch: 5 cost time: 1.7707345485687256
Epoch: 5, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.829 Vali Acc: 0.500 Test Loss: 2.829 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7351908683776855
Epoch: 6, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.400 Vali Acc: 0.560 Test Loss: 4.400 Test Acc: 0.560
Validation loss decreased (-0.539977 --> -0.559956).  Saving model ...
Epoch: 7 cost time: 1.7793934345245361
Epoch: 7, Steps: 4 | Train Loss: 0.048 Vali Loss: 4.811 Vali Acc: 0.520 Test Loss: 4.811 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.763176441192627
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.820 Vali Acc: 0.440 Test Loss: 5.820 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7171316146850586
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.778 Vali Acc: 0.540 Test Loss: 5.778 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7473046779632568
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.205 Vali Acc: 0.540 Test Loss: 5.205 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7268147468566895
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.488 Vali Acc: 0.520 Test Loss: 5.488 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7261137962341309
Epoch: 12, Steps: 4 | Train Loss: 0.041 Vali Loss: 4.883 Vali Acc: 0.520 Test Loss: 4.883 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7238504886627197
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.419 Vali Acc: 0.360 Test Loss: 6.419 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7362351417541504
Epoch: 14, Steps: 4 | Train Loss: 0.176 Vali Loss: 5.926 Vali Acc: 0.480 Test Loss: 5.926 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7234611511230469
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.170 Vali Acc: 0.460 Test Loss: 6.170 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7249369621276855
Epoch: 16, Steps: 4 | Train Loss: 1.950 Vali Loss: 6.863 Vali Acc: 0.420 Test Loss: 6.863 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 976065797
model size : 3724.72MB
2025-04-27 14:49:36.960054: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:49:36.979048: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765377.001979  239033 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765377.008758  239033 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:49:37.031124: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3413758277893066
Epoch: 1, Steps: 4 | Train Loss: 1.630 Vali Loss: 1.618 Vali Acc: 0.260 Test Loss: 1.618 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.5226483345031738
Epoch: 2, Steps: 4 | Train Loss: 1.417 Vali Loss: 2.856 Vali Acc: 0.380 Test Loss: 2.856 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379971).  Saving model ...
Epoch: 3 cost time: 1.5440304279327393
Epoch: 3, Steps: 4 | Train Loss: 0.878 Vali Loss: 5.277 Vali Acc: 0.480 Test Loss: 5.277 Test Acc: 0.480
Validation loss decreased (-0.379971 --> -0.479947).  Saving model ...
Epoch: 4 cost time: 1.54520845413208
Epoch: 4, Steps: 4 | Train Loss: 0.649 Vali Loss: 9.718 Vali Acc: 0.440 Test Loss: 9.718 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5254201889038086
Epoch: 5, Steps: 4 | Train Loss: 2.633 Vali Loss: 10.865 Vali Acc: 0.400 Test Loss: 10.865 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5434095859527588
Epoch: 6, Steps: 4 | Train Loss: 0.026 Vali Loss: 11.817 Vali Acc: 0.460 Test Loss: 11.817 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5344157218933105
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 17.946 Vali Acc: 0.460 Test Loss: 17.946 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5466749668121338
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.726 Vali Acc: 0.400 Test Loss: 21.726 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5303008556365967
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 22.660 Vali Acc: 0.480 Test Loss: 22.660 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5158562660217285
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.556 Vali Acc: 0.440 Test Loss: 23.556 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5394306182861328
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 21.843 Vali Acc: 0.480 Test Loss: 21.843 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5240371227264404
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.069 Vali Acc: 0.360 Test Loss: 22.069 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5225579738616943
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 20.013 Vali Acc: 0.440 Test Loss: 20.013 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 489924709
model size : 1869.58MB
2025-04-27 14:50:53.356031: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:50:53.374996: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765453.397630  244973 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765453.404398  244973 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:50:53.426857: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.130641460418701
Epoch: 1, Steps: 4 | Train Loss: 1.726 Vali Loss: 1.520 Vali Acc: 0.400 Test Loss: 1.520 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.31416916847229
Epoch: 2, Steps: 4 | Train Loss: 1.017 Vali Loss: 2.581 Vali Acc: 0.540 Test Loss: 2.581 Test Acc: 0.540
Validation loss decreased (-0.399985 --> -0.539974).  Saving model ...
Epoch: 3 cost time: 1.2926216125488281
Epoch: 3, Steps: 4 | Train Loss: 0.225 Vali Loss: 4.004 Vali Acc: 0.540 Test Loss: 4.004 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3151113986968994
Epoch: 4, Steps: 4 | Train Loss: 0.021 Vali Loss: 7.708 Vali Acc: 0.420 Test Loss: 7.708 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2775328159332275
Epoch: 5, Steps: 4 | Train Loss: 0.076 Vali Loss: 8.451 Vali Acc: 0.500 Test Loss: 8.451 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2958126068115234
Epoch: 6, Steps: 4 | Train Loss: 0.077 Vali Loss: 9.559 Vali Acc: 0.480 Test Loss: 9.559 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.250647783279419
Epoch: 7, Steps: 4 | Train Loss: 0.067 Vali Loss: 8.431 Vali Acc: 0.440 Test Loss: 8.431 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2345514297485352
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 9.032 Vali Acc: 0.520 Test Loss: 9.032 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2611708641052246
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.818 Vali Acc: 0.540 Test Loss: 9.818 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2729756832122803
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 10.139 Vali Acc: 0.500 Test Loss: 10.139 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.249800682067871
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.581 Vali Acc: 0.300 Test Loss: 12.581 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2765495777130127
Epoch: 12, Steps: 4 | Train Loss: 0.534 Vali Loss: 10.779 Vali Acc: 0.480 Test Loss: 10.779 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 483684133
model size : 1845.78MB
2025-04-27 14:51:55.661667: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:51:55.680294: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765515.702975  250407 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765515.709704  250407 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:51:55.731860: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.040510654449463
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.507 Vali Acc: 0.320 Test Loss: 1.507 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.1764862537384033
Epoch: 2, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.896 Vali Acc: 0.440 Test Loss: 1.896 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439981).  Saving model ...
Epoch: 3 cost time: 1.2091422080993652
Epoch: 3, Steps: 4 | Train Loss: 0.297 Vali Loss: 2.478 Vali Acc: 0.420 Test Loss: 2.478 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1613852977752686
Epoch: 4, Steps: 4 | Train Loss: 0.426 Vali Loss: 3.030 Vali Acc: 0.460 Test Loss: 3.030 Test Acc: 0.460
Validation loss decreased (-0.439981 --> -0.459970).  Saving model ...
Epoch: 5 cost time: 1.194084882736206
Epoch: 5, Steps: 4 | Train Loss: 0.158 Vali Loss: 4.727 Vali Acc: 0.480 Test Loss: 4.727 Test Acc: 0.480
Validation loss decreased (-0.459970 --> -0.479953).  Saving model ...
Epoch: 6 cost time: 1.177527904510498
Epoch: 6, Steps: 4 | Train Loss: 0.020 Vali Loss: 5.576 Vali Acc: 0.480 Test Loss: 5.576 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.174426555633545
Epoch: 7, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.350 Vali Acc: 0.480 Test Loss: 6.350 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1704449653625488
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.888 Vali Acc: 0.560 Test Loss: 6.888 Test Acc: 0.560
Validation loss decreased (-0.479953 --> -0.559931).  Saving model ...
Epoch: 9 cost time: 1.1827528476715088
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.886 Vali Acc: 0.580 Test Loss: 6.886 Test Acc: 0.580
Validation loss decreased (-0.559931 --> -0.579931).  Saving model ...
Epoch: 10 cost time: 1.2073640823364258
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.936 Vali Acc: 0.560 Test Loss: 6.936 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1990935802459717
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.711 Vali Acc: 0.540 Test Loss: 6.711 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1497409343719482
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.765 Vali Acc: 0.540 Test Loss: 6.765 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1793038845062256
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.334 Vali Acc: 0.540 Test Loss: 7.334 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1840934753417969
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.818 Vali Acc: 0.540 Test Loss: 7.818 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1679654121398926
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.067 Vali Acc: 0.540 Test Loss: 8.067 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1597235202789307
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.318 Vali Acc: 0.540 Test Loss: 8.318 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1376750469207764
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.450 Vali Acc: 0.540 Test Loss: 8.450 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.172689437866211
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.885 Vali Acc: 0.520 Test Loss: 7.885 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1394469738006592
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.210 Vali Acc: 0.560 Test Loss: 8.210 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 480671557
model size : 1834.29MB
2025-04-27 14:53:31.836523: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:53:31.855329: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765611.877079  258876 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765611.883817  258876 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:53:31.905753: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0111894607543945
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.481 Vali Acc: 0.380 Test Loss: 1.481 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 1.1811258792877197
Epoch: 2, Steps: 4 | Train Loss: 1.019 Vali Loss: 1.767 Vali Acc: 0.420 Test Loss: 1.767 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419982).  Saving model ...
Epoch: 3 cost time: 1.173527717590332
Epoch: 3, Steps: 4 | Train Loss: 0.273 Vali Loss: 2.743 Vali Acc: 0.440 Test Loss: 2.743 Test Acc: 0.440
Validation loss decreased (-0.419982 --> -0.439973).  Saving model ...
Epoch: 4 cost time: 1.191962718963623
Epoch: 4, Steps: 4 | Train Loss: 0.119 Vali Loss: 4.920 Vali Acc: 0.400 Test Loss: 4.920 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1479978561401367
Epoch: 5, Steps: 4 | Train Loss: 0.839 Vali Loss: 4.612 Vali Acc: 0.500 Test Loss: 4.612 Test Acc: 0.500
Validation loss decreased (-0.439973 --> -0.499954).  Saving model ...
Epoch: 6 cost time: 1.1932456493377686
Epoch: 6, Steps: 4 | Train Loss: 0.026 Vali Loss: 4.758 Vali Acc: 0.440 Test Loss: 4.758 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2105481624603271
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.670 Vali Acc: 0.420 Test Loss: 5.670 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1291847229003906
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.288 Vali Acc: 0.420 Test Loss: 6.288 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1799635887145996
Epoch: 9, Steps: 4 | Train Loss: 0.042 Vali Loss: 6.248 Vali Acc: 0.380 Test Loss: 6.248 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1415483951568604
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.738 Vali Acc: 0.400 Test Loss: 5.738 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.179870367050171
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.958 Vali Acc: 0.400 Test Loss: 4.958 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1579859256744385
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.340 Vali Acc: 0.420 Test Loss: 5.340 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.139692783355713
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.761 Vali Acc: 0.480 Test Loss: 5.761 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1553268432617188
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.188 Vali Acc: 0.460 Test Loss: 6.188 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1386308670043945
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.609 Vali Acc: 0.500 Test Loss: 6.609 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 479595749
model size : 1830.18MB
2025-04-27 14:54:53.694443: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:54:53.713244: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765693.735368  265643 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765693.742081  265643 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:54:53.764258: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1033568382263184
Epoch: 1, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.520 Vali Acc: 0.300 Test Loss: 1.520 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.1605675220489502
Epoch: 2, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.765 Vali Acc: 0.380 Test Loss: 1.765 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379982).  Saving model ...
Epoch: 3 cost time: 1.1774437427520752
Epoch: 3, Steps: 4 | Train Loss: 0.892 Vali Loss: 2.094 Vali Acc: 0.440 Test Loss: 2.094 Test Acc: 0.440
Validation loss decreased (-0.379982 --> -0.439979).  Saving model ...
Epoch: 4 cost time: 1.1967628002166748
Epoch: 4, Steps: 4 | Train Loss: 0.165 Vali Loss: 2.427 Vali Acc: 0.500 Test Loss: 2.427 Test Acc: 0.500
Validation loss decreased (-0.439979 --> -0.499976).  Saving model ...
Epoch: 5 cost time: 1.2175829410552979
Epoch: 5, Steps: 4 | Train Loss: 0.067 Vali Loss: 2.918 Vali Acc: 0.540 Test Loss: 2.918 Test Acc: 0.540
Validation loss decreased (-0.499976 --> -0.539971).  Saving model ...
Epoch: 6 cost time: 1.183058738708496
Epoch: 6, Steps: 4 | Train Loss: 0.017 Vali Loss: 4.164 Vali Acc: 0.480 Test Loss: 4.164 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1345934867858887
Epoch: 7, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.130 Vali Acc: 0.460 Test Loss: 5.130 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.168144702911377
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.356 Vali Acc: 0.460 Test Loss: 5.356 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1488564014434814
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.425 Vali Acc: 0.480 Test Loss: 5.425 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.146885633468628
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.615 Vali Acc: 0.480 Test Loss: 5.615 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.150733232498169
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.715 Vali Acc: 0.500 Test Loss: 5.715 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1481852531433105
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.766 Vali Acc: 0.500 Test Loss: 5.766 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1732711791992188
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.651 Vali Acc: 0.480 Test Loss: 5.651 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.159245491027832
Epoch: 14, Steps: 4 | Train Loss: 0.052 Vali Loss: 4.380 Vali Acc: 0.480 Test Loss: 4.380 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1460685729980469
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.163 Vali Acc: 0.400 Test Loss: 5.163 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 478089797
model size : 1824.44MB
2025-04-27 14:56:16.458639: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:56:16.479329: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765776.502637  272415 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765776.509516  272415 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:56:16.532545: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0562002658843994
Epoch: 1, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
Validation loss decreased (inf --> -0.419984).  Saving model ...
Epoch: 2 cost time: 1.1653757095336914
Epoch: 2, Steps: 4 | Train Loss: 0.961 Vali Loss: 1.539 Vali Acc: 0.360 Test Loss: 1.539 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1507935523986816
Epoch: 3, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.676 Vali Acc: 0.480 Test Loss: 1.676 Test Acc: 0.480
Validation loss decreased (-0.419984 --> -0.479983).  Saving model ...
Epoch: 4 cost time: 1.1588730812072754
Epoch: 4, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.991 Vali Acc: 0.560 Test Loss: 1.991 Test Acc: 0.560
Validation loss decreased (-0.479983 --> -0.559980).  Saving model ...
Epoch: 5 cost time: 1.1607964038848877
Epoch: 5, Steps: 4 | Train Loss: 0.071 Vali Loss: 2.055 Vali Acc: 0.480 Test Loss: 2.055 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0933873653411865
Epoch: 6, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.511 Vali Acc: 0.500 Test Loss: 2.511 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.071840763092041
Epoch: 7, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.226 Vali Acc: 0.480 Test Loss: 3.226 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1130247116088867
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.633 Vali Acc: 0.500 Test Loss: 3.633 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.113431692123413
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.922 Vali Acc: 0.480 Test Loss: 3.922 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.097829818725586
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.022 Vali Acc: 0.460 Test Loss: 4.022 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1035010814666748
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.071 Vali Acc: 0.520 Test Loss: 4.071 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0953810214996338
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.073 Vali Acc: 0.480 Test Loss: 4.073 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1021983623504639
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.360 Vali Acc: 0.520 Test Loss: 4.360 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1496150493621826
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.517 Vali Acc: 0.500 Test Loss: 4.517 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 477659813
model size : 1822.80MB
2025-04-27 14:57:25.539339: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:57:25.559096: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765845.581684  278693 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765845.588532  278693 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:57:25.611803: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9572415351867676
Epoch: 1, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.530 Vali Acc: 0.340 Test Loss: 1.530 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.1308865547180176
Epoch: 2, Steps: 4 | Train Loss: 1.153 Vali Loss: 1.467 Vali Acc: 0.420 Test Loss: 1.467 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419985).  Saving model ...
Epoch: 3 cost time: 1.1390628814697266
Epoch: 3, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.581 Vali Acc: 0.480 Test Loss: 1.581 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479984).  Saving model ...
Epoch: 4 cost time: 1.1475176811218262
Epoch: 4, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.934 Vali Acc: 0.520 Test Loss: 1.934 Test Acc: 0.520
Validation loss decreased (-0.479984 --> -0.519981).  Saving model ...
Epoch: 5 cost time: 1.1473283767700195
Epoch: 5, Steps: 4 | Train Loss: 0.114 Vali Loss: 2.251 Vali Acc: 0.560 Test Loss: 2.251 Test Acc: 0.560
Validation loss decreased (-0.519981 --> -0.559977).  Saving model ...
Epoch: 6 cost time: 1.1429717540740967
Epoch: 6, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.690 Vali Acc: 0.520 Test Loss: 2.690 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1166794300079346
Epoch: 7, Steps: 4 | Train Loss: 0.026 Vali Loss: 3.054 Vali Acc: 0.520 Test Loss: 3.054 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1127979755401611
Epoch: 8, Steps: 4 | Train Loss: 0.039 Vali Loss: 3.240 Vali Acc: 0.520 Test Loss: 3.240 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0847737789154053
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.906 Vali Acc: 0.520 Test Loss: 3.906 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.09661865234375
Epoch: 10, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.602 Vali Acc: 0.500 Test Loss: 3.602 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1067383289337158
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.768 Vali Acc: 0.460 Test Loss: 3.768 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1218299865722656
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.892 Vali Acc: 0.500 Test Loss: 3.892 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1332125663757324
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.077 Vali Acc: 0.520 Test Loss: 4.077 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1044549942016602
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.047 Vali Acc: 0.540 Test Loss: 4.047 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1241323947906494
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.161 Vali Acc: 0.520 Test Loss: 6.161 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 477014661
model size : 1820.34MB
2025-04-27 14:58:46.636470: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 14:58:46.655351: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745765926.677521  285453 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745765926.684237  285453 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 14:58:46.706440: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.1780846118927
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.558 Vali Acc: 0.300 Test Loss: 1.558 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 3.0869274139404297
Epoch: 2, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.807 Vali Acc: 0.380 Test Loss: 1.807 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379982).  Saving model ...
Epoch: 3 cost time: 3.0798697471618652
Epoch: 3, Steps: 4 | Train Loss: 0.166 Vali Loss: 2.793 Vali Acc: 0.360 Test Loss: 2.793 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0365872383117676
Epoch: 4, Steps: 4 | Train Loss: 0.073 Vali Loss: 6.545 Vali Acc: 0.340 Test Loss: 6.545 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0259768962860107
Epoch: 5, Steps: 4 | Train Loss: 0.526 Vali Loss: 7.773 Vali Acc: 0.420 Test Loss: 7.773 Test Acc: 0.420
Validation loss decreased (-0.379982 --> -0.419922).  Saving model ...
Epoch: 6 cost time: 3.0740928649902344
Epoch: 6, Steps: 4 | Train Loss: 0.088 Vali Loss: 7.316 Vali Acc: 0.440 Test Loss: 7.316 Test Acc: 0.440
Validation loss decreased (-0.419922 --> -0.439927).  Saving model ...
Epoch: 7 cost time: 3.0684263706207275
Epoch: 7, Steps: 4 | Train Loss: 0.043 Vali Loss: 7.431 Vali Acc: 0.360 Test Loss: 7.431 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0290093421936035
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 9.435 Vali Acc: 0.460 Test Loss: 9.435 Test Acc: 0.460
Validation loss decreased (-0.439927 --> -0.459906).  Saving model ...
Epoch: 9 cost time: 3.0834577083587646
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 11.856 Vali Acc: 0.440 Test Loss: 11.856 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.02925705909729
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.302 Vali Acc: 0.440 Test Loss: 13.302 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0252931118011475
Epoch: 11, Steps: 4 | Train Loss: 0.026 Vali Loss: 11.543 Vali Acc: 0.500 Test Loss: 11.543 Test Acc: 0.500
Validation loss decreased (-0.459906 --> -0.499885).  Saving model ...
Epoch: 12 cost time: 3.0737874507904053
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.753 Vali Acc: 0.440 Test Loss: 11.753 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.074540853500366
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.770 Vali Acc: 0.380 Test Loss: 11.770 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.058145046234131
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 11.547 Vali Acc: 0.340 Test Loss: 11.547 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0849316120147705
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.318 Vali Acc: 0.360 Test Loss: 11.318 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0903258323669434
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.422 Vali Acc: 0.440 Test Loss: 10.422 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0727360248565674
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.490 Vali Acc: 0.520 Test Loss: 9.490 Test Acc: 0.520
Validation loss decreased (-0.499885 --> -0.519905).  Saving model ...
Epoch: 18 cost time: 3.104067802429199
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.812 Vali Acc: 0.520 Test Loss: 9.812 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0588009357452393
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.631 Vali Acc: 0.520 Test Loss: 9.631 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0569374561309814
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.646 Vali Acc: 0.540 Test Loss: 9.646 Test Acc: 0.540
Validation loss decreased (-0.519905 --> -0.539904).  Saving model ...
Epoch: 21 cost time: 3.0865769386291504
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.065 Vali Acc: 0.520 Test Loss: 10.065 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0455644130706787
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.815 Vali Acc: 0.540 Test Loss: 9.815 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.061525583267212
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.492 Vali Acc: 0.480 Test Loss: 9.492 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.046814203262329
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.755 Vali Acc: 0.500 Test Loss: 9.755 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.055652141571045
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.951 Vali Acc: 0.500 Test Loss: 9.951 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.0441524982452393
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.112 Vali Acc: 0.520 Test Loss: 10.112 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.0407750606536865
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.428 Vali Acc: 0.540 Test Loss: 10.428 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.0742335319519043
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.526 Vali Acc: 0.520 Test Loss: 10.526 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.052294969558716
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.613 Vali Acc: 0.520 Test Loss: 10.613 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.0656559467315674
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.828 Vali Acc: 0.540 Test Loss: 9.828 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1759668997
model size : 6717.24MB
2025-04-27 15:04:32.221859: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:04:32.240620: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745766272.262589  300024 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745766272.269318  300024 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:04:32.291469: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.698976755142212
Epoch: 1, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.494 Vali Acc: 0.340 Test Loss: 1.494 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 2.811554193496704
Epoch: 2, Steps: 4 | Train Loss: 0.936 Vali Loss: 2.097 Vali Acc: 0.380 Test Loss: 2.097 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379979).  Saving model ...
Epoch: 3 cost time: 2.802638530731201
Epoch: 3, Steps: 4 | Train Loss: 0.277 Vali Loss: 2.091 Vali Acc: 0.440 Test Loss: 2.091 Test Acc: 0.440
Validation loss decreased (-0.379979 --> -0.439979).  Saving model ...
Epoch: 4 cost time: 2.800170421600342
Epoch: 4, Steps: 4 | Train Loss: 0.436 Vali Loss: 3.782 Vali Acc: 0.460 Test Loss: 3.782 Test Acc: 0.460
Validation loss decreased (-0.439979 --> -0.459962).  Saving model ...
Epoch: 5 cost time: 2.7952401638031006
Epoch: 5, Steps: 4 | Train Loss: 0.188 Vali Loss: 5.968 Vali Acc: 0.440 Test Loss: 5.968 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.747445583343506
Epoch: 6, Steps: 4 | Train Loss: 0.086 Vali Loss: 6.120 Vali Acc: 0.500 Test Loss: 6.120 Test Acc: 0.500
Validation loss decreased (-0.459962 --> -0.499939).  Saving model ...
Epoch: 7 cost time: 2.7806549072265625
Epoch: 7, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.920 Vali Acc: 0.420 Test Loss: 5.920 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.752082109451294
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 7.298 Vali Acc: 0.440 Test Loss: 7.298 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7501962184906006
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.840 Vali Acc: 0.400 Test Loss: 8.840 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.744433879852295
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.708 Vali Acc: 0.380 Test Loss: 9.708 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7376394271850586
Epoch: 11, Steps: 4 | Train Loss: 0.044 Vali Loss: 8.077 Vali Acc: 0.360 Test Loss: 8.077 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7434804439544678
Epoch: 12, Steps: 4 | Train Loss: 0.035 Vali Loss: 6.155 Vali Acc: 0.360 Test Loss: 6.155 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7405948638916016
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.520 Vali Acc: 0.360 Test Loss: 6.520 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7409989833831787
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.808 Vali Acc: 0.460 Test Loss: 6.808 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7453246116638184
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.059 Vali Acc: 0.500 Test Loss: 7.059 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.744450807571411
Epoch: 16, Steps: 4 | Train Loss: 0.019 Vali Loss: 7.402 Vali Acc: 0.460 Test Loss: 7.402 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1753643621
model size : 6694.26MB
2025-04-27 15:08:03.502180: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:08:03.521307: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745766483.543333  308078 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745766483.550114  308078 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:08:03.572758: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.568359136581421
Epoch: 1, Steps: 4 | Train Loss: 1.490 Vali Loss: 1.608 Vali Acc: 0.340 Test Loss: 1.608 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 2.6155052185058594
Epoch: 2, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.533 Vali Acc: 0.360 Test Loss: 1.533 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 2.6358182430267334
Epoch: 3, Steps: 4 | Train Loss: 0.376 Vali Loss: 1.767 Vali Acc: 0.380 Test Loss: 1.767 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379982).  Saving model ...
Epoch: 4 cost time: 2.6355879306793213
Epoch: 4, Steps: 4 | Train Loss: 0.097 Vali Loss: 2.288 Vali Acc: 0.480 Test Loss: 2.288 Test Acc: 0.480
Validation loss decreased (-0.379982 --> -0.479977).  Saving model ...
Epoch: 5 cost time: 2.633600950241089
Epoch: 5, Steps: 4 | Train Loss: 0.037 Vali Loss: 2.667 Vali Acc: 0.440 Test Loss: 2.667 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5921432971954346
Epoch: 6, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.408 Vali Acc: 0.440 Test Loss: 3.408 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5925657749176025
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.983 Vali Acc: 0.400 Test Loss: 3.983 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5982489585876465
Epoch: 8, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.449 Vali Acc: 0.480 Test Loss: 3.449 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.622596025466919
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.943 Vali Acc: 0.420 Test Loss: 3.943 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.602461338043213
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.295 Vali Acc: 0.440 Test Loss: 4.295 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.593437910079956
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.853 Vali Acc: 0.480 Test Loss: 4.853 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.597658157348633
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.991 Vali Acc: 0.460 Test Loss: 4.991 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5828590393066406
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.042 Vali Acc: 0.460 Test Loss: 5.042 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.601562976837158
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.395 Vali Acc: 0.420 Test Loss: 4.395 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1750200645
model size : 6681.12MB
2025-04-27 15:11:03.326187: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:11:03.345238: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745766663.366927  315094 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745766663.373745  315094 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:11:03.396228: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6047775745391846
Epoch: 1, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.593 Vali Acc: 0.260 Test Loss: 1.593 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.6117584705352783
Epoch: 2, Steps: 4 | Train Loss: 1.111 Vali Loss: 1.491 Vali Acc: 0.340 Test Loss: 1.491 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 2.6265006065368652
Epoch: 3, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.632 Vali Acc: 0.360 Test Loss: 1.632 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 2.592226982116699
Epoch: 4, Steps: 4 | Train Loss: 0.137 Vali Loss: 2.285 Vali Acc: 0.400 Test Loss: 2.285 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399977).  Saving model ...
Epoch: 5 cost time: 2.6184535026550293
Epoch: 5, Steps: 4 | Train Loss: 0.152 Vali Loss: 2.511 Vali Acc: 0.360 Test Loss: 2.511 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.570481061935425
Epoch: 6, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.573 Vali Acc: 0.480 Test Loss: 2.573 Test Acc: 0.480
Validation loss decreased (-0.399977 --> -0.479974).  Saving model ...
Epoch: 7 cost time: 2.6308703422546387
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 3.237 Vali Acc: 0.440 Test Loss: 3.237 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5686426162719727
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.319 Vali Acc: 0.420 Test Loss: 4.319 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5733251571655273
Epoch: 9, Steps: 4 | Train Loss: 0.054 Vali Loss: 3.454 Vali Acc: 0.440 Test Loss: 3.454 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5754899978637695
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.431 Vali Acc: 0.400 Test Loss: 3.431 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.577512264251709
Epoch: 11, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.379 Vali Acc: 0.480 Test Loss: 3.379 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6059839725494385
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.732 Vali Acc: 0.500 Test Loss: 3.732 Test Acc: 0.500
Validation loss decreased (-0.479974 --> -0.499963).  Saving model ...
Epoch: 13 cost time: 2.6095082759857178
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.099 Vali Acc: 0.480 Test Loss: 4.099 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5666704177856445
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.055 Vali Acc: 0.520 Test Loss: 4.055 Test Acc: 0.520
Validation loss decreased (-0.499963 --> -0.519959).  Saving model ...
Epoch: 15 cost time: 2.5940020084381104
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.249 Vali Acc: 0.480 Test Loss: 4.249 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5686466693878174
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.901 Vali Acc: 0.460 Test Loss: 3.901 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5721871852874756
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.030 Vali Acc: 0.440 Test Loss: 4.030 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.574413299560547
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.105 Vali Acc: 0.420 Test Loss: 4.105 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5687625408172607
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.380 Vali Acc: 0.460 Test Loss: 4.380 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5877137184143066
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.507 Vali Acc: 0.460 Test Loss: 4.507 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.577202558517456
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.539 Vali Acc: 0.460 Test Loss: 4.539 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.573387622833252
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.756 Vali Acc: 0.480 Test Loss: 4.756 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5957541465759277
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.388 Vali Acc: 0.440 Test Loss: 4.388 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5690267086029053
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.589 Vali Acc: 0.480 Test Loss: 4.589 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1749340037
model size : 6677.84MB
2025-04-27 15:15:53.420031: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:15:53.439563: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745766953.462027  326878 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745766953.468768  326878 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:15:53.491724: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.528082847595215
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.552 Vali Acc: 0.380 Test Loss: 1.552 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 2.536856174468994
Epoch: 2, Steps: 4 | Train Loss: 1.131 Vali Loss: 1.499 Vali Acc: 0.380 Test Loss: 1.499 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 2.5414013862609863
Epoch: 3, Steps: 4 | Train Loss: 0.598 Vali Loss: 1.595 Vali Acc: 0.460 Test Loss: 1.595 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459984).  Saving model ...
Epoch: 4 cost time: 2.551046133041382
Epoch: 4, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.727 Vali Acc: 0.560 Test Loss: 1.727 Test Acc: 0.560
Validation loss decreased (-0.459984 --> -0.559983).  Saving model ...
Epoch: 5 cost time: 2.5535569190979004
Epoch: 5, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.863 Vali Acc: 0.640 Test Loss: 1.863 Test Acc: 0.640
Validation loss decreased (-0.559983 --> -0.639981).  Saving model ...
Epoch: 6 cost time: 2.5563671588897705
Epoch: 6, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.711 Vali Acc: 0.500 Test Loss: 2.711 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.494929552078247
Epoch: 7, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.637 Vali Acc: 0.460 Test Loss: 3.637 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5193569660186768
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.115 Vali Acc: 0.480 Test Loss: 4.115 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4959516525268555
Epoch: 9, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.339 Vali Acc: 0.520 Test Loss: 4.339 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4931728839874268
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.742 Vali Acc: 0.560 Test Loss: 4.742 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5039947032928467
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.726 Vali Acc: 0.480 Test Loss: 4.726 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.498466968536377
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.954 Vali Acc: 0.500 Test Loss: 4.954 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5031540393829346
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.724 Vali Acc: 0.560 Test Loss: 4.724 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5240554809570312
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.563 Vali Acc: 0.580 Test Loss: 4.563 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.505427837371826
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.313 Vali Acc: 0.580 Test Loss: 4.313 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 1747618885
model size : 6671.27MB
2025-04-27 15:19:11.457786: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:19:11.478188: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745767151.501285  334442 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745767151.508322  334442 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:19:11.531452: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4798755645751953
Epoch: 1, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.594 Vali Acc: 0.200 Test Loss: 1.594 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.5372297763824463
Epoch: 2, Steps: 4 | Train Loss: 1.077 Vali Loss: 1.449 Vali Acc: 0.380 Test Loss: 1.449 Test Acc: 0.380
Validation loss decreased (-0.199984 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 2.5213727951049805
Epoch: 3, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.448 Vali Acc: 0.420 Test Loss: 1.448 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 2.533989906311035
Epoch: 4, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.604 Vali Acc: 0.460 Test Loss: 1.604 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459984).  Saving model ...
Epoch: 5 cost time: 2.5646722316741943
Epoch: 5, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.804 Vali Acc: 0.420 Test Loss: 1.804 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.486753225326538
Epoch: 6, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.899 Vali Acc: 0.460 Test Loss: 1.899 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5106911659240723
Epoch: 7, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.235 Vali Acc: 0.520 Test Loss: 2.235 Test Acc: 0.520
Validation loss decreased (-0.459984 --> -0.519978).  Saving model ...
Epoch: 8 cost time: 2.5489635467529297
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.685 Vali Acc: 0.480 Test Loss: 2.685 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4947657585144043
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.171 Vali Acc: 0.440 Test Loss: 3.171 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.490295171737671
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.511 Vali Acc: 0.440 Test Loss: 3.511 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4931693077087402
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.579 Vali Acc: 0.460 Test Loss: 3.579 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5035603046417236
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.651 Vali Acc: 0.420 Test Loss: 3.651 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.498288869857788
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.739 Vali Acc: 0.420 Test Loss: 3.739 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.507324457168579
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.601 Vali Acc: 0.440 Test Loss: 3.601 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.497750759124756
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.630 Vali Acc: 0.440 Test Loss: 3.630 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4963040351867676
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.493 Vali Acc: 0.440 Test Loss: 3.493 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5268936157226562
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.599 Vali Acc: 0.480 Test Loss: 3.599 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1747619301
model size : 6671.27MB
2025-04-27 15:22:39.246594: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:22:39.266120: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745767359.288035  342901 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745767359.294709  342901 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:22:39.316951: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6836910247802734
Epoch: 1, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.558 Vali Acc: 0.400 Test Loss: 1.558 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 2.516411304473877
Epoch: 2, Steps: 4 | Train Loss: 1.171 Vali Loss: 1.480 Vali Acc: 0.380 Test Loss: 1.480 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4685468673706055
Epoch: 3, Steps: 4 | Train Loss: 0.650 Vali Loss: 1.457 Vali Acc: 0.400 Test Loss: 1.457 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 2.4923324584960938
Epoch: 4, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.499 Vali Acc: 0.460 Test Loss: 1.499 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 2.4503793716430664
Epoch: 5, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.699 Vali Acc: 0.500 Test Loss: 1.699 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499983).  Saving model ...
Epoch: 6 cost time: 2.4271929264068604
Epoch: 6, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.822 Vali Acc: 0.540 Test Loss: 1.822 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539982).  Saving model ...
Epoch: 7 cost time: 2.463204860687256
Epoch: 7, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.982 Vali Acc: 0.480 Test Loss: 1.982 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.40873646736145
Epoch: 8, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.293 Vali Acc: 0.540 Test Loss: 2.293 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.396897554397583
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.729 Vali Acc: 0.520 Test Loss: 2.729 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4004464149475098
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.971 Vali Acc: 0.520 Test Loss: 2.971 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.402818202972412
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.047 Vali Acc: 0.480 Test Loss: 3.047 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4195785522460938
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.138 Vali Acc: 0.480 Test Loss: 3.138 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4011051654815674
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.946 Vali Acc: 0.560 Test Loss: 2.946 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559971).  Saving model ...
Epoch: 14 cost time: 2.417064666748047
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.352 Vali Acc: 0.560 Test Loss: 2.352 Test Acc: 0.560
Validation loss decreased (-0.559971 --> -0.559976).  Saving model ...
Epoch: 15 cost time: 2.4157826900482178
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.098 Vali Acc: 0.580 Test Loss: 2.098 Test Acc: 0.580
Validation loss decreased (-0.559976 --> -0.579979).  Saving model ...
Epoch: 16 cost time: 2.419703960418701
Epoch: 16, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.275 Vali Acc: 0.600 Test Loss: 2.275 Test Acc: 0.600
Validation loss decreased (-0.579979 --> -0.599977).  Saving model ...
Epoch: 17 cost time: 2.481766700744629
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.227 Vali Acc: 0.500 Test Loss: 3.227 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4175198078155518
Epoch: 18, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.217 Vali Acc: 0.480 Test Loss: 3.217 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4138307571411133
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.081 Vali Acc: 0.520 Test Loss: 3.081 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3876936435699463
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.925 Vali Acc: 0.560 Test Loss: 2.925 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.412757158279419
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.964 Vali Acc: 0.560 Test Loss: 2.964 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.393155097961426
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.109 Vali Acc: 0.540 Test Loss: 3.109 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.431729793548584
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.169 Vali Acc: 0.540 Test Loss: 3.169 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.403826951980591
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.820 Vali Acc: 0.560 Test Loss: 2.820 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.385674476623535
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.058 Vali Acc: 0.580 Test Loss: 3.058 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.394913911819458
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.187 Vali Acc: 0.620 Test Loss: 3.187 Test Acc: 0.620
Validation loss decreased (-0.599977 --> -0.619968).  Saving model ...
Epoch: 27 cost time: 2.431942939758301
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.580 Test Loss: 3.159 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4107182025909424
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.319 Vali Acc: 0.600 Test Loss: 3.319 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.41635799407959
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.408 Vali Acc: 0.600 Test Loss: 3.408 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.415060520172119
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.434 Vali Acc: 0.640 Test Loss: 3.434 Test Acc: 0.640
Validation loss decreased (-0.619968 --> -0.639966).  Saving model ...
Epoch: 31 cost time: 2.455256223678589
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.434 Vali Acc: 0.640 Test Loss: 3.434 Test Acc: 0.640
Validation loss decreased (-0.639966 --> -0.639966).  Saving model ...
Epoch: 32 cost time: 2.4441373348236084
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.546 Vali Acc: 0.620 Test Loss: 3.546 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.413904905319214
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.561 Vali Acc: 0.620 Test Loss: 3.561 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.392416477203369
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.249 Vali Acc: 0.580 Test Loss: 3.249 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.389158010482788
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.293 Vali Acc: 0.580 Test Loss: 3.293 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.397645950317383
Epoch: 36, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.162 Vali Acc: 0.580 Test Loss: 3.162 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.4143927097320557
Epoch: 37, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.298 Vali Acc: 0.580 Test Loss: 3.298 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.4073233604431152
Epoch: 38, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.297 Vali Acc: 0.580 Test Loss: 3.297 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.4120535850524902
Epoch: 39, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.904 Vali Acc: 0.580 Test Loss: 2.904 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.3958370685577393
Epoch: 40, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.969 Vali Acc: 0.560 Test Loss: 2.969 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.4095335006713867
Epoch: 41, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.064 Vali Acc: 0.580 Test Loss: 3.064 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 1746758949
model size : 6667.99MB
2025-04-27 15:30:14.349279: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:30:14.369009: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745767814.391630  362732 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745767814.398490  362732 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:30:14.421701: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.147905588150024
Epoch: 1, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.508 Vali Acc: 0.400 Test Loss: 1.508 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 3.0434587001800537
Epoch: 2, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.876 Vali Acc: 0.480 Test Loss: 1.876 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479981).  Saving model ...
Epoch: 3 cost time: 3.0533506870269775
Epoch: 3, Steps: 4 | Train Loss: 0.266 Vali Loss: 2.314 Vali Acc: 0.460 Test Loss: 2.314 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.029907703399658
Epoch: 4, Steps: 4 | Train Loss: 0.119 Vali Loss: 4.932 Vali Acc: 0.360 Test Loss: 4.932 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.034431219100952
Epoch: 5, Steps: 4 | Train Loss: 0.096 Vali Loss: 4.355 Vali Acc: 0.400 Test Loss: 4.355 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0215890407562256
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.296 Vali Acc: 0.420 Test Loss: 6.296 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.013599157333374
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.544 Vali Acc: 0.460 Test Loss: 8.544 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0165841579437256
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.739 Vali Acc: 0.460 Test Loss: 10.739 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0200648307800293
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.562 Vali Acc: 0.460 Test Loss: 12.562 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.032801628112793
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.741 Vali Acc: 0.440 Test Loss: 13.741 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.020164966583252
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.482 Vali Acc: 0.440 Test Loss: 13.482 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.0196664333343506
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.375 Vali Acc: 0.440 Test Loss: 14.375 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1758463877
model size : 6712.64MB
2025-04-27 15:32:31.710226: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:32:31.729474: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745767951.751556  368689 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745767951.758351  368689 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:32:31.781083: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.701613187789917
Epoch: 1, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.533 Vali Acc: 0.320 Test Loss: 1.533 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 2.7827517986297607
Epoch: 2, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.873 Vali Acc: 0.300 Test Loss: 1.873 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7258405685424805
Epoch: 3, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.691 Vali Acc: 0.400 Test Loss: 1.691 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 2.7803351879119873
Epoch: 4, Steps: 4 | Train Loss: 0.440 Vali Loss: 3.471 Vali Acc: 0.380 Test Loss: 3.471 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.71720814704895
Epoch: 5, Steps: 4 | Train Loss: 0.094 Vali Loss: 4.625 Vali Acc: 0.380 Test Loss: 4.625 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.723722219467163
Epoch: 6, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.666 Vali Acc: 0.360 Test Loss: 5.666 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7349793910980225
Epoch: 7, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.366 Vali Acc: 0.380 Test Loss: 6.366 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7151989936828613
Epoch: 8, Steps: 4 | Train Loss: 0.112 Vali Loss: 5.650 Vali Acc: 0.420 Test Loss: 5.650 Test Acc: 0.420
Validation loss decreased (-0.399983 --> -0.419943).  Saving model ...
Epoch: 9 cost time: 2.7395894527435303
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.738 Vali Acc: 0.320 Test Loss: 5.738 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.730262279510498
Epoch: 10, Steps: 4 | Train Loss: 0.019 Vali Loss: 6.887 Vali Acc: 0.380 Test Loss: 6.887 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7180192470550537
Epoch: 11, Steps: 4 | Train Loss: 0.059 Vali Loss: 7.067 Vali Acc: 0.380 Test Loss: 7.067 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7118449211120605
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.285 Vali Acc: 0.400 Test Loss: 6.285 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7073590755462646
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.720 Vali Acc: 0.420 Test Loss: 6.720 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.731290578842163
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.161 Vali Acc: 0.440 Test Loss: 7.161 Test Acc: 0.440
Validation loss decreased (-0.419943 --> -0.439928).  Saving model ...
Epoch: 15 cost time: 2.7683167457580566
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.959 Vali Acc: 0.400 Test Loss: 6.959 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.730137348175049
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.203 Vali Acc: 0.420 Test Loss: 7.203 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7299458980560303
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.057 Vali Acc: 0.400 Test Loss: 7.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7458603382110596
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.474 Vali Acc: 0.420 Test Loss: 7.474 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.834338903427124
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.661 Vali Acc: 0.460 Test Loss: 7.661 Test Acc: 0.460
Validation loss decreased (-0.439928 --> -0.459923).  Saving model ...
Epoch: 20 cost time: 2.774852991104126
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.657 Vali Acc: 0.460 Test Loss: 7.657 Test Acc: 0.460
Validation loss decreased (-0.459923 --> -0.459923).  Saving model ...
Epoch: 21 cost time: 2.826359510421753
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.981 Vali Acc: 0.440 Test Loss: 7.981 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7292847633361816
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.224 Vali Acc: 0.420 Test Loss: 7.224 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7627615928649902
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.617 Vali Acc: 0.460 Test Loss: 7.617 Test Acc: 0.460
Validation loss decreased (-0.459923 --> -0.459924).  Saving model ...
Epoch: 24 cost time: 2.7941811084747314
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.532 Vali Acc: 0.440 Test Loss: 7.532 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.737825632095337
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.902 Vali Acc: 0.440 Test Loss: 7.902 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7197883129119873
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.975 Vali Acc: 0.440 Test Loss: 7.975 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7484564781188965
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.261 Vali Acc: 0.440 Test Loss: 8.261 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.717744827270508
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.415 Vali Acc: 0.440 Test Loss: 8.415 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.723148822784424
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.744 Vali Acc: 0.460 Test Loss: 7.744 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7178304195404053
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.121 Vali Acc: 0.440 Test Loss: 8.121 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.7193055152893066
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.871 Vali Acc: 0.460 Test Loss: 7.871 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.7286229133605957
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.104 Vali Acc: 0.460 Test Loss: 8.104 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.722362995147705
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.327 Vali Acc: 0.440 Test Loss: 8.327 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 1752438501
model size : 6689.66MB
2025-04-27 15:38:29.389076: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:38:29.408379: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745768309.430764  384615 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745768309.437590  384615 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:38:29.460515: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.680640697479248
Epoch: 1, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.602 Vali Acc: 0.260 Test Loss: 1.602 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.6102023124694824
Epoch: 2, Steps: 4 | Train Loss: 1.071 Vali Loss: 1.559 Vali Acc: 0.300 Test Loss: 1.559 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.6554150581359863
Epoch: 3, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.787 Vali Acc: 0.440 Test Loss: 1.787 Test Acc: 0.440
Validation loss decreased (-0.299984 --> -0.439982).  Saving model ...
Epoch: 4 cost time: 2.6297736167907715
Epoch: 4, Steps: 4 | Train Loss: 0.108 Vali Loss: 2.680 Vali Acc: 0.520 Test Loss: 2.680 Test Acc: 0.520
Validation loss decreased (-0.439982 --> -0.519973).  Saving model ...
Epoch: 5 cost time: 2.6602115631103516
Epoch: 5, Steps: 4 | Train Loss: 0.026 Vali Loss: 3.686 Vali Acc: 0.480 Test Loss: 3.686 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5998146533966064
Epoch: 6, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.476 Vali Acc: 0.480 Test Loss: 4.476 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6093645095825195
Epoch: 7, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.913 Vali Acc: 0.380 Test Loss: 4.913 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.642090320587158
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.550 Vali Acc: 0.360 Test Loss: 5.550 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6291027069091797
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.075 Vali Acc: 0.340 Test Loss: 6.075 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6158041954040527
Epoch: 10, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.285 Vali Acc: 0.400 Test Loss: 6.285 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.58335018157959
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.092 Vali Acc: 0.340 Test Loss: 6.092 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6494221687316895
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 5.854 Vali Acc: 0.400 Test Loss: 5.854 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6017041206359863
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.257 Vali Acc: 0.320 Test Loss: 6.257 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.590482234954834
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.742 Vali Acc: 0.320 Test Loss: 6.742 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1748995525
model size : 6676.52MB
2025-04-27 15:41:37.679005: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:41:37.698566: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745768497.721108  391728 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745768497.728022  391728 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:41:37.750974: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5159294605255127
Epoch: 1, Steps: 4 | Train Loss: 1.587 Vali Loss: 1.578 Vali Acc: 0.360 Test Loss: 1.578 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 2.654975175857544
Epoch: 2, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.591 Vali Acc: 0.240 Test Loss: 1.591 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5916311740875244
Epoch: 3, Steps: 4 | Train Loss: 0.398 Vali Loss: 1.606 Vali Acc: 0.440 Test Loss: 1.606 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439984).  Saving model ...
Epoch: 4 cost time: 2.6690971851348877
Epoch: 4, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.888 Vali Acc: 0.420 Test Loss: 1.888 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5875844955444336
Epoch: 5, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.998 Vali Acc: 0.500 Test Loss: 1.998 Test Acc: 0.500
Validation loss decreased (-0.439984 --> -0.499980).  Saving model ...
Epoch: 6 cost time: 2.6044836044311523
Epoch: 6, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.563 Vali Acc: 0.540 Test Loss: 2.563 Test Acc: 0.540
Validation loss decreased (-0.499980 --> -0.539974).  Saving model ...
Epoch: 7 cost time: 2.619842529296875
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.375 Vali Acc: 0.480 Test Loss: 3.375 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5953269004821777
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.135 Vali Acc: 0.480 Test Loss: 4.135 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.61160945892334
Epoch: 9, Steps: 4 | Train Loss: 0.020 Vali Loss: 3.163 Vali Acc: 0.520 Test Loss: 3.163 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.578249931335449
Epoch: 10, Steps: 4 | Train Loss: 0.091 Vali Loss: 2.754 Vali Acc: 0.480 Test Loss: 2.754 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.593768835067749
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.658 Vali Acc: 0.420 Test Loss: 3.658 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.580260992050171
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.489 Vali Acc: 0.400 Test Loss: 4.489 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.589495897293091
Epoch: 13, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.848 Vali Acc: 0.480 Test Loss: 3.848 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.583108901977539
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.383 Vali Acc: 0.320 Test Loss: 4.383 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5853347778320312
Epoch: 15, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.843 Vali Acc: 0.460 Test Loss: 3.843 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5900516510009766
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.882 Vali Acc: 0.420 Test Loss: 4.882 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1748134917
model size : 6673.24MB
2025-04-27 15:44:49.664411: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:44:49.683737: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745768689.706336  399660 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745768689.713156  399660 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:44:49.737013: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5482301712036133
Epoch: 1, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.588 Vali Acc: 0.300 Test Loss: 1.588 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.537875175476074
Epoch: 2, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.504 Vali Acc: 0.340 Test Loss: 1.504 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 2.5519933700561523
Epoch: 3, Steps: 4 | Train Loss: 0.511 Vali Loss: 1.477 Vali Acc: 0.460 Test Loss: 1.477 Test Acc: 0.460
Validation loss decreased (-0.339985 --> -0.459985).  Saving model ...
Epoch: 4 cost time: 2.554100513458252
Epoch: 4, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.636 Vali Acc: 0.520 Test Loss: 1.636 Test Acc: 0.520
Validation loss decreased (-0.459985 --> -0.519984).  Saving model ...
Epoch: 5 cost time: 2.5759050846099854
Epoch: 5, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.996 Vali Acc: 0.560 Test Loss: 1.996 Test Acc: 0.560
Validation loss decreased (-0.519984 --> -0.559980).  Saving model ...
Epoch: 6 cost time: 2.5257065296173096
Epoch: 6, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.360 Vali Acc: 0.460 Test Loss: 2.360 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.500509023666382
Epoch: 7, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.730 Vali Acc: 0.580 Test Loss: 2.730 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579973).  Saving model ...
Epoch: 8 cost time: 2.5798120498657227
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.039 Vali Acc: 0.480 Test Loss: 3.039 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5048487186431885
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.708 Vali Acc: 0.500 Test Loss: 3.708 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5229880809783936
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.636 Vali Acc: 0.400 Test Loss: 3.636 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4927539825439453
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.128 Vali Acc: 0.420 Test Loss: 4.128 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.535733699798584
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.425 Vali Acc: 0.460 Test Loss: 4.425 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.488499402999878
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.820 Vali Acc: 0.520 Test Loss: 4.820 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.488611936569214
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.179 Vali Acc: 0.520 Test Loss: 5.179 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.498138666152954
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.206 Vali Acc: 0.540 Test Loss: 5.206 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4909629821777344
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.228 Vali Acc: 0.480 Test Loss: 5.228 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4963905811309814
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.391 Vali Acc: 0.540 Test Loss: 5.391 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1746413765
model size : 6666.68MB
2025-04-27 15:48:38.602951: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:48:38.623056: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745768918.645904  408265 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745768918.652961  408265 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:48:38.676962: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5129592418670654
Epoch: 1, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.549 Vali Acc: 0.260 Test Loss: 1.549 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 2.543158769607544
Epoch: 2, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.463 Vali Acc: 0.340 Test Loss: 1.463 Test Acc: 0.340
Validation loss decreased (-0.259985 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 2.517071008682251
Epoch: 3, Steps: 4 | Train Loss: 0.582 Vali Loss: 1.539 Vali Acc: 0.460 Test Loss: 1.539 Test Acc: 0.460
Validation loss decreased (-0.339985 --> -0.459985).  Saving model ...
Epoch: 4 cost time: 2.5257701873779297
Epoch: 4, Steps: 4 | Train Loss: 0.371 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 2.537102222442627
Epoch: 5, Steps: 4 | Train Loss: 0.110 Vali Loss: 2.242 Vali Acc: 0.540 Test Loss: 2.242 Test Acc: 0.540
Validation loss decreased (-0.499982 --> -0.539978).  Saving model ...
Epoch: 6 cost time: 2.5474929809570312
Epoch: 6, Steps: 4 | Train Loss: 0.037 Vali Loss: 2.485 Vali Acc: 0.520 Test Loss: 2.485 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.486036777496338
Epoch: 7, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.224 Vali Acc: 0.500 Test Loss: 2.224 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.495713472366333
Epoch: 8, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.356 Vali Acc: 0.520 Test Loss: 2.356 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.488759756088257
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.931 Vali Acc: 0.420 Test Loss: 2.931 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.488302707672119
Epoch: 10, Steps: 4 | Train Loss: 0.025 Vali Loss: 3.029 Vali Acc: 0.420 Test Loss: 3.029 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4862403869628906
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.423 Vali Acc: 0.360 Test Loss: 3.423 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4944539070129395
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.413 Vali Acc: 0.440 Test Loss: 3.413 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.498441219329834
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.403 Vali Acc: 0.420 Test Loss: 3.403 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.491288185119629
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.185 Vali Acc: 0.460 Test Loss: 3.185 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4898605346679688
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.129 Vali Acc: 0.460 Test Loss: 3.129 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1746414181
model size : 6666.68MB
2025-04-27 15:52:06.755309: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 15:52:06.774807: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745769126.797349  415916 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745769126.804264  415916 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 15:52:06.827437: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.429389715194702
Epoch: 1, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.611 Vali Acc: 0.200 Test Loss: 1.611 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.4555134773254395
Epoch: 2, Steps: 4 | Train Loss: 1.295 Vali Loss: 1.452 Vali Acc: 0.340 Test Loss: 1.452 Test Acc: 0.340
Validation loss decreased (-0.199984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 2.4425606727600098
Epoch: 3, Steps: 4 | Train Loss: 0.778 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 2.435523509979248
Epoch: 4, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499985).  Saving model ...
Epoch: 5 cost time: 2.4283549785614014
Epoch: 5, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.813 Vali Acc: 0.500 Test Loss: 1.813 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.378357410430908
Epoch: 6, Steps: 4 | Train Loss: 0.097 Vali Loss: 2.027 Vali Acc: 0.480 Test Loss: 2.027 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3759491443634033
Epoch: 7, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.245 Vali Acc: 0.600 Test Loss: 2.245 Test Acc: 0.600
Validation loss decreased (-0.499985 --> -0.599978).  Saving model ...
Epoch: 8 cost time: 2.4311063289642334
Epoch: 8, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.334 Vali Acc: 0.480 Test Loss: 2.334 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.418149709701538
Epoch: 9, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.707 Vali Acc: 0.540 Test Loss: 2.707 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.381692409515381
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.108 Vali Acc: 0.480 Test Loss: 3.108 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4091479778289795
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.427 Vali Acc: 0.440 Test Loss: 3.427 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.390599012374878
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.235 Vali Acc: 0.500 Test Loss: 3.235 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4043869972229004
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.146 Vali Acc: 0.500 Test Loss: 3.146 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3788158893585205
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.174 Vali Acc: 0.540 Test Loss: 3.174 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3836708068847656
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.238 Vali Acc: 0.560 Test Loss: 3.238 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3804073333740234
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.372 Vali Acc: 0.560 Test Loss: 3.372 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3720901012420654
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.462 Vali Acc: 0.560 Test Loss: 3.462 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1745553829
model size : 6663.40MB
2025-04-27 16:00:39.841362: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:00:39.858695: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745769639.880517  427800 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745769639.887228  427800 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:00:39.908442: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.047607898712158
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.526 Vali Acc: 0.300 Test Loss: 1.526 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 2.8972666263580322
Epoch: 2, Steps: 4 | Train Loss: 1.540 Vali Loss: 3.162 Vali Acc: 0.280 Test Loss: 3.162 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.844137191772461
Epoch: 3, Steps: 4 | Train Loss: 0.316 Vali Loss: 5.822 Vali Acc: 0.340 Test Loss: 5.822 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339942).  Saving model ...
Epoch: 4 cost time: 2.8659818172454834
Epoch: 4, Steps: 4 | Train Loss: 0.532 Vali Loss: 7.315 Vali Acc: 0.380 Test Loss: 7.315 Test Acc: 0.380
Validation loss decreased (-0.339942 --> -0.379927).  Saving model ...
Epoch: 5 cost time: 2.869903564453125
Epoch: 5, Steps: 4 | Train Loss: 0.399 Vali Loss: 9.461 Vali Acc: 0.480 Test Loss: 9.461 Test Acc: 0.480
Validation loss decreased (-0.379927 --> -0.479905).  Saving model ...
Epoch: 6 cost time: 2.8725523948669434
Epoch: 6, Steps: 4 | Train Loss: 0.007 Vali Loss: 12.358 Vali Acc: 0.440 Test Loss: 12.358 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8707072734832764
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 9.620 Vali Acc: 0.360 Test Loss: 9.620 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8470749855041504
Epoch: 8, Steps: 4 | Train Loss: 0.914 Vali Loss: 9.911 Vali Acc: 0.380 Test Loss: 9.911 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8675026893615723
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 16.518 Vali Acc: 0.420 Test Loss: 16.518 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.88100004196167
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 27.271 Vali Acc: 0.500 Test Loss: 27.271 Test Acc: 0.500
Validation loss decreased (-0.479905 --> -0.499727).  Saving model ...
Epoch: 11 cost time: 2.9138143062591553
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 30.929 Vali Acc: 0.460 Test Loss: 30.929 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8555665016174316
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 33.309 Vali Acc: 0.500 Test Loss: 33.309 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8532466888427734
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 35.013 Vali Acc: 0.500 Test Loss: 35.013 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.874019145965576
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 34.588 Vali Acc: 0.500 Test Loss: 34.588 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.847233772277832
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 33.695 Vali Acc: 0.480 Test Loss: 33.695 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.855841875076294
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 30.163 Vali Acc: 0.440 Test Loss: 30.163 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.852534770965576
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 28.267 Vali Acc: 0.400 Test Loss: 28.267 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.858506917953491
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 26.209 Vali Acc: 0.400 Test Loss: 26.209 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8607940673828125
Epoch: 19, Steps: 4 | Train Loss: 0.089 Vali Loss: 14.339 Vali Acc: 0.520 Test Loss: 14.339 Test Acc: 0.520
Validation loss decreased (-0.499727 --> -0.519857).  Saving model ...
Epoch: 20 cost time: 2.9205100536346436
Epoch: 20, Steps: 4 | Train Loss: 0.149 Vali Loss: 11.731 Vali Acc: 0.500 Test Loss: 11.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.858189821243286
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.911 Vali Acc: 0.360 Test Loss: 22.911 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.859683036804199
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 32.687 Vali Acc: 0.340 Test Loss: 32.687 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.84501576423645
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 35.117 Vali Acc: 0.420 Test Loss: 35.117 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8516976833343506
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 39.033 Vali Acc: 0.380 Test Loss: 39.033 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8653528690338135
Epoch: 25, Steps: 4 | Train Loss: 0.699 Vali Loss: 22.326 Vali Acc: 0.400 Test Loss: 22.326 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.8554296493530273
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.287 Vali Acc: 0.320 Test Loss: 21.287 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8751070499420166
Epoch: 27, Steps: 4 | Train Loss: 0.006 Vali Loss: 32.961 Vali Acc: 0.340 Test Loss: 32.961 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.850480079650879
Epoch: 28, Steps: 4 | Train Loss: 1.119 Vali Loss: 29.811 Vali Acc: 0.280 Test Loss: 29.811 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.855942487716675
Epoch: 29, Steps: 4 | Train Loss: 0.064 Vali Loss: 42.705 Vali Acc: 0.300 Test Loss: 42.705 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1536029189
model size : 5863.45MB
2025-04-27 16:05:23.496344: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:05:23.515538: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745769923.537422  441547 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745769923.544166  441547 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:05:23.566558: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.583038806915283
Epoch: 1, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.515 Vali Acc: 0.280 Test Loss: 1.515 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 2.618344783782959
Epoch: 2, Steps: 4 | Train Loss: 1.078 Vali Loss: 2.134 Vali Acc: 0.400 Test Loss: 2.134 Test Acc: 0.400
Validation loss decreased (-0.279985 --> -0.399979).  Saving model ...
Epoch: 3 cost time: 2.60016131401062
Epoch: 3, Steps: 4 | Train Loss: 0.700 Vali Loss: 4.358 Vali Acc: 0.420 Test Loss: 4.358 Test Acc: 0.420
Validation loss decreased (-0.399979 --> -0.419956).  Saving model ...
Epoch: 4 cost time: 2.5929911136627197
Epoch: 4, Steps: 4 | Train Loss: 0.170 Vali Loss: 7.218 Vali Acc: 0.420 Test Loss: 7.218 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5653977394104004
Epoch: 5, Steps: 4 | Train Loss: 0.080 Vali Loss: 9.102 Vali Acc: 0.380 Test Loss: 9.102 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5526065826416016
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.823 Vali Acc: 0.340 Test Loss: 14.823 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.574758291244507
Epoch: 7, Steps: 4 | Train Loss: 0.048 Vali Loss: 14.655 Vali Acc: 0.500 Test Loss: 14.655 Test Acc: 0.500
Validation loss decreased (-0.419956 --> -0.499853).  Saving model ...
Epoch: 8 cost time: 2.608638286590576
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 15.217 Vali Acc: 0.540 Test Loss: 15.217 Test Acc: 0.540
Validation loss decreased (-0.499853 --> -0.539848).  Saving model ...
Epoch: 9 cost time: 2.6119844913482666
Epoch: 9, Steps: 4 | Train Loss: 1.307 Vali Loss: 11.711 Vali Acc: 0.500 Test Loss: 11.711 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5757601261138916
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.911 Vali Acc: 0.400 Test Loss: 14.911 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.587433338165283
Epoch: 11, Steps: 4 | Train Loss: 0.055 Vali Loss: 13.705 Vali Acc: 0.460 Test Loss: 13.705 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5583643913269043
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.444 Vali Acc: 0.480 Test Loss: 12.444 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.576307773590088
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.388 Vali Acc: 0.460 Test Loss: 12.388 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5608468055725098
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.515 Vali Acc: 0.460 Test Loss: 13.515 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5505330562591553
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.556 Vali Acc: 0.460 Test Loss: 14.556 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.568394899368286
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.111 Vali Acc: 0.460 Test Loss: 15.111 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5585455894470215
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.247 Vali Acc: 0.460 Test Loss: 16.247 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5674571990966797
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.504 Vali Acc: 0.480 Test Loss: 16.504 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1523117637
model size : 5814.20MB
2025-04-27 16:08:40.954535: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:08:40.973747: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745770120.996605  450299 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745770121.003358  450299 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:08:41.026081: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3143274784088135
Epoch: 1, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.518 Vali Acc: 0.380 Test Loss: 1.518 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 2.3815252780914307
Epoch: 2, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.851 Vali Acc: 0.400 Test Loss: 1.851 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399981).  Saving model ...
Epoch: 3 cost time: 2.3589282035827637
Epoch: 3, Steps: 4 | Train Loss: 0.234 Vali Loss: 3.088 Vali Acc: 0.500 Test Loss: 3.088 Test Acc: 0.500
Validation loss decreased (-0.399981 --> -0.499969).  Saving model ...
Epoch: 4 cost time: 2.351311445236206
Epoch: 4, Steps: 4 | Train Loss: 0.137 Vali Loss: 2.896 Vali Acc: 0.420 Test Loss: 2.896 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.35504150390625
Epoch: 5, Steps: 4 | Train Loss: 0.067 Vali Loss: 3.440 Vali Acc: 0.440 Test Loss: 3.440 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.344029664993286
Epoch: 6, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.027 Vali Acc: 0.440 Test Loss: 5.027 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3188040256500244
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.272 Vali Acc: 0.460 Test Loss: 6.272 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3277642726898193
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.176 Vali Acc: 0.440 Test Loss: 7.176 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3218448162078857
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.833 Vali Acc: 0.440 Test Loss: 7.833 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3145790100097656
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.015 Vali Acc: 0.460 Test Loss: 8.015 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.338353157043457
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.975 Vali Acc: 0.480 Test Loss: 7.975 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3163094520568848
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.171 Vali Acc: 0.500 Test Loss: 8.171 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.332549571990967
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.427 Vali Acc: 0.480 Test Loss: 8.427 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1517092485
model size : 5791.22MB
2025-04-27 16:10:57.446133: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:10:57.465604: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745770257.487961  456626 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745770257.494790  456626 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:10:57.517771: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2504703998565674
Epoch: 1, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.462 Vali Acc: 0.320 Test Loss: 1.462 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 2.3142330646514893
Epoch: 2, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.749 Vali Acc: 0.440 Test Loss: 1.749 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439983).  Saving model ...
Epoch: 3 cost time: 2.341677188873291
Epoch: 3, Steps: 4 | Train Loss: 0.366 Vali Loss: 2.283 Vali Acc: 0.460 Test Loss: 2.283 Test Acc: 0.460
Validation loss decreased (-0.439983 --> -0.459977).  Saving model ...
Epoch: 4 cost time: 2.3011600971221924
Epoch: 4, Steps: 4 | Train Loss: 0.302 Vali Loss: 3.319 Vali Acc: 0.440 Test Loss: 3.319 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.283684730529785
Epoch: 5, Steps: 4 | Train Loss: 0.054 Vali Loss: 3.533 Vali Acc: 0.480 Test Loss: 3.533 Test Acc: 0.480
Validation loss decreased (-0.459977 --> -0.479965).  Saving model ...
Epoch: 6 cost time: 2.345031499862671
Epoch: 6, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.188 Vali Acc: 0.500 Test Loss: 7.188 Test Acc: 0.500
Validation loss decreased (-0.479965 --> -0.499928).  Saving model ...
Epoch: 7 cost time: 2.346647262573242
Epoch: 7, Steps: 4 | Train Loss: 0.047 Vali Loss: 6.362 Vali Acc: 0.460 Test Loss: 6.362 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.297032594680786
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.699 Vali Acc: 0.540 Test Loss: 5.699 Test Acc: 0.540
Validation loss decreased (-0.499928 --> -0.539943).  Saving model ...
Epoch: 9 cost time: 2.3177545070648193
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.880 Vali Acc: 0.520 Test Loss: 5.880 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2923049926757812
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.576 Vali Acc: 0.520 Test Loss: 5.576 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.286987066268921
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.107 Vali Acc: 0.500 Test Loss: 5.107 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.28006649017334
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.294 Vali Acc: 0.460 Test Loss: 5.294 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.292208671569824
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.530 Vali Acc: 0.460 Test Loss: 5.530 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2860612869262695
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.728 Vali Acc: 0.460 Test Loss: 5.728 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.298210382461548
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.323 Vali Acc: 0.480 Test Loss: 6.323 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.315753221511841
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.760 Vali Acc: 0.460 Test Loss: 6.760 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.284726142883301
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.987 Vali Acc: 0.460 Test Loss: 6.987 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2917842864990234
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.171 Vali Acc: 0.460 Test Loss: 7.171 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1515371269
model size : 5784.65MB
2025-04-27 16:14:29.789817: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:14:29.809219: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745770469.831535  465474 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745770469.838298  465474 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:14:29.861243: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2507095336914062
Epoch: 1, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.546 Vali Acc: 0.260 Test Loss: 1.546 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 2.2498631477355957
Epoch: 2, Steps: 4 | Train Loss: 1.071 Vali Loss: 1.423 Vali Acc: 0.420 Test Loss: 1.423 Test Acc: 0.420
Validation loss decreased (-0.259985 --> -0.419986).  Saving model ...
Epoch: 3 cost time: 2.244149684906006
Epoch: 3, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.638 Vali Acc: 0.500 Test Loss: 1.638 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 2.247337818145752
Epoch: 4, Steps: 4 | Train Loss: 0.134 Vali Loss: 2.145 Vali Acc: 0.520 Test Loss: 2.145 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519979).  Saving model ...
Epoch: 5 cost time: 2.2548606395721436
Epoch: 5, Steps: 4 | Train Loss: 0.076 Vali Loss: 3.006 Vali Acc: 0.540 Test Loss: 3.006 Test Acc: 0.540
Validation loss decreased (-0.519979 --> -0.539970).  Saving model ...
Epoch: 6 cost time: 2.2402353286743164
Epoch: 6, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.541 Vali Acc: 0.520 Test Loss: 3.541 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1981751918792725
Epoch: 7, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.181 Vali Acc: 0.540 Test Loss: 4.181 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1991939544677734
Epoch: 8, Steps: 4 | Train Loss: 0.725 Vali Loss: 4.178 Vali Acc: 0.460 Test Loss: 4.178 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2090702056884766
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.218 Vali Acc: 0.440 Test Loss: 4.218 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1997721195220947
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.656 Vali Acc: 0.440 Test Loss: 4.656 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2211451530456543
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.877 Vali Acc: 0.440 Test Loss: 4.877 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.203714370727539
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.551 Vali Acc: 0.420 Test Loss: 5.551 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2090203762054443
Epoch: 13, Steps: 4 | Train Loss: 0.030 Vali Loss: 4.536 Vali Acc: 0.540 Test Loss: 4.536 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2134387493133545
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.507 Vali Acc: 0.460 Test Loss: 4.507 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.225224018096924
Epoch: 15, Steps: 4 | Train Loss: 0.032 Vali Loss: 4.719 Vali Acc: 0.540 Test Loss: 4.719 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1511928965
model size : 5771.52MB
2025-04-27 16:17:27.709979: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:17:27.729625: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745770647.751254  472886 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745770647.757967  472886 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:17:27.780214: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1862876415252686
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.575 Vali Acc: 0.300 Test Loss: 1.575 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.215698003768921
Epoch: 2, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.584 Vali Acc: 0.340 Test Loss: 1.584 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 2.2154951095581055
Epoch: 3, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.652 Vali Acc: 0.420 Test Loss: 1.652 Test Acc: 0.420
Validation loss decreased (-0.339984 --> -0.419983).  Saving model ...
Epoch: 4 cost time: 2.2379205226898193
Epoch: 4, Steps: 4 | Train Loss: 0.269 Vali Loss: 2.099 Vali Acc: 0.440 Test Loss: 2.099 Test Acc: 0.440
Validation loss decreased (-0.419983 --> -0.439979).  Saving model ...
Epoch: 5 cost time: 2.215860605239868
Epoch: 5, Steps: 4 | Train Loss: 0.102 Vali Loss: 3.093 Vali Acc: 0.480 Test Loss: 3.093 Test Acc: 0.480
Validation loss decreased (-0.439979 --> -0.479969).  Saving model ...
Epoch: 6 cost time: 2.2192275524139404
Epoch: 6, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.973 Vali Acc: 0.460 Test Loss: 2.973 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1942856311798096
Epoch: 7, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.840 Vali Acc: 0.520 Test Loss: 2.840 Test Acc: 0.520
Validation loss decreased (-0.479969 --> -0.519972).  Saving model ...
Epoch: 8 cost time: 2.2312469482421875
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.706 Vali Acc: 0.480 Test Loss: 3.706 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.181243419647217
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.401 Vali Acc: 0.380 Test Loss: 4.401 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.205327272415161
Epoch: 10, Steps: 4 | Train Loss: 0.030 Vali Loss: 3.914 Vali Acc: 0.500 Test Loss: 3.914 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.19338059425354
Epoch: 11, Steps: 4 | Train Loss: 0.017 Vali Loss: 4.012 Vali Acc: 0.520 Test Loss: 4.012 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.176485776901245
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.266 Vali Acc: 0.480 Test Loss: 5.266 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.21327805519104
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.559 Vali Acc: 0.420 Test Loss: 5.559 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1883795261383057
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.723 Vali Acc: 0.420 Test Loss: 5.723 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1836814880371094
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.753 Vali Acc: 0.420 Test Loss: 5.753 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1836369037628174
Epoch: 16, Steps: 4 | Train Loss: 0.010 Vali Loss: 5.466 Vali Acc: 0.420 Test Loss: 5.466 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1862268447875977
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.825 Vali Acc: 0.480 Test Loss: 4.825 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1511068997
model size : 5768.24MB
2025-04-27 16:20:49.769395: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:20:49.788676: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745770849.810843  481310 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745770849.817772  481310 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:20:49.840641: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0451560020446777
Epoch: 1, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.533 Vali Acc: 0.260 Test Loss: 1.533 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 2.165055990219116
Epoch: 2, Steps: 4 | Train Loss: 1.066 Vali Loss: 1.445 Vali Acc: 0.420 Test Loss: 1.445 Test Acc: 0.420
Validation loss decreased (-0.259985 --> -0.419986).  Saving model ...
Epoch: 3 cost time: 2.175034761428833
Epoch: 3, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.713 Vali Acc: 0.440 Test Loss: 1.713 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439983).  Saving model ...
Epoch: 4 cost time: 2.1600699424743652
Epoch: 4, Steps: 4 | Train Loss: 0.122 Vali Loss: 2.074 Vali Acc: 0.500 Test Loss: 2.074 Test Acc: 0.500
Validation loss decreased (-0.439983 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 2.1267476081848145
Epoch: 5, Steps: 4 | Train Loss: 0.074 Vali Loss: 2.382 Vali Acc: 0.480 Test Loss: 2.382 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.108476161956787
Epoch: 6, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.960 Vali Acc: 0.480 Test Loss: 2.960 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.11711049079895
Epoch: 7, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.160 Vali Acc: 0.500 Test Loss: 3.160 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.115137815475464
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.458 Vali Acc: 0.460 Test Loss: 3.458 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.118018627166748
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.885 Vali Acc: 0.460 Test Loss: 3.885 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1279919147491455
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.500 Test Loss: 3.638 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.102365493774414
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.989 Vali Acc: 0.500 Test Loss: 3.989 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.087792158126831
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.736 Vali Acc: 0.500 Test Loss: 3.736 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0960795879364014
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.029 Vali Acc: 0.500 Test Loss: 4.029 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0964109897613525
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.099 Vali Acc: 0.560 Test Loss: 4.099 Test Acc: 0.560
Validation loss decreased (-0.499979 --> -0.559959).  Saving model ...
Epoch: 15 cost time: 2.140841007232666
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.031 Vali Acc: 0.580 Test Loss: 4.031 Test Acc: 0.580
Validation loss decreased (-0.559959 --> -0.579960).  Saving model ...
Epoch: 16 cost time: 2.139895439147949
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.076 Vali Acc: 0.560 Test Loss: 4.076 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1140480041503906
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.009 Vali Acc: 0.580 Test Loss: 4.009 Test Acc: 0.580
Validation loss decreased (-0.579960 --> -0.579960).  Saving model ...
Epoch: 18 cost time: 2.1508493423461914
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.517 Vali Acc: 0.580 Test Loss: 3.517 Test Acc: 0.580
Validation loss decreased (-0.579960 --> -0.579965).  Saving model ...
Epoch: 19 cost time: 2.1375582218170166
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.312 Vali Acc: 0.580 Test Loss: 3.312 Test Acc: 0.580
Validation loss decreased (-0.579965 --> -0.579967).  Saving model ...
Epoch: 20 cost time: 2.1375250816345215
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.541 Vali Acc: 0.580 Test Loss: 3.541 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.098090171813965
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.794 Vali Acc: 0.560 Test Loss: 3.794 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1059203147888184
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.881 Vali Acc: 0.560 Test Loss: 3.881 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1057815551757812
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.124 Vali Acc: 0.560 Test Loss: 4.124 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.107957363128662
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.855 Vali Acc: 0.580 Test Loss: 3.855 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.099775552749634
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.201 Vali Acc: 0.540 Test Loss: 4.201 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.104564905166626
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.448 Vali Acc: 0.520 Test Loss: 4.448 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0960047245025635
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.504 Vali Acc: 0.520 Test Loss: 4.504 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.099754810333252
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.944 Vali Acc: 0.520 Test Loss: 3.944 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.105362892150879
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.790 Vali Acc: 0.540 Test Loss: 3.790 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1510209093
model size : 5764.96MB
2025-04-27 16:22:03.893759: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:22:03.912885: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745770923.935170  483093 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745770923.941904  483093 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:22:03.964607: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.743764638900757
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
Validation loss decreased (inf --> -0.419984).  Saving model ...
Epoch: 2 cost time: 1.9254720211029053
Epoch: 2, Steps: 4 | Train Loss: 1.331 Vali Loss: 2.166 Vali Acc: 0.420 Test Loss: 2.166 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8938639163970947
Epoch: 3, Steps: 4 | Train Loss: 0.388 Vali Loss: 3.762 Vali Acc: 0.380 Test Loss: 3.762 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.85152006149292
Epoch: 4, Steps: 4 | Train Loss: 0.082 Vali Loss: 6.117 Vali Acc: 0.380 Test Loss: 6.117 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8366570472717285
Epoch: 5, Steps: 4 | Train Loss: 0.046 Vali Loss: 6.112 Vali Acc: 0.400 Test Loss: 6.112 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8558340072631836
Epoch: 6, Steps: 4 | Train Loss: 0.062 Vali Loss: 6.132 Vali Acc: 0.400 Test Loss: 6.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8545231819152832
Epoch: 7, Steps: 4 | Train Loss: 0.089 Vali Loss: 7.580 Vali Acc: 0.460 Test Loss: 7.580 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459924).  Saving model ...
Epoch: 8 cost time: 1.9267821311950684
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 10.474 Vali Acc: 0.400 Test Loss: 10.474 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8889904022216797
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 12.763 Vali Acc: 0.380 Test Loss: 12.763 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8354525566101074
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.560 Vali Acc: 0.360 Test Loss: 13.560 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.867624044418335
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.369 Vali Acc: 0.360 Test Loss: 14.369 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.855639934539795
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.076 Vali Acc: 0.360 Test Loss: 15.076 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8423526287078857
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.652 Vali Acc: 0.320 Test Loss: 15.652 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8411099910736084
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.224 Vali Acc: 0.320 Test Loss: 15.224 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8862411975860596
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.692 Vali Acc: 0.340 Test Loss: 15.692 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8422257900238037
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.722 Vali Acc: 0.340 Test Loss: 15.722 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.848961353302002
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.495 Vali Acc: 0.340 Test Loss: 14.495 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 740464901
model size : 2826.65MB
2025-04-27 16:23:42.651390: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:23:42.670807: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745771022.693172  490799 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745771022.700074  490799 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:23:42.723063: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5277206897735596
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.539 Vali Acc: 0.280 Test Loss: 1.539 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.6852047443389893
Epoch: 2, Steps: 4 | Train Loss: 1.386 Vali Loss: 1.848 Vali Acc: 0.440 Test Loss: 1.848 Test Acc: 0.440
Validation loss decreased (-0.279985 --> -0.439982).  Saving model ...
Epoch: 3 cost time: 1.6388475894927979
Epoch: 3, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.304 Vali Acc: 0.380 Test Loss: 2.304 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.614043951034546
Epoch: 4, Steps: 4 | Train Loss: 0.621 Vali Loss: 4.234 Vali Acc: 0.520 Test Loss: 4.234 Test Acc: 0.520
Validation loss decreased (-0.439982 --> -0.519958).  Saving model ...
Epoch: 5 cost time: 1.6755318641662598
Epoch: 5, Steps: 4 | Train Loss: 0.162 Vali Loss: 3.663 Vali Acc: 0.500 Test Loss: 3.663 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.630587100982666
Epoch: 6, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.891 Vali Acc: 0.440 Test Loss: 4.891 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.61911940574646
Epoch: 7, Steps: 4 | Train Loss: 0.029 Vali Loss: 6.281 Vali Acc: 0.480 Test Loss: 6.281 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6352488994598389
Epoch: 8, Steps: 4 | Train Loss: 0.543 Vali Loss: 6.177 Vali Acc: 0.400 Test Loss: 6.177 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6142230033874512
Epoch: 9, Steps: 4 | Train Loss: 0.013 Vali Loss: 6.795 Vali Acc: 0.360 Test Loss: 6.795 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6166582107543945
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 5.617 Vali Acc: 0.420 Test Loss: 5.617 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.606738805770874
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.444 Vali Acc: 0.400 Test Loss: 6.444 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.612421989440918
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.387 Vali Acc: 0.400 Test Loss: 6.387 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.610342025756836
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 6.178 Vali Acc: 0.420 Test Loss: 6.178 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6640417575836182
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.427 Vali Acc: 0.420 Test Loss: 5.427 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 734009125
model size : 2802.02MB
2025-04-27 16:25:15.603131: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:25:15.622391: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745771115.645125  497235 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745771115.651914  497235 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:25:15.674602: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4822773933410645
Epoch: 1, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.597 Vali Acc: 0.380 Test Loss: 1.597 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 1.5344266891479492
Epoch: 2, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.481 Vali Acc: 0.420 Test Loss: 1.481 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 3 cost time: 1.5344274044036865
Epoch: 3, Steps: 4 | Train Loss: 0.400 Vali Loss: 1.744 Vali Acc: 0.400 Test Loss: 1.744 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4807755947113037
Epoch: 4, Steps: 4 | Train Loss: 0.137 Vali Loss: 2.090 Vali Acc: 0.500 Test Loss: 2.090 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 1.5293169021606445
Epoch: 5, Steps: 4 | Train Loss: 0.079 Vali Loss: 2.456 Vali Acc: 0.540 Test Loss: 2.456 Test Acc: 0.540
Validation loss decreased (-0.499979 --> -0.539975).  Saving model ...
Epoch: 6 cost time: 1.5295379161834717
Epoch: 6, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.387 Vali Acc: 0.420 Test Loss: 2.387 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5275952816009521
Epoch: 7, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.011 Vali Acc: 0.460 Test Loss: 3.011 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4898529052734375
Epoch: 8, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.500 Vali Acc: 0.480 Test Loss: 3.500 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4893779754638672
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.906 Vali Acc: 0.500 Test Loss: 3.906 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4949040412902832
Epoch: 10, Steps: 4 | Train Loss: 0.043 Vali Loss: 4.026 Vali Acc: 0.440 Test Loss: 4.026 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5071837902069092
Epoch: 11, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.702 Vali Acc: 0.480 Test Loss: 3.702 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4952282905578613
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.138 Vali Acc: 0.400 Test Loss: 3.138 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4792747497558594
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.312 Vali Acc: 0.420 Test Loss: 3.312 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4813158512115479
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.293 Vali Acc: 0.520 Test Loss: 3.293 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4852838516235352
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.769 Vali Acc: 0.440 Test Loss: 3.769 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 730996549
model size : 2790.53MB
2025-04-27 16:26:55.030514: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:26:55.049908: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745771215.072398  504117 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745771215.079208  504117 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:26:55.102103: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.532668352127075
Epoch: 1, Steps: 4 | Train Loss: 1.562 Vali Loss: 1.575 Vali Acc: 0.280 Test Loss: 1.575 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 2.8984456062316895
Epoch: 2, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.609 Vali Acc: 0.400 Test Loss: 1.609 Test Acc: 0.400
Validation loss decreased (-0.279984 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 1.4957988262176514
Epoch: 3, Steps: 4 | Train Loss: 0.444 Vali Loss: 1.842 Vali Acc: 0.360 Test Loss: 1.842 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4730710983276367
Epoch: 4, Steps: 4 | Train Loss: 0.300 Vali Loss: 2.466 Vali Acc: 0.460 Test Loss: 2.466 Test Acc: 0.460
Validation loss decreased (-0.399984 --> -0.459975).  Saving model ...
Epoch: 5 cost time: 1.5004189014434814
Epoch: 5, Steps: 4 | Train Loss: 0.061 Vali Loss: 2.960 Vali Acc: 0.440 Test Loss: 2.960 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4682724475860596
Epoch: 6, Steps: 4 | Train Loss: 0.019 Vali Loss: 4.202 Vali Acc: 0.440 Test Loss: 4.202 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4635624885559082
Epoch: 7, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.580 Vali Acc: 0.400 Test Loss: 5.580 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4906177520751953
Epoch: 8, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.323 Vali Acc: 0.420 Test Loss: 6.323 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4651391506195068
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.006 Vali Acc: 0.460 Test Loss: 7.006 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4534993171691895
Epoch: 10, Steps: 4 | Train Loss: 0.080 Vali Loss: 6.536 Vali Acc: 0.440 Test Loss: 6.536 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4603378772735596
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.538 Vali Acc: 0.380 Test Loss: 7.538 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.499089002609253
Epoch: 12, Steps: 4 | Train Loss: 0.007 Vali Loss: 7.155 Vali Acc: 0.380 Test Loss: 7.155 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4708571434020996
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 4.962 Vali Acc: 0.420 Test Loss: 4.962 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4608290195465088
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.539 Vali Acc: 0.320 Test Loss: 4.539 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 730135941
model size : 2787.24MB
2025-04-27 16:28:25.097520: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:28:25.116442: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745771305.138563  510571 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745771305.145309  510571 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:28:25.168227: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.400127410888672
Epoch: 1, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.547 Vali Acc: 0.260 Test Loss: 1.547 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.4770829677581787
Epoch: 2, Steps: 4 | Train Loss: 1.211 Vali Loss: 1.499 Vali Acc: 0.380 Test Loss: 1.499 Test Acc: 0.380
Validation loss decreased (-0.259985 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.4787507057189941
Epoch: 3, Steps: 4 | Train Loss: 0.557 Vali Loss: 1.699 Vali Acc: 0.440 Test Loss: 1.699 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439983).  Saving model ...
Epoch: 4 cost time: 1.5085911750793457
Epoch: 4, Steps: 4 | Train Loss: 0.741 Vali Loss: 1.880 Vali Acc: 0.500 Test Loss: 1.880 Test Acc: 0.500
Validation loss decreased (-0.439983 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 1.4776506423950195
Epoch: 5, Steps: 4 | Train Loss: 0.130 Vali Loss: 2.261 Vali Acc: 0.520 Test Loss: 2.261 Test Acc: 0.520
Validation loss decreased (-0.499981 --> -0.519977).  Saving model ...
Epoch: 6 cost time: 1.4691131114959717
Epoch: 6, Steps: 4 | Train Loss: 0.069 Vali Loss: 2.684 Vali Acc: 0.540 Test Loss: 2.684 Test Acc: 0.540
Validation loss decreased (-0.519977 --> -0.539973).  Saving model ...
Epoch: 7 cost time: 1.4814565181732178
Epoch: 7, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.647 Vali Acc: 0.560 Test Loss: 2.647 Test Acc: 0.560
Validation loss decreased (-0.539973 --> -0.559974).  Saving model ...
Epoch: 8 cost time: 1.4479281902313232
Epoch: 8, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.137 Vali Acc: 0.520 Test Loss: 3.137 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.432555913925171
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.718 Vali Acc: 0.460 Test Loss: 3.718 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4398775100708008
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.835 Vali Acc: 0.440 Test Loss: 3.835 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4434247016906738
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.316 Vali Acc: 0.400 Test Loss: 3.316 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4522018432617188
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.273 Vali Acc: 0.420 Test Loss: 3.273 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4440124034881592
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.099 Vali Acc: 0.460 Test Loss: 3.099 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.431886911392212
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.958 Vali Acc: 0.480 Test Loss: 2.958 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4160397052764893
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.858 Vali Acc: 0.500 Test Loss: 2.858 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4299802780151367
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.026 Vali Acc: 0.500 Test Loss: 3.026 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4469470977783203
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.500 Test Loss: 3.159 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 728414789
model size : 2780.68MB
2025-04-27 16:30:34.283074: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:30:34.302305: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745771434.324813  518482 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745771434.331642  518482 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:30:34.354295: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3538098335266113
Epoch: 1, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.606 Vali Acc: 0.380 Test Loss: 1.606 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 1.4505717754364014
Epoch: 2, Steps: 4 | Train Loss: 1.213 Vali Loss: 1.477 Vali Acc: 0.320 Test Loss: 1.477 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4015295505523682
Epoch: 3, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.598 Vali Acc: 0.340 Test Loss: 1.598 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.407623291015625
Epoch: 4, Steps: 4 | Train Loss: 0.300 Vali Loss: 1.609 Vali Acc: 0.420 Test Loss: 1.609 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419984).  Saving model ...
Epoch: 5 cost time: 1.4435229301452637
Epoch: 5, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.753 Vali Acc: 0.460 Test Loss: 1.753 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459982).  Saving model ...
Epoch: 6 cost time: 1.4549870491027832
Epoch: 6, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.977 Vali Acc: 0.440 Test Loss: 1.977 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.414149284362793
Epoch: 7, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.945 Vali Acc: 0.440 Test Loss: 1.945 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4137053489685059
Epoch: 8, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.130 Vali Acc: 0.420 Test Loss: 2.130 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.406564474105835
Epoch: 9, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.364 Vali Acc: 0.440 Test Loss: 2.364 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4050803184509277
Epoch: 10, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.561 Vali Acc: 0.480 Test Loss: 2.561 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479974).  Saving model ...
Epoch: 11 cost time: 1.4336862564086914
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.802 Vali Acc: 0.500 Test Loss: 2.802 Test Acc: 0.500
Validation loss decreased (-0.479974 --> -0.499972).  Saving model ...
Epoch: 12 cost time: 1.438781499862671
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 3.015 Vali Acc: 0.500 Test Loss: 3.015 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3980534076690674
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.257 Vali Acc: 0.420 Test Loss: 3.257 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3985135555267334
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.243 Vali Acc: 0.420 Test Loss: 3.243 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4004096984863281
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.162 Vali Acc: 0.440 Test Loss: 3.162 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.402773380279541
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.066 Vali Acc: 0.480 Test Loss: 3.066 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4087796211242676
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.040 Vali Acc: 0.380 Test Loss: 3.040 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4310963153839111
Epoch: 18, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.849 Vali Acc: 0.460 Test Loss: 2.849 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.401240348815918
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.393 Vali Acc: 0.400 Test Loss: 3.393 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4045531749725342
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.864 Vali Acc: 0.420 Test Loss: 3.864 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3927991390228271
Epoch: 21, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.110 Vali Acc: 0.440 Test Loss: 3.110 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 727984805
model size : 2779.04MB
2025-04-27 16:32:38.893064: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:32:38.913456: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745771558.936204  527972 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745771558.943206  527972 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:32:38.967087: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.417052745819092
Epoch: 1, Steps: 4 | Train Loss: 1.583 Vali Loss: 1.604 Vali Acc: 0.300 Test Loss: 1.604 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.4604976177215576
Epoch: 2, Steps: 4 | Train Loss: 1.107 Vali Loss: 1.461 Vali Acc: 0.280 Test Loss: 1.461 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4206106662750244
Epoch: 3, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.622 Vali Acc: 0.460 Test Loss: 1.622 Test Acc: 0.460
Validation loss decreased (-0.299984 --> -0.459984).  Saving model ...
Epoch: 4 cost time: 1.4671576023101807
Epoch: 4, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.754 Vali Acc: 0.580 Test Loss: 1.754 Test Acc: 0.580
Validation loss decreased (-0.459984 --> -0.579982).  Saving model ...
Epoch: 5 cost time: 1.44317626953125
Epoch: 5, Steps: 4 | Train Loss: 0.145 Vali Loss: 2.077 Vali Acc: 0.600 Test Loss: 2.077 Test Acc: 0.600
Validation loss decreased (-0.579982 --> -0.599979).  Saving model ...
Epoch: 6 cost time: 1.4428293704986572
Epoch: 6, Steps: 4 | Train Loss: 0.072 Vali Loss: 2.517 Vali Acc: 0.560 Test Loss: 2.517 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.431520938873291
Epoch: 7, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.829 Vali Acc: 0.560 Test Loss: 2.829 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.436460256576538
Epoch: 8, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.801 Vali Acc: 0.460 Test Loss: 2.801 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3929123878479004
Epoch: 9, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.750 Vali Acc: 0.500 Test Loss: 2.750 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3985145092010498
Epoch: 10, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.845 Vali Acc: 0.480 Test Loss: 2.845 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4065933227539062
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.220 Vali Acc: 0.480 Test Loss: 3.220 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.399733066558838
Epoch: 12, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.142 Vali Acc: 0.500 Test Loss: 3.142 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.414980411529541
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.138 Vali Acc: 0.540 Test Loss: 3.138 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4019854068756104
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.140 Vali Acc: 0.600 Test Loss: 3.140 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.405102252960205
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.953 Vali Acc: 0.500 Test Loss: 2.953 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 727554853
model size : 2777.40MB
2025-04-27 16:39:16.455661: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:39:16.475583: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745771956.497974  538310 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745771956.504685  538310 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:39:16.527120: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.03515362739563
Epoch: 1, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.578 Vali Acc: 0.340 Test Loss: 1.578 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 2.8712358474731445
Epoch: 2, Steps: 4 | Train Loss: 1.225 Vali Loss: 4.040 Vali Acc: 0.300 Test Loss: 4.040 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.842195987701416
Epoch: 3, Steps: 4 | Train Loss: 0.320 Vali Loss: 5.496 Vali Acc: 0.360 Test Loss: 5.496 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359945).  Saving model ...
Epoch: 4 cost time: 2.862105131149292
Epoch: 4, Steps: 4 | Train Loss: 0.881 Vali Loss: 6.678 Vali Acc: 0.440 Test Loss: 6.678 Test Acc: 0.440
Validation loss decreased (-0.359945 --> -0.439933).  Saving model ...
Epoch: 5 cost time: 2.8638792037963867
Epoch: 5, Steps: 4 | Train Loss: 0.847 Vali Loss: 11.593 Vali Acc: 0.440 Test Loss: 11.593 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8598241806030273
Epoch: 6, Steps: 4 | Train Loss: 0.308 Vali Loss: 8.760 Vali Acc: 0.540 Test Loss: 8.760 Test Acc: 0.540
Validation loss decreased (-0.439933 --> -0.539912).  Saving model ...
Epoch: 7 cost time: 2.8869192600250244
Epoch: 7, Steps: 4 | Train Loss: 2.530 Vali Loss: 9.920 Vali Acc: 0.380 Test Loss: 9.920 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8420097827911377
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.659 Vali Acc: 0.420 Test Loss: 9.659 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.836954355239868
Epoch: 9, Steps: 4 | Train Loss: 0.027 Vali Loss: 8.643 Vali Acc: 0.400 Test Loss: 8.643 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8603355884552
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.091 Vali Acc: 0.340 Test Loss: 11.091 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.828618049621582
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.077 Vali Acc: 0.340 Test Loss: 15.077 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8298494815826416
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.845 Vali Acc: 0.320 Test Loss: 14.845 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.832383155822754
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 18.489 Vali Acc: 0.420 Test Loss: 18.489 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8325390815734863
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 21.866 Vali Acc: 0.380 Test Loss: 21.866 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8238513469696045
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 23.735 Vali Acc: 0.420 Test Loss: 23.735 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8378098011016846
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 14.170 Vali Acc: 0.440 Test Loss: 14.170 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1534996229
model size : 5859.51MB
2025-04-27 16:42:22.404191: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:42:22.423868: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745772142.446318  546190 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745772142.453185  546190 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:42:22.476091: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4528236389160156
Epoch: 1, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.479 Vali Acc: 0.400 Test Loss: 1.479 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 2.6093077659606934
Epoch: 2, Steps: 4 | Train Loss: 0.865 Vali Loss: 2.754 Vali Acc: 0.300 Test Loss: 2.754 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5613369941711426
Epoch: 3, Steps: 4 | Train Loss: 0.924 Vali Loss: 2.816 Vali Acc: 0.360 Test Loss: 2.816 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5644309520721436
Epoch: 4, Steps: 4 | Train Loss: 0.025 Vali Loss: 6.337 Vali Acc: 0.380 Test Loss: 6.337 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5648694038391113
Epoch: 5, Steps: 4 | Train Loss: 0.604 Vali Loss: 7.163 Vali Acc: 0.340 Test Loss: 7.163 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.564971923828125
Epoch: 6, Steps: 4 | Train Loss: 0.010 Vali Loss: 7.611 Vali Acc: 0.400 Test Loss: 7.611 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.542039155960083
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 8.331 Vali Acc: 0.380 Test Loss: 8.331 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5822598934173584
Epoch: 8, Steps: 4 | Train Loss: 0.104 Vali Loss: 9.608 Vali Acc: 0.380 Test Loss: 9.608 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.544987678527832
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.872 Vali Acc: 0.400 Test Loss: 10.872 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5421934127807617
Epoch: 10, Steps: 4 | Train Loss: 0.064 Vali Loss: 10.176 Vali Acc: 0.420 Test Loss: 10.176 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419898).  Saving model ...
Epoch: 11 cost time: 2.5916545391082764
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.036 Vali Acc: 0.360 Test Loss: 9.036 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5488803386688232
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.855 Vali Acc: 0.380 Test Loss: 7.855 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.564700126647949
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.333 Vali Acc: 0.400 Test Loss: 6.333 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.559749126434326
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.152 Vali Acc: 0.420 Test Loss: 6.152 Test Acc: 0.420
Validation loss decreased (-0.419898 --> -0.419938).  Saving model ...
Epoch: 15 cost time: 2.5821356773376465
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.528 Vali Acc: 0.440 Test Loss: 5.528 Test Acc: 0.440
Validation loss decreased (-0.419938 --> -0.439945).  Saving model ...
Epoch: 16 cost time: 2.6140003204345703
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.822 Vali Acc: 0.460 Test Loss: 5.822 Test Acc: 0.460
Validation loss decreased (-0.439945 --> -0.459942).  Saving model ...
Epoch: 17 cost time: 2.60518217086792
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.090 Vali Acc: 0.480 Test Loss: 6.090 Test Acc: 0.480
Validation loss decreased (-0.459942 --> -0.479939).  Saving model ...
Epoch: 18 cost time: 2.5860064029693604
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.910 Vali Acc: 0.500 Test Loss: 5.910 Test Acc: 0.500
Validation loss decreased (-0.479939 --> -0.499941).  Saving model ...
Epoch: 19 cost time: 2.582824468612671
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.837 Vali Acc: 0.460 Test Loss: 5.837 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.564789056777954
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.165 Vali Acc: 0.440 Test Loss: 6.165 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5703718662261963
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.566 Vali Acc: 0.460 Test Loss: 6.566 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5626392364501953
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.870 Vali Acc: 0.480 Test Loss: 5.870 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.582028865814209
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.951 Vali Acc: 0.500 Test Loss: 5.951 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5837690830230713
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.690 Vali Acc: 0.460 Test Loss: 5.690 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5460710525512695
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.704 Vali Acc: 0.460 Test Loss: 5.704 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.553699016571045
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.164 Vali Acc: 0.480 Test Loss: 6.164 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.561769723892212
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.545 Vali Acc: 0.480 Test Loss: 6.545 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.54404616355896
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.587 Vali Acc: 0.500 Test Loss: 6.587 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1522084677
model size : 5810.26MB
2025-04-27 16:47:05.735995: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:47:05.755163: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745772425.777047  559591 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745772425.783730  559591 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:47:05.806347: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.268731117248535
Epoch: 1, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.559 Vali Acc: 0.240 Test Loss: 1.559 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.4047858715057373
Epoch: 2, Steps: 4 | Train Loss: 0.878 Vali Loss: 2.008 Vali Acc: 0.280 Test Loss: 2.008 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279980).  Saving model ...
Epoch: 3 cost time: 2.3368985652923584
Epoch: 3, Steps: 4 | Train Loss: 0.227 Vali Loss: 2.265 Vali Acc: 0.420 Test Loss: 2.265 Test Acc: 0.420
Validation loss decreased (-0.279980 --> -0.419977).  Saving model ...
Epoch: 4 cost time: 2.34246563911438
Epoch: 4, Steps: 4 | Train Loss: 0.049 Vali Loss: 4.590 Vali Acc: 0.420 Test Loss: 4.590 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.297978401184082
Epoch: 5, Steps: 4 | Train Loss: 0.078 Vali Loss: 5.969 Vali Acc: 0.320 Test Loss: 5.969 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2918457984924316
Epoch: 6, Steps: 4 | Train Loss: 0.017 Vali Loss: 7.128 Vali Acc: 0.360 Test Loss: 7.128 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3096530437469482
Epoch: 7, Steps: 4 | Train Loss: 0.062 Vali Loss: 7.321 Vali Acc: 0.340 Test Loss: 7.321 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3134889602661133
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.891 Vali Acc: 0.360 Test Loss: 6.891 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.313199758529663
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.733 Vali Acc: 0.400 Test Loss: 6.733 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3042778968811035
Epoch: 10, Steps: 4 | Train Loss: 0.109 Vali Loss: 6.249 Vali Acc: 0.420 Test Loss: 6.249 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.307420015335083
Epoch: 11, Steps: 4 | Train Loss: 0.109 Vali Loss: 6.719 Vali Acc: 0.380 Test Loss: 6.719 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3055365085601807
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.950 Vali Acc: 0.440 Test Loss: 6.950 Test Acc: 0.440
Validation loss decreased (-0.419977 --> -0.439930).  Saving model ...
Epoch: 13 cost time: 2.3425166606903076
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.900 Vali Acc: 0.360 Test Loss: 6.900 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.313554525375366
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.048 Vali Acc: 0.340 Test Loss: 8.048 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2987194061279297
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.922 Vali Acc: 0.340 Test Loss: 8.922 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.30118989944458
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.476 Vali Acc: 0.360 Test Loss: 9.476 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3014283180236816
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.865 Vali Acc: 0.360 Test Loss: 9.865 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3227789402008057
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.945 Vali Acc: 0.400 Test Loss: 9.945 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.30358624458313
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.125 Vali Acc: 0.400 Test Loss: 10.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3234736919403076
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.989 Vali Acc: 0.400 Test Loss: 9.989 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3295750617980957
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.141 Vali Acc: 0.400 Test Loss: 10.141 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2975895404815674
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.200 Vali Acc: 0.400 Test Loss: 10.200 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 1516059525
model size : 5787.28MB
2025-04-27 16:50:20.249544: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:50:20.268814: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745772620.290992  569944 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745772620.297784  569944 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:50:20.320764: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.125002384185791
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (inf --> -0.419985).  Saving model ...
Epoch: 2 cost time: 2.310835123062134
Epoch: 2, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.760 Vali Acc: 0.400 Test Loss: 1.760 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.264902114868164
Epoch: 3, Steps: 4 | Train Loss: 0.392 Vali Loss: 2.080 Vali Acc: 0.480 Test Loss: 2.080 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479979).  Saving model ...
Epoch: 4 cost time: 2.309105157852173
Epoch: 4, Steps: 4 | Train Loss: 0.093 Vali Loss: 3.020 Vali Acc: 0.500 Test Loss: 3.020 Test Acc: 0.500
Validation loss decreased (-0.479979 --> -0.499970).  Saving model ...
Epoch: 5 cost time: 2.30313777923584
Epoch: 5, Steps: 4 | Train Loss: 0.097 Vali Loss: 3.185 Vali Acc: 0.460 Test Loss: 3.185 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.282594919204712
Epoch: 6, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.299 Vali Acc: 0.520 Test Loss: 4.299 Test Acc: 0.520
Validation loss decreased (-0.499970 --> -0.519957).  Saving model ...
Epoch: 7 cost time: 2.327860116958618
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.001 Vali Acc: 0.520 Test Loss: 6.001 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.269412040710449
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.434 Vali Acc: 0.500 Test Loss: 7.434 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.285202980041504
Epoch: 9, Steps: 4 | Train Loss: 0.085 Vali Loss: 7.215 Vali Acc: 0.500 Test Loss: 7.215 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2770791053771973
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.863 Vali Acc: 0.360 Test Loss: 9.863 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2866921424865723
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 9.129 Vali Acc: 0.420 Test Loss: 9.129 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.273611545562744
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.952 Vali Acc: 0.480 Test Loss: 8.952 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2732443809509277
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.688 Vali Acc: 0.480 Test Loss: 8.688 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.28143310546875
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.240 Vali Acc: 0.460 Test Loss: 9.240 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2860207557678223
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.943 Vali Acc: 0.400 Test Loss: 8.943 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.289421319961548
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.123 Vali Acc: 0.420 Test Loss: 9.123 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1514338309
model size : 5780.71MB
2025-04-27 16:53:20.282118: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:53:20.301441: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745772800.324212  577810 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745772800.331141  577810 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:53:20.353948: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1150729656219482
Epoch: 1, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.506 Vali Acc: 0.320 Test Loss: 1.506 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 2.236689329147339
Epoch: 2, Steps: 4 | Train Loss: 0.995 Vali Loss: 1.562 Vali Acc: 0.340 Test Loss: 1.562 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 2.2737185955047607
Epoch: 3, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.939 Vali Acc: 0.440 Test Loss: 1.939 Test Acc: 0.440
Validation loss decreased (-0.339984 --> -0.439981).  Saving model ...
Epoch: 4 cost time: 2.210996389389038
Epoch: 4, Steps: 4 | Train Loss: 0.168 Vali Loss: 2.660 Vali Acc: 0.420 Test Loss: 2.660 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2134087085723877
Epoch: 5, Steps: 4 | Train Loss: 0.072 Vali Loss: 3.060 Vali Acc: 0.440 Test Loss: 3.060 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1959869861602783
Epoch: 6, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.338 Vali Acc: 0.420 Test Loss: 3.338 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.216634511947632
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.853 Vali Acc: 0.420 Test Loss: 3.853 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2283849716186523
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.315 Vali Acc: 0.440 Test Loss: 4.315 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2053205966949463
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.014 Vali Acc: 0.440 Test Loss: 5.014 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2167389392852783
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.278 Vali Acc: 0.440 Test Loss: 5.278 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.227409601211548
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.631 Vali Acc: 0.440 Test Loss: 5.631 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2083559036254883
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.404 Vali Acc: 0.440 Test Loss: 5.404 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2183687686920166
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.370 Vali Acc: 0.420 Test Loss: 5.370 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 1510896005
model size : 5767.58MB
2025-04-27 16:55:41.225923: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:55:41.245138: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745772941.267196  584204 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745772941.273919  584204 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:55:41.296817: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.263075828552246
Epoch: 1, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.544 Vali Acc: 0.320 Test Loss: 1.544 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 2.2292377948760986
Epoch: 2, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.855 Vali Acc: 0.320 Test Loss: 1.855 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1655948162078857
Epoch: 3, Steps: 4 | Train Loss: 0.514 Vali Loss: 1.941 Vali Acc: 0.440 Test Loss: 1.941 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439981).  Saving model ...
Epoch: 4 cost time: 2.1849968433380127
Epoch: 4, Steps: 4 | Train Loss: 0.297 Vali Loss: 2.202 Vali Acc: 0.520 Test Loss: 2.202 Test Acc: 0.520
Validation loss decreased (-0.439981 --> -0.519978).  Saving model ...
Epoch: 5 cost time: 2.2117528915405273
Epoch: 5, Steps: 4 | Train Loss: 0.112 Vali Loss: 2.838 Vali Acc: 0.500 Test Loss: 2.838 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1559386253356934
Epoch: 6, Steps: 4 | Train Loss: 0.024 Vali Loss: 3.263 Vali Acc: 0.440 Test Loss: 3.263 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1633660793304443
Epoch: 7, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.897 Vali Acc: 0.500 Test Loss: 3.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1873795986175537
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.051 Vali Acc: 0.480 Test Loss: 5.051 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1761012077331543
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.584 Vali Acc: 0.460 Test Loss: 5.584 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1641736030578613
Epoch: 10, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.863 Vali Acc: 0.460 Test Loss: 4.863 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.165719509124756
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.196 Vali Acc: 0.440 Test Loss: 4.196 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1555228233337402
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.008 Vali Acc: 0.500 Test Loss: 4.008 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1561944484710693
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.789 Vali Acc: 0.540 Test Loss: 3.789 Test Acc: 0.540
Validation loss decreased (-0.519978 --> -0.539962).  Saving model ...
Epoch: 14 cost time: 2.1832275390625
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.505 Vali Acc: 0.500 Test Loss: 3.505 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1840298175811768
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.360 Vali Acc: 0.520 Test Loss: 3.360 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1592488288879395
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.471 Vali Acc: 0.520 Test Loss: 3.471 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1610193252563477
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.576 Vali Acc: 0.480 Test Loss: 3.576 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.170581102371216
Epoch: 18, Steps: 4 | Train Loss: 0.480 Vali Loss: 3.422 Vali Acc: 0.460 Test Loss: 3.422 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.15762996673584
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.607 Vali Acc: 0.300 Test Loss: 4.607 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1594667434692383
Epoch: 20, Steps: 4 | Train Loss: 0.169 Vali Loss: 3.276 Vali Acc: 0.480 Test Loss: 3.276 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1630141735076904
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.484 Vali Acc: 0.400 Test Loss: 3.484 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1655731201171875
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.337 Vali Acc: 0.380 Test Loss: 4.337 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.174309253692627
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.111 Vali Acc: 0.400 Test Loss: 4.111 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1510036037
model size : 5764.30MB
2025-04-27 16:58:55.359263: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 16:58:55.378836: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745773135.401277  594980 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745773135.408085  594980 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 16:58:55.431066: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1277568340301514
Epoch: 1, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.547 Vali Acc: 0.340 Test Loss: 1.547 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 2.199632406234741
Epoch: 2, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.425 Vali Acc: 0.360 Test Loss: 1.425 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359986).  Saving model ...
Epoch: 3 cost time: 2.206827402114868
Epoch: 3, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.523 Vali Acc: 0.520 Test Loss: 1.523 Test Acc: 0.520
Validation loss decreased (-0.359986 --> -0.519985).  Saving model ...
Epoch: 4 cost time: 2.1965487003326416
Epoch: 4, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.764 Vali Acc: 0.520 Test Loss: 1.764 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.161961555480957
Epoch: 5, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.775 Vali Acc: 0.520 Test Loss: 1.775 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.174379825592041
Epoch: 6, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.087 Vali Acc: 0.600 Test Loss: 2.087 Test Acc: 0.600
Validation loss decreased (-0.519985 --> -0.599979).  Saving model ...
Epoch: 7 cost time: 2.2053439617156982
Epoch: 7, Steps: 4 | Train Loss: 0.046 Vali Loss: 2.259 Vali Acc: 0.560 Test Loss: 2.259 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1731231212615967
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.842 Vali Acc: 0.520 Test Loss: 2.842 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.149134635925293
Epoch: 9, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.642 Vali Acc: 0.520 Test Loss: 3.642 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1545746326446533
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.440 Vali Acc: 0.540 Test Loss: 4.440 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1872363090515137
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.264 Vali Acc: 0.480 Test Loss: 5.264 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.157989978790283
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.781 Vali Acc: 0.460 Test Loss: 5.781 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.15733003616333
Epoch: 13, Steps: 4 | Train Loss: 0.030 Vali Loss: 4.680 Vali Acc: 0.480 Test Loss: 4.680 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1743576526641846
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.697 Vali Acc: 0.460 Test Loss: 3.697 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1533069610595703
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.827 Vali Acc: 0.380 Test Loss: 3.827 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.159853935241699
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.622 Vali Acc: 0.480 Test Loss: 3.622 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1509176133
model size : 5761.02MB
2025-04-27 17:01:40.512314: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:01:40.531943: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745773300.554588  602741 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745773300.561521  602741 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:01:40.584492: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8083505630493164
Epoch: 1, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.496 Vali Acc: 0.360 Test Loss: 1.496 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 1.8675932884216309
Epoch: 2, Steps: 4 | Train Loss: 1.341 Vali Loss: 1.862 Vali Acc: 0.400 Test Loss: 1.862 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399981).  Saving model ...
Epoch: 3 cost time: 1.86029052734375
Epoch: 3, Steps: 4 | Train Loss: 0.302 Vali Loss: 4.109 Vali Acc: 0.460 Test Loss: 4.109 Test Acc: 0.460
Validation loss decreased (-0.399981 --> -0.459959).  Saving model ...
Epoch: 4 cost time: 1.8459687232971191
Epoch: 4, Steps: 4 | Train Loss: 0.184 Vali Loss: 5.524 Vali Acc: 0.400 Test Loss: 5.524 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8415486812591553
Epoch: 5, Steps: 4 | Train Loss: 0.068 Vali Loss: 5.650 Vali Acc: 0.440 Test Loss: 5.650 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8384599685668945
Epoch: 6, Steps: 4 | Train Loss: 0.220 Vali Loss: 5.938 Vali Acc: 0.400 Test Loss: 5.938 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8120005130767822
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.193 Vali Acc: 0.360 Test Loss: 7.193 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8218913078308105
Epoch: 8, Steps: 4 | Train Loss: 0.053 Vali Loss: 8.556 Vali Acc: 0.400 Test Loss: 8.556 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8175394535064697
Epoch: 9, Steps: 4 | Train Loss: 0.073 Vali Loss: 11.104 Vali Acc: 0.380 Test Loss: 11.104 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8213675022125244
Epoch: 10, Steps: 4 | Train Loss: 0.018 Vali Loss: 8.315 Vali Acc: 0.400 Test Loss: 8.315 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8135528564453125
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.827 Vali Acc: 0.400 Test Loss: 8.827 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8511309623718262
Epoch: 12, Steps: 4 | Train Loss: 0.043 Vali Loss: 8.145 Vali Acc: 0.440 Test Loss: 8.145 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8144114017486572
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.812 Vali Acc: 0.480 Test Loss: 10.812 Test Acc: 0.480
Validation loss decreased (-0.459959 --> -0.479892).  Saving model ...
Epoch: 14 cost time: 1.8717994689941406
Epoch: 14, Steps: 4 | Train Loss: 0.106 Vali Loss: 11.394 Vali Acc: 0.480 Test Loss: 11.394 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8319649696350098
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 8.567 Vali Acc: 0.420 Test Loss: 8.567 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8179655075073242
Epoch: 16, Steps: 4 | Train Loss: 0.104 Vali Loss: 9.397 Vali Acc: 0.460 Test Loss: 9.397 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8285608291625977
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.152 Vali Acc: 0.440 Test Loss: 14.152 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.840602159500122
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.000 Vali Acc: 0.400 Test Loss: 22.000 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8021442890167236
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 29.257 Vali Acc: 0.440 Test Loss: 29.257 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8083910942077637
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 30.719 Vali Acc: 0.460 Test Loss: 30.719 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.818528652191162
Epoch: 21, Steps: 4 | Train Loss: 0.069 Vali Loss: 27.518 Vali Acc: 0.400 Test Loss: 27.518 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8097403049468994
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.567 Vali Acc: 0.340 Test Loss: 29.567 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8168420791625977
Epoch: 23, Steps: 4 | Train Loss: 0.407 Vali Loss: 17.165 Vali Acc: 0.340 Test Loss: 17.165 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 739948421
model size : 2824.68MB
2025-04-27 17:03:52.724535: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:03:52.743938: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745773432.766165  613080 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745773432.772968  613080 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:03:52.796138: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5995900630950928
Epoch: 1, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.545 Vali Acc: 0.340 Test Loss: 1.545 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.6395435333251953
Epoch: 2, Steps: 4 | Train Loss: 0.939 Vali Loss: 2.158 Vali Acc: 0.300 Test Loss: 2.158 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2617995738983154
Epoch: 3, Steps: 4 | Train Loss: 0.417 Vali Loss: 3.292 Vali Acc: 0.340 Test Loss: 3.292 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5910120010375977
Epoch: 4, Steps: 4 | Train Loss: 0.316 Vali Loss: 4.217 Vali Acc: 0.420 Test Loss: 4.217 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419958).  Saving model ...
Epoch: 5 cost time: 1.6091182231903076
Epoch: 5, Steps: 4 | Train Loss: 0.253 Vali Loss: 4.279 Vali Acc: 0.460 Test Loss: 4.279 Test Acc: 0.460
Validation loss decreased (-0.419958 --> -0.459957).  Saving model ...
Epoch: 6 cost time: 1.630455732345581
Epoch: 6, Steps: 4 | Train Loss: 0.099 Vali Loss: 6.154 Vali Acc: 0.500 Test Loss: 6.154 Test Acc: 0.500
Validation loss decreased (-0.459957 --> -0.499938).  Saving model ...
Epoch: 7 cost time: 1.6256859302520752
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 9.622 Vali Acc: 0.380 Test Loss: 9.622 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6231536865234375
Epoch: 8, Steps: 4 | Train Loss: 0.049 Vali Loss: 6.612 Vali Acc: 0.460 Test Loss: 6.612 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6096234321594238
Epoch: 9, Steps: 4 | Train Loss: 0.048 Vali Loss: 6.844 Vali Acc: 0.440 Test Loss: 6.844 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.593637228012085
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.931 Vali Acc: 0.440 Test Loss: 7.931 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5886175632476807
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 8.726 Vali Acc: 0.500 Test Loss: 8.726 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.603046178817749
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.181 Vali Acc: 0.480 Test Loss: 9.181 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6017589569091797
Epoch: 13, Steps: 4 | Train Loss: 0.034 Vali Loss: 7.137 Vali Acc: 0.500 Test Loss: 7.137 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5879957675933838
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.079 Vali Acc: 0.500 Test Loss: 7.079 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5917606353759766
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.420 Vali Acc: 0.420 Test Loss: 7.420 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6119201183319092
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.717 Vali Acc: 0.400 Test Loss: 6.717 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 733492645
model size : 2800.05MB
2025-04-27 17:05:37.374759: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:05:37.394404: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745773537.417062  620421 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745773537.423869  620421 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:05:37.446733: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5296666622161865
Epoch: 1, Steps: 4 | Train Loss: 1.560 Vali Loss: 1.590 Vali Acc: 0.280 Test Loss: 1.590 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.527679443359375
Epoch: 2, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.596 Vali Acc: 0.320 Test Loss: 1.596 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.5190024375915527
Epoch: 3, Steps: 4 | Train Loss: 0.414 Vali Loss: 2.180 Vali Acc: 0.360 Test Loss: 2.180 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359978).  Saving model ...
Epoch: 4 cost time: 1.4973716735839844
Epoch: 4, Steps: 4 | Train Loss: 0.158 Vali Loss: 2.596 Vali Acc: 0.400 Test Loss: 2.596 Test Acc: 0.400
Validation loss decreased (-0.359978 --> -0.399974).  Saving model ...
Epoch: 5 cost time: 1.508655071258545
Epoch: 5, Steps: 4 | Train Loss: 0.177 Vali Loss: 2.958 Vali Acc: 0.420 Test Loss: 2.958 Test Acc: 0.420
Validation loss decreased (-0.399974 --> -0.419970).  Saving model ...
Epoch: 6 cost time: 1.533362627029419
Epoch: 6, Steps: 4 | Train Loss: 0.051 Vali Loss: 3.542 Vali Acc: 0.460 Test Loss: 3.542 Test Acc: 0.460
Validation loss decreased (-0.419970 --> -0.459965).  Saving model ...
Epoch: 7 cost time: 1.5097370147705078
Epoch: 7, Steps: 4 | Train Loss: 0.019 Vali Loss: 3.145 Vali Acc: 0.460 Test Loss: 3.145 Test Acc: 0.460
Validation loss decreased (-0.459965 --> -0.459969).  Saving model ...
Epoch: 8 cost time: 1.5184121131896973
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.446 Vali Acc: 0.400 Test Loss: 3.446 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4748334884643555
Epoch: 9, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.669 Vali Acc: 0.440 Test Loss: 3.669 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4836440086364746
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.347 Vali Acc: 0.420 Test Loss: 4.347 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4774081707000732
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.946 Vali Acc: 0.400 Test Loss: 4.946 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4843780994415283
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.317 Vali Acc: 0.420 Test Loss: 5.317 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.467545747756958
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.520 Vali Acc: 0.420 Test Loss: 5.520 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5073301792144775
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.798 Vali Acc: 0.420 Test Loss: 5.798 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4835655689239502
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.869 Vali Acc: 0.420 Test Loss: 5.869 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.48996901512146
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.422 Vali Acc: 0.420 Test Loss: 5.422 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.490513801574707
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.492 Vali Acc: 0.440 Test Loss: 5.492 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 730480069
model size : 2788.56MB
2025-04-27 17:07:53.292852: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:07:53.312228: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745773673.334433  628377 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745773673.341266  628377 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:07:53.364148: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4512205123901367
Epoch: 1, Steps: 4 | Train Loss: 1.733 Vali Loss: 1.594 Vali Acc: 0.340 Test Loss: 1.594 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.5146241188049316
Epoch: 2, Steps: 4 | Train Loss: 1.025 Vali Loss: 1.551 Vali Acc: 0.320 Test Loss: 1.551 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4841187000274658
Epoch: 3, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.873 Vali Acc: 0.500 Test Loss: 1.873 Test Acc: 0.500
Validation loss decreased (-0.339984 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 1.4973716735839844
Epoch: 4, Steps: 4 | Train Loss: 0.147 Vali Loss: 2.363 Vali Acc: 0.400 Test Loss: 2.363 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4592866897583008
Epoch: 5, Steps: 4 | Train Loss: 0.091 Vali Loss: 2.715 Vali Acc: 0.420 Test Loss: 2.715 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4973857402801514
Epoch: 6, Steps: 4 | Train Loss: 0.038 Vali Loss: 2.985 Vali Acc: 0.420 Test Loss: 2.985 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4525232315063477
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.858 Vali Acc: 0.440 Test Loss: 3.858 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4795277118682861
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.704 Vali Acc: 0.420 Test Loss: 4.704 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.488961935043335
Epoch: 9, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.591 Vali Acc: 0.500 Test Loss: 4.591 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4800176620483398
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.622 Vali Acc: 0.440 Test Loss: 4.622 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4750792980194092
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.491 Vali Acc: 0.400 Test Loss: 4.491 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4781229496002197
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.645 Vali Acc: 0.400 Test Loss: 4.645 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4617304801940918
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.279 Vali Acc: 0.420 Test Loss: 4.279 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 729619461
model size : 2785.27MB
2025-04-27 17:09:12.358367: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:09:12.377707: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745773752.400181  634347 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745773752.407021  634347 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:09:12.430029: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4463093280792236
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.539 Vali Acc: 0.280 Test Loss: 1.539 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.4796733856201172
Epoch: 2, Steps: 4 | Train Loss: 1.210 Vali Loss: 1.569 Vali Acc: 0.400 Test Loss: 1.569 Test Acc: 0.400
Validation loss decreased (-0.279985 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 1.5068557262420654
Epoch: 3, Steps: 4 | Train Loss: 0.608 Vali Loss: 1.705 Vali Acc: 0.520 Test Loss: 1.705 Test Acc: 0.520
Validation loss decreased (-0.399984 --> -0.519983).  Saving model ...
Epoch: 4 cost time: 1.4729008674621582
Epoch: 4, Steps: 4 | Train Loss: 0.270 Vali Loss: 2.179 Vali Acc: 0.520 Test Loss: 2.179 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.431243658065796
Epoch: 5, Steps: 4 | Train Loss: 0.133 Vali Loss: 3.107 Vali Acc: 0.540 Test Loss: 3.107 Test Acc: 0.540
Validation loss decreased (-0.519983 --> -0.539969).  Saving model ...
Epoch: 6 cost time: 1.4981305599212646
Epoch: 6, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.844 Vali Acc: 0.500 Test Loss: 2.844 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4358856678009033
Epoch: 7, Steps: 4 | Train Loss: 0.043 Vali Loss: 3.228 Vali Acc: 0.560 Test Loss: 3.228 Test Acc: 0.560
Validation loss decreased (-0.539969 --> -0.559968).  Saving model ...
Epoch: 8 cost time: 1.4734628200531006
Epoch: 8, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.833 Vali Acc: 0.580 Test Loss: 3.833 Test Acc: 0.580
Validation loss decreased (-0.559968 --> -0.579962).  Saving model ...
Epoch: 9 cost time: 1.4714851379394531
Epoch: 9, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.126 Vali Acc: 0.520 Test Loss: 4.126 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4708473682403564
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.399 Vali Acc: 0.520 Test Loss: 4.399 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4449248313903809
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.570 Vali Acc: 0.540 Test Loss: 4.570 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4457294940948486
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.735 Vali Acc: 0.580 Test Loss: 4.735 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4391467571258545
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.755 Vali Acc: 0.580 Test Loss: 4.755 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.435593843460083
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.746 Vali Acc: 0.520 Test Loss: 4.746 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.438244342803955
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.757 Vali Acc: 0.560 Test Loss: 4.757 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4234585762023926
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.856 Vali Acc: 0.580 Test Loss: 4.856 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.427917718887329
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.674 Vali Acc: 0.580 Test Loss: 4.674 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.447706937789917
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.766 Vali Acc: 0.620 Test Loss: 4.766 Test Acc: 0.620
Validation loss decreased (-0.579962 --> -0.619952).  Saving model ...
Epoch: 19 cost time: 1.4734413623809814
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.612 Vali Acc: 0.600 Test Loss: 4.612 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4709677696228027
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.537 Vali Acc: 0.600 Test Loss: 4.537 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4462389945983887
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.699 Vali Acc: 0.600 Test Loss: 4.699 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.436018705368042
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.744 Vali Acc: 0.600 Test Loss: 4.744 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4317951202392578
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.725 Vali Acc: 0.620 Test Loss: 4.725 Test Acc: 0.620
Validation loss decreased (-0.619952 --> -0.619953).  Saving model ...
Epoch: 24 cost time: 1.4669182300567627
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.768 Vali Acc: 0.620 Test Loss: 4.768 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.42484450340271
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.819 Vali Acc: 0.620 Test Loss: 4.819 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4570183753967285
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.958 Vali Acc: 0.620 Test Loss: 4.958 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4471886157989502
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.946 Vali Acc: 0.620 Test Loss: 4.946 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4309940338134766
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.962 Vali Acc: 0.620 Test Loss: 4.962 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4384698867797852
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.901 Vali Acc: 0.600 Test Loss: 4.901 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4364545345306396
Epoch: 30, Steps: 4 | Train Loss: 0.019 Vali Loss: 4.197 Vali Acc: 0.540 Test Loss: 4.197 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.450035810470581
Epoch: 31, Steps: 4 | Train Loss: 0.045 Vali Loss: 4.984 Vali Acc: 0.480 Test Loss: 4.984 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4261879920959473
Epoch: 32, Steps: 4 | Train Loss: 0.075 Vali Loss: 4.671 Vali Acc: 0.500 Test Loss: 4.671 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4390316009521484
Epoch: 33, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.314 Vali Acc: 0.400 Test Loss: 4.314 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 727898309
model size : 2778.71MB
2025-04-27 17:12:14.292138: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:12:14.311390: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745773934.333530  649061 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745773934.340343  649061 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:12:14.363054: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4180614948272705
Epoch: 1, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.557 Vali Acc: 0.280 Test Loss: 1.557 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.4747884273529053
Epoch: 2, Steps: 4 | Train Loss: 1.130 Vali Loss: 1.446 Vali Acc: 0.300 Test Loss: 1.446 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.4350476264953613
Epoch: 3, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.438 Vali Acc: 0.380 Test Loss: 1.438 Test Acc: 0.380
Validation loss decreased (-0.299986 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 1.4345180988311768
Epoch: 4, Steps: 4 | Train Loss: 0.305 Vali Loss: 1.650 Vali Acc: 0.460 Test Loss: 1.650 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459983).  Saving model ...
Epoch: 5 cost time: 1.4537391662597656
Epoch: 5, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.820 Vali Acc: 0.500 Test Loss: 1.820 Test Acc: 0.500
Validation loss decreased (-0.459983 --> -0.499982).  Saving model ...
Epoch: 6 cost time: 1.4346067905426025
Epoch: 6, Steps: 4 | Train Loss: 0.124 Vali Loss: 2.121 Vali Acc: 0.440 Test Loss: 2.121 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4214200973510742
Epoch: 7, Steps: 4 | Train Loss: 0.058 Vali Loss: 2.407 Vali Acc: 0.460 Test Loss: 2.407 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4164273738861084
Epoch: 8, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.545 Vali Acc: 0.480 Test Loss: 2.545 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.443331241607666
Epoch: 9, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.445 Vali Acc: 0.500 Test Loss: 2.445 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4150135517120361
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.449 Vali Acc: 0.440 Test Loss: 2.449 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.409898042678833
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.550 Vali Acc: 0.440 Test Loss: 2.550 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4082441329956055
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.679 Vali Acc: 0.480 Test Loss: 2.679 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4143640995025635
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.498 Vali Acc: 0.480 Test Loss: 2.498 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.412865400314331
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.596 Vali Acc: 0.480 Test Loss: 2.596 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4088149070739746
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.764 Vali Acc: 0.500 Test Loss: 2.764 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 727468325
model size : 2777.07MB
2025-04-27 17:14:03.406195: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:14:03.425595: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745774043.447981  656025 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745774043.454785  656025 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:14:03.478555: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.401864767074585
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.522 Vali Acc: 0.240 Test Loss: 1.522 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.4305555820465088
Epoch: 2, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.445 Vali Acc: 0.400 Test Loss: 1.445 Test Acc: 0.400
Validation loss decreased (-0.239985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.4382271766662598
Epoch: 3, Steps: 4 | Train Loss: 0.617 Vali Loss: 1.608 Vali Acc: 0.500 Test Loss: 1.608 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499984).  Saving model ...
Epoch: 4 cost time: 1.4330089092254639
Epoch: 4, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.930 Vali Acc: 0.520 Test Loss: 1.930 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519981).  Saving model ...
Epoch: 5 cost time: 1.413508653640747
Epoch: 5, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.902 Vali Acc: 0.560 Test Loss: 1.902 Test Acc: 0.560
Validation loss decreased (-0.519981 --> -0.559981).  Saving model ...
Epoch: 6 cost time: 1.4337944984436035
Epoch: 6, Steps: 4 | Train Loss: 0.114 Vali Loss: 2.384 Vali Acc: 0.540 Test Loss: 2.384 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4042787551879883
Epoch: 7, Steps: 4 | Train Loss: 0.100 Vali Loss: 2.238 Vali Acc: 0.560 Test Loss: 2.238 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4101614952087402
Epoch: 8, Steps: 4 | Train Loss: 0.057 Vali Loss: 2.484 Vali Acc: 0.440 Test Loss: 2.484 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3905832767486572
Epoch: 9, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.154 Vali Acc: 0.420 Test Loss: 3.154 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3991007804870605
Epoch: 10, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.334 Vali Acc: 0.480 Test Loss: 3.334 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.41064453125
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.492 Vali Acc: 0.500 Test Loss: 3.492 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3864264488220215
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.517 Vali Acc: 0.520 Test Loss: 3.517 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3994348049163818
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.534 Vali Acc: 0.520 Test Loss: 3.534 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.384899377822876
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.758 Vali Acc: 0.520 Test Loss: 3.758 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.408325433731079
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.886 Vali Acc: 0.520 Test Loss: 3.886 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 727038373
model size : 2775.43MB
2025-04-27 17:19:39.087721: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:19:39.105053: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745774379.126735  665860 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745774379.133342  665860 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:19:39.154863: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1192269325256348
Epoch: 1, Steps: 4 | Train Loss: 2.022 Vali Loss: 1.516 Vali Acc: 0.360 Test Loss: 1.516 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 2.2929861545562744
Epoch: 2, Steps: 4 | Train Loss: 1.397 Vali Loss: 10.654 Vali Acc: 0.400 Test Loss: 10.654 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399893).  Saving model ...
Epoch: 3 cost time: 2.280299425125122
Epoch: 3, Steps: 4 | Train Loss: 0.952 Vali Loss: 37.835 Vali Acc: 0.480 Test Loss: 37.835 Test Acc: 0.480
Validation loss decreased (-0.399893 --> -0.479622).  Saving model ...
Epoch: 4 cost time: 2.2817208766937256
Epoch: 4, Steps: 4 | Train Loss: 5.094 Vali Loss: 40.679 Vali Acc: 0.480 Test Loss: 40.679 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2371041774749756
Epoch: 5, Steps: 4 | Train Loss: 0.193 Vali Loss: 36.416 Vali Acc: 0.520 Test Loss: 36.416 Test Acc: 0.520
Validation loss decreased (-0.479622 --> -0.519636).  Saving model ...
Epoch: 6 cost time: 2.2851545810699463
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 84.901 Vali Acc: 0.500 Test Loss: 84.901 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.257110118865967
Epoch: 7, Steps: 4 | Train Loss: 0.465 Vali Loss: 110.278 Vali Acc: 0.440 Test Loss: 110.278 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.246865749359131
Epoch: 8, Steps: 4 | Train Loss: 0.759 Vali Loss: 66.354 Vali Acc: 0.420 Test Loss: 66.354 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.242563009262085
Epoch: 9, Steps: 4 | Train Loss: 0.936 Vali Loss: 100.798 Vali Acc: 0.540 Test Loss: 100.798 Test Acc: 0.540
Validation loss decreased (-0.519636 --> -0.538992).  Saving model ...
Epoch: 10 cost time: 2.283135414123535
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 128.916 Vali Acc: 0.500 Test Loss: 128.916 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2698941230773926
Epoch: 11, Steps: 4 | Train Loss: 1.105 Vali Loss: 109.506 Vali Acc: 0.360 Test Loss: 109.506 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2498555183410645
Epoch: 12, Steps: 4 | Train Loss: 13.698 Vali Loss: 78.604 Vali Acc: 0.480 Test Loss: 78.604 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.260230302810669
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 197.146 Vali Acc: 0.260 Test Loss: 197.146 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.250173568725586
Epoch: 14, Steps: 4 | Train Loss: 31.862 Vali Loss: 134.916 Vali Acc: 0.380 Test Loss: 134.916 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.247239112854004
Epoch: 15, Steps: 4 | Train Loss: 0.239 Vali Loss: 98.197 Vali Acc: 0.400 Test Loss: 98.197 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.246354103088379
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 118.762 Vali Acc: 0.420 Test Loss: 118.762 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.235023260116577
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 142.875 Vali Acc: 0.380 Test Loss: 142.875 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2668344974517822
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 159.413 Vali Acc: 0.400 Test Loss: 159.413 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2459678649902344
Epoch: 19, Steps: 4 | Train Loss: 0.559 Vali Loss: 127.031 Vali Acc: 0.360 Test Loss: 127.031 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1076862341
model size : 4110.55MB
2025-04-27 17:22:25.305025: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:22:25.324015: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745774545.346198  674834 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745774545.352968  674834 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:22:25.375517: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.880403757095337
Epoch: 1, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.625 Vali Acc: 0.340 Test Loss: 1.625 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.9930474758148193
Epoch: 2, Steps: 4 | Train Loss: 2.133 Vali Loss: 7.270 Vali Acc: 0.400 Test Loss: 7.270 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399927).  Saving model ...
Epoch: 3 cost time: 1.992257833480835
Epoch: 3, Steps: 4 | Train Loss: 1.328 Vali Loss: 12.186 Vali Acc: 0.400 Test Loss: 12.186 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.983384132385254
Epoch: 4, Steps: 4 | Train Loss: 0.159 Vali Loss: 20.951 Vali Acc: 0.400 Test Loss: 20.951 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9524271488189697
Epoch: 5, Steps: 4 | Train Loss: 1.486 Vali Loss: 28.736 Vali Acc: 0.360 Test Loss: 28.736 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9554250240325928
Epoch: 6, Steps: 4 | Train Loss: 0.176 Vali Loss: 24.880 Vali Acc: 0.400 Test Loss: 24.880 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.971543312072754
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.457 Vali Acc: 0.440 Test Loss: 21.457 Test Acc: 0.440
Validation loss decreased (-0.399927 --> -0.439785).  Saving model ...
Epoch: 8 cost time: 2.0313103199005127
Epoch: 8, Steps: 4 | Train Loss: 0.118 Vali Loss: 31.088 Vali Acc: 0.400 Test Loss: 31.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9657793045043945
Epoch: 9, Steps: 4 | Train Loss: 0.389 Vali Loss: 37.539 Vali Acc: 0.480 Test Loss: 37.539 Test Acc: 0.480
Validation loss decreased (-0.439785 --> -0.479625).  Saving model ...
Epoch: 10 cost time: 1.9830045700073242
Epoch: 10, Steps: 4 | Train Loss: 0.122 Vali Loss: 35.170 Vali Acc: 0.480 Test Loss: 35.170 Test Acc: 0.480
Validation loss decreased (-0.479625 --> -0.479648).  Saving model ...
Epoch: 11 cost time: 2.0176169872283936
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 32.761 Vali Acc: 0.480 Test Loss: 32.761 Test Acc: 0.480
Validation loss decreased (-0.479648 --> -0.479672).  Saving model ...
Epoch: 12 cost time: 1.9879024028778076
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 31.959 Vali Acc: 0.440 Test Loss: 31.959 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9687674045562744
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 28.966 Vali Acc: 0.440 Test Loss: 28.966 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9726686477661133
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.722 Vali Acc: 0.400 Test Loss: 29.722 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.977790117263794
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.583 Vali Acc: 0.440 Test Loss: 29.583 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9595162868499756
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.022 Vali Acc: 0.440 Test Loss: 29.022 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9727754592895508
Epoch: 17, Steps: 4 | Train Loss: 0.109 Vali Loss: 53.718 Vali Acc: 0.400 Test Loss: 53.718 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9732253551483154
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 79.008 Vali Acc: 0.340 Test Loss: 79.008 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9658772945404053
Epoch: 19, Steps: 4 | Train Loss: 0.945 Vali Loss: 58.682 Vali Acc: 0.480 Test Loss: 58.682 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9580657482147217
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 70.784 Vali Acc: 0.520 Test Loss: 70.784 Test Acc: 0.520
Validation loss decreased (-0.479672 --> -0.519292).  Saving model ...
Epoch: 21 cost time: 2.0137321949005127
Epoch: 21, Steps: 4 | Train Loss: 0.245 Vali Loss: 93.601 Vali Acc: 0.360 Test Loss: 93.601 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9896862506866455
Epoch: 22, Steps: 4 | Train Loss: 2.244 Vali Loss: 72.604 Vali Acc: 0.360 Test Loss: 72.604 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9582583904266357
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 91.497 Vali Acc: 0.400 Test Loss: 91.497 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9591405391693115
Epoch: 24, Steps: 4 | Train Loss: 0.656 Vali Loss: 101.801 Vali Acc: 0.380 Test Loss: 101.801 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9603755474090576
Epoch: 25, Steps: 4 | Train Loss: 0.220 Vali Loss: 132.034 Vali Acc: 0.360 Test Loss: 132.034 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9617056846618652
Epoch: 26, Steps: 4 | Train Loss: 5.428 Vali Loss: 88.361 Vali Acc: 0.380 Test Loss: 88.361 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9618206024169922
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 102.025 Vali Acc: 0.420 Test Loss: 102.025 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.969397783279419
Epoch: 28, Steps: 4 | Train Loss: 11.233 Vali Loss: 118.383 Vali Acc: 0.460 Test Loss: 118.383 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.976741075515747
Epoch: 29, Steps: 4 | Train Loss: 0.545 Vali Loss: 112.938 Vali Acc: 0.360 Test Loss: 112.938 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9872701168060303
Epoch: 30, Steps: 4 | Train Loss: 0.099 Vali Loss: 123.204 Vali Acc: 0.300 Test Loss: 123.204 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1051900037
model size : 4015.32MB
2025-04-27 17:26:10.735719: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:26:10.755137: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745774770.777298  688638 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745774770.784166  688638 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:26:10.807233: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8642780780792236
Epoch: 1, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.485 Vali Acc: 0.300 Test Loss: 1.485 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.918288230895996
Epoch: 2, Steps: 4 | Train Loss: 1.478 Vali Loss: 5.657 Vali Acc: 0.380 Test Loss: 5.657 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379943).  Saving model ...
Epoch: 3 cost time: 1.9135046005249023
Epoch: 3, Steps: 4 | Train Loss: 0.341 Vali Loss: 9.501 Vali Acc: 0.460 Test Loss: 9.501 Test Acc: 0.460
Validation loss decreased (-0.379943 --> -0.459905).  Saving model ...
Epoch: 4 cost time: 1.9051778316497803
Epoch: 4, Steps: 4 | Train Loss: 0.336 Vali Loss: 8.938 Vali Acc: 0.420 Test Loss: 8.938 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8927488327026367
Epoch: 5, Steps: 4 | Train Loss: 0.007 Vali Loss: 14.711 Vali Acc: 0.360 Test Loss: 14.711 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8817331790924072
Epoch: 6, Steps: 4 | Train Loss: 0.010 Vali Loss: 22.053 Vali Acc: 0.380 Test Loss: 22.053 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8641984462738037
Epoch: 7, Steps: 4 | Train Loss: 0.429 Vali Loss: 21.310 Vali Acc: 0.480 Test Loss: 21.310 Test Acc: 0.480
Validation loss decreased (-0.459905 --> -0.479787).  Saving model ...
Epoch: 8 cost time: 1.9137928485870361
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.867 Vali Acc: 0.360 Test Loss: 22.867 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.872864007949829
Epoch: 9, Steps: 4 | Train Loss: 0.236 Vali Loss: 23.477 Vali Acc: 0.480 Test Loss: 23.477 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8879847526550293
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 37.999 Vali Acc: 0.400 Test Loss: 37.999 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.875563144683838
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 35.177 Vali Acc: 0.420 Test Loss: 35.177 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8687448501586914
Epoch: 12, Steps: 4 | Train Loss: 0.170 Vali Loss: 38.660 Vali Acc: 0.380 Test Loss: 38.660 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.856252908706665
Epoch: 13, Steps: 4 | Train Loss: 0.402 Vali Loss: 33.932 Vali Acc: 0.400 Test Loss: 33.932 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8648931980133057
Epoch: 14, Steps: 4 | Train Loss: 0.191 Vali Loss: 29.754 Vali Acc: 0.380 Test Loss: 29.754 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8752193450927734
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 38.173 Vali Acc: 0.460 Test Loss: 38.173 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8826894760131836
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 46.765 Vali Acc: 0.360 Test Loss: 46.765 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.876488447189331
Epoch: 17, Steps: 4 | Train Loss: 0.438 Vali Loss: 45.644 Vali Acc: 0.320 Test Loss: 45.644 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1039849733
model size : 3969.35MB
2025-04-27 17:28:23.034693: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:28:23.054313: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745774903.076531  696567 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745774903.083299  696567 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:28:23.105832: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.828235626220703
Epoch: 1, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.479 Vali Acc: 0.340 Test Loss: 1.479 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.856323480606079
Epoch: 2, Steps: 4 | Train Loss: 0.933 Vali Loss: 4.831 Vali Acc: 0.420 Test Loss: 4.831 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419952).  Saving model ...
Epoch: 3 cost time: 1.8432176113128662
Epoch: 3, Steps: 4 | Train Loss: 0.542 Vali Loss: 5.890 Vali Acc: 0.400 Test Loss: 5.890 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.809255838394165
Epoch: 4, Steps: 4 | Train Loss: 1.050 Vali Loss: 10.905 Vali Acc: 0.420 Test Loss: 10.905 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8576900959014893
Epoch: 5, Steps: 4 | Train Loss: 0.693 Vali Loss: 13.270 Vali Acc: 0.340 Test Loss: 13.270 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8250887393951416
Epoch: 6, Steps: 4 | Train Loss: 0.084 Vali Loss: 17.761 Vali Acc: 0.360 Test Loss: 17.761 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8251678943634033
Epoch: 7, Steps: 4 | Train Loss: 0.083 Vali Loss: 24.462 Vali Acc: 0.440 Test Loss: 24.462 Test Acc: 0.440
Validation loss decreased (-0.419952 --> -0.439755).  Saving model ...
Epoch: 8 cost time: 1.8598127365112305
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 34.856 Vali Acc: 0.360 Test Loss: 34.856 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.838343858718872
Epoch: 9, Steps: 4 | Train Loss: 0.068 Vali Loss: 27.715 Vali Acc: 0.440 Test Loss: 27.715 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8126468658447266
Epoch: 10, Steps: 4 | Train Loss: 0.130 Vali Loss: 25.711 Vali Acc: 0.320 Test Loss: 25.711 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8172025680541992
Epoch: 11, Steps: 4 | Train Loss: 0.156 Vali Loss: 26.025 Vali Acc: 0.280 Test Loss: 26.025 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8441765308380127
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 31.314 Vali Acc: 0.340 Test Loss: 31.314 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8256678581237793
Epoch: 13, Steps: 4 | Train Loss: 1.681 Vali Loss: 27.068 Vali Acc: 0.340 Test Loss: 27.068 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8270905017852783
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 28.431 Vali Acc: 0.360 Test Loss: 28.431 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.834000825881958
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 38.800 Vali Acc: 0.380 Test Loss: 38.800 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8291218280792236
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 60.111 Vali Acc: 0.320 Test Loss: 60.111 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8205394744873047
Epoch: 17, Steps: 4 | Train Loss: 0.218 Vali Loss: 35.190 Vali Acc: 0.360 Test Loss: 35.190 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 1035546501
model size : 3952.94MB
2025-04-27 17:30:23.475385: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:30:23.495763: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775023.518651  704419 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775023.525602  704419 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:30:23.548923: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6988253593444824
Epoch: 1, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.436 Vali Acc: 0.400 Test Loss: 1.436 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.8086977005004883
Epoch: 2, Steps: 4 | Train Loss: 0.936 Vali Loss: 2.509 Vali Acc: 0.460 Test Loss: 2.509 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459975).  Saving model ...
Epoch: 3 cost time: 1.789562463760376
Epoch: 3, Steps: 4 | Train Loss: 0.109 Vali Loss: 6.898 Vali Acc: 0.340 Test Loss: 6.898 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7498931884765625
Epoch: 4, Steps: 4 | Train Loss: 0.241 Vali Loss: 12.437 Vali Acc: 0.400 Test Loss: 12.437 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7477731704711914
Epoch: 5, Steps: 4 | Train Loss: 0.475 Vali Loss: 18.151 Vali Acc: 0.420 Test Loss: 18.151 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7832167148590088
Epoch: 6, Steps: 4 | Train Loss: 0.358 Vali Loss: 13.064 Vali Acc: 0.500 Test Loss: 13.064 Test Acc: 0.500
Validation loss decreased (-0.459975 --> -0.499869).  Saving model ...
Epoch: 7 cost time: 1.7999365329742432
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 20.413 Vali Acc: 0.500 Test Loss: 20.413 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7462947368621826
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 24.282 Vali Acc: 0.460 Test Loss: 24.282 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7616238594055176
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 26.231 Vali Acc: 0.460 Test Loss: 26.231 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7662279605865479
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 27.574 Vali Acc: 0.460 Test Loss: 27.574 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.757075309753418
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 26.796 Vali Acc: 0.440 Test Loss: 26.796 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7473716735839844
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 27.838 Vali Acc: 0.440 Test Loss: 27.838 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7567243576049805
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 28.047 Vali Acc: 0.460 Test Loss: 28.047 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7817332744598389
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.031 Vali Acc: 0.440 Test Loss: 29.031 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7625293731689453
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 30.410 Vali Acc: 0.420 Test Loss: 30.410 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7666032314300537
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 32.571 Vali Acc: 0.440 Test Loss: 32.571 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1029522693
model size : 3929.96MB
2025-04-27 17:32:17.959805: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:32:17.979618: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775138.002048  711827 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775138.008836  711827 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:32:18.032111: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7189221382141113
Epoch: 1, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.626 Vali Acc: 0.360 Test Loss: 1.626 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 1.7867603302001953
Epoch: 2, Steps: 4 | Train Loss: 0.713 Vali Loss: 2.781 Vali Acc: 0.340 Test Loss: 2.781 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7583911418914795
Epoch: 3, Steps: 4 | Train Loss: 0.601 Vali Loss: 3.200 Vali Acc: 0.480 Test Loss: 3.200 Test Acc: 0.480
Validation loss decreased (-0.359984 --> -0.479968).  Saving model ...
Epoch: 4 cost time: 1.7668159008026123
Epoch: 4, Steps: 4 | Train Loss: 0.113 Vali Loss: 6.389 Vali Acc: 0.440 Test Loss: 6.389 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7144269943237305
Epoch: 5, Steps: 4 | Train Loss: 0.638 Vali Loss: 8.925 Vali Acc: 0.480 Test Loss: 8.925 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.727693796157837
Epoch: 6, Steps: 4 | Train Loss: 0.270 Vali Loss: 8.887 Vali Acc: 0.480 Test Loss: 8.887 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7176353931427002
Epoch: 7, Steps: 4 | Train Loss: 0.043 Vali Loss: 13.879 Vali Acc: 0.380 Test Loss: 13.879 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7098355293273926
Epoch: 8, Steps: 4 | Train Loss: 0.300 Vali Loss: 14.828 Vali Acc: 0.360 Test Loss: 14.828 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.709634780883789
Epoch: 9, Steps: 4 | Train Loss: 0.282 Vali Loss: 19.558 Vali Acc: 0.400 Test Loss: 19.558 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7288286685943604
Epoch: 10, Steps: 4 | Train Loss: 0.042 Vali Loss: 27.520 Vali Acc: 0.300 Test Loss: 27.520 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7150030136108398
Epoch: 11, Steps: 4 | Train Loss: 0.636 Vali Loss: 28.970 Vali Acc: 0.400 Test Loss: 28.970 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7151057720184326
Epoch: 12, Steps: 4 | Train Loss: 0.184 Vali Loss: 26.518 Vali Acc: 0.400 Test Loss: 26.518 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7046144008636475
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 19.759 Vali Acc: 0.400 Test Loss: 19.759 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1027802757
model size : 3923.40MB
2025-04-27 17:33:49.297976: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:33:49.316970: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775229.339192  717869 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775229.345944  717869 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:33:49.368545: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.627993106842041
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.543 Vali Acc: 0.260 Test Loss: 1.543 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.7753546237945557
Epoch: 2, Steps: 4 | Train Loss: 0.912 Vali Loss: 2.431 Vali Acc: 0.460 Test Loss: 2.431 Test Acc: 0.460
Validation loss decreased (-0.259985 --> -0.459976).  Saving model ...
Epoch: 3 cost time: 1.7732858657836914
Epoch: 3, Steps: 4 | Train Loss: 0.212 Vali Loss: 3.051 Vali Acc: 0.440 Test Loss: 3.051 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7282285690307617
Epoch: 4, Steps: 4 | Train Loss: 0.926 Vali Loss: 5.660 Vali Acc: 0.440 Test Loss: 5.660 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7136273384094238
Epoch: 5, Steps: 4 | Train Loss: 0.029 Vali Loss: 4.870 Vali Acc: 0.440 Test Loss: 4.870 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7096161842346191
Epoch: 6, Steps: 4 | Train Loss: 0.017 Vali Loss: 5.332 Vali Acc: 0.440 Test Loss: 5.332 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7380521297454834
Epoch: 7, Steps: 4 | Train Loss: 0.064 Vali Loss: 6.751 Vali Acc: 0.420 Test Loss: 6.751 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.720827579498291
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.420 Vali Acc: 0.420 Test Loss: 7.420 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7069509029388428
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.043 Vali Acc: 0.440 Test Loss: 8.043 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7252023220062256
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.576 Vali Acc: 0.520 Test Loss: 8.576 Test Acc: 0.520
Validation loss decreased (-0.459976 --> -0.519914).  Saving model ...
Epoch: 11 cost time: 1.7517030239105225
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.665 Vali Acc: 0.480 Test Loss: 8.665 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.739804744720459
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.100 Vali Acc: 0.480 Test Loss: 8.100 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.735334873199463
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.912 Vali Acc: 0.460 Test Loss: 7.912 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7204012870788574
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.580 Vali Acc: 0.500 Test Loss: 7.580 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7441139221191406
Epoch: 15, Steps: 4 | Train Loss: 0.461 Vali Loss: 7.614 Vali Acc: 0.440 Test Loss: 7.614 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7052905559539795
Epoch: 16, Steps: 4 | Train Loss: 0.027 Vali Loss: 9.077 Vali Acc: 0.460 Test Loss: 9.077 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7319931983947754
Epoch: 17, Steps: 4 | Train Loss: 0.100 Vali Loss: 7.129 Vali Acc: 0.460 Test Loss: 7.129 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7074153423309326
Epoch: 18, Steps: 4 | Train Loss: 0.045 Vali Loss: 11.404 Vali Acc: 0.460 Test Loss: 11.404 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7270269393920898
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.924 Vali Acc: 0.340 Test Loss: 16.924 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7126610279083252
Epoch: 20, Steps: 4 | Train Loss: 0.054 Vali Loss: 19.634 Vali Acc: 0.420 Test Loss: 19.634 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1025222149
model size : 3913.55MB
2025-04-27 17:35:59.453198: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:35:59.472957: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775359.495453  726990 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775359.502287  726990 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:35:59.524861: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.410353422164917
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.495 Vali Acc: 0.400 Test Loss: 1.495 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.5468997955322266
Epoch: 2, Steps: 4 | Train Loss: 5.471 Vali Loss: 6.481 Vali Acc: 0.440 Test Loss: 6.481 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439935).  Saving model ...
Epoch: 3 cost time: 1.5219531059265137
Epoch: 3, Steps: 4 | Train Loss: 0.483 Vali Loss: 23.525 Vali Acc: 0.440 Test Loss: 23.525 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4849307537078857
Epoch: 4, Steps: 4 | Train Loss: 2.210 Vali Loss: 21.750 Vali Acc: 0.400 Test Loss: 21.750 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4865565299987793
Epoch: 5, Steps: 4 | Train Loss: 0.242 Vali Loss: 21.321 Vali Acc: 0.340 Test Loss: 21.321 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.491666555404663
Epoch: 6, Steps: 4 | Train Loss: 2.481 Vali Loss: 22.170 Vali Acc: 0.400 Test Loss: 22.170 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.494624376296997
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 41.133 Vali Acc: 0.400 Test Loss: 41.133 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4826838970184326
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 64.547 Vali Acc: 0.400 Test Loss: 64.547 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4933903217315674
Epoch: 9, Steps: 4 | Train Loss: 0.577 Vali Loss: 77.061 Vali Acc: 0.420 Test Loss: 77.061 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4910008907318115
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 69.927 Vali Acc: 0.340 Test Loss: 69.927 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4865756034851074
Epoch: 11, Steps: 4 | Train Loss: 0.371 Vali Loss: 43.512 Vali Acc: 0.380 Test Loss: 43.512 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4831774234771729
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 41.258 Vali Acc: 0.380 Test Loss: 41.258 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 516394693
model size : 1971.22MB
2025-04-27 17:37:05.835915: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:37:05.854836: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775425.876705  732463 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775425.883396  732463 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:37:05.905899: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.333028554916382
Epoch: 1, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.563 Vali Acc: 0.320 Test Loss: 1.563 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.3389074802398682
Epoch: 2, Steps: 4 | Train Loss: 1.644 Vali Loss: 3.605 Vali Acc: 0.500 Test Loss: 3.605 Test Acc: 0.500
Validation loss decreased (-0.319984 --> -0.499964).  Saving model ...
Epoch: 3 cost time: 1.342630386352539
Epoch: 3, Steps: 4 | Train Loss: 1.500 Vali Loss: 5.067 Vali Acc: 0.440 Test Loss: 5.067 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3158323764801025
Epoch: 4, Steps: 4 | Train Loss: 0.030 Vali Loss: 9.963 Vali Acc: 0.460 Test Loss: 9.963 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.305171251296997
Epoch: 5, Steps: 4 | Train Loss: 0.365 Vali Loss: 9.203 Vali Acc: 0.520 Test Loss: 9.203 Test Acc: 0.520
Validation loss decreased (-0.499964 --> -0.519908).  Saving model ...
Epoch: 6 cost time: 1.3651995658874512
Epoch: 6, Steps: 4 | Train Loss: 0.001 Vali Loss: 11.006 Vali Acc: 0.460 Test Loss: 11.006 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3116028308868408
Epoch: 7, Steps: 4 | Train Loss: 0.323 Vali Loss: 15.998 Vali Acc: 0.440 Test Loss: 15.998 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3169386386871338
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 46.947 Vali Acc: 0.380 Test Loss: 46.947 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3260080814361572
Epoch: 9, Steps: 4 | Train Loss: 0.870 Vali Loss: 50.320 Vali Acc: 0.380 Test Loss: 50.320 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3185033798217773
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 45.725 Vali Acc: 0.480 Test Loss: 45.725 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3171391487121582
Epoch: 11, Steps: 4 | Train Loss: 0.112 Vali Loss: 25.568 Vali Acc: 0.420 Test Loss: 25.568 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3285021781921387
Epoch: 12, Steps: 4 | Train Loss: 0.090 Vali Loss: 29.708 Vali Acc: 0.460 Test Loss: 29.708 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3042411804199219
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.995 Vali Acc: 0.420 Test Loss: 29.995 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3255178928375244
Epoch: 14, Steps: 4 | Train Loss: 5.178 Vali Loss: 30.294 Vali Acc: 0.440 Test Loss: 30.294 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3193225860595703
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 26.232 Vali Acc: 0.480 Test Loss: 26.232 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 503913541
model size : 1923.61MB
2025-04-27 17:38:22.609948: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:38:22.629281: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775502.651481  739209 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775502.658348  739209 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:38:22.681183: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0407631397247314
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (inf --> -0.419985).  Saving model ...
Epoch: 2 cost time: 1.1954636573791504
Epoch: 2, Steps: 4 | Train Loss: 0.820 Vali Loss: 2.633 Vali Acc: 0.540 Test Loss: 2.633 Test Acc: 0.540
Validation loss decreased (-0.419985 --> -0.539974).  Saving model ...
Epoch: 3 cost time: 1.1988575458526611
Epoch: 3, Steps: 4 | Train Loss: 0.218 Vali Loss: 4.834 Vali Acc: 0.540 Test Loss: 4.834 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1560580730438232
Epoch: 4, Steps: 4 | Train Loss: 0.315 Vali Loss: 6.362 Vali Acc: 0.460 Test Loss: 6.362 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.135570764541626
Epoch: 5, Steps: 4 | Train Loss: 0.065 Vali Loss: 12.970 Vali Acc: 0.520 Test Loss: 12.970 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.167802333831787
Epoch: 6, Steps: 4 | Train Loss: 0.621 Vali Loss: 11.976 Vali Acc: 0.420 Test Loss: 11.976 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.139678716659546
Epoch: 7, Steps: 4 | Train Loss: 0.131 Vali Loss: 13.452 Vali Acc: 0.460 Test Loss: 13.452 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1824698448181152
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 19.666 Vali Acc: 0.440 Test Loss: 19.666 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1505651473999023
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 26.160 Vali Acc: 0.420 Test Loss: 26.160 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1518309116363525
Epoch: 10, Steps: 4 | Train Loss: 0.163 Vali Loss: 22.517 Vali Acc: 0.440 Test Loss: 22.517 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1395888328552246
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.465 Vali Acc: 0.400 Test Loss: 25.465 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1374926567077637
Epoch: 12, Steps: 4 | Train Loss: 0.080 Vali Loss: 26.479 Vali Acc: 0.400 Test Loss: 26.479 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 497888389
model size : 1900.62MB
2025-04-27 17:39:22.270257: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:39:22.289612: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775562.312249  744631 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775562.319063  744631 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:39:22.342035: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.992664098739624
Epoch: 1, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.534 Vali Acc: 0.260 Test Loss: 1.534 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.174304723739624
Epoch: 2, Steps: 4 | Train Loss: 0.917 Vali Loss: 1.874 Vali Acc: 0.480 Test Loss: 1.874 Test Acc: 0.480
Validation loss decreased (-0.259985 --> -0.479981).  Saving model ...
Epoch: 3 cost time: 1.1692264080047607
Epoch: 3, Steps: 4 | Train Loss: 0.386 Vali Loss: 3.965 Vali Acc: 0.480 Test Loss: 3.965 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1540021896362305
Epoch: 4, Steps: 4 | Train Loss: 0.552 Vali Loss: 4.204 Vali Acc: 0.460 Test Loss: 4.204 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1528167724609375
Epoch: 5, Steps: 4 | Train Loss: 0.036 Vali Loss: 10.101 Vali Acc: 0.440 Test Loss: 10.101 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1447124481201172
Epoch: 6, Steps: 4 | Train Loss: 0.203 Vali Loss: 15.954 Vali Acc: 0.420 Test Loss: 15.954 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1351351737976074
Epoch: 7, Steps: 4 | Train Loss: 0.001 Vali Loss: 18.638 Vali Acc: 0.480 Test Loss: 18.638 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1562886238098145
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 20.554 Vali Acc: 0.500 Test Loss: 20.554 Test Acc: 0.500
Validation loss decreased (-0.479981 --> -0.499794).  Saving model ...
Epoch: 9 cost time: 1.1950857639312744
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.201 Vali Acc: 0.500 Test Loss: 22.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1515846252441406
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.657 Vali Acc: 0.480 Test Loss: 21.657 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1424121856689453
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.608 Vali Acc: 0.480 Test Loss: 23.608 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1593365669250488
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.134 Vali Acc: 0.480 Test Loss: 25.134 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1658484935760498
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.649 Vali Acc: 0.460 Test Loss: 23.649 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1357266902923584
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.823 Vali Acc: 0.440 Test Loss: 24.823 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1349732875823975
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.884 Vali Acc: 0.440 Test Loss: 25.884 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.155811071395874
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.550 Vali Acc: 0.480 Test Loss: 23.550 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1684811115264893
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.473 Vali Acc: 0.480 Test Loss: 24.473 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1380350589752197
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.544 Vali Acc: 0.480 Test Loss: 25.544 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 495736773
model size : 1892.41MB
2025-04-27 17:40:44.310125: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:40:44.329968: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775644.353186  752626 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775644.360257  752626 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:40:44.384316: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.141258955001831
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.547 Vali Acc: 0.320 Test Loss: 1.547 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.162872076034546
Epoch: 2, Steps: 4 | Train Loss: 0.898 Vali Loss: 1.890 Vali Acc: 0.340 Test Loss: 1.890 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339981).  Saving model ...
Epoch: 3 cost time: 1.1679449081420898
Epoch: 3, Steps: 4 | Train Loss: 0.411 Vali Loss: 2.477 Vali Acc: 0.340 Test Loss: 2.477 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1624233722686768
Epoch: 4, Steps: 4 | Train Loss: 0.246 Vali Loss: 3.098 Vali Acc: 0.500 Test Loss: 3.098 Test Acc: 0.500
Validation loss decreased (-0.339981 --> -0.499969).  Saving model ...
Epoch: 5 cost time: 1.171776294708252
Epoch: 5, Steps: 4 | Train Loss: 0.123 Vali Loss: 3.276 Vali Acc: 0.440 Test Loss: 3.276 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1393659114837646
Epoch: 6, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.379 Vali Acc: 0.460 Test Loss: 3.379 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.140157699584961
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.035 Vali Acc: 0.480 Test Loss: 5.035 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.134401798248291
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.564 Vali Acc: 0.460 Test Loss: 7.564 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1305053234100342
Epoch: 9, Steps: 4 | Train Loss: 0.113 Vali Loss: 8.159 Vali Acc: 0.440 Test Loss: 8.159 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.168792724609375
Epoch: 10, Steps: 4 | Train Loss: 0.016 Vali Loss: 7.751 Vali Acc: 0.400 Test Loss: 7.751 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1231257915496826
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.598 Vali Acc: 0.300 Test Loss: 9.598 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1255271434783936
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 7.909 Vali Acc: 0.460 Test Loss: 7.909 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1183347702026367
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.239 Vali Acc: 0.420 Test Loss: 7.239 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1317193508148193
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.675 Vali Acc: 0.420 Test Loss: 7.675 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 492724869
model size : 1880.92MB
2025-04-27 17:41:53.996023: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:41:54.015355: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775714.037455  758920 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775714.044216  758920 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:41:54.066921: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9718875885009766
Epoch: 1, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.550 Vali Acc: 0.340 Test Loss: 1.550 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.1349678039550781
Epoch: 2, Steps: 4 | Train Loss: 1.222 Vali Loss: 2.220 Vali Acc: 0.300 Test Loss: 2.220 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1103813648223877
Epoch: 3, Steps: 4 | Train Loss: 0.354 Vali Loss: 2.333 Vali Acc: 0.480 Test Loss: 2.333 Test Acc: 0.480
Validation loss decreased (-0.339984 --> -0.479977).  Saving model ...
Epoch: 4 cost time: 1.1526293754577637
Epoch: 4, Steps: 4 | Train Loss: 0.115 Vali Loss: 4.201 Vali Acc: 0.460 Test Loss: 4.201 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0996768474578857
Epoch: 5, Steps: 4 | Train Loss: 0.072 Vali Loss: 4.233 Vali Acc: 0.400 Test Loss: 4.233 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0938236713409424
Epoch: 6, Steps: 4 | Train Loss: 0.027 Vali Loss: 4.854 Vali Acc: 0.500 Test Loss: 4.854 Test Acc: 0.500
Validation loss decreased (-0.479977 --> -0.499951).  Saving model ...
Epoch: 7 cost time: 1.1377296447753906
Epoch: 7, Steps: 4 | Train Loss: 0.229 Vali Loss: 5.713 Vali Acc: 0.440 Test Loss: 5.713 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1153264045715332
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.006 Vali Acc: 0.400 Test Loss: 5.006 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0999152660369873
Epoch: 9, Steps: 4 | Train Loss: 0.015 Vali Loss: 4.499 Vali Acc: 0.380 Test Loss: 4.499 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0937087535858154
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.030 Vali Acc: 0.440 Test Loss: 4.030 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.092423915863037
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.077 Vali Acc: 0.400 Test Loss: 4.077 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1130268573760986
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.616 Vali Acc: 0.400 Test Loss: 5.616 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1006600856781006
Epoch: 13, Steps: 4 | Train Loss: 0.028 Vali Loss: 5.919 Vali Acc: 0.400 Test Loss: 5.919 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0876891613006592
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.903 Vali Acc: 0.440 Test Loss: 5.903 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1114542484283447
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.112 Vali Acc: 0.460 Test Loss: 6.112 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0990123748779297
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.134 Vali Acc: 0.440 Test Loss: 6.134 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 491864901
model size : 1877.64MB
2025-04-27 17:43:07.152079: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:43:07.171424: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775787.193625  766049 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775787.200491  766049 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:43:07.223503: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9734086990356445
Epoch: 1, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.699 Vali Acc: 0.260 Test Loss: 1.699 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.1465821266174316
Epoch: 2, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.625 Vali Acc: 0.340 Test Loss: 1.625 Test Acc: 0.340
Validation loss decreased (-0.259983 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.140099287033081
Epoch: 3, Steps: 4 | Train Loss: 0.348 Vali Loss: 2.042 Vali Acc: 0.420 Test Loss: 2.042 Test Acc: 0.420
Validation loss decreased (-0.339984 --> -0.419980).  Saving model ...
Epoch: 4 cost time: 1.1486053466796875
Epoch: 4, Steps: 4 | Train Loss: 0.231 Vali Loss: 2.887 Vali Acc: 0.460 Test Loss: 2.887 Test Acc: 0.460
Validation loss decreased (-0.419980 --> -0.459971).  Saving model ...
Epoch: 5 cost time: 1.1547751426696777
Epoch: 5, Steps: 4 | Train Loss: 0.149 Vali Loss: 3.510 Vali Acc: 0.460 Test Loss: 3.510 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1345205307006836
Epoch: 6, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.620 Vali Acc: 0.500 Test Loss: 3.620 Test Acc: 0.500
Validation loss decreased (-0.459971 --> -0.499964).  Saving model ...
Epoch: 7 cost time: 1.141848087310791
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.681 Vali Acc: 0.520 Test Loss: 3.681 Test Acc: 0.520
Validation loss decreased (-0.499964 --> -0.519963).  Saving model ...
Epoch: 8 cost time: 1.1701405048370361
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.008 Vali Acc: 0.420 Test Loss: 4.008 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1074390411376953
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.460 Vali Acc: 0.400 Test Loss: 4.460 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1227149963378906
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.832 Vali Acc: 0.440 Test Loss: 4.832 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1047699451446533
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.183 Vali Acc: 0.480 Test Loss: 5.183 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1144368648529053
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.510 Vali Acc: 0.480 Test Loss: 5.510 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1156482696533203
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.988 Vali Acc: 0.320 Test Loss: 5.988 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1061789989471436
Epoch: 14, Steps: 4 | Train Loss: 0.050 Vali Loss: 6.024 Vali Acc: 0.440 Test Loss: 6.024 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1000480651855469
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.248 Vali Acc: 0.400 Test Loss: 9.248 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1075992584228516
Epoch: 16, Steps: 4 | Train Loss: 0.188 Vali Loss: 8.347 Vali Acc: 0.440 Test Loss: 8.347 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1301467418670654
Epoch: 17, Steps: 4 | Train Loss: 0.172 Vali Loss: 5.022 Vali Acc: 0.460 Test Loss: 5.022 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 490574597
model size : 1872.72MB
2025-04-27 17:44:36.629182: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:44:36.648502: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775876.670573  773692 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775876.677359  773692 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:44:36.700035: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.093733072280884
Epoch: 1, Steps: 4 | Train Loss: 1.528 Vali Loss: 1.506 Vali Acc: 0.340 Test Loss: 1.506 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.1853673458099365
Epoch: 2, Steps: 4 | Train Loss: 1.654 Vali Loss: 3.017 Vali Acc: 0.360 Test Loss: 3.017 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359970).  Saving model ...
Epoch: 3 cost time: 1.1611242294311523
Epoch: 3, Steps: 4 | Train Loss: 0.224 Vali Loss: 5.246 Vali Acc: 0.400 Test Loss: 5.246 Test Acc: 0.400
Validation loss decreased (-0.359970 --> -0.399948).  Saving model ...
Epoch: 4 cost time: 1.1373686790466309
Epoch: 4, Steps: 4 | Train Loss: 0.290 Vali Loss: 10.042 Vali Acc: 0.440 Test Loss: 10.042 Test Acc: 0.440
Validation loss decreased (-0.399948 --> -0.439900).  Saving model ...
Epoch: 5 cost time: 1.1591651439666748
Epoch: 5, Steps: 4 | Train Loss: 0.572 Vali Loss: 16.231 Vali Acc: 0.320 Test Loss: 16.231 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1379461288452148
Epoch: 6, Steps: 4 | Train Loss: 2.149 Vali Loss: 14.629 Vali Acc: 0.420 Test Loss: 14.629 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1329360008239746
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.361 Vali Acc: 0.480 Test Loss: 15.361 Test Acc: 0.480
Validation loss decreased (-0.439900 --> -0.479846).  Saving model ...
Epoch: 8 cost time: 1.1642282009124756
Epoch: 8, Steps: 4 | Train Loss: 0.839 Vali Loss: 15.512 Vali Acc: 0.400 Test Loss: 15.512 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1532886028289795
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.362 Vali Acc: 0.420 Test Loss: 16.362 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1399259567260742
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.965 Vali Acc: 0.360 Test Loss: 16.965 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1172997951507568
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 18.529 Vali Acc: 0.400 Test Loss: 18.529 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.113818645477295
Epoch: 12, Steps: 4 | Train Loss: 6.465 Vali Loss: 19.215 Vali Acc: 0.380 Test Loss: 19.215 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.105318307876587
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.756 Vali Acc: 0.420 Test Loss: 14.756 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1385910511016846
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.534 Vali Acc: 0.440 Test Loss: 12.534 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1175134181976318
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.290 Vali Acc: 0.460 Test Loss: 13.290 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1217775344848633
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.970 Vali Acc: 0.500 Test Loss: 13.970 Test Acc: 0.500
Validation loss decreased (-0.479846 --> -0.499860).  Saving model ...
Epoch: 17 cost time: 1.1672351360321045
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.680 Vali Acc: 0.480 Test Loss: 13.680 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1235988140106201
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.828 Vali Acc: 0.520 Test Loss: 13.828 Test Acc: 0.520
Validation loss decreased (-0.499860 --> -0.519862).  Saving model ...
Epoch: 19 cost time: 1.1689131259918213
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.960 Vali Acc: 0.540 Test Loss: 12.960 Test Acc: 0.540
Validation loss decreased (-0.519862 --> -0.539870).  Saving model ...
Epoch: 20 cost time: 1.1422245502471924
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.529 Vali Acc: 0.520 Test Loss: 13.529 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1391491889953613
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.932 Vali Acc: 0.540 Test Loss: 13.932 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1176726818084717
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.257 Vali Acc: 0.520 Test Loss: 13.257 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1208217144012451
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.782 Vali Acc: 0.440 Test Loss: 12.782 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.107158899307251
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.945 Vali Acc: 0.440 Test Loss: 12.945 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1108243465423584
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.688 Vali Acc: 0.420 Test Loss: 13.688 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.127342700958252
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.484 Vali Acc: 0.440 Test Loss: 14.484 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1110520362854004
Epoch: 27, Steps: 4 | Train Loss: 0.006 Vali Loss: 25.705 Vali Acc: 0.400 Test Loss: 25.705 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.113088607788086
Epoch: 28, Steps: 4 | Train Loss: 0.002 Vali Loss: 80.920 Vali Acc: 0.460 Test Loss: 80.920 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1086738109588623
Epoch: 29, Steps: 4 | Train Loss: 2.264 Vali Loss: 70.429 Vali Acc: 0.320 Test Loss: 70.429 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 252688229
model size : 964.60MB
2025-04-27 17:46:24.740999: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:46:24.761093: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745775984.783823  786282 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745775984.790749  786282 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:46:24.814747: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.990751028060913
Epoch: 1, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.569 Vali Acc: 0.300 Test Loss: 1.569 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.0607619285583496
Epoch: 2, Steps: 4 | Train Loss: 0.734 Vali Loss: 2.836 Vali Acc: 0.380 Test Loss: 2.836 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379972).  Saving model ...
Epoch: 3 cost time: 1.023057460784912
Epoch: 3, Steps: 4 | Train Loss: 0.918 Vali Loss: 2.746 Vali Acc: 0.320 Test Loss: 2.746 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0583994388580322
Epoch: 4, Steps: 4 | Train Loss: 0.062 Vali Loss: 4.877 Vali Acc: 0.440 Test Loss: 4.877 Test Acc: 0.440
Validation loss decreased (-0.379972 --> -0.439951).  Saving model ...
Epoch: 5 cost time: 1.0374879837036133
Epoch: 5, Steps: 4 | Train Loss: 0.104 Vali Loss: 6.808 Vali Acc: 0.420 Test Loss: 6.808 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0470118522644043
Epoch: 6, Steps: 4 | Train Loss: 0.004 Vali Loss: 10.403 Vali Acc: 0.340 Test Loss: 10.403 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0398519039154053
Epoch: 7, Steps: 4 | Train Loss: 0.014 Vali Loss: 12.224 Vali Acc: 0.460 Test Loss: 12.224 Test Acc: 0.460
Validation loss decreased (-0.439951 --> -0.459878).  Saving model ...
Epoch: 8 cost time: 1.0321218967437744
Epoch: 8, Steps: 4 | Train Loss: 0.016 Vali Loss: 11.914 Vali Acc: 0.380 Test Loss: 11.914 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0550565719604492
Epoch: 9, Steps: 4 | Train Loss: 0.470 Vali Loss: 11.555 Vali Acc: 0.380 Test Loss: 11.555 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.031529188156128
Epoch: 10, Steps: 4 | Train Loss: 0.008 Vali Loss: 17.499 Vali Acc: 0.440 Test Loss: 17.499 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0259950160980225
Epoch: 11, Steps: 4 | Train Loss: 0.589 Vali Loss: 17.705 Vali Acc: 0.440 Test Loss: 17.705 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.03029203414917
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.062 Vali Acc: 0.420 Test Loss: 12.062 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0316975116729736
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.307 Vali Acc: 0.400 Test Loss: 13.307 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0193755626678467
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.697 Vali Acc: 0.380 Test Loss: 14.697 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.041503667831421
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.991 Vali Acc: 0.400 Test Loss: 12.991 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0176372528076172
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.799 Vali Acc: 0.360 Test Loss: 14.799 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0255773067474365
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.214 Vali Acc: 0.380 Test Loss: 16.214 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 246447653
model size : 940.79MB
2025-04-27 17:47:30.030813: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:47:30.050509: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776050.072998  793758 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776050.079908  793758 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:47:30.102889: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8450558185577393
Epoch: 1, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.496 Vali Acc: 0.300 Test Loss: 1.496 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.9698183536529541
Epoch: 2, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.858 Vali Acc: 0.460 Test Loss: 1.858 Test Acc: 0.460
Validation loss decreased (-0.299985 --> -0.459981).  Saving model ...
Epoch: 3 cost time: 0.986149787902832
Epoch: 3, Steps: 4 | Train Loss: 0.217 Vali Loss: 5.301 Vali Acc: 0.460 Test Loss: 5.301 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9456846714019775
Epoch: 4, Steps: 4 | Train Loss: 0.149 Vali Loss: 5.400 Vali Acc: 0.500 Test Loss: 5.400 Test Acc: 0.500
Validation loss decreased (-0.459981 --> -0.499946).  Saving model ...
Epoch: 5 cost time: 0.937591552734375
Epoch: 5, Steps: 4 | Train Loss: 0.082 Vali Loss: 4.866 Vali Acc: 0.480 Test Loss: 4.866 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9444453716278076
Epoch: 6, Steps: 4 | Train Loss: 0.011 Vali Loss: 6.447 Vali Acc: 0.400 Test Loss: 6.447 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.994783639907837
Epoch: 7, Steps: 4 | Train Loss: 0.012 Vali Loss: 9.000 Vali Acc: 0.420 Test Loss: 9.000 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.927443265914917
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.323 Vali Acc: 0.380 Test Loss: 11.323 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.932199239730835
Epoch: 9, Steps: 4 | Train Loss: 0.082 Vali Loss: 9.989 Vali Acc: 0.420 Test Loss: 9.989 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9396810531616211
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.530 Vali Acc: 0.360 Test Loss: 9.530 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9272027015686035
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 10.201 Vali Acc: 0.380 Test Loss: 10.201 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9529402256011963
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 10.583 Vali Acc: 0.400 Test Loss: 10.583 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9497542381286621
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.617 Vali Acc: 0.400 Test Loss: 10.617 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9255800247192383
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.284 Vali Acc: 0.420 Test Loss: 11.284 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 243435077
model size : 929.30MB
2025-04-27 17:48:25.114930: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:48:25.134742: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776105.156908  799957 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776105.163914  799957 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:48:25.188351: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8051650524139404
Epoch: 1, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.427 Vali Acc: 0.320 Test Loss: 1.427 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 0.9770867824554443
Epoch: 2, Steps: 4 | Train Loss: 1.065 Vali Loss: 1.873 Vali Acc: 0.420 Test Loss: 1.873 Test Acc: 0.420
Validation loss decreased (-0.319986 --> -0.419981).  Saving model ...
Epoch: 3 cost time: 0.9470932483673096
Epoch: 3, Steps: 4 | Train Loss: 0.370 Vali Loss: 2.344 Vali Acc: 0.540 Test Loss: 2.344 Test Acc: 0.540
Validation loss decreased (-0.419981 --> -0.539977).  Saving model ...
Epoch: 4 cost time: 0.9284248352050781
Epoch: 4, Steps: 4 | Train Loss: 0.071 Vali Loss: 3.330 Vali Acc: 0.560 Test Loss: 3.330 Test Acc: 0.560
Validation loss decreased (-0.539977 --> -0.559967).  Saving model ...
Epoch: 5 cost time: 0.956911563873291
Epoch: 5, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.646 Vali Acc: 0.540 Test Loss: 4.646 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9665069580078125
Epoch: 6, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.502 Vali Acc: 0.480 Test Loss: 5.502 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9539539813995361
Epoch: 7, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.461 Vali Acc: 0.560 Test Loss: 6.461 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9420843124389648
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.081 Vali Acc: 0.560 Test Loss: 7.081 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9265382289886475
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.679 Vali Acc: 0.560 Test Loss: 7.679 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9307479858398438
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.179 Vali Acc: 0.580 Test Loss: 8.179 Test Acc: 0.580
Validation loss decreased (-0.559967 --> -0.579918).  Saving model ...
Epoch: 11 cost time: 0.9347612857818604
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.209 Vali Acc: 0.580 Test Loss: 8.209 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9004886150360107
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.512 Vali Acc: 0.580 Test Loss: 8.512 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9464199542999268
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.889 Vali Acc: 0.580 Test Loss: 7.889 Test Acc: 0.580
Validation loss decreased (-0.579918 --> -0.579921).  Saving model ...
Epoch: 14 cost time: 0.9617488384246826
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.267 Vali Acc: 0.560 Test Loss: 8.267 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9246401786804199
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.481 Vali Acc: 0.560 Test Loss: 8.481 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9457809925079346
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.759 Vali Acc: 0.520 Test Loss: 8.759 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9339580535888672
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.864 Vali Acc: 0.540 Test Loss: 8.864 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9306991100311279
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.463 Vali Acc: 0.560 Test Loss: 8.463 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9417431354522705
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.701 Vali Acc: 0.540 Test Loss: 8.701 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.937323808670044
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.748 Vali Acc: 0.540 Test Loss: 8.748 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9258084297180176
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.635 Vali Acc: 0.540 Test Loss: 8.635 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9499220848083496
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.870 Vali Acc: 0.540 Test Loss: 8.870 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9091684818267822
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.454 Vali Acc: 0.540 Test Loss: 8.454 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 242359269
model size : 925.20MB
2025-04-27 17:49:46.017265: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:49:46.037401: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776186.059560  809945 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776186.066338  809945 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:49:46.089418: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8153810501098633
Epoch: 1, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.740 Vali Acc: 0.300 Test Loss: 1.740 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.9486613273620605
Epoch: 2, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.580 Vali Acc: 0.400 Test Loss: 1.580 Test Acc: 0.400
Validation loss decreased (-0.299983 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.9324748516082764
Epoch: 3, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.692 Vali Acc: 0.460 Test Loss: 1.692 Test Acc: 0.460
Validation loss decreased (-0.399984 --> -0.459983).  Saving model ...
Epoch: 4 cost time: 0.9194352626800537
Epoch: 4, Steps: 4 | Train Loss: 0.231 Vali Loss: 2.594 Vali Acc: 0.480 Test Loss: 2.594 Test Acc: 0.480
Validation loss decreased (-0.459983 --> -0.479974).  Saving model ...
Epoch: 5 cost time: 0.929485559463501
Epoch: 5, Steps: 4 | Train Loss: 0.433 Vali Loss: 4.335 Vali Acc: 0.440 Test Loss: 4.335 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.900930643081665
Epoch: 6, Steps: 4 | Train Loss: 0.123 Vali Loss: 2.941 Vali Acc: 0.400 Test Loss: 2.941 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.920163631439209
Epoch: 7, Steps: 4 | Train Loss: 0.093 Vali Loss: 3.093 Vali Acc: 0.480 Test Loss: 3.093 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9284961223602295
Epoch: 8, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.946 Vali Acc: 0.420 Test Loss: 3.946 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9476447105407715
Epoch: 9, Steps: 4 | Train Loss: 0.019 Vali Loss: 4.805 Vali Acc: 0.320 Test Loss: 4.805 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9258270263671875
Epoch: 10, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.665 Vali Acc: 0.460 Test Loss: 4.665 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9084761142730713
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.856 Vali Acc: 0.460 Test Loss: 4.856 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9204568862915039
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.553 Vali Acc: 0.480 Test Loss: 5.553 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9296860694885254
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.073 Vali Acc: 0.480 Test Loss: 6.073 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9168965816497803
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.312 Vali Acc: 0.480 Test Loss: 6.312 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 240853317
model size : 919.45MB
2025-04-27 17:50:40.693823: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:50:40.713252: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776240.735800  816140 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776240.742689  816140 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:50:40.765581: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.797022819519043
Epoch: 1, Steps: 4 | Train Loss: 1.602 Vali Loss: 1.537 Vali Acc: 0.360 Test Loss: 1.537 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 0.9291298389434814
Epoch: 2, Steps: 4 | Train Loss: 1.046 Vali Loss: 1.573 Vali Acc: 0.400 Test Loss: 1.573 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.9227685928344727
Epoch: 3, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.688 Vali Acc: 0.420 Test Loss: 1.688 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419983).  Saving model ...
Epoch: 4 cost time: 0.9186110496520996
Epoch: 4, Steps: 4 | Train Loss: 0.202 Vali Loss: 2.326 Vali Acc: 0.500 Test Loss: 2.326 Test Acc: 0.500
Validation loss decreased (-0.419983 --> -0.499977).  Saving model ...
Epoch: 5 cost time: 0.9258341789245605
Epoch: 5, Steps: 4 | Train Loss: 0.135 Vali Loss: 2.467 Vali Acc: 0.500 Test Loss: 2.467 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9283404350280762
Epoch: 6, Steps: 4 | Train Loss: 0.021 Vali Loss: 3.093 Vali Acc: 0.560 Test Loss: 3.093 Test Acc: 0.560
Validation loss decreased (-0.499977 --> -0.559969).  Saving model ...
Epoch: 7 cost time: 0.9164347648620605
Epoch: 7, Steps: 4 | Train Loss: 0.042 Vali Loss: 3.299 Vali Acc: 0.560 Test Loss: 3.299 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9034817218780518
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.677 Vali Acc: 0.540 Test Loss: 3.677 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9019320011138916
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.929 Vali Acc: 0.580 Test Loss: 3.929 Test Acc: 0.580
Validation loss decreased (-0.559969 --> -0.579961).  Saving model ...
Epoch: 10 cost time: 0.9415762424468994
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.055 Vali Acc: 0.560 Test Loss: 4.055 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.925386905670166
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.904 Vali Acc: 0.560 Test Loss: 3.904 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9059844017028809
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.195 Vali Acc: 0.540 Test Loss: 4.195 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8856759071350098
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.782 Vali Acc: 0.500 Test Loss: 3.782 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9081015586853027
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.976 Vali Acc: 0.500 Test Loss: 3.976 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9181597232818604
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.147 Vali Acc: 0.500 Test Loss: 4.147 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9357948303222656
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.225 Vali Acc: 0.480 Test Loss: 4.225 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8985702991485596
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.355 Vali Acc: 0.500 Test Loss: 4.355 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8944168090820312
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.105 Vali Acc: 0.540 Test Loss: 4.105 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9053945541381836
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.335 Vali Acc: 0.380 Test Loss: 5.335 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 240423333
model size : 917.81MB
2025-04-27 17:51:51.378121: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:51:51.397166: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776311.419222  824457 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776311.426018  824457 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:51:51.448618: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8612115383148193
Epoch: 1, Steps: 4 | Train Loss: 1.634 Vali Loss: 1.515 Vali Acc: 0.280 Test Loss: 1.515 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 0.9200267791748047
Epoch: 2, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.513 Vali Acc: 0.340 Test Loss: 1.513 Test Acc: 0.340
Validation loss decreased (-0.279985 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 0.9310030937194824
Epoch: 3, Steps: 4 | Train Loss: 0.605 Vali Loss: 1.688 Vali Acc: 0.500 Test Loss: 1.688 Test Acc: 0.500
Validation loss decreased (-0.339985 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 0.9558115005493164
Epoch: 4, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.778 Vali Acc: 0.540 Test Loss: 1.778 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539982).  Saving model ...
Epoch: 5 cost time: 0.9228570461273193
Epoch: 5, Steps: 4 | Train Loss: 0.063 Vali Loss: 2.692 Vali Acc: 0.480 Test Loss: 2.692 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8968973159790039
Epoch: 6, Steps: 4 | Train Loss: 0.075 Vali Loss: 3.022 Vali Acc: 0.480 Test Loss: 3.022 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3347878456115723
Epoch: 7, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.402 Vali Acc: 0.580 Test Loss: 2.402 Test Acc: 0.580
Validation loss decreased (-0.539982 --> -0.579976).  Saving model ...
Epoch: 8 cost time: 0.9303133487701416
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.168 Vali Acc: 0.520 Test Loss: 2.168 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5664558410644531
Epoch: 9, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.310 Vali Acc: 0.500 Test Loss: 2.310 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8861246109008789
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.613 Vali Acc: 0.460 Test Loss: 2.613 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9199590682983398
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.889 Vali Acc: 0.460 Test Loss: 2.889 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.924863338470459
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.021 Vali Acc: 0.420 Test Loss: 3.021 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9167160987854004
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.978 Vali Acc: 0.440 Test Loss: 2.978 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.929893970489502
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.079 Vali Acc: 0.440 Test Loss: 3.079 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9292981624603271
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.013 Vali Acc: 0.420 Test Loss: 3.013 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8994903564453125
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.186 Vali Acc: 0.480 Test Loss: 3.186 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8767189979553223
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.285 Vali Acc: 0.500 Test Loss: 3.285 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 239778181
model size : 915.35MB
2025-04-27 17:52:56.923232: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:52:56.942366: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776376.964297  831928 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776376.971018  831928 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:52:56.994045: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1373658180236816
Epoch: 1, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.582 Vali Acc: 0.280 Test Loss: 1.582 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 2.202205181121826
Epoch: 2, Steps: 4 | Train Loss: 0.980 Vali Loss: 1.624 Vali Acc: 0.420 Test Loss: 1.624 Test Acc: 0.420
Validation loss decreased (-0.279984 --> -0.419984).  Saving model ...
Epoch: 3 cost time: 2.191725254058838
Epoch: 3, Steps: 4 | Train Loss: 0.226 Vali Loss: 3.062 Vali Acc: 0.400 Test Loss: 3.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1497271060943604
Epoch: 4, Steps: 4 | Train Loss: 0.169 Vali Loss: 5.247 Vali Acc: 0.340 Test Loss: 5.247 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.157907485961914
Epoch: 5, Steps: 4 | Train Loss: 0.148 Vali Loss: 6.197 Vali Acc: 0.460 Test Loss: 6.197 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459938).  Saving model ...
Epoch: 6 cost time: 2.193834066390991
Epoch: 6, Steps: 4 | Train Loss: 0.031 Vali Loss: 7.740 Vali Acc: 0.380 Test Loss: 7.740 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1575396060943604
Epoch: 7, Steps: 4 | Train Loss: 0.017 Vali Loss: 7.678 Vali Acc: 0.460 Test Loss: 7.678 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1539440155029297
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.192 Vali Acc: 0.440 Test Loss: 8.192 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.144759178161621
Epoch: 9, Steps: 4 | Train Loss: 0.031 Vali Loss: 8.499 Vali Acc: 0.420 Test Loss: 8.499 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.172480583190918
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.847 Vali Acc: 0.460 Test Loss: 8.847 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1644504070281982
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.953 Vali Acc: 0.480 Test Loss: 8.953 Test Acc: 0.480
Validation loss decreased (-0.459938 --> -0.479910).  Saving model ...
Epoch: 12 cost time: 2.1766550540924072
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.214 Vali Acc: 0.480 Test Loss: 9.214 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1491289138793945
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.629 Vali Acc: 0.480 Test Loss: 9.629 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1531810760498047
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.510 Vali Acc: 0.500 Test Loss: 9.510 Test Acc: 0.500
Validation loss decreased (-0.479910 --> -0.499905).  Saving model ...
Epoch: 15 cost time: 2.1918721199035645
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.610 Vali Acc: 0.480 Test Loss: 8.610 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1586623191833496
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.073 Vali Acc: 0.500 Test Loss: 9.073 Test Acc: 0.500
Validation loss decreased (-0.499905 --> -0.499909).  Saving model ...
Epoch: 17 cost time: 2.172550678253174
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.762 Vali Acc: 0.460 Test Loss: 8.762 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1395068168640137
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.432 Vali Acc: 0.440 Test Loss: 9.432 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.147531270980835
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.579 Vali Acc: 0.460 Test Loss: 9.579 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1399521827697754
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.025 Vali Acc: 0.480 Test Loss: 9.025 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1385498046875
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.485 Vali Acc: 0.500 Test Loss: 9.485 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1405017375946045
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.440 Vali Acc: 0.500 Test Loss: 9.440 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1485140323638916
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.829 Vali Acc: 0.500 Test Loss: 9.829 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.13417387008667
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.648 Vali Acc: 0.460 Test Loss: 9.648 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1609256267547607
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.047 Vali Acc: 0.480 Test Loss: 9.047 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1683881282806396
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.327 Vali Acc: 0.500 Test Loss: 9.327 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 890777477
model size : 3402.68MB
2025-04-27 17:56:01.905358: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:56:01.924539: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776561.946585  843847 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776561.953412  843847 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:56:01.976138: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.012514114379883
Epoch: 1, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.560 Vali Acc: 0.340 Test Loss: 1.560 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.9670178890228271
Epoch: 2, Steps: 4 | Train Loss: 1.285 Vali Loss: 1.627 Vali Acc: 0.320 Test Loss: 1.627 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9499099254608154
Epoch: 3, Steps: 4 | Train Loss: 0.340 Vali Loss: 2.025 Vali Acc: 0.420 Test Loss: 2.025 Test Acc: 0.420
Validation loss decreased (-0.339984 --> -0.419980).  Saving model ...
Epoch: 4 cost time: 1.9975402355194092
Epoch: 4, Steps: 4 | Train Loss: 0.117 Vali Loss: 3.134 Vali Acc: 0.480 Test Loss: 3.134 Test Acc: 0.480
Validation loss decreased (-0.419980 --> -0.479969).  Saving model ...
Epoch: 5 cost time: 1.9769847393035889
Epoch: 5, Steps: 4 | Train Loss: 0.037 Vali Loss: 3.456 Vali Acc: 0.460 Test Loss: 3.456 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9421238899230957
Epoch: 6, Steps: 4 | Train Loss: 0.476 Vali Loss: 4.364 Vali Acc: 0.500 Test Loss: 4.364 Test Acc: 0.500
Validation loss decreased (-0.479969 --> -0.499956).  Saving model ...
Epoch: 7 cost time: 1.9816906452178955
Epoch: 7, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.643 Vali Acc: 0.460 Test Loss: 7.643 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.941382884979248
Epoch: 8, Steps: 4 | Train Loss: 0.229 Vali Loss: 8.652 Vali Acc: 0.480 Test Loss: 8.652 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9411251544952393
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.557 Vali Acc: 0.420 Test Loss: 8.557 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9484632015228271
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.918 Vali Acc: 0.400 Test Loss: 8.918 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9334111213684082
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 7.852 Vali Acc: 0.480 Test Loss: 7.852 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.927497386932373
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.930 Vali Acc: 0.480 Test Loss: 7.930 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9540188312530518
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.424 Vali Acc: 0.460 Test Loss: 8.424 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9539315700531006
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 7.350 Vali Acc: 0.420 Test Loss: 7.350 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9292755126953125
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.689 Vali Acc: 0.380 Test Loss: 5.689 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.950174331665039
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.037 Vali Acc: 0.380 Test Loss: 5.037 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 884752101
model size : 3379.70MB
2025-04-27 17:57:57.846023: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:57:57.865180: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776677.887128  851268 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776677.893806  851268 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:57:57.916545: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.89153790473938
Epoch: 1, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.578 Vali Acc: 0.220 Test Loss: 1.578 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9040446281433105
Epoch: 2, Steps: 4 | Train Loss: 1.203 Vali Loss: 1.662 Vali Acc: 0.360 Test Loss: 1.662 Test Acc: 0.360
Validation loss decreased (-0.219984 --> -0.359983).  Saving model ...
Epoch: 3 cost time: 1.909538745880127
Epoch: 3, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.768 Vali Acc: 0.460 Test Loss: 1.768 Test Acc: 0.460
Validation loss decreased (-0.359983 --> -0.459982).  Saving model ...
Epoch: 4 cost time: 1.9743666648864746
Epoch: 4, Steps: 4 | Train Loss: 0.127 Vali Loss: 2.502 Vali Acc: 0.520 Test Loss: 2.502 Test Acc: 0.520
Validation loss decreased (-0.459982 --> -0.519975).  Saving model ...
Epoch: 5 cost time: 1.9443473815917969
Epoch: 5, Steps: 4 | Train Loss: 0.027 Vali Loss: 3.321 Vali Acc: 0.520 Test Loss: 3.321 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8630690574645996
Epoch: 6, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.317 Vali Acc: 0.460 Test Loss: 3.317 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.876624584197998
Epoch: 7, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.765 Vali Acc: 0.460 Test Loss: 3.765 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.873805046081543
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.265 Vali Acc: 0.480 Test Loss: 4.265 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9053926467895508
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.694 Vali Acc: 0.480 Test Loss: 4.694 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8814067840576172
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.149 Vali Acc: 0.480 Test Loss: 5.149 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8682072162628174
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.607 Vali Acc: 0.520 Test Loss: 5.607 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9021902084350586
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.822 Vali Acc: 0.520 Test Loss: 5.822 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8707139492034912
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.560 Vali Acc: 0.520 Test Loss: 5.560 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8914687633514404
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.330 Vali Acc: 0.500 Test Loss: 5.330 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 881309125
model size : 3366.56MB
2025-04-27 17:59:48.431360: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 17:59:48.451485: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776788.473965  857855 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776788.480782  857855 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 17:59:48.503623: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9098265171051025
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.605 Vali Acc: 0.300 Test Loss: 1.605 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.926485300064087
Epoch: 2, Steps: 4 | Train Loss: 1.113 Vali Loss: 1.512 Vali Acc: 0.380 Test Loss: 1.512 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.9259192943572998
Epoch: 3, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.552 Vali Acc: 0.400 Test Loss: 1.552 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 1.9287035465240479
Epoch: 4, Steps: 4 | Train Loss: 0.163 Vali Loss: 2.305 Vali Acc: 0.440 Test Loss: 2.305 Test Acc: 0.440
Validation loss decreased (-0.399984 --> -0.439977).  Saving model ...
Epoch: 5 cost time: 1.9159700870513916
Epoch: 5, Steps: 4 | Train Loss: 0.144 Vali Loss: 2.435 Vali Acc: 0.460 Test Loss: 2.435 Test Acc: 0.460
Validation loss decreased (-0.439977 --> -0.459976).  Saving model ...
Epoch: 6 cost time: 1.9295856952667236
Epoch: 6, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.271 Vali Acc: 0.520 Test Loss: 2.271 Test Acc: 0.520
Validation loss decreased (-0.459976 --> -0.519977).  Saving model ...
Epoch: 7 cost time: 1.9385502338409424
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.772 Vali Acc: 0.500 Test Loss: 2.772 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8857102394104004
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.085 Vali Acc: 0.500 Test Loss: 3.085 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8755214214324951
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.424 Vali Acc: 0.580 Test Loss: 3.424 Test Acc: 0.580
Validation loss decreased (-0.519977 --> -0.579966).  Saving model ...
Epoch: 10 cost time: 1.962817907333374
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.813 Vali Acc: 0.540 Test Loss: 3.813 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8765807151794434
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.212 Vali Acc: 0.480 Test Loss: 4.212 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8757164478302002
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.854 Vali Acc: 0.440 Test Loss: 3.854 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.914137840270996
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.187 Vali Acc: 0.520 Test Loss: 4.187 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8771653175354004
Epoch: 14, Steps: 4 | Train Loss: 0.341 Vali Loss: 3.953 Vali Acc: 0.460 Test Loss: 3.953 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8711392879486084
Epoch: 15, Steps: 4 | Train Loss: 0.246 Vali Loss: 4.069 Vali Acc: 0.380 Test Loss: 4.069 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.878091812133789
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.917 Vali Acc: 0.320 Test Loss: 4.917 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9052367210388184
Epoch: 17, Steps: 4 | Train Loss: 0.070 Vali Loss: 5.316 Vali Acc: 0.320 Test Loss: 5.316 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.873685598373413
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.630 Vali Acc: 0.420 Test Loss: 7.630 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.867321491241455
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.265 Vali Acc: 0.380 Test Loss: 11.265 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 880448517
model size : 3363.28MB
2025-04-27 18:02:19.560638: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:02:19.579564: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745776939.601866  866732 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745776939.608595  866732 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:02:19.631627: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8890187740325928
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.590 Vali Acc: 0.260 Test Loss: 1.590 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.8664419651031494
Epoch: 2, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.425 Vali Acc: 0.380 Test Loss: 1.425 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 1.8575701713562012
Epoch: 3, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.462 Vali Acc: 0.440 Test Loss: 1.462 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 1.8523118495941162
Epoch: 4, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.644 Vali Acc: 0.500 Test Loss: 1.644 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 1.8917698860168457
Epoch: 5, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.715 Vali Acc: 0.540 Test Loss: 1.715 Test Acc: 0.540
Validation loss decreased (-0.499984 --> -0.539983).  Saving model ...
Epoch: 6 cost time: 1.8744425773620605
Epoch: 6, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.114 Vali Acc: 0.560 Test Loss: 2.114 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559979).  Saving model ...
Epoch: 7 cost time: 1.865835189819336
Epoch: 7, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.237 Vali Acc: 0.540 Test Loss: 2.237 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.833292007446289
Epoch: 8, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.518 Vali Acc: 0.520 Test Loss: 2.518 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8266351222991943
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.018 Vali Acc: 0.520 Test Loss: 3.018 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8291993141174316
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.469 Vali Acc: 0.480 Test Loss: 3.469 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8253567218780518
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.696 Vali Acc: 0.480 Test Loss: 3.696 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.815992832183838
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.531 Vali Acc: 0.480 Test Loss: 3.531 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8207976818084717
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.112 Vali Acc: 0.580 Test Loss: 3.112 Test Acc: 0.580
Validation loss decreased (-0.559979 --> -0.579969).  Saving model ...
Epoch: 14 cost time: 1.8465845584869385
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.004 Vali Acc: 0.520 Test Loss: 3.004 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8368580341339111
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.064 Vali Acc: 0.580 Test Loss: 3.064 Test Acc: 0.580
Validation loss decreased (-0.579969 --> -0.579969).  Saving model ...
Epoch: 16 cost time: 1.8868651390075684
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.311 Vali Acc: 0.540 Test Loss: 3.311 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8458428382873535
Epoch: 17, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.007 Vali Acc: 0.560 Test Loss: 3.007 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8378019332885742
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.263 Vali Acc: 0.380 Test Loss: 4.263 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8220884799957275
Epoch: 19, Steps: 4 | Train Loss: 0.034 Vali Loss: 5.377 Vali Acc: 0.580 Test Loss: 5.377 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8173940181732178
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 9.747 Vali Acc: 0.460 Test Loss: 9.747 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8373186588287354
Epoch: 21, Steps: 4 | Train Loss: 0.227 Vali Loss: 5.763 Vali Acc: 0.500 Test Loss: 5.763 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.827622652053833
Epoch: 22, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.347 Vali Acc: 0.500 Test Loss: 5.347 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8335115909576416
Epoch: 23, Steps: 4 | Train Loss: 0.013 Vali Loss: 6.462 Vali Acc: 0.420 Test Loss: 6.462 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.837501049041748
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.573 Vali Acc: 0.420 Test Loss: 5.573 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8420627117156982
Epoch: 25, Steps: 4 | Train Loss: 0.209 Vali Loss: 4.904 Vali Acc: 0.520 Test Loss: 4.904 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 878727365
model size : 3356.71MB
2025-04-27 18:05:23.011595: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:05:23.030924: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745777123.053221  878249 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745777123.060053  878249 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:05:23.082755: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.867295503616333
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.622 Vali Acc: 0.220 Test Loss: 1.622 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.8708055019378662
Epoch: 2, Steps: 4 | Train Loss: 1.247 Vali Loss: 1.441 Vali Acc: 0.320 Test Loss: 1.441 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319986).  Saving model ...
Epoch: 3 cost time: 1.8398454189300537
Epoch: 3, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.413 Vali Acc: 0.440 Test Loss: 1.413 Test Acc: 0.440
Validation loss decreased (-0.319986 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 1.8752856254577637
Epoch: 4, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.520 Vali Acc: 0.400 Test Loss: 1.520 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3356659412384033
Epoch: 5, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.823 Vali Acc: 0.440 Test Loss: 1.823 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8077964782714844
Epoch: 6, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.112 Vali Acc: 0.500 Test Loss: 2.112 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499979).  Saving model ...
Epoch: 7 cost time: 1.8282854557037354
Epoch: 7, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.423 Vali Acc: 0.540 Test Loss: 2.423 Test Acc: 0.540
Validation loss decreased (-0.499979 --> -0.539976).  Saving model ...
Epoch: 8 cost time: 1.8326141834259033
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.894 Vali Acc: 0.440 Test Loss: 2.894 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8136670589447021
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.420 Vali Acc: 0.440 Test Loss: 3.420 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8276546001434326
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.752 Vali Acc: 0.440 Test Loss: 3.752 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8258516788482666
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.974 Vali Acc: 0.440 Test Loss: 3.974 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.806612253189087
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.032 Vali Acc: 0.400 Test Loss: 4.032 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8432526588439941
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.974 Vali Acc: 0.460 Test Loss: 3.974 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.80800199508667
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.909 Vali Acc: 0.480 Test Loss: 3.909 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8233952522277832
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.921 Vali Acc: 0.520 Test Loss: 3.921 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8209760189056396
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.933 Vali Acc: 0.520 Test Loss: 3.933 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8067166805267334
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.003 Vali Acc: 0.500 Test Loss: 4.003 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 878727781
model size : 3356.72MB
2025-04-27 18:07:28.947554: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:07:28.967293: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745777248.990195  886144 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745777248.997198  886144 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:07:29.020145: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.746124505996704
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.593 Vali Acc: 0.280 Test Loss: 1.593 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.7469050884246826
Epoch: 2, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.462 Vali Acc: 0.340 Test Loss: 1.462 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.7532968521118164
Epoch: 3, Steps: 4 | Train Loss: 0.692 Vali Loss: 1.529 Vali Acc: 0.400 Test Loss: 1.529 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.7518351078033447
Epoch: 4, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.619 Vali Acc: 0.500 Test Loss: 1.619 Test Acc: 0.500
Validation loss decreased (-0.399985 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 1.745018482208252
Epoch: 5, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.804 Vali Acc: 0.560 Test Loss: 1.804 Test Acc: 0.560
Validation loss decreased (-0.499984 --> -0.559982).  Saving model ...
Epoch: 6 cost time: 1.7655329704284668
Epoch: 6, Steps: 4 | Train Loss: 0.057 Vali Loss: 2.157 Vali Acc: 0.600 Test Loss: 2.157 Test Acc: 0.600
Validation loss decreased (-0.559982 --> -0.599978).  Saving model ...
Epoch: 7 cost time: 1.7400290966033936
Epoch: 7, Steps: 4 | Train Loss: 0.159 Vali Loss: 2.506 Vali Acc: 0.580 Test Loss: 2.506 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7243719100952148
Epoch: 8, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.729 Vali Acc: 0.580 Test Loss: 2.729 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7036709785461426
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.662 Vali Acc: 0.560 Test Loss: 2.662 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7076530456542969
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.648 Vali Acc: 0.560 Test Loss: 2.648 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.693610668182373
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.500 Vali Acc: 0.560 Test Loss: 2.500 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6864080429077148
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.511 Vali Acc: 0.540 Test Loss: 2.511 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7233302593231201
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.681 Vali Acc: 0.560 Test Loss: 2.681 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7218997478485107
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.900 Vali Acc: 0.540 Test Loss: 2.900 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7104442119598389
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.891 Vali Acc: 0.540 Test Loss: 2.891 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7004270553588867
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.062 Vali Acc: 0.540 Test Loss: 3.062 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 877867429
model size : 3353.43MB
2025-04-27 18:09:38.642960: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:09:38.661925: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745777378.685317  893655 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745777378.691990  893655 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:09:38.714331: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.053926944732666
Epoch: 1, Steps: 4 | Train Loss: 1.511 Vali Loss: 1.583 Vali Acc: 0.320 Test Loss: 1.583 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 2.1487154960632324
Epoch: 2, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.792 Vali Acc: 0.260 Test Loss: 1.792 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.126826763153076
Epoch: 3, Steps: 4 | Train Loss: 0.300 Vali Loss: 2.737 Vali Acc: 0.320 Test Loss: 2.737 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0860795974731445
Epoch: 4, Steps: 4 | Train Loss: 0.630 Vali Loss: 3.771 Vali Acc: 0.400 Test Loss: 3.771 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399962).  Saving model ...
Epoch: 5 cost time: 2.1606297492980957
Epoch: 5, Steps: 4 | Train Loss: 0.122 Vali Loss: 4.280 Vali Acc: 0.460 Test Loss: 4.280 Test Acc: 0.460
Validation loss decreased (-0.399962 --> -0.459957).  Saving model ...
Epoch: 6 cost time: 2.1475813388824463
Epoch: 6, Steps: 4 | Train Loss: 0.072 Vali Loss: 6.736 Vali Acc: 0.480 Test Loss: 6.736 Test Acc: 0.480
Validation loss decreased (-0.459957 --> -0.479933).  Saving model ...
Epoch: 7 cost time: 2.1499056816101074
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 9.922 Vali Acc: 0.440 Test Loss: 9.922 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.112086296081543
Epoch: 8, Steps: 4 | Train Loss: 0.016 Vali Loss: 9.784 Vali Acc: 0.440 Test Loss: 9.784 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1093099117279053
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.460 Vali Acc: 0.460 Test Loss: 9.460 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1008849143981934
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.455 Vali Acc: 0.480 Test Loss: 9.455 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1297640800476074
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.877 Vali Acc: 0.480 Test Loss: 8.877 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.102200984954834
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.778 Vali Acc: 0.500 Test Loss: 8.778 Test Acc: 0.500
Validation loss decreased (-0.479933 --> -0.499912).  Saving model ...
Epoch: 13 cost time: 2.142143487930298
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.895 Vali Acc: 0.500 Test Loss: 8.895 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.102778673171997
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.728 Vali Acc: 0.460 Test Loss: 7.728 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0979385375976562
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.228 Vali Acc: 0.480 Test Loss: 8.228 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.096233606338501
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.659 Vali Acc: 0.480 Test Loss: 8.659 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0812416076660156
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.125 Vali Acc: 0.440 Test Loss: 8.125 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1557366847991943
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.687 Vali Acc: 0.440 Test Loss: 8.687 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0828914642333984
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.737 Vali Acc: 0.440 Test Loss: 8.737 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1040802001953125
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.900 Vali Acc: 0.440 Test Loss: 8.900 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.134653091430664
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.150 Vali Acc: 0.440 Test Loss: 9.150 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.092405080795288
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.499 Vali Acc: 0.440 Test Loss: 9.499 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 889572357
model size : 3398.08MB
2025-04-27 18:12:17.123833: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:12:17.143723: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745777537.166346  903785 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745777537.173268  903785 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:12:17.196388: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8699796199798584
Epoch: 1, Steps: 4 | Train Loss: 1.517 Vali Loss: 1.559 Vali Acc: 0.260 Test Loss: 1.559 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.9433999061584473
Epoch: 2, Steps: 4 | Train Loss: 1.535 Vali Loss: 1.699 Vali Acc: 0.320 Test Loss: 1.699 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 1.9370801448822021
Epoch: 3, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.718 Vali Acc: 0.340 Test Loss: 1.718 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339983).  Saving model ...
Epoch: 4 cost time: 1.9562716484069824
Epoch: 4, Steps: 4 | Train Loss: 0.371 Vali Loss: 4.280 Vali Acc: 0.420 Test Loss: 4.280 Test Acc: 0.420
Validation loss decreased (-0.339983 --> -0.419957).  Saving model ...
Epoch: 5 cost time: 1.9371159076690674
Epoch: 5, Steps: 4 | Train Loss: 0.277 Vali Loss: 6.887 Vali Acc: 0.280 Test Loss: 6.887 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4381775856018066
Epoch: 6, Steps: 4 | Train Loss: 0.333 Vali Loss: 4.350 Vali Acc: 0.500 Test Loss: 4.350 Test Acc: 0.500
Validation loss decreased (-0.419957 --> -0.499956).  Saving model ...
Epoch: 7 cost time: 1.9650404453277588
Epoch: 7, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.366 Vali Acc: 0.460 Test Loss: 4.366 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9077656269073486
Epoch: 8, Steps: 4 | Train Loss: 0.018 Vali Loss: 4.531 Vali Acc: 0.460 Test Loss: 4.531 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8981103897094727
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.918 Vali Acc: 0.460 Test Loss: 4.918 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.923349142074585
Epoch: 10, Steps: 4 | Train Loss: 0.179 Vali Loss: 5.444 Vali Acc: 0.460 Test Loss: 5.444 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9254705905914307
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.893 Vali Acc: 0.420 Test Loss: 5.893 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9308879375457764
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.563 Vali Acc: 0.460 Test Loss: 5.563 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8896028995513916
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.298 Vali Acc: 0.520 Test Loss: 5.298 Test Acc: 0.520
Validation loss decreased (-0.499956 --> -0.519947).  Saving model ...
Epoch: 14 cost time: 1.9624381065368652
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.727 Vali Acc: 0.460 Test Loss: 4.727 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9132606983184814
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.866 Vali Acc: 0.500 Test Loss: 4.866 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9216485023498535
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.025 Vali Acc: 0.480 Test Loss: 5.025 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9231576919555664
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.003 Vali Acc: 0.400 Test Loss: 5.003 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9324569702148438
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.854 Vali Acc: 0.480 Test Loss: 4.854 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9029240608215332
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.998 Vali Acc: 0.500 Test Loss: 4.998 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9384963512420654
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.715 Vali Acc: 0.500 Test Loss: 4.715 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9075534343719482
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.793 Vali Acc: 0.480 Test Loss: 4.793 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.933030605316162
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.009 Vali Acc: 0.460 Test Loss: 5.009 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9381814002990723
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.689 Vali Acc: 0.500 Test Loss: 4.689 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 883546981
model size : 3375.10MB
2025-04-27 18:14:57.835449: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:14:57.854705: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745777697.876897  914331 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745777697.883693  914331 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:14:57.906358: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.870248794555664
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.594 Vali Acc: 0.300 Test Loss: 1.594 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.9247357845306396
Epoch: 2, Steps: 4 | Train Loss: 0.992 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 1.9034135341644287
Epoch: 3, Steps: 4 | Train Loss: 0.361 Vali Loss: 1.742 Vali Acc: 0.400 Test Loss: 1.742 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 1.9114556312561035
Epoch: 4, Steps: 4 | Train Loss: 0.168 Vali Loss: 2.070 Vali Acc: 0.500 Test Loss: 2.070 Test Acc: 0.500
Validation loss decreased (-0.399983 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 1.9564111232757568
Epoch: 5, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.580 Vali Acc: 0.480 Test Loss: 2.580 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.871530532836914
Epoch: 6, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.974 Vali Acc: 0.580 Test Loss: 2.974 Test Acc: 0.580
Validation loss decreased (-0.499979 --> -0.579970).  Saving model ...
Epoch: 7 cost time: 1.9215819835662842
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.516 Vali Acc: 0.500 Test Loss: 3.516 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8461883068084717
Epoch: 8, Steps: 4 | Train Loss: 0.017 Vali Loss: 3.812 Vali Acc: 0.540 Test Loss: 3.812 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8476462364196777
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.477 Vali Acc: 0.460 Test Loss: 4.477 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8592698574066162
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.155 Vali Acc: 0.440 Test Loss: 5.155 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8635036945343018
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.387 Vali Acc: 0.420 Test Loss: 5.387 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.854745626449585
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.802 Vali Acc: 0.460 Test Loss: 4.802 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8597948551177979
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.585 Vali Acc: 0.440 Test Loss: 4.585 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8529973030090332
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.720 Vali Acc: 0.400 Test Loss: 4.720 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.855353593826294
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.715 Vali Acc: 0.460 Test Loss: 4.715 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8575148582458496
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.069 Vali Acc: 0.500 Test Loss: 5.069 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 880104005
model size : 3361.97MB
2025-04-27 18:17:06.012177: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:17:06.032638: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745777826.055281  921848 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745777826.062222  921848 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:17:06.085918: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.785977602005005
Epoch: 1, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.621 Vali Acc: 0.300 Test Loss: 1.621 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.694762945175171
Epoch: 2, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.543 Vali Acc: 0.240 Test Loss: 1.543 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.851452112197876
Epoch: 3, Steps: 4 | Train Loss: 0.461 Vali Loss: 1.552 Vali Acc: 0.480 Test Loss: 1.552 Test Acc: 0.480
Validation loss decreased (-0.299984 --> -0.479984).  Saving model ...
Epoch: 4 cost time: 1.8795528411865234
Epoch: 4, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.919 Vali Acc: 0.540 Test Loss: 1.919 Test Acc: 0.540
Validation loss decreased (-0.479984 --> -0.539981).  Saving model ...
Epoch: 5 cost time: 1.886289358139038
Epoch: 5, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.184 Vali Acc: 0.480 Test Loss: 2.184 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.833428144454956
Epoch: 6, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.812 Vali Acc: 0.500 Test Loss: 2.812 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8457674980163574
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.489 Vali Acc: 0.500 Test Loss: 3.489 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8881921768188477
Epoch: 8, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.808 Vali Acc: 0.500 Test Loss: 3.808 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8385953903198242
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.237 Vali Acc: 0.500 Test Loss: 4.237 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8405592441558838
Epoch: 10, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.282 Vali Acc: 0.540 Test Loss: 4.282 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.855841875076294
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.831 Vali Acc: 0.480 Test Loss: 4.831 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8354790210723877
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.823 Vali Acc: 0.520 Test Loss: 4.823 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.850611686706543
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.654 Vali Acc: 0.460 Test Loss: 4.654 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.848963737487793
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.722 Vali Acc: 0.460 Test Loss: 4.722 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 879243397
model size : 3358.68MB
2025-04-27 18:18:47.151763: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:18:47.171329: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745777927.194362  928356 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745777927.201209  928356 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:18:47.223848: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.846639633178711
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.620 Vali Acc: 0.320 Test Loss: 1.620 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.8650741577148438
Epoch: 2, Steps: 4 | Train Loss: 1.345 Vali Loss: 1.525 Vali Acc: 0.340 Test Loss: 1.525 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.8551173210144043
Epoch: 3, Steps: 4 | Train Loss: 0.555 Vali Loss: 1.555 Vali Acc: 0.440 Test Loss: 1.555 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439984).  Saving model ...
Epoch: 4 cost time: 1.8390491008758545
Epoch: 4, Steps: 4 | Train Loss: 0.254 Vali Loss: 1.793 Vali Acc: 0.500 Test Loss: 1.793 Test Acc: 0.500
Validation loss decreased (-0.439984 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 1.8460242748260498
Epoch: 5, Steps: 4 | Train Loss: 0.124 Vali Loss: 2.104 Vali Acc: 0.500 Test Loss: 2.104 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.805710792541504
Epoch: 6, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.685 Vali Acc: 0.460 Test Loss: 2.685 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7689359188079834
Epoch: 7, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.119 Vali Acc: 0.480 Test Loss: 3.119 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7811381816864014
Epoch: 8, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.366 Vali Acc: 0.480 Test Loss: 3.366 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.798220157623291
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.358 Vali Acc: 0.540 Test Loss: 3.358 Test Acc: 0.540
Validation loss decreased (-0.499982 --> -0.539966).  Saving model ...
Epoch: 10 cost time: 1.847353219985962
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.128 Vali Acc: 0.440 Test Loss: 3.128 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8339855670928955
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.373 Vali Acc: 0.520 Test Loss: 3.373 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7710235118865967
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.535 Vali Acc: 0.480 Test Loss: 3.535 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7734920978546143
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.745 Vali Acc: 0.540 Test Loss: 3.745 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7747254371643066
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.750 Vali Acc: 0.540 Test Loss: 3.750 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7937960624694824
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.598 Vali Acc: 0.540 Test Loss: 3.598 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.772864818572998
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.738 Vali Acc: 0.500 Test Loss: 3.738 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7868952751159668
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.863 Vali Acc: 0.520 Test Loss: 3.863 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.781693935394287
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.097 Vali Acc: 0.520 Test Loss: 4.097 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8254961967468262
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.158 Vali Acc: 0.520 Test Loss: 4.158 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 877522245
model size : 3352.12MB
2025-04-27 18:20:57.576699: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:20:57.595867: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745778057.617841  937085 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745778057.624643  937085 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:20:57.647355: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7637593746185303
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.610 Vali Acc: 0.340 Test Loss: 1.610 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.8155136108398438
Epoch: 2, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.469 Vali Acc: 0.260 Test Loss: 1.469 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.752481460571289
Epoch: 3, Steps: 4 | Train Loss: 0.511 Vali Loss: 1.463 Vali Acc: 0.420 Test Loss: 1.463 Test Acc: 0.420
Validation loss decreased (-0.339984 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 1.8116648197174072
Epoch: 4, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.499 Vali Acc: 0.520 Test Loss: 1.499 Test Acc: 0.520
Validation loss decreased (-0.419985 --> -0.519985).  Saving model ...
Epoch: 5 cost time: 1.8102748394012451
Epoch: 5, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.756 Vali Acc: 0.580 Test Loss: 1.756 Test Acc: 0.580
Validation loss decreased (-0.519985 --> -0.579982).  Saving model ...
Epoch: 6 cost time: 1.8167786598205566
Epoch: 6, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.159 Vali Acc: 0.520 Test Loss: 2.159 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7773032188415527
Epoch: 7, Steps: 4 | Train Loss: 0.117 Vali Loss: 2.202 Vali Acc: 0.540 Test Loss: 2.202 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7745089530944824
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.328 Vali Acc: 0.580 Test Loss: 2.328 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7609636783599854
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.618 Vali Acc: 0.480 Test Loss: 2.618 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7547881603240967
Epoch: 10, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.700 Vali Acc: 0.560 Test Loss: 2.700 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7831544876098633
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.047 Vali Acc: 0.560 Test Loss: 3.047 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7481799125671387
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.375 Vali Acc: 0.480 Test Loss: 3.375 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7563796043395996
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.712 Vali Acc: 0.500 Test Loss: 3.712 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7798893451690674
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.706 Vali Acc: 0.460 Test Loss: 3.706 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.778249979019165
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.824 Vali Acc: 0.460 Test Loss: 3.824 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 877522661
model size : 3352.12MB
2025-04-27 18:22:50.508905: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:22:50.527866: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745778170.549817  944087 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745778170.556579  944087 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:22:50.578941: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.650728940963745
Epoch: 1, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.593 Vali Acc: 0.280 Test Loss: 1.593 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.7779130935668945
Epoch: 2, Steps: 4 | Train Loss: 1.247 Vali Loss: 1.453 Vali Acc: 0.380 Test Loss: 1.453 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.7332475185394287
Epoch: 3, Steps: 4 | Train Loss: 0.663 Vali Loss: 1.576 Vali Acc: 0.440 Test Loss: 1.576 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439984).  Saving model ...
Epoch: 4 cost time: 1.7632794380187988
Epoch: 4, Steps: 4 | Train Loss: 0.374 Vali Loss: 1.653 Vali Acc: 0.460 Test Loss: 1.653 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459983).  Saving model ...
Epoch: 5 cost time: 1.7631969451904297
Epoch: 5, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.655 Vali Acc: 0.540 Test Loss: 1.655 Test Acc: 0.540
Validation loss decreased (-0.459983 --> -0.539983).  Saving model ...
Epoch: 6 cost time: 1.7407050132751465
Epoch: 6, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.718 Vali Acc: 0.560 Test Loss: 1.718 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559983).  Saving model ...
Epoch: 7 cost time: 1.7315797805786133
Epoch: 7, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.928 Vali Acc: 0.640 Test Loss: 1.928 Test Acc: 0.640
Validation loss decreased (-0.559983 --> -0.639981).  Saving model ...
Epoch: 8 cost time: 1.7638804912567139
Epoch: 8, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.216 Vali Acc: 0.620 Test Loss: 2.216 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6946179866790771
Epoch: 9, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.333 Vali Acc: 0.580 Test Loss: 2.333 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.71248197555542
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.411 Vali Acc: 0.520 Test Loss: 2.411 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7087152004241943
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.662 Vali Acc: 0.560 Test Loss: 2.662 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7242066860198975
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.838 Vali Acc: 0.540 Test Loss: 2.838 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6861915588378906
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.062 Vali Acc: 0.540 Test Loss: 3.062 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6762652397155762
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.951 Vali Acc: 0.540 Test Loss: 2.951 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6860337257385254
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.997 Vali Acc: 0.520 Test Loss: 2.997 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6871881484985352
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.107 Vali Acc: 0.540 Test Loss: 3.107 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6717092990875244
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.182 Vali Acc: 0.560 Test Loss: 3.182 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 876662309
model size : 3348.84MB
2025-04-27 18:25:10.855988: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:25:10.875183: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745778310.897454  952073 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745778310.904297  952073 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:25:10.927070: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.514740705490112
Epoch: 1, Steps: 7 | Train Loss: 3.405 Vali Loss: 5.590 Vali Acc: 0.360 Test Loss: 5.590 Test Acc: 0.360
Validation loss decreased (inf --> -0.359944).  Saving model ...
Epoch: 2 cost time: 4.588496685028076
Epoch: 2, Steps: 7 | Train Loss: 3.586 Vali Loss: 16.277 Vali Acc: 0.400 Test Loss: 16.277 Test Acc: 0.400
Validation loss decreased (-0.359944 --> -0.399837).  Saving model ...
Epoch: 3 cost time: 4.579090118408203
Epoch: 3, Steps: 7 | Train Loss: 1.118 Vali Loss: 16.889 Vali Acc: 0.420 Test Loss: 16.889 Test Acc: 0.420
Validation loss decreased (-0.399837 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 4.578127384185791
Epoch: 4, Steps: 7 | Train Loss: 0.000 Vali Loss: 33.630 Vali Acc: 0.360 Test Loss: 33.630 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.527602672576904
Epoch: 5, Steps: 7 | Train Loss: 1.268 Vali Loss: 28.758 Vali Acc: 0.340 Test Loss: 28.758 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.539897441864014
Epoch: 6, Steps: 7 | Train Loss: 1.538 Vali Loss: 36.060 Vali Acc: 0.400 Test Loss: 36.060 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.540858507156372
Epoch: 7, Steps: 7 | Train Loss: 0.281 Vali Loss: 60.430 Vali Acc: 0.440 Test Loss: 60.430 Test Acc: 0.440
Validation loss decreased (-0.419831 --> -0.439396).  Saving model ...
Epoch: 8 cost time: 4.560998916625977
Epoch: 8, Steps: 7 | Train Loss: 0.137 Vali Loss: 64.979 Vali Acc: 0.400 Test Loss: 64.979 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.530160427093506
Epoch: 9, Steps: 7 | Train Loss: 5.178 Vali Loss: 33.193 Vali Acc: 0.420 Test Loss: 33.193 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.543830871582031
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 63.086 Vali Acc: 0.340 Test Loss: 63.086 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.548189640045166
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 83.383 Vali Acc: 0.360 Test Loss: 83.383 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.5197906494140625
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 88.915 Vali Acc: 0.340 Test Loss: 88.915 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.547194004058838
Epoch: 13, Steps: 7 | Train Loss: 1.519 Vali Loss: 69.118 Vali Acc: 0.440 Test Loss: 69.118 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.52279257774353
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 70.240 Vali Acc: 0.500 Test Loss: 70.240 Test Acc: 0.500
Validation loss decreased (-0.439396 --> -0.499298).  Saving model ...
Epoch: 15 cost time: 4.572918176651001
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 83.127 Vali Acc: 0.420 Test Loss: 83.127 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.536186695098877
Epoch: 16, Steps: 7 | Train Loss: 0.974 Vali Loss: 69.866 Vali Acc: 0.460 Test Loss: 69.866 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.53434419631958
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 81.265 Vali Acc: 0.360 Test Loss: 81.265 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.538697719573975
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 83.704 Vali Acc: 0.460 Test Loss: 83.704 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.530588150024414
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 84.130 Vali Acc: 0.460 Test Loss: 84.130 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.532543182373047
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 87.573 Vali Acc: 0.440 Test Loss: 87.573 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.528779745101929
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 85.357 Vali Acc: 0.440 Test Loss: 85.357 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.525230407714844
Epoch: 22, Steps: 7 | Train Loss: 2.940 Vali Loss: 89.591 Vali Acc: 0.320 Test Loss: 89.591 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.542490005493164
Epoch: 23, Steps: 7 | Train Loss: 4.710 Vali Loss: 80.348 Vali Acc: 0.340 Test Loss: 80.348 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.548763990402222
Epoch: 24, Steps: 7 | Train Loss: 3.898 Vali Loss: 77.774 Vali Acc: 0.400 Test Loss: 77.774 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1681726981
model size : 6423.19MB
2025-04-27 18:25:41.943725: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:25:41.963164: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745778341.985600  952473 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745778341.992391  952473 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:25:42.015047: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8634836673736572
Epoch: 1, Steps: 4 | Train Loss: 1.751 Vali Loss: 1.585 Vali Acc: 0.340 Test Loss: 1.585 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 2.8487982749938965
Epoch: 2, Steps: 4 | Train Loss: 1.332 Vali Loss: 3.578 Vali Acc: 0.400 Test Loss: 3.578 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399964).  Saving model ...
Epoch: 3 cost time: 2.8596808910369873
Epoch: 3, Steps: 4 | Train Loss: 0.391 Vali Loss: 7.398 Vali Acc: 0.380 Test Loss: 7.398 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.837743043899536
Epoch: 4, Steps: 4 | Train Loss: 0.110 Vali Loss: 8.117 Vali Acc: 0.340 Test Loss: 8.117 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.80118727684021
Epoch: 5, Steps: 4 | Train Loss: 0.116 Vali Loss: 10.346 Vali Acc: 0.380 Test Loss: 10.346 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7996604442596436
Epoch: 6, Steps: 4 | Train Loss: 0.011 Vali Loss: 19.003 Vali Acc: 0.400 Test Loss: 19.003 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.794607639312744
Epoch: 7, Steps: 4 | Train Loss: 0.176 Vali Loss: 24.034 Vali Acc: 0.440 Test Loss: 24.034 Test Acc: 0.440
Validation loss decreased (-0.399964 --> -0.439760).  Saving model ...
Epoch: 8 cost time: 2.8383641242980957
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 26.354 Vali Acc: 0.420 Test Loss: 26.354 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.80898118019104
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 30.344 Vali Acc: 0.360 Test Loss: 30.344 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8238251209259033
Epoch: 10, Steps: 4 | Train Loss: 0.032 Vali Loss: 26.736 Vali Acc: 0.460 Test Loss: 26.736 Test Acc: 0.460
Validation loss decreased (-0.439760 --> -0.459733).  Saving model ...
Epoch: 11 cost time: 2.8613429069519043
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 25.272 Vali Acc: 0.380 Test Loss: 25.272 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7882606983184814
Epoch: 12, Steps: 4 | Train Loss: 0.076 Vali Loss: 39.854 Vali Acc: 0.420 Test Loss: 39.854 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8530588150024414
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 61.939 Vali Acc: 0.400 Test Loss: 61.939 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8381922245025635
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 61.138 Vali Acc: 0.400 Test Loss: 61.138 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7953102588653564
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 69.917 Vali Acc: 0.380 Test Loss: 69.917 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7910208702087402
Epoch: 16, Steps: 4 | Train Loss: 0.295 Vali Loss: 61.273 Vali Acc: 0.360 Test Loss: 61.273 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7952229976654053
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 53.320 Vali Acc: 0.420 Test Loss: 53.320 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8846323490142822
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 53.772 Vali Acc: 0.400 Test Loss: 53.772 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.367574453353882
Epoch: 19, Steps: 4 | Train Loss: 0.616 Vali Loss: 51.187 Vali Acc: 0.400 Test Loss: 51.187 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.812021493911743
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 60.541 Vali Acc: 0.460 Test Loss: 60.541 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 1655903877
model size : 6324.68MB
2025-04-27 18:29:13.349722: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:29:13.369380: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745778553.392020  962164 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745778553.398948  962164 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:29:13.422142: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7137105464935303
Epoch: 1, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.520 Vali Acc: 0.380 Test Loss: 1.520 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 2.7001543045043945
Epoch: 2, Steps: 4 | Train Loss: 0.859 Vali Loss: 2.233 Vali Acc: 0.480 Test Loss: 2.233 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479978).  Saving model ...
Epoch: 3 cost time: 2.7055680751800537
Epoch: 3, Steps: 4 | Train Loss: 0.286 Vali Loss: 4.801 Vali Acc: 0.260 Test Loss: 4.801 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6929707527160645
Epoch: 4, Steps: 4 | Train Loss: 0.088 Vali Loss: 8.147 Vali Acc: 0.420 Test Loss: 8.147 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6218278408050537
Epoch: 5, Steps: 4 | Train Loss: 0.003 Vali Loss: 15.210 Vali Acc: 0.440 Test Loss: 15.210 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.626800298690796
Epoch: 6, Steps: 4 | Train Loss: 0.023 Vali Loss: 11.430 Vali Acc: 0.440 Test Loss: 11.430 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6367428302764893
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.158 Vali Acc: 0.420 Test Loss: 9.158 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6160945892333984
Epoch: 8, Steps: 4 | Train Loss: 0.130 Vali Loss: 8.706 Vali Acc: 0.460 Test Loss: 8.706 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6432549953460693
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.658 Vali Acc: 0.480 Test Loss: 7.658 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6479907035827637
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.294 Vali Acc: 0.440 Test Loss: 8.294 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6084022521972656
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.505 Vali Acc: 0.420 Test Loss: 9.505 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6104321479797363
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 10.264 Vali Acc: 0.520 Test Loss: 10.264 Test Acc: 0.520
Validation loss decreased (-0.479978 --> -0.519897).  Saving model ...
Epoch: 13 cost time: 2.656351089477539
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.721 Vali Acc: 0.460 Test Loss: 15.721 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.637598752975464
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 20.347 Vali Acc: 0.440 Test Loss: 20.347 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.655150890350342
Epoch: 15, Steps: 4 | Train Loss: 0.080 Vali Loss: 11.360 Vali Acc: 0.460 Test Loss: 11.360 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.623891592025757
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.074 Vali Acc: 0.500 Test Loss: 14.074 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.648144483566284
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 17.445 Vali Acc: 0.440 Test Loss: 17.445 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.61893892288208
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 19.121 Vali Acc: 0.440 Test Loss: 19.121 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6395926475524902
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 20.278 Vali Acc: 0.440 Test Loss: 20.278 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6695897579193115
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 18.196 Vali Acc: 0.500 Test Loss: 18.196 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.628408432006836
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.485 Vali Acc: 0.440 Test Loss: 14.485 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.643770933151245
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.084 Vali Acc: 0.420 Test Loss: 14.084 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1643853573
model size : 6278.71MB
2025-04-27 18:32:33.451795: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:32:33.472230: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745778753.495653  972581 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745778753.502669  972581 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:32:33.525489: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5502772331237793
Epoch: 1, Steps: 4 | Train Loss: 1.525 Vali Loss: 1.558 Vali Acc: 0.340 Test Loss: 1.558 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 2.631533622741699
Epoch: 2, Steps: 4 | Train Loss: 1.066 Vali Loss: 2.032 Vali Acc: 0.460 Test Loss: 2.032 Test Acc: 0.460
Validation loss decreased (-0.339984 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 2.634587287902832
Epoch: 3, Steps: 4 | Train Loss: 0.433 Vali Loss: 3.708 Vali Acc: 0.460 Test Loss: 3.708 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5851404666900635
Epoch: 4, Steps: 4 | Train Loss: 0.126 Vali Loss: 6.902 Vali Acc: 0.440 Test Loss: 6.902 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6028051376342773
Epoch: 5, Steps: 4 | Train Loss: 0.065 Vali Loss: 9.317 Vali Acc: 0.420 Test Loss: 9.317 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.579563856124878
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.700 Vali Acc: 0.480 Test Loss: 11.700 Test Acc: 0.480
Validation loss decreased (-0.459980 --> -0.479883).  Saving model ...
Epoch: 7 cost time: 2.6302812099456787
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.548 Vali Acc: 0.460 Test Loss: 11.548 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.597109317779541
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.852 Vali Acc: 0.420 Test Loss: 12.852 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.605487585067749
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.638 Vali Acc: 0.460 Test Loss: 14.638 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5817928314208984
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.916 Vali Acc: 0.460 Test Loss: 15.916 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6060993671417236
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 13.725 Vali Acc: 0.520 Test Loss: 13.725 Test Acc: 0.520
Validation loss decreased (-0.479883 --> -0.519863).  Saving model ...
Epoch: 12 cost time: 2.628335952758789
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.472 Vali Acc: 0.460 Test Loss: 12.472 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5853307247161865
Epoch: 13, Steps: 4 | Train Loss: 0.176 Vali Loss: 10.730 Vali Acc: 0.540 Test Loss: 10.730 Test Acc: 0.540
Validation loss decreased (-0.519863 --> -0.539893).  Saving model ...
Epoch: 14 cost time: 2.6854026317596436
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.643 Vali Acc: 0.480 Test Loss: 15.643 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5902562141418457
Epoch: 15, Steps: 4 | Train Loss: 0.062 Vali Loss: 14.221 Vali Acc: 0.480 Test Loss: 14.221 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6039462089538574
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.119 Vali Acc: 0.480 Test Loss: 13.119 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.596266031265259
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.751 Vali Acc: 0.560 Test Loss: 15.751 Test Acc: 0.560
Validation loss decreased (-0.539893 --> -0.559842).  Saving model ...
Epoch: 18 cost time: 2.6617701053619385
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 18.038 Vali Acc: 0.480 Test Loss: 18.038 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5710835456848145
Epoch: 19, Steps: 4 | Train Loss: 0.005 Vali Loss: 15.947 Vali Acc: 0.400 Test Loss: 15.947 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5980067253112793
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 28.736 Vali Acc: 0.360 Test Loss: 28.736 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.6000397205352783
Epoch: 21, Steps: 4 | Train Loss: 0.178 Vali Loss: 29.333 Vali Acc: 0.340 Test Loss: 29.333 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.583987236022949
Epoch: 22, Steps: 4 | Train Loss: 0.204 Vali Loss: 24.617 Vali Acc: 0.400 Test Loss: 24.617 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.608236312866211
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.145 Vali Acc: 0.420 Test Loss: 23.145 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5974314212799072
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 24.833 Vali Acc: 0.400 Test Loss: 24.833 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.584282398223877
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.491 Vali Acc: 0.400 Test Loss: 22.491 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6098392009735107
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.800 Vali Acc: 0.380 Test Loss: 21.800 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5745489597320557
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.661 Vali Acc: 0.400 Test Loss: 22.661 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1640411141
model size : 6265.58MB
2025-04-27 18:37:04.898888: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:37:04.917985: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745779024.940048  985515 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745779024.946793  985515 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:37:04.969392: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.411746025085449
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.504 Vali Acc: 0.320 Test Loss: 1.504 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 2.5019524097442627
Epoch: 2, Steps: 4 | Train Loss: 0.948 Vali Loss: 2.010 Vali Acc: 0.460 Test Loss: 2.010 Test Acc: 0.460
Validation loss decreased (-0.319985 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 2.4841694831848145
Epoch: 3, Steps: 4 | Train Loss: 0.816 Vali Loss: 2.343 Vali Acc: 0.480 Test Loss: 2.343 Test Acc: 0.480
Validation loss decreased (-0.459980 --> -0.479977).  Saving model ...
Epoch: 4 cost time: 2.484354019165039
Epoch: 4, Steps: 4 | Train Loss: 0.171 Vali Loss: 3.946 Vali Acc: 0.520 Test Loss: 3.946 Test Acc: 0.520
Validation loss decreased (-0.479977 --> -0.519961).  Saving model ...
Epoch: 5 cost time: 2.5136148929595947
Epoch: 5, Steps: 4 | Train Loss: 0.690 Vali Loss: 5.044 Vali Acc: 0.500 Test Loss: 5.044 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.458996057510376
Epoch: 6, Steps: 4 | Train Loss: 0.019 Vali Loss: 3.085 Vali Acc: 0.500 Test Loss: 3.085 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4434587955474854
Epoch: 7, Steps: 4 | Train Loss: 0.038 Vali Loss: 4.508 Vali Acc: 0.540 Test Loss: 4.508 Test Acc: 0.540
Validation loss decreased (-0.519961 --> -0.539955).  Saving model ...
Epoch: 8 cost time: 2.5123889446258545
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.363 Vali Acc: 0.540 Test Loss: 7.363 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.459861993789673
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.042 Vali Acc: 0.520 Test Loss: 9.042 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.445260763168335
Epoch: 10, Steps: 4 | Train Loss: 0.223 Vali Loss: 9.215 Vali Acc: 0.520 Test Loss: 9.215 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.432727575302124
Epoch: 11, Steps: 4 | Train Loss: 0.073 Vali Loss: 7.865 Vali Acc: 0.460 Test Loss: 7.865 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4295780658721924
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.007 Vali Acc: 0.500 Test Loss: 6.007 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4272513389587402
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.200 Vali Acc: 0.520 Test Loss: 5.200 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.447864532470703
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.223 Vali Acc: 0.500 Test Loss: 5.223 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4560658931732178
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.271 Vali Acc: 0.500 Test Loss: 5.271 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4397926330566406
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.698 Vali Acc: 0.520 Test Loss: 5.698 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.438770294189453
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.346 Vali Acc: 0.460 Test Loss: 6.346 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1633526533
model size : 6239.32MB
2025-04-27 18:40:30.643500: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:40:30.662806: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745779230.685123  993964 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745779230.691921  993964 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:40:30.714907: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4323337078094482
Epoch: 1, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.476 Vali Acc: 0.360 Test Loss: 1.476 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 2.4805796146392822
Epoch: 2, Steps: 4 | Train Loss: 1.103 Vali Loss: 2.051 Vali Acc: 0.360 Test Loss: 2.051 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.405954599380493
Epoch: 3, Steps: 4 | Train Loss: 0.754 Vali Loss: 2.087 Vali Acc: 0.380 Test Loss: 2.087 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379979).  Saving model ...
Epoch: 4 cost time: 2.437936305999756
Epoch: 4, Steps: 4 | Train Loss: 0.304 Vali Loss: 2.933 Vali Acc: 0.460 Test Loss: 2.933 Test Acc: 0.460
Validation loss decreased (-0.379979 --> -0.459971).  Saving model ...
Epoch: 5 cost time: 2.4670050144195557
Epoch: 5, Steps: 4 | Train Loss: 0.153 Vali Loss: 2.876 Vali Acc: 0.540 Test Loss: 2.876 Test Acc: 0.540
Validation loss decreased (-0.459971 --> -0.539971).  Saving model ...
Epoch: 6 cost time: 2.4435620307922363
Epoch: 6, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.646 Vali Acc: 0.460 Test Loss: 2.646 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.410120725631714
Epoch: 7, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.279 Vali Acc: 0.500 Test Loss: 3.279 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4151227474212646
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.080 Vali Acc: 0.460 Test Loss: 4.080 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3930647373199463
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.891 Vali Acc: 0.460 Test Loss: 4.891 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.421940803527832
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.210 Vali Acc: 0.440 Test Loss: 5.210 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4084506034851074
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.440 Test Loss: 5.956 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4187726974487305
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.099 Vali Acc: 0.440 Test Loss: 6.099 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.414113998413086
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.783 Vali Acc: 0.420 Test Loss: 5.783 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4015450477600098
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.134 Vali Acc: 0.440 Test Loss: 6.134 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3940746784210205
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.431 Vali Acc: 0.440 Test Loss: 6.431 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1631806597
model size : 6232.76MB
2025-04-27 18:43:29.880290: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:43:29.899691: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745779409.921774 1001417 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745779409.928495 1001417 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:43:29.951268: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4292378425598145
Epoch: 1, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.461 Vali Acc: 0.460 Test Loss: 1.461 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 2.5044891834259033
Epoch: 2, Steps: 4 | Train Loss: 0.924 Vali Loss: 1.832 Vali Acc: 0.460 Test Loss: 1.832 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4454941749572754
Epoch: 3, Steps: 4 | Train Loss: 0.783 Vali Loss: 2.187 Vali Acc: 0.440 Test Loss: 2.187 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4871103763580322
Epoch: 4, Steps: 4 | Train Loss: 0.143 Vali Loss: 2.678 Vali Acc: 0.520 Test Loss: 2.678 Test Acc: 0.520
Validation loss decreased (-0.459985 --> -0.519973).  Saving model ...
Epoch: 5 cost time: 2.5191240310668945
Epoch: 5, Steps: 4 | Train Loss: 0.040 Vali Loss: 2.898 Vali Acc: 0.520 Test Loss: 2.898 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4916176795959473
Epoch: 6, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.103 Vali Acc: 0.500 Test Loss: 4.103 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.472867250442505
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.142 Vali Acc: 0.520 Test Loss: 5.142 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.463167428970337
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.443 Vali Acc: 0.520 Test Loss: 5.443 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.491513967514038
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.907 Vali Acc: 0.520 Test Loss: 5.907 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.458348512649536
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.306 Vali Acc: 0.500 Test Loss: 6.306 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4564850330352783
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.583 Vali Acc: 0.520 Test Loss: 6.583 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4660158157348633
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.944 Vali Acc: 0.540 Test Loss: 6.944 Test Acc: 0.540
Validation loss decreased (-0.519973 --> -0.539931).  Saving model ...
Epoch: 13 cost time: 2.54579758644104
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.815 Vali Acc: 0.520 Test Loss: 6.815 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4785916805267334
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.872 Vali Acc: 0.520 Test Loss: 6.872 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4665729999542236
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.826 Vali Acc: 0.560 Test Loss: 6.826 Test Acc: 0.560
Validation loss decreased (-0.539931 --> -0.559932).  Saving model ...
Epoch: 16 cost time: 2.5215985774993896
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.154 Vali Acc: 0.580 Test Loss: 7.154 Test Acc: 0.580
Validation loss decreased (-0.559932 --> -0.579928).  Saving model ...
Epoch: 17 cost time: 2.5124154090881348
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.803 Vali Acc: 0.520 Test Loss: 6.803 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4706432819366455
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.079 Vali Acc: 0.580 Test Loss: 7.079 Test Acc: 0.580
Validation loss decreased (-0.579928 --> -0.579929).  Saving model ...
Epoch: 19 cost time: 2.5333118438720703
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.431 Vali Acc: 0.540 Test Loss: 6.431 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4633660316467285
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.020 Vali Acc: 0.460 Test Loss: 7.020 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4740512371063232
Epoch: 21, Steps: 4 | Train Loss: 0.173 Vali Loss: 5.756 Vali Acc: 0.460 Test Loss: 5.756 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.463897466659546
Epoch: 22, Steps: 4 | Train Loss: 0.115 Vali Loss: 6.502 Vali Acc: 0.460 Test Loss: 6.502 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.471802234649658
Epoch: 23, Steps: 4 | Train Loss: 0.276 Vali Loss: 10.211 Vali Acc: 0.420 Test Loss: 10.211 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4819493293762207
Epoch: 24, Steps: 4 | Train Loss: 0.864 Vali Loss: 8.065 Vali Acc: 0.480 Test Loss: 8.065 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.479496955871582
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.875 Vali Acc: 0.500 Test Loss: 6.875 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.4554929733276367
Epoch: 26, Steps: 4 | Train Loss: 0.071 Vali Loss: 18.050 Vali Acc: 0.400 Test Loss: 18.050 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.479617118835449
Epoch: 27, Steps: 4 | Train Loss: 0.246 Vali Loss: 15.810 Vali Acc: 0.440 Test Loss: 15.810 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4622890949249268
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.150 Vali Acc: 0.480 Test Loss: 13.150 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1630086789
model size : 6226.20MB
2025-04-27 18:47:51.672430: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:47:51.692349: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745779671.714844 1014673 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745779671.721738 1014673 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:47:51.745376: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0649142265319824
Epoch: 1, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.532 Vali Acc: 0.300 Test Loss: 1.532 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 2.1789145469665527
Epoch: 2, Steps: 4 | Train Loss: 0.885 Vali Loss: 2.550 Vali Acc: 0.440 Test Loss: 2.550 Test Acc: 0.440
Validation loss decreased (-0.299985 --> -0.439975).  Saving model ...
Epoch: 3 cost time: 2.1778249740600586
Epoch: 3, Steps: 4 | Train Loss: 0.179 Vali Loss: 10.718 Vali Acc: 0.420 Test Loss: 10.718 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1102817058563232
Epoch: 4, Steps: 4 | Train Loss: 0.918 Vali Loss: 10.483 Vali Acc: 0.360 Test Loss: 10.483 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1000428199768066
Epoch: 5, Steps: 4 | Train Loss: 0.195 Vali Loss: 15.544 Vali Acc: 0.380 Test Loss: 15.544 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1112375259399414
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.731 Vali Acc: 0.360 Test Loss: 23.731 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.142707586288452
Epoch: 7, Steps: 4 | Train Loss: 0.246 Vali Loss: 23.060 Vali Acc: 0.360 Test Loss: 23.060 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.105454683303833
Epoch: 8, Steps: 4 | Train Loss: 0.011 Vali Loss: 17.538 Vali Acc: 0.400 Test Loss: 17.538 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.107511281967163
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 25.599 Vali Acc: 0.380 Test Loss: 25.599 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1242849826812744
Epoch: 10, Steps: 4 | Train Loss: 0.291 Vali Loss: 22.402 Vali Acc: 0.360 Test Loss: 22.402 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.108711004257202
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 32.862 Vali Acc: 0.360 Test Loss: 32.862 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1030118465423584
Epoch: 12, Steps: 4 | Train Loss: 0.032 Vali Loss: 27.226 Vali Acc: 0.420 Test Loss: 27.226 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 785755909
model size : 3001.39MB
2025-04-27 18:49:18.521759: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:49:18.540646: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745779758.562603 1020290 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745779758.569235 1020290 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:49:18.591612: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7814929485321045
Epoch: 1, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.8542194366455078
Epoch: 2, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.789 Vali Acc: 0.500 Test Loss: 1.789 Test Acc: 0.500
Validation loss decreased (-0.299985 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 1.8290388584136963
Epoch: 3, Steps: 4 | Train Loss: 0.269 Vali Loss: 4.171 Vali Acc: 0.420 Test Loss: 4.171 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.808027744293213
Epoch: 4, Steps: 4 | Train Loss: 0.406 Vali Loss: 4.511 Vali Acc: 0.480 Test Loss: 4.511 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8133175373077393
Epoch: 5, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.883 Vali Acc: 0.460 Test Loss: 5.883 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.821526050567627
Epoch: 6, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.932 Vali Acc: 0.440 Test Loss: 9.932 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8228933811187744
Epoch: 7, Steps: 4 | Train Loss: 0.152 Vali Loss: 10.491 Vali Acc: 0.460 Test Loss: 10.491 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.791844129562378
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.418 Vali Acc: 0.420 Test Loss: 11.418 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.807072401046753
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 12.593 Vali Acc: 0.420 Test Loss: 12.593 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8026342391967773
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.934 Vali Acc: 0.380 Test Loss: 13.934 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7922272682189941
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 13.155 Vali Acc: 0.400 Test Loss: 13.155 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7906148433685303
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 11.092 Vali Acc: 0.440 Test Loss: 11.092 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 772844357
model size : 2952.13MB
2025-04-27 18:50:42.531435: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:50:42.550675: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745779842.572824 1025876 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745779842.579610 1025876 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:50:42.602535: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.64801287651062
Epoch: 1, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.560 Vali Acc: 0.280 Test Loss: 1.560 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.6957974433898926
Epoch: 2, Steps: 4 | Train Loss: 1.036 Vali Loss: 1.968 Vali Acc: 0.360 Test Loss: 1.968 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359980).  Saving model ...
Epoch: 3 cost time: 1.6764914989471436
Epoch: 3, Steps: 4 | Train Loss: 0.205 Vali Loss: 2.747 Vali Acc: 0.380 Test Loss: 2.747 Test Acc: 0.380
Validation loss decreased (-0.359980 --> -0.379973).  Saving model ...
Epoch: 4 cost time: 1.6977150440216064
Epoch: 4, Steps: 4 | Train Loss: 0.046 Vali Loss: 4.038 Vali Acc: 0.380 Test Loss: 4.038 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6456263065338135
Epoch: 5, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.250 Vali Acc: 0.360 Test Loss: 5.250 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.617239236831665
Epoch: 6, Steps: 4 | Train Loss: 0.076 Vali Loss: 6.486 Vali Acc: 0.460 Test Loss: 6.486 Test Acc: 0.460
Validation loss decreased (-0.379973 --> -0.459935).  Saving model ...
Epoch: 7 cost time: 1.7007622718811035
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.535 Vali Acc: 0.460 Test Loss: 8.535 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.641160011291504
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.573 Vali Acc: 0.420 Test Loss: 10.573 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.616724967956543
Epoch: 9, Steps: 4 | Train Loss: 0.024 Vali Loss: 9.506 Vali Acc: 0.420 Test Loss: 9.506 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6131031513214111
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.309 Vali Acc: 0.380 Test Loss: 8.309 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6234495639801025
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.550 Vali Acc: 0.400 Test Loss: 8.550 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6318426132202148
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 9.834 Vali Acc: 0.400 Test Loss: 9.834 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6153321266174316
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.709 Vali Acc: 0.360 Test Loss: 12.709 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6185390949249268
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 11.943 Vali Acc: 0.360 Test Loss: 11.943 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6666982173919678
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.658 Vali Acc: 0.400 Test Loss: 10.658 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.652456283569336
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.954 Vali Acc: 0.420 Test Loss: 9.954 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 766819205
model size : 2929.15MB
2025-04-27 18:52:32.906182: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:52:32.925109: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745779952.946893 1033259 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745779952.953544 1033259 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:52:32.975829: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6150245666503906
Epoch: 1, Steps: 4 | Train Loss: 1.718 Vali Loss: 1.580 Vali Acc: 0.240 Test Loss: 1.580 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.6613051891326904
Epoch: 2, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.882 Vali Acc: 0.360 Test Loss: 1.882 Test Acc: 0.360
Validation loss decreased (-0.239984 --> -0.359981).  Saving model ...
Epoch: 3 cost time: 1.6994915008544922
Epoch: 3, Steps: 4 | Train Loss: 0.356 Vali Loss: 2.160 Vali Acc: 0.440 Test Loss: 2.160 Test Acc: 0.440
Validation loss decreased (-0.359981 --> -0.439978).  Saving model ...
Epoch: 4 cost time: 1.6780891418457031
Epoch: 4, Steps: 4 | Train Loss: 0.182 Vali Loss: 2.897 Vali Acc: 0.440 Test Loss: 2.897 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6079702377319336
Epoch: 5, Steps: 4 | Train Loss: 0.092 Vali Loss: 3.427 Vali Acc: 0.340 Test Loss: 3.427 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6105711460113525
Epoch: 6, Steps: 4 | Train Loss: 0.218 Vali Loss: 4.505 Vali Acc: 0.320 Test Loss: 4.505 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6150593757629395
Epoch: 7, Steps: 4 | Train Loss: 0.166 Vali Loss: 5.083 Vali Acc: 0.500 Test Loss: 5.083 Test Acc: 0.500
Validation loss decreased (-0.439978 --> -0.499949).  Saving model ...
Epoch: 8 cost time: 1.666506290435791
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.265 Vali Acc: 0.480 Test Loss: 7.265 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6177613735198975
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.803 Vali Acc: 0.480 Test Loss: 9.803 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6130156517028809
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.686 Vali Acc: 0.480 Test Loss: 11.686 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6287171840667725
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.169 Vali Acc: 0.500 Test Loss: 13.169 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.644578456878662
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.654 Vali Acc: 0.480 Test Loss: 12.654 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.592231273651123
Epoch: 13, Steps: 4 | Train Loss: 1.180 Vali Loss: 10.678 Vali Acc: 0.480 Test Loss: 10.678 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6214678287506104
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.675 Vali Acc: 0.440 Test Loss: 6.675 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.622309923171997
Epoch: 15, Steps: 4 | Train Loss: 0.021 Vali Loss: 5.625 Vali Acc: 0.440 Test Loss: 5.625 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6221539974212646
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.167 Vali Acc: 0.400 Test Loss: 9.167 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6174860000610352
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 9.446 Vali Acc: 0.460 Test Loss: 9.446 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 765097989
model size : 2922.58MB
2025-04-27 18:54:23.489903: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:54:23.510620: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780063.532581 1041046 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780063.539608 1041046 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:54:23.562499: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.63913893699646
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.527 Vali Acc: 0.340 Test Loss: 1.527 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 1.7062404155731201
Epoch: 2, Steps: 4 | Train Loss: 1.098 Vali Loss: 1.485 Vali Acc: 0.380 Test Loss: 1.485 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.6616082191467285
Epoch: 3, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.693 Vali Acc: 0.420 Test Loss: 1.693 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419983).  Saving model ...
Epoch: 4 cost time: 1.6934618949890137
Epoch: 4, Steps: 4 | Train Loss: 0.217 Vali Loss: 2.028 Vali Acc: 0.540 Test Loss: 2.028 Test Acc: 0.540
Validation loss decreased (-0.419983 --> -0.539980).  Saving model ...
Epoch: 5 cost time: 1.6795399188995361
Epoch: 5, Steps: 4 | Train Loss: 0.067 Vali Loss: 2.404 Vali Acc: 0.520 Test Loss: 2.404 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.638425588607788
Epoch: 6, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.167 Vali Acc: 0.560 Test Loss: 2.167 Test Acc: 0.560
Validation loss decreased (-0.539980 --> -0.559978).  Saving model ...
Epoch: 7 cost time: 1.6715519428253174
Epoch: 7, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.719 Vali Acc: 0.580 Test Loss: 2.719 Test Acc: 0.580
Validation loss decreased (-0.559978 --> -0.579973).  Saving model ...
Epoch: 8 cost time: 1.6996698379516602
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.396 Vali Acc: 0.520 Test Loss: 3.396 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6204543113708496
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.368 Vali Acc: 0.540 Test Loss: 4.368 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6377582550048828
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.123 Vali Acc: 0.560 Test Loss: 5.123 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6434659957885742
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.659 Vali Acc: 0.560 Test Loss: 5.659 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.614964485168457
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.092 Vali Acc: 0.540 Test Loss: 6.092 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.624939203262329
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.881 Vali Acc: 0.520 Test Loss: 5.881 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6284129619598389
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.801 Vali Acc: 0.500 Test Loss: 5.801 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6411280632019043
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.746 Vali Acc: 0.500 Test Loss: 5.746 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.613792896270752
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.947 Vali Acc: 0.460 Test Loss: 5.947 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.648482084274292
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.787 Vali Acc: 0.480 Test Loss: 5.787 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 761655685
model size : 2909.45MB
2025-04-27 18:56:32.576749: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:56:32.596013: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780192.618187 1048960 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780192.625008 1048960 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:56:32.648449: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.522230386734009
Epoch: 1, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.578 Vali Acc: 0.360 Test Loss: 1.578 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 1.6603777408599854
Epoch: 2, Steps: 4 | Train Loss: 0.924 Vali Loss: 1.578 Vali Acc: 0.360 Test Loss: 1.578 Test Acc: 0.360
Validation loss decreased (-0.359984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 1.6406548023223877
Epoch: 3, Steps: 4 | Train Loss: 0.515 Vali Loss: 1.798 Vali Acc: 0.340 Test Loss: 1.798 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5940594673156738
Epoch: 4, Steps: 4 | Train Loss: 0.344 Vali Loss: 2.031 Vali Acc: 0.460 Test Loss: 2.031 Test Acc: 0.460
Validation loss decreased (-0.359984 --> -0.459980).  Saving model ...
Epoch: 5 cost time: 1.6736478805541992
Epoch: 5, Steps: 4 | Train Loss: 0.067 Vali Loss: 2.480 Vali Acc: 0.500 Test Loss: 2.480 Test Acc: 0.500
Validation loss decreased (-0.459980 --> -0.499975).  Saving model ...
Epoch: 6 cost time: 1.6262140274047852
Epoch: 6, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.751 Vali Acc: 0.440 Test Loss: 2.751 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6174602508544922
Epoch: 7, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.988 Vali Acc: 0.480 Test Loss: 2.988 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6316766738891602
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.598 Vali Acc: 0.480 Test Loss: 3.598 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6186974048614502
Epoch: 9, Steps: 4 | Train Loss: 0.026 Vali Loss: 3.132 Vali Acc: 0.520 Test Loss: 3.132 Test Acc: 0.520
Validation loss decreased (-0.499975 --> -0.519969).  Saving model ...
Epoch: 10 cost time: 1.6401958465576172
Epoch: 10, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.275 Vali Acc: 0.460 Test Loss: 3.275 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6165947914123535
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.580 Vali Acc: 0.520 Test Loss: 3.580 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6104607582092285
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.130 Vali Acc: 0.500 Test Loss: 4.130 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6254169940948486
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.574 Vali Acc: 0.460 Test Loss: 4.574 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5921528339385986
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.637 Vali Acc: 0.480 Test Loss: 4.637 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5903966426849365
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.628 Vali Acc: 0.500 Test Loss: 4.628 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6383538246154785
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.059 Vali Acc: 0.460 Test Loss: 4.059 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6082615852355957
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.106 Vali Acc: 0.460 Test Loss: 4.106 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6073634624481201
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.148 Vali Acc: 0.460 Test Loss: 4.148 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6244900226593018
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.084 Vali Acc: 0.460 Test Loss: 4.084 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 760795717
model size : 2906.17MB
2025-04-27 18:58:36.891722: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 18:58:36.911094: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780316.933372 1057644 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780316.940228 1057644 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 18:58:36.962989: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.544402837753296
Epoch: 1, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.603 Vali Acc: 0.180 Test Loss: 1.603 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.6250314712524414
Epoch: 2, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.571 Vali Acc: 0.380 Test Loss: 1.571 Test Acc: 0.380
Validation loss decreased (-0.179984 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 1.6341092586517334
Epoch: 3, Steps: 4 | Train Loss: 0.462 Vali Loss: 1.589 Vali Acc: 0.420 Test Loss: 1.589 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419984).  Saving model ...
Epoch: 4 cost time: 1.6188850402832031
Epoch: 4, Steps: 4 | Train Loss: 0.215 Vali Loss: 2.012 Vali Acc: 0.560 Test Loss: 2.012 Test Acc: 0.560
Validation loss decreased (-0.419984 --> -0.559980).  Saving model ...
Epoch: 5 cost time: 1.6668384075164795
Epoch: 5, Steps: 4 | Train Loss: 0.082 Vali Loss: 2.141 Vali Acc: 0.540 Test Loss: 2.141 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5912797451019287
Epoch: 6, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.567 Vali Acc: 0.480 Test Loss: 2.567 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6076898574829102
Epoch: 7, Steps: 4 | Train Loss: 0.532 Vali Loss: 2.787 Vali Acc: 0.480 Test Loss: 2.787 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.573901653289795
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.256 Vali Acc: 0.520 Test Loss: 3.256 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5790529251098633
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.764 Vali Acc: 0.500 Test Loss: 3.764 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5861210823059082
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.879 Vali Acc: 0.480 Test Loss: 3.879 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5901374816894531
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.201 Vali Acc: 0.460 Test Loss: 4.201 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5845301151275635
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.573 Vali Acc: 0.440 Test Loss: 4.573 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5758576393127441
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.845 Vali Acc: 0.460 Test Loss: 4.845 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.605562448501587
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.856 Vali Acc: 0.460 Test Loss: 4.856 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 759935813
model size : 2902.89MB
2025-04-27 19:00:17.542317: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:00:17.561352: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780417.583256 1064155 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780417.589914 1064155 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:00:17.612412: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.480464220046997
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.554 Vali Acc: 0.280 Test Loss: 1.554 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.577892780303955
Epoch: 2, Steps: 4 | Train Loss: 0.880 Vali Loss: 2.630 Vali Acc: 0.340 Test Loss: 2.630 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339974).  Saving model ...
Epoch: 3 cost time: 1.539792776107788
Epoch: 3, Steps: 4 | Train Loss: 0.621 Vali Loss: 5.378 Vali Acc: 0.500 Test Loss: 5.378 Test Acc: 0.500
Validation loss decreased (-0.339974 --> -0.499946).  Saving model ...
Epoch: 4 cost time: 1.5536773204803467
Epoch: 4, Steps: 4 | Train Loss: 0.109 Vali Loss: 7.058 Vali Acc: 0.420 Test Loss: 7.058 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5076682567596436
Epoch: 5, Steps: 4 | Train Loss: 0.077 Vali Loss: 11.570 Vali Acc: 0.440 Test Loss: 11.570 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.485692024230957
Epoch: 6, Steps: 4 | Train Loss: 0.052 Vali Loss: 8.988 Vali Acc: 0.380 Test Loss: 8.988 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5253357887268066
Epoch: 7, Steps: 4 | Train Loss: 0.007 Vali Loss: 9.628 Vali Acc: 0.460 Test Loss: 9.628 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5144484043121338
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 12.156 Vali Acc: 0.360 Test Loss: 12.156 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5171756744384766
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 12.464 Vali Acc: 0.500 Test Loss: 12.464 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5084865093231201
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 12.408 Vali Acc: 0.460 Test Loss: 12.408 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5334076881408691
Epoch: 11, Steps: 4 | Train Loss: 0.068 Vali Loss: 12.154 Vali Acc: 0.400 Test Loss: 12.154 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5148074626922607
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.591 Vali Acc: 0.340 Test Loss: 14.591 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5045890808105469
Epoch: 13, Steps: 4 | Train Loss: 0.023 Vali Loss: 16.524 Vali Acc: 0.460 Test Loss: 16.524 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 379101061
model size : 1448.15MB
2025-04-27 19:01:25.877450: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:01:25.896787: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780485.920277 1070041 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780485.927584 1070041 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:01:25.950502: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1815032958984375
Epoch: 1, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.509 Vali Acc: 0.300 Test Loss: 1.509 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.3566749095916748
Epoch: 2, Steps: 4 | Train Loss: 1.010 Vali Loss: 2.011 Vali Acc: 0.440 Test Loss: 2.011 Test Acc: 0.440
Validation loss decreased (-0.299985 --> -0.439980).  Saving model ...
Epoch: 3 cost time: 1.3508455753326416
Epoch: 3, Steps: 4 | Train Loss: 0.894 Vali Loss: 2.478 Vali Acc: 0.380 Test Loss: 2.478 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.327730655670166
Epoch: 4, Steps: 4 | Train Loss: 0.277 Vali Loss: 4.461 Vali Acc: 0.440 Test Loss: 4.461 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2929089069366455
Epoch: 5, Steps: 4 | Train Loss: 0.254 Vali Loss: 5.724 Vali Acc: 0.400 Test Loss: 5.724 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3066530227661133
Epoch: 6, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.847 Vali Acc: 0.480 Test Loss: 4.847 Test Acc: 0.480
Validation loss decreased (-0.439980 --> -0.479952).  Saving model ...
Epoch: 7 cost time: 1.356466293334961
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 5.542 Vali Acc: 0.480 Test Loss: 5.542 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3654160499572754
Epoch: 8, Steps: 4 | Train Loss: 0.032 Vali Loss: 6.161 Vali Acc: 0.460 Test Loss: 6.161 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2996540069580078
Epoch: 9, Steps: 4 | Train Loss: 0.060 Vali Loss: 6.251 Vali Acc: 0.480 Test Loss: 6.251 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3479976654052734
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.350 Vali Acc: 0.500 Test Loss: 7.350 Test Acc: 0.500
Validation loss decreased (-0.479952 --> -0.499927).  Saving model ...
Epoch: 11 cost time: 1.3773307800292969
Epoch: 11, Steps: 4 | Train Loss: 0.011 Vali Loss: 6.899 Vali Acc: 0.460 Test Loss: 6.899 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1478447914123535
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.488 Vali Acc: 0.500 Test Loss: 6.488 Test Acc: 0.500
Validation loss decreased (-0.499927 --> -0.499935).  Saving model ...
Epoch: 13 cost time: 1.3965473175048828
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 5.961 Vali Acc: 0.520 Test Loss: 5.961 Test Acc: 0.520
Validation loss decreased (-0.499935 --> -0.519940).  Saving model ...
Epoch: 14 cost time: 1.3624804019927979
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.331 Vali Acc: 0.560 Test Loss: 6.331 Test Acc: 0.560
Validation loss decreased (-0.519940 --> -0.559937).  Saving model ...
Epoch: 15 cost time: 1.365095853805542
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.689 Vali Acc: 0.540 Test Loss: 6.689 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3252151012420654
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.972 Vali Acc: 0.540 Test Loss: 6.972 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3127408027648926
Epoch: 17, Steps: 4 | Train Loss: 0.068 Vali Loss: 7.183 Vali Acc: 0.540 Test Loss: 7.183 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3253252506256104
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.737 Vali Acc: 0.500 Test Loss: 6.737 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3054673671722412
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.005 Vali Acc: 0.440 Test Loss: 7.005 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3526899814605713
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.153 Vali Acc: 0.440 Test Loss: 7.153 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3057639598846436
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.849 Vali Acc: 0.480 Test Loss: 6.849 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.314800500869751
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.173 Vali Acc: 0.500 Test Loss: 7.173 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.360264539718628
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.342 Vali Acc: 0.500 Test Loss: 7.342 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.327699899673462
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.100 Vali Acc: 0.520 Test Loss: 7.100 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 372645285
model size : 1423.52MB
2025-04-27 19:03:11.718851: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:03:11.738814: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780591.761189 1080606 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780591.768070 1080606 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:03:11.791808: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.197828769683838
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.548 Vali Acc: 0.300 Test Loss: 1.548 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.313065528869629
Epoch: 2, Steps: 4 | Train Loss: 1.117 Vali Loss: 1.651 Vali Acc: 0.440 Test Loss: 1.651 Test Acc: 0.440
Validation loss decreased (-0.299985 --> -0.439983).  Saving model ...
Epoch: 3 cost time: 1.2798490524291992
Epoch: 3, Steps: 4 | Train Loss: 0.371 Vali Loss: 2.613 Vali Acc: 0.460 Test Loss: 2.613 Test Acc: 0.460
Validation loss decreased (-0.439983 --> -0.459974).  Saving model ...
Epoch: 4 cost time: 1.288198709487915
Epoch: 4, Steps: 4 | Train Loss: 0.220 Vali Loss: 3.603 Vali Acc: 0.480 Test Loss: 3.603 Test Acc: 0.480
Validation loss decreased (-0.459974 --> -0.479964).  Saving model ...
Epoch: 5 cost time: 1.2904391288757324
Epoch: 5, Steps: 4 | Train Loss: 0.172 Vali Loss: 3.463 Vali Acc: 0.500 Test Loss: 3.463 Test Acc: 0.500
Validation loss decreased (-0.479964 --> -0.499965).  Saving model ...
Epoch: 6 cost time: 1.2876136302947998
Epoch: 6, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.886 Vali Acc: 0.360 Test Loss: 3.886 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1092262268066406
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 4.495 Vali Acc: 0.420 Test Loss: 4.495 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.246021032333374
Epoch: 8, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.251 Vali Acc: 0.380 Test Loss: 5.251 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.214669942855835
Epoch: 9, Steps: 4 | Train Loss: 0.165 Vali Loss: 5.138 Vali Acc: 0.400 Test Loss: 5.138 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.221240520477295
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.083 Vali Acc: 0.400 Test Loss: 4.083 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2666194438934326
Epoch: 11, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.130 Vali Acc: 0.380 Test Loss: 4.130 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2166821956634521
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.155 Vali Acc: 0.360 Test Loss: 5.155 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2483603954315186
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.215 Vali Acc: 0.380 Test Loss: 6.215 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2342801094055176
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.372 Vali Acc: 0.400 Test Loss: 6.372 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2233638763427734
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.265 Vali Acc: 0.440 Test Loss: 6.265 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 369632709
model size : 1412.03MB
2025-04-27 19:04:26.250007: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:04:26.269430: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780666.291899 1087336 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780666.298739 1087336 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:04:26.321441: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0975866317749023
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.500 Vali Acc: 0.360 Test Loss: 1.500 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 1.2668204307556152
Epoch: 2, Steps: 4 | Train Loss: 1.080 Vali Loss: 1.566 Vali Acc: 0.300 Test Loss: 1.566 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2295782566070557
Epoch: 3, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.804 Vali Acc: 0.440 Test Loss: 1.804 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439982).  Saving model ...
Epoch: 4 cost time: 1.2498583793640137
Epoch: 4, Steps: 4 | Train Loss: 0.221 Vali Loss: 2.070 Vali Acc: 0.460 Test Loss: 2.070 Test Acc: 0.460
Validation loss decreased (-0.439982 --> -0.459979).  Saving model ...
Epoch: 5 cost time: 1.2779550552368164
Epoch: 5, Steps: 4 | Train Loss: 0.066 Vali Loss: 2.426 Vali Acc: 0.480 Test Loss: 2.426 Test Acc: 0.480
Validation loss decreased (-0.459979 --> -0.479976).  Saving model ...
Epoch: 6 cost time: 1.273838758468628
Epoch: 6, Steps: 4 | Train Loss: 0.048 Vali Loss: 2.690 Vali Acc: 0.440 Test Loss: 2.690 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2370290756225586
Epoch: 7, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.143 Vali Acc: 0.420 Test Loss: 3.143 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2042651176452637
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.683 Vali Acc: 0.460 Test Loss: 3.683 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2315406799316406
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.116 Vali Acc: 0.480 Test Loss: 4.116 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.223038911819458
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.586 Vali Acc: 0.480 Test Loss: 4.586 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1952650547027588
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.732 Vali Acc: 0.480 Test Loss: 4.732 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1959400177001953
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.679 Vali Acc: 0.480 Test Loss: 4.679 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2275733947753906
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.557 Vali Acc: 0.480 Test Loss: 4.557 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2237403392791748
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.346 Vali Acc: 0.460 Test Loss: 4.346 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.256138563156128
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.215 Vali Acc: 0.440 Test Loss: 4.215 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 368772101
model size : 1408.75MB
2025-04-27 19:05:35.872738: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:05:35.892115: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780735.914298 1094034 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780735.921187 1094034 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:05:35.944070: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.204435110092163
Epoch: 1, Steps: 4 | Train Loss: 1.610 Vali Loss: 1.579 Vali Acc: 0.320 Test Loss: 1.579 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.2160394191741943
Epoch: 2, Steps: 4 | Train Loss: 1.153 Vali Loss: 1.555 Vali Acc: 0.400 Test Loss: 1.555 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 1.2410485744476318
Epoch: 3, Steps: 4 | Train Loss: 0.637 Vali Loss: 1.644 Vali Acc: 0.520 Test Loss: 1.644 Test Acc: 0.520
Validation loss decreased (-0.399984 --> -0.519984).  Saving model ...
Epoch: 4 cost time: 1.246436357498169
Epoch: 4, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.935 Vali Acc: 0.560 Test Loss: 1.935 Test Acc: 0.560
Validation loss decreased (-0.519984 --> -0.559981).  Saving model ...
Epoch: 5 cost time: 1.2164833545684814
Epoch: 5, Steps: 4 | Train Loss: 0.182 Vali Loss: 2.025 Vali Acc: 0.580 Test Loss: 2.025 Test Acc: 0.580
Validation loss decreased (-0.559981 --> -0.579980).  Saving model ...
Epoch: 6 cost time: 1.2347328662872314
Epoch: 6, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.717 Vali Acc: 0.560 Test Loss: 2.717 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2023649215698242
Epoch: 7, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.259 Vali Acc: 0.520 Test Loss: 3.259 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1829001903533936
Epoch: 8, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.729 Vali Acc: 0.440 Test Loss: 2.729 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1828904151916504
Epoch: 9, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.807 Vali Acc: 0.600 Test Loss: 2.807 Test Acc: 0.600
Validation loss decreased (-0.579980 --> -0.599972).  Saving model ...
Epoch: 10 cost time: 1.2241196632385254
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.337 Vali Acc: 0.560 Test Loss: 3.337 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2078032493591309
Epoch: 11, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.315 Vali Acc: 0.600 Test Loss: 3.315 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1733109951019287
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.156 Vali Acc: 0.540 Test Loss: 3.156 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1996753215789795
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.368 Vali Acc: 0.460 Test Loss: 3.368 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1853148937225342
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.582 Vali Acc: 0.560 Test Loss: 3.582 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1886227130889893
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.834 Vali Acc: 0.520 Test Loss: 3.834 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1999850273132324
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.008 Vali Acc: 0.520 Test Loss: 4.008 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1781692504882812
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.121 Vali Acc: 0.520 Test Loss: 4.121 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1999788284301758
Epoch: 18, Steps: 4 | Train Loss: 0.073 Vali Loss: 3.334 Vali Acc: 0.560 Test Loss: 3.334 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.18033766746521
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.171 Vali Acc: 0.440 Test Loss: 4.171 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 367050949
model size : 1402.18MB
2025-04-27 19:07:00.968960: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:07:00.987868: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780821.009837 1102447 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780821.016609 1102447 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:07:01.039000: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0379672050476074
Epoch: 1, Steps: 4 | Train Loss: 1.683 Vali Loss: 1.529 Vali Acc: 0.260 Test Loss: 1.529 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.185539722442627
Epoch: 2, Steps: 4 | Train Loss: 1.408 Vali Loss: 1.455 Vali Acc: 0.320 Test Loss: 1.455 Test Acc: 0.320
Validation loss decreased (-0.259985 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.2241594791412354
Epoch: 3, Steps: 4 | Train Loss: 0.931 Vali Loss: 1.512 Vali Acc: 0.480 Test Loss: 1.512 Test Acc: 0.480
Validation loss decreased (-0.319985 --> -0.479985).  Saving model ...
Epoch: 4 cost time: 1.217590570449829
Epoch: 4, Steps: 4 | Train Loss: 0.389 Vali Loss: 1.688 Vali Acc: 0.500 Test Loss: 1.688 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499983).  Saving model ...
Epoch: 5 cost time: 1.2034809589385986
Epoch: 5, Steps: 4 | Train Loss: 0.144 Vali Loss: 2.112 Vali Acc: 0.460 Test Loss: 2.112 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.180281639099121
Epoch: 6, Steps: 4 | Train Loss: 0.110 Vali Loss: 2.092 Vali Acc: 0.480 Test Loss: 2.092 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.182401418685913
Epoch: 7, Steps: 4 | Train Loss: 0.092 Vali Loss: 2.274 Vali Acc: 0.440 Test Loss: 2.274 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1629877090454102
Epoch: 8, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.586 Vali Acc: 0.480 Test Loss: 2.586 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.155651330947876
Epoch: 9, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.827 Vali Acc: 0.440 Test Loss: 2.827 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1641592979431152
Epoch: 10, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.506 Vali Acc: 0.420 Test Loss: 2.506 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.185612440109253
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.339 Vali Acc: 0.520 Test Loss: 2.339 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519977).  Saving model ...
Epoch: 12 cost time: 1.2001731395721436
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.347 Vali Acc: 0.440 Test Loss: 2.347 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1667962074279785
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.367 Vali Acc: 0.460 Test Loss: 2.367 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1925559043884277
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.481 Vali Acc: 0.480 Test Loss: 2.481 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.164719581604004
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.504 Vali Acc: 0.480 Test Loss: 2.504 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1709692478179932
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.570 Vali Acc: 0.480 Test Loss: 2.570 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1438374519348145
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.649 Vali Acc: 0.520 Test Loss: 2.649 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1565964221954346
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.688 Vali Acc: 0.520 Test Loss: 2.688 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1816794872283936
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.703 Vali Acc: 0.520 Test Loss: 2.703 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1367366313934326
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.607 Vali Acc: 0.500 Test Loss: 2.607 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2259471416473389
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.640 Vali Acc: 0.540 Test Loss: 2.640 Test Acc: 0.540
Validation loss decreased (-0.519977 --> -0.539974).  Saving model ...
Epoch: 22 cost time: 1.1798884868621826
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.718 Vali Acc: 0.540 Test Loss: 2.718 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1564133167266846
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.659 Vali Acc: 0.560 Test Loss: 2.659 Test Acc: 0.560
Validation loss decreased (-0.539974 --> -0.559973).  Saving model ...
Epoch: 24 cost time: 1.1872754096984863
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.668 Vali Acc: 0.480 Test Loss: 2.668 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2022950649261475
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.659 Vali Acc: 0.500 Test Loss: 2.659 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1522839069366455
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.719 Vali Acc: 0.480 Test Loss: 2.719 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.175997018814087
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.771 Vali Acc: 0.500 Test Loss: 2.771 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1582584381103516
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.798 Vali Acc: 0.520 Test Loss: 2.798 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1664464473724365
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.478 Vali Acc: 0.500 Test Loss: 2.478 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1773557662963867
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.505 Vali Acc: 0.480 Test Loss: 2.505 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1822443008422852
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.543 Vali Acc: 0.500 Test Loss: 2.543 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.142359972000122
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.602 Vali Acc: 0.540 Test Loss: 2.602 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.170470952987671
Epoch: 33, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.584 Vali Acc: 0.460 Test Loss: 2.584 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 366620965
model size : 1400.54MB
2025-04-27 19:09:04.772341: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:09:04.791601: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745780944.813851 1116755 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745780944.820700 1116755 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:09:04.843441: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0750834941864014
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.570 Vali Acc: 0.280 Test Loss: 1.570 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.2250828742980957
Epoch: 2, Steps: 4 | Train Loss: 1.184 Vali Loss: 1.493 Vali Acc: 0.360 Test Loss: 1.493 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.191633701324463
Epoch: 3, Steps: 4 | Train Loss: 0.577 Vali Loss: 1.576 Vali Acc: 0.440 Test Loss: 1.576 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439984).  Saving model ...
Epoch: 4 cost time: 1.2275631427764893
Epoch: 4, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.672 Vali Acc: 0.460 Test Loss: 1.672 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459983).  Saving model ...
Epoch: 5 cost time: 1.2264940738677979
Epoch: 5, Steps: 4 | Train Loss: 0.517 Vali Loss: 1.808 Vali Acc: 0.500 Test Loss: 1.808 Test Acc: 0.500
Validation loss decreased (-0.459983 --> -0.499982).  Saving model ...
Epoch: 6 cost time: 1.2147467136383057
Epoch: 6, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.978 Vali Acc: 0.600 Test Loss: 1.978 Test Acc: 0.600
Validation loss decreased (-0.499982 --> -0.599980).  Saving model ...
Epoch: 7 cost time: 1.2252578735351562
Epoch: 7, Steps: 4 | Train Loss: 0.053 Vali Loss: 2.179 Vali Acc: 0.620 Test Loss: 2.179 Test Acc: 0.620
Validation loss decreased (-0.599980 --> -0.619978).  Saving model ...
Epoch: 8 cost time: 1.2146809101104736
Epoch: 8, Steps: 4 | Train Loss: 0.020 Vali Loss: 2.561 Vali Acc: 0.600 Test Loss: 2.561 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1746487617492676
Epoch: 9, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.686 Vali Acc: 0.580 Test Loss: 2.686 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1924107074737549
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.464 Vali Acc: 0.580 Test Loss: 2.464 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2245550155639648
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.485 Vali Acc: 0.560 Test Loss: 2.485 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1919193267822266
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.749 Vali Acc: 0.560 Test Loss: 2.749 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1731700897216797
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.025 Vali Acc: 0.560 Test Loss: 3.025 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1533517837524414
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.069 Vali Acc: 0.540 Test Loss: 3.069 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2192997932434082
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.119 Vali Acc: 0.560 Test Loss: 3.119 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1816132068634033
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.086 Vali Acc: 0.580 Test Loss: 3.086 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.199803352355957
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.934 Vali Acc: 0.540 Test Loss: 2.934 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 366191013
model size : 1398.90MB
2025-04-27 19:10:26.278893: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:10:26.298701: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781026.322008 1124333 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781026.328946 1124333 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:10:26.352064: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.721631050109863
Epoch: 1, Steps: 7 | Train Loss: 1.590 Vali Loss: 3.062 Vali Acc: 0.420 Test Loss: 3.062 Test Acc: 0.420
Validation loss decreased (inf --> -0.419969).  Saving model ...
Epoch: 2 cost time: 4.507037878036499
Epoch: 2, Steps: 7 | Train Loss: 3.647 Vali Loss: 19.297 Vali Acc: 0.340 Test Loss: 19.297 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.470431327819824
Epoch: 3, Steps: 7 | Train Loss: 2.328 Vali Loss: 19.468 Vali Acc: 0.420 Test Loss: 19.468 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.458218097686768
Epoch: 4, Steps: 7 | Train Loss: 0.981 Vali Loss: 41.944 Vali Acc: 0.360 Test Loss: 41.944 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.461761951446533
Epoch: 5, Steps: 7 | Train Loss: 0.345 Vali Loss: 37.161 Vali Acc: 0.260 Test Loss: 37.161 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.4606218338012695
Epoch: 6, Steps: 7 | Train Loss: 0.221 Vali Loss: 37.232 Vali Acc: 0.420 Test Loss: 37.232 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.458266496658325
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 38.526 Vali Acc: 0.380 Test Loss: 38.526 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.470779895782471
Epoch: 8, Steps: 7 | Train Loss: 0.233 Vali Loss: 37.641 Vali Acc: 0.420 Test Loss: 37.641 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.4704201221466064
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 40.595 Vali Acc: 0.400 Test Loss: 40.595 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.449244260787964
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 41.958 Vali Acc: 0.400 Test Loss: 41.958 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.472503662109375
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 44.761 Vali Acc: 0.380 Test Loss: 44.761 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 1679661061
model size : 6415.31MB
2025-04-27 19:10:55.642014: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:10:55.659421: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781055.681258 1124727 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781055.687895 1124727 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:10:55.709275: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7925057411193848
Epoch: 1, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.678 Vali Acc: 0.420 Test Loss: 1.678 Test Acc: 0.420
Validation loss decreased (inf --> -0.419983).  Saving model ...
Epoch: 2 cost time: 2.8245811462402344
Epoch: 2, Steps: 4 | Train Loss: 1.726 Vali Loss: 3.479 Vali Acc: 0.420 Test Loss: 3.479 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.779336452484131
Epoch: 3, Steps: 4 | Train Loss: 1.119 Vali Loss: 5.145 Vali Acc: 0.400 Test Loss: 5.145 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8209211826324463
Epoch: 4, Steps: 4 | Train Loss: 0.476 Vali Loss: 11.244 Vali Acc: 0.440 Test Loss: 11.244 Test Acc: 0.440
Validation loss decreased (-0.419983 --> -0.439888).  Saving model ...
Epoch: 5 cost time: 2.8518102169036865
Epoch: 5, Steps: 4 | Train Loss: 0.757 Vali Loss: 18.382 Vali Acc: 0.420 Test Loss: 18.382 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.777529716491699
Epoch: 6, Steps: 4 | Train Loss: 0.066 Vali Loss: 17.301 Vali Acc: 0.360 Test Loss: 17.301 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7922310829162598
Epoch: 7, Steps: 4 | Train Loss: 0.540 Vali Loss: 14.147 Vali Acc: 0.420 Test Loss: 14.147 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.797114133834839
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 17.323 Vali Acc: 0.440 Test Loss: 17.323 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.781433582305908
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 26.871 Vali Acc: 0.380 Test Loss: 26.871 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7812387943267822
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 38.625 Vali Acc: 0.360 Test Loss: 38.625 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8050267696380615
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 45.213 Vali Acc: 0.380 Test Loss: 45.213 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7948873043060303
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 50.874 Vali Acc: 0.240 Test Loss: 50.874 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7849104404449463
Epoch: 13, Steps: 4 | Train Loss: 0.053 Vali Loss: 53.298 Vali Acc: 0.400 Test Loss: 53.298 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7832372188568115
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 55.861 Vali Acc: 0.420 Test Loss: 55.861 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 1653837957
model size : 6316.80MB
2025-04-27 19:13:16.437369: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:13:16.456758: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781196.481556 1131513 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781196.488899 1131513 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:13:16.512336: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.539581775665283
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.505 Vali Acc: 0.360 Test Loss: 1.505 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 2.614781379699707
Epoch: 2, Steps: 4 | Train Loss: 0.959 Vali Loss: 2.001 Vali Acc: 0.460 Test Loss: 2.001 Test Acc: 0.460
Validation loss decreased (-0.359985 --> -0.459980).  Saving model ...
Epoch: 3 cost time: 2.6152076721191406
Epoch: 3, Steps: 4 | Train Loss: 0.128 Vali Loss: 5.236 Vali Acc: 0.360 Test Loss: 5.236 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.572603702545166
Epoch: 4, Steps: 4 | Train Loss: 0.105 Vali Loss: 7.016 Vali Acc: 0.440 Test Loss: 7.016 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.582322597503662
Epoch: 5, Steps: 4 | Train Loss: 0.130 Vali Loss: 7.771 Vali Acc: 0.420 Test Loss: 7.771 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.581385374069214
Epoch: 6, Steps: 4 | Train Loss: 0.042 Vali Loss: 9.194 Vali Acc: 0.520 Test Loss: 9.194 Test Acc: 0.520
Validation loss decreased (-0.459980 --> -0.519908).  Saving model ...
Epoch: 7 cost time: 2.6020379066467285
Epoch: 7, Steps: 4 | Train Loss: 0.013 Vali Loss: 12.506 Vali Acc: 0.500 Test Loss: 12.506 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.566265344619751
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 17.416 Vali Acc: 0.480 Test Loss: 17.416 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5856380462646484
Epoch: 9, Steps: 4 | Train Loss: 0.130 Vali Loss: 13.793 Vali Acc: 0.480 Test Loss: 13.793 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5651614665985107
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.426 Vali Acc: 0.500 Test Loss: 12.426 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5883917808532715
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.183 Vali Acc: 0.480 Test Loss: 12.183 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5797033309936523
Epoch: 12, Steps: 4 | Train Loss: 0.072 Vali Loss: 9.783 Vali Acc: 0.440 Test Loss: 9.783 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5854036808013916
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 11.152 Vali Acc: 0.480 Test Loss: 11.152 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5776023864746094
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.120 Vali Acc: 0.420 Test Loss: 15.120 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.558392286300659
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 19.761 Vali Acc: 0.400 Test Loss: 19.761 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5879900455474854
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 19.245 Vali Acc: 0.380 Test Loss: 19.245 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1641787653
model size : 6270.83MB
2025-04-27 19:14:51.772907: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:14:51.792610: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781291.815486 1134655 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781291.822344 1134655 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:14:51.845369: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.465380907058716
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.485 Vali Acc: 0.420 Test Loss: 1.485 Test Acc: 0.420
Validation loss decreased (inf --> -0.419985).  Saving model ...
Epoch: 2 cost time: 2.624091148376465
Epoch: 2, Steps: 4 | Train Loss: 0.997 Vali Loss: 2.420 Vali Acc: 0.320 Test Loss: 2.420 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.561112880706787
Epoch: 3, Steps: 4 | Train Loss: 0.516 Vali Loss: 2.733 Vali Acc: 0.380 Test Loss: 2.733 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5890884399414062
Epoch: 4, Steps: 4 | Train Loss: 0.074 Vali Loss: 7.007 Vali Acc: 0.480 Test Loss: 7.007 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479930).  Saving model ...
Epoch: 5 cost time: 2.6553544998168945
Epoch: 5, Steps: 4 | Train Loss: 0.196 Vali Loss: 12.032 Vali Acc: 0.440 Test Loss: 12.032 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.560967206954956
Epoch: 6, Steps: 4 | Train Loss: 0.156 Vali Loss: 10.463 Vali Acc: 0.380 Test Loss: 10.463 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5767252445220947
Epoch: 7, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.404 Vali Acc: 0.400 Test Loss: 8.404 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.595405101776123
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.942 Vali Acc: 0.440 Test Loss: 6.942 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5948917865753174
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.820 Vali Acc: 0.460 Test Loss: 7.820 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5731749534606934
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.738 Vali Acc: 0.420 Test Loss: 8.738 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.562467336654663
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.884 Vali Acc: 0.460 Test Loss: 8.884 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.582563638687134
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.568 Vali Acc: 0.420 Test Loss: 8.568 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5790090560913086
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.329 Vali Acc: 0.420 Test Loss: 9.329 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.563739538192749
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.463 Vali Acc: 0.420 Test Loss: 9.463 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1638345221
model size : 6257.70MB
2025-04-27 19:17:11.583770: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:17:11.602622: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781431.624434 1141435 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781431.631112 1141435 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:17:11.653578: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.441086769104004
Epoch: 1, Steps: 4 | Train Loss: 1.480 Vali Loss: 1.528 Vali Acc: 0.360 Test Loss: 1.528 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 2.5519583225250244
Epoch: 2, Steps: 4 | Train Loss: 0.886 Vali Loss: 1.710 Vali Acc: 0.420 Test Loss: 1.710 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419983).  Saving model ...
Epoch: 3 cost time: 2.465588331222534
Epoch: 3, Steps: 4 | Train Loss: 0.307 Vali Loss: 2.030 Vali Acc: 0.460 Test Loss: 2.030 Test Acc: 0.460
Validation loss decreased (-0.419983 --> -0.459980).  Saving model ...
Epoch: 4 cost time: 2.4761149883270264
Epoch: 4, Steps: 4 | Train Loss: 0.085 Vali Loss: 3.879 Vali Acc: 0.480 Test Loss: 3.879 Test Acc: 0.480
Validation loss decreased (-0.459980 --> -0.479961).  Saving model ...
Epoch: 5 cost time: 2.4946889877319336
Epoch: 5, Steps: 4 | Train Loss: 0.219 Vali Loss: 3.020 Vali Acc: 0.540 Test Loss: 3.020 Test Acc: 0.540
Validation loss decreased (-0.479961 --> -0.539970).  Saving model ...
Epoch: 6 cost time: 2.484124183654785
Epoch: 6, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.970 Vali Acc: 0.660 Test Loss: 2.970 Test Acc: 0.660
Validation loss decreased (-0.539970 --> -0.659970).  Saving model ...
Epoch: 7 cost time: 2.490286350250244
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.038 Vali Acc: 0.560 Test Loss: 4.038 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.448946952819824
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.274 Vali Acc: 0.540 Test Loss: 5.274 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.439729690551758
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.173 Vali Acc: 0.540 Test Loss: 6.173 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.494664192199707
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.741 Vali Acc: 0.520 Test Loss: 4.741 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4655661582946777
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.453 Vali Acc: 0.580 Test Loss: 4.453 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4162654876708984
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.501 Vali Acc: 0.600 Test Loss: 3.501 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4657020568847656
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.415 Vali Acc: 0.540 Test Loss: 3.415 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4253809452056885
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.673 Vali Acc: 0.560 Test Loss: 3.673 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4364254474639893
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.083 Vali Acc: 0.540 Test Loss: 4.083 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.460679531097412
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.281 Vali Acc: 0.580 Test Loss: 4.281 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 1631460613
model size : 6231.44MB
2025-04-27 19:20:49.206694: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:20:49.225582: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781649.247361 1149562 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781649.254013 1149562 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:20:49.275969: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.318706512451172
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.573 Vali Acc: 0.360 Test Loss: 1.573 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 2.4731833934783936
Epoch: 2, Steps: 4 | Train Loss: 0.896 Vali Loss: 2.177 Vali Acc: 0.280 Test Loss: 2.177 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.434335947036743
Epoch: 3, Steps: 4 | Train Loss: 0.512 Vali Loss: 2.319 Vali Acc: 0.400 Test Loss: 2.319 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399977).  Saving model ...
Epoch: 4 cost time: 2.4574732780456543
Epoch: 4, Steps: 4 | Train Loss: 0.257 Vali Loss: 2.906 Vali Acc: 0.560 Test Loss: 2.906 Test Acc: 0.560
Validation loss decreased (-0.399977 --> -0.559971).  Saving model ...
Epoch: 5 cost time: 2.45668625831604
Epoch: 5, Steps: 4 | Train Loss: 1.703 Vali Loss: 4.839 Vali Acc: 0.420 Test Loss: 4.839 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4253392219543457
Epoch: 6, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.154 Vali Acc: 0.480 Test Loss: 6.154 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.410048007965088
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.468 Vali Acc: 0.300 Test Loss: 6.468 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4055726528167725
Epoch: 8, Steps: 4 | Train Loss: 0.054 Vali Loss: 5.624 Vali Acc: 0.440 Test Loss: 5.624 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4021687507629395
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 10.566 Vali Acc: 0.420 Test Loss: 10.566 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4053614139556885
Epoch: 10, Steps: 4 | Train Loss: 0.012 Vali Loss: 13.532 Vali Acc: 0.460 Test Loss: 13.532 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.387885332107544
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.696 Vali Acc: 0.460 Test Loss: 13.696 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.390974521636963
Epoch: 12, Steps: 4 | Train Loss: 0.069 Vali Loss: 8.660 Vali Acc: 0.440 Test Loss: 8.660 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.401470899581909
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.188 Vali Acc: 0.480 Test Loss: 9.188 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4065299034118652
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 12.341 Vali Acc: 0.460 Test Loss: 12.341 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1629740677
model size : 6224.88MB
2025-04-27 19:23:23.131219: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:23:23.150302: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781803.172595 1156440 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781803.179362 1156440 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:23:23.201985: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4133684635162354
Epoch: 1, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.479 Vali Acc: 0.340 Test Loss: 1.479 Test Acc: 0.340
Validation loss decreased (inf --> -0.339985).  Saving model ...
Epoch: 2 cost time: 2.4864742755889893
Epoch: 2, Steps: 4 | Train Loss: 1.480 Vali Loss: 1.664 Vali Acc: 0.480 Test Loss: 1.664 Test Acc: 0.480
Validation loss decreased (-0.339985 --> -0.479983).  Saving model ...
Epoch: 3 cost time: 2.4959096908569336
Epoch: 3, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.848 Vali Acc: 0.400 Test Loss: 1.848 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.45467472076416
Epoch: 4, Steps: 4 | Train Loss: 0.117 Vali Loss: 2.906 Vali Acc: 0.440 Test Loss: 2.906 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4586169719696045
Epoch: 5, Steps: 4 | Train Loss: 1.102 Vali Loss: 3.379 Vali Acc: 0.500 Test Loss: 3.379 Test Acc: 0.500
Validation loss decreased (-0.479983 --> -0.499966).  Saving model ...
Epoch: 6 cost time: 2.5966615676879883
Epoch: 6, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.073 Vali Acc: 0.460 Test Loss: 3.073 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5388522148132324
Epoch: 7, Steps: 4 | Train Loss: 0.017 Vali Loss: 3.414 Vali Acc: 0.440 Test Loss: 3.414 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.524782419204712
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.034 Vali Acc: 0.420 Test Loss: 4.034 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4977707862854004
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.269 Vali Acc: 0.460 Test Loss: 4.269 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4441795349121094
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.204 Vali Acc: 0.480 Test Loss: 4.204 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5210487842559814
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.543 Vali Acc: 0.480 Test Loss: 4.543 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.573871374130249
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.212 Vali Acc: 0.480 Test Loss: 4.212 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5497472286224365
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.496 Vali Acc: 0.480 Test Loss: 4.496 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.537712574005127
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.048 Vali Acc: 0.420 Test Loss: 5.048 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5306015014648438
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.599 Vali Acc: 0.420 Test Loss: 5.599 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1628020869
model size : 6218.32MB
2025-04-27 19:26:05.917898: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:26:05.937241: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745781965.959397 1163777 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745781965.966199 1163777 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:26:05.989740: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.12740159034729
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.518 Vali Acc: 0.320 Test Loss: 1.518 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 2.1387181282043457
Epoch: 2, Steps: 4 | Train Loss: 0.858 Vali Loss: 3.101 Vali Acc: 0.440 Test Loss: 3.101 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439969).  Saving model ...
Epoch: 3 cost time: 2.1838533878326416
Epoch: 3, Steps: 4 | Train Loss: 0.554 Vali Loss: 4.843 Vali Acc: 0.440 Test Loss: 4.843 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.105503797531128
Epoch: 4, Steps: 4 | Train Loss: 0.120 Vali Loss: 11.207 Vali Acc: 0.500 Test Loss: 11.207 Test Acc: 0.500
Validation loss decreased (-0.439969 --> -0.499888).  Saving model ...
Epoch: 5 cost time: 2.1455442905426025
Epoch: 5, Steps: 4 | Train Loss: 0.788 Vali Loss: 14.140 Vali Acc: 0.400 Test Loss: 14.140 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.06668758392334
Epoch: 6, Steps: 4 | Train Loss: 0.012 Vali Loss: 15.974 Vali Acc: 0.420 Test Loss: 15.974 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.094425916671753
Epoch: 7, Steps: 4 | Train Loss: 0.018 Vali Loss: 16.843 Vali Acc: 0.480 Test Loss: 16.843 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1004300117492676
Epoch: 8, Steps: 4 | Train Loss: 0.292 Vali Loss: 19.573 Vali Acc: 0.460 Test Loss: 19.573 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0976085662841797
Epoch: 9, Steps: 4 | Train Loss: 0.030 Vali Loss: 14.905 Vali Acc: 0.460 Test Loss: 14.905 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1245362758636475
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.123 Vali Acc: 0.380 Test Loss: 16.123 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1036038398742676
Epoch: 11, Steps: 4 | Train Loss: 0.261 Vali Loss: 15.216 Vali Acc: 0.480 Test Loss: 15.216 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0931568145751953
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 19.568 Vali Acc: 0.460 Test Loss: 19.568 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.109415292739868
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.414 Vali Acc: 0.420 Test Loss: 22.414 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.093332052230835
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 27.530 Vali Acc: 0.440 Test Loss: 27.530 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 784722949
model size : 2997.45MB
2025-04-27 19:27:52.247655: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:27:52.266890: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782072.288960 1170310 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782072.295747 1170310 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:27:52.318141: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.761665105819702
Epoch: 1, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.524 Vali Acc: 0.360 Test Loss: 1.524 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 1.8493247032165527
Epoch: 2, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.864 Vali Acc: 0.440 Test Loss: 1.864 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439981).  Saving model ...
Epoch: 3 cost time: 1.8415820598602295
Epoch: 3, Steps: 4 | Train Loss: 0.296 Vali Loss: 3.445 Vali Acc: 0.420 Test Loss: 3.445 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7833914756774902
Epoch: 4, Steps: 4 | Train Loss: 0.140 Vali Loss: 4.258 Vali Acc: 0.400 Test Loss: 4.258 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.77778959274292
Epoch: 5, Steps: 4 | Train Loss: 0.009 Vali Loss: 5.852 Vali Acc: 0.460 Test Loss: 5.852 Test Acc: 0.460
Validation loss decreased (-0.439981 --> -0.459941).  Saving model ...
Epoch: 6 cost time: 1.853973150253296
Epoch: 6, Steps: 4 | Train Loss: 0.054 Vali Loss: 5.727 Vali Acc: 0.460 Test Loss: 5.727 Test Acc: 0.460
Validation loss decreased (-0.459941 --> -0.459943).  Saving model ...
Epoch: 7 cost time: 1.8354923725128174
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.753 Vali Acc: 0.480 Test Loss: 4.753 Test Acc: 0.480
Validation loss decreased (-0.459943 --> -0.479952).  Saving model ...
Epoch: 8 cost time: 1.8082516193389893
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.380 Vali Acc: 0.420 Test Loss: 5.380 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7860023975372314
Epoch: 9, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.438 Vali Acc: 0.460 Test Loss: 5.438 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7836384773254395
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.127 Vali Acc: 0.420 Test Loss: 7.127 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7904341220855713
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.682 Vali Acc: 0.420 Test Loss: 8.682 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7717912197113037
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.019 Vali Acc: 0.440 Test Loss: 6.019 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.766916275024414
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.677 Vali Acc: 0.380 Test Loss: 5.677 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7728550434112549
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 7.517 Vali Acc: 0.500 Test Loss: 7.517 Test Acc: 0.500
Validation loss decreased (-0.479952 --> -0.499925).  Saving model ...
Epoch: 15 cost time: 1.84529709815979
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.014 Vali Acc: 0.360 Test Loss: 14.014 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7931475639343262
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 17.492 Vali Acc: 0.380 Test Loss: 17.492 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7779638767242432
Epoch: 17, Steps: 4 | Train Loss: 0.025 Vali Loss: 16.839 Vali Acc: 0.360 Test Loss: 16.839 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8107974529266357
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.139 Vali Acc: 0.300 Test Loss: 16.139 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7815790176391602
Epoch: 19, Steps: 4 | Train Loss: 0.023 Vali Loss: 8.749 Vali Acc: 0.380 Test Loss: 8.749 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7751357555389404
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.894 Vali Acc: 0.480 Test Loss: 5.894 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.817512035369873
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.437 Vali Acc: 0.440 Test Loss: 9.437 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7799599170684814
Epoch: 22, Steps: 4 | Train Loss: 0.221 Vali Loss: 9.369 Vali Acc: 0.460 Test Loss: 9.369 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7840077877044678
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.687 Vali Acc: 0.460 Test Loss: 14.687 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7786438465118408
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 19.275 Vali Acc: 0.420 Test Loss: 19.275 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 771811397
model size : 2948.19MB
2025-04-27 19:30:28.856163: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:30:28.875210: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782228.897632 1181229 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782228.904466 1181229 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:30:28.926992: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.613851547241211
Epoch: 1, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.606 Vali Acc: 0.340 Test Loss: 1.606 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.6857547760009766
Epoch: 2, Steps: 4 | Train Loss: 1.037 Vali Loss: 2.110 Vali Acc: 0.360 Test Loss: 2.110 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359979).  Saving model ...
Epoch: 3 cost time: 1.6855518817901611
Epoch: 3, Steps: 4 | Train Loss: 0.351 Vali Loss: 2.494 Vali Acc: 0.440 Test Loss: 2.494 Test Acc: 0.440
Validation loss decreased (-0.359979 --> -0.439975).  Saving model ...
Epoch: 4 cost time: 1.675419807434082
Epoch: 4, Steps: 4 | Train Loss: 0.099 Vali Loss: 3.978 Vali Acc: 0.420 Test Loss: 3.978 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6506803035736084
Epoch: 5, Steps: 4 | Train Loss: 0.114 Vali Loss: 4.577 Vali Acc: 0.380 Test Loss: 4.577 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6441352367401123
Epoch: 6, Steps: 4 | Train Loss: 0.068 Vali Loss: 5.869 Vali Acc: 0.460 Test Loss: 5.869 Test Acc: 0.460
Validation loss decreased (-0.439975 --> -0.459941).  Saving model ...
Epoch: 7 cost time: 1.71136474609375
Epoch: 7, Steps: 4 | Train Loss: 0.019 Vali Loss: 7.636 Vali Acc: 0.360 Test Loss: 7.636 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6623547077178955
Epoch: 8, Steps: 4 | Train Loss: 0.056 Vali Loss: 5.984 Vali Acc: 0.420 Test Loss: 5.984 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6768276691436768
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.592 Vali Acc: 0.340 Test Loss: 8.592 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6667706966400146
Epoch: 10, Steps: 4 | Train Loss: 0.006 Vali Loss: 8.406 Vali Acc: 0.400 Test Loss: 8.406 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6676878929138184
Epoch: 11, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.974 Vali Acc: 0.440 Test Loss: 7.974 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6588120460510254
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.441 Vali Acc: 0.440 Test Loss: 8.441 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6782422065734863
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 7.654 Vali Acc: 0.400 Test Loss: 7.654 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6746864318847656
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.026 Vali Acc: 0.400 Test Loss: 7.026 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6817913055419922
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.431 Vali Acc: 0.400 Test Loss: 7.431 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.685427188873291
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.635 Vali Acc: 0.380 Test Loss: 7.635 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 765786245
model size : 2925.21MB
2025-04-27 19:32:24.377571: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:32:24.397067: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782344.420414 1188647 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782344.427341 1188647 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:32:24.450842: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7030930519104004
Epoch: 1, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.625 Vali Acc: 0.260 Test Loss: 1.625 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.679469347000122
Epoch: 2, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.623 Vali Acc: 0.460 Test Loss: 1.623 Test Acc: 0.460
Validation loss decreased (-0.259984 --> -0.459984).  Saving model ...
Epoch: 3 cost time: 1.651799201965332
Epoch: 3, Steps: 4 | Train Loss: 0.319 Vali Loss: 2.649 Vali Acc: 0.440 Test Loss: 2.649 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6546247005462646
Epoch: 4, Steps: 4 | Train Loss: 0.112 Vali Loss: 3.045 Vali Acc: 0.460 Test Loss: 3.045 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6456000804901123
Epoch: 5, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.088 Vali Acc: 0.500 Test Loss: 4.088 Test Acc: 0.500
Validation loss decreased (-0.459984 --> -0.499959).  Saving model ...
Epoch: 6 cost time: 1.6791291236877441
Epoch: 6, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.333 Vali Acc: 0.460 Test Loss: 5.333 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6628913879394531
Epoch: 7, Steps: 4 | Train Loss: 0.018 Vali Loss: 4.500 Vali Acc: 0.460 Test Loss: 4.500 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6878077983856201
Epoch: 8, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.023 Vali Acc: 0.460 Test Loss: 5.023 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.657114028930664
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.180 Vali Acc: 0.500 Test Loss: 5.180 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6285769939422607
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.220 Vali Acc: 0.540 Test Loss: 6.220 Test Acc: 0.540
Validation loss decreased (-0.499959 --> -0.539938).  Saving model ...
Epoch: 11 cost time: 1.651087999343872
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.990 Vali Acc: 0.500 Test Loss: 6.990 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6133842468261719
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.243 Vali Acc: 0.480 Test Loss: 7.243 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.619469404220581
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.723 Vali Acc: 0.480 Test Loss: 7.723 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6250429153442383
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.969 Vali Acc: 0.460 Test Loss: 7.969 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6189045906066895
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.752 Vali Acc: 0.460 Test Loss: 7.752 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.611753225326538
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.028 Vali Acc: 0.460 Test Loss: 8.028 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6188867092132568
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.265 Vali Acc: 0.460 Test Loss: 8.265 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6171302795410156
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.394 Vali Acc: 0.500 Test Loss: 8.394 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6437788009643555
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.466 Vali Acc: 0.500 Test Loss: 8.466 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6343724727630615
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.066 Vali Acc: 0.480 Test Loss: 8.066 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 764065029
model size : 2918.64MB
2025-04-27 19:34:27.632664: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:34:27.651998: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782467.674652 1197728 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782467.681595 1197728 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:34:27.704394: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7118964195251465
Epoch: 1, Steps: 4 | Train Loss: 1.709 Vali Loss: 1.629 Vali Acc: 0.300 Test Loss: 1.629 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.6878612041473389
Epoch: 2, Steps: 4 | Train Loss: 1.245 Vali Loss: 1.502 Vali Acc: 0.440 Test Loss: 1.502 Test Acc: 0.440
Validation loss decreased (-0.299984 --> -0.439985).  Saving model ...
Epoch: 3 cost time: 1.6678452491760254
Epoch: 3, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.864 Vali Acc: 0.480 Test Loss: 1.864 Test Acc: 0.480
Validation loss decreased (-0.439985 --> -0.479981).  Saving model ...
Epoch: 4 cost time: 1.6706221103668213
Epoch: 4, Steps: 4 | Train Loss: 0.188 Vali Loss: 2.425 Vali Acc: 0.500 Test Loss: 2.425 Test Acc: 0.500
Validation loss decreased (-0.479981 --> -0.499976).  Saving model ...
Epoch: 5 cost time: 1.6545674800872803
Epoch: 5, Steps: 4 | Train Loss: 0.051 Vali Loss: 3.112 Vali Acc: 0.460 Test Loss: 3.112 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6334679126739502
Epoch: 6, Steps: 4 | Train Loss: 1.432 Vali Loss: 3.190 Vali Acc: 0.500 Test Loss: 3.190 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6414439678192139
Epoch: 7, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.070 Vali Acc: 0.500 Test Loss: 3.070 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6244888305664062
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.336 Vali Acc: 0.480 Test Loss: 3.336 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.636336326599121
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.504 Vali Acc: 0.420 Test Loss: 3.504 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6422290802001953
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.661 Vali Acc: 0.420 Test Loss: 3.661 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6413004398345947
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.785 Vali Acc: 0.420 Test Loss: 3.785 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6212811470031738
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.617 Vali Acc: 0.460 Test Loss: 3.617 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6318082809448242
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.363 Vali Acc: 0.480 Test Loss: 3.363 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6401116847991943
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.235 Vali Acc: 0.460 Test Loss: 3.235 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 760622725
model size : 2905.51MB
2025-04-27 19:36:08.666961: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:36:08.686417: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782568.708774 1204239 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782568.715548 1204239 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:36:08.738429: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5791306495666504
Epoch: 1, Steps: 4 | Train Loss: 1.614 Vali Loss: 1.456 Vali Acc: 0.380 Test Loss: 1.456 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 1.6468210220336914
Epoch: 2, Steps: 4 | Train Loss: 1.154 Vali Loss: 1.419 Vali Acc: 0.380 Test Loss: 1.419 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 1.6816351413726807
Epoch: 3, Steps: 4 | Train Loss: 0.437 Vali Loss: 1.778 Vali Acc: 0.460 Test Loss: 1.778 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459982).  Saving model ...
Epoch: 4 cost time: 1.6662986278533936
Epoch: 4, Steps: 4 | Train Loss: 0.140 Vali Loss: 2.275 Vali Acc: 0.480 Test Loss: 2.275 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479977).  Saving model ...
Epoch: 5 cost time: 1.6610536575317383
Epoch: 5, Steps: 4 | Train Loss: 0.058 Vali Loss: 2.799 Vali Acc: 0.460 Test Loss: 2.799 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6497535705566406
Epoch: 6, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.189 Vali Acc: 0.520 Test Loss: 3.189 Test Acc: 0.520
Validation loss decreased (-0.479977 --> -0.519968).  Saving model ...
Epoch: 7 cost time: 1.706383228302002
Epoch: 7, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.536 Vali Acc: 0.500 Test Loss: 3.536 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6463489532470703
Epoch: 8, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.316 Vali Acc: 0.520 Test Loss: 3.316 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6133244037628174
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.984 Vali Acc: 0.440 Test Loss: 3.984 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6326630115509033
Epoch: 10, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.988 Vali Acc: 0.520 Test Loss: 3.988 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6453769207000732
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.083 Vali Acc: 0.460 Test Loss: 4.083 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6116321086883545
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.243 Vali Acc: 0.480 Test Loss: 4.243 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6113505363464355
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.329 Vali Acc: 0.420 Test Loss: 4.329 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6249809265136719
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.266 Vali Acc: 0.420 Test Loss: 4.266 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6365711688995361
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.299 Vali Acc: 0.440 Test Loss: 4.299 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.616401195526123
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.213 Vali Acc: 0.500 Test Loss: 4.213 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 759762757
model size : 2902.23MB
2025-04-27 19:38:06.384030: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:38:06.403751: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782686.426015 1211681 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782686.432787 1211681 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:38:06.455939: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5970332622528076
Epoch: 1, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.544 Vali Acc: 0.320 Test Loss: 1.544 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.6649820804595947
Epoch: 2, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.502 Vali Acc: 0.300 Test Loss: 1.502 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6159958839416504
Epoch: 3, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.603 Vali Acc: 0.540 Test Loss: 1.603 Test Acc: 0.540
Validation loss decreased (-0.319985 --> -0.539984).  Saving model ...
Epoch: 4 cost time: 1.6445701122283936
Epoch: 4, Steps: 4 | Train Loss: 0.194 Vali Loss: 2.177 Vali Acc: 0.500 Test Loss: 2.177 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6145005226135254
Epoch: 5, Steps: 4 | Train Loss: 0.124 Vali Loss: 2.351 Vali Acc: 0.500 Test Loss: 2.351 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6512219905853271
Epoch: 6, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.223 Vali Acc: 0.480 Test Loss: 2.223 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6343300342559814
Epoch: 7, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.834 Vali Acc: 0.500 Test Loss: 2.834 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6243829727172852
Epoch: 8, Steps: 4 | Train Loss: 0.020 Vali Loss: 3.022 Vali Acc: 0.480 Test Loss: 3.022 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6373193264007568
Epoch: 9, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.912 Vali Acc: 0.480 Test Loss: 2.912 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6458055973052979
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.788 Vali Acc: 0.440 Test Loss: 3.788 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6267971992492676
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.326 Vali Acc: 0.400 Test Loss: 4.326 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6489498615264893
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.319 Vali Acc: 0.440 Test Loss: 4.319 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6557962894439697
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.525 Vali Acc: 0.440 Test Loss: 4.525 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 758902853
model size : 2898.95MB
2025-04-27 19:39:25.731073: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:39:25.750829: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782765.773180 1217642 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782765.780016 1217642 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:39:25.803042: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4445011615753174
Epoch: 1, Steps: 4 | Train Loss: 1.564 Vali Loss: 1.654 Vali Acc: 0.360 Test Loss: 1.654 Test Acc: 0.360
Validation loss decreased (inf --> -0.359983).  Saving model ...
Epoch: 2 cost time: 1.5513036251068115
Epoch: 2, Steps: 4 | Train Loss: 0.901 Vali Loss: 2.684 Vali Acc: 0.400 Test Loss: 2.684 Test Acc: 0.400
Validation loss decreased (-0.359983 --> -0.399973).  Saving model ...
Epoch: 3 cost time: 1.5474326610565186
Epoch: 3, Steps: 4 | Train Loss: 0.344 Vali Loss: 3.258 Vali Acc: 0.380 Test Loss: 3.258 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4769835472106934
Epoch: 4, Steps: 4 | Train Loss: 0.742 Vali Loss: 6.157 Vali Acc: 0.460 Test Loss: 6.157 Test Acc: 0.460
Validation loss decreased (-0.399973 --> -0.459938).  Saving model ...
Epoch: 5 cost time: 1.5502469539642334
Epoch: 5, Steps: 4 | Train Loss: 0.142 Vali Loss: 9.013 Vali Acc: 0.460 Test Loss: 9.013 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4908356666564941
Epoch: 6, Steps: 4 | Train Loss: 0.368 Vali Loss: 7.855 Vali Acc: 0.380 Test Loss: 7.855 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.48972487449646
Epoch: 7, Steps: 4 | Train Loss: 0.025 Vali Loss: 7.163 Vali Acc: 0.420 Test Loss: 7.163 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5299732685089111
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.303 Vali Acc: 0.420 Test Loss: 7.303 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4947471618652344
Epoch: 9, Steps: 4 | Train Loss: 0.093 Vali Loss: 8.517 Vali Acc: 0.480 Test Loss: 8.517 Test Acc: 0.480
Validation loss decreased (-0.459938 --> -0.479915).  Saving model ...
Epoch: 10 cost time: 1.5211694240570068
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.154 Vali Acc: 0.480 Test Loss: 10.154 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5050814151763916
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 12.426 Vali Acc: 0.380 Test Loss: 12.426 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.486633062362671
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 12.690 Vali Acc: 0.460 Test Loss: 12.690 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5061638355255127
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.340 Vali Acc: 0.420 Test Loss: 13.340 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5256295204162598
Epoch: 14, Steps: 4 | Train Loss: 0.022 Vali Loss: 12.656 Vali Acc: 0.400 Test Loss: 12.656 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.517392873764038
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.236 Vali Acc: 0.440 Test Loss: 11.236 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4761686325073242
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.078 Vali Acc: 0.460 Test Loss: 11.078 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4716222286224365
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.320 Vali Acc: 0.480 Test Loss: 11.320 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4924345016479492
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 12.593 Vali Acc: 0.480 Test Loss: 12.593 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4724719524383545
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 13.248 Vali Acc: 0.460 Test Loss: 13.248 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 378584581
model size : 1446.18MB
2025-04-27 19:40:57.986317: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:40:58.005246: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782858.027516 1226112 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782858.034253 1226112 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:40:58.056739: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.269665479660034
Epoch: 1, Steps: 4 | Train Loss: 1.531 Vali Loss: 1.579 Vali Acc: 0.340 Test Loss: 1.579 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.3253724575042725
Epoch: 2, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.796 Vali Acc: 0.500 Test Loss: 1.796 Test Acc: 0.500
Validation loss decreased (-0.339984 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 1.337360143661499
Epoch: 3, Steps: 4 | Train Loss: 0.283 Vali Loss: 2.594 Vali Acc: 0.520 Test Loss: 2.594 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519974).  Saving model ...
Epoch: 4 cost time: 1.3429982662200928
Epoch: 4, Steps: 4 | Train Loss: 0.240 Vali Loss: 2.691 Vali Acc: 0.460 Test Loss: 2.691 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.168503761291504
Epoch: 5, Steps: 4 | Train Loss: 0.076 Vali Loss: 3.987 Vali Acc: 0.500 Test Loss: 3.987 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3026998043060303
Epoch: 6, Steps: 4 | Train Loss: 0.109 Vali Loss: 5.095 Vali Acc: 0.480 Test Loss: 5.095 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2985167503356934
Epoch: 7, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.240 Vali Acc: 0.440 Test Loss: 5.240 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3192188739776611
Epoch: 8, Steps: 4 | Train Loss: 0.042 Vali Loss: 5.695 Vali Acc: 0.420 Test Loss: 5.695 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2832036018371582
Epoch: 9, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.050 Vali Acc: 0.500 Test Loss: 5.050 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2787792682647705
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.498 Vali Acc: 0.580 Test Loss: 5.498 Test Acc: 0.580
Validation loss decreased (-0.519974 --> -0.579945).  Saving model ...
Epoch: 11 cost time: 1.3351402282714844
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.902 Vali Acc: 0.560 Test Loss: 5.902 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2914433479309082
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.342 Vali Acc: 0.560 Test Loss: 5.342 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2794811725616455
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.791 Vali Acc: 0.560 Test Loss: 5.791 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2986173629760742
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.184 Vali Acc: 0.540 Test Loss: 6.184 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3285558223724365
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.055 Vali Acc: 0.540 Test Loss: 6.055 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2976975440979004
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.076 Vali Acc: 0.520 Test Loss: 6.076 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2858545780181885
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.817 Vali Acc: 0.520 Test Loss: 5.817 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2883801460266113
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.129 Vali Acc: 0.500 Test Loss: 6.129 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.329763650894165
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.258 Vali Acc: 0.500 Test Loss: 6.258 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2922649383544922
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.781 Vali Acc: 0.500 Test Loss: 5.781 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 372128805
model size : 1421.55MB
2025-04-27 19:42:24.163874: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:42:24.183821: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745782944.206056 1234930 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745782944.212859 1234930 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:42:24.235567: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1743640899658203
Epoch: 1, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.575 Vali Acc: 0.300 Test Loss: 1.575 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.2450826168060303
Epoch: 2, Steps: 4 | Train Loss: 0.979 Vali Loss: 1.892 Vali Acc: 0.320 Test Loss: 1.892 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319981).  Saving model ...
Epoch: 3 cost time: 1.3345060348510742
Epoch: 3, Steps: 4 | Train Loss: 0.372 Vali Loss: 2.420 Vali Acc: 0.280 Test Loss: 2.420 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.093170166015625
Epoch: 4, Steps: 4 | Train Loss: 0.135 Vali Loss: 2.765 Vali Acc: 0.400 Test Loss: 2.765 Test Acc: 0.400
Validation loss decreased (-0.319981 --> -0.399972).  Saving model ...
Epoch: 5 cost time: 1.23398756980896
Epoch: 5, Steps: 4 | Train Loss: 0.151 Vali Loss: 3.104 Vali Acc: 0.380 Test Loss: 3.104 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2130186557769775
Epoch: 6, Steps: 4 | Train Loss: 0.021 Vali Loss: 3.212 Vali Acc: 0.380 Test Loss: 3.212 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.220590353012085
Epoch: 7, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.916 Vali Acc: 0.400 Test Loss: 4.916 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2096607685089111
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.042 Vali Acc: 0.400 Test Loss: 6.042 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1958503723144531
Epoch: 9, Steps: 4 | Train Loss: 0.006 Vali Loss: 5.973 Vali Acc: 0.400 Test Loss: 5.973 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2131216526031494
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.902 Vali Acc: 0.480 Test Loss: 4.902 Test Acc: 0.480
Validation loss decreased (-0.399972 --> -0.479951).  Saving model ...
Epoch: 11 cost time: 1.2455816268920898
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.180 Vali Acc: 0.420 Test Loss: 5.180 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2372419834136963
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 5.730 Vali Acc: 0.380 Test Loss: 5.730 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2190065383911133
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.370 Vali Acc: 0.420 Test Loss: 6.370 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2116458415985107
Epoch: 14, Steps: 4 | Train Loss: 0.070 Vali Loss: 6.493 Vali Acc: 0.400 Test Loss: 6.493 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.232318639755249
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 9.765 Vali Acc: 0.300 Test Loss: 9.765 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2443702220916748
Epoch: 16, Steps: 4 | Train Loss: 0.031 Vali Loss: 9.218 Vali Acc: 0.420 Test Loss: 9.218 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2204101085662842
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.436 Vali Acc: 0.360 Test Loss: 10.436 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2173371315002441
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 10.898 Vali Acc: 0.320 Test Loss: 10.898 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.21336030960083
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 10.672 Vali Acc: 0.320 Test Loss: 10.672 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2174615859985352
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 9.666 Vali Acc: 0.360 Test Loss: 9.666 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 369116229
model size : 1410.06MB
2025-04-27 19:43:46.758878: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:43:46.778008: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783026.799858 1243728 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783026.806564 1243728 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:43:46.828903: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.055467367172241
Epoch: 1, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.584 Vali Acc: 0.340 Test Loss: 1.584 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.227879524230957
Epoch: 2, Steps: 4 | Train Loss: 1.253 Vali Loss: 1.606 Vali Acc: 0.320 Test Loss: 1.606 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.182145357131958
Epoch: 3, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.883 Vali Acc: 0.480 Test Loss: 1.883 Test Acc: 0.480
Validation loss decreased (-0.339984 --> -0.479981).  Saving model ...
Epoch: 4 cost time: 1.2429187297821045
Epoch: 4, Steps: 4 | Train Loss: 0.148 Vali Loss: 2.757 Vali Acc: 0.480 Test Loss: 2.757 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1834690570831299
Epoch: 5, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.372 Vali Acc: 0.500 Test Loss: 2.372 Test Acc: 0.500
Validation loss decreased (-0.479981 --> -0.499976).  Saving model ...
Epoch: 6 cost time: 1.2211236953735352
Epoch: 6, Steps: 4 | Train Loss: 0.079 Vali Loss: 3.615 Vali Acc: 0.480 Test Loss: 3.615 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.206294059753418
Epoch: 7, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.162 Vali Acc: 0.460 Test Loss: 4.162 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1735835075378418
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.551 Vali Acc: 0.480 Test Loss: 4.551 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1890475749969482
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.701 Vali Acc: 0.460 Test Loss: 4.701 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.222076416015625
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.930 Vali Acc: 0.480 Test Loss: 4.930 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.197357177734375
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 5.673 Vali Acc: 0.420 Test Loss: 5.673 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1746861934661865
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.066 Vali Acc: 0.420 Test Loss: 6.066 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1818864345550537
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.244 Vali Acc: 0.440 Test Loss: 6.244 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.200568437576294
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.693 Vali Acc: 0.400 Test Loss: 5.693 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2128984928131104
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.350 Vali Acc: 0.440 Test Loss: 5.350 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 368255621
model size : 1406.78MB
2025-04-27 19:44:51.263247: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:44:51.282350: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783091.304381 1250385 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783091.311148 1250385 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:44:51.333808: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1402008533477783
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.579 Vali Acc: 0.340 Test Loss: 1.579 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.2240476608276367
Epoch: 2, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.550 Vali Acc: 0.400 Test Loss: 1.550 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 1.2177479267120361
Epoch: 3, Steps: 4 | Train Loss: 0.532 Vali Loss: 1.508 Vali Acc: 0.460 Test Loss: 1.508 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459985).  Saving model ...
Epoch: 4 cost time: 1.2086100578308105
Epoch: 4, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.797 Vali Acc: 0.540 Test Loss: 1.797 Test Acc: 0.540
Validation loss decreased (-0.459985 --> -0.539982).  Saving model ...
Epoch: 5 cost time: 1.2051854133605957
Epoch: 5, Steps: 4 | Train Loss: 0.125 Vali Loss: 2.645 Vali Acc: 0.500 Test Loss: 2.645 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1703896522521973
Epoch: 6, Steps: 4 | Train Loss: 0.126 Vali Loss: 2.601 Vali Acc: 0.560 Test Loss: 2.601 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559974).  Saving model ...
Epoch: 7 cost time: 1.2295029163360596
Epoch: 7, Steps: 4 | Train Loss: 0.037 Vali Loss: 2.595 Vali Acc: 0.540 Test Loss: 2.595 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1774182319641113
Epoch: 8, Steps: 4 | Train Loss: 0.096 Vali Loss: 2.692 Vali Acc: 0.520 Test Loss: 2.692 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.17228102684021
Epoch: 9, Steps: 4 | Train Loss: 0.101 Vali Loss: 3.296 Vali Acc: 0.520 Test Loss: 3.296 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1927318572998047
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.549 Vali Acc: 0.480 Test Loss: 3.549 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.153787612915039
Epoch: 11, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.832 Vali Acc: 0.500 Test Loss: 3.832 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.186347246170044
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.196 Vali Acc: 0.540 Test Loss: 3.196 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1765670776367188
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.979 Vali Acc: 0.520 Test Loss: 2.979 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1395514011383057
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.102 Vali Acc: 0.520 Test Loss: 3.102 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1552984714508057
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.350 Vali Acc: 0.480 Test Loss: 3.350 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1394085884094238
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.547 Vali Acc: 0.480 Test Loss: 3.547 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 366534469
model size : 1400.21MB
2025-04-27 19:46:03.946693: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:46:03.965821: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783163.988220 1257502 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783163.995196 1257502 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:46:04.017921: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.133666515350342
Epoch: 1, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.584 Vali Acc: 0.280 Test Loss: 1.584 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1972575187683105
Epoch: 2, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.431 Vali Acc: 0.380 Test Loss: 1.431 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 1.1918621063232422
Epoch: 3, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.430 Vali Acc: 0.460 Test Loss: 1.430 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459986).  Saving model ...
Epoch: 4 cost time: 1.2070202827453613
Epoch: 4, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.640 Vali Acc: 0.500 Test Loss: 1.640 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 1.199324131011963
Epoch: 5, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.582 Vali Acc: 0.580 Test Loss: 1.582 Test Acc: 0.580
Validation loss decreased (-0.499984 --> -0.579984).  Saving model ...
Epoch: 6 cost time: 1.1824820041656494
Epoch: 6, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.807 Vali Acc: 0.480 Test Loss: 1.807 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2660300731658936
Epoch: 7, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.195 Vali Acc: 0.480 Test Loss: 2.195 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.207193374633789
Epoch: 8, Steps: 4 | Train Loss: 0.038 Vali Loss: 2.237 Vali Acc: 0.500 Test Loss: 2.237 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1503591537475586
Epoch: 9, Steps: 4 | Train Loss: 0.138 Vali Loss: 2.050 Vali Acc: 0.540 Test Loss: 2.050 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2059073448181152
Epoch: 10, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.066 Vali Acc: 0.480 Test Loss: 2.066 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1689825057983398
Epoch: 11, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.363 Vali Acc: 0.440 Test Loss: 2.363 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1637887954711914
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.700 Vali Acc: 0.420 Test Loss: 2.700 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1698358058929443
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.504 Vali Acc: 0.400 Test Loss: 2.504 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1730077266693115
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.567 Vali Acc: 0.400 Test Loss: 2.567 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1545937061309814
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.486 Vali Acc: 0.420 Test Loss: 2.486 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 366104485
model size : 1398.57MB
2025-04-27 19:47:17.245972: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:47:17.265894: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783237.288219 1264231 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783237.295204 1264231 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:47:17.318696: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.052698850631714
Epoch: 1, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.561 Vali Acc: 0.320 Test Loss: 1.561 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 1.2138090133666992
Epoch: 2, Steps: 4 | Train Loss: 1.245 Vali Loss: 1.425 Vali Acc: 0.360 Test Loss: 1.425 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359986).  Saving model ...
Epoch: 3 cost time: 1.199657917022705
Epoch: 3, Steps: 4 | Train Loss: 0.593 Vali Loss: 1.524 Vali Acc: 0.440 Test Loss: 1.524 Test Acc: 0.440
Validation loss decreased (-0.359986 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 1.1946232318878174
Epoch: 4, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.818 Vali Acc: 0.560 Test Loss: 1.818 Test Acc: 0.560
Validation loss decreased (-0.439985 --> -0.559982).  Saving model ...
Epoch: 5 cost time: 1.1964561939239502
Epoch: 5, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.913 Vali Acc: 0.560 Test Loss: 1.913 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.231898546218872
Epoch: 6, Steps: 4 | Train Loss: 0.083 Vali Loss: 2.171 Vali Acc: 0.520 Test Loss: 2.171 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1509745121002197
Epoch: 7, Steps: 4 | Train Loss: 0.059 Vali Loss: 2.488 Vali Acc: 0.500 Test Loss: 2.488 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.146573543548584
Epoch: 8, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.920 Vali Acc: 0.500 Test Loss: 2.920 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1679956912994385
Epoch: 9, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.198 Vali Acc: 0.500 Test Loss: 3.198 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1376910209655762
Epoch: 10, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.400 Vali Acc: 0.500 Test Loss: 3.400 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1486103534698486
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.526 Vali Acc: 0.520 Test Loss: 3.526 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1295247077941895
Epoch: 12, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.476 Vali Acc: 0.500 Test Loss: 3.476 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1278026103973389
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.278 Vali Acc: 0.540 Test Loss: 3.278 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1677608489990234
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 3.334 Vali Acc: 0.580 Test Loss: 3.334 Test Acc: 0.580
Validation loss decreased (-0.559982 --> -0.579967).  Saving model ...
Epoch: 15 cost time: 1.1927564144134521
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.371 Vali Acc: 0.480 Test Loss: 3.371 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1359920501708984
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.516 Vali Acc: 0.460 Test Loss: 3.516 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1561172008514404
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.313 Vali Acc: 0.540 Test Loss: 3.313 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.180222511291504
Epoch: 18, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.831 Vali Acc: 0.500 Test Loss: 2.831 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1428844928741455
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.392 Vali Acc: 0.380 Test Loss: 3.392 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.148991584777832
Epoch: 20, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.257 Vali Acc: 0.500 Test Loss: 3.257 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1528606414794922
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.884 Vali Acc: 0.460 Test Loss: 3.884 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1249382495880127
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.048 Vali Acc: 0.440 Test Loss: 4.048 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1555917263031006
Epoch: 23, Steps: 4 | Train Loss: 0.313 Vali Loss: 3.355 Vali Acc: 0.480 Test Loss: 3.355 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.156447172164917
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.780 Vali Acc: 0.420 Test Loss: 3.780 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 365674533
model size : 1396.93MB
2025-04-27 19:48:51.237591: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:48:51.257016: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783331.279623 1274716 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783331.286510 1274716 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:48:51.309019: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.819998025894165
Epoch: 1, Steps: 4 | Train Loss: 1.560 Vali Loss: 1.584 Vali Acc: 0.380 Test Loss: 1.584 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 2.7158119678497314
Epoch: 2, Steps: 4 | Train Loss: 1.056 Vali Loss: 35.726 Vali Acc: 0.360 Test Loss: 35.726 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.675812005996704
Epoch: 3, Steps: 4 | Train Loss: 6.419 Vali Loss: 43.639 Vali Acc: 0.440 Test Loss: 43.639 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439564).  Saving model ...
Epoch: 4 cost time: 2.7587108612060547
Epoch: 4, Steps: 4 | Train Loss: 1.314 Vali Loss: 167.607 Vali Acc: 0.280 Test Loss: 167.607 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6955816745758057
Epoch: 5, Steps: 4 | Train Loss: 19.749 Vali Loss: 121.794 Vali Acc: 0.480 Test Loss: 121.794 Test Acc: 0.480
Validation loss decreased (-0.439564 --> -0.478782).  Saving model ...
Epoch: 6 cost time: 2.7551403045654297
Epoch: 6, Steps: 4 | Train Loss: 2.329 Vali Loss: 186.269 Vali Acc: 0.440 Test Loss: 186.269 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.676098585128784
Epoch: 7, Steps: 4 | Train Loss: 5.883 Vali Loss: 190.367 Vali Acc: 0.460 Test Loss: 190.367 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6838722229003906
Epoch: 8, Steps: 4 | Train Loss: 1.044 Vali Loss: 169.542 Vali Acc: 0.400 Test Loss: 169.542 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.730943202972412
Epoch: 9, Steps: 4 | Train Loss: 0.086 Vali Loss: 244.646 Vali Acc: 0.340 Test Loss: 244.646 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6950716972351074
Epoch: 10, Steps: 4 | Train Loss: 5.140 Vali Loss: 295.685 Vali Acc: 0.300 Test Loss: 295.685 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.667426109313965
Epoch: 11, Steps: 4 | Train Loss: 6.975 Vali Loss: 284.051 Vali Acc: 0.300 Test Loss: 284.051 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.666684865951538
Epoch: 12, Steps: 4 | Train Loss: 1.494 Vali Loss: 287.670 Vali Acc: 0.400 Test Loss: 287.670 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.680943250656128
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 424.510 Vali Acc: 0.460 Test Loss: 424.510 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.685472249984741
Epoch: 14, Steps: 4 | Train Loss: 4.321 Vali Loss: 404.278 Vali Acc: 0.400 Test Loss: 404.278 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7010433673858643
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 311.982 Vali Acc: 0.400 Test Loss: 311.982 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1226815237
model size : 4685.20MB
2025-04-27 19:51:15.896648: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:51:15.915763: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783475.937835 1281940 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783475.944565 1281940 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:51:15.967133: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1777117252349854
Epoch: 1, Steps: 4 | Train Loss: 1.486 Vali Loss: 1.438 Vali Acc: 0.360 Test Loss: 1.438 Test Acc: 0.360
Validation loss decreased (inf --> -0.359986).  Saving model ...
Epoch: 2 cost time: 2.3114840984344482
Epoch: 2, Steps: 4 | Train Loss: 0.987 Vali Loss: 7.980 Vali Acc: 0.440 Test Loss: 7.980 Test Acc: 0.440
Validation loss decreased (-0.359986 --> -0.439920).  Saving model ...
Epoch: 3 cost time: 2.3336570262908936
Epoch: 3, Steps: 4 | Train Loss: 0.001 Vali Loss: 20.255 Vali Acc: 0.520 Test Loss: 20.255 Test Acc: 0.520
Validation loss decreased (-0.439920 --> -0.519797).  Saving model ...
Epoch: 4 cost time: 2.305649518966675
Epoch: 4, Steps: 4 | Train Loss: 0.000 Vali Loss: 31.312 Vali Acc: 0.540 Test Loss: 31.312 Test Acc: 0.540
Validation loss decreased (-0.519797 --> -0.539687).  Saving model ...
Epoch: 5 cost time: 2.358656406402588
Epoch: 5, Steps: 4 | Train Loss: 0.000 Vali Loss: 43.798 Vali Acc: 0.480 Test Loss: 43.798 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.284731149673462
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 54.342 Vali Acc: 0.480 Test Loss: 54.342 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.282680034637451
Epoch: 7, Steps: 4 | Train Loss: 0.197 Vali Loss: 64.963 Vali Acc: 0.420 Test Loss: 64.963 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2756881713867188
Epoch: 8, Steps: 4 | Train Loss: 3.650 Vali Loss: 58.292 Vali Acc: 0.420 Test Loss: 58.292 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2805464267730713
Epoch: 9, Steps: 4 | Train Loss: 1.357 Vali Loss: 98.239 Vali Acc: 0.400 Test Loss: 98.239 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2676801681518555
Epoch: 10, Steps: 4 | Train Loss: 15.874 Vali Loss: 95.838 Vali Acc: 0.340 Test Loss: 95.838 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2807247638702393
Epoch: 11, Steps: 4 | Train Loss: 1.667 Vali Loss: 87.754 Vali Acc: 0.400 Test Loss: 87.754 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3116350173950195
Epoch: 12, Steps: 4 | Train Loss: 1.310 Vali Loss: 126.441 Vali Acc: 0.380 Test Loss: 126.441 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.290616512298584
Epoch: 13, Steps: 4 | Train Loss: 5.646 Vali Loss: 85.002 Vali Acc: 0.380 Test Loss: 85.002 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.294985055923462
Epoch: 14, Steps: 4 | Train Loss: 1.576 Vali Loss: 244.395 Vali Acc: 0.340 Test Loss: 244.395 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1176890629
model size : 4494.75MB
2025-04-27 19:53:36.475397: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:53:36.494611: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783616.516809 1288732 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783616.523610 1288732 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:53:36.546399: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9797544479370117
Epoch: 1, Steps: 4 | Train Loss: 1.767 Vali Loss: 1.722 Vali Acc: 0.380 Test Loss: 1.722 Test Acc: 0.380
Validation loss decreased (inf --> -0.379983).  Saving model ...
Epoch: 2 cost time: 2.0627574920654297
Epoch: 2, Steps: 4 | Train Loss: 1.608 Vali Loss: 5.696 Vali Acc: 0.440 Test Loss: 5.696 Test Acc: 0.440
Validation loss decreased (-0.379983 --> -0.439943).  Saving model ...
Epoch: 3 cost time: 2.071013927459717
Epoch: 3, Steps: 4 | Train Loss: 6.389 Vali Loss: 21.930 Vali Acc: 0.420 Test Loss: 21.930 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.289213180541992
Epoch: 4, Steps: 4 | Train Loss: 0.733 Vali Loss: 26.290 Vali Acc: 0.380 Test Loss: 26.290 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.030665874481201
Epoch: 5, Steps: 4 | Train Loss: 0.429 Vali Loss: 46.165 Vali Acc: 0.380 Test Loss: 46.165 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.023009777069092
Epoch: 6, Steps: 4 | Train Loss: 1.801 Vali Loss: 73.244 Vali Acc: 0.360 Test Loss: 73.244 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.029264211654663
Epoch: 7, Steps: 4 | Train Loss: 0.967 Vali Loss: 80.858 Vali Acc: 0.480 Test Loss: 80.858 Test Acc: 0.480
Validation loss decreased (-0.439943 --> -0.479191).  Saving model ...
Epoch: 8 cost time: 2.0569615364074707
Epoch: 8, Steps: 4 | Train Loss: 0.152 Vali Loss: 73.024 Vali Acc: 0.300 Test Loss: 73.024 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.024137020111084
Epoch: 9, Steps: 4 | Train Loss: 1.573 Vali Loss: 74.655 Vali Acc: 0.260 Test Loss: 74.655 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.039090871810913
Epoch: 10, Steps: 4 | Train Loss: 0.206 Vali Loss: 71.133 Vali Acc: 0.380 Test Loss: 71.133 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0133490562438965
Epoch: 11, Steps: 4 | Train Loss: 0.425 Vali Loss: 81.375 Vali Acc: 0.420 Test Loss: 81.375 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.025874137878418
Epoch: 12, Steps: 4 | Train Loss: 0.216 Vali Loss: 77.737 Vali Acc: 0.440 Test Loss: 77.737 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.017988443374634
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 72.355 Vali Acc: 0.440 Test Loss: 72.355 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0167267322540283
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 67.750 Vali Acc: 0.400 Test Loss: 67.750 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0493648052215576
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 64.503 Vali Acc: 0.400 Test Loss: 64.503 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.06607985496521
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 74.710 Vali Acc: 0.460 Test Loss: 74.710 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0382790565490723
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 80.049 Vali Acc: 0.500 Test Loss: 80.049 Test Acc: 0.500
Validation loss decreased (-0.479191 --> -0.499200).  Saving model ...
Epoch: 18 cost time: 2.0667691230773926
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 79.106 Vali Acc: 0.520 Test Loss: 79.106 Test Acc: 0.520
Validation loss decreased (-0.499200 --> -0.519209).  Saving model ...
Epoch: 19 cost time: 2.0771002769470215
Epoch: 19, Steps: 4 | Train Loss: 0.761 Vali Loss: 61.693 Vali Acc: 0.520 Test Loss: 61.693 Test Acc: 0.520
Validation loss decreased (-0.519209 --> -0.519383).  Saving model ...
Epoch: 20 cost time: 2.0665788650512695
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 52.291 Vali Acc: 0.500 Test Loss: 52.291 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.019188165664673
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 48.429 Vali Acc: 0.440 Test Loss: 48.429 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.087430953979492
Epoch: 22, Steps: 4 | Train Loss: 0.683 Vali Loss: 59.840 Vali Acc: 0.380 Test Loss: 59.840 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.035853624343872
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 82.564 Vali Acc: 0.320 Test Loss: 82.564 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0066614151000977
Epoch: 24, Steps: 4 | Train Loss: 0.789 Vali Loss: 76.576 Vali Acc: 0.480 Test Loss: 76.576 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.047445297241211
Epoch: 25, Steps: 4 | Train Loss: 0.321 Vali Loss: 97.176 Vali Acc: 0.480 Test Loss: 97.176 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0347249507904053
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 120.089 Vali Acc: 0.420 Test Loss: 120.089 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0259294509887695
Epoch: 27, Steps: 4 | Train Loss: 0.951 Vali Loss: 99.981 Vali Acc: 0.420 Test Loss: 99.981 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.031399965286255
Epoch: 28, Steps: 4 | Train Loss: 0.245 Vali Loss: 88.291 Vali Acc: 0.440 Test Loss: 88.291 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.04583477973938
Epoch: 29, Steps: 4 | Train Loss: 0.265 Vali Loss: 96.870 Vali Acc: 0.400 Test Loss: 96.870 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1152790021
model size : 4402.82MB
2025-04-27 19:57:22.261860: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 19:57:22.280763: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745783842.302809 1302119 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745783842.309493 1302119 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 19:57:22.331843: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.93269419670105
Epoch: 1, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.556 Vali Acc: 0.400 Test Loss: 1.556 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 2.0355136394500732
Epoch: 2, Steps: 4 | Train Loss: 2.462 Vali Loss: 8.413 Vali Acc: 0.440 Test Loss: 8.413 Test Acc: 0.440
Validation loss decreased (-0.399984 --> -0.439916).  Saving model ...
Epoch: 3 cost time: 2.0317227840423584
Epoch: 3, Steps: 4 | Train Loss: 0.274 Vali Loss: 14.894 Vali Acc: 0.400 Test Loss: 14.894 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9610283374786377
Epoch: 4, Steps: 4 | Train Loss: 2.663 Vali Loss: 21.572 Vali Acc: 0.540 Test Loss: 21.572 Test Acc: 0.540
Validation loss decreased (-0.439916 --> -0.539784).  Saving model ...
Epoch: 5 cost time: 2.0000274181365967
Epoch: 5, Steps: 4 | Train Loss: 2.874 Vali Loss: 29.140 Vali Acc: 0.480 Test Loss: 29.140 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9691174030303955
Epoch: 6, Steps: 4 | Train Loss: 1.897 Vali Loss: 31.104 Vali Acc: 0.420 Test Loss: 31.104 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9467577934265137
Epoch: 7, Steps: 4 | Train Loss: 0.544 Vali Loss: 36.617 Vali Acc: 0.520 Test Loss: 36.617 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.972822666168213
Epoch: 8, Steps: 4 | Train Loss: 1.682 Vali Loss: 44.931 Vali Acc: 0.440 Test Loss: 44.931 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9630446434020996
Epoch: 9, Steps: 4 | Train Loss: 1.436 Vali Loss: 46.606 Vali Acc: 0.540 Test Loss: 46.606 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9466416835784912
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 54.482 Vali Acc: 0.480 Test Loss: 54.482 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9672212600708008
Epoch: 11, Steps: 4 | Train Loss: 4.452 Vali Loss: 64.850 Vali Acc: 0.500 Test Loss: 64.850 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.000814199447632
Epoch: 12, Steps: 4 | Train Loss: 0.399 Vali Loss: 58.390 Vali Acc: 0.520 Test Loss: 58.390 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9447052478790283
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 44.998 Vali Acc: 0.540 Test Loss: 44.998 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9725515842437744
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 43.918 Vali Acc: 0.620 Test Loss: 43.918 Test Acc: 0.620
Validation loss decreased (-0.539784 --> -0.619561).  Saving model ...
Epoch: 15 cost time: 2.054955244064331
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 46.086 Vali Acc: 0.580 Test Loss: 46.086 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9991340637207031
Epoch: 16, Steps: 4 | Train Loss: 0.102 Vali Loss: 32.747 Vali Acc: 0.500 Test Loss: 32.747 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9769551753997803
Epoch: 17, Steps: 4 | Train Loss: 0.063 Vali Loss: 47.806 Vali Acc: 0.420 Test Loss: 47.806 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0002965927124023
Epoch: 18, Steps: 4 | Train Loss: 0.075 Vali Loss: 74.797 Vali Acc: 0.420 Test Loss: 74.797 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9366297721862793
Epoch: 19, Steps: 4 | Train Loss: 0.136 Vali Loss: 77.797 Vali Acc: 0.440 Test Loss: 77.797 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.954202651977539
Epoch: 20, Steps: 4 | Train Loss: 0.328 Vali Loss: 57.066 Vali Acc: 0.560 Test Loss: 57.066 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9919400215148926
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 53.509 Vali Acc: 0.620 Test Loss: 53.509 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9507427215576172
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 108.207 Vali Acc: 0.620 Test Loss: 108.207 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9564194679260254
Epoch: 23, Steps: 4 | Train Loss: 0.475 Vali Loss: 69.426 Vali Acc: 0.540 Test Loss: 69.426 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.985001802444458
Epoch: 24, Steps: 4 | Train Loss: 1.043 Vali Loss: 77.944 Vali Acc: 0.500 Test Loss: 77.944 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1144183557
model size : 4369.98MB
2025-04-27 20:00:13.168504: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:00:13.187039: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784013.208610 1313119 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784013.215265 1313119 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:00:13.237582: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9406182765960693
Epoch: 1, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.718 Vali Acc: 0.280 Test Loss: 1.718 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 1.9871904850006104
Epoch: 2, Steps: 4 | Train Loss: 1.154 Vali Loss: 4.916 Vali Acc: 0.440 Test Loss: 4.916 Test Acc: 0.440
Validation loss decreased (-0.279983 --> -0.439951).  Saving model ...
Epoch: 3 cost time: 2.0314176082611084
Epoch: 3, Steps: 4 | Train Loss: 0.452 Vali Loss: 8.893 Vali Acc: 0.520 Test Loss: 8.893 Test Acc: 0.520
Validation loss decreased (-0.439951 --> -0.519911).  Saving model ...
Epoch: 4 cost time: 2.0052428245544434
Epoch: 4, Steps: 4 | Train Loss: 0.627 Vali Loss: 9.683 Vali Acc: 0.540 Test Loss: 9.683 Test Acc: 0.540
Validation loss decreased (-0.519911 --> -0.539903).  Saving model ...
Epoch: 5 cost time: 1.9842610359191895
Epoch: 5, Steps: 4 | Train Loss: 0.001 Vali Loss: 16.527 Vali Acc: 0.320 Test Loss: 16.527 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9593937397003174
Epoch: 6, Steps: 4 | Train Loss: 0.166 Vali Loss: 25.720 Vali Acc: 0.420 Test Loss: 25.720 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9437050819396973
Epoch: 7, Steps: 4 | Train Loss: 2.547 Vali Loss: 26.508 Vali Acc: 0.460 Test Loss: 26.508 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9441826343536377
Epoch: 8, Steps: 4 | Train Loss: 0.573 Vali Loss: 33.192 Vali Acc: 0.420 Test Loss: 33.192 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9558405876159668
Epoch: 9, Steps: 4 | Train Loss: 18.220 Vali Loss: 47.654 Vali Acc: 0.380 Test Loss: 47.654 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.930715560913086
Epoch: 10, Steps: 4 | Train Loss: 0.572 Vali Loss: 31.024 Vali Acc: 0.400 Test Loss: 31.024 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9398856163024902
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 27.218 Vali Acc: 0.420 Test Loss: 27.218 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9355087280273438
Epoch: 12, Steps: 4 | Train Loss: 0.084 Vali Loss: 28.331 Vali Acc: 0.400 Test Loss: 28.331 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9552459716796875
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 36.123 Vali Acc: 0.400 Test Loss: 36.123 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9208180904388428
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 52.575 Vali Acc: 0.400 Test Loss: 52.575 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1132135941
model size : 4324.03MB
2025-04-27 20:02:25.555198: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:02:25.574423: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784145.596533 1319828 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784145.603339 1319828 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:02:25.625968: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8591573238372803
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.578 Vali Acc: 0.440 Test Loss: 1.578 Test Acc: 0.440
Validation loss decreased (inf --> -0.439984).  Saving model ...
Epoch: 2 cost time: 1.9853131771087646
Epoch: 2, Steps: 4 | Train Loss: 1.234 Vali Loss: 3.014 Vali Acc: 0.500 Test Loss: 3.014 Test Acc: 0.500
Validation loss decreased (-0.439984 --> -0.499970).  Saving model ...
Epoch: 3 cost time: 1.9643502235412598
Epoch: 3, Steps: 4 | Train Loss: 0.085 Vali Loss: 7.162 Vali Acc: 0.480 Test Loss: 7.162 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9053738117218018
Epoch: 4, Steps: 4 | Train Loss: 0.277 Vali Loss: 8.561 Vali Acc: 0.500 Test Loss: 8.561 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9156203269958496
Epoch: 5, Steps: 4 | Train Loss: 0.009 Vali Loss: 9.519 Vali Acc: 0.500 Test Loss: 9.519 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.901787281036377
Epoch: 6, Steps: 4 | Train Loss: 0.044 Vali Loss: 16.475 Vali Acc: 0.420 Test Loss: 16.475 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9074981212615967
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.790 Vali Acc: 0.380 Test Loss: 29.790 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9026148319244385
Epoch: 8, Steps: 4 | Train Loss: 0.417 Vali Loss: 23.056 Vali Acc: 0.420 Test Loss: 23.056 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8916618824005127
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 19.083 Vali Acc: 0.480 Test Loss: 19.083 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9524664878845215
Epoch: 10, Steps: 4 | Train Loss: 0.232 Vali Loss: 23.532 Vali Acc: 0.480 Test Loss: 23.532 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.891251802444458
Epoch: 11, Steps: 4 | Train Loss: 1.601 Vali Loss: 34.525 Vali Acc: 0.380 Test Loss: 34.525 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.894911766052246
Epoch: 12, Steps: 4 | Train Loss: 0.219 Vali Loss: 24.564 Vali Acc: 0.360 Test Loss: 24.564 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 1128696069
model size : 4310.90MB
2025-04-27 20:04:06.963094: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:04:06.982467: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784247.005146 1325516 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784247.012069 1325516 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:04:07.034979: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.806053638458252
Epoch: 1, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.601 Vali Acc: 0.340 Test Loss: 1.601 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.8964357376098633
Epoch: 2, Steps: 4 | Train Loss: 2.339 Vali Loss: 2.979 Vali Acc: 0.520 Test Loss: 2.979 Test Acc: 0.520
Validation loss decreased (-0.339984 --> -0.519970).  Saving model ...
Epoch: 3 cost time: 1.9134035110473633
Epoch: 3, Steps: 4 | Train Loss: 0.060 Vali Loss: 4.263 Vali Acc: 0.460 Test Loss: 4.263 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8404502868652344
Epoch: 4, Steps: 4 | Train Loss: 0.169 Vali Loss: 7.694 Vali Acc: 0.440 Test Loss: 7.694 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.829524278640747
Epoch: 5, Steps: 4 | Train Loss: 0.269 Vali Loss: 15.049 Vali Acc: 0.500 Test Loss: 15.049 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.840625286102295
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.692 Vali Acc: 0.440 Test Loss: 22.692 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8231780529022217
Epoch: 7, Steps: 4 | Train Loss: 0.005 Vali Loss: 26.028 Vali Acc: 0.480 Test Loss: 26.028 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8468024730682373
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 30.232 Vali Acc: 0.400 Test Loss: 30.232 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8399968147277832
Epoch: 9, Steps: 4 | Train Loss: 0.153 Vali Loss: 37.953 Vali Acc: 0.440 Test Loss: 37.953 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.833571434020996
Epoch: 10, Steps: 4 | Train Loss: 0.198 Vali Loss: 35.773 Vali Acc: 0.360 Test Loss: 35.773 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8401637077331543
Epoch: 11, Steps: 4 | Train Loss: 0.138 Vali Loss: 35.502 Vali Acc: 0.380 Test Loss: 35.502 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8368597030639648
Epoch: 12, Steps: 4 | Train Loss: 0.280 Vali Loss: 31.511 Vali Acc: 0.460 Test Loss: 31.511 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 1123534853
model size : 4291.22MB
2025-04-27 20:05:43.355743: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:05:43.375561: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784343.397814 1331175 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784343.404632 1331175 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:05:43.428265: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.487553119659424
Epoch: 1, Steps: 4 | Train Loss: 1.893 Vali Loss: 1.712 Vali Acc: 0.360 Test Loss: 1.712 Test Acc: 0.360
Validation loss decreased (inf --> -0.359983).  Saving model ...
Epoch: 2 cost time: 1.6213197708129883
Epoch: 2, Steps: 4 | Train Loss: 1.373 Vali Loss: 9.592 Vali Acc: 0.360 Test Loss: 9.592 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5805268287658691
Epoch: 3, Steps: 4 | Train Loss: 3.187 Vali Loss: 33.950 Vali Acc: 0.340 Test Loss: 33.950 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.56001877784729
Epoch: 4, Steps: 4 | Train Loss: 3.252 Vali Loss: 37.326 Vali Acc: 0.360 Test Loss: 37.326 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5780706405639648
Epoch: 5, Steps: 4 | Train Loss: 3.764 Vali Loss: 67.709 Vali Acc: 0.420 Test Loss: 67.709 Test Acc: 0.420
Validation loss decreased (-0.359983 --> -0.419323).  Saving model ...
Epoch: 6 cost time: 1.6098048686981201
Epoch: 6, Steps: 4 | Train Loss: 0.161 Vali Loss: 84.035 Vali Acc: 0.360 Test Loss: 84.035 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6019995212554932
Epoch: 7, Steps: 4 | Train Loss: 0.242 Vali Loss: 76.480 Vali Acc: 0.340 Test Loss: 76.480 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5763835906982422
Epoch: 8, Steps: 4 | Train Loss: 0.817 Vali Loss: 75.152 Vali Acc: 0.400 Test Loss: 75.152 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5847482681274414
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 86.213 Vali Acc: 0.340 Test Loss: 86.213 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5885841846466064
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 119.477 Vali Acc: 0.320 Test Loss: 119.477 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.577697515487671
Epoch: 11, Steps: 4 | Train Loss: 1.347 Vali Loss: 107.440 Vali Acc: 0.340 Test Loss: 107.440 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5785772800445557
Epoch: 12, Steps: 4 | Train Loss: 0.001 Vali Loss: 74.802 Vali Acc: 0.280 Test Loss: 74.802 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.594242811203003
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 67.224 Vali Acc: 0.300 Test Loss: 67.224 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5908310413360596
Epoch: 14, Steps: 4 | Train Loss: 0.213 Vali Loss: 92.378 Vali Acc: 0.340 Test Loss: 92.378 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5976204872131348
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 140.092 Vali Acc: 0.300 Test Loss: 140.092 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 569334661
model size : 2174.48MB
2025-04-27 20:07:08.374183: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:07:08.393394: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784428.415480 1337977 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784428.422176 1337977 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:07:08.444896: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.354973554611206
Epoch: 1, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.507 Vali Acc: 0.280 Test Loss: 1.507 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.4398863315582275
Epoch: 2, Steps: 4 | Train Loss: 1.662 Vali Loss: 8.567 Vali Acc: 0.400 Test Loss: 8.567 Test Acc: 0.400
Validation loss decreased (-0.279985 --> -0.399914).  Saving model ...
Epoch: 3 cost time: 1.4222428798675537
Epoch: 3, Steps: 4 | Train Loss: 0.415 Vali Loss: 23.511 Vali Acc: 0.440 Test Loss: 23.511 Test Acc: 0.440
Validation loss decreased (-0.399914 --> -0.439765).  Saving model ...
Epoch: 4 cost time: 1.4418444633483887
Epoch: 4, Steps: 4 | Train Loss: 1.219 Vali Loss: 22.607 Vali Acc: 0.320 Test Loss: 22.607 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3798890113830566
Epoch: 5, Steps: 4 | Train Loss: 0.274 Vali Loss: 28.486 Vali Acc: 0.500 Test Loss: 28.486 Test Acc: 0.500
Validation loss decreased (-0.439765 --> -0.499715).  Saving model ...
Epoch: 6 cost time: 1.426697015762329
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 40.651 Vali Acc: 0.440 Test Loss: 40.651 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3964989185333252
Epoch: 7, Steps: 4 | Train Loss: 1.184 Vali Loss: 39.428 Vali Acc: 0.320 Test Loss: 39.428 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3804216384887695
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 47.990 Vali Acc: 0.280 Test Loss: 47.990 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4158604145050049
Epoch: 9, Steps: 4 | Train Loss: 0.064 Vali Loss: 66.394 Vali Acc: 0.320 Test Loss: 66.394 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3757028579711914
Epoch: 10, Steps: 4 | Train Loss: 0.175 Vali Loss: 82.589 Vali Acc: 0.380 Test Loss: 82.589 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4082756042480469
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 91.314 Vali Acc: 0.340 Test Loss: 91.314 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3871684074401855
Epoch: 12, Steps: 4 | Train Loss: 0.999 Vali Loss: 98.681 Vali Acc: 0.400 Test Loss: 98.681 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3979942798614502
Epoch: 13, Steps: 4 | Train Loss: 1.005 Vali Loss: 59.110 Vali Acc: 0.440 Test Loss: 59.110 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3746633529663086
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 46.690 Vali Acc: 0.400 Test Loss: 46.690 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3994510173797607
Epoch: 15, Steps: 4 | Train Loss: 0.189 Vali Loss: 70.188 Vali Acc: 0.440 Test Loss: 70.188 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 544372357
model size : 2079.26MB
2025-04-27 20:08:33.601420: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:08:33.620432: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784513.642542 1344781 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784513.649273 1344781 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:08:33.671921: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.274432897567749
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.524 Vali Acc: 0.260 Test Loss: 1.524 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.308452844619751
Epoch: 2, Steps: 4 | Train Loss: 1.003 Vali Loss: 4.447 Vali Acc: 0.440 Test Loss: 4.447 Test Acc: 0.440
Validation loss decreased (-0.259985 --> -0.439956).  Saving model ...
Epoch: 3 cost time: 1.32672119140625
Epoch: 3, Steps: 4 | Train Loss: 0.892 Vali Loss: 8.945 Vali Acc: 0.460 Test Loss: 8.945 Test Acc: 0.460
Validation loss decreased (-0.439956 --> -0.459911).  Saving model ...
Epoch: 4 cost time: 1.292180061340332
Epoch: 4, Steps: 4 | Train Loss: 0.138 Vali Loss: 21.471 Vali Acc: 0.420 Test Loss: 21.471 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2474591732025146
Epoch: 5, Steps: 4 | Train Loss: 0.666 Vali Loss: 22.026 Vali Acc: 0.580 Test Loss: 22.026 Test Acc: 0.580
Validation loss decreased (-0.459911 --> -0.579780).  Saving model ...
Epoch: 6 cost time: 1.310960054397583
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 27.282 Vali Acc: 0.400 Test Loss: 27.282 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2282915115356445
Epoch: 7, Steps: 4 | Train Loss: 0.132 Vali Loss: 27.689 Vali Acc: 0.400 Test Loss: 27.689 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2444112300872803
Epoch: 8, Steps: 4 | Train Loss: 0.086 Vali Loss: 20.643 Vali Acc: 0.380 Test Loss: 20.643 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2284150123596191
Epoch: 9, Steps: 4 | Train Loss: 0.377 Vali Loss: 20.119 Vali Acc: 0.500 Test Loss: 20.119 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2388107776641846
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 41.756 Vali Acc: 0.380 Test Loss: 41.756 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2269814014434814
Epoch: 11, Steps: 4 | Train Loss: 1.096 Vali Loss: 47.865 Vali Acc: 0.380 Test Loss: 47.865 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2537968158721924
Epoch: 12, Steps: 4 | Train Loss: 0.487 Vali Loss: 31.587 Vali Acc: 0.500 Test Loss: 31.587 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2427079677581787
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 31.688 Vali Acc: 0.380 Test Loss: 31.688 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2556045055389404
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 42.263 Vali Acc: 0.300 Test Loss: 42.263 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2690083980560303
Epoch: 15, Steps: 4 | Train Loss: 0.113 Vali Loss: 27.058 Vali Acc: 0.460 Test Loss: 27.058 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 532322053
model size : 2033.29MB
2025-04-27 20:09:58.325719: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:09:58.345028: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784598.367583 1351593 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784598.374451 1351593 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:09:58.397222: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1709940433502197
Epoch: 1, Steps: 4 | Train Loss: 1.412 Vali Loss: 1.388 Vali Acc: 0.340 Test Loss: 1.388 Test Acc: 0.340
Validation loss decreased (inf --> -0.339986).  Saving model ...
Epoch: 2 cost time: 1.2728116512298584
Epoch: 2, Steps: 4 | Train Loss: 1.448 Vali Loss: 5.272 Vali Acc: 0.360 Test Loss: 5.272 Test Acc: 0.360
Validation loss decreased (-0.339986 --> -0.359947).  Saving model ...
Epoch: 3 cost time: 1.24985671043396
Epoch: 3, Steps: 4 | Train Loss: 0.732 Vali Loss: 7.177 Vali Acc: 0.340 Test Loss: 7.177 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2322916984558105
Epoch: 4, Steps: 4 | Train Loss: 0.279 Vali Loss: 16.067 Vali Acc: 0.440 Test Loss: 16.067 Test Acc: 0.440
Validation loss decreased (-0.359947 --> -0.439839).  Saving model ...
Epoch: 5 cost time: 1.2917110919952393
Epoch: 5, Steps: 4 | Train Loss: 0.314 Vali Loss: 17.606 Vali Acc: 0.480 Test Loss: 17.606 Test Acc: 0.480
Validation loss decreased (-0.439839 --> -0.479824).  Saving model ...
Epoch: 6 cost time: 1.286970615386963
Epoch: 6, Steps: 4 | Train Loss: 0.042 Vali Loss: 20.015 Vali Acc: 0.440 Test Loss: 20.015 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.247720718383789
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 28.978 Vali Acc: 0.420 Test Loss: 28.978 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.24660325050354
Epoch: 8, Steps: 4 | Train Loss: 0.005 Vali Loss: 39.134 Vali Acc: 0.440 Test Loss: 39.134 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2449305057525635
Epoch: 9, Steps: 4 | Train Loss: 0.354 Vali Loss: 43.168 Vali Acc: 0.380 Test Loss: 43.168 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2501699924468994
Epoch: 10, Steps: 4 | Train Loss: 0.021 Vali Loss: 26.980 Vali Acc: 0.440 Test Loss: 26.980 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2569174766540527
Epoch: 11, Steps: 4 | Train Loss: 0.087 Vali Loss: 37.801 Vali Acc: 0.460 Test Loss: 37.801 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2548446655273438
Epoch: 12, Steps: 4 | Train Loss: 1.005 Vali Loss: 42.214 Vali Acc: 0.380 Test Loss: 42.214 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2499268054962158
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 47.943 Vali Acc: 0.360 Test Loss: 47.943 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2694556713104248
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 58.788 Vali Acc: 0.340 Test Loss: 58.788 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2371711730957031
Epoch: 15, Steps: 4 | Train Loss: 0.377 Vali Loss: 36.978 Vali Acc: 0.400 Test Loss: 36.978 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 528018821
model size : 2016.87MB
2025-04-27 20:11:18.516244: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:11:18.535153: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784678.557380 1358353 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784678.564154 1358353 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:11:18.587499: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0705978870391846
Epoch: 1, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.605 Vali Acc: 0.360 Test Loss: 1.605 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 1.2254347801208496
Epoch: 2, Steps: 4 | Train Loss: 0.682 Vali Loss: 2.760 Vali Acc: 0.420 Test Loss: 2.760 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419972).  Saving model ...
Epoch: 3 cost time: 1.2421250343322754
Epoch: 3, Steps: 4 | Train Loss: 0.481 Vali Loss: 4.843 Vali Acc: 0.440 Test Loss: 4.843 Test Acc: 0.440
Validation loss decreased (-0.419972 --> -0.439952).  Saving model ...
Epoch: 4 cost time: 1.2601258754730225
Epoch: 4, Steps: 4 | Train Loss: 0.367 Vali Loss: 6.115 Vali Acc: 0.500 Test Loss: 6.115 Test Acc: 0.500
Validation loss decreased (-0.439952 --> -0.499939).  Saving model ...
Epoch: 5 cost time: 1.2203454971313477
Epoch: 5, Steps: 4 | Train Loss: 0.230 Vali Loss: 6.683 Vali Acc: 0.400 Test Loss: 6.683 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.214238166809082
Epoch: 6, Steps: 4 | Train Loss: 0.026 Vali Loss: 7.967 Vali Acc: 0.520 Test Loss: 7.967 Test Acc: 0.520
Validation loss decreased (-0.499939 --> -0.519920).  Saving model ...
Epoch: 7 cost time: 1.2389016151428223
Epoch: 7, Steps: 4 | Train Loss: 0.076 Vali Loss: 10.293 Vali Acc: 0.400 Test Loss: 10.293 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.20194673538208
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 12.716 Vali Acc: 0.440 Test Loss: 12.716 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2046196460723877
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.772 Vali Acc: 0.400 Test Loss: 15.772 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2092406749725342
Epoch: 10, Steps: 4 | Train Loss: 0.004 Vali Loss: 16.143 Vali Acc: 0.520 Test Loss: 16.143 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1939830780029297
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 23.682 Vali Acc: 0.380 Test Loss: 23.682 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2056779861450195
Epoch: 12, Steps: 4 | Train Loss: 0.407 Vali Loss: 31.098 Vali Acc: 0.420 Test Loss: 31.098 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1894092559814453
Epoch: 13, Steps: 4 | Train Loss: 0.064 Vali Loss: 25.287 Vali Acc: 0.460 Test Loss: 25.287 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1918506622314453
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.530 Vali Acc: 0.380 Test Loss: 21.530 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1822543144226074
Epoch: 15, Steps: 4 | Train Loss: 0.096 Vali Loss: 22.277 Vali Acc: 0.400 Test Loss: 22.277 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1942615509033203
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.912 Vali Acc: 0.480 Test Loss: 21.912 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 521995013
model size : 1993.89MB
2025-04-27 20:12:51.312578: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:12:51.332658: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784771.355626 1365598 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784771.362594 1365598 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:12:51.386269: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1933884620666504
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.419 Vali Acc: 0.400 Test Loss: 1.419 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.2394671440124512
Epoch: 2, Steps: 4 | Train Loss: 0.864 Vali Loss: 2.806 Vali Acc: 0.340 Test Loss: 2.806 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2043886184692383
Epoch: 3, Steps: 4 | Train Loss: 0.327 Vali Loss: 3.998 Vali Acc: 0.440 Test Loss: 3.998 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439960).  Saving model ...
Epoch: 4 cost time: 1.2373266220092773
Epoch: 4, Steps: 4 | Train Loss: 0.504 Vali Loss: 12.056 Vali Acc: 0.540 Test Loss: 12.056 Test Acc: 0.540
Validation loss decreased (-0.439960 --> -0.539879).  Saving model ...
Epoch: 5 cost time: 1.2613067626953125
Epoch: 5, Steps: 4 | Train Loss: 0.703 Vali Loss: 16.206 Vali Acc: 0.480 Test Loss: 16.206 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.657668113708496
Epoch: 6, Steps: 4 | Train Loss: 0.160 Vali Loss: 12.075 Vali Acc: 0.420 Test Loss: 12.075 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.213815689086914
Epoch: 7, Steps: 4 | Train Loss: 0.344 Vali Loss: 8.940 Vali Acc: 0.400 Test Loss: 8.940 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2125585079193115
Epoch: 8, Steps: 4 | Train Loss: 0.166 Vali Loss: 11.956 Vali Acc: 0.360 Test Loss: 11.956 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2016692161560059
Epoch: 9, Steps: 4 | Train Loss: 0.019 Vali Loss: 13.059 Vali Acc: 0.420 Test Loss: 13.059 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1960115432739258
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 18.538 Vali Acc: 0.480 Test Loss: 18.538 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.199483871459961
Epoch: 11, Steps: 4 | Train Loss: 0.004 Vali Loss: 21.112 Vali Acc: 0.480 Test Loss: 21.112 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2159311771392822
Epoch: 12, Steps: 4 | Train Loss: 0.077 Vali Loss: 12.441 Vali Acc: 0.500 Test Loss: 12.441 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.195016622543335
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 14.145 Vali Acc: 0.480 Test Loss: 14.145 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2085559368133545
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.990 Vali Acc: 0.420 Test Loss: 23.990 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 520275077
model size : 1987.33MB
2025-04-27 20:14:05.726283: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:14:05.745417: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784845.767710 1371932 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784845.774486 1371932 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:14:05.797169: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1335699558258057
Epoch: 1, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.597 Vali Acc: 0.340 Test Loss: 1.597 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.3285188674926758
Epoch: 2, Steps: 4 | Train Loss: 0.998 Vali Loss: 2.645 Vali Acc: 0.440 Test Loss: 2.645 Test Acc: 0.440
Validation loss decreased (-0.339984 --> -0.439974).  Saving model ...
Epoch: 3 cost time: 1.3012754917144775
Epoch: 3, Steps: 4 | Train Loss: 0.540 Vali Loss: 2.988 Vali Acc: 0.520 Test Loss: 2.988 Test Acc: 0.520
Validation loss decreased (-0.439974 --> -0.519970).  Saving model ...
Epoch: 4 cost time: 1.3211750984191895
Epoch: 4, Steps: 4 | Train Loss: 0.037 Vali Loss: 3.223 Vali Acc: 0.520 Test Loss: 3.223 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2736742496490479
Epoch: 5, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.804 Vali Acc: 0.420 Test Loss: 4.804 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2430100440979004
Epoch: 6, Steps: 4 | Train Loss: 0.036 Vali Loss: 6.404 Vali Acc: 0.460 Test Loss: 6.404 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2492167949676514
Epoch: 7, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.027 Vali Acc: 0.460 Test Loss: 7.027 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2584362030029297
Epoch: 8, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.388 Vali Acc: 0.520 Test Loss: 7.388 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2524936199188232
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.707 Vali Acc: 0.480 Test Loss: 6.707 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2823882102966309
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.027 Vali Acc: 0.460 Test Loss: 7.027 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2426185607910156
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.422 Vali Acc: 0.440 Test Loss: 7.422 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.272674798965454
Epoch: 12, Steps: 4 | Train Loss: 0.937 Vali Loss: 7.000 Vali Acc: 0.500 Test Loss: 7.000 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.281465768814087
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.786 Vali Acc: 0.440 Test Loss: 10.786 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 517694469
model size : 1977.49MB
2025-04-27 20:15:19.146525: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:15:19.166298: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784919.190149 1377852 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784919.197050 1377852 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:15:19.220112: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2400150299072266
Epoch: 1, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.439 Vali Acc: 0.380 Test Loss: 1.439 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.320396900177002
Epoch: 2, Steps: 4 | Train Loss: 1.190 Vali Loss: 6.152 Vali Acc: 0.320 Test Loss: 6.152 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3230879306793213
Epoch: 3, Steps: 4 | Train Loss: 0.362 Vali Loss: 23.864 Vali Acc: 0.400 Test Loss: 23.864 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399761).  Saving model ...
Epoch: 4 cost time: 1.3011164665222168
Epoch: 4, Steps: 4 | Train Loss: 0.619 Vali Loss: 19.041 Vali Acc: 0.440 Test Loss: 19.041 Test Acc: 0.440
Validation loss decreased (-0.399761 --> -0.439810).  Saving model ...
Epoch: 5 cost time: 1.2930121421813965
Epoch: 5, Steps: 4 | Train Loss: 0.023 Vali Loss: 26.199 Vali Acc: 0.440 Test Loss: 26.199 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3033084869384766
Epoch: 6, Steps: 4 | Train Loss: 7.895 Vali Loss: 39.861 Vali Acc: 0.440 Test Loss: 39.861 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2812464237213135
Epoch: 7, Steps: 4 | Train Loss: 1.361 Vali Loss: 44.881 Vali Acc: 0.340 Test Loss: 44.881 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2696993350982666
Epoch: 8, Steps: 4 | Train Loss: 0.923 Vali Loss: 56.923 Vali Acc: 0.480 Test Loss: 56.923 Test Acc: 0.480
Validation loss decreased (-0.439810 --> -0.479431).  Saving model ...
Epoch: 9 cost time: 1.3434906005859375
Epoch: 9, Steps: 4 | Train Loss: 0.104 Vali Loss: 36.943 Vali Acc: 0.500 Test Loss: 36.943 Test Acc: 0.500
Validation loss decreased (-0.479431 --> -0.499631).  Saving model ...
Epoch: 10 cost time: 1.3211946487426758
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 71.498 Vali Acc: 0.540 Test Loss: 71.498 Test Acc: 0.540
Validation loss decreased (-0.499631 --> -0.539285).  Saving model ...
Epoch: 11 cost time: 1.3064680099487305
Epoch: 11, Steps: 4 | Train Loss: 0.631 Vali Loss: 54.750 Vali Acc: 0.420 Test Loss: 54.750 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3077161312103271
Epoch: 12, Steps: 4 | Train Loss: 1.434 Vali Loss: 33.077 Vali Acc: 0.580 Test Loss: 33.077 Test Acc: 0.580
Validation loss decreased (-0.539285 --> -0.579669).  Saving model ...
Epoch: 13 cost time: 1.2869038581848145
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 46.222 Vali Acc: 0.500 Test Loss: 46.222 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2762107849121094
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 56.386 Vali Acc: 0.440 Test Loss: 56.386 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2736310958862305
Epoch: 15, Steps: 4 | Train Loss: 0.035 Vali Loss: 60.378 Vali Acc: 0.420 Test Loss: 60.378 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2786035537719727
Epoch: 16, Steps: 4 | Train Loss: 0.101 Vali Loss: 77.717 Vali Acc: 0.460 Test Loss: 77.717 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2720224857330322
Epoch: 17, Steps: 4 | Train Loss: 0.401 Vali Loss: 67.676 Vali Acc: 0.540 Test Loss: 67.676 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2711181640625
Epoch: 18, Steps: 4 | Train Loss: 4.350 Vali Loss: 63.096 Vali Acc: 0.540 Test Loss: 63.096 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2849090099334717
Epoch: 19, Steps: 4 | Train Loss: 0.326 Vali Loss: 60.799 Vali Acc: 0.480 Test Loss: 60.799 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2697136402130127
Epoch: 20, Steps: 4 | Train Loss: 0.052 Vali Loss: 88.584 Vali Acc: 0.440 Test Loss: 88.584 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.286501169204712
Epoch: 21, Steps: 4 | Train Loss: 1.422 Vali Loss: 109.991 Vali Acc: 0.440 Test Loss: 109.991 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2588603496551514
Epoch: 22, Steps: 4 | Train Loss: 0.559 Vali Loss: 104.759 Vali Acc: 0.440 Test Loss: 104.759 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 273649093
model size : 1045.22MB
2025-04-27 20:16:53.684528: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:16:53.704558: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785013.727299 1387532 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785013.734324 1387532 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:16:53.757963: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9370222091674805
Epoch: 1, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.402 Vali Acc: 0.380 Test Loss: 1.402 Test Acc: 0.380
Validation loss decreased (inf --> -0.379986).  Saving model ...
Epoch: 2 cost time: 1.1581809520721436
Epoch: 2, Steps: 4 | Train Loss: 0.694 Vali Loss: 3.447 Vali Acc: 0.460 Test Loss: 3.447 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459966).  Saving model ...
Epoch: 3 cost time: 1.151611328125
Epoch: 3, Steps: 4 | Train Loss: 0.210 Vali Loss: 7.410 Vali Acc: 0.380 Test Loss: 7.410 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.122800588607788
Epoch: 4, Steps: 4 | Train Loss: 0.522 Vali Loss: 10.010 Vali Acc: 0.380 Test Loss: 10.010 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.116635799407959
Epoch: 5, Steps: 4 | Train Loss: 0.241 Vali Loss: 11.036 Vali Acc: 0.380 Test Loss: 11.036 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1088943481445312
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 29.382 Vali Acc: 0.360 Test Loss: 29.382 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1243722438812256
Epoch: 7, Steps: 4 | Train Loss: 1.366 Vali Loss: 16.185 Vali Acc: 0.380 Test Loss: 16.185 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1432020664215088
Epoch: 8, Steps: 4 | Train Loss: 0.000 Vali Loss: 22.161 Vali Acc: 0.440 Test Loss: 22.161 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1123909950256348
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 34.925 Vali Acc: 0.420 Test Loss: 34.925 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1214241981506348
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 44.594 Vali Acc: 0.380 Test Loss: 44.594 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.100196361541748
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 51.507 Vali Acc: 0.400 Test Loss: 51.507 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1236276626586914
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 59.515 Vali Acc: 0.380 Test Loss: 59.515 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 261167941
model size : 997.60MB
2025-04-27 20:17:44.378745: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:17:44.396343: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785064.418073 1392891 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785064.424748 1392891 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:17:44.446154: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9428682327270508
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.550 Vali Acc: 0.400 Test Loss: 1.550 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.0234813690185547
Epoch: 2, Steps: 4 | Train Loss: 0.768 Vali Loss: 2.419 Vali Acc: 0.460 Test Loss: 2.419 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459976).  Saving model ...
Epoch: 3 cost time: 1.0415968894958496
Epoch: 3, Steps: 4 | Train Loss: 0.210 Vali Loss: 3.817 Vali Acc: 0.420 Test Loss: 3.817 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0161747932434082
Epoch: 4, Steps: 4 | Train Loss: 0.174 Vali Loss: 5.250 Vali Acc: 0.440 Test Loss: 5.250 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0317661762237549
Epoch: 5, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.021 Vali Acc: 0.460 Test Loss: 7.021 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0380902290344238
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.503 Vali Acc: 0.460 Test Loss: 10.503 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0066900253295898
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 14.510 Vali Acc: 0.460 Test Loss: 14.510 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9956009387969971
Epoch: 8, Steps: 4 | Train Loss: 0.024 Vali Loss: 12.584 Vali Acc: 0.480 Test Loss: 12.584 Test Acc: 0.480
Validation loss decreased (-0.459976 --> -0.479874).  Saving model ...
Epoch: 9 cost time: 1.0559718608856201
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.018 Vali Acc: 0.520 Test Loss: 11.018 Test Acc: 0.520
Validation loss decreased (-0.479874 --> -0.519890).  Saving model ...
Epoch: 10 cost time: 1.0184564590454102
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.424 Vali Acc: 0.360 Test Loss: 11.424 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.019425630569458
Epoch: 11, Steps: 4 | Train Loss: 0.003 Vali Loss: 14.494 Vali Acc: 0.460 Test Loss: 14.494 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0044739246368408
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 23.038 Vali Acc: 0.360 Test Loss: 23.038 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0279810428619385
Epoch: 13, Steps: 4 | Train Loss: 0.084 Vali Loss: 20.685 Vali Acc: 0.440 Test Loss: 20.685 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0031890869140625
Epoch: 14, Steps: 4 | Train Loss: 1.258 Vali Loss: 17.285 Vali Acc: 0.360 Test Loss: 17.285 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9896092414855957
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 21.717 Vali Acc: 0.380 Test Loss: 21.717 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0073728561401367
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 27.326 Vali Acc: 0.380 Test Loss: 27.326 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.98262619972229
Epoch: 17, Steps: 4 | Train Loss: 0.882 Vali Loss: 39.279 Vali Acc: 0.400 Test Loss: 39.279 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.003082036972046
Epoch: 18, Steps: 4 | Train Loss: 0.103 Vali Loss: 34.234 Vali Acc: 0.460 Test Loss: 34.234 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9992635250091553
Epoch: 19, Steps: 4 | Train Loss: 0.005 Vali Loss: 20.533 Vali Acc: 0.420 Test Loss: 20.533 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 255142789
model size : 974.62MB
2025-04-27 20:18:54.644739: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:18:54.664026: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785134.686534 1401204 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785134.693415 1401204 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:18:54.716401: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8457956314086914
Epoch: 1, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.559 Vali Acc: 0.340 Test Loss: 1.559 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.0226776599884033
Epoch: 2, Steps: 4 | Train Loss: 0.837 Vali Loss: 2.331 Vali Acc: 0.480 Test Loss: 2.331 Test Acc: 0.480
Validation loss decreased (-0.339984 --> -0.479977).  Saving model ...
Epoch: 3 cost time: 1.0101280212402344
Epoch: 3, Steps: 4 | Train Loss: 0.287 Vali Loss: 2.355 Vali Acc: 0.480 Test Loss: 2.355 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9888916015625
Epoch: 4, Steps: 4 | Train Loss: 0.133 Vali Loss: 4.994 Vali Acc: 0.500 Test Loss: 4.994 Test Acc: 0.500
Validation loss decreased (-0.479977 --> -0.499950).  Saving model ...
Epoch: 5 cost time: 0.9956319332122803
Epoch: 5, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.055 Vali Acc: 0.520 Test Loss: 6.055 Test Acc: 0.520
Validation loss decreased (-0.499950 --> -0.519939).  Saving model ...
Epoch: 6 cost time: 1.0413095951080322
Epoch: 6, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.602 Vali Acc: 0.400 Test Loss: 6.602 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9784026145935059
Epoch: 7, Steps: 4 | Train Loss: 0.216 Vali Loss: 8.202 Vali Acc: 0.320 Test Loss: 8.202 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9768617153167725
Epoch: 8, Steps: 4 | Train Loss: 0.142 Vali Loss: 7.227 Vali Acc: 0.480 Test Loss: 7.227 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0072166919708252
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 13.826 Vali Acc: 0.400 Test Loss: 13.826 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0000643730163574
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 22.227 Vali Acc: 0.380 Test Loss: 22.227 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9978773593902588
Epoch: 11, Steps: 4 | Train Loss: 0.121 Vali Loss: 14.543 Vali Acc: 0.440 Test Loss: 14.543 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9924230575561523
Epoch: 12, Steps: 4 | Train Loss: 0.038 Vali Loss: 11.724 Vali Acc: 0.480 Test Loss: 11.724 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.980337381362915
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 13.169 Vali Acc: 0.380 Test Loss: 13.169 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9761252403259277
Epoch: 14, Steps: 4 | Train Loss: 0.081 Vali Loss: 16.101 Vali Acc: 0.380 Test Loss: 16.101 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0154917240142822
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 18.431 Vali Acc: 0.440 Test Loss: 18.431 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 252991173
model size : 966.41MB
2025-04-27 20:19:56.476844: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:19:56.495869: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785196.517683 1407834 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785196.524410 1407834 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:19:56.546670: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8261897563934326
Epoch: 1, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.456 Vali Acc: 0.360 Test Loss: 1.456 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 1.0062472820281982
Epoch: 2, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.624 Vali Acc: 0.500 Test Loss: 1.624 Test Acc: 0.500
Validation loss decreased (-0.359985 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.1129076480865479
Epoch: 3, Steps: 4 | Train Loss: 0.253 Vali Loss: 2.187 Vali Acc: 0.400 Test Loss: 2.187 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.959514856338501
Epoch: 4, Steps: 4 | Train Loss: 1.308 Vali Loss: 2.834 Vali Acc: 0.480 Test Loss: 2.834 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0831420421600342
Epoch: 5, Steps: 4 | Train Loss: 0.178 Vali Loss: 3.437 Vali Acc: 0.360 Test Loss: 3.437 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0876400470733643
Epoch: 6, Steps: 4 | Train Loss: 0.040 Vali Loss: 3.874 Vali Acc: 0.420 Test Loss: 3.874 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1286921501159668
Epoch: 7, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.264 Vali Acc: 0.300 Test Loss: 5.264 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0412771701812744
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.193 Vali Acc: 0.500 Test Loss: 6.193 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0506746768951416
Epoch: 9, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.580 Vali Acc: 0.440 Test Loss: 5.580 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.079117774963379
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.149 Vali Acc: 0.460 Test Loss: 5.149 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1132149696350098
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.362 Vali Acc: 0.440 Test Loss: 5.362 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0957486629486084
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.503 Vali Acc: 0.360 Test Loss: 5.503 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 249979269
model size : 954.92MB
2025-04-27 20:20:49.572200: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:20:49.592135: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785249.616125 1413197 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785249.623199 1413197 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:20:49.647254: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.949291706085205
Epoch: 1, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.431 Vali Acc: 0.460 Test Loss: 1.431 Test Acc: 0.460
Validation loss decreased (inf --> -0.459986).  Saving model ...
Epoch: 2 cost time: 1.0851047039031982
Epoch: 2, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.780 Vali Acc: 0.420 Test Loss: 1.780 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.101609468460083
Epoch: 3, Steps: 4 | Train Loss: 0.348 Vali Loss: 2.118 Vali Acc: 0.440 Test Loss: 2.118 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.062476396560669
Epoch: 4, Steps: 4 | Train Loss: 0.514 Vali Loss: 2.823 Vali Acc: 0.500 Test Loss: 2.823 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499972).  Saving model ...
Epoch: 5 cost time: 1.0700404644012451
Epoch: 5, Steps: 4 | Train Loss: 0.035 Vali Loss: 2.889 Vali Acc: 0.540 Test Loss: 2.889 Test Acc: 0.540
Validation loss decreased (-0.499972 --> -0.539971).  Saving model ...
Epoch: 6 cost time: 1.0811967849731445
Epoch: 6, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.136 Vali Acc: 0.540 Test Loss: 4.136 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0637333393096924
Epoch: 7, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.475 Vali Acc: 0.520 Test Loss: 5.475 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0774915218353271
Epoch: 8, Steps: 4 | Train Loss: 0.064 Vali Loss: 5.233 Vali Acc: 0.460 Test Loss: 5.233 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0738606452941895
Epoch: 9, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.599 Vali Acc: 0.500 Test Loss: 5.599 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0235199928283691
Epoch: 10, Steps: 4 | Train Loss: 0.054 Vali Loss: 5.627 Vali Acc: 0.520 Test Loss: 5.627 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0524506568908691
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.790 Vali Acc: 0.500 Test Loss: 7.790 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.077237844467163
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 7.957 Vali Acc: 0.440 Test Loss: 7.957 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0539908409118652
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 9.142 Vali Acc: 0.500 Test Loss: 9.142 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0887939929962158
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.436 Vali Acc: 0.460 Test Loss: 10.436 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0076651573181152
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.116 Vali Acc: 0.400 Test Loss: 10.116 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 249119301
model size : 951.64MB
2025-04-27 20:21:51.026081: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:21:51.045084: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785311.067269 1419836 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785311.074015 1419836 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:21:51.096581: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9196481704711914
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.502 Vali Acc: 0.400 Test Loss: 1.502 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 1.0258665084838867
Epoch: 2, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.437 Vali Acc: 0.500 Test Loss: 1.437 Test Acc: 0.500
Validation loss decreased (-0.399985 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 1.0044100284576416
Epoch: 3, Steps: 4 | Train Loss: 0.386 Vali Loss: 1.883 Vali Acc: 0.460 Test Loss: 1.883 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0015504360198975
Epoch: 4, Steps: 4 | Train Loss: 0.125 Vali Loss: 2.972 Vali Acc: 0.500 Test Loss: 2.972 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9666233062744141
Epoch: 5, Steps: 4 | Train Loss: 0.266 Vali Loss: 3.886 Vali Acc: 0.500 Test Loss: 3.886 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0028343200683594
Epoch: 6, Steps: 4 | Train Loss: 0.043 Vali Loss: 3.549 Vali Acc: 0.480 Test Loss: 3.549 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.032120943069458
Epoch: 7, Steps: 4 | Train Loss: 0.016 Vali Loss: 4.329 Vali Acc: 0.480 Test Loss: 4.329 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0119452476501465
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.915 Vali Acc: 0.460 Test Loss: 5.915 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.99957275390625
Epoch: 9, Steps: 4 | Train Loss: 0.018 Vali Loss: 6.540 Vali Acc: 0.520 Test Loss: 6.540 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519935).  Saving model ...
Epoch: 10 cost time: 0.9906907081604004
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.895 Vali Acc: 0.420 Test Loss: 6.895 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0010998249053955
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 7.594 Vali Acc: 0.480 Test Loss: 7.594 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9904129505157471
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.908 Vali Acc: 0.460 Test Loss: 7.908 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0143399238586426
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.816 Vali Acc: 0.420 Test Loss: 8.816 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9919154644012451
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.379 Vali Acc: 0.460 Test Loss: 9.379 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.025327205657959
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 9.633 Vali Acc: 0.480 Test Loss: 9.633 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0163347721099854
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 9.024 Vali Acc: 0.480 Test Loss: 9.024 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9927332401275635
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.842 Vali Acc: 0.540 Test Loss: 8.842 Test Acc: 0.540
Validation loss decreased (-0.519935 --> -0.539912).  Saving model ...
Epoch: 18 cost time: 1.0309693813323975
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.796 Vali Acc: 0.540 Test Loss: 8.796 Test Acc: 0.540
Validation loss decreased (-0.539912 --> -0.539912).  Saving model ...
Epoch: 19 cost time: 0.9953477382659912
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.583 Vali Acc: 0.520 Test Loss: 8.583 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0265097618103027
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.014 Vali Acc: 0.440 Test Loss: 7.014 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0012118816375732
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.823 Vali Acc: 0.460 Test Loss: 7.823 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.038841724395752
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.448 Vali Acc: 0.440 Test Loss: 8.448 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9952371120452881
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.323 Vali Acc: 0.440 Test Loss: 8.323 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0062954425811768
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.631 Vali Acc: 0.440 Test Loss: 8.631 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0384082794189453
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.808 Vali Acc: 0.440 Test Loss: 8.808 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.009387731552124
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.654 Vali Acc: 0.440 Test Loss: 8.654 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9794514179229736
Epoch: 27, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.834 Vali Acc: 0.460 Test Loss: 7.834 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.007615566253662
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 8.212 Vali Acc: 0.460 Test Loss: 8.212 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 247828997
model size : 946.72MB
2025-04-27 20:23:24.197288: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:23:24.216385: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785404.238750 1431923 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785404.245563 1431923 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:23:24.268065: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9402692317962646
Epoch: 1, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.449 Vali Acc: 0.320 Test Loss: 1.449 Test Acc: 0.320
Validation loss decreased (inf --> -0.319986).  Saving model ...
Epoch: 2 cost time: 1.0113816261291504
Epoch: 2, Steps: 4 | Train Loss: 0.973 Vali Loss: 1.929 Vali Acc: 0.520 Test Loss: 1.929 Test Acc: 0.520
Validation loss decreased (-0.319986 --> -0.519981).  Saving model ...
Epoch: 3 cost time: 1.0320072174072266
Epoch: 3, Steps: 4 | Train Loss: 1.000 Vali Loss: 4.552 Vali Acc: 0.460 Test Loss: 4.552 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9807343482971191
Epoch: 4, Steps: 4 | Train Loss: 0.166 Vali Loss: 5.701 Vali Acc: 0.540 Test Loss: 5.701 Test Acc: 0.540
Validation loss decreased (-0.519981 --> -0.539943).  Saving model ...
Epoch: 5 cost time: 1.0173742771148682
Epoch: 5, Steps: 4 | Train Loss: 0.008 Vali Loss: 10.684 Vali Acc: 0.420 Test Loss: 10.684 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9692771434783936
Epoch: 6, Steps: 4 | Train Loss: 0.419 Vali Loss: 11.835 Vali Acc: 0.460 Test Loss: 11.835 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9803571701049805
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.559 Vali Acc: 0.380 Test Loss: 11.559 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9707188606262207
Epoch: 8, Steps: 4 | Train Loss: 0.075 Vali Loss: 9.819 Vali Acc: 0.440 Test Loss: 9.819 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9965815544128418
Epoch: 9, Steps: 4 | Train Loss: 0.012 Vali Loss: 11.591 Vali Acc: 0.480 Test Loss: 11.591 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9873261451721191
Epoch: 10, Steps: 4 | Train Loss: 0.014 Vali Loss: 12.949 Vali Acc: 0.420 Test Loss: 12.949 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9867329597473145
Epoch: 11, Steps: 4 | Train Loss: 0.024 Vali Loss: 18.345 Vali Acc: 0.480 Test Loss: 18.345 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9890940189361572
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 17.302 Vali Acc: 0.480 Test Loss: 17.302 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9874119758605957
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.074 Vali Acc: 0.480 Test Loss: 16.074 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9772727489471436
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 16.144 Vali Acc: 0.480 Test Loss: 16.144 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 134069989
model size : 512.11MB
2025-04-27 20:24:16.788525: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:24:16.807584: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785456.829588 1438088 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785456.836284 1438088 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:24:16.858852: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.9108378887176514
Epoch: 1, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.680 Vali Acc: 0.340 Test Loss: 1.680 Test Acc: 0.340
Validation loss decreased (inf --> -0.339983).  Saving model ...
Epoch: 2 cost time: 0.9294564723968506
Epoch: 2, Steps: 4 | Train Loss: 1.052 Vali Loss: 1.808 Vali Acc: 0.540 Test Loss: 1.808 Test Acc: 0.540
Validation loss decreased (-0.339983 --> -0.539982).  Saving model ...
Epoch: 3 cost time: 0.9358370304107666
Epoch: 3, Steps: 4 | Train Loss: 0.242 Vali Loss: 2.902 Vali Acc: 0.440 Test Loss: 2.902 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.95585036277771
Epoch: 4, Steps: 4 | Train Loss: 0.022 Vali Loss: 4.914 Vali Acc: 0.460 Test Loss: 4.914 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9634742736816406
Epoch: 5, Steps: 4 | Train Loss: 0.085 Vali Loss: 5.335 Vali Acc: 0.500 Test Loss: 5.335 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9381916522979736
Epoch: 6, Steps: 4 | Train Loss: 0.013 Vali Loss: 6.755 Vali Acc: 0.500 Test Loss: 6.755 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9297993183135986
Epoch: 7, Steps: 4 | Train Loss: 0.000 Vali Loss: 10.764 Vali Acc: 0.420 Test Loss: 10.764 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9475655555725098
Epoch: 8, Steps: 4 | Train Loss: 0.009 Vali Loss: 10.780 Vali Acc: 0.480 Test Loss: 10.780 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9375331401824951
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.829 Vali Acc: 0.340 Test Loss: 11.829 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.956841230392456
Epoch: 10, Steps: 4 | Train Loss: 0.009 Vali Loss: 12.168 Vali Acc: 0.420 Test Loss: 12.168 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9588737487792969
Epoch: 11, Steps: 4 | Train Loss: 0.054 Vali Loss: 15.055 Vali Acc: 0.400 Test Loss: 15.055 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9230482578277588
Epoch: 12, Steps: 4 | Train Loss: 0.056 Vali Loss: 11.279 Vali Acc: 0.460 Test Loss: 11.279 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 127829413
model size : 488.30MB
2025-04-27 20:25:01.130896: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:25:01.148252: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785501.169918 1443396 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785501.176538 1443396 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:25:01.198030: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.765197515487671
Epoch: 1, Steps: 4 | Train Loss: 1.762 Vali Loss: 1.532 Vali Acc: 0.320 Test Loss: 1.532 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 0.8991265296936035
Epoch: 2, Steps: 4 | Train Loss: 0.944 Vali Loss: 1.720 Vali Acc: 0.440 Test Loss: 1.720 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439983).  Saving model ...
Epoch: 3 cost time: 0.8774876594543457
Epoch: 3, Steps: 4 | Train Loss: 0.393 Vali Loss: 2.119 Vali Acc: 0.460 Test Loss: 2.119 Test Acc: 0.460
Validation loss decreased (-0.439983 --> -0.459979).  Saving model ...
Epoch: 4 cost time: 0.880943775177002
Epoch: 4, Steps: 4 | Train Loss: 0.113 Vali Loss: 4.599 Vali Acc: 0.460 Test Loss: 4.599 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.908170223236084
Epoch: 5, Steps: 4 | Train Loss: 0.341 Vali Loss: 7.365 Vali Acc: 0.500 Test Loss: 7.365 Test Acc: 0.500
Validation loss decreased (-0.459979 --> -0.499926).  Saving model ...
Epoch: 6 cost time: 0.9045147895812988
Epoch: 6, Steps: 4 | Train Loss: 0.405 Vali Loss: 3.921 Vali Acc: 0.480 Test Loss: 3.921 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8885087966918945
Epoch: 7, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.766 Vali Acc: 0.420 Test Loss: 3.766 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8718388080596924
Epoch: 8, Steps: 4 | Train Loss: 0.044 Vali Loss: 4.972 Vali Acc: 0.460 Test Loss: 4.972 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8702778816223145
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.117 Vali Acc: 0.440 Test Loss: 11.117 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.877849817276001
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 15.530 Vali Acc: 0.440 Test Loss: 15.530 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8795454502105713
Epoch: 11, Steps: 4 | Train Loss: 0.134 Vali Loss: 14.233 Vali Acc: 0.400 Test Loss: 14.233 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8863718509674072
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 11.930 Vali Acc: 0.420 Test Loss: 11.930 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8925337791442871
Epoch: 13, Steps: 4 | Train Loss: 0.022 Vali Loss: 7.154 Vali Acc: 0.460 Test Loss: 7.154 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9029250144958496
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.014 Vali Acc: 0.400 Test Loss: 6.014 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8963668346405029
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.439 Vali Acc: 0.400 Test Loss: 5.439 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps21_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 124816837
model size : 476.81MB
2025-04-27 20:25:53.046578: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:25:53.065830: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785553.088134 1449967 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785553.094936 1449967 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:25:53.117700: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.7542321681976318
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.556 Vali Acc: 0.200 Test Loss: 1.556 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.8947634696960449
Epoch: 2, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.783 Vali Acc: 0.420 Test Loss: 1.783 Test Acc: 0.420
Validation loss decreased (-0.199984 --> -0.419982).  Saving model ...
Epoch: 3 cost time: 0.8769302368164062
Epoch: 3, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.976 Vali Acc: 0.540 Test Loss: 1.976 Test Acc: 0.540
Validation loss decreased (-0.419982 --> -0.539980).  Saving model ...
Epoch: 4 cost time: 0.8607311248779297
Epoch: 4, Steps: 4 | Train Loss: 0.067 Vali Loss: 2.946 Vali Acc: 0.540 Test Loss: 2.946 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8605642318725586
Epoch: 5, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.632 Vali Acc: 0.520 Test Loss: 3.632 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.859368085861206
Epoch: 6, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.297 Vali Acc: 0.540 Test Loss: 4.297 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.88311767578125
Epoch: 7, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.978 Vali Acc: 0.500 Test Loss: 4.978 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8991971015930176
Epoch: 8, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.881 Vali Acc: 0.560 Test Loss: 5.881 Test Acc: 0.560
Validation loss decreased (-0.539980 --> -0.559941).  Saving model ...
Epoch: 9 cost time: 0.8910443782806396
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.230 Vali Acc: 0.440 Test Loss: 6.230 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8667194843292236
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.251 Vali Acc: 0.440 Test Loss: 6.251 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8481001853942871
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.571 Vali Acc: 0.460 Test Loss: 6.571 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8923053741455078
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.538 Vali Acc: 0.460 Test Loss: 6.538 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8625755310058594
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.672 Vali Acc: 0.460 Test Loss: 6.672 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8736708164215088
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.348 Vali Acc: 0.440 Test Loss: 6.348 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8717727661132812
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.057 Vali Acc: 0.460 Test Loss: 6.057 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8515925407409668
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.013 Vali Acc: 0.500 Test Loss: 6.013 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8694736957550049
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.440 Vali Acc: 0.480 Test Loss: 6.440 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8549530506134033
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.604 Vali Acc: 0.480 Test Loss: 6.604 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps27_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 123741029
model size : 472.70MB
2025-04-27 20:26:50.781208: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:26:50.800679: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785610.823039 1457779 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785610.829817 1457779 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:26:50.853046: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.808424949645996
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.614 Vali Acc: 0.160 Test Loss: 1.614 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 0.8878099918365479
Epoch: 2, Steps: 4 | Train Loss: 1.193 Vali Loss: 1.460 Vali Acc: 0.380 Test Loss: 1.460 Test Acc: 0.380
Validation loss decreased (-0.159984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 0.9029543399810791
Epoch: 3, Steps: 4 | Train Loss: 0.486 Vali Loss: 1.736 Vali Acc: 0.460 Test Loss: 1.736 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459983).  Saving model ...
Epoch: 4 cost time: 0.8555643558502197
Epoch: 4, Steps: 4 | Train Loss: 0.168 Vali Loss: 2.074 Vali Acc: 0.500 Test Loss: 2.074 Test Acc: 0.500
Validation loss decreased (-0.459983 --> -0.499979).  Saving model ...
Epoch: 5 cost time: 0.8952064514160156
Epoch: 5, Steps: 4 | Train Loss: 0.044 Vali Loss: 2.255 Vali Acc: 0.520 Test Loss: 2.255 Test Acc: 0.520
Validation loss decreased (-0.499979 --> -0.519977).  Saving model ...
Epoch: 6 cost time: 0.877373218536377
Epoch: 6, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.739 Vali Acc: 0.520 Test Loss: 2.739 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8605716228485107
Epoch: 7, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.714 Vali Acc: 0.580 Test Loss: 2.714 Test Acc: 0.580
Validation loss decreased (-0.519977 --> -0.579973).  Saving model ...
Epoch: 8 cost time: 0.85719895362854
Epoch: 8, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.870 Vali Acc: 0.560 Test Loss: 2.870 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8438646793365479
Epoch: 9, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.137 Vali Acc: 0.580 Test Loss: 3.137 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8715517520904541
Epoch: 10, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.775 Vali Acc: 0.520 Test Loss: 3.775 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8722290992736816
Epoch: 11, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.517 Vali Acc: 0.480 Test Loss: 4.517 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8486502170562744
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.621 Vali Acc: 0.420 Test Loss: 4.621 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8554797172546387
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.868 Vali Acc: 0.460 Test Loss: 4.868 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8620808124542236
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 4.128 Vali Acc: 0.460 Test Loss: 4.128 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8644318580627441
Epoch: 15, Steps: 4 | Train Loss: 0.021 Vali Loss: 3.625 Vali Acc: 0.420 Test Loss: 3.625 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8815176486968994
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.032 Vali Acc: 0.440 Test Loss: 4.032 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8667116165161133
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.393 Vali Acc: 0.440 Test Loss: 4.393 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps41_str21_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 122235077
model size : 466.96MB
2025-04-27 20:27:48.465702: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:27:48.486118: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785668.508118 1465196 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785668.514849 1465196 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:27:48.537306: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.921269416809082
Epoch: 1, Steps: 4 | Train Loss: 1.686 Vali Loss: 1.659 Vali Acc: 0.260 Test Loss: 1.659 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 0.865135669708252
Epoch: 2, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.534 Vali Acc: 0.400 Test Loss: 1.534 Test Acc: 0.400
Validation loss decreased (-0.259983 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 0.8516485691070557
Epoch: 3, Steps: 4 | Train Loss: 0.586 Vali Loss: 1.737 Vali Acc: 0.500 Test Loss: 1.737 Test Acc: 0.500
Validation loss decreased (-0.399985 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 0.8655486106872559
Epoch: 4, Steps: 4 | Train Loss: 0.191 Vali Loss: 2.112 Vali Acc: 0.580 Test Loss: 2.112 Test Acc: 0.580
Validation loss decreased (-0.499983 --> -0.579979).  Saving model ...
Epoch: 5 cost time: 0.8957276344299316
Epoch: 5, Steps: 4 | Train Loss: 0.060 Vali Loss: 3.119 Vali Acc: 0.580 Test Loss: 3.119 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8714072704315186
Epoch: 6, Steps: 4 | Train Loss: 0.034 Vali Loss: 3.365 Vali Acc: 0.580 Test Loss: 3.365 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8543171882629395
Epoch: 7, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.659 Vali Acc: 0.560 Test Loss: 3.659 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8402121067047119
Epoch: 8, Steps: 4 | Train Loss: 0.010 Vali Loss: 3.659 Vali Acc: 0.600 Test Loss: 3.659 Test Acc: 0.600
Validation loss decreased (-0.579979 --> -0.599963).  Saving model ...
Epoch: 9 cost time: 0.866410493850708
Epoch: 9, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.086 Vali Acc: 0.460 Test Loss: 4.086 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8545517921447754
Epoch: 10, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.693 Vali Acc: 0.520 Test Loss: 4.693 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.861985445022583
Epoch: 11, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.030 Vali Acc: 0.560 Test Loss: 4.030 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8602316379547119
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.028 Vali Acc: 0.540 Test Loss: 4.028 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8588540554046631
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.896 Vali Acc: 0.540 Test Loss: 3.896 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8612861633300781
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.399 Vali Acc: 0.520 Test Loss: 4.399 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8475697040557861
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.471 Vali Acc: 0.520 Test Loss: 4.471 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8810238838195801
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.872 Vali Acc: 0.480 Test Loss: 4.872 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.877589225769043
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.888 Vali Acc: 0.520 Test Loss: 4.888 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8708887100219727
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.207 Vali Acc: 0.540 Test Loss: 5.207 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps54_str27_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 121805093
model size : 465.32MB
2025-04-27 20:28:47.569772: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:28:47.589035: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785727.611392 1473034 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785727.618139 1473034 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:28:47.640802: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 1.8051860332489014
Epoch: 1, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.592 Vali Acc: 0.280 Test Loss: 1.592 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 0.891486644744873
Epoch: 2, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.524 Vali Acc: 0.380 Test Loss: 1.524 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 0.8487956523895264
Epoch: 3, Steps: 4 | Train Loss: 0.517 Vali Loss: 1.688 Vali Acc: 0.480 Test Loss: 1.688 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479983).  Saving model ...
Epoch: 4 cost time: 0.8640339374542236
Epoch: 4, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.983 Vali Acc: 0.540 Test Loss: 1.983 Test Acc: 0.540
Validation loss decreased (-0.479983 --> -0.539980).  Saving model ...
Epoch: 5 cost time: 0.8790204524993896
Epoch: 5, Steps: 4 | Train Loss: 0.220 Vali Loss: 2.368 Vali Acc: 0.600 Test Loss: 2.368 Test Acc: 0.600
Validation loss decreased (-0.539980 --> -0.599976).  Saving model ...
Epoch: 6 cost time: 0.867426872253418
Epoch: 6, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.669 Vali Acc: 0.600 Test Loss: 2.669 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8761060237884521
Epoch: 7, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.097 Vali Acc: 0.580 Test Loss: 3.097 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8640506267547607
Epoch: 8, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.416 Vali Acc: 0.560 Test Loss: 3.416 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8668253421783447
Epoch: 9, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.659 Vali Acc: 0.500 Test Loss: 3.659 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8613495826721191
Epoch: 10, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.644 Vali Acc: 0.480 Test Loss: 3.644 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8553872108459473
Epoch: 11, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.919 Vali Acc: 0.480 Test Loss: 3.919 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8744356632232666
Epoch: 12, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.948 Vali Acc: 0.440 Test Loss: 3.948 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8756344318389893
Epoch: 13, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.127 Vali Acc: 0.460 Test Loss: 4.127 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8505344390869141
Epoch: 14, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.296 Vali Acc: 0.480 Test Loss: 4.296 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8411397933959961
Epoch: 15, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.421 Vali Acc: 0.480 Test Loss: 4.421 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ModernTCN_UEA_ftM_sl270_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps68_str34_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 121159941
model size : 462.86MB
