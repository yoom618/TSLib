Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.994980812072754
Epoch: 1, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.389 Vali Acc: 0.255 Test Loss: 1.389 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.2484066486358643
Epoch: 2, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.390 Vali Acc: 0.262 Test Loss: 1.390 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262344).  Saving model ...
Epoch: 3 cost time: 1.276599407196045
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (-0.262344 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.270137071609497
Epoch: 4, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.420 Vali Acc: 0.243 Test Loss: 1.420 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4621014595031738
Epoch: 5, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3678526878356934
Epoch: 6, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.422 Vali Acc: 0.281 Test Loss: 1.422 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281355).  Saving model ...
Epoch: 7 cost time: 1.3004341125488281
Epoch: 7, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.470 Vali Acc: 0.281 Test Loss: 1.470 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3055830001831055
Epoch: 8, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4279658794403076
Epoch: 9, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.551 Vali Acc: 0.289 Test Loss: 1.551 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288958).  Saving model ...
Epoch: 10 cost time: 1.4965813159942627
Epoch: 10, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.556 Vali Acc: 0.262 Test Loss: 1.556 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5023510456085205
Epoch: 11, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.643 Vali Acc: 0.285 Test Loss: 1.643 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3766939640045166
Epoch: 12, Steps: 17 | Train Loss: 0.811 Vali Loss: 1.724 Vali Acc: 0.304 Test Loss: 1.724 Test Acc: 0.304
Validation loss decreased (-0.288958 --> -0.304165).  Saving model ...
Epoch: 13 cost time: 1.3696942329406738
Epoch: 13, Steps: 17 | Train Loss: 0.782 Vali Loss: 1.779 Vali Acc: 0.285 Test Loss: 1.779 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3976664543151855
Epoch: 14, Steps: 17 | Train Loss: 0.732 Vali Loss: 1.884 Vali Acc: 0.274 Test Loss: 1.884 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4557466506958008
Epoch: 15, Steps: 17 | Train Loss: 0.693 Vali Loss: 1.991 Vali Acc: 0.262 Test Loss: 1.991 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4354918003082275
Epoch: 16, Steps: 17 | Train Loss: 0.666 Vali Loss: 2.152 Vali Acc: 0.278 Test Loss: 2.152 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3867225646972656
Epoch: 17, Steps: 17 | Train Loss: 0.620 Vali Loss: 2.322 Vali Acc: 0.262 Test Loss: 2.322 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4164488315582275
Epoch: 18, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.374 Vali Acc: 0.278 Test Loss: 2.374 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4802706241607666
Epoch: 19, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.466 Vali Acc: 0.255 Test Loss: 2.466 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5961344242095947
Epoch: 20, Steps: 17 | Train Loss: 0.551 Vali Loss: 2.646 Vali Acc: 0.266 Test Loss: 2.646 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4928276538848877
Epoch: 21, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.787 Vali Acc: 0.243 Test Loss: 2.787 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4805347919464111
Epoch: 22, Steps: 17 | Train Loss: 0.501 Vali Loss: 2.847 Vali Acc: 0.270 Test Loss: 2.847 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 607268
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7106292247772217
Epoch: 1, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.382 Vali Acc: 0.278 Test Loss: 1.382 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 1.3635871410369873
Epoch: 2, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.387 Vali Acc: 0.289 Test Loss: 1.387 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288960).  Saving model ...
Epoch: 3 cost time: 1.1685676574707031
Epoch: 3, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.387 Vali Acc: 0.259 Test Loss: 1.387 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.306412935256958
Epoch: 4, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.371260643005371
Epoch: 5, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.396 Vali Acc: 0.281 Test Loss: 1.396 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.375577449798584
Epoch: 6, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3412067890167236
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.422 Vali Acc: 0.285 Test Loss: 1.422 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5102035999298096
Epoch: 8, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.435 Vali Acc: 0.285 Test Loss: 1.435 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4474544525146484
Epoch: 9, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.435 Vali Acc: 0.266 Test Loss: 1.435 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4322893619537354
Epoch: 10, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.433 Vali Acc: 0.266 Test Loss: 1.433 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3869447708129883
Epoch: 11, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.479 Vali Acc: 0.297 Test Loss: 1.479 Test Acc: 0.297
Validation loss decreased (-0.288960 --> -0.296563).  Saving model ...
Epoch: 12 cost time: 1.2587616443634033
Epoch: 12, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.492 Vali Acc: 0.266 Test Loss: 1.492 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.252096176147461
Epoch: 13, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.540 Vali Acc: 0.259 Test Loss: 1.540 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.218886137008667
Epoch: 14, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.562 Vali Acc: 0.255 Test Loss: 1.562 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.271937608718872
Epoch: 15, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.625 Vali Acc: 0.247 Test Loss: 1.625 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.245875597000122
Epoch: 16, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.734 Vali Acc: 0.255 Test Loss: 1.734 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2760272026062012
Epoch: 17, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.683 Vali Acc: 0.259 Test Loss: 1.683 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.274895191192627
Epoch: 18, Steps: 17 | Train Loss: 0.727 Vali Loss: 1.830 Vali Acc: 0.228 Test Loss: 1.830 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3643584251403809
Epoch: 19, Steps: 17 | Train Loss: 0.719 Vali Loss: 1.896 Vali Acc: 0.266 Test Loss: 1.896 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.541069507598877
Epoch: 20, Steps: 17 | Train Loss: 0.701 Vali Loss: 1.999 Vali Acc: 0.262 Test Loss: 1.999 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.533369779586792
Epoch: 21, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.981 Vali Acc: 0.251 Test Loss: 1.981 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 593316
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.706779718399048
Epoch: 1, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.402 Vali Acc: 0.240 Test Loss: 1.402 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.2082579135894775
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.395 Vali Acc: 0.274 Test Loss: 1.395 Test Acc: 0.274
Validation loss decreased (-0.239530 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.104491949081421
Epoch: 3, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.408 Vali Acc: 0.240 Test Loss: 1.408 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.306659460067749
Epoch: 4, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3004546165466309
Epoch: 5, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2102727890014648
Epoch: 6, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.422 Vali Acc: 0.221 Test Loss: 1.422 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3057610988616943
Epoch: 7, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.432 Vali Acc: 0.236 Test Loss: 1.432 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1886308193206787
Epoch: 8, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.442 Vali Acc: 0.259 Test Loss: 1.442 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.145766258239746
Epoch: 9, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.474 Vali Acc: 0.247 Test Loss: 1.474 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2903900146484375
Epoch: 10, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.473 Vali Acc: 0.281 Test Loss: 1.473 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 11 cost time: 1.2650575637817383
Epoch: 11, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.479 Vali Acc: 0.247 Test Loss: 1.479 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.204763650894165
Epoch: 12, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.255169153213501
Epoch: 13, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.582 Vali Acc: 0.259 Test Loss: 1.582 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1505014896392822
Epoch: 14, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.597 Vali Acc: 0.285 Test Loss: 1.597 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 15 cost time: 1.2701728343963623
Epoch: 15, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.623 Vali Acc: 0.262 Test Loss: 1.623 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3274328708648682
Epoch: 16, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.636 Vali Acc: 0.236 Test Loss: 1.636 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3032174110412598
Epoch: 17, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.733 Vali Acc: 0.240 Test Loss: 1.733 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.092881679534912
Epoch: 18, Steps: 17 | Train Loss: 0.823 Vali Loss: 1.623 Vali Acc: 0.251 Test Loss: 1.623 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.182939052581787
Epoch: 19, Steps: 17 | Train Loss: 0.814 Vali Loss: 1.734 Vali Acc: 0.281 Test Loss: 1.734 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1474337577819824
Epoch: 20, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.859 Vali Acc: 0.247 Test Loss: 1.859 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3268098831176758
Epoch: 21, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.786 Vali Acc: 0.251 Test Loss: 1.786 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2928016185760498
Epoch: 22, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.762 Vali Acc: 0.262 Test Loss: 1.762 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.294795274734497
Epoch: 23, Steps: 17 | Train Loss: 0.743 Vali Loss: 2.052 Vali Acc: 0.251 Test Loss: 2.052 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3496370315551758
Epoch: 24, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.268 Vali Acc: 0.281 Test Loss: 2.268 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 590116
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6500449180603027
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.388 Vali Acc: 0.247 Test Loss: 1.388 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.1049883365631104
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.382 Vali Acc: 0.240 Test Loss: 1.382 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1698131561279297
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.394 Vali Acc: 0.236 Test Loss: 1.394 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2278919219970703
Epoch: 4, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.3365962505340576
Epoch: 5, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.392 Vali Acc: 0.274 Test Loss: 1.392 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 1.284672498703003
Epoch: 6, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.398 Vali Acc: 0.285 Test Loss: 1.398 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285157).  Saving model ...
Epoch: 7 cost time: 1.430098533630371
Epoch: 7, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.408 Vali Acc: 0.255 Test Loss: 1.408 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.36083984375
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.407 Vali Acc: 0.262 Test Loss: 1.407 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.362691879272461
Epoch: 9, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.415 Vali Acc: 0.247 Test Loss: 1.415 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.139561414718628
Epoch: 10, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.417 Vali Acc: 0.247 Test Loss: 1.417 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0748000144958496
Epoch: 11, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.453 Vali Acc: 0.266 Test Loss: 1.453 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0860822200775146
Epoch: 12, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.435 Vali Acc: 0.278 Test Loss: 1.435 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0206072330474854
Epoch: 13, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.451 Vali Acc: 0.251 Test Loss: 1.451 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1583712100982666
Epoch: 14, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.500 Vali Acc: 0.259 Test Loss: 1.500 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2892498970031738
Epoch: 15, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.540 Vali Acc: 0.270 Test Loss: 1.540 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3550989627838135
Epoch: 16, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.539 Vali Acc: 0.247 Test Loss: 1.539 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 588452
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.5153090953826904
Epoch: 1, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.1456069946289062
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.386 Vali Acc: 0.247 Test Loss: 1.386 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1710121631622314
Epoch: 3, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.392 Vali Acc: 0.251 Test Loss: 1.392 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2254528999328613
Epoch: 4, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.398 Vali Acc: 0.232 Test Loss: 1.398 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.28208327293396
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.397 Vali Acc: 0.221 Test Loss: 1.397 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2525620460510254
Epoch: 6, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.406 Vali Acc: 0.240 Test Loss: 1.406 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3008997440338135
Epoch: 7, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.405 Vali Acc: 0.240 Test Loss: 1.405 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2851245403289795
Epoch: 8, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.407 Vali Acc: 0.232 Test Loss: 1.407 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2913641929626465
Epoch: 9, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.286367654800415
Epoch: 10, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.467 Vali Acc: 0.236 Test Loss: 1.467 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2342925071716309
Epoch: 11, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.476 Vali Acc: 0.274 Test Loss: 1.476 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273749).  Saving model ...
Epoch: 12 cost time: 1.2022738456726074
Epoch: 12, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.478 Vali Acc: 0.228 Test Loss: 1.478 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0771095752716064
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.484 Vali Acc: 0.213 Test Loss: 1.484 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1953105926513672
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.519 Vali Acc: 0.217 Test Loss: 1.519 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2764286994934082
Epoch: 15, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.504 Vali Acc: 0.232 Test Loss: 1.504 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.244096279144287
Epoch: 16, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.581 Vali Acc: 0.243 Test Loss: 1.581 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.22896409034729
Epoch: 17, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.638 Vali Acc: 0.251 Test Loss: 1.638 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2614703178405762
Epoch: 18, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.635 Vali Acc: 0.221 Test Loss: 1.635 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1928682327270508
Epoch: 19, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.691 Vali Acc: 0.255 Test Loss: 1.691 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.288301944732666
Epoch: 20, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.765 Vali Acc: 0.240 Test Loss: 1.765 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2775044441223145
Epoch: 21, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.749 Vali Acc: 0.251 Test Loss: 1.749 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 589700
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6631507873535156
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 1.285193920135498
Epoch: 2, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.391 Vali Acc: 0.262 Test Loss: 1.391 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2376224994659424
Epoch: 3, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.395 Vali Acc: 0.240 Test Loss: 1.395 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2059919834136963
Epoch: 4, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.399 Vali Acc: 0.240 Test Loss: 1.399 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0246591567993164
Epoch: 5, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2686553001403809
Epoch: 6, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.417 Vali Acc: 0.217 Test Loss: 1.417 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2130100727081299
Epoch: 7, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.420 Vali Acc: 0.228 Test Loss: 1.420 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.236210584640503
Epoch: 8, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.436 Vali Acc: 0.240 Test Loss: 1.436 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2839887142181396
Epoch: 9, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.464 Vali Acc: 0.224 Test Loss: 1.464 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.31803560256958
Epoch: 10, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3365113735198975
Epoch: 11, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.507 Vali Acc: 0.259 Test Loss: 1.507 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 590980
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.69395112991333
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.408 Vali Acc: 0.232 Test Loss: 1.408 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.2913568019866943
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.388 Vali Acc: 0.240 Test Loss: 1.388 Test Acc: 0.240
Validation loss decreased (-0.231925 --> -0.239530).  Saving model ...
Epoch: 3 cost time: 1.25651216506958
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
Validation loss decreased (-0.239530 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.408604621887207
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3538446426391602
Epoch: 5, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.400 Vali Acc: 0.240 Test Loss: 1.400 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.288780927658081
Epoch: 6, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.393 Vali Acc: 0.255 Test Loss: 1.393 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.295975685119629
Epoch: 7, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.407 Vali Acc: 0.240 Test Loss: 1.407 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1708900928497314
Epoch: 8, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.418 Vali Acc: 0.278 Test Loss: 1.418 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 1.1337575912475586
Epoch: 9, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.434 Vali Acc: 0.243 Test Loss: 1.434 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2810962200164795
Epoch: 10, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.462 Vali Acc: 0.255 Test Loss: 1.462 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1809794902801514
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.448 Vali Acc: 0.259 Test Loss: 1.448 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.19258713722229
Epoch: 12, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.444 Vali Acc: 0.278 Test Loss: 1.444 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2726128101348877
Epoch: 13, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.474 Vali Acc: 0.259 Test Loss: 1.474 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.315887212753296
Epoch: 14, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.538 Vali Acc: 0.259 Test Loss: 1.538 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2530558109283447
Epoch: 15, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4184579849243164
Epoch: 16, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.637 Vali Acc: 0.270 Test Loss: 1.637 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2446458339691162
Epoch: 17, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.699 Vali Acc: 0.251 Test Loss: 1.699 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2873709201812744
Epoch: 18, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.763 Vali Acc: 0.255 Test Loss: 1.763 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 592228
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7465219497680664
Epoch: 1, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.393 Vali Acc: 0.232 Test Loss: 1.393 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.3529179096221924
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.396 Vali Acc: 0.255 Test Loss: 1.396 Test Acc: 0.255
Validation loss decreased (-0.231925 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.3431510925292969
Epoch: 3, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.401 Vali Acc: 0.259 Test Loss: 1.401 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.4534626007080078
Epoch: 4, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.410 Vali Acc: 0.274 Test Loss: 1.410 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.5458097457885742
Epoch: 5, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.424 Vali Acc: 0.266 Test Loss: 1.424 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4491956233978271
Epoch: 6, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.442 Vali Acc: 0.274 Test Loss: 1.442 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4352684020996094
Epoch: 7, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4542064666748047
Epoch: 8, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.462 Vali Acc: 0.285 Test Loss: 1.462 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 1.4441320896148682
Epoch: 9, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.539 Vali Acc: 0.251 Test Loss: 1.539 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4309296607971191
Epoch: 10, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.586 Vali Acc: 0.289 Test Loss: 1.586 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288958).  Saving model ...
Epoch: 11 cost time: 1.4173808097839355
Epoch: 11, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.648 Vali Acc: 0.285 Test Loss: 1.648 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3873262405395508
Epoch: 12, Steps: 17 | Train Loss: 0.813 Vali Loss: 1.766 Vali Acc: 0.304 Test Loss: 1.766 Test Acc: 0.304
Validation loss decreased (-0.288958 --> -0.304165).  Saving model ...
Epoch: 13 cost time: 1.3156373500823975
Epoch: 13, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.791 Vali Acc: 0.278 Test Loss: 1.791 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4331438541412354
Epoch: 14, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.880 Vali Acc: 0.278 Test Loss: 1.880 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4921658039093018
Epoch: 15, Steps: 17 | Train Loss: 0.674 Vali Loss: 2.039 Vali Acc: 0.293 Test Loss: 2.039 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3873190879821777
Epoch: 16, Steps: 17 | Train Loss: 0.639 Vali Loss: 2.172 Vali Acc: 0.232 Test Loss: 2.172 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5153894424438477
Epoch: 17, Steps: 17 | Train Loss: 0.642 Vali Loss: 2.237 Vali Acc: 0.270 Test Loss: 2.237 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5970349311828613
Epoch: 18, Steps: 17 | Train Loss: 0.618 Vali Loss: 2.381 Vali Acc: 0.281 Test Loss: 2.381 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6537418365478516
Epoch: 19, Steps: 17 | Train Loss: 0.579 Vali Loss: 2.494 Vali Acc: 0.293 Test Loss: 2.494 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4571564197540283
Epoch: 20, Steps: 17 | Train Loss: 0.560 Vali Loss: 2.651 Vali Acc: 0.259 Test Loss: 2.651 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.429269790649414
Epoch: 21, Steps: 17 | Train Loss: 0.528 Vali Loss: 2.870 Vali Acc: 0.228 Test Loss: 2.870 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2007150650024414
Epoch: 22, Steps: 17 | Train Loss: 0.515 Vali Loss: 2.842 Vali Acc: 0.285 Test Loss: 2.842 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 604580
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.615089178085327
Epoch: 1, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.385 Vali Acc: 0.259 Test Loss: 1.385 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.526200771331787
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.383 Vali Acc: 0.278 Test Loss: 1.383 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 1.3976473808288574
Epoch: 3, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.386 Vali Acc: 0.289 Test Loss: 1.386 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288960).  Saving model ...
Epoch: 4 cost time: 1.4538118839263916
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.390 Vali Acc: 0.266 Test Loss: 1.390 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1142499446868896
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.388 Vali Acc: 0.266 Test Loss: 1.388 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.174795150756836
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.395 Vali Acc: 0.247 Test Loss: 1.395 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1600291728973389
Epoch: 7, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1381738185882568
Epoch: 8, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.413 Vali Acc: 0.270 Test Loss: 1.413 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.085981845855713
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.277357578277588
Epoch: 10, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.450 Vali Acc: 0.240 Test Loss: 1.450 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2668917179107666
Epoch: 11, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.478 Vali Acc: 0.240 Test Loss: 1.478 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3082151412963867
Epoch: 12, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.501 Vali Acc: 0.240 Test Loss: 1.501 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4642164707183838
Epoch: 13, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.567 Vali Acc: 0.259 Test Loss: 1.567 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 590628
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4942500591278076
Epoch: 1, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.385 Vali Acc: 0.236 Test Loss: 1.385 Test Acc: 0.236
Validation loss decreased (inf --> -0.235728).  Saving model ...
Epoch: 2 cost time: 1.273371696472168
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.379 Vali Acc: 0.247 Test Loss: 1.379 Test Acc: 0.247
Validation loss decreased (-0.235728 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.2271537780761719
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.386 Vali Acc: 0.255 Test Loss: 1.386 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 1.1622860431671143
Epoch: 4, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.386 Vali Acc: 0.259 Test Loss: 1.386 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 1.2464361190795898
Epoch: 5, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.381 Vali Acc: 0.266 Test Loss: 1.381 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 6 cost time: 1.259979248046875
Epoch: 6, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.384 Vali Acc: 0.240 Test Loss: 1.384 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2170894145965576
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.399 Vali Acc: 0.289 Test Loss: 1.399 Test Acc: 0.289
Validation loss decreased (-0.266146 --> -0.288959).  Saving model ...
Epoch: 8 cost time: 1.270017385482788
Epoch: 8, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2342119216918945
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.417 Vali Acc: 0.274 Test Loss: 1.417 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2542316913604736
Epoch: 10, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.468 Vali Acc: 0.255 Test Loss: 1.468 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2931334972381592
Epoch: 11, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.439 Vali Acc: 0.297 Test Loss: 1.439 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296564).  Saving model ...
Epoch: 12 cost time: 1.2051937580108643
Epoch: 12, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.461 Vali Acc: 0.278 Test Loss: 1.461 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2905588150024414
Epoch: 13, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.490 Vali Acc: 0.308 Test Loss: 1.490 Test Acc: 0.308
Validation loss decreased (-0.296564 --> -0.307970).  Saving model ...
Epoch: 14 cost time: 1.1478002071380615
Epoch: 14, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.553 Vali Acc: 0.281 Test Loss: 1.553 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2305445671081543
Epoch: 15, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.603 Vali Acc: 0.278 Test Loss: 1.603 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0962865352630615
Epoch: 16, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.598 Vali Acc: 0.255 Test Loss: 1.598 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1190567016601562
Epoch: 17, Steps: 17 | Train Loss: 0.851 Vali Loss: 1.620 Vali Acc: 0.251 Test Loss: 1.620 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3810224533081055
Epoch: 18, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.706 Vali Acc: 0.285 Test Loss: 1.706 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.186091423034668
Epoch: 19, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.830 Vali Acc: 0.278 Test Loss: 1.830 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3037774562835693
Epoch: 20, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.691 Vali Acc: 0.262 Test Loss: 1.691 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2552175521850586
Epoch: 21, Steps: 17 | Train Loss: 0.750 Vali Loss: 1.916 Vali Acc: 0.281 Test Loss: 1.916 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3554391860961914
Epoch: 22, Steps: 17 | Train Loss: 0.738 Vali Loss: 1.991 Vali Acc: 0.247 Test Loss: 1.991 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3448331356048584
Epoch: 23, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.124 Vali Acc: 0.243 Test Loss: 2.124 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 587428
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8130853176116943
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.397 Vali Acc: 0.240 Test Loss: 1.397 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.3251726627349854
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.385 Vali Acc: 0.236 Test Loss: 1.385 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.197791337966919
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.387 Vali Acc: 0.247 Test Loss: 1.387 Test Acc: 0.247
Validation loss decreased (-0.239530 --> -0.247134).  Saving model ...
Epoch: 4 cost time: 1.4310226440429688
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.386 Vali Acc: 0.232 Test Loss: 1.386 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4430906772613525
Epoch: 5, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 6 cost time: 1.4147851467132568
Epoch: 6, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3916347026824951
Epoch: 7, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0073485374450684
Epoch: 8, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.192436695098877
Epoch: 9, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2317008972167969
Epoch: 10, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1547808647155762
Epoch: 11, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.435 Vali Acc: 0.255 Test Loss: 1.435 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.322671890258789
Epoch: 12, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.435 Vali Acc: 0.266 Test Loss: 1.435 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.191770076751709
Epoch: 13, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.477 Vali Acc: 0.266 Test Loss: 1.477 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.389237403869629
Epoch: 14, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.508 Vali Acc: 0.255 Test Loss: 1.508 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3449180126190186
Epoch: 15, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.513 Vali Acc: 0.243 Test Loss: 1.513 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 585764
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4715816974639893
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.385 Vali Acc: 0.247 Test Loss: 1.385 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.1843483448028564
Epoch: 2, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.380 Vali Acc: 0.262 Test Loss: 1.380 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262344).  Saving model ...
Epoch: 3 cost time: 1.2375340461730957
Epoch: 3, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.386 Vali Acc: 0.251 Test Loss: 1.386 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2785146236419678
Epoch: 4, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.385 Vali Acc: 0.285 Test Loss: 1.385 Test Acc: 0.285
Validation loss decreased (-0.262344 --> -0.285157).  Saving model ...
Epoch: 5 cost time: 1.3140535354614258
Epoch: 5, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.394 Vali Acc: 0.247 Test Loss: 1.394 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2902023792266846
Epoch: 6, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3267827033996582
Epoch: 7, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1960484981536865
Epoch: 8, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.419 Vali Acc: 0.232 Test Loss: 1.419 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.330702543258667
Epoch: 9, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4202499389648438
Epoch: 10, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.436 Vali Acc: 0.243 Test Loss: 1.436 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2631757259368896
Epoch: 11, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.433 Vali Acc: 0.247 Test Loss: 1.433 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2440166473388672
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.468 Vali Acc: 0.221 Test Loss: 1.468 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2362275123596191
Epoch: 13, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.455 Vali Acc: 0.240 Test Loss: 1.455 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3271920680999756
Epoch: 14, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.504 Vali Acc: 0.255 Test Loss: 1.504 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 587012
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.687793016433716
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.1970388889312744
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.236 Test Loss: 1.384 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.221555233001709
Epoch: 3, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.389 Vali Acc: 0.266 Test Loss: 1.389 Test Acc: 0.266
Validation loss decreased (-0.243332 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.2369070053100586
Epoch: 4, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.392 Vali Acc: 0.255 Test Loss: 1.392 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2577149868011475
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.395 Vali Acc: 0.232 Test Loss: 1.395 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2141366004943848
Epoch: 6, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.400 Vali Acc: 0.266 Test Loss: 1.400 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3064780235290527
Epoch: 7, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.411 Vali Acc: 0.240 Test Loss: 1.411 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2811059951782227
Epoch: 8, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.436 Vali Acc: 0.240 Test Loss: 1.436 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2002956867218018
Epoch: 9, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.450 Vali Acc: 0.262 Test Loss: 1.450 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1708810329437256
Epoch: 10, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.482 Vali Acc: 0.228 Test Loss: 1.482 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1393799781799316
Epoch: 11, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1237945556640625
Epoch: 12, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.477 Vali Acc: 0.240 Test Loss: 1.477 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2736263275146484
Epoch: 13, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.509 Vali Acc: 0.247 Test Loss: 1.509 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 588292
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.636854648590088
Epoch: 1, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.398 Vali Acc: 0.240 Test Loss: 1.398 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.2147698402404785
Epoch: 2, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.405 Vali Acc: 0.236 Test Loss: 1.405 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1928126811981201
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.396 Vali Acc: 0.266 Test Loss: 1.396 Test Acc: 0.266
Validation loss decreased (-0.239530 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.2012486457824707
Epoch: 4, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.392 Vali Acc: 0.247 Test Loss: 1.392 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2484526634216309
Epoch: 5, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.235687255859375
Epoch: 6, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2815678119659424
Epoch: 7, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.400 Vali Acc: 0.232 Test Loss: 1.400 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4102048873901367
Epoch: 8, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.298095464706421
Epoch: 9, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.453 Vali Acc: 0.240 Test Loss: 1.453 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3001327514648438
Epoch: 10, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.442 Vali Acc: 0.224 Test Loss: 1.442 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3422372341156006
Epoch: 11, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.452 Vali Acc: 0.240 Test Loss: 1.452 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3417627811431885
Epoch: 12, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.545 Vali Acc: 0.240 Test Loss: 1.545 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3100476264953613
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.517 Vali Acc: 0.236 Test Loss: 1.517 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 589540
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4149181842803955
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.412 Vali Acc: 0.251 Test Loss: 1.412 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 2.219642162322998
Epoch: 2, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.435 Vali Acc: 0.274 Test Loss: 1.435 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 2.1609792709350586
Epoch: 3, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.466 Vali Acc: 0.262 Test Loss: 1.466 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2141435146331787
Epoch: 4, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.554 Vali Acc: 0.240 Test Loss: 1.554 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1605772972106934
Epoch: 5, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.560 Vali Acc: 0.285 Test Loss: 1.560 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285155).  Saving model ...
Epoch: 6 cost time: 2.065293073654175
Epoch: 6, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.715 Vali Acc: 0.266 Test Loss: 1.715 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.018764019012451
Epoch: 7, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.890 Vali Acc: 0.270 Test Loss: 1.890 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.002685070037842
Epoch: 8, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.952 Vali Acc: 0.240 Test Loss: 1.952 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6463816165924072
Epoch: 9, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.878 Vali Acc: 0.251 Test Loss: 1.878 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6022820472717285
Epoch: 10, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.190 Vali Acc: 0.228 Test Loss: 2.190 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9001843929290771
Epoch: 11, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.301 Vali Acc: 0.243 Test Loss: 2.301 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9320836067199707
Epoch: 12, Steps: 17 | Train Loss: 0.612 Vali Loss: 2.760 Vali Acc: 0.243 Test Loss: 2.760 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9407765865325928
Epoch: 13, Steps: 17 | Train Loss: 0.639 Vali Loss: 2.845 Vali Acc: 0.240 Test Loss: 2.845 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.110142230987549
Epoch: 14, Steps: 17 | Train Loss: 0.512 Vali Loss: 3.094 Vali Acc: 0.232 Test Loss: 3.094 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.12768816947937
Epoch: 15, Steps: 17 | Train Loss: 0.469 Vali Loss: 3.440 Vali Acc: 0.255 Test Loss: 3.440 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2226308
model size : 8.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1715586185455322
Epoch: 1, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.772871971130371
Epoch: 2, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.410 Vali Acc: 0.266 Test Loss: 1.410 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9045460224151611
Epoch: 3, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.699913740158081
Epoch: 4, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.458 Vali Acc: 0.262 Test Loss: 1.458 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6122143268585205
Epoch: 5, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.486 Vali Acc: 0.262 Test Loss: 1.486 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.697350263595581
Epoch: 6, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.608 Vali Acc: 0.270 Test Loss: 1.608 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6128718852996826
Epoch: 7, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.622 Vali Acc: 0.255 Test Loss: 1.622 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.825011968612671
Epoch: 8, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8322415351867676
Epoch: 9, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.728 Vali Acc: 0.236 Test Loss: 1.728 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7573978900909424
Epoch: 10, Steps: 17 | Train Loss: 0.770 Vali Loss: 1.851 Vali Acc: 0.259 Test Loss: 1.851 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7794945240020752
Epoch: 11, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.987 Vali Acc: 0.205 Test Loss: 1.987 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 2170500
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9465644359588623
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.392 Vali Acc: 0.232 Test Loss: 1.392 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.6236305236816406
Epoch: 2, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.400 Vali Acc: 0.285 Test Loss: 1.400 Test Acc: 0.285
Validation loss decreased (-0.231925 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 1.578199863433838
Epoch: 3, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.421 Vali Acc: 0.224 Test Loss: 1.421 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6771008968353271
Epoch: 4, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.389 Vali Acc: 0.274 Test Loss: 1.389 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.391122579574585
Epoch: 5, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4210901260375977
Epoch: 6, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4093568325042725
Epoch: 7, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.558 Vali Acc: 0.285 Test Loss: 1.558 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4933099746704102
Epoch: 8, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.552 Vali Acc: 0.247 Test Loss: 1.552 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3980674743652344
Epoch: 9, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.618 Vali Acc: 0.259 Test Loss: 1.618 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4457008838653564
Epoch: 10, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.721 Vali Acc: 0.251 Test Loss: 1.721 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.487886667251587
Epoch: 11, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.742 Vali Acc: 0.232 Test Loss: 1.742 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5605812072753906
Epoch: 12, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.901 Vali Acc: 0.259 Test Loss: 1.901 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2154628
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.760709762573242
Epoch: 1, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.387 Vali Acc: 0.259 Test Loss: 1.387 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.134455919265747
Epoch: 2, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.427 Vali Acc: 0.221 Test Loss: 1.427 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.509037733078003
Epoch: 3, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.399 Vali Acc: 0.259 Test Loss: 1.399 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4736511707305908
Epoch: 4, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.431 Vali Acc: 0.236 Test Loss: 1.431 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4707274436950684
Epoch: 5, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4754514694213867
Epoch: 6, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.443 Vali Acc: 0.205 Test Loss: 1.443 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5398292541503906
Epoch: 7, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.467 Vali Acc: 0.251 Test Loss: 1.467 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4897911548614502
Epoch: 8, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.596 Vali Acc: 0.236 Test Loss: 1.596 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4842915534973145
Epoch: 9, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.592 Vali Acc: 0.228 Test Loss: 1.592 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5074806213378906
Epoch: 10, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.692 Vali Acc: 0.243 Test Loss: 1.692 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4537022113800049
Epoch: 11, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.813 Vali Acc: 0.255 Test Loss: 1.813 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 2151044
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.975074529647827
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.383 Vali Acc: 0.247 Test Loss: 1.383 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.7196598052978516
Epoch: 2, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.386 Vali Acc: 0.247 Test Loss: 1.386 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5624523162841797
Epoch: 3, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.410 Vali Acc: 0.209 Test Loss: 1.410 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7814903259277344
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.401 Vali Acc: 0.228 Test Loss: 1.401 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7676777839660645
Epoch: 5, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.436 Vali Acc: 0.240 Test Loss: 1.436 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6580924987792969
Epoch: 6, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.476 Vali Acc: 0.247 Test Loss: 1.476 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.579145908355713
Epoch: 7, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.442 Vali Acc: 0.232 Test Loss: 1.442 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.442594289779663
Epoch: 8, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.466 Vali Acc: 0.228 Test Loss: 1.466 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6081769466400146
Epoch: 9, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.589 Vali Acc: 0.262 Test Loss: 1.589 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262342).  Saving model ...
Epoch: 10 cost time: 1.808293342590332
Epoch: 10, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.564 Vali Acc: 0.236 Test Loss: 1.564 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7648897171020508
Epoch: 11, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.623 Vali Acc: 0.236 Test Loss: 1.623 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7447478771209717
Epoch: 12, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.630 Vali Acc: 0.243 Test Loss: 1.630 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8460452556610107
Epoch: 13, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.732 Vali Acc: 0.274 Test Loss: 1.732 Test Acc: 0.274
Validation loss decreased (-0.262342 --> -0.273747).  Saving model ...
Epoch: 14 cost time: 1.775533676147461
Epoch: 14, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.720 Vali Acc: 0.251 Test Loss: 1.720 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5961496829986572
Epoch: 15, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.857 Vali Acc: 0.240 Test Loss: 1.857 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5484859943389893
Epoch: 16, Steps: 17 | Train Loss: 0.781 Vali Loss: 1.902 Vali Acc: 0.251 Test Loss: 1.902 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5263664722442627
Epoch: 17, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.030 Vali Acc: 0.232 Test Loss: 2.030 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6417467594146729
Epoch: 18, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.018 Vali Acc: 0.259 Test Loss: 2.018 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6219911575317383
Epoch: 19, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.113 Vali Acc: 0.255 Test Loss: 2.113 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7836308479309082
Epoch: 20, Steps: 17 | Train Loss: 0.716 Vali Loss: 2.439 Vali Acc: 0.240 Test Loss: 2.439 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7691943645477295
Epoch: 21, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.346 Vali Acc: 0.266 Test Loss: 2.346 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7802772521972656
Epoch: 22, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.300 Vali Acc: 0.240 Test Loss: 2.300 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7854673862457275
Epoch: 23, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.464 Vali Acc: 0.213 Test Loss: 2.464 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 2152964
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9402012825012207
Epoch: 1, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.6662626266479492
Epoch: 2, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.407 Vali Acc: 0.240 Test Loss: 1.407 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.712113380432129
Epoch: 3, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.401 Vali Acc: 0.285 Test Loss: 1.401 Test Acc: 0.285
Validation loss decreased (-0.243332 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 1.7415380477905273
Epoch: 4, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.478 Vali Acc: 0.232 Test Loss: 1.478 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6108522415161133
Epoch: 5, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.427 Vali Acc: 0.213 Test Loss: 1.427 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5279221534729004
Epoch: 6, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.436 Vali Acc: 0.270 Test Loss: 1.436 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5683965682983398
Epoch: 7, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.453 Vali Acc: 0.232 Test Loss: 1.453 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5005066394805908
Epoch: 8, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.493 Vali Acc: 0.255 Test Loss: 1.493 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6175391674041748
Epoch: 9, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.514 Vali Acc: 0.247 Test Loss: 1.514 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6578640937805176
Epoch: 10, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.589 Vali Acc: 0.274 Test Loss: 1.589 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7376940250396729
Epoch: 11, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.624 Vali Acc: 0.247 Test Loss: 1.624 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.573122262954712
Epoch: 12, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.721 Vali Acc: 0.243 Test Loss: 1.721 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6227326393127441
Epoch: 13, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.733 Vali Acc: 0.221 Test Loss: 1.733 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2158084
model size : 8.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8290131092071533
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.380 Vali Acc: 0.240 Test Loss: 1.380 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.495588779449463
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.392 Vali Acc: 0.255 Test Loss: 1.392 Test Acc: 0.255
Validation loss decreased (-0.239530 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.4343767166137695
Epoch: 3, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.380 Vali Acc: 0.259 Test Loss: 1.380 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.4131662845611572
Epoch: 4, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.402 Vali Acc: 0.251 Test Loss: 1.402 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.476464033126831
Epoch: 5, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.404 Vali Acc: 0.274 Test Loss: 1.404 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 1.4228684902191162
Epoch: 6, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.420 Vali Acc: 0.213 Test Loss: 1.420 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4326303005218506
Epoch: 7, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.491 Vali Acc: 0.217 Test Loss: 1.491 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3543586730957031
Epoch: 8, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.503 Vali Acc: 0.232 Test Loss: 1.503 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.48838472366333
Epoch: 9, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.581 Vali Acc: 0.236 Test Loss: 1.581 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.522904634475708
Epoch: 10, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.521 Vali Acc: 0.270 Test Loss: 1.521 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5363950729370117
Epoch: 11, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.672 Vali Acc: 0.266 Test Loss: 1.672 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5303709506988525
Epoch: 12, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.583 Vali Acc: 0.259 Test Loss: 1.583 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4242501258850098
Epoch: 13, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.678 Vali Acc: 0.251 Test Loss: 1.678 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4490981101989746
Epoch: 14, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.759 Vali Acc: 0.247 Test Loss: 1.759 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4432001113891602
Epoch: 15, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.924 Vali Acc: 0.251 Test Loss: 1.924 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 2166148
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8889245986938477
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.381 Vali Acc: 0.274 Test Loss: 1.381 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.15775728225708
Epoch: 2, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.167898178100586
Epoch: 3, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.450 Vali Acc: 0.236 Test Loss: 1.450 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.143214225769043
Epoch: 4, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.434 Vali Acc: 0.297 Test Loss: 1.434 Test Acc: 0.297
Validation loss decreased (-0.273750 --> -0.296564).  Saving model ...
Epoch: 5 cost time: 1.1736197471618652
Epoch: 5, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.459 Vali Acc: 0.304 Test Loss: 1.459 Test Acc: 0.304
Validation loss decreased (-0.296564 --> -0.304168).  Saving model ...
Epoch: 6 cost time: 1.1671638488769531
Epoch: 6, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.491 Vali Acc: 0.266 Test Loss: 1.491 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5393671989440918
Epoch: 7, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.511 Vali Acc: 0.300 Test Loss: 1.511 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4608635902404785
Epoch: 8, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.565 Vali Acc: 0.262 Test Loss: 1.565 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4893672466278076
Epoch: 9, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.673 Vali Acc: 0.262 Test Loss: 1.673 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4532153606414795
Epoch: 10, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.775 Vali Acc: 0.259 Test Loss: 1.775 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4251291751861572
Epoch: 11, Steps: 17 | Train Loss: 0.802 Vali Loss: 1.880 Vali Acc: 0.266 Test Loss: 1.880 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.48787522315979
Epoch: 12, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.016 Vali Acc: 0.278 Test Loss: 2.016 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3261709213256836
Epoch: 13, Steps: 17 | Train Loss: 0.659 Vali Loss: 2.227 Vali Acc: 0.285 Test Loss: 2.227 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2973198890686035
Epoch: 14, Steps: 17 | Train Loss: 0.617 Vali Loss: 2.319 Vali Acc: 0.251 Test Loss: 2.319 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1900873184204102
Epoch: 15, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.362 Vali Acc: 0.274 Test Loss: 2.362 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 605252
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.5934131145477295
Epoch: 1, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.392 Vali Acc: 0.289 Test Loss: 1.392 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 1.170027732849121
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0772571563720703
Epoch: 3, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.402 Vali Acc: 0.262 Test Loss: 1.402 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2248449325561523
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.406 Vali Acc: 0.293 Test Loss: 1.406 Test Acc: 0.293
Validation loss decreased (-0.288959 --> -0.292762).  Saving model ...
Epoch: 5 cost time: 1.1015291213989258
Epoch: 5, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0870544910430908
Epoch: 6, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.460 Vali Acc: 0.228 Test Loss: 1.460 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0466599464416504
Epoch: 7, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.435 Vali Acc: 0.251 Test Loss: 1.435 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1992182731628418
Epoch: 8, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.470 Vali Acc: 0.274 Test Loss: 1.470 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1801724433898926
Epoch: 9, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.544 Vali Acc: 0.262 Test Loss: 1.544 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1700584888458252
Epoch: 10, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.510 Vali Acc: 0.255 Test Loss: 1.510 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1861186027526855
Epoch: 11, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.575 Vali Acc: 0.232 Test Loss: 1.575 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1681649684906006
Epoch: 12, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.664 Vali Acc: 0.251 Test Loss: 1.664 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.169917106628418
Epoch: 13, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.720 Vali Acc: 0.251 Test Loss: 1.720 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.161111831665039
Epoch: 14, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.824 Vali Acc: 0.255 Test Loss: 1.824 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 577348
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3187358379364014
Epoch: 1, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.385 Vali Acc: 0.289 Test Loss: 1.385 Test Acc: 0.289
Validation loss decreased (inf --> -0.288960).  Saving model ...
Epoch: 2 cost time: 1.140423059463501
Epoch: 2, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.391 Vali Acc: 0.281 Test Loss: 1.391 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0879244804382324
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.388 Vali Acc: 0.255 Test Loss: 1.388 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1348347663879395
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1476097106933594
Epoch: 5, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.402 Vali Acc: 0.259 Test Loss: 1.402 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1210072040557861
Epoch: 6, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1497044563293457
Epoch: 7, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.421 Vali Acc: 0.278 Test Loss: 1.421 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1301233768463135
Epoch: 8, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.438 Vali Acc: 0.228 Test Loss: 1.438 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1621589660644531
Epoch: 9, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.451 Vali Acc: 0.228 Test Loss: 1.451 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1542644500732422
Epoch: 10, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.468 Vali Acc: 0.240 Test Loss: 1.468 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0788414478302002
Epoch: 11, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.532 Vali Acc: 0.213 Test Loss: 1.532 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 569412
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.385197162628174
Epoch: 1, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.392 Vali Acc: 0.319 Test Loss: 1.392 Test Acc: 0.319
Validation loss decreased (inf --> -0.319378).  Saving model ...
Epoch: 2 cost time: 1.1865184307098389
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.389 Vali Acc: 0.232 Test Loss: 1.389 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0849103927612305
Epoch: 3, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1204123497009277
Epoch: 4, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.378 Vali Acc: 0.228 Test Loss: 1.378 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1128747463226318
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8554437160491943
Epoch: 6, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.407 Vali Acc: 0.232 Test Loss: 1.407 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0447254180908203
Epoch: 7, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.415 Vali Acc: 0.224 Test Loss: 1.415 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0180509090423584
Epoch: 8, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.467 Vali Acc: 0.228 Test Loss: 1.467 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9787054061889648
Epoch: 9, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1113255023956299
Epoch: 10, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.469 Vali Acc: 0.236 Test Loss: 1.469 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.065643548965454
Epoch: 11, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.511 Vali Acc: 0.251 Test Loss: 1.511 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 567620
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.229036808013916
Epoch: 1, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.366 Vali Acc: 0.259 Test Loss: 1.366 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.0729303359985352
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.367 Vali Acc: 0.281 Test Loss: 1.367 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.0416228771209717
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.369 Vali Acc: 0.259 Test Loss: 1.369 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0476853847503662
Epoch: 4, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.370 Vali Acc: 0.251 Test Loss: 1.370 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0429646968841553
Epoch: 5, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.382 Vali Acc: 0.262 Test Loss: 1.382 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0291876792907715
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.375 Vali Acc: 0.266 Test Loss: 1.375 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0429999828338623
Epoch: 7, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.387 Vali Acc: 0.262 Test Loss: 1.387 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0254294872283936
Epoch: 8, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.387 Vali Acc: 0.228 Test Loss: 1.387 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.01591157913208
Epoch: 9, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.417 Vali Acc: 0.255 Test Loss: 1.417 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0144050121307373
Epoch: 10, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9477427005767822
Epoch: 11, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.418 Vali Acc: 0.281 Test Loss: 1.418 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0297627449035645
Epoch: 12, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.434 Vali Acc: 0.247 Test Loss: 1.434 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 568580
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3216843605041504
Epoch: 1, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.0781152248382568
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.370 Vali Acc: 0.274 Test Loss: 1.370 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273751).  Saving model ...
Epoch: 3 cost time: 1.123361587524414
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.392 Vali Acc: 0.274 Test Loss: 1.392 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0390303134918213
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.378 Vali Acc: 0.281 Test Loss: 1.378 Test Acc: 0.281
Validation loss decreased (-0.273751 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 1.0155203342437744
Epoch: 5, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.400 Vali Acc: 0.259 Test Loss: 1.400 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9734940528869629
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.387 Vali Acc: 0.262 Test Loss: 1.387 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0060107707977295
Epoch: 7, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.402 Vali Acc: 0.262 Test Loss: 1.402 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.074777364730835
Epoch: 8, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.419 Vali Acc: 0.262 Test Loss: 1.419 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0317795276641846
Epoch: 9, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.435 Vali Acc: 0.251 Test Loss: 1.435 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0602149963378906
Epoch: 10, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.477 Vali Acc: 0.266 Test Loss: 1.477 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0519225597381592
Epoch: 11, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.464 Vali Acc: 0.240 Test Loss: 1.464 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0846948623657227
Epoch: 12, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.472 Vali Acc: 0.243 Test Loss: 1.472 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0342059135437012
Epoch: 13, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.499 Vali Acc: 0.266 Test Loss: 1.499 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0918729305267334
Epoch: 14, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.561 Vali Acc: 0.259 Test Loss: 1.561 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 571140
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4191575050354004
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.397 Vali Acc: 0.221 Test Loss: 1.397 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 1.0111730098724365
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.391 Vali Acc: 0.232 Test Loss: 1.391 Test Acc: 0.232
Validation loss decreased (-0.220518 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.038064956665039
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.395 Vali Acc: 0.259 Test Loss: 1.395 Test Acc: 0.259
Validation loss decreased (-0.231925 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.0314273834228516
Epoch: 4, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.389 Vali Acc: 0.274 Test Loss: 1.389 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 0.9973495006561279
Epoch: 5, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.390 Vali Acc: 0.232 Test Loss: 1.390 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0597970485687256
Epoch: 6, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.399 Vali Acc: 0.251 Test Loss: 1.399 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9482901096343994
Epoch: 7, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.408 Vali Acc: 0.262 Test Loss: 1.408 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9998412132263184
Epoch: 8, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.413 Vali Acc: 0.251 Test Loss: 1.413 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9677462577819824
Epoch: 9, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.430 Vali Acc: 0.243 Test Loss: 1.430 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9919195175170898
Epoch: 10, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.446 Vali Acc: 0.217 Test Loss: 1.446 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9199314117431641
Epoch: 11, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.457 Vali Acc: 0.221 Test Loss: 1.457 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.075728416442871
Epoch: 12, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.477 Vali Acc: 0.247 Test Loss: 1.477 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1064174175262451
Epoch: 13, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.540 Vali Acc: 0.270 Test Loss: 1.540 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1416616439819336
Epoch: 14, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.609 Vali Acc: 0.221 Test Loss: 1.609 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 575172
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.196255683898926
Epoch: 1, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.402 Vali Acc: 0.300 Test Loss: 1.402 Test Acc: 0.300
Validation loss decreased (inf --> -0.300366).  Saving model ...
Epoch: 2 cost time: 0.8873786926269531
Epoch: 2, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.414 Vali Acc: 0.247 Test Loss: 1.414 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9087371826171875
Epoch: 3, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9505195617675781
Epoch: 4, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.420 Vali Acc: 0.247 Test Loss: 1.420 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.888939619064331
Epoch: 5, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1142215728759766
Epoch: 6, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.448 Vali Acc: 0.243 Test Loss: 1.448 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.134469747543335
Epoch: 7, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.465 Vali Acc: 0.304 Test Loss: 1.465 Test Acc: 0.304
Validation loss decreased (-0.300366 --> -0.304168).  Saving model ...
Epoch: 8 cost time: 1.1923243999481201
Epoch: 8, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.148758888244629
Epoch: 9, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.563 Vali Acc: 0.274 Test Loss: 1.563 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1030783653259277
Epoch: 10, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.536 Vali Acc: 0.274 Test Loss: 1.536 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0681748390197754
Epoch: 11, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.606 Vali Acc: 0.289 Test Loss: 1.606 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0807952880859375
Epoch: 12, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.576 Vali Acc: 0.262 Test Loss: 1.576 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0602850914001465
Epoch: 13, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.692 Vali Acc: 0.274 Test Loss: 1.692 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9689075946807861
Epoch: 14, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.723 Vali Acc: 0.285 Test Loss: 1.723 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8977224826812744
Epoch: 15, Steps: 17 | Train Loss: 0.740 Vali Loss: 1.843 Vali Acc: 0.259 Test Loss: 1.843 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9858608245849609
Epoch: 16, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.955 Vali Acc: 0.274 Test Loss: 1.955 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0544483661651611
Epoch: 17, Steps: 17 | Train Loss: 0.687 Vali Loss: 2.018 Vali Acc: 0.304 Test Loss: 2.018 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 175652
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.190383195877075
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.0059974193572998
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.385 Vali Acc: 0.266 Test Loss: 1.385 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 0.9531846046447754
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.390 Vali Acc: 0.293 Test Loss: 1.390 Test Acc: 0.293
Validation loss decreased (-0.266146 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 1.0143322944641113
Epoch: 4, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9206583499908447
Epoch: 5, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.396 Vali Acc: 0.281 Test Loss: 1.396 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8812780380249023
Epoch: 6, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.396 Vali Acc: 0.266 Test Loss: 1.396 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9849593639373779
Epoch: 7, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.411 Vali Acc: 0.232 Test Loss: 1.411 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9326741695404053
Epoch: 8, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.401 Vali Acc: 0.274 Test Loss: 1.401 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9776215553283691
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.397 Vali Acc: 0.262 Test Loss: 1.397 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9877660274505615
Epoch: 10, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.457 Vali Acc: 0.266 Test Loss: 1.457 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9526135921478271
Epoch: 11, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.416 Vali Acc: 0.278 Test Loss: 1.416 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9026222229003906
Epoch: 12, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.436 Vali Acc: 0.255 Test Loss: 1.436 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9871327877044678
Epoch: 13, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.439 Vali Acc: 0.289 Test Loss: 1.439 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 161700
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.258399248123169
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.440 Vali Acc: 0.224 Test Loss: 1.440 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 0.8432471752166748
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.393 Vali Acc: 0.240 Test Loss: 1.393 Test Acc: 0.240
Validation loss decreased (-0.224320 --> -0.239530).  Saving model ...
Epoch: 3 cost time: 0.9828238487243652
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.387 Vali Acc: 0.274 Test Loss: 1.387 Test Acc: 0.274
Validation loss decreased (-0.239530 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.84834885597229
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.388 Vali Acc: 0.251 Test Loss: 1.388 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8982853889465332
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9002282619476318
Epoch: 6, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.390 Vali Acc: 0.251 Test Loss: 1.390 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8948440551757812
Epoch: 7, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.411 Vali Acc: 0.262 Test Loss: 1.411 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9394686222076416
Epoch: 8, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.413 Vali Acc: 0.224 Test Loss: 1.413 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9781770706176758
Epoch: 9, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.421 Vali Acc: 0.251 Test Loss: 1.421 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9268219470977783
Epoch: 10, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.434 Vali Acc: 0.217 Test Loss: 1.434 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.883094310760498
Epoch: 11, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.468 Vali Acc: 0.247 Test Loss: 1.468 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9597792625427246
Epoch: 12, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.458 Vali Acc: 0.236 Test Loss: 1.458 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9467806816101074
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.466 Vali Acc: 0.262 Test Loss: 1.466 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 157732
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.463778018951416
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.380 Vali Acc: 0.243 Test Loss: 1.380 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.97389817237854
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.370 Vali Acc: 0.247 Test Loss: 1.370 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247135).  Saving model ...
Epoch: 3 cost time: 0.8293251991271973
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
Validation loss decreased (-0.247135 --> -0.300367).  Saving model ...
Epoch: 4 cost time: 0.9060125350952148
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.376 Vali Acc: 0.247 Test Loss: 1.376 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9331345558166504
Epoch: 5, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.372 Vali Acc: 0.247 Test Loss: 1.372 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9435369968414307
Epoch: 6, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.368 Vali Acc: 0.259 Test Loss: 1.368 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9243173599243164
Epoch: 7, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.382 Vali Acc: 0.243 Test Loss: 1.382 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9451115131378174
Epoch: 8, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.373 Vali Acc: 0.228 Test Loss: 1.373 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9986751079559326
Epoch: 9, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.393 Vali Acc: 0.255 Test Loss: 1.393 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9281001091003418
Epoch: 10, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.384 Vali Acc: 0.251 Test Loss: 1.384 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9029178619384766
Epoch: 11, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.396 Vali Acc: 0.240 Test Loss: 1.396 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.943434476852417
Epoch: 12, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.405 Vali Acc: 0.236 Test Loss: 1.405 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.95918869972229
Epoch: 13, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.406 Vali Acc: 0.278 Test Loss: 1.406 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 156836
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.424403190612793
Epoch: 1, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.385 Vali Acc: 0.262 Test Loss: 1.385 Test Acc: 0.262
Validation loss decreased (inf --> -0.262344).  Saving model ...
Epoch: 2 cost time: 0.9166581630706787
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.259 Test Loss: 1.387 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9165544509887695
Epoch: 3, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.382 Vali Acc: 0.262 Test Loss: 1.382 Test Acc: 0.262
Validation loss decreased (-0.262344 --> -0.262344).  Saving model ...
Epoch: 4 cost time: 0.9036386013031006
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.381 Vali Acc: 0.259 Test Loss: 1.381 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9127421379089355
Epoch: 5, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.386 Vali Acc: 0.262 Test Loss: 1.386 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8725287914276123
Epoch: 6, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.382 Vali Acc: 0.262 Test Loss: 1.382 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8916537761688232
Epoch: 7, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
Validation loss decreased (-0.262344 --> -0.269948).  Saving model ...
Epoch: 8 cost time: 0.9303696155548096
Epoch: 8, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.394 Vali Acc: 0.259 Test Loss: 1.394 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9179270267486572
Epoch: 9, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.393 Vali Acc: 0.259 Test Loss: 1.393 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9585118293762207
Epoch: 10, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.402 Vali Acc: 0.251 Test Loss: 1.402 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9399611949920654
Epoch: 11, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.405 Vali Acc: 0.266 Test Loss: 1.405 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8862783908843994
Epoch: 12, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.416 Vali Acc: 0.270 Test Loss: 1.416 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9404666423797607
Epoch: 13, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.416 Vali Acc: 0.232 Test Loss: 1.416 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9114749431610107
Epoch: 14, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.428 Vali Acc: 0.259 Test Loss: 1.428 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8982906341552734
Epoch: 15, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.446 Vali Acc: 0.259 Test Loss: 1.446 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9802026748657227
Epoch: 16, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.451 Vali Acc: 0.262 Test Loss: 1.451 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9339652061462402
Epoch: 17, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.478 Vali Acc: 0.266 Test Loss: 1.478 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 157316
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4137160778045654
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.391 Vali Acc: 0.217 Test Loss: 1.391 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 0.8931336402893066
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.387 Vali Acc: 0.236 Test Loss: 1.387 Test Acc: 0.236
Validation loss decreased (-0.216716 --> -0.235728).  Saving model ...
Epoch: 3 cost time: 0.853196382522583
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.387 Vali Acc: 0.224 Test Loss: 1.387 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8287684917449951
Epoch: 4, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
Validation loss decreased (-0.235728 --> -0.266146).  Saving model ...
Epoch: 5 cost time: 0.926210880279541
Epoch: 5, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.391 Vali Acc: 0.228 Test Loss: 1.391 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9159860610961914
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9426281452178955
Epoch: 7, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.403 Vali Acc: 0.228 Test Loss: 1.403 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9718589782714844
Epoch: 8, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.395 Vali Acc: 0.274 Test Loss: 1.395 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 9 cost time: 0.9193236827850342
Epoch: 9, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.421 Vali Acc: 0.251 Test Loss: 1.421 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9548373222351074
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.411 Vali Acc: 0.266 Test Loss: 1.411 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9504988193511963
Epoch: 11, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.431 Vali Acc: 0.236 Test Loss: 1.431 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.909325122833252
Epoch: 12, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.457 Vali Acc: 0.281 Test Loss: 1.457 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 13 cost time: 0.9166147708892822
Epoch: 13, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.436 Vali Acc: 0.259 Test Loss: 1.436 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8250856399536133
Epoch: 14, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.476 Vali Acc: 0.251 Test Loss: 1.476 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7657279968261719
Epoch: 15, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8779726028442383
Epoch: 16, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.580 Vali Acc: 0.251 Test Loss: 1.580 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8542971611022949
Epoch: 17, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.443 Vali Acc: 0.274 Test Loss: 1.443 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.765378475189209
Epoch: 18, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.496 Vali Acc: 0.262 Test Loss: 1.496 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8643748760223389
Epoch: 19, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.522 Vali Acc: 0.266 Test Loss: 1.522 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.888404130935669
Epoch: 20, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.553 Vali Acc: 0.262 Test Loss: 1.553 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9344484806060791
Epoch: 21, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.573 Vali Acc: 0.247 Test Loss: 1.573 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8710587024688721
Epoch: 22, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.655 Vali Acc: 0.278 Test Loss: 1.655 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 158596
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2202959060668945
Epoch: 1, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.388 Vali Acc: 0.259 Test Loss: 1.388 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.8992292881011963
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.266 Test Loss: 1.385 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 0.8853490352630615
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.384 Vali Acc: 0.278 Test Loss: 1.384 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 0.9156382083892822
Epoch: 4, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.384 Vali Acc: 0.278 Test Loss: 1.384 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9594392776489258
Epoch: 5, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.383 Vali Acc: 0.236 Test Loss: 1.383 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9736402034759521
Epoch: 6, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.390 Vali Acc: 0.259 Test Loss: 1.390 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8829562664031982
Epoch: 7, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.389 Vali Acc: 0.251 Test Loss: 1.389 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9434370994567871
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.392 Vali Acc: 0.274 Test Loss: 1.392 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9597325325012207
Epoch: 9, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.91048264503479
Epoch: 10, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9019036293029785
Epoch: 11, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.415 Vali Acc: 0.213 Test Loss: 1.415 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8845810890197754
Epoch: 12, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.414 Vali Acc: 0.289 Test Loss: 1.414 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288959).  Saving model ...
Epoch: 13 cost time: 0.8411087989807129
Epoch: 13, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.450 Vali Acc: 0.255 Test Loss: 1.450 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8911383152008057
Epoch: 14, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8932721614837646
Epoch: 15, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.511 Vali Acc: 0.255 Test Loss: 1.511 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9592819213867188
Epoch: 16, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.460 Vali Acc: 0.247 Test Loss: 1.460 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9394528865814209
Epoch: 17, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.502 Vali Acc: 0.240 Test Loss: 1.502 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9335143566131592
Epoch: 18, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.507 Vali Acc: 0.281 Test Loss: 1.507 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9253864288330078
Epoch: 19, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.522 Vali Acc: 0.266 Test Loss: 1.522 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9164843559265137
Epoch: 20, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.498 Vali Acc: 0.240 Test Loss: 1.498 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9263777732849121
Epoch: 21, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.550 Vali Acc: 0.274 Test Loss: 1.550 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8395380973815918
Epoch: 22, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.606 Vali Acc: 0.243 Test Loss: 1.606 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 160612
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0622944831848145
Epoch: 1, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.425 Vali Acc: 0.262 Test Loss: 1.425 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.6651349067687988
Epoch: 2, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.655261516571045
Epoch: 3, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.485 Vali Acc: 0.278 Test Loss: 1.485 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.552283763885498
Epoch: 4, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.477 Vali Acc: 0.251 Test Loss: 1.477 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.522146224975586
Epoch: 5, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.587 Vali Acc: 0.251 Test Loss: 1.587 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8425235748291016
Epoch: 6, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.594 Vali Acc: 0.266 Test Loss: 1.594 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7607197761535645
Epoch: 7, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.637 Vali Acc: 0.262 Test Loss: 1.637 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9694762229919434
Epoch: 8, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.795 Vali Acc: 0.278 Test Loss: 1.795 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9185676574707031
Epoch: 9, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.047 Vali Acc: 0.278 Test Loss: 2.047 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8324787616729736
Epoch: 10, Steps: 17 | Train Loss: 0.727 Vali Loss: 2.046 Vali Acc: 0.240 Test Loss: 2.046 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8366882801055908
Epoch: 11, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.451 Vali Acc: 0.255 Test Loss: 2.451 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7327239513397217
Epoch: 12, Steps: 17 | Train Loss: 0.593 Vali Loss: 2.787 Vali Acc: 0.247 Test Loss: 2.787 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8739979267120361
Epoch: 13, Steps: 17 | Train Loss: 0.573 Vali Loss: 2.851 Vali Acc: 0.247 Test Loss: 2.851 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 2221700
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8182857036590576
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.385 Vali Acc: 0.255 Test Loss: 1.385 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.6196379661560059
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.421 Vali Acc: 0.255 Test Loss: 1.421 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4809179306030273
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.408 Vali Acc: 0.266 Test Loss: 1.408 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.6114366054534912
Epoch: 4, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.415 Vali Acc: 0.236 Test Loss: 1.415 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4478373527526855
Epoch: 5, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.455 Vali Acc: 0.251 Test Loss: 1.455 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4249632358551025
Epoch: 6, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273749).  Saving model ...
Epoch: 7 cost time: 1.429405689239502
Epoch: 7, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.556 Vali Acc: 0.240 Test Loss: 1.556 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.535290241241455
Epoch: 8, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.563 Vali Acc: 0.228 Test Loss: 1.563 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.388458490371704
Epoch: 9, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.659 Vali Acc: 0.221 Test Loss: 1.659 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5612573623657227
Epoch: 10, Steps: 17 | Train Loss: 0.783 Vali Loss: 1.836 Vali Acc: 0.236 Test Loss: 1.836 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5620837211608887
Epoch: 11, Steps: 17 | Train Loss: 0.739 Vali Loss: 1.944 Vali Acc: 0.228 Test Loss: 1.944 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6564826965332031
Epoch: 12, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.986 Vali Acc: 0.274 Test Loss: 1.986 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6206822395324707
Epoch: 13, Steps: 17 | Train Loss: 0.683 Vali Loss: 2.335 Vali Acc: 0.240 Test Loss: 2.335 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5876250267028809
Epoch: 14, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.506 Vali Acc: 0.243 Test Loss: 2.506 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.448239803314209
Epoch: 15, Steps: 17 | Train Loss: 0.582 Vali Loss: 2.455 Vali Acc: 0.247 Test Loss: 2.455 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2940595149993896
Epoch: 16, Steps: 17 | Train Loss: 0.589 Vali Loss: 2.769 Vali Acc: 0.240 Test Loss: 2.769 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 2165892
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1596519947052
Epoch: 1, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.377 Vali Acc: 0.274 Test Loss: 1.377 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.6878271102905273
Epoch: 2, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.386 Vali Acc: 0.251 Test Loss: 1.386 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5605206489562988
Epoch: 3, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5040698051452637
Epoch: 4, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.435 Vali Acc: 0.243 Test Loss: 1.435 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.514927625656128
Epoch: 5, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.509 Vali Acc: 0.266 Test Loss: 1.509 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5049169063568115
Epoch: 6, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.432 Vali Acc: 0.259 Test Loss: 1.432 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.724363088607788
Epoch: 7, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.516 Vali Acc: 0.270 Test Loss: 1.516 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6141564846038818
Epoch: 8, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.542 Vali Acc: 0.221 Test Loss: 1.542 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.710836410522461
Epoch: 9, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.688 Vali Acc: 0.259 Test Loss: 1.688 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.802173376083374
Epoch: 10, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.652 Vali Acc: 0.228 Test Loss: 1.652 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6271569728851318
Epoch: 11, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.793 Vali Acc: 0.236 Test Loss: 1.793 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 2150020
model size : 8.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8708014488220215
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.385 Vali Acc: 0.240 Test Loss: 1.385 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 1.471536636352539
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.410 Vali Acc: 0.285 Test Loss: 1.410 Test Acc: 0.285
Validation loss decreased (-0.239530 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 1.4719791412353516
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.391 Vali Acc: 0.255 Test Loss: 1.391 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4028809070587158
Epoch: 4, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.459 Vali Acc: 0.281 Test Loss: 1.459 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.451805591583252
Epoch: 5, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.432 Vali Acc: 0.247 Test Loss: 1.432 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3630499839782715
Epoch: 6, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.473 Vali Acc: 0.228 Test Loss: 1.473 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2693181037902832
Epoch: 7, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.569 Vali Acc: 0.274 Test Loss: 1.569 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3999173641204834
Epoch: 8, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.556 Vali Acc: 0.251 Test Loss: 1.556 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5013353824615479
Epoch: 9, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.583 Vali Acc: 0.266 Test Loss: 1.583 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.474809169769287
Epoch: 10, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.667 Vali Acc: 0.243 Test Loss: 1.667 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4603512287139893
Epoch: 11, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.601 Vali Acc: 0.247 Test Loss: 1.601 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3545293807983398
Epoch: 12, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2146436
model size : 8.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.959770679473877
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.6212594509124756
Epoch: 2, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.417 Vali Acc: 0.224 Test Loss: 1.417 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5608417987823486
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.412 Vali Acc: 0.266 Test Loss: 1.412 Test Acc: 0.266
Validation loss decreased (-0.243332 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.3534505367279053
Epoch: 4, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.426 Vali Acc: 0.278 Test Loss: 1.426 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 1.256605863571167
Epoch: 5, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.434 Vali Acc: 0.232 Test Loss: 1.434 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0639820098876953
Epoch: 6, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.514 Vali Acc: 0.259 Test Loss: 1.514 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.660874843597412
Epoch: 7, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.459 Vali Acc: 0.240 Test Loss: 1.459 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5726206302642822
Epoch: 8, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.495 Vali Acc: 0.262 Test Loss: 1.495 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.563948631286621
Epoch: 9, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.526 Vali Acc: 0.251 Test Loss: 1.526 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.534790277481079
Epoch: 10, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.540 Vali Acc: 0.209 Test Loss: 1.540 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6075990200042725
Epoch: 11, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.564 Vali Acc: 0.221 Test Loss: 1.564 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.399646282196045
Epoch: 12, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.588 Vali Acc: 0.228 Test Loss: 1.588 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.550800085067749
Epoch: 13, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.724 Vali Acc: 0.194 Test Loss: 1.724 Test Acc: 0.194
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5953688621520996
Epoch: 14, Steps: 17 | Train Loss: 0.819 Vali Loss: 1.888 Vali Acc: 0.243 Test Loss: 1.888 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 2148356
model size : 8.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.5730788707733154
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.380 Vali Acc: 0.285 Test Loss: 1.380 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.179863452911377
Epoch: 2, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.391 Vali Acc: 0.262 Test Loss: 1.391 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.227586030960083
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.396 Vali Acc: 0.247 Test Loss: 1.396 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3072121143341064
Epoch: 4, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.424 Vali Acc: 0.236 Test Loss: 1.424 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5400030612945557
Epoch: 5, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.411 Vali Acc: 0.221 Test Loss: 1.411 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5162253379821777
Epoch: 6, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.434 Vali Acc: 0.255 Test Loss: 1.434 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5275144577026367
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.515 Vali Acc: 0.266 Test Loss: 1.515 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4153974056243896
Epoch: 8, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.471 Vali Acc: 0.270 Test Loss: 1.471 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3920278549194336
Epoch: 9, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.541 Vali Acc: 0.236 Test Loss: 1.541 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3770554065704346
Epoch: 10, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.600 Vali Acc: 0.243 Test Loss: 1.600 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2775938510894775
Epoch: 11, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.614 Vali Acc: 0.213 Test Loss: 1.614 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2153476
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.619966983795166
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.379 Vali Acc: 0.270 Test Loss: 1.379 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.409999132156372
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.388 Vali Acc: 0.262 Test Loss: 1.388 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4292106628417969
Epoch: 3, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.389 Vali Acc: 0.251 Test Loss: 1.389 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3881103992462158
Epoch: 4, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 1.3802716732025146
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.446 Vali Acc: 0.232 Test Loss: 1.446 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3405747413635254
Epoch: 6, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.417 Vali Acc: 0.221 Test Loss: 1.417 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4058952331542969
Epoch: 7, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.445 Vali Acc: 0.240 Test Loss: 1.445 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3766388893127441
Epoch: 8, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.518 Vali Acc: 0.251 Test Loss: 1.518 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4903981685638428
Epoch: 9, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.508 Vali Acc: 0.266 Test Loss: 1.508 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4127013683319092
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.602 Vali Acc: 0.259 Test Loss: 1.602 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.43418550491333
Epoch: 11, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.556 Vali Acc: 0.259 Test Loss: 1.556 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3621156215667725
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.646 Vali Acc: 0.240 Test Loss: 1.646 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4473061561584473
Epoch: 13, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3715004920959473
Epoch: 14, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.775 Vali Acc: 0.285 Test Loss: 1.775 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285153).  Saving model ...
Epoch: 15 cost time: 1.3673672676086426
Epoch: 15, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.825 Vali Acc: 0.255 Test Loss: 1.825 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4379017353057861
Epoch: 16, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.887 Vali Acc: 0.259 Test Loss: 1.887 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4455604553222656
Epoch: 17, Steps: 17 | Train Loss: 0.837 Vali Loss: 1.971 Vali Acc: 0.224 Test Loss: 1.971 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4388291835784912
Epoch: 18, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.886 Vali Acc: 0.236 Test Loss: 1.886 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3357508182525635
Epoch: 19, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.028 Vali Acc: 0.240 Test Loss: 2.028 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4795050621032715
Epoch: 20, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.953 Vali Acc: 0.251 Test Loss: 1.953 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3914377689361572
Epoch: 21, Steps: 17 | Train Loss: 0.747 Vali Loss: 2.218 Vali Acc: 0.232 Test Loss: 2.218 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.38411545753479
Epoch: 22, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.190 Vali Acc: 0.270 Test Loss: 2.190 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4067957401275635
Epoch: 23, Steps: 17 | Train Loss: 0.739 Vali Loss: 2.336 Vali Acc: 0.274 Test Loss: 2.336 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4960761070251465
Epoch: 24, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.371 Vali Acc: 0.262 Test Loss: 2.371 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 2161540
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.7456705570220947
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.383 Vali Acc: 0.243 Test Loss: 1.383 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.316007375717163
Epoch: 2, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.391 Vali Acc: 0.251 Test Loss: 1.391 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 1.2960574626922607
Epoch: 3, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
Validation loss decreased (-0.250937 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.3410956859588623
Epoch: 4, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.414 Vali Acc: 0.281 Test Loss: 1.414 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 1.360745906829834
Epoch: 5, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.463 Vali Acc: 0.281 Test Loss: 1.463 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3177738189697266
Epoch: 6, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.504 Vali Acc: 0.285 Test Loss: 1.504 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 1.3305869102478027
Epoch: 7, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.562 Vali Acc: 0.293 Test Loss: 1.562 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292760).  Saving model ...
Epoch: 8 cost time: 1.1428611278533936
Epoch: 8, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.608 Vali Acc: 0.243 Test Loss: 1.608 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.254289150238037
Epoch: 9, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.676 Vali Acc: 0.251 Test Loss: 1.676 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1156048774719238
Epoch: 10, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.721 Vali Acc: 0.278 Test Loss: 1.721 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2386317253112793
Epoch: 11, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.965 Vali Acc: 0.274 Test Loss: 1.965 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2117462158203125
Epoch: 12, Steps: 17 | Train Loss: 0.701 Vali Loss: 1.937 Vali Acc: 0.266 Test Loss: 1.937 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2916936874389648
Epoch: 13, Steps: 17 | Train Loss: 0.644 Vali Loss: 2.107 Vali Acc: 0.300 Test Loss: 2.107 Test Acc: 0.300
Validation loss decreased (-0.292760 --> -0.300359).  Saving model ...
Epoch: 14 cost time: 1.3611242771148682
Epoch: 14, Steps: 17 | Train Loss: 0.650 Vali Loss: 2.293 Vali Acc: 0.270 Test Loss: 2.293 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3819890022277832
Epoch: 15, Steps: 17 | Train Loss: 0.588 Vali Loss: 2.390 Vali Acc: 0.281 Test Loss: 2.390 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.263777732849121
Epoch: 16, Steps: 17 | Train Loss: 0.533 Vali Loss: 2.475 Vali Acc: 0.270 Test Loss: 2.475 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.223809003829956
Epoch: 17, Steps: 17 | Train Loss: 0.497 Vali Loss: 2.820 Vali Acc: 0.293 Test Loss: 2.820 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.207127571105957
Epoch: 18, Steps: 17 | Train Loss: 0.489 Vali Loss: 3.086 Vali Acc: 0.259 Test Loss: 3.086 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1728746891021729
Epoch: 19, Steps: 17 | Train Loss: 0.487 Vali Loss: 3.001 Vali Acc: 0.262 Test Loss: 3.001 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2453303337097168
Epoch: 20, Steps: 17 | Train Loss: 0.413 Vali Loss: 3.568 Vali Acc: 0.270 Test Loss: 3.568 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2431585788726807
Epoch: 21, Steps: 17 | Train Loss: 0.429 Vali Loss: 3.435 Vali Acc: 0.243 Test Loss: 3.435 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1927886009216309
Epoch: 22, Steps: 17 | Train Loss: 0.381 Vali Loss: 4.010 Vali Acc: 0.266 Test Loss: 4.010 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2438199520111084
Epoch: 23, Steps: 17 | Train Loss: 0.352 Vali Loss: 3.966 Vali Acc: 0.262 Test Loss: 3.966 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 602948
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.716789960861206
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.390 Vali Acc: 0.232 Test Loss: 1.390 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.153782844543457
Epoch: 2, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.378 Vali Acc: 0.281 Test Loss: 1.378 Test Acc: 0.281
Validation loss decreased (-0.231925 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.1488797664642334
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.413 Vali Acc: 0.285 Test Loss: 1.413 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 1.1316537857055664
Epoch: 4, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.396 Vali Acc: 0.259 Test Loss: 1.396 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1969943046569824
Epoch: 5, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.404 Vali Acc: 0.270 Test Loss: 1.404 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2557628154754639
Epoch: 6, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1686618328094482
Epoch: 7, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2778196334838867
Epoch: 8, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1057000160217285
Epoch: 9, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.460 Vali Acc: 0.232 Test Loss: 1.460 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.11952805519104
Epoch: 10, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.473 Vali Acc: 0.236 Test Loss: 1.473 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1446702480316162
Epoch: 11, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.530 Vali Acc: 0.259 Test Loss: 1.530 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1925225257873535
Epoch: 12, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.566 Vali Acc: 0.259 Test Loss: 1.566 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1657822132110596
Epoch: 13, Steps: 17 | Train Loss: 0.863 Vali Loss: 1.715 Vali Acc: 0.251 Test Loss: 1.715 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 575044
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3730263710021973
Epoch: 1, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.378 Vali Acc: 0.266 Test Loss: 1.378 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.1208178997039795
Epoch: 2, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.382 Vali Acc: 0.247 Test Loss: 1.382 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1005842685699463
Epoch: 3, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.390 Vali Acc: 0.221 Test Loss: 1.390 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1403603553771973
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1895017623901367
Epoch: 5, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.394 Vali Acc: 0.259 Test Loss: 1.394 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1721351146697998
Epoch: 6, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.416 Vali Acc: 0.274 Test Loss: 1.416 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 1.1579596996307373
Epoch: 7, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.418 Vali Acc: 0.251 Test Loss: 1.418 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1863715648651123
Epoch: 8, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.445 Vali Acc: 0.224 Test Loss: 1.445 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1806013584136963
Epoch: 9, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.456 Vali Acc: 0.221 Test Loss: 1.456 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1727662086486816
Epoch: 10, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.508 Vali Acc: 0.228 Test Loss: 1.508 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.126192331314087
Epoch: 11, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.516 Vali Acc: 0.228 Test Loss: 1.516 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0572516918182373
Epoch: 12, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.580 Vali Acc: 0.232 Test Loss: 1.580 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1039841175079346
Epoch: 13, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.582 Vali Acc: 0.247 Test Loss: 1.582 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.12070631980896
Epoch: 14, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.713 Vali Acc: 0.247 Test Loss: 1.713 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0968196392059326
Epoch: 15, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.738 Vali Acc: 0.221 Test Loss: 1.738 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0853946208953857
Epoch: 16, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.748 Vali Acc: 0.243 Test Loss: 1.748 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 567108
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4347448348999023
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.391 Vali Acc: 0.236 Test Loss: 1.391 Test Acc: 0.236
Validation loss decreased (inf --> -0.235728).  Saving model ...
Epoch: 2 cost time: 1.125305414199829
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.390 Vali Acc: 0.274 Test Loss: 1.390 Test Acc: 0.274
Validation loss decreased (-0.235728 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.0787546634674072
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0310051441192627
Epoch: 4, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.390 Vali Acc: 0.300 Test Loss: 1.390 Test Acc: 0.300
Validation loss decreased (-0.273750 --> -0.300366).  Saving model ...
Epoch: 5 cost time: 1.1404402256011963
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.388 Vali Acc: 0.274 Test Loss: 1.388 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2070069313049316
Epoch: 6, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.401 Vali Acc: 0.281 Test Loss: 1.401 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2193734645843506
Epoch: 7, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.414 Vali Acc: 0.278 Test Loss: 1.414 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.23354172706604
Epoch: 8, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.425 Vali Acc: 0.247 Test Loss: 1.425 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.22981595993042
Epoch: 9, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.457 Vali Acc: 0.255 Test Loss: 1.457 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1567635536193848
Epoch: 10, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.515 Vali Acc: 0.285 Test Loss: 1.515 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0737817287445068
Epoch: 11, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.507 Vali Acc: 0.278 Test Loss: 1.507 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0860090255737305
Epoch: 12, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.545 Vali Acc: 0.255 Test Loss: 1.545 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0567798614501953
Epoch: 13, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.577 Vali Acc: 0.255 Test Loss: 1.577 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.062457799911499
Epoch: 14, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.593 Vali Acc: 0.251 Test Loss: 1.593 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 565316
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3196096420288086
Epoch: 1, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.395 Vali Acc: 0.251 Test Loss: 1.395 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.087756633758545
Epoch: 2, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.389 Vali Acc: 0.266 Test Loss: 1.389 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 1.0148887634277344
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.386 Vali Acc: 0.278 Test Loss: 1.386 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 0.9650869369506836
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.398 Vali Acc: 0.278 Test Loss: 1.398 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0221233367919922
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.386 Vali Acc: 0.285 Test Loss: 1.386 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 1.0149602890014648
Epoch: 6, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.388 Vali Acc: 0.281 Test Loss: 1.388 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0098035335540771
Epoch: 7, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.407 Vali Acc: 0.278 Test Loss: 1.407 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.009361743927002
Epoch: 8, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.070389986038208
Epoch: 9, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.407 Vali Acc: 0.240 Test Loss: 1.407 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0637125968933105
Epoch: 10, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.427 Vali Acc: 0.274 Test Loss: 1.427 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.099048376083374
Epoch: 11, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.446 Vali Acc: 0.251 Test Loss: 1.446 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0539677143096924
Epoch: 12, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.470 Vali Acc: 0.266 Test Loss: 1.470 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0587122440338135
Epoch: 13, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.447 Vali Acc: 0.278 Test Loss: 1.447 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1402497291564941
Epoch: 14, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.521 Vali Acc: 0.236 Test Loss: 1.521 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9698593616485596
Epoch: 15, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 566276
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.301119804382324
Epoch: 1, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.388 Vali Acc: 0.236 Test Loss: 1.388 Test Acc: 0.236
Validation loss decreased (inf --> -0.235728).  Saving model ...
Epoch: 2 cost time: 1.056044578552246
Epoch: 2, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.383 Vali Acc: 0.243 Test Loss: 1.383 Test Acc: 0.243
Validation loss decreased (-0.235728 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 1.0135586261749268
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.389 Vali Acc: 0.240 Test Loss: 1.389 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0458412170410156
Epoch: 4, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.388 Vali Acc: 0.217 Test Loss: 1.388 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0577366352081299
Epoch: 5, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.404 Vali Acc: 0.232 Test Loss: 1.404 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.976128101348877
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.414 Vali Acc: 0.266 Test Loss: 1.414 Test Acc: 0.266
Validation loss decreased (-0.243332 --> -0.266146).  Saving model ...
Epoch: 7 cost time: 0.9791660308837891
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.428 Vali Acc: 0.247 Test Loss: 1.428 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0301806926727295
Epoch: 8, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.467 Vali Acc: 0.270 Test Loss: 1.467 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269947).  Saving model ...
Epoch: 9 cost time: 1.0084142684936523
Epoch: 9, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.426 Vali Acc: 0.236 Test Loss: 1.426 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0660419464111328
Epoch: 10, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.488 Vali Acc: 0.285 Test Loss: 1.488 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285156).  Saving model ...
Epoch: 11 cost time: 1.0204834938049316
Epoch: 11, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.482 Vali Acc: 0.243 Test Loss: 1.482 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0017235279083252
Epoch: 12, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.475 Vali Acc: 0.270 Test Loss: 1.475 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0156924724578857
Epoch: 13, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.542 Vali Acc: 0.251 Test Loss: 1.542 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.104832649230957
Epoch: 14, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.518 Vali Acc: 0.266 Test Loss: 1.518 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9731583595275879
Epoch: 15, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.552 Vali Acc: 0.281 Test Loss: 1.552 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.003380537033081
Epoch: 16, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.625 Vali Acc: 0.266 Test Loss: 1.625 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9962344169616699
Epoch: 17, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.631 Vali Acc: 0.270 Test Loss: 1.631 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9709696769714355
Epoch: 18, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.704 Vali Acc: 0.293 Test Loss: 1.704 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292759).  Saving model ...
Epoch: 19 cost time: 1.0582847595214844
Epoch: 19, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.712 Vali Acc: 0.266 Test Loss: 1.712 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0623822212219238
Epoch: 20, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.794 Vali Acc: 0.274 Test Loss: 1.794 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9559640884399414
Epoch: 21, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.820 Vali Acc: 0.274 Test Loss: 1.820 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9456439018249512
Epoch: 22, Steps: 17 | Train Loss: 0.827 Vali Loss: 1.899 Vali Acc: 0.289 Test Loss: 1.899 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0196421146392822
Epoch: 23, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.924 Vali Acc: 0.281 Test Loss: 1.924 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0062954425811768
Epoch: 24, Steps: 17 | Train Loss: 0.740 Vali Loss: 1.940 Vali Acc: 0.274 Test Loss: 1.940 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9506497383117676
Epoch: 25, Steps: 17 | Train Loss: 0.792 Vali Loss: 2.046 Vali Acc: 0.255 Test Loss: 2.046 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.00893235206604
Epoch: 26, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.157 Vali Acc: 0.255 Test Loss: 2.157 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9729790687561035
Epoch: 27, Steps: 17 | Train Loss: 0.699 Vali Loss: 1.996 Vali Acc: 0.278 Test Loss: 1.996 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0697391033172607
Epoch: 28, Steps: 17 | Train Loss: 0.714 Vali Loss: 2.321 Vali Acc: 0.274 Test Loss: 2.321 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 568836
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.421308755874634
Epoch: 1, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.399 Vali Acc: 0.274 Test Loss: 1.399 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.9453761577606201
Epoch: 2, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.390 Vali Acc: 0.251 Test Loss: 1.390 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9528443813323975
Epoch: 3, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.394 Vali Acc: 0.247 Test Loss: 1.394 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9700162410736084
Epoch: 4, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.389 Vali Acc: 0.262 Test Loss: 1.389 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9354367256164551
Epoch: 5, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.400 Vali Acc: 0.224 Test Loss: 1.400 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0015220642089844
Epoch: 6, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.398 Vali Acc: 0.259 Test Loss: 1.398 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0222251415252686
Epoch: 7, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.430 Vali Acc: 0.274 Test Loss: 1.430 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9736406803131104
Epoch: 8, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.420 Vali Acc: 0.236 Test Loss: 1.420 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9979236125946045
Epoch: 9, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.449 Vali Acc: 0.255 Test Loss: 1.449 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8910999298095703
Epoch: 10, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9141135215759277
Epoch: 11, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.507 Vali Acc: 0.247 Test Loss: 1.507 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 572868
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3666534423828125
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.391 Vali Acc: 0.293 Test Loss: 1.391 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 1.013608455657959
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.373 Vali Acc: 0.289 Test Loss: 1.373 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9579672813415527
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.398 Vali Acc: 0.316 Test Loss: 1.398 Test Acc: 0.316
Validation loss decreased (-0.292762 --> -0.315575).  Saving model ...
Epoch: 4 cost time: 0.9553725719451904
Epoch: 4, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8459081649780273
Epoch: 5, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.382 Vali Acc: 0.300 Test Loss: 1.382 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9292120933532715
Epoch: 6, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.392 Vali Acc: 0.293 Test Loss: 1.392 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8988447189331055
Epoch: 7, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9768366813659668
Epoch: 8, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0869019031524658
Epoch: 9, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1779568195343018
Epoch: 10, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.483 Vali Acc: 0.274 Test Loss: 1.483 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1314959526062012
Epoch: 11, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.515 Vali Acc: 0.289 Test Loss: 1.515 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1167621612548828
Epoch: 12, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.557 Vali Acc: 0.308 Test Loss: 1.557 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0423686504364014
Epoch: 13, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.610 Vali Acc: 0.293 Test Loss: 1.610 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 174500
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4118945598602295
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.401 Vali Acc: 0.274 Test Loss: 1.401 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.9815304279327393
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.259 Test Loss: 1.385 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9440510272979736
Epoch: 3, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.388 Vali Acc: 0.270 Test Loss: 1.388 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1244683265686035
Epoch: 4, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.390 Vali Acc: 0.259 Test Loss: 1.390 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0043339729309082
Epoch: 5, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9199676513671875
Epoch: 6, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.406 Vali Acc: 0.224 Test Loss: 1.406 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9792895317077637
Epoch: 7, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.394 Vali Acc: 0.232 Test Loss: 1.394 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8781907558441162
Epoch: 8, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.417 Vali Acc: 0.259 Test Loss: 1.417 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8946614265441895
Epoch: 9, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.427 Vali Acc: 0.236 Test Loss: 1.427 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.923651933670044
Epoch: 10, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.433 Vali Acc: 0.240 Test Loss: 1.433 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9027044773101807
Epoch: 11, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 160548
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3572933673858643
Epoch: 1, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.376 Vali Acc: 0.270 Test Loss: 1.376 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 0.9461827278137207
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.372 Vali Acc: 0.304 Test Loss: 1.372 Test Acc: 0.304
Validation loss decreased (-0.269948 --> -0.304169).  Saving model ...
Epoch: 3 cost time: 0.8761298656463623
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.370 Vali Acc: 0.316 Test Loss: 1.370 Test Acc: 0.316
Validation loss decreased (-0.304169 --> -0.315576).  Saving model ...
Epoch: 4 cost time: 0.8595576286315918
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.374 Vali Acc: 0.281 Test Loss: 1.374 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9263908863067627
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.372 Vali Acc: 0.297 Test Loss: 1.372 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.943720817565918
Epoch: 6, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.370 Vali Acc: 0.274 Test Loss: 1.370 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9973411560058594
Epoch: 7, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9973592758178711
Epoch: 8, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.383 Vali Acc: 0.266 Test Loss: 1.383 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.063300609588623
Epoch: 9, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.394 Vali Acc: 0.251 Test Loss: 1.394 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9591860771179199
Epoch: 10, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.413 Vali Acc: 0.274 Test Loss: 1.413 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9645285606384277
Epoch: 11, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9545819759368896
Epoch: 12, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.443 Vali Acc: 0.251 Test Loss: 1.443 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8429965972900391
Epoch: 13, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.463 Vali Acc: 0.266 Test Loss: 1.463 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 156580
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.228858232498169
Epoch: 1, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.405 Vali Acc: 0.213 Test Loss: 1.405 Test Acc: 0.213
Validation loss decreased (inf --> -0.212914).  Saving model ...
Epoch: 2 cost time: 0.8900918960571289
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.393 Vali Acc: 0.240 Test Loss: 1.393 Test Acc: 0.240
Validation loss decreased (-0.212914 --> -0.239530).  Saving model ...
Epoch: 3 cost time: 0.9479584693908691
Epoch: 3, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
Validation loss decreased (-0.239530 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 0.8648943901062012
Epoch: 4, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.386 Vali Acc: 0.240 Test Loss: 1.386 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7754943370819092
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9171967506408691
Epoch: 6, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.390 Vali Acc: 0.236 Test Loss: 1.390 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9813046455383301
Epoch: 7, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.397 Vali Acc: 0.262 Test Loss: 1.397 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9416971206665039
Epoch: 8, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8875987529754639
Epoch: 9, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.421 Vali Acc: 0.270 Test Loss: 1.421 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8831541538238525
Epoch: 10, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.411 Vali Acc: 0.255 Test Loss: 1.411 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9007754325866699
Epoch: 11, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.418 Vali Acc: 0.217 Test Loss: 1.418 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9287080764770508
Epoch: 12, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.424 Vali Acc: 0.247 Test Loss: 1.424 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9070327281951904
Epoch: 13, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.430 Vali Acc: 0.224 Test Loss: 1.430 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 155684
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1087327003479004
Epoch: 1, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.396 Vali Acc: 0.259 Test Loss: 1.396 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.8959996700286865
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.388 Vali Acc: 0.259 Test Loss: 1.388 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.9825530052185059
Epoch: 3, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (-0.258541 --> -0.296564).  Saving model ...
Epoch: 4 cost time: 0.893369197845459
Epoch: 4, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.393 Vali Acc: 0.300 Test Loss: 1.393 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300366).  Saving model ...
Epoch: 5 cost time: 0.9314565658569336
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.384 Vali Acc: 0.213 Test Loss: 1.384 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9782521724700928
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.385 Vali Acc: 0.262 Test Loss: 1.385 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9263021945953369
Epoch: 7, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9593966007232666
Epoch: 8, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.389 Vali Acc: 0.266 Test Loss: 1.389 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0078985691070557
Epoch: 9, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.393 Vali Acc: 0.240 Test Loss: 1.393 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9781777858734131
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.406 Vali Acc: 0.274 Test Loss: 1.406 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9544312953948975
Epoch: 11, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.408 Vali Acc: 0.228 Test Loss: 1.408 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9073009490966797
Epoch: 12, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8719117641448975
Epoch: 13, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.421 Vali Acc: 0.247 Test Loss: 1.421 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9468107223510742
Epoch: 14, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.449 Vali Acc: 0.247 Test Loss: 1.449 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 156164
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.353523015975952
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.400 Vali Acc: 0.262 Test Loss: 1.400 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.9547085762023926
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.390 Vali Acc: 0.278 Test Loss: 1.390 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 0.9716002941131592
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8678722381591797
Epoch: 4, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.393 Vali Acc: 0.285 Test Loss: 1.393 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285157).  Saving model ...
Epoch: 5 cost time: 0.8573884963989258
Epoch: 5, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.383 Vali Acc: 0.278 Test Loss: 1.383 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8794283866882324
Epoch: 6, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.396 Vali Acc: 0.289 Test Loss: 1.396 Test Acc: 0.289
Validation loss decreased (-0.285157 --> -0.288959).  Saving model ...
Epoch: 7 cost time: 0.9105165004730225
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.391 Vali Acc: 0.300 Test Loss: 1.391 Test Acc: 0.300
Validation loss decreased (-0.288959 --> -0.300366).  Saving model ...
Epoch: 8 cost time: 0.9245123863220215
Epoch: 8, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.404 Vali Acc: 0.274 Test Loss: 1.404 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9092085361480713
Epoch: 9, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.392 Vali Acc: 0.266 Test Loss: 1.392 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9316956996917725
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.428 Vali Acc: 0.259 Test Loss: 1.428 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9261527061462402
Epoch: 11, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.419 Vali Acc: 0.259 Test Loss: 1.419 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9188237190246582
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.429 Vali Acc: 0.289 Test Loss: 1.429 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9321930408477783
Epoch: 13, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.429 Vali Acc: 0.232 Test Loss: 1.429 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9564168453216553
Epoch: 14, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.465 Vali Acc: 0.312 Test Loss: 1.465 Test Acc: 0.312
Validation loss decreased (-0.300366 --> -0.311772).  Saving model ...
Epoch: 15 cost time: 0.91957688331604
Epoch: 15, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.464 Vali Acc: 0.251 Test Loss: 1.464 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9165456295013428
Epoch: 16, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.492 Vali Acc: 0.297 Test Loss: 1.492 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9510400295257568
Epoch: 17, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.490 Vali Acc: 0.255 Test Loss: 1.490 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8138225078582764
Epoch: 18, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.469 Vali Acc: 0.251 Test Loss: 1.469 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8698770999908447
Epoch: 19, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.578 Vali Acc: 0.270 Test Loss: 1.578 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.914888858795166
Epoch: 20, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.550 Vali Acc: 0.259 Test Loss: 1.550 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9190945625305176
Epoch: 21, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.521 Vali Acc: 0.240 Test Loss: 1.521 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.985424280166626
Epoch: 22, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.620 Vali Acc: 0.281 Test Loss: 1.620 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9167077541351318
Epoch: 23, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.624 Vali Acc: 0.270 Test Loss: 1.624 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8595774173736572
Epoch: 24, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.697 Vali Acc: 0.274 Test Loss: 1.697 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 157444
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2007439136505127
Epoch: 1, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.405 Vali Acc: 0.281 Test Loss: 1.405 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 0.906569242477417
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.393 Vali Acc: 0.281 Test Loss: 1.393 Test Acc: 0.281
Validation loss decreased (-0.281355 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.9802255630493164
Epoch: 3, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.398 Vali Acc: 0.297 Test Loss: 1.398 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296564).  Saving model ...
Epoch: 4 cost time: 0.8984217643737793
Epoch: 4, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.382 Vali Acc: 0.281 Test Loss: 1.382 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9225218296051025
Epoch: 5, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.378 Vali Acc: 0.312 Test Loss: 1.378 Test Acc: 0.312
Validation loss decreased (-0.296564 --> -0.311773).  Saving model ...
Epoch: 6 cost time: 0.900090217590332
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9354903697967529
Epoch: 7, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.379 Vali Acc: 0.274 Test Loss: 1.379 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9405899047851562
Epoch: 8, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.382 Vali Acc: 0.285 Test Loss: 1.382 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9328234195709229
Epoch: 9, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.391 Vali Acc: 0.255 Test Loss: 1.391 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8847155570983887
Epoch: 10, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.390 Vali Acc: 0.281 Test Loss: 1.390 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8756630420684814
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.394 Vali Acc: 0.251 Test Loss: 1.394 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.972536563873291
Epoch: 12, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.398 Vali Acc: 0.285 Test Loss: 1.398 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8867301940917969
Epoch: 13, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.404 Vali Acc: 0.285 Test Loss: 1.404 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9265410900115967
Epoch: 14, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.434 Vali Acc: 0.289 Test Loss: 1.434 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8931567668914795
Epoch: 15, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 159460
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9715592861175537
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.525 Vali Acc: 0.262 Test Loss: 1.525 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 1.7040977478027344
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6927106380462646
Epoch: 3, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.842 Vali Acc: 0.236 Test Loss: 1.842 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.559030532836914
Epoch: 4, Steps: 17 | Train Loss: 1.294 Vali Loss: 2.109 Vali Acc: 0.285 Test Loss: 2.109 Test Acc: 0.285
Validation loss decreased (-0.262342 --> -0.285150).  Saving model ...
Epoch: 5 cost time: 1.8733596801757812
Epoch: 5, Steps: 17 | Train Loss: 1.167 Vali Loss: 2.182 Vali Acc: 0.262 Test Loss: 2.182 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.822617530822754
Epoch: 6, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.855 Vali Acc: 0.228 Test Loss: 1.855 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8880419731140137
Epoch: 7, Steps: 17 | Train Loss: 1.118 Vali Loss: 2.313 Vali Acc: 0.266 Test Loss: 2.313 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8248558044433594
Epoch: 8, Steps: 17 | Train Loss: 0.886 Vali Loss: 2.619 Vali Acc: 0.270 Test Loss: 2.619 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6605398654937744
Epoch: 9, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.533 Vali Acc: 0.255 Test Loss: 2.533 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.740548849105835
Epoch: 10, Steps: 17 | Train Loss: 0.847 Vali Loss: 2.665 Vali Acc: 0.270 Test Loss: 2.665 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7275607585906982
Epoch: 11, Steps: 17 | Train Loss: 0.944 Vali Loss: 3.324 Vali Acc: 0.240 Test Loss: 3.324 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6955561637878418
Epoch: 12, Steps: 17 | Train Loss: 0.757 Vali Loss: 3.198 Vali Acc: 0.255 Test Loss: 3.198 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8837172985076904
Epoch: 13, Steps: 17 | Train Loss: 0.633 Vali Loss: 3.191 Vali Acc: 0.236 Test Loss: 3.191 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.890054702758789
Epoch: 14, Steps: 17 | Train Loss: 0.600 Vali Loss: 3.193 Vali Acc: 0.247 Test Loss: 3.193 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1871108
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.634807586669922
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.488 Vali Acc: 0.266 Test Loss: 1.488 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 1.294130802154541
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.490 Vali Acc: 0.221 Test Loss: 1.490 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2849137783050537
Epoch: 3, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.498 Vali Acc: 0.281 Test Loss: 1.498 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.3853120803833008
Epoch: 4, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.774 Vali Acc: 0.270 Test Loss: 1.774 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3575263023376465
Epoch: 5, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.781 Vali Acc: 0.274 Test Loss: 1.781 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2503104209899902
Epoch: 6, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.763 Vali Acc: 0.274 Test Loss: 1.763 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2481234073638916
Epoch: 7, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.831 Vali Acc: 0.266 Test Loss: 1.831 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2825450897216797
Epoch: 8, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.112 Vali Acc: 0.266 Test Loss: 2.112 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3028488159179688
Epoch: 9, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.766 Vali Acc: 0.274 Test Loss: 1.766 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2251238822937012
Epoch: 10, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.162 Vali Acc: 0.266 Test Loss: 2.162 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3041269779205322
Epoch: 11, Steps: 17 | Train Loss: 0.724 Vali Loss: 2.365 Vali Acc: 0.278 Test Loss: 2.365 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.441641092300415
Epoch: 12, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.424 Vali Acc: 0.274 Test Loss: 2.424 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3619375228881836
Epoch: 13, Steps: 17 | Train Loss: 0.628 Vali Loss: 2.380 Vali Acc: 0.240 Test Loss: 2.380 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1759492
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.598238468170166
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.449 Vali Acc: 0.259 Test Loss: 1.449 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.2987663745880127
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.481 Vali Acc: 0.259 Test Loss: 1.481 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3455052375793457
Epoch: 3, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.468 Vali Acc: 0.240 Test Loss: 1.468 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1830410957336426
Epoch: 4, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.500 Vali Acc: 0.221 Test Loss: 1.500 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3488860130310059
Epoch: 5, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.658 Vali Acc: 0.243 Test Loss: 1.658 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2051758766174316
Epoch: 6, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.680 Vali Acc: 0.262 Test Loss: 1.680 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 7 cost time: 1.375701904296875
Epoch: 7, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.713 Vali Acc: 0.255 Test Loss: 1.713 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1931235790252686
Epoch: 8, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.789 Vali Acc: 0.247 Test Loss: 1.789 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3559114933013916
Epoch: 9, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.814 Vali Acc: 0.202 Test Loss: 1.814 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.266145944595337
Epoch: 10, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.864 Vali Acc: 0.247 Test Loss: 1.864 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2835605144500732
Epoch: 11, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.258 Vali Acc: 0.240 Test Loss: 2.258 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3322064876556396
Epoch: 12, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.242 Vali Acc: 0.274 Test Loss: 2.242 Test Acc: 0.274
Validation loss decreased (-0.262341 --> -0.273742).  Saving model ...
Epoch: 13 cost time: 1.2220027446746826
Epoch: 13, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.283 Vali Acc: 0.255 Test Loss: 2.283 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3277008533477783
Epoch: 14, Steps: 17 | Train Loss: 0.714 Vali Loss: 2.369 Vali Acc: 0.262 Test Loss: 2.369 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.30324387550354
Epoch: 15, Steps: 17 | Train Loss: 0.630 Vali Loss: 2.485 Vali Acc: 0.251 Test Loss: 2.485 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2765448093414307
Epoch: 16, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.471 Vali Acc: 0.240 Test Loss: 2.471 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2467010021209717
Epoch: 17, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.936 Vali Acc: 0.251 Test Loss: 2.936 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3395843505859375
Epoch: 18, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.570 Vali Acc: 0.240 Test Loss: 2.570 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2765445709228516
Epoch: 19, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.862 Vali Acc: 0.243 Test Loss: 2.862 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3812856674194336
Epoch: 20, Steps: 17 | Train Loss: 0.589 Vali Loss: 2.986 Vali Acc: 0.224 Test Loss: 2.986 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2621848583221436
Epoch: 21, Steps: 17 | Train Loss: 0.512 Vali Loss: 3.122 Vali Acc: 0.236 Test Loss: 3.122 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2569091320037842
Epoch: 22, Steps: 17 | Train Loss: 0.542 Vali Loss: 3.538 Vali Acc: 0.247 Test Loss: 3.538 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1730820
model size : 6.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.439026355743408
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.447 Vali Acc: 0.278 Test Loss: 1.447 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.0056045055389404
Epoch: 2, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.494 Vali Acc: 0.251 Test Loss: 1.494 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2888376712799072
Epoch: 3, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.450 Vali Acc: 0.240 Test Loss: 1.450 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1934866905212402
Epoch: 4, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.555 Vali Acc: 0.243 Test Loss: 1.555 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.088625192642212
Epoch: 5, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.528 Vali Acc: 0.274 Test Loss: 1.528 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2955529689788818
Epoch: 6, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.583 Vali Acc: 0.278 Test Loss: 1.583 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2172818183898926
Epoch: 7, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.700 Vali Acc: 0.255 Test Loss: 1.700 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2122399806976318
Epoch: 8, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.938 Vali Acc: 0.255 Test Loss: 1.938 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1400477886199951
Epoch: 9, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.766 Vali Acc: 0.247 Test Loss: 1.766 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2291712760925293
Epoch: 10, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.841 Vali Acc: 0.274 Test Loss: 1.841 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2051177024841309
Epoch: 11, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.990 Vali Acc: 0.266 Test Loss: 1.990 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 1720580
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.500608444213867
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.398 Vali Acc: 0.247 Test Loss: 1.398 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.1503772735595703
Epoch: 2, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.399 Vali Acc: 0.240 Test Loss: 1.399 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.198488712310791
Epoch: 3, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.1588754653930664
Epoch: 4, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.467 Vali Acc: 0.232 Test Loss: 1.467 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1549832820892334
Epoch: 5, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.498 Vali Acc: 0.262 Test Loss: 1.498 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1937403678894043
Epoch: 6, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.494 Vali Acc: 0.259 Test Loss: 1.494 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1022391319274902
Epoch: 7, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.512 Vali Acc: 0.247 Test Loss: 1.512 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1364517211914062
Epoch: 8, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.514 Vali Acc: 0.247 Test Loss: 1.514 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.091273546218872
Epoch: 9, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.731 Vali Acc: 0.281 Test Loss: 1.731 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281352).  Saving model ...
Epoch: 10 cost time: 1.112666368484497
Epoch: 10, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.602 Vali Acc: 0.247 Test Loss: 1.602 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1622819900512695
Epoch: 11, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.682 Vali Acc: 0.281 Test Loss: 1.682 Test Acc: 0.281
Validation loss decreased (-0.281352 --> -0.281352).  Saving model ...
Epoch: 12 cost time: 1.17635178565979
Epoch: 12, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.834 Vali Acc: 0.251 Test Loss: 1.834 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1661014556884766
Epoch: 13, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.737 Vali Acc: 0.259 Test Loss: 1.737 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1563773155212402
Epoch: 14, Steps: 17 | Train Loss: 0.772 Vali Loss: 1.924 Vali Acc: 0.243 Test Loss: 1.924 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1338529586791992
Epoch: 15, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.046 Vali Acc: 0.262 Test Loss: 2.046 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1795775890350342
Epoch: 16, Steps: 17 | Train Loss: 0.788 Vali Loss: 1.971 Vali Acc: 0.259 Test Loss: 1.971 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1197755336761475
Epoch: 17, Steps: 17 | Train Loss: 0.746 Vali Loss: 1.953 Vali Acc: 0.262 Test Loss: 1.953 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0486235618591309
Epoch: 18, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.261 Vali Acc: 0.240 Test Loss: 2.261 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.169870138168335
Epoch: 19, Steps: 17 | Train Loss: 0.655 Vali Loss: 2.215 Vali Acc: 0.259 Test Loss: 2.215 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1745870113372803
Epoch: 20, Steps: 17 | Train Loss: 0.645 Vali Loss: 2.276 Vali Acc: 0.240 Test Loss: 2.276 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.094160795211792
Epoch: 21, Steps: 17 | Train Loss: 0.638 Vali Loss: 2.357 Vali Acc: 0.224 Test Loss: 2.357 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1724420
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.382772207260132
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.559 Vali Acc: 0.228 Test Loss: 1.559 Test Acc: 0.228
Validation loss decreased (inf --> -0.228121).  Saving model ...
Epoch: 2 cost time: 0.9977178573608398
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
Validation loss decreased (-0.228121 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.07722806930542
Epoch: 3, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.443 Vali Acc: 0.243 Test Loss: 1.443 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0238628387451172
Epoch: 4, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.584 Vali Acc: 0.240 Test Loss: 1.584 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.112053632736206
Epoch: 5, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.508 Vali Acc: 0.247 Test Loss: 1.508 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0991451740264893
Epoch: 6, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.521 Vali Acc: 0.228 Test Loss: 1.521 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1121912002563477
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.598 Vali Acc: 0.255 Test Loss: 1.598 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0225422382354736
Epoch: 8, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.634 Vali Acc: 0.236 Test Loss: 1.634 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9402093887329102
Epoch: 9, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.637 Vali Acc: 0.232 Test Loss: 1.637 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0136463642120361
Epoch: 10, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.675 Vali Acc: 0.251 Test Loss: 1.675 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9993598461151123
Epoch: 11, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.667 Vali Acc: 0.224 Test Loss: 1.667 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9736268520355225
Epoch: 12, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.685 Vali Acc: 0.247 Test Loss: 1.685 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.25475285171102663
model parameter : 1734660
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2719850540161133
Epoch: 1, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.381 Vali Acc: 0.285 Test Loss: 1.381 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.0650627613067627
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.413 Vali Acc: 0.281 Test Loss: 1.413 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0796713829040527
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.391 Vali Acc: 0.285 Test Loss: 1.391 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1361823081970215
Epoch: 4, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.480 Vali Acc: 0.251 Test Loss: 1.480 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1078248023986816
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.460 Vali Acc: 0.281 Test Loss: 1.460 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1876587867736816
Epoch: 6, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.452 Vali Acc: 0.255 Test Loss: 1.452 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2891278266906738
Epoch: 7, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.454 Vali Acc: 0.247 Test Loss: 1.454 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.316178560256958
Epoch: 8, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.482 Vali Acc: 0.262 Test Loss: 1.482 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2740769386291504
Epoch: 9, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.612 Vali Acc: 0.247 Test Loss: 1.612 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.187812328338623
Epoch: 10, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.698 Vali Acc: 0.281 Test Loss: 1.698 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0318477153778076
Epoch: 11, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.687 Vali Acc: 0.285 Test Loss: 1.687 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1750788
model size : 6.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4094760417938232
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.433 Vali Acc: 0.262 Test Loss: 1.433 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.196432113647461
Epoch: 2, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.487 Vali Acc: 0.255 Test Loss: 1.487 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.231151819229126
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.765 Vali Acc: 0.243 Test Loss: 1.765 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0221805572509766
Epoch: 4, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.557 Vali Acc: 0.278 Test Loss: 1.557 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 0.9886424541473389
Epoch: 5, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.774 Vali Acc: 0.243 Test Loss: 1.774 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9405503273010254
Epoch: 6, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.878 Vali Acc: 0.247 Test Loss: 1.878 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0605409145355225
Epoch: 7, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.959 Vali Acc: 0.236 Test Loss: 1.959 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0647838115692139
Epoch: 8, Steps: 17 | Train Loss: 1.057 Vali Loss: 2.008 Vali Acc: 0.274 Test Loss: 2.008 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2630188465118408
Epoch: 9, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.156 Vali Acc: 0.274 Test Loss: 2.156 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1943089962005615
Epoch: 10, Steps: 17 | Train Loss: 0.762 Vali Loss: 2.216 Vali Acc: 0.259 Test Loss: 2.216 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.180626630783081
Epoch: 11, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.302 Vali Acc: 0.221 Test Loss: 2.302 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3122239112854004
Epoch: 12, Steps: 17 | Train Loss: 0.619 Vali Loss: 2.421 Vali Acc: 0.262 Test Loss: 2.421 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1171495914459229
Epoch: 13, Steps: 17 | Train Loss: 0.589 Vali Loss: 2.462 Vali Acc: 0.266 Test Loss: 2.462 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9999122619628906
Epoch: 14, Steps: 17 | Train Loss: 0.558 Vali Loss: 2.814 Vali Acc: 0.262 Test Loss: 2.814 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 542340
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4287548065185547
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.406 Vali Acc: 0.262 Test Loss: 1.406 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.9817750453948975
Epoch: 2, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.409 Vali Acc: 0.251 Test Loss: 1.409 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9409651756286621
Epoch: 3, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.502 Vali Acc: 0.243 Test Loss: 1.502 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9509987831115723
Epoch: 4, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.456 Vali Acc: 0.262 Test Loss: 1.456 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9078772068023682
Epoch: 5, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.504 Vali Acc: 0.289 Test Loss: 1.504 Test Acc: 0.289
Validation loss decreased (-0.262343 --> -0.288958).  Saving model ...
Epoch: 6 cost time: 0.8513610363006592
Epoch: 6, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.516 Vali Acc: 0.270 Test Loss: 1.516 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8313653469085693
Epoch: 7, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.562 Vali Acc: 0.243 Test Loss: 1.562 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8737051486968994
Epoch: 8, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.609 Vali Acc: 0.266 Test Loss: 1.609 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0185866355895996
Epoch: 9, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.694 Vali Acc: 0.270 Test Loss: 1.694 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.027766227722168
Epoch: 10, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.853 Vali Acc: 0.270 Test Loss: 1.853 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0109810829162598
Epoch: 11, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.809 Vali Acc: 0.255 Test Loss: 1.809 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.076538324356079
Epoch: 12, Steps: 17 | Train Loss: 0.708 Vali Loss: 2.112 Vali Acc: 0.251 Test Loss: 2.112 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0406432151794434
Epoch: 13, Steps: 17 | Train Loss: 0.747 Vali Loss: 2.064 Vali Acc: 0.281 Test Loss: 2.064 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9782454967498779
Epoch: 14, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.180 Vali Acc: 0.266 Test Loss: 2.180 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9588546752929688
Epoch: 15, Steps: 17 | Train Loss: 0.688 Vali Loss: 2.266 Vali Acc: 0.262 Test Loss: 2.266 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 486532
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3134896755218506
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 0.9888432025909424
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.538 Vali Acc: 0.240 Test Loss: 1.538 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9679224491119385
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.441 Vali Acc: 0.266 Test Loss: 1.441 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9254815578460693
Epoch: 4, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.442 Vali Acc: 0.247 Test Loss: 1.442 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9925370216369629
Epoch: 5, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.444 Vali Acc: 0.232 Test Loss: 1.444 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9143548011779785
Epoch: 6, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.472 Vali Acc: 0.243 Test Loss: 1.472 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8312528133392334
Epoch: 7, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.473 Vali Acc: 0.251 Test Loss: 1.473 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8450827598571777
Epoch: 8, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.646 Vali Acc: 0.217 Test Loss: 1.646 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9456408023834229
Epoch: 9, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.993767261505127
Epoch: 10, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.594 Vali Acc: 0.243 Test Loss: 1.594 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9808826446533203
Epoch: 11, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.679 Vali Acc: 0.217 Test Loss: 1.679 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 472196
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.297090530395508
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.7980031967163086
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.400 Vali Acc: 0.232 Test Loss: 1.400 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8571629524230957
Epoch: 3, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.426 Vali Acc: 0.266 Test Loss: 1.426 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 0.9279768466949463
Epoch: 4, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.441 Vali Acc: 0.278 Test Loss: 1.441 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 0.8685493469238281
Epoch: 5, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.571 Vali Acc: 0.247 Test Loss: 1.571 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9526529312133789
Epoch: 6, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.452 Vali Acc: 0.221 Test Loss: 1.452 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8663496971130371
Epoch: 7, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.502 Vali Acc: 0.251 Test Loss: 1.502 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8307321071624756
Epoch: 8, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.517 Vali Acc: 0.247 Test Loss: 1.517 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8674678802490234
Epoch: 9, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.645 Vali Acc: 0.259 Test Loss: 1.645 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8467414379119873
Epoch: 10, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.616 Vali Acc: 0.262 Test Loss: 1.616 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7959649562835693
Epoch: 11, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.663 Vali Acc: 0.255 Test Loss: 1.663 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8193809986114502
Epoch: 12, Steps: 17 | Train Loss: 0.887 Vali Loss: 1.708 Vali Acc: 0.236 Test Loss: 1.708 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8168318271636963
Epoch: 13, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.656 Vali Acc: 0.255 Test Loss: 1.656 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8703658580780029
Epoch: 14, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.856 Vali Acc: 0.247 Test Loss: 1.856 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 467076
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.258070230484009
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.403 Vali Acc: 0.262 Test Loss: 1.403 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.9562525749206543
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.448 Vali Acc: 0.251 Test Loss: 1.448 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9206500053405762
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.427 Vali Acc: 0.266 Test Loss: 1.427 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 0.9076263904571533
Epoch: 4, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.446 Vali Acc: 0.293 Test Loss: 1.446 Test Acc: 0.293
Validation loss decreased (-0.266145 --> -0.292761).  Saving model ...
Epoch: 5 cost time: 0.8409068584442139
Epoch: 5, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.449 Vali Acc: 0.251 Test Loss: 1.449 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8877599239349365
Epoch: 6, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.520 Vali Acc: 0.224 Test Loss: 1.520 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9090662002563477
Epoch: 7, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.444 Vali Acc: 0.251 Test Loss: 1.444 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9577698707580566
Epoch: 8, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.463 Vali Acc: 0.281 Test Loss: 1.463 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.958050012588501
Epoch: 9, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.481 Vali Acc: 0.266 Test Loss: 1.481 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9872446060180664
Epoch: 10, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.542 Vali Acc: 0.270 Test Loss: 1.542 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.056532621383667
Epoch: 11, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.595 Vali Acc: 0.259 Test Loss: 1.595 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9412317276000977
Epoch: 12, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.587 Vali Acc: 0.255 Test Loss: 1.587 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9716238975524902
Epoch: 13, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.558 Vali Acc: 0.243 Test Loss: 1.558 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.025434970855713
Epoch: 14, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.632 Vali Acc: 0.251 Test Loss: 1.632 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 468996
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1560983657836914
Epoch: 1, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.381 Vali Acc: 0.278 Test Loss: 1.381 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 0.9590280055999756
Epoch: 2, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.398 Vali Acc: 0.266 Test Loss: 1.398 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9403271675109863
Epoch: 3, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.395 Vali Acc: 0.247 Test Loss: 1.395 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.923248291015625
Epoch: 4, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.450 Vali Acc: 0.274 Test Loss: 1.450 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9446506500244141
Epoch: 5, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9106221199035645
Epoch: 6, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.494 Vali Acc: 0.274 Test Loss: 1.494 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9360525608062744
Epoch: 7, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.496 Vali Acc: 0.251 Test Loss: 1.496 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.959937334060669
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.532 Vali Acc: 0.285 Test Loss: 1.532 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 0.9682438373565674
Epoch: 9, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.586 Vali Acc: 0.228 Test Loss: 1.586 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9453778266906738
Epoch: 10, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.537 Vali Acc: 0.232 Test Loss: 1.537 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9289133548736572
Epoch: 11, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.544 Vali Acc: 0.240 Test Loss: 1.544 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9970550537109375
Epoch: 12, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9027843475341797
Epoch: 13, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.642 Vali Acc: 0.289 Test Loss: 1.642 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288957).  Saving model ...
Epoch: 14 cost time: 1.0608837604522705
Epoch: 14, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.618 Vali Acc: 0.240 Test Loss: 1.618 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9069163799285889
Epoch: 15, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.685 Vali Acc: 0.243 Test Loss: 1.685 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9724884033203125
Epoch: 16, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.824 Vali Acc: 0.259 Test Loss: 1.824 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9537844657897949
Epoch: 17, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.809 Vali Acc: 0.255 Test Loss: 1.809 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0129404067993164
Epoch: 18, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.824 Vali Acc: 0.243 Test Loss: 1.824 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9618611335754395
Epoch: 19, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.758 Vali Acc: 0.236 Test Loss: 1.758 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.984705924987793
Epoch: 20, Steps: 17 | Train Loss: 0.822 Vali Loss: 1.804 Vali Acc: 0.240 Test Loss: 1.804 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9834856986999512
Epoch: 21, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.989 Vali Acc: 0.251 Test Loss: 1.989 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9872171878814697
Epoch: 22, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.061 Vali Acc: 0.262 Test Loss: 2.061 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9479460716247559
Epoch: 23, Steps: 17 | Train Loss: 0.776 Vali Loss: 1.999 Vali Acc: 0.255 Test Loss: 1.999 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 474116
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.286933660507202
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.416 Vali Acc: 0.221 Test Loss: 1.416 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 1.040391445159912
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.425 Vali Acc: 0.217 Test Loss: 1.425 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9896032810211182
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
Validation loss decreased (-0.220518 --> -0.243332).  Saving model ...
Epoch: 4 cost time: 0.9713864326477051
Epoch: 4, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.431 Vali Acc: 0.243 Test Loss: 1.431 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8736238479614258
Epoch: 5, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.423 Vali Acc: 0.213 Test Loss: 1.423 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9239101409912109
Epoch: 6, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.481 Vali Acc: 0.213 Test Loss: 1.481 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9048910140991211
Epoch: 7, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.459 Vali Acc: 0.232 Test Loss: 1.459 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9269108772277832
Epoch: 8, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.478 Vali Acc: 0.236 Test Loss: 1.478 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8523132801055908
Epoch: 9, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.507 Vali Acc: 0.221 Test Loss: 1.507 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8873825073242188
Epoch: 10, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.582 Vali Acc: 0.251 Test Loss: 1.582 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250935).  Saving model ...
Epoch: 11 cost time: 0.8895111083984375
Epoch: 11, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.572 Vali Acc: 0.240 Test Loss: 1.572 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8743541240692139
Epoch: 12, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.538 Vali Acc: 0.247 Test Loss: 1.538 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9001269340515137
Epoch: 13, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.677 Vali Acc: 0.289 Test Loss: 1.677 Test Acc: 0.289
Validation loss decreased (-0.250935 --> -0.288957).  Saving model ...
Epoch: 14 cost time: 0.9891624450683594
Epoch: 14, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.642 Vali Acc: 0.217 Test Loss: 1.642 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.926936149597168
Epoch: 15, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.673 Vali Acc: 0.247 Test Loss: 1.673 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.996685266494751
Epoch: 16, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.733 Vali Acc: 0.274 Test Loss: 1.733 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9273927211761475
Epoch: 17, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.854 Vali Acc: 0.243 Test Loss: 1.854 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8879432678222656
Epoch: 18, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.762 Vali Acc: 0.240 Test Loss: 1.762 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0087225437164307
Epoch: 19, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.745 Vali Acc: 0.243 Test Loss: 1.745 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8607444763183594
Epoch: 20, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.737 Vali Acc: 0.236 Test Loss: 1.737 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9246683120727539
Epoch: 21, Steps: 17 | Train Loss: 0.783 Vali Loss: 1.963 Vali Acc: 0.243 Test Loss: 1.963 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0122466087341309
Epoch: 22, Steps: 17 | Train Loss: 0.778 Vali Loss: 1.925 Vali Acc: 0.224 Test Loss: 1.925 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0214650630950928
Epoch: 23, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.887 Vali Acc: 0.240 Test Loss: 1.887 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 482180
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1921041011810303
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.473 Vali Acc: 0.232 Test Loss: 1.473 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 0.8000884056091309
Epoch: 2, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
Validation loss decreased (-0.231924 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 0.8693678379058838
Epoch: 3, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 0.8490474224090576
Epoch: 4, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.533 Vali Acc: 0.274 Test Loss: 1.533 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 0.949028730392456
Epoch: 5, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.489 Vali Acc: 0.255 Test Loss: 1.489 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9469401836395264
Epoch: 6, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.511 Vali Acc: 0.285 Test Loss: 1.511 Test Acc: 0.285
Validation loss decreased (-0.273749 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 0.9307956695556641
Epoch: 7, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.591 Vali Acc: 0.259 Test Loss: 1.591 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8855125904083252
Epoch: 8, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.661 Vali Acc: 0.270 Test Loss: 1.661 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8927736282348633
Epoch: 9, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.766 Vali Acc: 0.266 Test Loss: 1.766 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9115121364593506
Epoch: 10, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.779 Vali Acc: 0.262 Test Loss: 1.779 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8996098041534424
Epoch: 11, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.882 Vali Acc: 0.243 Test Loss: 1.882 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8947229385375977
Epoch: 12, Steps: 17 | Train Loss: 0.741 Vali Loss: 1.916 Vali Acc: 0.270 Test Loss: 1.916 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9052958488464355
Epoch: 13, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.028 Vali Acc: 0.266 Test Loss: 2.028 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0686976909637451
Epoch: 14, Steps: 17 | Train Loss: 0.642 Vali Loss: 2.071 Vali Acc: 0.243 Test Loss: 2.071 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9401874542236328
Epoch: 15, Steps: 17 | Train Loss: 0.604 Vali Loss: 2.170 Vali Acc: 0.262 Test Loss: 2.170 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9120709896087646
Epoch: 16, Steps: 17 | Train Loss: 0.594 Vali Loss: 2.402 Vali Acc: 0.266 Test Loss: 2.402 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 172868
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.273956775665283
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.432 Vali Acc: 0.262 Test Loss: 1.432 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.8905282020568848
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.434 Vali Acc: 0.232 Test Loss: 1.434 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8195948600769043
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.471 Vali Acc: 0.270 Test Loss: 1.471 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 0.8582086563110352
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.450 Vali Acc: 0.281 Test Loss: 1.450 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 0.8321561813354492
Epoch: 5, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.465 Vali Acc: 0.251 Test Loss: 1.465 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.745342493057251
Epoch: 6, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8914148807525635
Epoch: 7, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.468 Vali Acc: 0.232 Test Loss: 1.468 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7934141159057617
Epoch: 8, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.509 Vali Acc: 0.243 Test Loss: 1.509 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8211665153503418
Epoch: 9, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.582 Vali Acc: 0.285 Test Loss: 1.582 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 10 cost time: 0.9148578643798828
Epoch: 10, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.604 Vali Acc: 0.270 Test Loss: 1.604 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8417887687683105
Epoch: 11, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.612 Vali Acc: 0.228 Test Loss: 1.612 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8489508628845215
Epoch: 12, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.744 Vali Acc: 0.251 Test Loss: 1.744 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8110942840576172
Epoch: 13, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8147406578063965
Epoch: 14, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.758 Vali Acc: 0.285 Test Loss: 1.758 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8732142448425293
Epoch: 15, Steps: 17 | Train Loss: 0.782 Vali Loss: 1.793 Vali Acc: 0.297 Test Loss: 1.793 Test Acc: 0.297
Validation loss decreased (-0.285155 --> -0.296560).  Saving model ...
Epoch: 16 cost time: 0.8424687385559082
Epoch: 16, Steps: 17 | Train Loss: 0.754 Vali Loss: 1.868 Vali Acc: 0.255 Test Loss: 1.868 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8061766624450684
Epoch: 17, Steps: 17 | Train Loss: 0.711 Vali Loss: 2.088 Vali Acc: 0.289 Test Loss: 2.088 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7547829151153564
Epoch: 18, Steps: 17 | Train Loss: 0.716 Vali Loss: 2.015 Vali Acc: 0.247 Test Loss: 2.015 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.856518030166626
Epoch: 19, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.153 Vali Acc: 0.236 Test Loss: 2.153 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8046560287475586
Epoch: 20, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.160 Vali Acc: 0.266 Test Loss: 2.160 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8204774856567383
Epoch: 21, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.187 Vali Acc: 0.243 Test Loss: 2.187 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9076957702636719
Epoch: 22, Steps: 17 | Train Loss: 0.630 Vali Loss: 1.949 Vali Acc: 0.262 Test Loss: 1.949 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7994680404663086
Epoch: 23, Steps: 17 | Train Loss: 0.600 Vali Loss: 2.263 Vali Acc: 0.266 Test Loss: 2.263 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8203244209289551
Epoch: 24, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.431 Vali Acc: 0.262 Test Loss: 2.431 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8533210754394531
Epoch: 25, Steps: 17 | Train Loss: 0.589 Vali Loss: 2.442 Vali Acc: 0.266 Test Loss: 2.442 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 144964
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.150036096572876
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.487 Vali Acc: 0.247 Test Loss: 1.487 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 0.824648380279541
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.445 Vali Acc: 0.255 Test Loss: 1.445 Test Acc: 0.255
Validation loss decreased (-0.247133 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 0.7204294204711914
Epoch: 3, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.443 Vali Acc: 0.278 Test Loss: 1.443 Test Acc: 0.278
Validation loss decreased (-0.254738 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 0.8731048107147217
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.423 Vali Acc: 0.240 Test Loss: 1.423 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.777738094329834
Epoch: 5, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.454 Vali Acc: 0.243 Test Loss: 1.454 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7416455745697021
Epoch: 6, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.438 Vali Acc: 0.236 Test Loss: 1.438 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7890393733978271
Epoch: 7, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.440 Vali Acc: 0.247 Test Loss: 1.440 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7825644016265869
Epoch: 8, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.487 Vali Acc: 0.262 Test Loss: 1.487 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7723343372344971
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.511 Vali Acc: 0.243 Test Loss: 1.511 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7343523502349854
Epoch: 10, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.483 Vali Acc: 0.255 Test Loss: 1.483 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8294932842254639
Epoch: 11, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.542 Vali Acc: 0.209 Test Loss: 1.542 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7408597469329834
Epoch: 12, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.573 Vali Acc: 0.255 Test Loss: 1.573 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7925467491149902
Epoch: 13, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.575 Vali Acc: 0.236 Test Loss: 1.575 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 137796
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.429462194442749
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.402 Vali Acc: 0.236 Test Loss: 1.402 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 0.774754524230957
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.391 Vali Acc: 0.255 Test Loss: 1.391 Test Acc: 0.255
Validation loss decreased (-0.235727 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 0.7823593616485596
Epoch: 3, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.402 Vali Acc: 0.251 Test Loss: 1.402 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7876181602478027
Epoch: 4, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.72080397605896
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.415 Vali Acc: 0.247 Test Loss: 1.415 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8492012023925781
Epoch: 6, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.436 Vali Acc: 0.240 Test Loss: 1.436 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7905268669128418
Epoch: 7, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.453 Vali Acc: 0.251 Test Loss: 1.453 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7607631683349609
Epoch: 8, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.449 Vali Acc: 0.221 Test Loss: 1.449 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.77030348777771
Epoch: 9, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.508 Vali Acc: 0.293 Test Loss: 1.508 Test Acc: 0.293
Validation loss decreased (-0.254739 --> -0.292761).  Saving model ...
Epoch: 10 cost time: 0.8144819736480713
Epoch: 10, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.473 Vali Acc: 0.224 Test Loss: 1.473 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8087282180786133
Epoch: 11, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.505 Vali Acc: 0.255 Test Loss: 1.505 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8104152679443359
Epoch: 12, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.510 Vali Acc: 0.243 Test Loss: 1.510 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7768692970275879
Epoch: 13, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.616 Vali Acc: 0.255 Test Loss: 1.616 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7553520202636719
Epoch: 14, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.558 Vali Acc: 0.251 Test Loss: 1.558 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7411725521087646
Epoch: 15, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.570 Vali Acc: 0.209 Test Loss: 1.570 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7619752883911133
Epoch: 16, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.635 Vali Acc: 0.243 Test Loss: 1.635 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.793053388595581
Epoch: 17, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.656 Vali Acc: 0.251 Test Loss: 1.656 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7791340351104736
Epoch: 18, Steps: 17 | Train Loss: 0.851 Vali Loss: 1.653 Vali Acc: 0.259 Test Loss: 1.653 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7565040588378906
Epoch: 19, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.673 Vali Acc: 0.251 Test Loss: 1.673 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 135236
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.035191774368286
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.411 Vali Acc: 0.255 Test Loss: 1.411 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.6801433563232422
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.392 Vali Acc: 0.259 Test Loss: 1.392 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.6965768337249756
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.390 Vali Acc: 0.274 Test Loss: 1.390 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.7375283241271973
Epoch: 4, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.395 Vali Acc: 0.247 Test Loss: 1.395 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6706736087799072
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6942458152770996
Epoch: 6, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.414 Vali Acc: 0.266 Test Loss: 1.414 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6645071506500244
Epoch: 7, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.433 Vali Acc: 0.255 Test Loss: 1.433 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6789095401763916
Epoch: 8, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.422 Vali Acc: 0.240 Test Loss: 1.422 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7403848171234131
Epoch: 9, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.425 Vali Acc: 0.251 Test Loss: 1.425 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7543065547943115
Epoch: 10, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.440 Vali Acc: 0.243 Test Loss: 1.440 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7499096393585205
Epoch: 11, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.476 Vali Acc: 0.232 Test Loss: 1.476 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.685791015625
Epoch: 12, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.494 Vali Acc: 0.247 Test Loss: 1.494 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7443065643310547
Epoch: 13, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.538 Vali Acc: 0.285 Test Loss: 1.538 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 14 cost time: 0.7074971199035645
Epoch: 14, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6900742053985596
Epoch: 15, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.530 Vali Acc: 0.247 Test Loss: 1.530 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6886131763458252
Epoch: 16, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.531 Vali Acc: 0.255 Test Loss: 1.531 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7025251388549805
Epoch: 17, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.563 Vali Acc: 0.278 Test Loss: 1.563 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6902425289154053
Epoch: 18, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.636 Vali Acc: 0.224 Test Loss: 1.636 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8087630271911621
Epoch: 19, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.615 Vali Acc: 0.251 Test Loss: 1.615 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7054922580718994
Epoch: 20, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7039620876312256
Epoch: 21, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6467554569244385
Epoch: 22, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.651 Vali Acc: 0.259 Test Loss: 1.651 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6708581447601318
Epoch: 23, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.730 Vali Acc: 0.251 Test Loss: 1.730 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 136196
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.139568328857422
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 0.8048491477966309
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 0.7309374809265137
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.393 Vali Acc: 0.289 Test Loss: 1.393 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 0.7684352397918701
Epoch: 4, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7069120407104492
Epoch: 5, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.710066556930542
Epoch: 6, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.417 Vali Acc: 0.251 Test Loss: 1.417 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7132272720336914
Epoch: 7, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.417 Vali Acc: 0.266 Test Loss: 1.417 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7227845191955566
Epoch: 8, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.441 Vali Acc: 0.228 Test Loss: 1.441 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6953825950622559
Epoch: 9, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.433 Vali Acc: 0.228 Test Loss: 1.433 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7057559490203857
Epoch: 10, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.453 Vali Acc: 0.205 Test Loss: 1.453 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6956417560577393
Epoch: 11, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.463 Vali Acc: 0.278 Test Loss: 1.463 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7690598964691162
Epoch: 12, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.517 Vali Acc: 0.293 Test Loss: 1.517 Test Acc: 0.293
Validation loss decreased (-0.288959 --> -0.292760).  Saving model ...
Epoch: 13 cost time: 0.7601525783538818
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.485 Vali Acc: 0.281 Test Loss: 1.485 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7388653755187988
Epoch: 14, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7000720500946045
Epoch: 15, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.496 Vali Acc: 0.240 Test Loss: 1.496 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8250732421875
Epoch: 16, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.486 Vali Acc: 0.251 Test Loss: 1.486 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7092440128326416
Epoch: 17, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.546 Vali Acc: 0.270 Test Loss: 1.546 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6889848709106445
Epoch: 18, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.589 Vali Acc: 0.232 Test Loss: 1.589 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7064416408538818
Epoch: 19, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.634 Vali Acc: 0.262 Test Loss: 1.634 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7128849029541016
Epoch: 20, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.568 Vali Acc: 0.255 Test Loss: 1.568 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6774156093597412
Epoch: 21, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.692 Vali Acc: 0.274 Test Loss: 1.692 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.691666841506958
Epoch: 22, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.622 Vali Acc: 0.247 Test Loss: 1.622 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 138756
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0819034576416016
Epoch: 1, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.421 Vali Acc: 0.259 Test Loss: 1.421 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7194948196411133
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.406 Vali Acc: 0.240 Test Loss: 1.406 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7478768825531006
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.423 Vali Acc: 0.262 Test Loss: 1.423 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 0.749903678894043
Epoch: 4, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7685840129852295
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7375469207763672
Epoch: 6, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.436 Vali Acc: 0.251 Test Loss: 1.436 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7031102180480957
Epoch: 7, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.472 Vali Acc: 0.274 Test Loss: 1.472 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 8 cost time: 0.7217130661010742
Epoch: 8, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.451 Vali Acc: 0.262 Test Loss: 1.451 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8340404033660889
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.448 Vali Acc: 0.232 Test Loss: 1.448 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7840261459350586
Epoch: 10, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.480 Vali Acc: 0.255 Test Loss: 1.480 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7612762451171875
Epoch: 11, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.500 Vali Acc: 0.243 Test Loss: 1.500 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.751988410949707
Epoch: 12, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.486 Vali Acc: 0.259 Test Loss: 1.486 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7014639377593994
Epoch: 13, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.547 Vali Acc: 0.281 Test Loss: 1.547 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281353).  Saving model ...
Epoch: 14 cost time: 0.7361390590667725
Epoch: 14, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.535 Vali Acc: 0.247 Test Loss: 1.535 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7311947345733643
Epoch: 15, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.526 Vali Acc: 0.278 Test Loss: 1.526 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6879515647888184
Epoch: 16, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.572 Vali Acc: 0.247 Test Loss: 1.572 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7197802066802979
Epoch: 17, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.540 Vali Acc: 0.274 Test Loss: 1.540 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8423678874969482
Epoch: 18, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.577 Vali Acc: 0.266 Test Loss: 1.577 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7351348400115967
Epoch: 19, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.578 Vali Acc: 0.243 Test Loss: 1.578 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7464022636413574
Epoch: 20, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.667 Vali Acc: 0.270 Test Loss: 1.667 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.765023946762085
Epoch: 21, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.712 Vali Acc: 0.259 Test Loss: 1.712 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7413914203643799
Epoch: 22, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7199642658233643
Epoch: 23, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.723 Vali Acc: 0.243 Test Loss: 1.723 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 142788
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1896729469299316
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.419 Vali Acc: 0.236 Test Loss: 1.419 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 0.8293972015380859
Epoch: 2, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 0.811565637588501
Epoch: 3, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.427 Vali Acc: 0.262 Test Loss: 1.427 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 0.7696108818054199
Epoch: 4, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.423 Vali Acc: 0.270 Test Loss: 1.423 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 0.7169878482818604
Epoch: 5, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.441 Vali Acc: 0.236 Test Loss: 1.441 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7633035182952881
Epoch: 6, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.477 Vali Acc: 0.240 Test Loss: 1.477 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7592315673828125
Epoch: 7, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.506 Vali Acc: 0.247 Test Loss: 1.506 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7528767585754395
Epoch: 8, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.508 Vali Acc: 0.251 Test Loss: 1.508 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7461333274841309
Epoch: 9, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.595 Vali Acc: 0.259 Test Loss: 1.595 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7908554077148438
Epoch: 10, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.541 Vali Acc: 0.240 Test Loss: 1.541 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.919189453125
Epoch: 11, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.578 Vali Acc: 0.270 Test Loss: 1.578 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7617530822753906
Epoch: 12, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.694 Vali Acc: 0.232 Test Loss: 1.694 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8296952247619629
Epoch: 13, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.676 Vali Acc: 0.262 Test Loss: 1.676 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.788637638092041
Epoch: 14, Steps: 17 | Train Loss: 0.780 Vali Loss: 1.745 Vali Acc: 0.228 Test Loss: 1.745 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 61860
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0385072231292725
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.415 Vali Acc: 0.255 Test Loss: 1.415 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.7771239280700684
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.798553466796875
Epoch: 3, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.416 Vali Acc: 0.255 Test Loss: 1.416 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8123416900634766
Epoch: 4, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.406 Vali Acc: 0.243 Test Loss: 1.406 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7901959419250488
Epoch: 5, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.413 Vali Acc: 0.255 Test Loss: 1.413 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 6 cost time: 0.7166259288787842
Epoch: 6, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.414 Vali Acc: 0.259 Test Loss: 1.414 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 7 cost time: 0.6937639713287354
Epoch: 7, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.417 Vali Acc: 0.266 Test Loss: 1.417 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 8 cost time: 0.758331298828125
Epoch: 8, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.408 Vali Acc: 0.240 Test Loss: 1.408 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7679502964019775
Epoch: 9, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.421 Vali Acc: 0.251 Test Loss: 1.421 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7167010307312012
Epoch: 10, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.433 Vali Acc: 0.266 Test Loss: 1.433 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7924551963806152
Epoch: 11, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.459 Vali Acc: 0.274 Test Loss: 1.459 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 12 cost time: 0.7628586292266846
Epoch: 12, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.511 Vali Acc: 0.259 Test Loss: 1.511 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7730262279510498
Epoch: 13, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.524 Vali Acc: 0.243 Test Loss: 1.524 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7368097305297852
Epoch: 14, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.549 Vali Acc: 0.262 Test Loss: 1.549 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6832020282745361
Epoch: 15, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.599 Vali Acc: 0.228 Test Loss: 1.599 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7916760444641113
Epoch: 16, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.605 Vali Acc: 0.270 Test Loss: 1.605 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6992056369781494
Epoch: 17, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.588 Vali Acc: 0.274 Test Loss: 1.588 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7153246402740479
Epoch: 18, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.612 Vali Acc: 0.266 Test Loss: 1.612 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6513049602508545
Epoch: 19, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.600 Vali Acc: 0.247 Test Loss: 1.600 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6873691082000732
Epoch: 20, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.690 Vali Acc: 0.285 Test Loss: 1.690 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285154).  Saving model ...
Epoch: 21 cost time: 0.6439533233642578
Epoch: 21, Steps: 17 | Train Loss: 0.783 Vali Loss: 1.783 Vali Acc: 0.243 Test Loss: 1.783 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7399113178253174
Epoch: 22, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.767 Vali Acc: 0.266 Test Loss: 1.767 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7055928707122803
Epoch: 23, Steps: 17 | Train Loss: 0.754 Vali Loss: 1.830 Vali Acc: 0.262 Test Loss: 1.830 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8050000667572021
Epoch: 24, Steps: 17 | Train Loss: 0.717 Vali Loss: 1.876 Vali Acc: 0.289 Test Loss: 1.876 Test Acc: 0.289
Validation loss decreased (-0.285154 --> -0.288955).  Saving model ...
Epoch: 25 cost time: 0.837181568145752
Epoch: 25, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.926 Vali Acc: 0.259 Test Loss: 1.926 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8273632526397705
Epoch: 26, Steps: 17 | Train Loss: 0.708 Vali Loss: 1.924 Vali Acc: 0.274 Test Loss: 1.924 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.763228178024292
Epoch: 27, Steps: 17 | Train Loss: 0.654 Vali Loss: 1.963 Vali Acc: 0.278 Test Loss: 1.963 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7522211074829102
Epoch: 28, Steps: 17 | Train Loss: 0.644 Vali Loss: 1.987 Vali Acc: 0.243 Test Loss: 1.987 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7450697422027588
Epoch: 29, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.987 Vali Acc: 0.251 Test Loss: 1.987 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6812014579772949
Epoch: 30, Steps: 17 | Train Loss: 0.625 Vali Loss: 2.064 Vali Acc: 0.251 Test Loss: 2.064 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7403700351715088
Epoch: 31, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.204 Vali Acc: 0.236 Test Loss: 2.204 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7026686668395996
Epoch: 32, Steps: 17 | Train Loss: 0.588 Vali Loss: 2.215 Vali Acc: 0.247 Test Loss: 2.215 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7256450653076172
Epoch: 33, Steps: 17 | Train Loss: 0.583 Vali Loss: 2.196 Vali Acc: 0.281 Test Loss: 2.196 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7631630897521973
Epoch: 34, Steps: 17 | Train Loss: 0.564 Vali Loss: 2.318 Vali Acc: 0.262 Test Loss: 2.318 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 47908
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9898796081542969
Epoch: 1, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.405 Vali Acc: 0.259 Test Loss: 1.405 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7096164226531982
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.403 Vali Acc: 0.262 Test Loss: 1.403 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 0.7080996036529541
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.403 Vali Acc: 0.259 Test Loss: 1.403 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7588441371917725
Epoch: 4, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.412 Vali Acc: 0.228 Test Loss: 1.412 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6996972560882568
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.405 Vali Acc: 0.278 Test Loss: 1.405 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 0.7190206050872803
Epoch: 6, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.400 Vali Acc: 0.240 Test Loss: 1.400 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7613065242767334
Epoch: 7, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.429 Vali Acc: 0.240 Test Loss: 1.429 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7617437839508057
Epoch: 8, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.416 Vali Acc: 0.232 Test Loss: 1.416 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7389533519744873
Epoch: 9, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.437 Vali Acc: 0.259 Test Loss: 1.437 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8062207698822021
Epoch: 10, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.444 Vali Acc: 0.270 Test Loss: 1.444 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8415746688842773
Epoch: 11, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.444 Vali Acc: 0.228 Test Loss: 1.444 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8266348838806152
Epoch: 12, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.505 Vali Acc: 0.251 Test Loss: 1.505 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7022593021392822
Epoch: 13, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.455 Vali Acc: 0.251 Test Loss: 1.455 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6372501850128174
Epoch: 14, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.478 Vali Acc: 0.243 Test Loss: 1.478 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.723548173904419
Epoch: 15, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.538 Vali Acc: 0.274 Test Loss: 1.538 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 44324
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.195021629333496
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.383 Vali Acc: 0.259 Test Loss: 1.383 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7764506340026855
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.379 Vali Acc: 0.278 Test Loss: 1.379 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 0.7570269107818604
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.382 Vali Acc: 0.259 Test Loss: 1.382 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6782042980194092
Epoch: 4, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.388 Vali Acc: 0.243 Test Loss: 1.388 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.74249267578125
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.385 Vali Acc: 0.270 Test Loss: 1.385 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7037599086761475
Epoch: 6, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.390 Vali Acc: 0.251 Test Loss: 1.390 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6689081192016602
Epoch: 7, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.405 Vali Acc: 0.274 Test Loss: 1.405 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7549808025360107
Epoch: 8, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.393 Vali Acc: 0.285 Test Loss: 1.393 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 0.7377266883850098
Epoch: 9, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.406 Vali Acc: 0.255 Test Loss: 1.406 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8558740615844727
Epoch: 10, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7614288330078125
Epoch: 11, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7662951946258545
Epoch: 12, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7329232692718506
Epoch: 13, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.435 Vali Acc: 0.240 Test Loss: 1.435 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7766909599304199
Epoch: 14, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.425 Vali Acc: 0.236 Test Loss: 1.425 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7258930206298828
Epoch: 15, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.465 Vali Acc: 0.224 Test Loss: 1.465 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6948952674865723
Epoch: 16, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.468 Vali Acc: 0.247 Test Loss: 1.468 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7591702938079834
Epoch: 17, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.501 Vali Acc: 0.228 Test Loss: 1.501 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6313514709472656
Epoch: 18, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.491 Vali Acc: 0.228 Test Loss: 1.491 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 43044
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9772276878356934
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.384 Vali Acc: 0.293 Test Loss: 1.384 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 0.8396358489990234
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.386 Vali Acc: 0.304 Test Loss: 1.386 Test Acc: 0.304
Validation loss decreased (-0.292762 --> -0.304169).  Saving model ...
Epoch: 3 cost time: 0.7881855964660645
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.382 Vali Acc: 0.266 Test Loss: 1.382 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7782013416290283
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.391 Vali Acc: 0.240 Test Loss: 1.391 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7430727481842041
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.395 Vali Acc: 0.240 Test Loss: 1.395 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6831009387969971
Epoch: 6, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7289948463439941
Epoch: 7, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.402 Vali Acc: 0.240 Test Loss: 1.402 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.820676326751709
Epoch: 8, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7274951934814453
Epoch: 9, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.421 Vali Acc: 0.240 Test Loss: 1.421 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.735771656036377
Epoch: 10, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.424 Vali Acc: 0.228 Test Loss: 1.424 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7485373020172119
Epoch: 11, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.438 Vali Acc: 0.236 Test Loss: 1.438 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.767491340637207
Epoch: 12, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.413 Vali Acc: 0.236 Test Loss: 1.413 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 43524
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0545620918273926
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.420 Vali Acc: 0.224 Test Loss: 1.420 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 0.7647671699523926
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
Validation loss decreased (-0.224320 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 0.7680723667144775
Epoch: 3, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.403 Vali Acc: 0.236 Test Loss: 1.403 Test Acc: 0.236
Validation loss decreased (-0.235727 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 0.7335467338562012
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.412 Vali Acc: 0.190 Test Loss: 1.412 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7635540962219238
Epoch: 5, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 6 cost time: 0.7100136280059814
Epoch: 6, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.414 Vali Acc: 0.217 Test Loss: 1.414 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.747769832611084
Epoch: 7, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.421 Vali Acc: 0.221 Test Loss: 1.421 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7639706134796143
Epoch: 8, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.422 Vali Acc: 0.221 Test Loss: 1.422 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7768185138702393
Epoch: 9, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.434 Vali Acc: 0.217 Test Loss: 1.434 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8082089424133301
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.451 Vali Acc: 0.247 Test Loss: 1.451 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.795706033706665
Epoch: 11, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.475 Vali Acc: 0.198 Test Loss: 1.475 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7775461673736572
Epoch: 12, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.449 Vali Acc: 0.228 Test Loss: 1.449 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7553873062133789
Epoch: 13, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.486 Vali Acc: 0.221 Test Loss: 1.486 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.656231164932251
Epoch: 14, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.459 Vali Acc: 0.236 Test Loss: 1.459 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7867166996002197
Epoch: 15, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.463 Vali Acc: 0.232 Test Loss: 1.463 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.24714828897338403
model parameter : 44804
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2793753147125244
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.414 Vali Acc: 0.289 Test Loss: 1.414 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 0.7810473442077637
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.399 Vali Acc: 0.236 Test Loss: 1.399 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7043962478637695
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.398 Vali Acc: 0.236 Test Loss: 1.398 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.704779863357544
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.401 Vali Acc: 0.209 Test Loss: 1.401 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6969447135925293
Epoch: 5, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.398 Vali Acc: 0.240 Test Loss: 1.398 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7658047676086426
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.397 Vali Acc: 0.236 Test Loss: 1.397 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7666451930999756
Epoch: 7, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.395 Vali Acc: 0.259 Test Loss: 1.395 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7687029838562012
Epoch: 8, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.402 Vali Acc: 0.247 Test Loss: 1.402 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7875134944915771
Epoch: 9, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7361199855804443
Epoch: 10, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7620790004730225
Epoch: 11, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 46820
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4379208087921143
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.384 Vali Acc: 0.285 Test Loss: 1.384 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 0.9947950839996338
Epoch: 2, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.378 Vali Acc: 0.270 Test Loss: 1.378 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0693011283874512
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.383 Vali Acc: 0.259 Test Loss: 1.383 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.003636360168457
Epoch: 4, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.410 Vali Acc: 0.293 Test Loss: 1.410 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292762).  Saving model ...
Epoch: 5 cost time: 1.0953123569488525
Epoch: 5, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0815632343292236
Epoch: 6, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.061861276626587
Epoch: 7, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9797286987304688
Epoch: 8, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.466 Vali Acc: 0.255 Test Loss: 1.466 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9595227241516113
Epoch: 9, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.488 Vali Acc: 0.289 Test Loss: 1.488 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9887747764587402
Epoch: 10, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.03825044631958
Epoch: 11, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.572 Vali Acc: 0.274 Test Loss: 1.572 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9299204349517822
Epoch: 12, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.617 Vali Acc: 0.274 Test Loss: 1.617 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1645636558532715
Epoch: 13, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.601 Vali Acc: 0.259 Test Loss: 1.601 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0789165496826172
Epoch: 14, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.786 Vali Acc: 0.285 Test Loss: 1.786 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 338468
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.233792781829834
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.389 Vali Acc: 0.281 Test Loss: 1.389 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 1.08258056640625
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.383 Vali Acc: 0.274 Test Loss: 1.383 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9487349987030029
Epoch: 3, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0384132862091064
Epoch: 4, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.391 Vali Acc: 0.262 Test Loss: 1.391 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9550998210906982
Epoch: 5, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.383 Vali Acc: 0.304 Test Loss: 1.383 Test Acc: 0.304
Validation loss decreased (-0.281355 --> -0.304169).  Saving model ...
Epoch: 6 cost time: 0.8899943828582764
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.394 Vali Acc: 0.289 Test Loss: 1.394 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0750541687011719
Epoch: 7, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.397 Vali Acc: 0.293 Test Loss: 1.397 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9759471416473389
Epoch: 8, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.390 Vali Acc: 0.281 Test Loss: 1.390 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.964493989944458
Epoch: 9, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.419 Vali Acc: 0.308 Test Loss: 1.419 Test Acc: 0.308
Validation loss decreased (-0.304169 --> -0.307971).  Saving model ...
Epoch: 10 cost time: 0.9242360591888428
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9263031482696533
Epoch: 11, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.467 Vali Acc: 0.270 Test Loss: 1.467 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9682755470275879
Epoch: 12, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.467 Vali Acc: 0.274 Test Loss: 1.467 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9293432235717773
Epoch: 13, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.507 Vali Acc: 0.289 Test Loss: 1.507 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9063045978546143
Epoch: 14, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.547 Vali Acc: 0.293 Test Loss: 1.547 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9177267551422119
Epoch: 15, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.547 Vali Acc: 0.274 Test Loss: 1.547 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9109587669372559
Epoch: 16, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.580 Vali Acc: 0.259 Test Loss: 1.580 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9615201950073242
Epoch: 17, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.645 Vali Acc: 0.270 Test Loss: 1.645 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8809771537780762
Epoch: 18, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.680 Vali Acc: 0.278 Test Loss: 1.680 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8967263698577881
Epoch: 19, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.736 Vali Acc: 0.266 Test Loss: 1.736 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 324516
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2062621116638184
Epoch: 1, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.382 Vali Acc: 0.293 Test Loss: 1.382 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 0.9197993278503418
Epoch: 2, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.376 Vali Acc: 0.316 Test Loss: 1.376 Test Acc: 0.316
Validation loss decreased (-0.292762 --> -0.315576).  Saving model ...
Epoch: 3 cost time: 0.9309437274932861
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.376 Vali Acc: 0.274 Test Loss: 1.376 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.881171703338623
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.375 Vali Acc: 0.289 Test Loss: 1.375 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0051319599151611
Epoch: 5, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.387 Vali Acc: 0.308 Test Loss: 1.387 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9036614894866943
Epoch: 6, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.388 Vali Acc: 0.278 Test Loss: 1.388 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9296221733093262
Epoch: 7, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8990175724029541
Epoch: 8, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.405 Vali Acc: 0.240 Test Loss: 1.405 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9263031482696533
Epoch: 9, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.416 Vali Acc: 0.247 Test Loss: 1.416 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9829344749450684
Epoch: 10, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.425 Vali Acc: 0.259 Test Loss: 1.425 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.893996000289917
Epoch: 11, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.429 Vali Acc: 0.266 Test Loss: 1.429 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8449721336364746
Epoch: 12, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.453 Vali Acc: 0.251 Test Loss: 1.453 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 321316
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2355079650878906
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.9117517471313477
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.376 Vali Acc: 0.308 Test Loss: 1.376 Test Acc: 0.308
Validation loss decreased (-0.243332 --> -0.307971).  Saving model ...
Epoch: 3 cost time: 0.9083337783813477
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.377 Vali Acc: 0.285 Test Loss: 1.377 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9539439678192139
Epoch: 4, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.386 Vali Acc: 0.251 Test Loss: 1.386 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9728782176971436
Epoch: 5, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.382 Vali Acc: 0.274 Test Loss: 1.382 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0544207096099854
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.386 Vali Acc: 0.293 Test Loss: 1.386 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.96140456199646
Epoch: 7, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.392 Vali Acc: 0.281 Test Loss: 1.392 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0339360237121582
Epoch: 8, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.409 Vali Acc: 0.251 Test Loss: 1.409 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.030367374420166
Epoch: 9, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.404 Vali Acc: 0.278 Test Loss: 1.404 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9711513519287109
Epoch: 10, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.413 Vali Acc: 0.255 Test Loss: 1.413 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.035372257232666
Epoch: 11, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.451 Vali Acc: 0.281 Test Loss: 1.451 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.967318058013916
Epoch: 12, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.419 Vali Acc: 0.266 Test Loss: 1.419 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 319652
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2357795238494873
Epoch: 1, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.001523494720459
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
Validation loss decreased (-0.243332 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 0.8687899112701416
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.396 Vali Acc: 0.251 Test Loss: 1.396 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250937).  Saving model ...
Epoch: 4 cost time: 0.967803955078125
Epoch: 4, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.395 Vali Acc: 0.251 Test Loss: 1.395 Test Acc: 0.251
Validation loss decreased (-0.250937 --> -0.250937).  Saving model ...
Epoch: 5 cost time: 1.0228164196014404
Epoch: 5, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.402 Vali Acc: 0.221 Test Loss: 1.402 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.925046443939209
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.401 Vali Acc: 0.274 Test Loss: 1.401 Test Acc: 0.274
Validation loss decreased (-0.250937 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 1.019906759262085
Epoch: 7, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.408 Vali Acc: 0.232 Test Loss: 1.408 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9843521118164062
Epoch: 8, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.426 Vali Acc: 0.247 Test Loss: 1.426 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0193517208099365
Epoch: 9, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.417 Vali Acc: 0.259 Test Loss: 1.417 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9932324886322021
Epoch: 10, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.434 Vali Acc: 0.255 Test Loss: 1.434 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9696457386016846
Epoch: 11, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9747524261474609
Epoch: 12, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.492 Vali Acc: 0.228 Test Loss: 1.492 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9640588760375977
Epoch: 13, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.511 Vali Acc: 0.285 Test Loss: 1.511 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 14 cost time: 0.9343430995941162
Epoch: 14, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.506 Vali Acc: 0.209 Test Loss: 1.506 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.937971830368042
Epoch: 15, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.507 Vali Acc: 0.240 Test Loss: 1.507 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9544463157653809
Epoch: 16, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.533 Vali Acc: 0.243 Test Loss: 1.533 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0091543197631836
Epoch: 17, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.583 Vali Acc: 0.232 Test Loss: 1.583 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9655559062957764
Epoch: 18, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.558 Vali Acc: 0.259 Test Loss: 1.558 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9954268932342529
Epoch: 19, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.654 Vali Acc: 0.243 Test Loss: 1.654 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9845867156982422
Epoch: 20, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.640 Vali Acc: 0.274 Test Loss: 1.640 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9950380325317383
Epoch: 21, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.816 Vali Acc: 0.255 Test Loss: 1.816 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8615896701812744
Epoch: 22, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.740 Vali Acc: 0.274 Test Loss: 1.740 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.002840518951416
Epoch: 23, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.711 Vali Acc: 0.270 Test Loss: 1.711 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 320900
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2383692264556885
Epoch: 1, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.9186880588531494
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.388 Vali Acc: 0.240 Test Loss: 1.388 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0447955131530762
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.388 Vali Acc: 0.228 Test Loss: 1.388 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9856793880462646
Epoch: 4, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.388 Vali Acc: 0.236 Test Loss: 1.388 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.935570240020752
Epoch: 5, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.396 Vali Acc: 0.232 Test Loss: 1.396 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.954669713973999
Epoch: 6, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.405 Vali Acc: 0.228 Test Loss: 1.405 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9537382125854492
Epoch: 7, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262343).  Saving model ...
Epoch: 8 cost time: 0.9815709590911865
Epoch: 8, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.419 Vali Acc: 0.202 Test Loss: 1.419 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.977766752243042
Epoch: 9, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.418 Vali Acc: 0.209 Test Loss: 1.418 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.074568748474121
Epoch: 10, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0139155387878418
Epoch: 11, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.468 Vali Acc: 0.262 Test Loss: 1.468 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9795238971710205
Epoch: 12, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.457 Vali Acc: 0.270 Test Loss: 1.457 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 13 cost time: 0.9583921432495117
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.520 Vali Acc: 0.281 Test Loss: 1.520 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 14 cost time: 0.9665398597717285
Epoch: 14, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.502 Vali Acc: 0.262 Test Loss: 1.502 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9583005905151367
Epoch: 15, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.482 Vali Acc: 0.262 Test Loss: 1.482 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.956852912902832
Epoch: 16, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.529 Vali Acc: 0.274 Test Loss: 1.529 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0192639827728271
Epoch: 17, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.561 Vali Acc: 0.274 Test Loss: 1.561 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0199472904205322
Epoch: 18, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.554 Vali Acc: 0.270 Test Loss: 1.554 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9615848064422607
Epoch: 19, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.697 Vali Acc: 0.278 Test Loss: 1.697 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9379351139068604
Epoch: 20, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.691 Vali Acc: 0.266 Test Loss: 1.691 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.96370530128479
Epoch: 21, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.753 Vali Acc: 0.270 Test Loss: 1.753 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9869840145111084
Epoch: 22, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.724 Vali Acc: 0.270 Test Loss: 1.724 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8930606842041016
Epoch: 23, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.784 Vali Acc: 0.243 Test Loss: 1.784 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 322180
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.294307231903076
Epoch: 1, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.383 Vali Acc: 0.262 Test Loss: 1.383 Test Acc: 0.262
Validation loss decreased (inf --> -0.262344).  Saving model ...
Epoch: 2 cost time: 0.9082224369049072
Epoch: 2, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.382 Vali Acc: 0.251 Test Loss: 1.382 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9222502708435059
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.379 Vali Acc: 0.213 Test Loss: 1.379 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9857993125915527
Epoch: 4, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.380 Vali Acc: 0.243 Test Loss: 1.380 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0271515846252441
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.387 Vali Acc: 0.259 Test Loss: 1.387 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9332318305969238
Epoch: 6, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.397 Vali Acc: 0.251 Test Loss: 1.397 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9461193084716797
Epoch: 7, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.028782606124878
Epoch: 8, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.415 Vali Acc: 0.247 Test Loss: 1.415 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9345352649688721
Epoch: 9, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.393 Vali Acc: 0.243 Test Loss: 1.393 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.004105567932129
Epoch: 10, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.431 Vali Acc: 0.259 Test Loss: 1.431 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.076871633529663
Epoch: 11, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.405 Vali Acc: 0.285 Test Loss: 1.405 Test Acc: 0.285
Validation loss decreased (-0.262344 --> -0.285157).  Saving model ...
Epoch: 12 cost time: 0.9646036624908447
Epoch: 12, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8902957439422607
Epoch: 13, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.449 Vali Acc: 0.281 Test Loss: 1.449 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9241061210632324
Epoch: 14, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.436 Vali Acc: 0.259 Test Loss: 1.436 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9253013134002686
Epoch: 15, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.517 Vali Acc: 0.285 Test Loss: 1.517 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9211456775665283
Epoch: 16, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.523 Vali Acc: 0.293 Test Loss: 1.523 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292760).  Saving model ...
Epoch: 17 cost time: 0.9059629440307617
Epoch: 17, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.620 Vali Acc: 0.255 Test Loss: 1.620 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9117329120635986
Epoch: 18, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.626 Vali Acc: 0.236 Test Loss: 1.626 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9664497375488281
Epoch: 19, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.726 Vali Acc: 0.285 Test Loss: 1.726 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.988006591796875
Epoch: 20, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.770 Vali Acc: 0.236 Test Loss: 1.770 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9340081214904785
Epoch: 21, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.708 Vali Acc: 0.293 Test Loss: 1.708 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.871483325958252
Epoch: 22, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.796 Vali Acc: 0.266 Test Loss: 1.796 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.927126407623291
Epoch: 23, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.863 Vali Acc: 0.278 Test Loss: 1.863 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9966485500335693
Epoch: 24, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.963 Vali Acc: 0.285 Test Loss: 1.963 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9793727397918701
Epoch: 25, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.099 Vali Acc: 0.247 Test Loss: 2.099 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9941699504852295
Epoch: 26, Steps: 17 | Train Loss: 0.816 Vali Loss: 2.056 Vali Acc: 0.274 Test Loss: 2.056 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 323428
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.300692081451416
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.386 Vali Acc: 0.259 Test Loss: 1.386 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.957805871963501
Epoch: 2, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.388 Vali Acc: 0.247 Test Loss: 1.388 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9953341484069824
Epoch: 3, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0237348079681396
Epoch: 4, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.417 Vali Acc: 0.240 Test Loss: 1.417 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.935112476348877
Epoch: 5, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 6 cost time: 0.9575779438018799
Epoch: 6, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.435 Vali Acc: 0.274 Test Loss: 1.435 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 0.961503267288208
Epoch: 7, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.451 Vali Acc: 0.266 Test Loss: 1.451 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9441568851470947
Epoch: 8, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.508 Vali Acc: 0.259 Test Loss: 1.508 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0363214015960693
Epoch: 9, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.478 Vali Acc: 0.285 Test Loss: 1.478 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 0.9569451808929443
Epoch: 10, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.593 Vali Acc: 0.266 Test Loss: 1.593 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9127910137176514
Epoch: 11, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.554 Vali Acc: 0.289 Test Loss: 1.554 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288958).  Saving model ...
Epoch: 12 cost time: 0.9263927936553955
Epoch: 12, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.660 Vali Acc: 0.270 Test Loss: 1.660 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9284672737121582
Epoch: 13, Steps: 17 | Train Loss: 0.809 Vali Loss: 1.766 Vali Acc: 0.308 Test Loss: 1.766 Test Acc: 0.308
Validation loss decreased (-0.288958 --> -0.307967).  Saving model ...
Epoch: 14 cost time: 0.9119889736175537
Epoch: 14, Steps: 17 | Train Loss: 0.777 Vali Loss: 1.764 Vali Acc: 0.270 Test Loss: 1.764 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9549522399902344
Epoch: 15, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.888 Vali Acc: 0.293 Test Loss: 1.888 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0229451656341553
Epoch: 16, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.924 Vali Acc: 0.285 Test Loss: 1.924 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9448225498199463
Epoch: 17, Steps: 17 | Train Loss: 0.665 Vali Loss: 2.011 Vali Acc: 0.266 Test Loss: 2.011 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9265239238739014
Epoch: 18, Steps: 17 | Train Loss: 0.644 Vali Loss: 2.172 Vali Acc: 0.270 Test Loss: 2.172 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9069108963012695
Epoch: 19, Steps: 17 | Train Loss: 0.597 Vali Loss: 2.320 Vali Acc: 0.293 Test Loss: 2.320 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9203939437866211
Epoch: 20, Steps: 17 | Train Loss: 0.579 Vali Loss: 2.407 Vali Acc: 0.274 Test Loss: 2.407 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.042470932006836
Epoch: 21, Steps: 17 | Train Loss: 0.567 Vali Loss: 2.717 Vali Acc: 0.270 Test Loss: 2.717 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9821763038635254
Epoch: 22, Steps: 17 | Train Loss: 0.542 Vali Loss: 2.544 Vali Acc: 0.270 Test Loss: 2.544 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9613485336303711
Epoch: 23, Steps: 17 | Train Loss: 0.507 Vali Loss: 2.800 Vali Acc: 0.285 Test Loss: 2.800 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 335780
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4757606983184814
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.384 Vali Acc: 0.251 Test Loss: 1.384 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.9066910743713379
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.381 Vali Acc: 0.278 Test Loss: 1.381 Test Acc: 0.278
Validation loss decreased (-0.250937 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 0.961240291595459
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.375 Vali Acc: 0.274 Test Loss: 1.375 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9994192123413086
Epoch: 4, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.399 Vali Acc: 0.281 Test Loss: 1.399 Test Acc: 0.281
Validation loss decreased (-0.277553 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 0.8881494998931885
Epoch: 5, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.376 Vali Acc: 0.259 Test Loss: 1.376 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0665457248687744
Epoch: 6, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0597240924835205
Epoch: 7, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.422 Vali Acc: 0.285 Test Loss: 1.422 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285157).  Saving model ...
Epoch: 8 cost time: 1.0488312244415283
Epoch: 8, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.416 Vali Acc: 0.274 Test Loss: 1.416 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9539947509765625
Epoch: 9, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.428 Vali Acc: 0.240 Test Loss: 1.428 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8809459209442139
Epoch: 10, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.457 Vali Acc: 0.308 Test Loss: 1.457 Test Acc: 0.308
Validation loss decreased (-0.285157 --> -0.307970).  Saving model ...
Epoch: 11 cost time: 0.9060618877410889
Epoch: 11, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.469 Vali Acc: 0.289 Test Loss: 1.469 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9472255706787109
Epoch: 12, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.494 Vali Acc: 0.255 Test Loss: 1.494 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0040230751037598
Epoch: 13, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9744949340820312
Epoch: 14, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.548 Vali Acc: 0.255 Test Loss: 1.548 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9462997913360596
Epoch: 15, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.554 Vali Acc: 0.266 Test Loss: 1.554 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.886408805847168
Epoch: 16, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.559 Vali Acc: 0.232 Test Loss: 1.559 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9008409976959229
Epoch: 17, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.670 Vali Acc: 0.262 Test Loss: 1.670 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9553663730621338
Epoch: 18, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.683 Vali Acc: 0.274 Test Loss: 1.683 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0254039764404297
Epoch: 19, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.714 Vali Acc: 0.255 Test Loss: 1.714 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0424668788909912
Epoch: 20, Steps: 17 | Train Loss: 0.772 Vali Loss: 1.789 Vali Acc: 0.278 Test Loss: 1.789 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 321828
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2012381553649902
Epoch: 1, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.392 Vali Acc: 0.285 Test Loss: 1.392 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 0.9140281677246094
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.383 Vali Acc: 0.274 Test Loss: 1.383 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8839471340179443
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.395 Vali Acc: 0.262 Test Loss: 1.395 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9484193325042725
Epoch: 4, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.400 Vali Acc: 0.247 Test Loss: 1.400 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.901453971862793
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.395 Vali Acc: 0.232 Test Loss: 1.395 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0336129665374756
Epoch: 6, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.404 Vali Acc: 0.232 Test Loss: 1.404 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9046893119812012
Epoch: 7, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.408 Vali Acc: 0.262 Test Loss: 1.408 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9266688823699951
Epoch: 8, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.426 Vali Acc: 0.247 Test Loss: 1.426 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0351011753082275
Epoch: 9, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.445 Vali Acc: 0.270 Test Loss: 1.445 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9983174800872803
Epoch: 10, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.448 Vali Acc: 0.213 Test Loss: 1.448 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0427751541137695
Epoch: 11, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.458 Vali Acc: 0.240 Test Loss: 1.458 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 318628
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3297080993652344
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.371 Vali Acc: 0.281 Test Loss: 1.371 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 0.8614199161529541
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.368 Vali Acc: 0.285 Test Loss: 1.368 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 0.9094891548156738
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.373 Vali Acc: 0.281 Test Loss: 1.373 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8921778202056885
Epoch: 4, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.374 Vali Acc: 0.285 Test Loss: 1.374 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9685380458831787
Epoch: 5, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.376 Vali Acc: 0.293 Test Loss: 1.376 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292762).  Saving model ...
Epoch: 6 cost time: 0.9162430763244629
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.382 Vali Acc: 0.278 Test Loss: 1.382 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.034416675567627
Epoch: 7, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.387 Vali Acc: 0.266 Test Loss: 1.387 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9187111854553223
Epoch: 8, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.394 Vali Acc: 0.274 Test Loss: 1.394 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9307818412780762
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9709529876708984
Epoch: 10, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9990286827087402
Epoch: 11, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.412 Vali Acc: 0.259 Test Loss: 1.412 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9054391384124756
Epoch: 12, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.434 Vali Acc: 0.251 Test Loss: 1.434 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8203794956207275
Epoch: 13, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9425432682037354
Epoch: 14, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.501 Vali Acc: 0.251 Test Loss: 1.501 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8930203914642334
Epoch: 15, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.486 Vali Acc: 0.274 Test Loss: 1.486 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 316964
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3320302963256836
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.384 Vali Acc: 0.274 Test Loss: 1.384 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.9597189426422119
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.375 Vali Acc: 0.259 Test Loss: 1.375 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9798142910003662
Epoch: 3, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.379 Vali Acc: 0.243 Test Loss: 1.379 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9676806926727295
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.386 Vali Acc: 0.259 Test Loss: 1.386 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9327685832977295
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.385 Vali Acc: 0.266 Test Loss: 1.385 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9660165309906006
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.386 Vali Acc: 0.255 Test Loss: 1.386 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9536099433898926
Epoch: 7, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.390 Vali Acc: 0.247 Test Loss: 1.390 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9704735279083252
Epoch: 8, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.387 Vali Acc: 0.259 Test Loss: 1.387 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0240545272827148
Epoch: 9, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9351191520690918
Epoch: 10, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.415 Vali Acc: 0.262 Test Loss: 1.415 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9372754096984863
Epoch: 11, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.415 Vali Acc: 0.209 Test Loss: 1.415 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 318212
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.351952314376831
Epoch: 1, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.375 Vali Acc: 0.228 Test Loss: 1.375 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 0.8947417736053467
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.375 Vali Acc: 0.243 Test Loss: 1.375 Test Acc: 0.243
Validation loss decreased (-0.228123 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 0.9831829071044922
Epoch: 3, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.383 Vali Acc: 0.274 Test Loss: 1.383 Test Acc: 0.274
Validation loss decreased (-0.243332 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.917130708694458
Epoch: 4, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.381 Vali Acc: 0.247 Test Loss: 1.381 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.904247522354126
Epoch: 5, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.393 Vali Acc: 0.266 Test Loss: 1.393 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0315630435943604
Epoch: 6, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.403 Vali Acc: 0.255 Test Loss: 1.403 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0356738567352295
Epoch: 7, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.411 Vali Acc: 0.240 Test Loss: 1.411 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9992749691009521
Epoch: 8, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9817821979522705
Epoch: 9, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.435 Vali Acc: 0.236 Test Loss: 1.435 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9123854637145996
Epoch: 10, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.432 Vali Acc: 0.236 Test Loss: 1.432 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9574134349822998
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.475 Vali Acc: 0.228 Test Loss: 1.475 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9506254196166992
Epoch: 12, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.440 Vali Acc: 0.247 Test Loss: 1.440 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9594070911407471
Epoch: 13, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.503 Vali Acc: 0.221 Test Loss: 1.503 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 319492
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4110794067382812
Epoch: 1, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.0156452655792236
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.401 Vali Acc: 0.247 Test Loss: 1.401 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9796266555786133
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.406 Vali Acc: 0.262 Test Loss: 1.406 Test Acc: 0.262
Validation loss decreased (-0.250937 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 0.9469904899597168
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.400 Vali Acc: 0.236 Test Loss: 1.400 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9325644969940186
Epoch: 5, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.406 Vali Acc: 0.232 Test Loss: 1.406 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0343501567840576
Epoch: 6, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.414 Vali Acc: 0.251 Test Loss: 1.414 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9820702075958252
Epoch: 7, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.405 Vali Acc: 0.266 Test Loss: 1.405 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 8 cost time: 1.1118552684783936
Epoch: 8, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.423 Vali Acc: 0.266 Test Loss: 1.423 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.067460060119629
Epoch: 9, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.416 Vali Acc: 0.247 Test Loss: 1.416 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0106401443481445
Epoch: 10, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.442 Vali Acc: 0.240 Test Loss: 1.442 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0860583782196045
Epoch: 11, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0884902477264404
Epoch: 12, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.449 Vali Acc: 0.247 Test Loss: 1.449 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.02193021774292
Epoch: 13, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.446 Vali Acc: 0.270 Test Loss: 1.446 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 14 cost time: 1.0513832569122314
Epoch: 14, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.479 Vali Acc: 0.259 Test Loss: 1.479 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0630288124084473
Epoch: 15, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.527 Vali Acc: 0.259 Test Loss: 1.527 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0899899005889893
Epoch: 16, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.531 Vali Acc: 0.270 Test Loss: 1.531 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0531361103057861
Epoch: 17, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.554 Vali Acc: 0.274 Test Loss: 1.554 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273749).  Saving model ...
Epoch: 18 cost time: 1.008516788482666
Epoch: 18, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.626 Vali Acc: 0.281 Test Loss: 1.626 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281353).  Saving model ...
Epoch: 19 cost time: 1.0315325260162354
Epoch: 19, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.700 Vali Acc: 0.262 Test Loss: 1.700 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0700101852416992
Epoch: 20, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.701 Vali Acc: 0.240 Test Loss: 1.701 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1461403369903564
Epoch: 21, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.721 Vali Acc: 0.262 Test Loss: 1.721 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9865775108337402
Epoch: 22, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.791 Vali Acc: 0.285 Test Loss: 1.791 Test Acc: 0.285
Validation loss decreased (-0.281353 --> -0.285153).  Saving model ...
Epoch: 23 cost time: 1.065227746963501
Epoch: 23, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.724 Vali Acc: 0.266 Test Loss: 1.724 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0418639183044434
Epoch: 24, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.849 Vali Acc: 0.281 Test Loss: 1.849 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0906836986541748
Epoch: 25, Steps: 17 | Train Loss: 0.839 Vali Loss: 1.832 Vali Acc: 0.304 Test Loss: 1.832 Test Acc: 0.304
Validation loss decreased (-0.285153 --> -0.304164).  Saving model ...
Epoch: 26 cost time: 1.0172476768493652
Epoch: 26, Steps: 17 | Train Loss: 0.861 Vali Loss: 2.035 Vali Acc: 0.247 Test Loss: 2.035 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0472502708435059
Epoch: 27, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.966 Vali Acc: 0.255 Test Loss: 1.966 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0515120029449463
Epoch: 28, Steps: 17 | Train Loss: 0.824 Vali Loss: 2.016 Vali Acc: 0.262 Test Loss: 2.016 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.100637435913086
Epoch: 29, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.916 Vali Acc: 0.274 Test Loss: 1.916 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0215861797332764
Epoch: 30, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.916 Vali Acc: 0.278 Test Loss: 1.916 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.060781478881836
Epoch: 31, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.019 Vali Acc: 0.274 Test Loss: 2.019 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0747346878051758
Epoch: 32, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.255 Vali Acc: 0.251 Test Loss: 2.255 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.146972417831421
Epoch: 33, Steps: 17 | Train Loss: 0.804 Vali Loss: 2.434 Vali Acc: 0.270 Test Loss: 2.434 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9484603404998779
Epoch: 34, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.151 Vali Acc: 0.236 Test Loss: 2.151 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.064809799194336
Epoch: 35, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.232 Vali Acc: 0.247 Test Loss: 2.232 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 320740
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3847436904907227
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.395 Vali Acc: 0.262 Test Loss: 1.395 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.096081018447876
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.1068027019500732
Epoch: 3, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.528 Vali Acc: 0.259 Test Loss: 1.528 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1329193115234375
Epoch: 4, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.517 Vali Acc: 0.278 Test Loss: 1.517 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 1.183701515197754
Epoch: 5, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.442 Vali Acc: 0.262 Test Loss: 1.442 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.021702766418457
Epoch: 6, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.642 Vali Acc: 0.247 Test Loss: 1.642 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2403368949890137
Epoch: 7, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.728 Vali Acc: 0.270 Test Loss: 1.728 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0648448467254639
Epoch: 8, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.938 Vali Acc: 0.259 Test Loss: 1.938 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.135873794555664
Epoch: 9, Steps: 17 | Train Loss: 0.908 Vali Loss: 2.013 Vali Acc: 0.259 Test Loss: 2.013 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2258565425872803
Epoch: 10, Steps: 17 | Train Loss: 0.765 Vali Loss: 2.087 Vali Acc: 0.266 Test Loss: 2.087 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1065330505371094
Epoch: 11, Steps: 17 | Train Loss: 0.725 Vali Loss: 2.186 Vali Acc: 0.262 Test Loss: 2.186 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0967979431152344
Epoch: 12, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.672 Vali Acc: 0.266 Test Loss: 2.672 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1184148788452148
Epoch: 13, Steps: 17 | Train Loss: 0.567 Vali Loss: 2.981 Vali Acc: 0.297 Test Loss: 2.981 Test Acc: 0.297
Validation loss decreased (-0.277551 --> -0.296548).  Saving model ...
Epoch: 14 cost time: 1.1654462814331055
Epoch: 14, Steps: 17 | Train Loss: 0.552 Vali Loss: 3.093 Vali Acc: 0.228 Test Loss: 3.093 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9952826499938965
Epoch: 15, Steps: 17 | Train Loss: 0.486 Vali Loss: 3.578 Vali Acc: 0.262 Test Loss: 3.578 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2757482528686523
Epoch: 16, Steps: 17 | Train Loss: 0.456 Vali Loss: 3.574 Vali Acc: 0.251 Test Loss: 3.574 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.223123550415039
Epoch: 17, Steps: 17 | Train Loss: 0.394 Vali Loss: 3.943 Vali Acc: 0.255 Test Loss: 3.943 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2326316833496094
Epoch: 18, Steps: 17 | Train Loss: 0.387 Vali Loss: 4.357 Vali Acc: 0.243 Test Loss: 4.357 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1153090000152588
Epoch: 19, Steps: 17 | Train Loss: 0.331 Vali Loss: 4.509 Vali Acc: 0.228 Test Loss: 4.509 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.103731393814087
Epoch: 20, Steps: 17 | Train Loss: 0.324 Vali Loss: 5.369 Vali Acc: 0.228 Test Loss: 5.369 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0780961513519287
Epoch: 21, Steps: 17 | Train Loss: 0.323 Vali Loss: 5.321 Vali Acc: 0.202 Test Loss: 5.321 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.142923355102539
Epoch: 22, Steps: 17 | Train Loss: 0.288 Vali Loss: 5.588 Vali Acc: 0.213 Test Loss: 5.588 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.234159231185913
Epoch: 23, Steps: 17 | Train Loss: 0.361 Vali Loss: 5.586 Vali Acc: 0.213 Test Loss: 5.586 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1224836
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3416483402252197
Epoch: 1, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.372 Vali Acc: 0.266 Test Loss: 1.372 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.072068691253662
Epoch: 2, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.458 Vali Acc: 0.281 Test Loss: 1.458 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 1.0201873779296875
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.457 Vali Acc: 0.236 Test Loss: 1.457 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.024078607559204
Epoch: 4, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.443 Vali Acc: 0.281 Test Loss: 1.443 Test Acc: 0.281
Validation loss decreased (-0.281354 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 1.0578324794769287
Epoch: 5, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.454 Vali Acc: 0.262 Test Loss: 1.454 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0032432079315186
Epoch: 6, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.513 Vali Acc: 0.247 Test Loss: 1.513 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1388401985168457
Epoch: 7, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.558 Vali Acc: 0.259 Test Loss: 1.558 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0738153457641602
Epoch: 8, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.543 Vali Acc: 0.247 Test Loss: 1.543 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0323679447174072
Epoch: 9, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.647 Vali Acc: 0.247 Test Loss: 1.647 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0526626110076904
Epoch: 10, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.876 Vali Acc: 0.255 Test Loss: 1.876 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.962430477142334
Epoch: 11, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.854 Vali Acc: 0.224 Test Loss: 1.854 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0075442790985107
Epoch: 12, Steps: 17 | Train Loss: 0.723 Vali Loss: 2.018 Vali Acc: 0.262 Test Loss: 2.018 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1075685024261475
Epoch: 13, Steps: 17 | Train Loss: 0.680 Vali Loss: 2.215 Vali Acc: 0.278 Test Loss: 2.215 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1173839569091797
Epoch: 14, Steps: 17 | Train Loss: 0.660 Vali Loss: 2.245 Vali Acc: 0.274 Test Loss: 2.245 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1169028
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4583024978637695
Epoch: 1, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.389 Vali Acc: 0.247 Test Loss: 1.389 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.0607149600982666
Epoch: 2, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.386 Vali Acc: 0.247 Test Loss: 1.386 Test Acc: 0.247
Validation loss decreased (-0.247134 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.009702444076538
Epoch: 3, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.402 Vali Acc: 0.270 Test Loss: 1.402 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 0.9428322315216064
Epoch: 4, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.450 Vali Acc: 0.266 Test Loss: 1.450 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0060579776763916
Epoch: 5, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.421 Vali Acc: 0.232 Test Loss: 1.421 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8987767696380615
Epoch: 6, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.491 Vali Acc: 0.240 Test Loss: 1.491 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0927283763885498
Epoch: 7, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.461 Vali Acc: 0.240 Test Loss: 1.461 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0302588939666748
Epoch: 8, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.540 Vali Acc: 0.240 Test Loss: 1.540 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9953227043151855
Epoch: 9, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.584 Vali Acc: 0.240 Test Loss: 1.584 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0415236949920654
Epoch: 10, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.672 Vali Acc: 0.251 Test Loss: 1.672 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1210496425628662
Epoch: 11, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.824 Vali Acc: 0.266 Test Loss: 1.824 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0474727153778076
Epoch: 12, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.878 Vali Acc: 0.243 Test Loss: 1.878 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.054703712463379
Epoch: 13, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.854 Vali Acc: 0.255 Test Loss: 1.854 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1153156
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4678642749786377
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.156163215637207
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.398 Vali Acc: 0.240 Test Loss: 1.398 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0688161849975586
Epoch: 3, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1410295963287354
Epoch: 4, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.483 Vali Acc: 0.274 Test Loss: 1.483 Test Acc: 0.274
Validation loss decreased (-0.250937 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 1.0641610622406006
Epoch: 5, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.426 Vali Acc: 0.255 Test Loss: 1.426 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0365931987762451
Epoch: 6, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1029088497161865
Epoch: 7, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.517 Vali Acc: 0.240 Test Loss: 1.517 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2184855937957764
Epoch: 8, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.596 Vali Acc: 0.243 Test Loss: 1.596 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1159658432006836
Epoch: 9, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.542 Vali Acc: 0.255 Test Loss: 1.542 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0427627563476562
Epoch: 10, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.631 Vali Acc: 0.236 Test Loss: 1.631 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.083298921585083
Epoch: 11, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.777 Vali Acc: 0.243 Test Loss: 1.777 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0446090698242188
Epoch: 12, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.723 Vali Acc: 0.274 Test Loss: 1.723 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0816965103149414
Epoch: 13, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.986 Vali Acc: 0.255 Test Loss: 1.986 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0901079177856445
Epoch: 14, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.895 Vali Acc: 0.266 Test Loss: 1.895 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1149572
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4183123111724854
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.397 Vali Acc: 0.251 Test Loss: 1.397 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.1058647632598877
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.391 Vali Acc: 0.247 Test Loss: 1.391 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0410919189453125
Epoch: 3, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.408 Vali Acc: 0.240 Test Loss: 1.408 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0316760540008545
Epoch: 4, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.403 Vali Acc: 0.240 Test Loss: 1.403 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9905219078063965
Epoch: 5, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.442 Vali Acc: 0.236 Test Loss: 1.442 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2303447723388672
Epoch: 6, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.433 Vali Acc: 0.270 Test Loss: 1.433 Test Acc: 0.270
Validation loss decreased (-0.250937 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 1.185516119003296
Epoch: 7, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.461 Vali Acc: 0.270 Test Loss: 1.461 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0073583126068115
Epoch: 8, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.450 Vali Acc: 0.247 Test Loss: 1.450 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.11808443069458
Epoch: 9, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.559 Vali Acc: 0.228 Test Loss: 1.559 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1105570793151855
Epoch: 10, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.545 Vali Acc: 0.247 Test Loss: 1.545 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9862096309661865
Epoch: 11, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.582 Vali Acc: 0.236 Test Loss: 1.582 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.110306739807129
Epoch: 12, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.653 Vali Acc: 0.243 Test Loss: 1.653 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0692174434661865
Epoch: 13, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.713 Vali Acc: 0.270 Test Loss: 1.713 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.062685489654541
Epoch: 14, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.767 Vali Acc: 0.255 Test Loss: 1.767 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0655162334442139
Epoch: 15, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.780 Vali Acc: 0.255 Test Loss: 1.780 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9590117931365967
Epoch: 16, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.884 Vali Acc: 0.240 Test Loss: 1.884 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 1151492
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3625309467315674
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.9371700286865234
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.405 Vali Acc: 0.259 Test Loss: 1.405 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.9777286052703857
Epoch: 3, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.405 Vali Acc: 0.243 Test Loss: 1.405 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9808704853057861
Epoch: 4, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.418 Vali Acc: 0.209 Test Loss: 1.418 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0769550800323486
Epoch: 5, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.426 Vali Acc: 0.247 Test Loss: 1.426 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9179844856262207
Epoch: 6, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.482 Vali Acc: 0.224 Test Loss: 1.482 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9997267723083496
Epoch: 7, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.512 Vali Acc: 0.232 Test Loss: 1.512 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9529328346252441
Epoch: 8, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.477 Vali Acc: 0.243 Test Loss: 1.477 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.919389009475708
Epoch: 9, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.532 Vali Acc: 0.224 Test Loss: 1.532 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9637341499328613
Epoch: 10, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.535 Vali Acc: 0.236 Test Loss: 1.535 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0456178188323975
Epoch: 11, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.550 Vali Acc: 0.266 Test Loss: 1.550 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266144).  Saving model ...
Epoch: 12 cost time: 1.0257306098937988
Epoch: 12, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.840 Vali Acc: 0.274 Test Loss: 1.840 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273746).  Saving model ...
Epoch: 13 cost time: 1.02308988571167
Epoch: 13, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.692 Vali Acc: 0.281 Test Loss: 1.692 Test Acc: 0.281
Validation loss decreased (-0.273746 --> -0.281352).  Saving model ...
Epoch: 14 cost time: 0.9919373989105225
Epoch: 14, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.691 Vali Acc: 0.236 Test Loss: 1.691 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9736239910125732
Epoch: 15, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.748 Vali Acc: 0.247 Test Loss: 1.748 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8572235107421875
Epoch: 16, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.862 Vali Acc: 0.236 Test Loss: 1.862 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9964699745178223
Epoch: 17, Steps: 17 | Train Loss: 0.784 Vali Loss: 1.858 Vali Acc: 0.251 Test Loss: 1.858 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0086753368377686
Epoch: 18, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.066 Vali Acc: 0.240 Test Loss: 2.066 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0120186805725098
Epoch: 19, Steps: 17 | Train Loss: 0.727 Vali Loss: 1.999 Vali Acc: 0.247 Test Loss: 1.999 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9550151824951172
Epoch: 20, Steps: 17 | Train Loss: 0.771 Vali Loss: 2.150 Vali Acc: 0.240 Test Loss: 2.150 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9617512226104736
Epoch: 21, Steps: 17 | Train Loss: 0.675 Vali Loss: 2.140 Vali Acc: 0.270 Test Loss: 2.140 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0140366554260254
Epoch: 22, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.238 Vali Acc: 0.278 Test Loss: 2.238 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9834918975830078
Epoch: 23, Steps: 17 | Train Loss: 0.701 Vali Loss: 2.195 Vali Acc: 0.255 Test Loss: 2.195 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1156612
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3647305965423584
Epoch: 1, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.387 Vali Acc: 0.251 Test Loss: 1.387 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.1779189109802246
Epoch: 2, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.400 Vali Acc: 0.228 Test Loss: 1.400 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1114964485168457
Epoch: 3, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.397 Vali Acc: 0.278 Test Loss: 1.397 Test Acc: 0.278
Validation loss decreased (-0.250937 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 1.0599586963653564
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.422 Vali Acc: 0.247 Test Loss: 1.422 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.937847375869751
Epoch: 5, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.420 Vali Acc: 0.266 Test Loss: 1.420 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9353024959564209
Epoch: 6, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.426 Vali Acc: 0.240 Test Loss: 1.426 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9651501178741455
Epoch: 7, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.445 Vali Acc: 0.251 Test Loss: 1.445 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0975456237792969
Epoch: 8, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.486 Vali Acc: 0.236 Test Loss: 1.486 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.058293104171753
Epoch: 9, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.536 Vali Acc: 0.285 Test Loss: 1.536 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 0.9937739372253418
Epoch: 10, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.517 Vali Acc: 0.293 Test Loss: 1.517 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292760).  Saving model ...
Epoch: 11 cost time: 0.9669878482818604
Epoch: 11, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.548 Vali Acc: 0.297 Test Loss: 1.548 Test Acc: 0.297
Validation loss decreased (-0.292760 --> -0.296562).  Saving model ...
Epoch: 12 cost time: 0.9890921115875244
Epoch: 12, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.572 Vali Acc: 0.274 Test Loss: 1.572 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.014376163482666
Epoch: 13, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.610 Vali Acc: 0.270 Test Loss: 1.610 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9756147861480713
Epoch: 14, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.604 Vali Acc: 0.259 Test Loss: 1.604 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0742299556732178
Epoch: 15, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.661 Vali Acc: 0.262 Test Loss: 1.661 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9209816455841064
Epoch: 16, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.751 Vali Acc: 0.251 Test Loss: 1.751 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0692336559295654
Epoch: 17, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.993 Vali Acc: 0.262 Test Loss: 1.993 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0286755561828613
Epoch: 18, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.938 Vali Acc: 0.224 Test Loss: 1.938 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0312352180480957
Epoch: 19, Steps: 17 | Train Loss: 0.821 Vali Loss: 1.793 Vali Acc: 0.247 Test Loss: 1.793 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1529016494750977
Epoch: 20, Steps: 17 | Train Loss: 0.784 Vali Loss: 1.875 Vali Acc: 0.285 Test Loss: 1.875 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9582569599151611
Epoch: 21, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.181 Vali Acc: 0.270 Test Loss: 2.181 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1164676
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.226980209350586
Epoch: 1, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.399 Vali Acc: 0.251 Test Loss: 1.399 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.9016292095184326
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.409 Vali Acc: 0.293 Test Loss: 1.409 Test Acc: 0.293
Validation loss decreased (-0.250937 --> -0.292762).  Saving model ...
Epoch: 3 cost time: 0.8488421440124512
Epoch: 3, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.481 Vali Acc: 0.236 Test Loss: 1.481 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8194749355316162
Epoch: 4, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.447 Vali Acc: 0.274 Test Loss: 1.447 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8683688640594482
Epoch: 5, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.439 Vali Acc: 0.259 Test Loss: 1.439 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8843526840209961
Epoch: 6, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.489 Vali Acc: 0.259 Test Loss: 1.489 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8829185962677002
Epoch: 7, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.521 Vali Acc: 0.259 Test Loss: 1.521 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.917644739151001
Epoch: 8, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.690 Vali Acc: 0.266 Test Loss: 1.690 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8971021175384521
Epoch: 9, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.630 Vali Acc: 0.270 Test Loss: 1.630 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8270893096923828
Epoch: 10, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.696 Vali Acc: 0.259 Test Loss: 1.696 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8298482894897461
Epoch: 11, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.843 Vali Acc: 0.266 Test Loss: 1.843 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8409855365753174
Epoch: 12, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.974 Vali Acc: 0.266 Test Loss: 1.974 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 350276
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.204724073410034
Epoch: 1, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.413 Vali Acc: 0.240 Test Loss: 1.413 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 0.8737249374389648
Epoch: 2, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
Validation loss decreased (-0.239530 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 0.8549809455871582
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.418 Vali Acc: 0.243 Test Loss: 1.418 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8900895118713379
Epoch: 4, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.398 Vali Acc: 0.240 Test Loss: 1.398 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8787510395050049
Epoch: 5, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.452 Vali Acc: 0.255 Test Loss: 1.452 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9036190509796143
Epoch: 6, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.433 Vali Acc: 0.213 Test Loss: 1.433 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8072414398193359
Epoch: 7, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.515 Vali Acc: 0.262 Test Loss: 1.515 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8644144535064697
Epoch: 8, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.485 Vali Acc: 0.213 Test Loss: 1.485 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8441565036773682
Epoch: 9, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8357343673706055
Epoch: 10, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8328440189361572
Epoch: 11, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277551).  Saving model ...
Epoch: 12 cost time: 0.872596025466919
Epoch: 12, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.601 Vali Acc: 0.224 Test Loss: 1.601 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9138827323913574
Epoch: 13, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.732 Vali Acc: 0.255 Test Loss: 1.732 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9164993762969971
Epoch: 14, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.674 Vali Acc: 0.243 Test Loss: 1.674 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9570019245147705
Epoch: 15, Steps: 17 | Train Loss: 0.810 Vali Loss: 1.838 Vali Acc: 0.243 Test Loss: 1.838 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.853121280670166
Epoch: 16, Steps: 17 | Train Loss: 0.777 Vali Loss: 2.028 Vali Acc: 0.259 Test Loss: 2.028 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.921560525894165
Epoch: 17, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.995 Vali Acc: 0.259 Test Loss: 1.995 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7892298698425293
Epoch: 18, Steps: 17 | Train Loss: 0.711 Vali Loss: 2.048 Vali Acc: 0.278 Test Loss: 2.048 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8597567081451416
Epoch: 19, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.991 Vali Acc: 0.247 Test Loss: 1.991 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8595433235168457
Epoch: 20, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.189 Vali Acc: 0.221 Test Loss: 2.189 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.82655930519104
Epoch: 21, Steps: 17 | Train Loss: 0.621 Vali Loss: 2.268 Vali Acc: 0.247 Test Loss: 2.268 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 322372
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.276237964630127
Epoch: 1, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.387 Vali Acc: 0.259 Test Loss: 1.387 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.8622729778289795
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.386 Vali Acc: 0.240 Test Loss: 1.386 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8409686088562012
Epoch: 3, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.383 Vali Acc: 0.259 Test Loss: 1.383 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 0.8561913967132568
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.390 Vali Acc: 0.259 Test Loss: 1.390 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8756136894226074
Epoch: 5, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.395 Vali Acc: 0.247 Test Loss: 1.395 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.897411584854126
Epoch: 6, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8947610855102539
Epoch: 7, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 8 cost time: 0.7890055179595947
Epoch: 8, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.473 Vali Acc: 0.259 Test Loss: 1.473 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8391029834747314
Epoch: 9, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.785569429397583
Epoch: 10, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8279221057891846
Epoch: 11, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.504 Vali Acc: 0.240 Test Loss: 1.504 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8543639183044434
Epoch: 12, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.493 Vali Acc: 0.240 Test Loss: 1.493 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.888559103012085
Epoch: 13, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.541 Vali Acc: 0.266 Test Loss: 1.541 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8449819087982178
Epoch: 14, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.557 Vali Acc: 0.209 Test Loss: 1.557 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8499014377593994
Epoch: 15, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.630 Vali Acc: 0.247 Test Loss: 1.630 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.85367751121521
Epoch: 16, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.714 Vali Acc: 0.270 Test Loss: 1.714 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269945).  Saving model ...
Epoch: 17 cost time: 0.8799376487731934
Epoch: 17, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.721 Vali Acc: 0.281 Test Loss: 1.721 Test Acc: 0.281
Validation loss decreased (-0.269945 --> -0.281352).  Saving model ...
Epoch: 18 cost time: 0.8441696166992188
Epoch: 18, Steps: 17 | Train Loss: 0.784 Vali Loss: 1.820 Vali Acc: 0.224 Test Loss: 1.820 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9361701011657715
Epoch: 19, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.815 Vali Acc: 0.266 Test Loss: 1.815 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8806865215301514
Epoch: 20, Steps: 17 | Train Loss: 0.716 Vali Loss: 1.875 Vali Acc: 0.217 Test Loss: 1.875 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8058762550354004
Epoch: 21, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.002 Vali Acc: 0.243 Test Loss: 2.002 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8506097793579102
Epoch: 22, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.088 Vali Acc: 0.243 Test Loss: 2.088 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8516635894775391
Epoch: 23, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.148 Vali Acc: 0.259 Test Loss: 2.148 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8748581409454346
Epoch: 24, Steps: 17 | Train Loss: 0.659 Vali Loss: 2.247 Vali Acc: 0.255 Test Loss: 2.247 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8777036666870117
Epoch: 25, Steps: 17 | Train Loss: 0.631 Vali Loss: 2.229 Vali Acc: 0.240 Test Loss: 2.229 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8726575374603271
Epoch: 26, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.540 Vali Acc: 0.247 Test Loss: 2.540 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8838229179382324
Epoch: 27, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.473 Vali Acc: 0.221 Test Loss: 2.473 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 314436
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.187223434448242
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.8470115661621094
Epoch: 2, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8005361557006836
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.414 Vali Acc: 0.251 Test Loss: 1.414 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8337662220001221
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.388 Vali Acc: 0.251 Test Loss: 1.388 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8212215900421143
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.421 Vali Acc: 0.270 Test Loss: 1.421 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269948).  Saving model ...
Epoch: 6 cost time: 0.7606782913208008
Epoch: 6, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.407 Vali Acc: 0.240 Test Loss: 1.407 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8653814792633057
Epoch: 7, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.414 Vali Acc: 0.255 Test Loss: 1.414 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8855500221252441
Epoch: 8, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.445 Vali Acc: 0.236 Test Loss: 1.445 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7858734130859375
Epoch: 9, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.426 Vali Acc: 0.259 Test Loss: 1.426 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8343329429626465
Epoch: 10, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.454 Vali Acc: 0.240 Test Loss: 1.454 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7909305095672607
Epoch: 11, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8498530387878418
Epoch: 12, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.531 Vali Acc: 0.259 Test Loss: 1.531 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8037116527557373
Epoch: 13, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.508 Vali Acc: 0.278 Test Loss: 1.508 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277551).  Saving model ...
Epoch: 14 cost time: 0.8733484745025635
Epoch: 14, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.543 Vali Acc: 0.247 Test Loss: 1.543 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7768375873565674
Epoch: 15, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.584 Vali Acc: 0.259 Test Loss: 1.584 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8556921482086182
Epoch: 16, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.667 Vali Acc: 0.255 Test Loss: 1.667 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8188107013702393
Epoch: 17, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.730 Vali Acc: 0.270 Test Loss: 1.730 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8244078159332275
Epoch: 18, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8295340538024902
Epoch: 19, Steps: 17 | Train Loss: 0.787 Vali Loss: 1.789 Vali Acc: 0.259 Test Loss: 1.789 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7997910976409912
Epoch: 20, Steps: 17 | Train Loss: 0.756 Vali Loss: 1.871 Vali Acc: 0.236 Test Loss: 1.871 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8262984752655029
Epoch: 21, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.872 Vali Acc: 0.232 Test Loss: 1.872 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.884941577911377
Epoch: 22, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.113 Vali Acc: 0.236 Test Loss: 2.113 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8307955265045166
Epoch: 23, Steps: 17 | Train Loss: 0.730 Vali Loss: 2.089 Vali Acc: 0.270 Test Loss: 2.089 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 312644
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0432755947113037
Epoch: 1, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.835561990737915
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 0.8114490509033203
Epoch: 3, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 0.8131723403930664
Epoch: 4, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.393 Vali Acc: 0.232 Test Loss: 1.393 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7625350952148438
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.389 Vali Acc: 0.262 Test Loss: 1.389 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262344).  Saving model ...
Epoch: 6 cost time: 0.8013641834259033
Epoch: 6, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.406 Vali Acc: 0.281 Test Loss: 1.406 Test Acc: 0.281
Validation loss decreased (-0.262344 --> -0.281355).  Saving model ...
Epoch: 7 cost time: 0.8809752464294434
Epoch: 7, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8134729862213135
Epoch: 8, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.410 Vali Acc: 0.240 Test Loss: 1.410 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7827033996582031
Epoch: 9, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.411 Vali Acc: 0.266 Test Loss: 1.411 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7829539775848389
Epoch: 10, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.444 Vali Acc: 0.270 Test Loss: 1.444 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8245861530303955
Epoch: 11, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.463 Vali Acc: 0.243 Test Loss: 1.463 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8554501533508301
Epoch: 12, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.465 Vali Acc: 0.221 Test Loss: 1.465 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8050060272216797
Epoch: 13, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.459 Vali Acc: 0.266 Test Loss: 1.459 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8075113296508789
Epoch: 14, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.481 Vali Acc: 0.262 Test Loss: 1.481 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9502856731414795
Epoch: 15, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.516 Vali Acc: 0.232 Test Loss: 1.516 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8318026065826416
Epoch: 16, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.584 Vali Acc: 0.255 Test Loss: 1.584 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 313604
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0870869159698486
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.399 Vali Acc: 0.221 Test Loss: 1.399 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 0.8373115062713623
Epoch: 2, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.397 Vali Acc: 0.240 Test Loss: 1.397 Test Acc: 0.240
Validation loss decreased (-0.220518 --> -0.239530).  Saving model ...
Epoch: 3 cost time: 0.823646068572998
Epoch: 3, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
Validation loss decreased (-0.239530 --> -0.243332).  Saving model ...
Epoch: 4 cost time: 0.8430037498474121
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.411 Vali Acc: 0.205 Test Loss: 1.411 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.788506269454956
Epoch: 5, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8249130249023438
Epoch: 6, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.414 Vali Acc: 0.240 Test Loss: 1.414 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8034052848815918
Epoch: 7, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.427 Vali Acc: 0.228 Test Loss: 1.427 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7756319046020508
Epoch: 8, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.435 Vali Acc: 0.221 Test Loss: 1.435 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8661694526672363
Epoch: 9, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.473 Vali Acc: 0.228 Test Loss: 1.473 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7855074405670166
Epoch: 10, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.530 Vali Acc: 0.228 Test Loss: 1.530 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7840306758880615
Epoch: 11, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.436 Vali Acc: 0.228 Test Loss: 1.436 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7949998378753662
Epoch: 12, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.499 Vali Acc: 0.232 Test Loss: 1.499 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8325066566467285
Epoch: 13, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.528 Vali Acc: 0.251 Test Loss: 1.528 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250935).  Saving model ...
Epoch: 14 cost time: 0.8392982482910156
Epoch: 14, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.536 Vali Acc: 0.251 Test Loss: 1.536 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8259403705596924
Epoch: 15, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.590 Vali Acc: 0.255 Test Loss: 1.590 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254737).  Saving model ...
Epoch: 16 cost time: 0.8210492134094238
Epoch: 16, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.633 Vali Acc: 0.236 Test Loss: 1.633 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7998692989349365
Epoch: 17, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.680 Vali Acc: 0.205 Test Loss: 1.680 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7832543849945068
Epoch: 18, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.565 Vali Acc: 0.243 Test Loss: 1.565 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8218824863433838
Epoch: 19, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.633 Vali Acc: 0.247 Test Loss: 1.633 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8123586177825928
Epoch: 20, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.715 Vali Acc: 0.251 Test Loss: 1.715 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8314261436462402
Epoch: 21, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.851 Vali Acc: 0.240 Test Loss: 1.851 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8043015003204346
Epoch: 22, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.844 Vali Acc: 0.262 Test Loss: 1.844 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262339).  Saving model ...
Epoch: 23 cost time: 0.8761165142059326
Epoch: 23, Steps: 17 | Train Loss: 0.856 Vali Loss: 1.794 Vali Acc: 0.243 Test Loss: 1.794 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8269920349121094
Epoch: 24, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.924 Vali Acc: 0.243 Test Loss: 1.924 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8404781818389893
Epoch: 25, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.836 Vali Acc: 0.243 Test Loss: 1.836 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8364729881286621
Epoch: 26, Steps: 17 | Train Loss: 0.739 Vali Loss: 1.997 Vali Acc: 0.243 Test Loss: 1.997 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8402371406555176
Epoch: 27, Steps: 17 | Train Loss: 0.734 Vali Loss: 2.109 Vali Acc: 0.259 Test Loss: 2.109 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8445250988006592
Epoch: 28, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.088 Vali Acc: 0.247 Test Loss: 2.088 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8709495067596436
Epoch: 29, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.309 Vali Acc: 0.221 Test Loss: 2.309 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9049103260040283
Epoch: 30, Steps: 17 | Train Loss: 0.795 Vali Loss: 2.196 Vali Acc: 0.243 Test Loss: 2.196 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8120822906494141
Epoch: 31, Steps: 17 | Train Loss: 0.703 Vali Loss: 2.239 Vali Acc: 0.259 Test Loss: 2.239 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8356208801269531
Epoch: 32, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.247 Vali Acc: 0.274 Test Loss: 2.247 Test Acc: 0.274
Validation loss decreased (-0.262339 --> -0.273742).  Saving model ...
Epoch: 33 cost time: 0.8284711837768555
Epoch: 33, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.356 Vali Acc: 0.243 Test Loss: 2.356 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8397300243377686
Epoch: 34, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.574 Vali Acc: 0.251 Test Loss: 2.574 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9086120128631592
Epoch: 35, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.436 Vali Acc: 0.232 Test Loss: 2.436 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.871373176574707
Epoch: 36, Steps: 17 | Train Loss: 0.619 Vali Loss: 2.433 Vali Acc: 0.247 Test Loss: 2.433 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.835191011428833
Epoch: 37, Steps: 17 | Train Loss: 0.588 Vali Loss: 2.687 Vali Acc: 0.259 Test Loss: 2.687 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0176007747650146
Epoch: 38, Steps: 17 | Train Loss: 0.601 Vali Loss: 3.006 Vali Acc: 0.251 Test Loss: 3.006 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8823871612548828
Epoch: 39, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.857 Vali Acc: 0.262 Test Loss: 2.857 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8644628524780273
Epoch: 40, Steps: 17 | Train Loss: 0.634 Vali Loss: 2.874 Vali Acc: 0.255 Test Loss: 2.874 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8450956344604492
Epoch: 41, Steps: 17 | Train Loss: 0.595 Vali Loss: 2.948 Vali Acc: 0.270 Test Loss: 2.948 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8663010597229004
Epoch: 42, Steps: 17 | Train Loss: 0.650 Vali Loss: 3.135 Vali Acc: 0.236 Test Loss: 3.135 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 316164
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0649280548095703
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.394 Vali Acc: 0.236 Test Loss: 1.394 Test Acc: 0.236
Validation loss decreased (inf --> -0.235728).  Saving model ...
Epoch: 2 cost time: 0.9485559463500977
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
Validation loss decreased (-0.235728 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 0.8549630641937256
Epoch: 3, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.399 Vali Acc: 0.259 Test Loss: 1.399 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 0.7763566970825195
Epoch: 4, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7757086753845215
Epoch: 5, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.384 Vali Acc: 0.266 Test Loss: 1.384 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 6 cost time: 0.6579020023345947
Epoch: 6, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.395 Vali Acc: 0.240 Test Loss: 1.395 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7661442756652832
Epoch: 7, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.398 Vali Acc: 0.259 Test Loss: 1.398 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6801786422729492
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.451 Vali Acc: 0.236 Test Loss: 1.451 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8389995098114014
Epoch: 9, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.440 Vali Acc: 0.247 Test Loss: 1.440 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7734866142272949
Epoch: 10, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.441 Vali Acc: 0.266 Test Loss: 1.441 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8378567695617676
Epoch: 11, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.465 Vali Acc: 0.270 Test Loss: 1.465 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269947).  Saving model ...
Epoch: 12 cost time: 0.7767789363861084
Epoch: 12, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.482 Vali Acc: 0.293 Test Loss: 1.482 Test Acc: 0.293
Validation loss decreased (-0.269947 --> -0.292761).  Saving model ...
Epoch: 13 cost time: 0.834221363067627
Epoch: 13, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8645257949829102
Epoch: 14, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.554 Vali Acc: 0.262 Test Loss: 1.554 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7592644691467285
Epoch: 15, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.553 Vali Acc: 0.259 Test Loss: 1.553 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8405885696411133
Epoch: 16, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.566 Vali Acc: 0.274 Test Loss: 1.566 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8571314811706543
Epoch: 17, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.747 Vali Acc: 0.243 Test Loss: 1.747 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7921724319458008
Epoch: 18, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.650 Vali Acc: 0.259 Test Loss: 1.650 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7919940948486328
Epoch: 19, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.722 Vali Acc: 0.293 Test Loss: 1.722 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8546886444091797
Epoch: 20, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.747 Vali Acc: 0.240 Test Loss: 1.747 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8384885787963867
Epoch: 21, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.859 Vali Acc: 0.285 Test Loss: 1.859 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8240184783935547
Epoch: 22, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.715 Vali Acc: 0.251 Test Loss: 1.715 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 320196
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.8570022583007812
Epoch: 1, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.386 Vali Acc: 0.251 Test Loss: 1.386 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.7563998699188232
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.391 Vali Acc: 0.255 Test Loss: 1.391 Test Acc: 0.255
Validation loss decreased (-0.250937 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 0.7794210910797119
Epoch: 3, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.402 Vali Acc: 0.251 Test Loss: 1.402 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7929120063781738
Epoch: 4, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.397 Vali Acc: 0.251 Test Loss: 1.397 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7886936664581299
Epoch: 5, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.416 Vali Acc: 0.281 Test Loss: 1.416 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281355).  Saving model ...
Epoch: 6 cost time: 0.7722659111022949
Epoch: 6, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8322436809539795
Epoch: 7, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.428 Vali Acc: 0.274 Test Loss: 1.428 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7683136463165283
Epoch: 8, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7760448455810547
Epoch: 9, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.494 Vali Acc: 0.278 Test Loss: 1.494 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7914109230041504
Epoch: 10, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.528 Vali Acc: 0.270 Test Loss: 1.528 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7955632209777832
Epoch: 11, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.541 Vali Acc: 0.255 Test Loss: 1.541 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8242557048797607
Epoch: 12, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.535 Vali Acc: 0.304 Test Loss: 1.535 Test Acc: 0.304
Validation loss decreased (-0.281355 --> -0.304167).  Saving model ...
Epoch: 13 cost time: 0.841710090637207
Epoch: 13, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.636 Vali Acc: 0.308 Test Loss: 1.636 Test Acc: 0.308
Validation loss decreased (-0.304167 --> -0.307968).  Saving model ...
Epoch: 14 cost time: 0.8196907043457031
Epoch: 14, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.663 Vali Acc: 0.274 Test Loss: 1.663 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8481040000915527
Epoch: 15, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.739 Vali Acc: 0.297 Test Loss: 1.739 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8305199146270752
Epoch: 16, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.810 Vali Acc: 0.274 Test Loss: 1.810 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7792675495147705
Epoch: 17, Steps: 17 | Train Loss: 0.697 Vali Loss: 1.967 Vali Acc: 0.281 Test Loss: 1.967 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7612485885620117
Epoch: 18, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.120 Vali Acc: 0.274 Test Loss: 2.120 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8113365173339844
Epoch: 19, Steps: 17 | Train Loss: 0.685 Vali Loss: 2.021 Vali Acc: 0.266 Test Loss: 2.021 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7715964317321777
Epoch: 20, Steps: 17 | Train Loss: 0.649 Vali Loss: 2.177 Vali Acc: 0.270 Test Loss: 2.177 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8156845569610596
Epoch: 21, Steps: 17 | Train Loss: 0.617 Vali Loss: 2.307 Vali Acc: 0.247 Test Loss: 2.307 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.837937593460083
Epoch: 22, Steps: 17 | Train Loss: 0.582 Vali Loss: 2.391 Vali Acc: 0.278 Test Loss: 2.391 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8346412181854248
Epoch: 23, Steps: 17 | Train Loss: 0.585 Vali Loss: 2.351 Vali Acc: 0.262 Test Loss: 2.351 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 109604
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1080498695373535
Epoch: 1, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.8404936790466309
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.391 Vali Acc: 0.281 Test Loss: 1.391 Test Acc: 0.281
Validation loss decreased (-0.243332 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.7904691696166992
Epoch: 3, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7356913089752197
Epoch: 4, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7100019454956055
Epoch: 5, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.402 Vali Acc: 0.247 Test Loss: 1.402 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7858293056488037
Epoch: 6, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.396 Vali Acc: 0.251 Test Loss: 1.396 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7675163745880127
Epoch: 7, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8738706111907959
Epoch: 8, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.417 Vali Acc: 0.251 Test Loss: 1.417 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9220902919769287
Epoch: 9, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.439 Vali Acc: 0.278 Test Loss: 1.439 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7717902660369873
Epoch: 10, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8235056400299072
Epoch: 11, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.461 Vali Acc: 0.262 Test Loss: 1.461 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7435359954833984
Epoch: 12, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.508 Vali Acc: 0.281 Test Loss: 1.508 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 95652
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1223981380462646
Epoch: 1, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.7706785202026367
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
Validation loss decreased (-0.243332 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 0.7885849475860596
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.406 Vali Acc: 0.281 Test Loss: 1.406 Test Acc: 0.281
Validation loss decreased (-0.243332 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 0.7718758583068848
Epoch: 4, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.415 Vali Acc: 0.232 Test Loss: 1.415 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8071517944335938
Epoch: 5, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.405 Vali Acc: 0.228 Test Loss: 1.405 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8108773231506348
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.403 Vali Acc: 0.247 Test Loss: 1.403 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8178164958953857
Epoch: 7, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.416 Vali Acc: 0.240 Test Loss: 1.416 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8540191650390625
Epoch: 8, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.430 Vali Acc: 0.247 Test Loss: 1.430 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8121576309204102
Epoch: 9, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8040785789489746
Epoch: 10, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8026459217071533
Epoch: 11, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.458 Vali Acc: 0.224 Test Loss: 1.458 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8659267425537109
Epoch: 12, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.486 Vali Acc: 0.255 Test Loss: 1.486 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7582409381866455
Epoch: 13, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.484 Vali Acc: 0.236 Test Loss: 1.484 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 91684
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9025559425354004
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.383 Vali Acc: 0.251 Test Loss: 1.383 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.7692508697509766
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.378 Vali Acc: 0.293 Test Loss: 1.378 Test Acc: 0.293
Validation loss decreased (-0.250937 --> -0.292762).  Saving model ...
Epoch: 3 cost time: 0.7377536296844482
Epoch: 3, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.377 Vali Acc: 0.270 Test Loss: 1.377 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7396771907806396
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.367 Vali Acc: 0.266 Test Loss: 1.367 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.740757942199707
Epoch: 5, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.376 Vali Acc: 0.259 Test Loss: 1.376 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.78110671043396
Epoch: 6, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.379 Vali Acc: 0.270 Test Loss: 1.379 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7303040027618408
Epoch: 7, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.372 Vali Acc: 0.266 Test Loss: 1.372 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7642335891723633
Epoch: 8, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.386 Vali Acc: 0.247 Test Loss: 1.386 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7892663478851318
Epoch: 9, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.383 Vali Acc: 0.236 Test Loss: 1.383 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7774052619934082
Epoch: 10, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.384 Vali Acc: 0.285 Test Loss: 1.384 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7992830276489258
Epoch: 11, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.385 Vali Acc: 0.243 Test Loss: 1.385 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7450196743011475
Epoch: 12, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.395 Vali Acc: 0.251 Test Loss: 1.395 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 90788
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.915313482284546
Epoch: 1, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.407 Vali Acc: 0.255 Test Loss: 1.407 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.7753462791442871
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.391 Vali Acc: 0.281 Test Loss: 1.391 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.764540433883667
Epoch: 3, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7319839000701904
Epoch: 4, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.398 Vali Acc: 0.232 Test Loss: 1.398 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7390410900115967
Epoch: 5, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.397 Vali Acc: 0.236 Test Loss: 1.397 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8399105072021484
Epoch: 6, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7872276306152344
Epoch: 7, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.393 Vali Acc: 0.270 Test Loss: 1.393 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7783174514770508
Epoch: 8, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.393 Vali Acc: 0.236 Test Loss: 1.393 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7496931552886963
Epoch: 9, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.408 Vali Acc: 0.285 Test Loss: 1.408 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285157).  Saving model ...
Epoch: 10 cost time: 0.7283225059509277
Epoch: 10, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.413 Vali Acc: 0.240 Test Loss: 1.413 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.784527063369751
Epoch: 11, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.425 Vali Acc: 0.281 Test Loss: 1.425 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7241711616516113
Epoch: 12, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.417 Vali Acc: 0.251 Test Loss: 1.417 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.735029935836792
Epoch: 13, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.428 Vali Acc: 0.247 Test Loss: 1.428 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7995169162750244
Epoch: 14, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.444 Vali Acc: 0.240 Test Loss: 1.444 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7785274982452393
Epoch: 15, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7138063907623291
Epoch: 16, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.477 Vali Acc: 0.221 Test Loss: 1.477 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7303564548492432
Epoch: 17, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.483 Vali Acc: 0.251 Test Loss: 1.483 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7750279903411865
Epoch: 18, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.505 Vali Acc: 0.266 Test Loss: 1.505 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7229804992675781
Epoch: 19, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.511 Vali Acc: 0.262 Test Loss: 1.511 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 91268
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3707919120788574
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.399 Vali Acc: 0.240 Test Loss: 1.399 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 0.8334147930145264
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.389 Vali Acc: 0.300 Test Loss: 1.389 Test Acc: 0.300
Validation loss decreased (-0.239530 --> -0.300366).  Saving model ...
Epoch: 3 cost time: 0.8170440196990967
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.392 Vali Acc: 0.285 Test Loss: 1.392 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8494164943695068
Epoch: 4, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.395 Vali Acc: 0.236 Test Loss: 1.395 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8347771167755127
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9133882522583008
Epoch: 6, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.402 Vali Acc: 0.232 Test Loss: 1.402 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7762172222137451
Epoch: 7, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7904953956604004
Epoch: 8, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.399 Vali Acc: 0.251 Test Loss: 1.399 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.801098108291626
Epoch: 9, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.833953857421875
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.407 Vali Acc: 0.251 Test Loss: 1.407 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8657526969909668
Epoch: 11, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7829587459564209
Epoch: 12, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 92548
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.288466691970825
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.409 Vali Acc: 0.228 Test Loss: 1.409 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 0.7561838626861572
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.400 Vali Acc: 0.262 Test Loss: 1.400 Test Acc: 0.262
Validation loss decreased (-0.228123 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 0.7986855506896973
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8162078857421875
Epoch: 4, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.388 Vali Acc: 0.209 Test Loss: 1.388 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8092329502105713
Epoch: 5, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.380 Vali Acc: 0.255 Test Loss: 1.380 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7872817516326904
Epoch: 6, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.388 Vali Acc: 0.255 Test Loss: 1.388 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7184956073760986
Epoch: 7, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.381 Vali Acc: 0.247 Test Loss: 1.381 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7632179260253906
Epoch: 8, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.388 Vali Acc: 0.232 Test Loss: 1.388 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7793469429016113
Epoch: 9, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.392 Vali Acc: 0.266 Test Loss: 1.392 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 10 cost time: 0.7583413124084473
Epoch: 10, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.392 Vali Acc: 0.247 Test Loss: 1.392 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8060159683227539
Epoch: 11, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.415 Vali Acc: 0.259 Test Loss: 1.415 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7965447902679443
Epoch: 12, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.423 Vali Acc: 0.221 Test Loss: 1.423 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7438271045684814
Epoch: 13, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.433 Vali Acc: 0.247 Test Loss: 1.433 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8345685005187988
Epoch: 14, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.427 Vali Acc: 0.240 Test Loss: 1.427 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7635989189147949
Epoch: 15, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.466 Vali Acc: 0.247 Test Loss: 1.466 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7455449104309082
Epoch: 16, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.433 Vali Acc: 0.251 Test Loss: 1.433 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7097606658935547
Epoch: 17, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.468 Vali Acc: 0.255 Test Loss: 1.468 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7434406280517578
Epoch: 18, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.511 Vali Acc: 0.255 Test Loss: 1.511 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7389543056488037
Epoch: 19, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.487 Vali Acc: 0.255 Test Loss: 1.487 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 94564
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3764021396636963
Epoch: 1, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.397 Vali Acc: 0.259 Test Loss: 1.397 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.0806481838226318
Epoch: 2, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.437 Vali Acc: 0.247 Test Loss: 1.437 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0909523963928223
Epoch: 3, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.486 Vali Acc: 0.262 Test Loss: 1.486 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.2506654262542725
Epoch: 4, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.463 Vali Acc: 0.289 Test Loss: 1.463 Test Acc: 0.289
Validation loss decreased (-0.262343 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 1.2051291465759277
Epoch: 5, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.512 Vali Acc: 0.278 Test Loss: 1.512 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.324800729751587
Epoch: 6, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.573 Vali Acc: 0.297 Test Loss: 1.573 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296562).  Saving model ...
Epoch: 7 cost time: 1.1015479564666748
Epoch: 7, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.821 Vali Acc: 0.266 Test Loss: 1.821 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1283888816833496
Epoch: 8, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.873 Vali Acc: 0.236 Test Loss: 1.873 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9864892959594727
Epoch: 9, Steps: 17 | Train Loss: 0.780 Vali Loss: 2.003 Vali Acc: 0.285 Test Loss: 2.003 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0905442237854004
Epoch: 10, Steps: 17 | Train Loss: 0.738 Vali Loss: 2.354 Vali Acc: 0.221 Test Loss: 2.354 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0963354110717773
Epoch: 11, Steps: 17 | Train Loss: 0.703 Vali Loss: 2.398 Vali Acc: 0.255 Test Loss: 2.398 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2059438228607178
Epoch: 12, Steps: 17 | Train Loss: 0.601 Vali Loss: 2.676 Vali Acc: 0.274 Test Loss: 2.676 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2252397537231445
Epoch: 13, Steps: 17 | Train Loss: 0.617 Vali Loss: 2.922 Vali Acc: 0.255 Test Loss: 2.922 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.160492181777954
Epoch: 14, Steps: 17 | Train Loss: 0.578 Vali Loss: 3.300 Vali Acc: 0.259 Test Loss: 3.300 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1647567749023438
Epoch: 15, Steps: 17 | Train Loss: 0.535 Vali Loss: 3.170 Vali Acc: 0.270 Test Loss: 3.170 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2236130237579346
Epoch: 16, Steps: 17 | Train Loss: 0.505 Vali Loss: 3.420 Vali Acc: 0.259 Test Loss: 3.420 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1220228
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.600719451904297
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.443 Vali Acc: 0.266 Test Loss: 1.443 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 1.2619154453277588
Epoch: 2, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.377 Vali Acc: 0.304 Test Loss: 1.377 Test Acc: 0.304
Validation loss decreased (-0.266145 --> -0.304169).  Saving model ...
Epoch: 3 cost time: 1.1446757316589355
Epoch: 3, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.418 Vali Acc: 0.297 Test Loss: 1.418 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1859755516052246
Epoch: 4, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1055443286895752
Epoch: 5, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.406 Vali Acc: 0.228 Test Loss: 1.406 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2052152156829834
Epoch: 6, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.459 Vali Acc: 0.262 Test Loss: 1.459 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1410315036773682
Epoch: 7, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.507 Vali Acc: 0.278 Test Loss: 1.507 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1107556819915771
Epoch: 8, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.549 Vali Acc: 0.285 Test Loss: 1.549 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1856520175933838
Epoch: 9, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1696069240570068
Epoch: 10, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.802 Vali Acc: 0.251 Test Loss: 1.802 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.19966459274292
Epoch: 11, Steps: 17 | Train Loss: 0.774 Vali Loss: 1.714 Vali Acc: 0.274 Test Loss: 1.714 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.229736328125
Epoch: 12, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.925 Vali Acc: 0.278 Test Loss: 1.925 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 1164420
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.407534599304199
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.0870428085327148
Epoch: 2, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.1034483909606934
Epoch: 3, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.417 Vali Acc: 0.266 Test Loss: 1.417 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 1.097834825515747
Epoch: 4, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.449 Vali Acc: 0.255 Test Loss: 1.449 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1537175178527832
Epoch: 5, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.439 Vali Acc: 0.228 Test Loss: 1.439 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1668815612792969
Epoch: 6, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.507 Vali Acc: 0.293 Test Loss: 1.507 Test Acc: 0.293
Validation loss decreased (-0.266146 --> -0.292761).  Saving model ...
Epoch: 7 cost time: 1.1387572288513184
Epoch: 7, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.553 Vali Acc: 0.243 Test Loss: 1.553 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1467053890228271
Epoch: 8, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.560 Vali Acc: 0.224 Test Loss: 1.560 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1014368534088135
Epoch: 9, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.620 Vali Acc: 0.255 Test Loss: 1.620 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.10695481300354
Epoch: 10, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.664 Vali Acc: 0.255 Test Loss: 1.664 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.207927942276001
Epoch: 11, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.845 Vali Acc: 0.251 Test Loss: 1.845 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0702598094940186
Epoch: 12, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.786 Vali Acc: 0.224 Test Loss: 1.786 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1211042404174805
Epoch: 13, Steps: 17 | Train Loss: 0.793 Vali Loss: 1.928 Vali Acc: 0.217 Test Loss: 1.928 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0555410385131836
Epoch: 14, Steps: 17 | Train Loss: 0.762 Vali Loss: 1.935 Vali Acc: 0.232 Test Loss: 1.935 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1256535053253174
Epoch: 15, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.004 Vali Acc: 0.228 Test Loss: 2.004 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.155376672744751
Epoch: 16, Steps: 17 | Train Loss: 0.678 Vali Loss: 2.027 Vali Acc: 0.259 Test Loss: 2.027 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1148548
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.317659854888916
Epoch: 1, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.395 Vali Acc: 0.289 Test Loss: 1.395 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 1.025604486465454
Epoch: 2, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.406 Vali Acc: 0.262 Test Loss: 1.406 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9628782272338867
Epoch: 3, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.435 Vali Acc: 0.247 Test Loss: 1.435 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9061484336853027
Epoch: 4, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0047476291656494
Epoch: 5, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.484 Vali Acc: 0.247 Test Loss: 1.484 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9353370666503906
Epoch: 6, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.434 Vali Acc: 0.205 Test Loss: 1.434 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0146758556365967
Epoch: 7, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.454 Vali Acc: 0.217 Test Loss: 1.454 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0515861511230469
Epoch: 8, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.560 Vali Acc: 0.236 Test Loss: 1.560 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9785974025726318
Epoch: 9, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.628 Vali Acc: 0.274 Test Loss: 1.628 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0626804828643799
Epoch: 10, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.612 Vali Acc: 0.240 Test Loss: 1.612 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9110202789306641
Epoch: 11, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.629 Vali Acc: 0.262 Test Loss: 1.629 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1144964
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2373287677764893
Epoch: 1, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.411 Vali Acc: 0.251 Test Loss: 1.411 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.0839784145355225
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9891304969787598
Epoch: 3, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.411 Vali Acc: 0.240 Test Loss: 1.411 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.88796067237854
Epoch: 4, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.408 Vali Acc: 0.247 Test Loss: 1.408 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.989457368850708
Epoch: 5, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.457 Vali Acc: 0.236 Test Loss: 1.457 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0208849906921387
Epoch: 6, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 1.005164384841919
Epoch: 7, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.481 Vali Acc: 0.262 Test Loss: 1.481 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0353789329528809
Epoch: 8, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.497 Vali Acc: 0.247 Test Loss: 1.497 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0128769874572754
Epoch: 9, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.534 Vali Acc: 0.255 Test Loss: 1.534 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9590790271759033
Epoch: 10, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.571 Vali Acc: 0.289 Test Loss: 1.571 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288958).  Saving model ...
Epoch: 11 cost time: 0.9483828544616699
Epoch: 11, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.633 Vali Acc: 0.232 Test Loss: 1.633 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8663341999053955
Epoch: 12, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.677 Vali Acc: 0.243 Test Loss: 1.677 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9896280765533447
Epoch: 13, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.684 Vali Acc: 0.236 Test Loss: 1.684 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0242960453033447
Epoch: 14, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.742 Vali Acc: 0.259 Test Loss: 1.742 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0034387111663818
Epoch: 15, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.746 Vali Acc: 0.243 Test Loss: 1.746 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.007002353668213
Epoch: 16, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.830 Vali Acc: 0.255 Test Loss: 1.830 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9838612079620361
Epoch: 17, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.940 Vali Acc: 0.259 Test Loss: 1.940 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.964324951171875
Epoch: 18, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.103 Vali Acc: 0.247 Test Loss: 2.103 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9612929821014404
Epoch: 19, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.159 Vali Acc: 0.255 Test Loss: 2.159 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9756624698638916
Epoch: 20, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.099 Vali Acc: 0.221 Test Loss: 2.099 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1146884
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.5200092792510986
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.378 Vali Acc: 0.274 Test Loss: 1.378 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.9671633243560791
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.371 Vali Acc: 0.243 Test Loss: 1.371 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.031602382659912
Epoch: 3, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.418 Vali Acc: 0.251 Test Loss: 1.418 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9570620059967041
Epoch: 4, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.387 Vali Acc: 0.255 Test Loss: 1.387 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9944972991943359
Epoch: 5, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.417 Vali Acc: 0.259 Test Loss: 1.417 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0490591526031494
Epoch: 6, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.411 Vali Acc: 0.232 Test Loss: 1.411 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0861711502075195
Epoch: 7, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.431 Vali Acc: 0.236 Test Loss: 1.431 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0519604682922363
Epoch: 8, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.440 Vali Acc: 0.236 Test Loss: 1.440 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.016517162322998
Epoch: 9, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.571 Vali Acc: 0.262 Test Loss: 1.571 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9926478862762451
Epoch: 10, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.531 Vali Acc: 0.224 Test Loss: 1.531 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9296343326568604
Epoch: 11, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.539 Vali Acc: 0.232 Test Loss: 1.539 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 1152004
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.360985517501831
Epoch: 1, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.398 Vali Acc: 0.255 Test Loss: 1.398 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.0007402896881104
Epoch: 2, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.392 Vali Acc: 0.259 Test Loss: 1.392 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.0663988590240479
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.409 Vali Acc: 0.262 Test Loss: 1.409 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.0631847381591797
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9918856620788574
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.407 Vali Acc: 0.262 Test Loss: 1.407 Test Acc: 0.262
Validation loss decreased (-0.262343 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 1.0272674560546875
Epoch: 6, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.459 Vali Acc: 0.247 Test Loss: 1.459 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1466710567474365
Epoch: 7, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.455 Vali Acc: 0.251 Test Loss: 1.455 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9579670429229736
Epoch: 8, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.474 Vali Acc: 0.281 Test Loss: 1.474 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281354).  Saving model ...
Epoch: 9 cost time: 1.0248706340789795
Epoch: 9, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.509 Vali Acc: 0.251 Test Loss: 1.509 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1231920719146729
Epoch: 10, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.569 Vali Acc: 0.274 Test Loss: 1.569 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0683157444000244
Epoch: 11, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.524 Vali Acc: 0.247 Test Loss: 1.524 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0431890487670898
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.635 Vali Acc: 0.262 Test Loss: 1.635 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0348246097564697
Epoch: 13, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.738 Vali Acc: 0.259 Test Loss: 1.738 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1088669300079346
Epoch: 14, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.689 Vali Acc: 0.247 Test Loss: 1.689 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1292812824249268
Epoch: 15, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.778 Vali Acc: 0.266 Test Loss: 1.778 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0318796634674072
Epoch: 16, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.837 Vali Acc: 0.240 Test Loss: 1.837 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0392780303955078
Epoch: 17, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.934 Vali Acc: 0.262 Test Loss: 1.934 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9126360416412354
Epoch: 18, Steps: 17 | Train Loss: 0.833 Vali Loss: 1.954 Vali Acc: 0.266 Test Loss: 1.954 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 1160068
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0742361545562744
Epoch: 1, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.8531153202056885
Epoch: 2, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (-0.243332 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 0.9083423614501953
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9143149852752686
Epoch: 4, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.428 Vali Acc: 0.251 Test Loss: 1.428 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8676793575286865
Epoch: 5, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.424 Vali Acc: 0.270 Test Loss: 1.424 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8810737133026123
Epoch: 6, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.500 Vali Acc: 0.259 Test Loss: 1.500 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.875636100769043
Epoch: 7, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.509 Vali Acc: 0.247 Test Loss: 1.509 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8860530853271484
Epoch: 8, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.628 Vali Acc: 0.247 Test Loss: 1.628 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9261453151702881
Epoch: 9, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.659 Vali Acc: 0.236 Test Loss: 1.659 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9348711967468262
Epoch: 10, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.685 Vali Acc: 0.270 Test Loss: 1.685 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8110592365264893
Epoch: 11, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.856 Vali Acc: 0.289 Test Loss: 1.856 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288955).  Saving model ...
Epoch: 12 cost time: 0.8908321857452393
Epoch: 12, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.926 Vali Acc: 0.255 Test Loss: 1.926 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9462039470672607
Epoch: 13, Steps: 17 | Train Loss: 0.765 Vali Loss: 1.965 Vali Acc: 0.262 Test Loss: 1.965 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8681347370147705
Epoch: 14, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.110 Vali Acc: 0.266 Test Loss: 2.110 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8964695930480957
Epoch: 15, Steps: 17 | Train Loss: 0.678 Vali Loss: 2.380 Vali Acc: 0.243 Test Loss: 2.380 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9172666072845459
Epoch: 16, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.376 Vali Acc: 0.266 Test Loss: 2.376 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8638882637023926
Epoch: 17, Steps: 17 | Train Loss: 0.602 Vali Loss: 2.652 Vali Acc: 0.270 Test Loss: 2.652 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8549256324768066
Epoch: 18, Steps: 17 | Train Loss: 0.588 Vali Loss: 2.742 Vali Acc: 0.262 Test Loss: 2.742 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.87532639503479
Epoch: 19, Steps: 17 | Train Loss: 0.489 Vali Loss: 2.824 Vali Acc: 0.236 Test Loss: 2.824 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8011701107025146
Epoch: 20, Steps: 17 | Train Loss: 0.496 Vali Loss: 2.948 Vali Acc: 0.255 Test Loss: 2.948 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8746476173400879
Epoch: 21, Steps: 17 | Train Loss: 0.459 Vali Loss: 3.591 Vali Acc: 0.259 Test Loss: 3.591 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 347972
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1383132934570312
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.378 Vali Acc: 0.293 Test Loss: 1.378 Test Acc: 0.293
Validation loss decreased (inf --> -0.292762).  Saving model ...
Epoch: 2 cost time: 0.7931666374206543
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.381 Vali Acc: 0.297 Test Loss: 1.381 Test Acc: 0.297
Validation loss decreased (-0.292762 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 0.9030802249908447
Epoch: 3, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.382 Vali Acc: 0.262 Test Loss: 1.382 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8467862606048584
Epoch: 4, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.384 Vali Acc: 0.297 Test Loss: 1.384 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8340029716491699
Epoch: 5, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.395 Vali Acc: 0.259 Test Loss: 1.395 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8391368389129639
Epoch: 6, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.404 Vali Acc: 0.293 Test Loss: 1.404 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8949215412139893
Epoch: 7, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.420 Vali Acc: 0.255 Test Loss: 1.420 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8561098575592041
Epoch: 8, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.431 Vali Acc: 0.304 Test Loss: 1.431 Test Acc: 0.304
Validation loss decreased (-0.296564 --> -0.304168).  Saving model ...
Epoch: 9 cost time: 0.8396213054656982
Epoch: 9, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8268117904663086
Epoch: 10, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.492 Vali Acc: 0.270 Test Loss: 1.492 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9814152717590332
Epoch: 11, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.483 Vali Acc: 0.236 Test Loss: 1.483 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9628903865814209
Epoch: 12, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.666 Vali Acc: 0.232 Test Loss: 1.666 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9450831413269043
Epoch: 13, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.583 Vali Acc: 0.255 Test Loss: 1.583 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8835227489471436
Epoch: 14, Steps: 17 | Train Loss: 0.814 Vali Loss: 1.675 Vali Acc: 0.247 Test Loss: 1.675 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8364772796630859
Epoch: 15, Steps: 17 | Train Loss: 0.792 Vali Loss: 1.748 Vali Acc: 0.247 Test Loss: 1.748 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8763501644134521
Epoch: 16, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.816 Vali Acc: 0.247 Test Loss: 1.816 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9173483848571777
Epoch: 17, Steps: 17 | Train Loss: 0.735 Vali Loss: 1.852 Vali Acc: 0.266 Test Loss: 1.852 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9020376205444336
Epoch: 18, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.943 Vali Acc: 0.274 Test Loss: 1.943 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 320068
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2140753269195557
Epoch: 1, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.403 Vali Acc: 0.236 Test Loss: 1.403 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 0.9405419826507568
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 0.8747246265411377
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
Validation loss decreased (-0.243332 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 0.820183515548706
Epoch: 4, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.404 Vali Acc: 0.259 Test Loss: 1.404 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 0.8115315437316895
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.415 Vali Acc: 0.247 Test Loss: 1.415 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8498196601867676
Epoch: 6, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8331313133239746
Epoch: 7, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.453 Vali Acc: 0.247 Test Loss: 1.453 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8028874397277832
Epoch: 8, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.474 Vali Acc: 0.259 Test Loss: 1.474 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.887458086013794
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.455 Vali Acc: 0.240 Test Loss: 1.455 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9001045227050781
Epoch: 10, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.506 Vali Acc: 0.259 Test Loss: 1.506 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8737244606018066
Epoch: 11, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.483 Vali Acc: 0.228 Test Loss: 1.483 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8294155597686768
Epoch: 12, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.526 Vali Acc: 0.232 Test Loss: 1.526 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8442211151123047
Epoch: 13, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.525 Vali Acc: 0.251 Test Loss: 1.525 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8511407375335693
Epoch: 14, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.628 Vali Acc: 0.266 Test Loss: 1.628 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266143).  Saving model ...
Epoch: 15 cost time: 0.912381649017334
Epoch: 15, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.692 Vali Acc: 0.266 Test Loss: 1.692 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.892991304397583
Epoch: 16, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.692 Vali Acc: 0.243 Test Loss: 1.692 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8902292251586914
Epoch: 17, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.882 Vali Acc: 0.255 Test Loss: 1.882 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9498710632324219
Epoch: 18, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.744 Vali Acc: 0.255 Test Loss: 1.744 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9233279228210449
Epoch: 19, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.884 Vali Acc: 0.247 Test Loss: 1.884 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8491759300231934
Epoch: 20, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.050 Vali Acc: 0.217 Test Loss: 2.050 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.829857349395752
Epoch: 21, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.015 Vali Acc: 0.247 Test Loss: 2.015 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.831754207611084
Epoch: 22, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.002 Vali Acc: 0.262 Test Loss: 2.002 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8784763813018799
Epoch: 23, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.154 Vali Acc: 0.266 Test Loss: 2.154 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8804864883422852
Epoch: 24, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.357 Vali Acc: 0.236 Test Loss: 2.357 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 312132
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1021692752838135
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.394 Vali Acc: 0.262 Test Loss: 1.394 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.8277807235717773
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.384 Vali Acc: 0.255 Test Loss: 1.384 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7713994979858398
Epoch: 3, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.390 Vali Acc: 0.266 Test Loss: 1.390 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 0.8512582778930664
Epoch: 4, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.389 Vali Acc: 0.266 Test Loss: 1.389 Test Acc: 0.266
Validation loss decreased (-0.266146 --> -0.266146).  Saving model ...
Epoch: 5 cost time: 0.8191707134246826
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.393 Vali Acc: 0.247 Test Loss: 1.393 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8457179069519043
Epoch: 6, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7807292938232422
Epoch: 7, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.403 Vali Acc: 0.240 Test Loss: 1.403 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8186640739440918
Epoch: 8, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.434 Vali Acc: 0.236 Test Loss: 1.434 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8083510398864746
Epoch: 9, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8671712875366211
Epoch: 10, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.446 Vali Acc: 0.232 Test Loss: 1.446 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8237061500549316
Epoch: 11, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.499 Vali Acc: 0.278 Test Loss: 1.499 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277552).  Saving model ...
Epoch: 12 cost time: 0.8449044227600098
Epoch: 12, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.483 Vali Acc: 0.247 Test Loss: 1.483 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.852245569229126
Epoch: 13, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.509 Vali Acc: 0.224 Test Loss: 1.509 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8666269779205322
Epoch: 14, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.548 Vali Acc: 0.224 Test Loss: 1.548 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8531520366668701
Epoch: 15, Steps: 17 | Train Loss: 0.887 Vali Loss: 1.623 Vali Acc: 0.255 Test Loss: 1.623 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8334949016571045
Epoch: 16, Steps: 17 | Train Loss: 0.866 Vali Loss: 1.578 Vali Acc: 0.255 Test Loss: 1.578 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8399837017059326
Epoch: 17, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.707 Vali Acc: 0.240 Test Loss: 1.707 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8307137489318848
Epoch: 18, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.742 Vali Acc: 0.240 Test Loss: 1.742 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8560876846313477
Epoch: 19, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.719 Vali Acc: 0.240 Test Loss: 1.719 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8357226848602295
Epoch: 20, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.867 Vali Acc: 0.209 Test Loss: 1.867 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7922799587249756
Epoch: 21, Steps: 17 | Train Loss: 0.751 Vali Loss: 1.918 Vali Acc: 0.240 Test Loss: 1.918 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 310340
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1680166721343994
Epoch: 1, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.398 Vali Acc: 0.255 Test Loss: 1.398 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.7971343994140625
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.384 Vali Acc: 0.232 Test Loss: 1.384 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7778520584106445
Epoch: 3, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.382 Vali Acc: 0.259 Test Loss: 1.382 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 0.7780008316040039
Epoch: 4, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.383 Vali Acc: 0.224 Test Loss: 1.383 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8095436096191406
Epoch: 5, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.388 Vali Acc: 0.247 Test Loss: 1.388 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8509149551391602
Epoch: 6, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.394 Vali Acc: 0.232 Test Loss: 1.394 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7042410373687744
Epoch: 7, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7442491054534912
Epoch: 8, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.426 Vali Acc: 0.259 Test Loss: 1.426 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7273659706115723
Epoch: 9, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.445 Vali Acc: 0.247 Test Loss: 1.445 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7318911552429199
Epoch: 10, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7747359275817871
Epoch: 11, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.428 Vali Acc: 0.259 Test Loss: 1.428 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8228743076324463
Epoch: 12, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.469 Vali Acc: 0.224 Test Loss: 1.469 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7695841789245605
Epoch: 13, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.496 Vali Acc: 0.240 Test Loss: 1.496 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 311300
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.086306095123291
Epoch: 1, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.379 Vali Acc: 0.251 Test Loss: 1.379 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.7752730846405029
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.374 Vali Acc: 0.247 Test Loss: 1.374 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8069789409637451
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.385 Vali Acc: 0.308 Test Loss: 1.385 Test Acc: 0.308
Validation loss decreased (-0.250937 --> -0.307971).  Saving model ...
Epoch: 4 cost time: 0.8169245719909668
Epoch: 4, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7762930393218994
Epoch: 5, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.390 Vali Acc: 0.285 Test Loss: 1.390 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7990725040435791
Epoch: 6, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.383 Vali Acc: 0.281 Test Loss: 1.383 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8217978477478027
Epoch: 7, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.390 Vali Acc: 0.274 Test Loss: 1.390 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.793917179107666
Epoch: 8, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7998981475830078
Epoch: 9, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.428 Vali Acc: 0.262 Test Loss: 1.428 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7613282203674316
Epoch: 10, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.441 Vali Acc: 0.251 Test Loss: 1.441 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8066222667694092
Epoch: 11, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.456 Vali Acc: 0.255 Test Loss: 1.456 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.856395959854126
Epoch: 12, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.485 Vali Acc: 0.240 Test Loss: 1.485 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8577561378479004
Epoch: 13, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.454 Vali Acc: 0.255 Test Loss: 1.454 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 313860
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0204954147338867
Epoch: 1, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.389 Vali Acc: 0.255 Test Loss: 1.389 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.7975702285766602
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 0.8158564567565918
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.387 Vali Acc: 0.247 Test Loss: 1.387 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.742887020111084
Epoch: 4, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.391 Vali Acc: 0.259 Test Loss: 1.391 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8269748687744141
Epoch: 5, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.391 Vali Acc: 0.255 Test Loss: 1.391 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7435088157653809
Epoch: 6, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.391 Vali Acc: 0.262 Test Loss: 1.391 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7804949283599854
Epoch: 7, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.417 Vali Acc: 0.247 Test Loss: 1.417 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8187580108642578
Epoch: 8, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.421 Vali Acc: 0.251 Test Loss: 1.421 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7853209972381592
Epoch: 9, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8935995101928711
Epoch: 10, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.443 Vali Acc: 0.270 Test Loss: 1.443 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7571187019348145
Epoch: 11, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8245770931243896
Epoch: 12, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.481 Vali Acc: 0.281 Test Loss: 1.481 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281354).  Saving model ...
Epoch: 13 cost time: 0.8062238693237305
Epoch: 13, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.492 Vali Acc: 0.247 Test Loss: 1.492 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8404257297515869
Epoch: 14, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.472 Vali Acc: 0.259 Test Loss: 1.472 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8081445693969727
Epoch: 15, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.522 Vali Acc: 0.270 Test Loss: 1.522 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7930529117584229
Epoch: 16, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.579 Vali Acc: 0.251 Test Loss: 1.579 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8001189231872559
Epoch: 17, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.613 Vali Acc: 0.259 Test Loss: 1.613 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.774470329284668
Epoch: 18, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.639 Vali Acc: 0.259 Test Loss: 1.639 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7604107856750488
Epoch: 19, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.651 Vali Acc: 0.259 Test Loss: 1.651 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7943329811096191
Epoch: 20, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.663 Vali Acc: 0.255 Test Loss: 1.663 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8303823471069336
Epoch: 21, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.763 Vali Acc: 0.255 Test Loss: 1.763 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8068954944610596
Epoch: 22, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.782 Vali Acc: 0.278 Test Loss: 1.782 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 317892
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1525135040283203
Epoch: 1, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
Validation loss decreased (inf --> -0.296564).  Saving model ...
Epoch: 2 cost time: 0.7619667053222656
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.377 Vali Acc: 0.274 Test Loss: 1.377 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.830174446105957
Epoch: 3, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.386 Vali Acc: 0.259 Test Loss: 1.386 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8624064922332764
Epoch: 4, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7866289615631104
Epoch: 5, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.396 Vali Acc: 0.259 Test Loss: 1.396 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8380062580108643
Epoch: 6, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.787508487701416
Epoch: 7, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.402 Vali Acc: 0.300 Test Loss: 1.402 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300366).  Saving model ...
Epoch: 8 cost time: 0.8859689235687256
Epoch: 8, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8268053531646729
Epoch: 9, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.457 Vali Acc: 0.285 Test Loss: 1.457 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8001799583435059
Epoch: 10, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.469 Vali Acc: 0.285 Test Loss: 1.469 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8867824077606201
Epoch: 11, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8568344116210938
Epoch: 12, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.595 Vali Acc: 0.270 Test Loss: 1.595 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8289809226989746
Epoch: 13, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.633 Vali Acc: 0.300 Test Loss: 1.633 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8228020668029785
Epoch: 14, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.668 Vali Acc: 0.270 Test Loss: 1.668 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8982326984405518
Epoch: 15, Steps: 17 | Train Loss: 0.787 Vali Loss: 1.733 Vali Acc: 0.297 Test Loss: 1.733 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8265962600708008
Epoch: 16, Steps: 17 | Train Loss: 0.763 Vali Loss: 1.815 Vali Acc: 0.297 Test Loss: 1.815 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7913632392883301
Epoch: 17, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.880 Vali Acc: 0.289 Test Loss: 1.880 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 108452
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.15441632270813
Epoch: 1, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.389 Vali Acc: 0.259 Test Loss: 1.389 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7177689075469971
Epoch: 2, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.387 Vali Acc: 0.285 Test Loss: 1.387 Test Acc: 0.285
Validation loss decreased (-0.258541 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 0.7894537448883057
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.389 Vali Acc: 0.281 Test Loss: 1.389 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7051334381103516
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.390 Vali Acc: 0.251 Test Loss: 1.390 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7471191883087158
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.390 Vali Acc: 0.293 Test Loss: 1.390 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292762).  Saving model ...
Epoch: 6 cost time: 0.7676198482513428
Epoch: 6, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.390 Vali Acc: 0.262 Test Loss: 1.390 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8369171619415283
Epoch: 7, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.396 Vali Acc: 0.255 Test Loss: 1.396 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7474584579467773
Epoch: 8, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.410 Vali Acc: 0.281 Test Loss: 1.410 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7767333984375
Epoch: 9, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.433 Vali Acc: 0.270 Test Loss: 1.433 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7839503288269043
Epoch: 10, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.421 Vali Acc: 0.247 Test Loss: 1.421 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8104879856109619
Epoch: 11, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.471 Vali Acc: 0.259 Test Loss: 1.471 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6789419651031494
Epoch: 12, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.463 Vali Acc: 0.232 Test Loss: 1.463 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7306690216064453
Epoch: 13, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.491 Vali Acc: 0.266 Test Loss: 1.491 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7714972496032715
Epoch: 14, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.491 Vali Acc: 0.232 Test Loss: 1.491 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.793485164642334
Epoch: 15, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.526 Vali Acc: 0.270 Test Loss: 1.526 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 94500
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.160358428955078
Epoch: 1, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.414 Vali Acc: 0.259 Test Loss: 1.414 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7521107196807861
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7302069664001465
Epoch: 3, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.384 Vali Acc: 0.255 Test Loss: 1.384 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.728980302810669
Epoch: 4, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.379 Vali Acc: 0.266 Test Loss: 1.379 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 5 cost time: 0.7452468872070312
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.375 Vali Acc: 0.274 Test Loss: 1.375 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273751).  Saving model ...
Epoch: 6 cost time: 0.7751119136810303
Epoch: 6, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.377 Vali Acc: 0.278 Test Loss: 1.377 Test Acc: 0.278
Validation loss decreased (-0.273751 --> -0.277553).  Saving model ...
Epoch: 7 cost time: 0.7488758563995361
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.379 Vali Acc: 0.255 Test Loss: 1.379 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7254109382629395
Epoch: 8, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.384 Vali Acc: 0.285 Test Loss: 1.384 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 0.7292048931121826
Epoch: 9, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.410 Vali Acc: 0.297 Test Loss: 1.410 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296564).  Saving model ...
Epoch: 10 cost time: 0.7250227928161621
Epoch: 10, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.395 Vali Acc: 0.262 Test Loss: 1.395 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7366206645965576
Epoch: 11, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7810854911804199
Epoch: 12, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.450 Vali Acc: 0.297 Test Loss: 1.450 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7860705852508545
Epoch: 13, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.447 Vali Acc: 0.240 Test Loss: 1.447 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7571148872375488
Epoch: 14, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.461 Vali Acc: 0.266 Test Loss: 1.461 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7479450702667236
Epoch: 15, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.477 Vali Acc: 0.259 Test Loss: 1.477 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7396104335784912
Epoch: 16, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.501 Vali Acc: 0.255 Test Loss: 1.501 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7700278759002686
Epoch: 17, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.500 Vali Acc: 0.247 Test Loss: 1.500 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7221717834472656
Epoch: 18, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.547 Vali Acc: 0.289 Test Loss: 1.547 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8172461986541748
Epoch: 19, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.560 Vali Acc: 0.270 Test Loss: 1.560 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 90532
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.148805856704712
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.384 Vali Acc: 0.247 Test Loss: 1.384 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.7655754089355469
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.370 Vali Acc: 0.251 Test Loss: 1.370 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 0.7824282646179199
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.363 Vali Acc: 0.293 Test Loss: 1.363 Test Acc: 0.293
Validation loss decreased (-0.250937 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 0.7635283470153809
Epoch: 4, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.369 Vali Acc: 0.281 Test Loss: 1.369 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.79555344581604
Epoch: 5, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.369 Vali Acc: 0.236 Test Loss: 1.369 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7695708274841309
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.370 Vali Acc: 0.232 Test Loss: 1.370 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7470121383666992
Epoch: 7, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.367 Vali Acc: 0.236 Test Loss: 1.367 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7442178726196289
Epoch: 8, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.393 Vali Acc: 0.274 Test Loss: 1.393 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7409703731536865
Epoch: 9, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.380 Vali Acc: 0.251 Test Loss: 1.380 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7271578311920166
Epoch: 10, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.397 Vali Acc: 0.266 Test Loss: 1.397 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7635512351989746
Epoch: 11, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.398 Vali Acc: 0.247 Test Loss: 1.398 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7658596038818359
Epoch: 12, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.739600419998169
Epoch: 13, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 89636
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.234522819519043
Epoch: 1, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.392 Vali Acc: 0.259 Test Loss: 1.392 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7668442726135254
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.378 Vali Acc: 0.289 Test Loss: 1.378 Test Acc: 0.289
Validation loss decreased (-0.258541 --> -0.288960).  Saving model ...
Epoch: 3 cost time: 0.7106120586395264
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.380 Vali Acc: 0.266 Test Loss: 1.380 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8093400001525879
Epoch: 4, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.380 Vali Acc: 0.293 Test Loss: 1.380 Test Acc: 0.293
Validation loss decreased (-0.288960 --> -0.292762).  Saving model ...
Epoch: 5 cost time: 0.787571907043457
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.385 Vali Acc: 0.255 Test Loss: 1.385 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8331444263458252
Epoch: 6, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.382 Vali Acc: 0.259 Test Loss: 1.382 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7082812786102295
Epoch: 7, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.389 Vali Acc: 0.255 Test Loss: 1.389 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.77482008934021
Epoch: 8, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.390 Vali Acc: 0.262 Test Loss: 1.390 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7494401931762695
Epoch: 9, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.391 Vali Acc: 0.259 Test Loss: 1.391 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7362291812896729
Epoch: 10, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7570180892944336
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8411598205566406
Epoch: 12, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.417 Vali Acc: 0.266 Test Loss: 1.417 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7677431106567383
Epoch: 13, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7163147926330566
Epoch: 14, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.442 Vali Acc: 0.274 Test Loss: 1.442 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 90116
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.084810733795166
Epoch: 1, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.407 Vali Acc: 0.259 Test Loss: 1.407 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7474122047424316
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.396 Vali Acc: 0.255 Test Loss: 1.396 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8097665309906006
Epoch: 3, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.398 Vali Acc: 0.259 Test Loss: 1.398 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 0.7317554950714111
Epoch: 4, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.393 Vali Acc: 0.259 Test Loss: 1.393 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 0.7680673599243164
Epoch: 5, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.409 Vali Acc: 0.251 Test Loss: 1.409 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7224624156951904
Epoch: 6, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.403 Vali Acc: 0.205 Test Loss: 1.403 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.748384952545166
Epoch: 7, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.408 Vali Acc: 0.221 Test Loss: 1.408 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7455427646636963
Epoch: 8, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.398 Vali Acc: 0.240 Test Loss: 1.398 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7467479705810547
Epoch: 9, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.394 Vali Acc: 0.224 Test Loss: 1.394 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.748950719833374
Epoch: 10, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.405 Vali Acc: 0.202 Test Loss: 1.405 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7702188491821289
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.402 Vali Acc: 0.236 Test Loss: 1.402 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7252199649810791
Epoch: 12, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.410 Vali Acc: 0.262 Test Loss: 1.410 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 13 cost time: 0.7482626438140869
Epoch: 13, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.420 Vali Acc: 0.255 Test Loss: 1.420 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7414395809173584
Epoch: 14, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.421 Vali Acc: 0.224 Test Loss: 1.421 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7998054027557373
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.442 Vali Acc: 0.259 Test Loss: 1.442 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7456541061401367
Epoch: 16, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.457 Vali Acc: 0.274 Test Loss: 1.457 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 17 cost time: 0.7626080513000488
Epoch: 17, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.464 Vali Acc: 0.247 Test Loss: 1.464 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7980520725250244
Epoch: 18, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.457 Vali Acc: 0.251 Test Loss: 1.457 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.774580717086792
Epoch: 19, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.490 Vali Acc: 0.270 Test Loss: 1.490 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8403100967407227
Epoch: 20, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.498 Vali Acc: 0.247 Test Loss: 1.498 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7652144432067871
Epoch: 21, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.493 Vali Acc: 0.278 Test Loss: 1.493 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 22 cost time: 0.7520523071289062
Epoch: 22, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7194263935089111
Epoch: 23, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.527 Vali Acc: 0.274 Test Loss: 1.527 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8138339519500732
Epoch: 24, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.601 Vali Acc: 0.266 Test Loss: 1.601 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6881740093231201
Epoch: 25, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.594 Vali Acc: 0.262 Test Loss: 1.594 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6819310188293457
Epoch: 26, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.628 Vali Acc: 0.224 Test Loss: 1.628 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7511162757873535
Epoch: 27, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.618 Vali Acc: 0.289 Test Loss: 1.618 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288957).  Saving model ...
Epoch: 28 cost time: 0.7687289714813232
Epoch: 28, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.707 Vali Acc: 0.259 Test Loss: 1.707 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.703444242477417
Epoch: 29, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.751 Vali Acc: 0.243 Test Loss: 1.751 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7793233394622803
Epoch: 30, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.819 Vali Acc: 0.224 Test Loss: 1.819 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7973849773406982
Epoch: 31, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.828 Vali Acc: 0.274 Test Loss: 1.828 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8436920642852783
Epoch: 32, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.855 Vali Acc: 0.274 Test Loss: 1.855 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7666370868682861
Epoch: 33, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.864 Vali Acc: 0.251 Test Loss: 1.864 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7690591812133789
Epoch: 34, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.953 Vali Acc: 0.259 Test Loss: 1.953 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8076329231262207
Epoch: 35, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.892 Vali Acc: 0.262 Test Loss: 1.892 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7775869369506836
Epoch: 36, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.908 Vali Acc: 0.243 Test Loss: 1.908 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8400061130523682
Epoch: 37, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.043 Vali Acc: 0.274 Test Loss: 2.043 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 91396
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1599106788635254
Epoch: 1, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.399 Vali Acc: 0.259 Test Loss: 1.399 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7239928245544434
Epoch: 2, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.380 Vali Acc: 0.274 Test Loss: 1.380 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 0.7660689353942871
Epoch: 3, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.385 Vali Acc: 0.308 Test Loss: 1.385 Test Acc: 0.308
Validation loss decreased (-0.273750 --> -0.307971).  Saving model ...
Epoch: 4 cost time: 0.7183117866516113
Epoch: 4, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.382 Vali Acc: 0.293 Test Loss: 1.382 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7312779426574707
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8043832778930664
Epoch: 6, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.386 Vali Acc: 0.262 Test Loss: 1.386 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7671594619750977
Epoch: 7, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7462425231933594
Epoch: 8, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.395 Vali Acc: 0.232 Test Loss: 1.395 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7688643932342529
Epoch: 9, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.392 Vali Acc: 0.274 Test Loss: 1.392 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7544193267822266
Epoch: 10, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7566936016082764
Epoch: 11, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.412 Vali Acc: 0.251 Test Loss: 1.412 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8120198249816895
Epoch: 12, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.408 Vali Acc: 0.278 Test Loss: 1.408 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7638471126556396
Epoch: 13, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 93412
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1904008388519287
Epoch: 1, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.747 Vali Acc: 0.255 Test Loss: 1.747 Test Acc: 0.255
Validation loss decreased (inf --> -0.254735).  Saving model ...
Epoch: 2 cost time: 1.0666701793670654
Epoch: 2, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.508 Vali Acc: 0.255 Test Loss: 1.508 Test Acc: 0.255
Validation loss decreased (-0.254735 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.1344971656799316
Epoch: 3, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.541 Vali Acc: 0.293 Test Loss: 1.541 Test Acc: 0.293
Validation loss decreased (-0.254738 --> -0.292760).  Saving model ...
Epoch: 4 cost time: 1.1823585033416748
Epoch: 4, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.800 Vali Acc: 0.247 Test Loss: 1.800 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.074730396270752
Epoch: 5, Steps: 17 | Train Loss: 1.123 Vali Loss: 2.304 Vali Acc: 0.270 Test Loss: 2.304 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0986628532409668
Epoch: 6, Steps: 17 | Train Loss: 1.140 Vali Loss: 2.515 Vali Acc: 0.247 Test Loss: 2.515 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1147282123565674
Epoch: 7, Steps: 17 | Train Loss: 0.993 Vali Loss: 2.439 Vali Acc: 0.270 Test Loss: 2.439 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.072606086730957
Epoch: 8, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.617 Vali Acc: 0.232 Test Loss: 2.617 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0926954746246338
Epoch: 9, Steps: 17 | Train Loss: 0.813 Vali Loss: 2.147 Vali Acc: 0.270 Test Loss: 2.147 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1127517223358154
Epoch: 10, Steps: 17 | Train Loss: 0.751 Vali Loss: 3.041 Vali Acc: 0.243 Test Loss: 3.041 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0989100933074951
Epoch: 11, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.997 Vali Acc: 0.266 Test Loss: 2.997 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9731669425964355
Epoch: 12, Steps: 17 | Train Loss: 0.607 Vali Loss: 2.864 Vali Acc: 0.255 Test Loss: 2.864 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.095963716506958
Epoch: 13, Steps: 17 | Train Loss: 0.555 Vali Loss: 3.250 Vali Acc: 0.262 Test Loss: 3.250 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1072388
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.403193235397339
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.646 Vali Acc: 0.259 Test Loss: 1.646 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 0.9621586799621582
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.461 Vali Acc: 0.278 Test Loss: 1.461 Test Acc: 0.278
Validation loss decreased (-0.258539 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 0.9857437610626221
Epoch: 3, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.611 Vali Acc: 0.259 Test Loss: 1.611 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.889549732208252
Epoch: 4, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.548 Vali Acc: 0.274 Test Loss: 1.548 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9986522197723389
Epoch: 5, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.843 Vali Acc: 0.270 Test Loss: 1.843 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8236794471740723
Epoch: 6, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.805 Vali Acc: 0.228 Test Loss: 1.805 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8610963821411133
Epoch: 7, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.890 Vali Acc: 0.247 Test Loss: 1.890 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9130315780639648
Epoch: 8, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.926 Vali Acc: 0.266 Test Loss: 1.926 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9323458671569824
Epoch: 9, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.040 Vali Acc: 0.281 Test Loss: 2.040 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281348).  Saving model ...
Epoch: 10 cost time: 0.9129230976104736
Epoch: 10, Steps: 17 | Train Loss: 0.840 Vali Loss: 2.149 Vali Acc: 0.240 Test Loss: 2.149 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9282033443450928
Epoch: 11, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.302 Vali Acc: 0.259 Test Loss: 2.302 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8827219009399414
Epoch: 12, Steps: 17 | Train Loss: 0.763 Vali Loss: 2.202 Vali Acc: 0.236 Test Loss: 2.202 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0147056579589844
Epoch: 13, Steps: 17 | Train Loss: 0.714 Vali Loss: 2.462 Vali Acc: 0.251 Test Loss: 2.462 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9681675434112549
Epoch: 14, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.518 Vali Acc: 0.262 Test Loss: 2.518 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0026836395263672
Epoch: 15, Steps: 17 | Train Loss: 0.591 Vali Loss: 3.202 Vali Acc: 0.281 Test Loss: 3.202 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9712374210357666
Epoch: 16, Steps: 17 | Train Loss: 0.606 Vali Loss: 2.772 Vali Acc: 0.251 Test Loss: 2.772 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9270627498626709
Epoch: 17, Steps: 17 | Train Loss: 0.549 Vali Loss: 2.883 Vali Acc: 0.232 Test Loss: 2.883 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9496867656707764
Epoch: 18, Steps: 17 | Train Loss: 0.523 Vali Loss: 2.561 Vali Acc: 0.251 Test Loss: 2.561 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9771261215209961
Epoch: 19, Steps: 17 | Train Loss: 0.507 Vali Loss: 2.802 Vali Acc: 0.232 Test Loss: 2.802 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 960772
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2082343101501465
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 0.7824428081512451
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.643 Vali Acc: 0.274 Test Loss: 1.643 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273748).  Saving model ...
Epoch: 3 cost time: 0.8180897235870361
Epoch: 3, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.572 Vali Acc: 0.228 Test Loss: 1.572 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7553956508636475
Epoch: 4, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7516191005706787
Epoch: 5, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.572 Vali Acc: 0.251 Test Loss: 1.572 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7454977035522461
Epoch: 6, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.646 Vali Acc: 0.240 Test Loss: 1.646 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7655069828033447
Epoch: 7, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.736 Vali Acc: 0.289 Test Loss: 1.736 Test Acc: 0.289
Validation loss decreased (-0.273748 --> -0.288956).  Saving model ...
Epoch: 8 cost time: 0.8170075416564941
Epoch: 8, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.836 Vali Acc: 0.255 Test Loss: 1.836 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7692947387695312
Epoch: 9, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.827 Vali Acc: 0.240 Test Loss: 1.827 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7833411693572998
Epoch: 10, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.021 Vali Acc: 0.262 Test Loss: 2.021 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7187788486480713
Epoch: 11, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.038 Vali Acc: 0.240 Test Loss: 2.038 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7889080047607422
Epoch: 12, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.094 Vali Acc: 0.262 Test Loss: 2.094 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.767906665802002
Epoch: 13, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.202 Vali Acc: 0.266 Test Loss: 2.202 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7935595512390137
Epoch: 14, Steps: 17 | Train Loss: 0.702 Vali Loss: 2.560 Vali Acc: 0.274 Test Loss: 2.560 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7186431884765625
Epoch: 15, Steps: 17 | Train Loss: 0.609 Vali Loss: 2.296 Vali Acc: 0.217 Test Loss: 2.296 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7426321506500244
Epoch: 16, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.490 Vali Acc: 0.266 Test Loss: 2.490 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.74686598777771
Epoch: 17, Steps: 17 | Train Loss: 0.642 Vali Loss: 3.081 Vali Acc: 0.281 Test Loss: 3.081 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 932100
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9870851039886475
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.438 Vali Acc: 0.278 Test Loss: 1.438 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 0.8403587341308594
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.465 Vali Acc: 0.243 Test Loss: 1.465 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7537887096405029
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.465 Vali Acc: 0.243 Test Loss: 1.465 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.79258131980896
Epoch: 4, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.535 Vali Acc: 0.259 Test Loss: 1.535 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.727818489074707
Epoch: 5, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.532 Vali Acc: 0.232 Test Loss: 1.532 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7555792331695557
Epoch: 6, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.545 Vali Acc: 0.255 Test Loss: 1.545 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7879340648651123
Epoch: 7, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.691 Vali Acc: 0.243 Test Loss: 1.691 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7158269882202148
Epoch: 8, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.735 Vali Acc: 0.266 Test Loss: 1.735 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7561757564544678
Epoch: 9, Steps: 17 | Train Loss: 0.936 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.720736026763916
Epoch: 10, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.795 Vali Acc: 0.240 Test Loss: 1.795 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7270748615264893
Epoch: 11, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.961 Vali Acc: 0.259 Test Loss: 1.961 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 921860
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2965285778045654
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.440 Vali Acc: 0.224 Test Loss: 1.440 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 0.7986116409301758
Epoch: 2, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.457 Vali Acc: 0.262 Test Loss: 1.457 Test Acc: 0.262
Validation loss decreased (-0.224320 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 0.8422918319702148
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.541 Vali Acc: 0.240 Test Loss: 1.541 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8413107395172119
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.464 Vali Acc: 0.240 Test Loss: 1.464 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.812943696975708
Epoch: 5, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.580 Vali Acc: 0.255 Test Loss: 1.580 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8942563533782959
Epoch: 6, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.460 Vali Acc: 0.240 Test Loss: 1.460 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7689316272735596
Epoch: 7, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.564 Vali Acc: 0.255 Test Loss: 1.564 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7948246002197266
Epoch: 8, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.568 Vali Acc: 0.259 Test Loss: 1.568 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8558220863342285
Epoch: 9, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.694 Vali Acc: 0.278 Test Loss: 1.694 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277550).  Saving model ...
Epoch: 10 cost time: 0.9306004047393799
Epoch: 10, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.612 Vali Acc: 0.270 Test Loss: 1.612 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9674115180969238
Epoch: 11, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.794 Vali Acc: 0.236 Test Loss: 1.794 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9033393859863281
Epoch: 12, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.801 Vali Acc: 0.259 Test Loss: 1.801 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8100845813751221
Epoch: 13, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.811 Vali Acc: 0.243 Test Loss: 1.811 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7942800521850586
Epoch: 14, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.864 Vali Acc: 0.247 Test Loss: 1.864 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9750661849975586
Epoch: 15, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.922 Vali Acc: 0.236 Test Loss: 1.922 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8090152740478516
Epoch: 16, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.862 Vali Acc: 0.243 Test Loss: 1.862 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8708758354187012
Epoch: 17, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.243 Vali Acc: 0.243 Test Loss: 2.243 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8373396396636963
Epoch: 18, Steps: 17 | Train Loss: 0.729 Vali Loss: 2.181 Vali Acc: 0.224 Test Loss: 2.181 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9133942127227783
Epoch: 19, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.054 Vali Acc: 0.251 Test Loss: 2.054 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 925700
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.14359188079834
Epoch: 1, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.424 Vali Acc: 0.247 Test Loss: 1.424 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.750291109085083
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.505 Vali Acc: 0.255 Test Loss: 1.505 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 0.8037033081054688
Epoch: 3, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.438 Vali Acc: 0.240 Test Loss: 1.438 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8029732704162598
Epoch: 4, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.550 Vali Acc: 0.259 Test Loss: 1.550 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 0.7057523727416992
Epoch: 5, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.484 Vali Acc: 0.232 Test Loss: 1.484 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7579584121704102
Epoch: 6, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.533 Vali Acc: 0.243 Test Loss: 1.533 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7349727153778076
Epoch: 7, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.544 Vali Acc: 0.205 Test Loss: 1.544 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7384562492370605
Epoch: 8, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.582 Vali Acc: 0.259 Test Loss: 1.582 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6961276531219482
Epoch: 9, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.680 Vali Acc: 0.259 Test Loss: 1.680 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7303059101104736
Epoch: 10, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.785 Vali Acc: 0.224 Test Loss: 1.785 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7108042240142822
Epoch: 11, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.626 Vali Acc: 0.232 Test Loss: 1.626 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6676938533782959
Epoch: 12, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.643 Vali Acc: 0.236 Test Loss: 1.643 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.720726490020752
Epoch: 13, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.785 Vali Acc: 0.224 Test Loss: 1.785 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7337076663970947
Epoch: 14, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.094 Vali Acc: 0.236 Test Loss: 2.094 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 935940
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9300661087036133
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.7900969982147217
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.414 Vali Acc: 0.236 Test Loss: 1.414 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7403256893157959
Epoch: 3, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.456 Vali Acc: 0.285 Test Loss: 1.456 Test Acc: 0.285
Validation loss decreased (-0.247134 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 0.7337546348571777
Epoch: 4, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.511 Vali Acc: 0.240 Test Loss: 1.511 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7589592933654785
Epoch: 5, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.504 Vali Acc: 0.243 Test Loss: 1.504 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8037371635437012
Epoch: 6, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.460 Vali Acc: 0.251 Test Loss: 1.460 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8064470291137695
Epoch: 7, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.526 Vali Acc: 0.285 Test Loss: 1.526 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7409594058990479
Epoch: 8, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.516 Vali Acc: 0.236 Test Loss: 1.516 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8256397247314453
Epoch: 9, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.695 Vali Acc: 0.270 Test Loss: 1.695 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7633512020111084
Epoch: 10, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.657 Vali Acc: 0.240 Test Loss: 1.657 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7739906311035156
Epoch: 11, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.663 Vali Acc: 0.236 Test Loss: 1.663 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8019323348999023
Epoch: 12, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.848 Vali Acc: 0.255 Test Loss: 1.848 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.752263069152832
Epoch: 13, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.702 Vali Acc: 0.243 Test Loss: 1.702 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 952068
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2147414684295654
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.484 Vali Acc: 0.281 Test Loss: 1.484 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 0.7707030773162842
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.552 Vali Acc: 0.259 Test Loss: 1.552 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7464737892150879
Epoch: 3, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.597 Vali Acc: 0.274 Test Loss: 1.597 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7148764133453369
Epoch: 4, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.746772289276123
Epoch: 5, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.587 Vali Acc: 0.255 Test Loss: 1.587 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7527732849121094
Epoch: 6, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.626 Vali Acc: 0.274 Test Loss: 1.626 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7880537509918213
Epoch: 7, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.755 Vali Acc: 0.300 Test Loss: 1.755 Test Acc: 0.300
Validation loss decreased (-0.281354 --> -0.300363).  Saving model ...
Epoch: 8 cost time: 0.8015351295471191
Epoch: 8, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.938 Vali Acc: 0.270 Test Loss: 1.938 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7986395359039307
Epoch: 9, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.048 Vali Acc: 0.251 Test Loss: 2.048 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8015341758728027
Epoch: 10, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.187 Vali Acc: 0.270 Test Loss: 2.187 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.791454553604126
Epoch: 11, Steps: 17 | Train Loss: 0.664 Vali Loss: 2.162 Vali Acc: 0.251 Test Loss: 2.162 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7774298191070557
Epoch: 12, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.418 Vali Acc: 0.278 Test Loss: 2.418 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8172667026519775
Epoch: 13, Steps: 17 | Train Loss: 0.636 Vali Loss: 2.601 Vali Acc: 0.278 Test Loss: 2.601 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8400647640228271
Epoch: 14, Steps: 17 | Train Loss: 0.613 Vali Loss: 2.574 Vali Acc: 0.259 Test Loss: 2.574 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8191008567810059
Epoch: 15, Steps: 17 | Train Loss: 0.602 Vali Loss: 2.811 Vali Acc: 0.285 Test Loss: 2.811 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8483676910400391
Epoch: 16, Steps: 17 | Train Loss: 0.545 Vali Loss: 2.927 Vali Acc: 0.262 Test Loss: 2.927 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8560335636138916
Epoch: 17, Steps: 17 | Train Loss: 0.483 Vali Loss: 2.868 Vali Acc: 0.262 Test Loss: 2.868 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 339588
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.15702748298645
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.420 Vali Acc: 0.255 Test Loss: 1.420 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.751328706741333
Epoch: 2, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.468 Vali Acc: 0.262 Test Loss: 1.468 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 0.7972986698150635
Epoch: 3, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.472 Vali Acc: 0.262 Test Loss: 1.472 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.824230432510376
Epoch: 4, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.469 Vali Acc: 0.266 Test Loss: 1.469 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 0.782351016998291
Epoch: 5, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.563 Vali Acc: 0.289 Test Loss: 1.563 Test Acc: 0.289
Validation loss decreased (-0.266145 --> -0.288958).  Saving model ...
Epoch: 6 cost time: 0.8552014827728271
Epoch: 6, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.544 Vali Acc: 0.266 Test Loss: 1.544 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7415282726287842
Epoch: 7, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.545 Vali Acc: 0.266 Test Loss: 1.545 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8035495281219482
Epoch: 8, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.825 Vali Acc: 0.274 Test Loss: 1.825 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7953128814697266
Epoch: 9, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.666 Vali Acc: 0.243 Test Loss: 1.666 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7781388759613037
Epoch: 10, Steps: 17 | Train Loss: 0.851 Vali Loss: 1.738 Vali Acc: 0.262 Test Loss: 1.738 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7970175743103027
Epoch: 11, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.642 Vali Acc: 0.266 Test Loss: 1.642 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7845666408538818
Epoch: 12, Steps: 17 | Train Loss: 0.763 Vali Loss: 1.776 Vali Acc: 0.247 Test Loss: 1.776 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7981019020080566
Epoch: 13, Steps: 17 | Train Loss: 0.740 Vali Loss: 1.825 Vali Acc: 0.236 Test Loss: 1.825 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7201557159423828
Epoch: 14, Steps: 17 | Train Loss: 0.715 Vali Loss: 1.989 Vali Acc: 0.221 Test Loss: 1.989 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7372069358825684
Epoch: 15, Steps: 17 | Train Loss: 0.680 Vali Loss: 2.133 Vali Acc: 0.240 Test Loss: 2.133 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 283780
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2707149982452393
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 0.7113823890686035
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7025213241577148
Epoch: 3, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.391 Vali Acc: 0.300 Test Loss: 1.391 Test Acc: 0.300
Validation loss decreased (-0.269948 --> -0.300366).  Saving model ...
Epoch: 4 cost time: 0.7687113285064697
Epoch: 4, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.484 Vali Acc: 0.266 Test Loss: 1.484 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8244190216064453
Epoch: 5, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.753791332244873
Epoch: 6, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.464 Vali Acc: 0.270 Test Loss: 1.464 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8043785095214844
Epoch: 7, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.552 Vali Acc: 0.251 Test Loss: 1.552 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8597033023834229
Epoch: 8, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.520 Vali Acc: 0.247 Test Loss: 1.520 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.737968921661377
Epoch: 9, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.582 Vali Acc: 0.213 Test Loss: 1.582 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7673139572143555
Epoch: 10, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.582 Vali Acc: 0.251 Test Loss: 1.582 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.830390214920044
Epoch: 11, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.674 Vali Acc: 0.247 Test Loss: 1.674 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7673594951629639
Epoch: 12, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.729 Vali Acc: 0.224 Test Loss: 1.729 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6967060565948486
Epoch: 13, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.768 Vali Acc: 0.266 Test Loss: 1.768 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 269444
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.083494186401367
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.429 Vali Acc: 0.240 Test Loss: 1.429 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 0.8123846054077148
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.454 Vali Acc: 0.251 Test Loss: 1.454 Test Acc: 0.251
Validation loss decreased (-0.239529 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 0.6904687881469727
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.441 Vali Acc: 0.266 Test Loss: 1.441 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 0.7958822250366211
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6882758140563965
Epoch: 5, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.559 Vali Acc: 0.228 Test Loss: 1.559 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.743152379989624
Epoch: 6, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.552 Vali Acc: 0.224 Test Loss: 1.552 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7052927017211914
Epoch: 7, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.511 Vali Acc: 0.236 Test Loss: 1.511 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7104167938232422
Epoch: 8, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.513 Vali Acc: 0.251 Test Loss: 1.513 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7193984985351562
Epoch: 9, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.587 Vali Acc: 0.251 Test Loss: 1.587 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.758547306060791
Epoch: 10, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.639 Vali Acc: 0.262 Test Loss: 1.639 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7442953586578369
Epoch: 11, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.624 Vali Acc: 0.243 Test Loss: 1.624 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7363131046295166
Epoch: 12, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.736 Vali Acc: 0.255 Test Loss: 1.736 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7446272373199463
Epoch: 13, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.777 Vali Acc: 0.281 Test Loss: 1.777 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281351).  Saving model ...
Epoch: 14 cost time: 0.7971775531768799
Epoch: 14, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.843 Vali Acc: 0.259 Test Loss: 1.843 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8090696334838867
Epoch: 15, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.860 Vali Acc: 0.247 Test Loss: 1.860 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7772464752197266
Epoch: 16, Steps: 17 | Train Loss: 0.772 Vali Loss: 1.898 Vali Acc: 0.243 Test Loss: 1.898 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7337837219238281
Epoch: 17, Steps: 17 | Train Loss: 0.742 Vali Loss: 2.018 Vali Acc: 0.240 Test Loss: 2.018 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7818379402160645
Epoch: 18, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.049 Vali Acc: 0.236 Test Loss: 2.049 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7802145481109619
Epoch: 19, Steps: 17 | Train Loss: 0.707 Vali Loss: 2.069 Vali Acc: 0.281 Test Loss: 2.069 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8226580619812012
Epoch: 20, Steps: 17 | Train Loss: 0.684 Vali Loss: 2.310 Vali Acc: 0.259 Test Loss: 2.310 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7378966808319092
Epoch: 21, Steps: 17 | Train Loss: 0.697 Vali Loss: 2.111 Vali Acc: 0.274 Test Loss: 2.111 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7955625057220459
Epoch: 22, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.262 Vali Acc: 0.232 Test Loss: 2.262 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7955124378204346
Epoch: 23, Steps: 17 | Train Loss: 0.620 Vali Loss: 2.330 Vali Acc: 0.228 Test Loss: 2.330 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 264324
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0595953464508057
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.385 Vali Acc: 0.262 Test Loss: 1.385 Test Acc: 0.262
Validation loss decreased (inf --> -0.262344).  Saving model ...
Epoch: 2 cost time: 0.7505795955657959
Epoch: 2, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.384 Vali Acc: 0.274 Test Loss: 1.384 Test Acc: 0.274
Validation loss decreased (-0.262344 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 0.763709306716919
Epoch: 3, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.397 Vali Acc: 0.236 Test Loss: 1.397 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7612788677215576
Epoch: 4, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.424 Vali Acc: 0.255 Test Loss: 1.424 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7757947444915771
Epoch: 5, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.445 Vali Acc: 0.247 Test Loss: 1.445 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7562539577484131
Epoch: 6, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.451 Vali Acc: 0.255 Test Loss: 1.451 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.644578218460083
Epoch: 7, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6908652782440186
Epoch: 8, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.484 Vali Acc: 0.243 Test Loss: 1.484 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6639628410339355
Epoch: 9, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.495 Vali Acc: 0.240 Test Loss: 1.495 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7428724765777588
Epoch: 10, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.519 Vali Acc: 0.232 Test Loss: 1.519 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.753286600112915
Epoch: 11, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.554 Vali Acc: 0.224 Test Loss: 1.554 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6592888832092285
Epoch: 12, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 266244
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.8944337368011475
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.411 Vali Acc: 0.255 Test Loss: 1.411 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.7630012035369873
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.417 Vali Acc: 0.236 Test Loss: 1.417 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7123136520385742
Epoch: 3, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.418 Vali Acc: 0.243 Test Loss: 1.418 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6904511451721191
Epoch: 4, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7260243892669678
Epoch: 5, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.470 Vali Acc: 0.236 Test Loss: 1.470 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7069721221923828
Epoch: 6, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.497 Vali Acc: 0.259 Test Loss: 1.497 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258540).  Saving model ...
Epoch: 7 cost time: 0.69352126121521
Epoch: 7, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.486 Vali Acc: 0.224 Test Loss: 1.486 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7852041721343994
Epoch: 8, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.526 Vali Acc: 0.228 Test Loss: 1.526 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.687997579574585
Epoch: 9, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.494 Vali Acc: 0.236 Test Loss: 1.494 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6966407299041748
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.510 Vali Acc: 0.274 Test Loss: 1.510 Test Acc: 0.274
Validation loss decreased (-0.258540 --> -0.273749).  Saving model ...
Epoch: 11 cost time: 0.8430051803588867
Epoch: 11, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.541 Vali Acc: 0.240 Test Loss: 1.541 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6432785987854004
Epoch: 12, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.568 Vali Acc: 0.240 Test Loss: 1.568 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7084524631500244
Epoch: 13, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.576 Vali Acc: 0.255 Test Loss: 1.576 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6995248794555664
Epoch: 14, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.685 Vali Acc: 0.274 Test Loss: 1.685 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7233836650848389
Epoch: 15, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.645 Vali Acc: 0.194 Test Loss: 1.645 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6987090110778809
Epoch: 16, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.664 Vali Acc: 0.262 Test Loss: 1.664 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.702672004699707
Epoch: 17, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.774 Vali Acc: 0.262 Test Loss: 1.774 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6332669258117676
Epoch: 18, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.794 Vali Acc: 0.274 Test Loss: 1.794 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.653764009475708
Epoch: 19, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.912 Vali Acc: 0.255 Test Loss: 1.912 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6807823181152344
Epoch: 20, Steps: 17 | Train Loss: 0.779 Vali Loss: 1.771 Vali Acc: 0.251 Test Loss: 1.771 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 271364
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1759328842163086
Epoch: 1, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.424 Vali Acc: 0.232 Test Loss: 1.424 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 0.7646572589874268
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.409 Vali Acc: 0.228 Test Loss: 1.409 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7274870872497559
Epoch: 3, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.424 Vali Acc: 0.232 Test Loss: 1.424 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7398853302001953
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.431 Vali Acc: 0.251 Test Loss: 1.431 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250936).  Saving model ...
Epoch: 5 cost time: 0.6869716644287109
Epoch: 5, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.426 Vali Acc: 0.232 Test Loss: 1.426 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6941657066345215
Epoch: 6, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.460 Vali Acc: 0.281 Test Loss: 1.460 Test Acc: 0.281
Validation loss decreased (-0.250936 --> -0.281354).  Saving model ...
Epoch: 7 cost time: 0.675412654876709
Epoch: 7, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.446 Vali Acc: 0.289 Test Loss: 1.446 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288959).  Saving model ...
Epoch: 8 cost time: 0.6754603385925293
Epoch: 8, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.464 Vali Acc: 0.266 Test Loss: 1.464 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7076704502105713
Epoch: 9, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.489 Vali Acc: 0.259 Test Loss: 1.489 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6937198638916016
Epoch: 10, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.458 Vali Acc: 0.251 Test Loss: 1.458 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7217237949371338
Epoch: 11, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.520 Vali Acc: 0.247 Test Loss: 1.520 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7174050807952881
Epoch: 12, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.727 Vali Acc: 0.259 Test Loss: 1.727 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7576797008514404
Epoch: 13, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.570 Vali Acc: 0.247 Test Loss: 1.570 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6997487545013428
Epoch: 14, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.658 Vali Acc: 0.247 Test Loss: 1.658 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7894420623779297
Epoch: 15, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.582 Vali Acc: 0.262 Test Loss: 1.582 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7291464805603027
Epoch: 16, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.674 Vali Acc: 0.228 Test Loss: 1.674 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7289447784423828
Epoch: 17, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.726 Vali Acc: 0.240 Test Loss: 1.726 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 279428
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1985254287719727
Epoch: 1, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.484 Vali Acc: 0.236 Test Loss: 1.484 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 0.7027902603149414
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.465 Vali Acc: 0.224 Test Loss: 1.465 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7855346202850342
Epoch: 3, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.465 Vali Acc: 0.236 Test Loss: 1.465 Test Acc: 0.236
Validation loss decreased (-0.235727 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 0.6806161403656006
Epoch: 4, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.482 Vali Acc: 0.243 Test Loss: 1.482 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 5 cost time: 0.6573383808135986
Epoch: 5, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.500 Vali Acc: 0.281 Test Loss: 1.500 Test Acc: 0.281
Validation loss decreased (-0.243331 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 0.6205117702484131
Epoch: 6, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.539 Vali Acc: 0.266 Test Loss: 1.539 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7236413955688477
Epoch: 7, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.618 Vali Acc: 0.259 Test Loss: 1.618 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6941220760345459
Epoch: 8, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.766 Vali Acc: 0.236 Test Loss: 1.766 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6610820293426514
Epoch: 9, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.650 Vali Acc: 0.285 Test Loss: 1.650 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 10 cost time: 0.6390974521636963
Epoch: 10, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.813 Vali Acc: 0.240 Test Loss: 1.813 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6450827121734619
Epoch: 11, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.935 Vali Acc: 0.262 Test Loss: 1.935 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6955103874206543
Epoch: 12, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.019 Vali Acc: 0.293 Test Loss: 2.019 Test Acc: 0.293
Validation loss decreased (-0.285155 --> -0.292755).  Saving model ...
Epoch: 13 cost time: 0.7282888889312744
Epoch: 13, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.034 Vali Acc: 0.281 Test Loss: 2.034 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7405383586883545
Epoch: 14, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.345 Vali Acc: 0.270 Test Loss: 2.345 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7302734851837158
Epoch: 15, Steps: 17 | Train Loss: 0.693 Vali Loss: 2.442 Vali Acc: 0.270 Test Loss: 2.442 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7419109344482422
Epoch: 16, Steps: 17 | Train Loss: 0.676 Vali Loss: 2.557 Vali Acc: 0.255 Test Loss: 2.557 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7305083274841309
Epoch: 17, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.561 Vali Acc: 0.251 Test Loss: 2.561 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7500841617584229
Epoch: 18, Steps: 17 | Train Loss: 0.582 Vali Loss: 2.719 Vali Acc: 0.289 Test Loss: 2.719 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6879892349243164
Epoch: 19, Steps: 17 | Train Loss: 0.527 Vali Loss: 2.511 Vali Acc: 0.228 Test Loss: 2.511 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7197375297546387
Epoch: 20, Steps: 17 | Train Loss: 0.585 Vali Loss: 2.811 Vali Acc: 0.240 Test Loss: 2.811 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6829378604888916
Epoch: 21, Steps: 17 | Train Loss: 0.514 Vali Loss: 2.831 Vali Acc: 0.243 Test Loss: 2.831 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.724837064743042
Epoch: 22, Steps: 17 | Train Loss: 0.505 Vali Loss: 2.856 Vali Acc: 0.262 Test Loss: 2.856 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 120644
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.054001569747925
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.431 Vali Acc: 0.266 Test Loss: 1.431 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 0.6290316581726074
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.420 Vali Acc: 0.247 Test Loss: 1.420 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7105062007904053
Epoch: 3, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.443 Vali Acc: 0.259 Test Loss: 1.443 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7268037796020508
Epoch: 4, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6950726509094238
Epoch: 5, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.422 Vali Acc: 0.224 Test Loss: 1.422 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6786763668060303
Epoch: 6, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6838967800140381
Epoch: 7, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.476 Vali Acc: 0.259 Test Loss: 1.476 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7120921611785889
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.522 Vali Acc: 0.247 Test Loss: 1.522 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7380189895629883
Epoch: 9, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.504 Vali Acc: 0.243 Test Loss: 1.504 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7388334274291992
Epoch: 10, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.537 Vali Acc: 0.262 Test Loss: 1.537 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7389137744903564
Epoch: 11, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.588 Vali Acc: 0.209 Test Loss: 1.588 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 92740
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.974588394165039
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.391 Vali Acc: 0.259 Test Loss: 1.391 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.6153368949890137
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.394 Vali Acc: 0.247 Test Loss: 1.394 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7290844917297363
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.411 Vali Acc: 0.240 Test Loss: 1.411 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6887731552124023
Epoch: 4, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.405 Vali Acc: 0.243 Test Loss: 1.405 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6756086349487305
Epoch: 5, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.415 Vali Acc: 0.236 Test Loss: 1.415 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7054860591888428
Epoch: 6, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.459 Vali Acc: 0.262 Test Loss: 1.459 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 7 cost time: 0.7420828342437744
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.471 Vali Acc: 0.243 Test Loss: 1.471 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7230298519134521
Epoch: 8, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.455 Vali Acc: 0.285 Test Loss: 1.455 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 0.7701709270477295
Epoch: 9, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.454 Vali Acc: 0.224 Test Loss: 1.454 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7211060523986816
Epoch: 10, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.555 Vali Acc: 0.259 Test Loss: 1.555 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7301366329193115
Epoch: 11, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.463 Vali Acc: 0.255 Test Loss: 1.463 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7031021118164062
Epoch: 12, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.550 Vali Acc: 0.274 Test Loss: 1.550 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6905786991119385
Epoch: 13, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.614 Vali Acc: 0.259 Test Loss: 1.614 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7934386730194092
Epoch: 14, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.632 Vali Acc: 0.255 Test Loss: 1.632 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.773784875869751
Epoch: 15, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.633 Vali Acc: 0.243 Test Loss: 1.633 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7348556518554688
Epoch: 16, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8367786407470703
Epoch: 17, Steps: 17 | Train Loss: 0.837 Vali Loss: 1.685 Vali Acc: 0.247 Test Loss: 1.685 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7476296424865723
Epoch: 18, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.778 Vali Acc: 0.251 Test Loss: 1.778 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 85572
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.117495059967041
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.392 Vali Acc: 0.247 Test Loss: 1.392 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.7445850372314453
Epoch: 2, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.400 Vali Acc: 0.236 Test Loss: 1.400 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7031514644622803
Epoch: 3, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 0.8031105995178223
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.411 Vali Acc: 0.228 Test Loss: 1.411 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7604992389678955
Epoch: 5, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.398 Vali Acc: 0.217 Test Loss: 1.398 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7417004108428955
Epoch: 6, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.448 Vali Acc: 0.209 Test Loss: 1.448 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7103438377380371
Epoch: 7, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.409 Vali Acc: 0.262 Test Loss: 1.409 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7302627563476562
Epoch: 8, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7554512023925781
Epoch: 9, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7502493858337402
Epoch: 10, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7463979721069336
Epoch: 11, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.476 Vali Acc: 0.251 Test Loss: 1.476 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7723402976989746
Epoch: 12, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.610 Vali Acc: 0.240 Test Loss: 1.610 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7425644397735596
Epoch: 13, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.533 Vali Acc: 0.297 Test Loss: 1.533 Test Acc: 0.297
Validation loss decreased (-0.269948 --> -0.296563).  Saving model ...
Epoch: 14 cost time: 0.7175016403198242
Epoch: 14, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.572 Vali Acc: 0.243 Test Loss: 1.572 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7629489898681641
Epoch: 15, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.574 Vali Acc: 0.232 Test Loss: 1.574 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.752997636795044
Epoch: 16, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7543017864227295
Epoch: 17, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.791 Vali Acc: 0.266 Test Loss: 1.791 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7154707908630371
Epoch: 18, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.694 Vali Acc: 0.251 Test Loss: 1.694 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7313675880432129
Epoch: 19, Steps: 17 | Train Loss: 0.833 Vali Loss: 1.682 Vali Acc: 0.243 Test Loss: 1.682 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.689063549041748
Epoch: 20, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.722 Vali Acc: 0.247 Test Loss: 1.722 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7232098579406738
Epoch: 21, Steps: 17 | Train Loss: 0.771 Vali Loss: 1.752 Vali Acc: 0.224 Test Loss: 1.752 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6758036613464355
Epoch: 22, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.817 Vali Acc: 0.232 Test Loss: 1.817 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6846177577972412
Epoch: 23, Steps: 17 | Train Loss: 0.729 Vali Loss: 1.849 Vali Acc: 0.236 Test Loss: 1.849 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 83012
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9171507358551025
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.383 Vali Acc: 0.312 Test Loss: 1.383 Test Acc: 0.312
Validation loss decreased (inf --> -0.311773).  Saving model ...
Epoch: 2 cost time: 0.684039831161499
Epoch: 2, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.375 Vali Acc: 0.285 Test Loss: 1.375 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.669163703918457
Epoch: 3, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.380 Vali Acc: 0.308 Test Loss: 1.380 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6719355583190918
Epoch: 4, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.379 Vali Acc: 0.270 Test Loss: 1.379 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.71565842628479
Epoch: 5, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6528873443603516
Epoch: 6, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.392 Vali Acc: 0.285 Test Loss: 1.392 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6795873641967773
Epoch: 7, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.390 Vali Acc: 0.240 Test Loss: 1.390 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6161022186279297
Epoch: 8, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.466 Vali Acc: 0.259 Test Loss: 1.466 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6435432434082031
Epoch: 9, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.422 Vali Acc: 0.259 Test Loss: 1.422 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6080806255340576
Epoch: 10, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.424 Vali Acc: 0.278 Test Loss: 1.424 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6347939968109131
Epoch: 11, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.514 Vali Acc: 0.243 Test Loss: 1.514 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 83972
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1070048809051514
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.402 Vali Acc: 0.274 Test Loss: 1.402 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.7029690742492676
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.397 Vali Acc: 0.293 Test Loss: 1.397 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292762).  Saving model ...
Epoch: 3 cost time: 0.6937572956085205
Epoch: 3, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.389 Vali Acc: 0.281 Test Loss: 1.389 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7172391414642334
Epoch: 4, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.392 Vali Acc: 0.289 Test Loss: 1.392 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6655850410461426
Epoch: 5, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.393 Vali Acc: 0.289 Test Loss: 1.393 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7060883045196533
Epoch: 6, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6700396537780762
Epoch: 7, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.406 Vali Acc: 0.289 Test Loss: 1.406 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6518354415893555
Epoch: 8, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.416 Vali Acc: 0.274 Test Loss: 1.416 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6258339881896973
Epoch: 9, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.425 Vali Acc: 0.274 Test Loss: 1.425 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6780853271484375
Epoch: 10, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.431 Vali Acc: 0.259 Test Loss: 1.431 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7100992202758789
Epoch: 11, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.452 Vali Acc: 0.297 Test Loss: 1.452 Test Acc: 0.297
Validation loss decreased (-0.292762 --> -0.296563).  Saving model ...
Epoch: 12 cost time: 0.639228105545044
Epoch: 12, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.657440185546875
Epoch: 13, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.445 Vali Acc: 0.240 Test Loss: 1.445 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6430027484893799
Epoch: 14, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.499 Vali Acc: 0.308 Test Loss: 1.499 Test Acc: 0.308
Validation loss decreased (-0.296563 --> -0.307970).  Saving model ...
Epoch: 15 cost time: 0.6991870403289795
Epoch: 15, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.486 Vali Acc: 0.262 Test Loss: 1.486 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6576492786407471
Epoch: 16, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.492 Vali Acc: 0.262 Test Loss: 1.492 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6754913330078125
Epoch: 17, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.520 Vali Acc: 0.274 Test Loss: 1.520 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7004854679107666
Epoch: 18, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.571 Vali Acc: 0.281 Test Loss: 1.571 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6252713203430176
Epoch: 19, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.544 Vali Acc: 0.255 Test Loss: 1.544 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6953380107879639
Epoch: 20, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.590 Vali Acc: 0.255 Test Loss: 1.590 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6653401851654053
Epoch: 21, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.636 Vali Acc: 0.259 Test Loss: 1.636 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7711808681488037
Epoch: 22, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.688 Vali Acc: 0.281 Test Loss: 1.688 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7037043571472168
Epoch: 23, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.718 Vali Acc: 0.262 Test Loss: 1.718 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7893528938293457
Epoch: 24, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.681 Vali Acc: 0.266 Test Loss: 1.681 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 86532
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0536911487579346
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.441 Vali Acc: 0.240 Test Loss: 1.441 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 0.6468737125396729
Epoch: 2, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.428 Vali Acc: 0.259 Test Loss: 1.428 Test Acc: 0.259
Validation loss decreased (-0.239529 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.6483392715454102
Epoch: 3, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.403 Vali Acc: 0.247 Test Loss: 1.403 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6633248329162598
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 0.686417818069458
Epoch: 5, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.403 Vali Acc: 0.255 Test Loss: 1.403 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6379392147064209
Epoch: 6, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.414 Vali Acc: 0.247 Test Loss: 1.414 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6304142475128174
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6637921333312988
Epoch: 8, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6960594654083252
Epoch: 9, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.478 Vali Acc: 0.247 Test Loss: 1.478 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6385552883148193
Epoch: 10, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.457 Vali Acc: 0.224 Test Loss: 1.457 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5958328247070312
Epoch: 11, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6019363403320312
Epoch: 12, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.524 Vali Acc: 0.266 Test Loss: 1.524 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266144).  Saving model ...
Epoch: 13 cost time: 0.6444001197814941
Epoch: 13, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.503 Vali Acc: 0.228 Test Loss: 1.503 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6567494869232178
Epoch: 14, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.479 Vali Acc: 0.240 Test Loss: 1.479 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6457223892211914
Epoch: 15, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.510 Vali Acc: 0.228 Test Loss: 1.510 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6426167488098145
Epoch: 16, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.547 Vali Acc: 0.236 Test Loss: 1.547 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.629345178604126
Epoch: 17, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.554 Vali Acc: 0.270 Test Loss: 1.554 Test Acc: 0.270
Validation loss decreased (-0.266144 --> -0.269946).  Saving model ...
Epoch: 18 cost time: 0.6637704372406006
Epoch: 18, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.571 Vali Acc: 0.243 Test Loss: 1.571 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5940902233123779
Epoch: 19, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.638 Vali Acc: 0.281 Test Loss: 1.638 Test Acc: 0.281
Validation loss decreased (-0.269946 --> -0.281352).  Saving model ...
Epoch: 20 cost time: 0.5725762844085693
Epoch: 20, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.606 Vali Acc: 0.270 Test Loss: 1.606 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6344494819641113
Epoch: 21, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.736 Vali Acc: 0.270 Test Loss: 1.736 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6500880718231201
Epoch: 22, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.701 Vali Acc: 0.236 Test Loss: 1.701 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.613476037979126
Epoch: 23, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.682 Vali Acc: 0.251 Test Loss: 1.682 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.619253396987915
Epoch: 24, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.669 Vali Acc: 0.247 Test Loss: 1.669 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6797845363616943
Epoch: 25, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.738 Vali Acc: 0.262 Test Loss: 1.738 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6660377979278564
Epoch: 26, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.841 Vali Acc: 0.262 Test Loss: 1.841 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6186614036560059
Epoch: 27, Steps: 17 | Train Loss: 0.826 Vali Loss: 1.794 Vali Acc: 0.243 Test Loss: 1.794 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6413519382476807
Epoch: 28, Steps: 17 | Train Loss: 0.822 Vali Loss: 1.863 Vali Acc: 0.262 Test Loss: 1.863 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6567387580871582
Epoch: 29, Steps: 17 | Train Loss: 0.753 Vali Loss: 1.869 Vali Acc: 0.270 Test Loss: 1.869 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 90564
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0504608154296875
Epoch: 1, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.419 Vali Acc: 0.247 Test Loss: 1.419 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.6687757968902588
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 0.6285569667816162
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.396 Vali Acc: 0.266 Test Loss: 1.396 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 0.6805887222290039
Epoch: 4, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.421 Vali Acc: 0.255 Test Loss: 1.421 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7288205623626709
Epoch: 5, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6604936122894287
Epoch: 6, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 0.7260973453521729
Epoch: 7, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.479 Vali Acc: 0.262 Test Loss: 1.479 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7318787574768066
Epoch: 8, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.488 Vali Acc: 0.278 Test Loss: 1.488 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 0.712444543838501
Epoch: 9, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.589 Vali Acc: 0.262 Test Loss: 1.589 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7076277732849121
Epoch: 10, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.560 Vali Acc: 0.293 Test Loss: 1.560 Test Acc: 0.293
Validation loss decreased (-0.277552 --> -0.292760).  Saving model ...
Epoch: 11 cost time: 0.7045338153839111
Epoch: 11, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.589 Vali Acc: 0.266 Test Loss: 1.589 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7008705139160156
Epoch: 12, Steps: 17 | Train Loss: 0.866 Vali Loss: 1.674 Vali Acc: 0.255 Test Loss: 1.674 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7145085334777832
Epoch: 13, Steps: 17 | Train Loss: 0.823 Vali Loss: 1.648 Vali Acc: 0.278 Test Loss: 1.648 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7353208065032959
Epoch: 14, Steps: 17 | Train Loss: 0.784 Vali Loss: 1.760 Vali Acc: 0.270 Test Loss: 1.760 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6878266334533691
Epoch: 15, Steps: 17 | Train Loss: 0.772 Vali Loss: 1.842 Vali Acc: 0.259 Test Loss: 1.842 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6942312717437744
Epoch: 16, Steps: 17 | Train Loss: 0.705 Vali Loss: 1.867 Vali Acc: 0.266 Test Loss: 1.867 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7421069145202637
Epoch: 17, Steps: 17 | Train Loss: 0.702 Vali Loss: 1.931 Vali Acc: 0.316 Test Loss: 1.931 Test Acc: 0.316
Validation loss decreased (-0.292760 --> -0.315570).  Saving model ...
Epoch: 18 cost time: 0.7347087860107422
Epoch: 18, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.946 Vali Acc: 0.285 Test Loss: 1.946 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7003235816955566
Epoch: 19, Steps: 17 | Train Loss: 0.653 Vali Loss: 1.990 Vali Acc: 0.281 Test Loss: 1.990 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6685094833374023
Epoch: 20, Steps: 17 | Train Loss: 0.632 Vali Loss: 2.062 Vali Acc: 0.300 Test Loss: 2.062 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7094252109527588
Epoch: 21, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.159 Vali Acc: 0.281 Test Loss: 2.159 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6692261695861816
Epoch: 22, Steps: 17 | Train Loss: 0.602 Vali Loss: 2.199 Vali Acc: 0.304 Test Loss: 2.199 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6927940845489502
Epoch: 23, Steps: 17 | Train Loss: 0.574 Vali Loss: 2.302 Vali Acc: 0.281 Test Loss: 2.302 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7208960056304932
Epoch: 24, Steps: 17 | Train Loss: 0.552 Vali Loss: 2.359 Vali Acc: 0.278 Test Loss: 2.359 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7124903202056885
Epoch: 25, Steps: 17 | Train Loss: 0.535 Vali Loss: 2.256 Vali Acc: 0.304 Test Loss: 2.256 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7293829917907715
Epoch: 26, Steps: 17 | Train Loss: 0.516 Vali Loss: 2.525 Vali Acc: 0.255 Test Loss: 2.525 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7504992485046387
Epoch: 27, Steps: 17 | Train Loss: 0.522 Vali Loss: 2.439 Vali Acc: 0.297 Test Loss: 2.439 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 48036
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.109943151473999
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.403 Vali Acc: 0.281 Test Loss: 1.403 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 0.6915342807769775
Epoch: 2, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.410 Vali Acc: 0.278 Test Loss: 1.410 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6818416118621826
Epoch: 3, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7166306972503662
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.403 Vali Acc: 0.247 Test Loss: 1.403 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6916553974151611
Epoch: 5, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7294840812683105
Epoch: 6, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.430 Vali Acc: 0.255 Test Loss: 1.430 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7500674724578857
Epoch: 7, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.420 Vali Acc: 0.259 Test Loss: 1.420 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.721473217010498
Epoch: 8, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.440 Vali Acc: 0.243 Test Loss: 1.440 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7258076667785645
Epoch: 9, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.467 Vali Acc: 0.232 Test Loss: 1.467 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7108490467071533
Epoch: 10, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.458 Vali Acc: 0.255 Test Loss: 1.458 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6866083145141602
Epoch: 11, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.494 Vali Acc: 0.255 Test Loss: 1.494 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 34084
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.061673879623413
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.6839015483856201
Epoch: 2, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.400 Vali Acc: 0.236 Test Loss: 1.400 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6991994380950928
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.401 Vali Acc: 0.228 Test Loss: 1.401 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6869668960571289
Epoch: 4, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.411 Vali Acc: 0.213 Test Loss: 1.411 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6654176712036133
Epoch: 5, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.426 Vali Acc: 0.232 Test Loss: 1.426 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7304232120513916
Epoch: 6, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.434 Vali Acc: 0.209 Test Loss: 1.434 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6929137706756592
Epoch: 7, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.430 Vali Acc: 0.209 Test Loss: 1.430 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7673642635345459
Epoch: 8, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.455 Vali Acc: 0.228 Test Loss: 1.455 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6902906894683838
Epoch: 9, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.472 Vali Acc: 0.228 Test Loss: 1.472 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7170417308807373
Epoch: 10, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.465 Vali Acc: 0.198 Test Loss: 1.465 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6828477382659912
Epoch: 11, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.502 Vali Acc: 0.205 Test Loss: 1.502 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.24334600760456274
model parameter : 30500
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0900216102600098
Epoch: 1, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.414 Vali Acc: 0.274 Test Loss: 1.414 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.6860678195953369
Epoch: 2, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.384 Vali Acc: 0.281 Test Loss: 1.384 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.6649575233459473
Epoch: 3, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.393 Vali Acc: 0.247 Test Loss: 1.393 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6896238327026367
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.386 Vali Acc: 0.251 Test Loss: 1.386 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7215757369995117
Epoch: 5, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.390 Vali Acc: 0.278 Test Loss: 1.390 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.687758207321167
Epoch: 6, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.393 Vali Acc: 0.247 Test Loss: 1.393 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7015714645385742
Epoch: 7, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.404 Vali Acc: 0.236 Test Loss: 1.404 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.750298261642456
Epoch: 8, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7222516536712646
Epoch: 9, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.397 Vali Acc: 0.251 Test Loss: 1.397 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6863064765930176
Epoch: 10, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.401 Vali Acc: 0.251 Test Loss: 1.401 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7052426338195801
Epoch: 11, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.421 Vali Acc: 0.278 Test Loss: 1.421 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7207417488098145
Epoch: 12, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.416 Vali Acc: 0.293 Test Loss: 1.416 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292762).  Saving model ...
Epoch: 13 cost time: 0.725379228591919
Epoch: 13, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.409 Vali Acc: 0.285 Test Loss: 1.409 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7472977638244629
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.429 Vali Acc: 0.240 Test Loss: 1.429 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6800177097320557
Epoch: 15, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.481 Vali Acc: 0.270 Test Loss: 1.481 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7061853408813477
Epoch: 16, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.439 Vali Acc: 0.255 Test Loss: 1.439 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7079155445098877
Epoch: 17, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.457 Vali Acc: 0.266 Test Loss: 1.457 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7312729358673096
Epoch: 18, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.464 Vali Acc: 0.228 Test Loss: 1.464 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7900784015655518
Epoch: 19, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.485 Vali Acc: 0.259 Test Loss: 1.485 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6857907772064209
Epoch: 20, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.538 Vali Acc: 0.247 Test Loss: 1.538 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6689717769622803
Epoch: 21, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.485 Vali Acc: 0.281 Test Loss: 1.485 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6671912670135498
Epoch: 22, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.533 Vali Acc: 0.274 Test Loss: 1.533 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 29220
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.8588707447052002
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.391 Vali Acc: 0.259 Test Loss: 1.391 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7053368091583252
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.389 Vali Acc: 0.224 Test Loss: 1.389 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7470431327819824
Epoch: 3, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.391 Vali Acc: 0.224 Test Loss: 1.391 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9267375469207764
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.409 Vali Acc: 0.251 Test Loss: 1.409 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6931793689727783
Epoch: 5, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.414 Vali Acc: 0.259 Test Loss: 1.414 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6982059478759766
Epoch: 6, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7286849021911621
Epoch: 7, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.423 Vali Acc: 0.259 Test Loss: 1.423 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8441910743713379
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.414 Vali Acc: 0.266 Test Loss: 1.414 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 9 cost time: 0.742478609085083
Epoch: 9, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.431 Vali Acc: 0.274 Test Loss: 1.431 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 0.8108277320861816
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.424 Vali Acc: 0.247 Test Loss: 1.424 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.729893684387207
Epoch: 11, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6962580680847168
Epoch: 12, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.475 Vali Acc: 0.251 Test Loss: 1.475 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7291412353515625
Epoch: 13, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.425 Vali Acc: 0.255 Test Loss: 1.425 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7492506504058838
Epoch: 14, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.454 Vali Acc: 0.247 Test Loss: 1.454 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7262852191925049
Epoch: 15, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.426 Vali Acc: 0.259 Test Loss: 1.426 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6936438083648682
Epoch: 16, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.454 Vali Acc: 0.209 Test Loss: 1.454 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6965014934539795
Epoch: 17, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.485 Vali Acc: 0.262 Test Loss: 1.485 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7299027442932129
Epoch: 18, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.474 Vali Acc: 0.255 Test Loss: 1.474 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6832375526428223
Epoch: 19, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.487 Vali Acc: 0.251 Test Loss: 1.487 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 29700
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9798240661621094
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.436 Vali Acc: 0.224 Test Loss: 1.436 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 0.7076044082641602
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.397 Vali Acc: 0.236 Test Loss: 1.397 Test Acc: 0.236
Validation loss decreased (-0.224320 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 0.7313113212585449
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.388 Vali Acc: 0.232 Test Loss: 1.388 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6940417289733887
Epoch: 4, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
Validation loss decreased (-0.235727 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 0.6716892719268799
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.396 Vali Acc: 0.266 Test Loss: 1.396 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 6 cost time: 0.6613454818725586
Epoch: 6, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.406 Vali Acc: 0.213 Test Loss: 1.406 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6347260475158691
Epoch: 7, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.396 Vali Acc: 0.224 Test Loss: 1.396 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.670635461807251
Epoch: 8, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.411 Vali Acc: 0.221 Test Loss: 1.411 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7195050716400146
Epoch: 9, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.401 Vali Acc: 0.232 Test Loss: 1.401 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7422754764556885
Epoch: 10, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6678183078765869
Epoch: 11, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.426 Vali Acc: 0.266 Test Loss: 1.426 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6661412715911865
Epoch: 12, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.423 Vali Acc: 0.240 Test Loss: 1.423 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6550328731536865
Epoch: 13, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6504454612731934
Epoch: 14, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.442 Vali Acc: 0.255 Test Loss: 1.442 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6467902660369873
Epoch: 15, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 30980
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0722496509552
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.431 Vali Acc: 0.221 Test Loss: 1.431 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 0.6643064022064209
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
Validation loss decreased (-0.220518 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 0.6762716770172119
Epoch: 3, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.419 Vali Acc: 0.274 Test Loss: 1.419 Test Acc: 0.274
Validation loss decreased (-0.243332 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.6593539714813232
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.398 Vali Acc: 0.316 Test Loss: 1.398 Test Acc: 0.316
Validation loss decreased (-0.273750 --> -0.315575).  Saving model ...
Epoch: 5 cost time: 0.697498083114624
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.411 Vali Acc: 0.259 Test Loss: 1.411 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7066121101379395
Epoch: 6, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.406 Vali Acc: 0.240 Test Loss: 1.406 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6973404884338379
Epoch: 7, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6668784618377686
Epoch: 8, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.413 Vali Acc: 0.232 Test Loss: 1.413 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6524965763092041
Epoch: 9, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.408 Vali Acc: 0.262 Test Loss: 1.408 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6726469993591309
Epoch: 10, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.441 Vali Acc: 0.243 Test Loss: 1.441 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6538033485412598
Epoch: 11, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.442 Vali Acc: 0.213 Test Loss: 1.442 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5986297130584717
Epoch: 12, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.415 Vali Acc: 0.259 Test Loss: 1.415 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6562168598175049
Epoch: 13, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.420 Vali Acc: 0.236 Test Loss: 1.420 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6898548603057861
Epoch: 14, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.491 Vali Acc: 0.247 Test Loss: 1.491 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 32996
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.188154458999634
Epoch: 1, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.390 Vali Acc: 0.266 Test Loss: 1.390 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 0.9543085098266602
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9520385265350342
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.385 Vali Acc: 0.251 Test Loss: 1.385 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9575614929199219
Epoch: 4, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.397 Vali Acc: 0.281 Test Loss: 1.397 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 0.9382412433624268
Epoch: 5, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.435 Vali Acc: 0.255 Test Loss: 1.435 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9690968990325928
Epoch: 6, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.435 Vali Acc: 0.274 Test Loss: 1.435 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9290318489074707
Epoch: 7, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.436 Vali Acc: 0.251 Test Loss: 1.436 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9329471588134766
Epoch: 8, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.427 Vali Acc: 0.285 Test Loss: 1.427 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 0.9085402488708496
Epoch: 9, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.485 Vali Acc: 0.285 Test Loss: 1.485 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9405531883239746
Epoch: 10, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.514 Vali Acc: 0.266 Test Loss: 1.514 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.958549976348877
Epoch: 11, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.535 Vali Acc: 0.278 Test Loss: 1.535 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9454472064971924
Epoch: 12, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.623 Vali Acc: 0.323 Test Loss: 1.623 Test Acc: 0.323
Validation loss decreased (-0.285157 --> -0.323178).  Saving model ...
Epoch: 13 cost time: 1.0053884983062744
Epoch: 13, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.633 Vali Acc: 0.304 Test Loss: 1.633 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9273087978363037
Epoch: 14, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.722 Vali Acc: 0.308 Test Loss: 1.722 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9780237674713135
Epoch: 15, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.702 Vali Acc: 0.304 Test Loss: 1.702 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9087376594543457
Epoch: 16, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.889 Vali Acc: 0.270 Test Loss: 1.889 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9646735191345215
Epoch: 17, Steps: 17 | Train Loss: 0.724 Vali Loss: 2.034 Vali Acc: 0.297 Test Loss: 2.034 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9339675903320312
Epoch: 18, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.005 Vali Acc: 0.266 Test Loss: 2.005 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9642879962921143
Epoch: 19, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.043 Vali Acc: 0.304 Test Loss: 2.043 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9294993877410889
Epoch: 20, Steps: 17 | Train Loss: 0.634 Vali Loss: 2.209 Vali Acc: 0.297 Test Loss: 2.209 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9711120128631592
Epoch: 21, Steps: 17 | Train Loss: 0.631 Vali Loss: 2.345 Vali Acc: 0.274 Test Loss: 2.345 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9433867931365967
Epoch: 22, Steps: 17 | Train Loss: 0.604 Vali Loss: 2.416 Vali Acc: 0.266 Test Loss: 2.416 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 204068
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.294577121734619
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.394 Vali Acc: 0.251 Test Loss: 1.394 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.8258821964263916
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.388 Vali Acc: 0.236 Test Loss: 1.388 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9296579360961914
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.390 Vali Acc: 0.247 Test Loss: 1.390 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9501171112060547
Epoch: 4, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.398 Vali Acc: 0.224 Test Loss: 1.398 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8688454627990723
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.400 Vali Acc: 0.221 Test Loss: 1.400 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9175980091094971
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.401 Vali Acc: 0.217 Test Loss: 1.401 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8777587413787842
Epoch: 7, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.398 Vali Acc: 0.236 Test Loss: 1.398 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.985567569732666
Epoch: 8, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.428 Vali Acc: 0.259 Test Loss: 1.428 Test Acc: 0.259
Validation loss decreased (-0.250937 --> -0.258541).  Saving model ...
Epoch: 9 cost time: 0.9289290904998779
Epoch: 9, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.428 Vali Acc: 0.251 Test Loss: 1.428 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9550485610961914
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.444 Vali Acc: 0.262 Test Loss: 1.444 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 11 cost time: 0.9086167812347412
Epoch: 11, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.456 Vali Acc: 0.251 Test Loss: 1.456 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9347872734069824
Epoch: 12, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.513 Vali Acc: 0.281 Test Loss: 1.513 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281354).  Saving model ...
Epoch: 13 cost time: 0.916959285736084
Epoch: 13, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.504 Vali Acc: 0.240 Test Loss: 1.504 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9565079212188721
Epoch: 14, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.535 Vali Acc: 0.259 Test Loss: 1.535 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9245913028717041
Epoch: 15, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.564 Vali Acc: 0.255 Test Loss: 1.564 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9506618976593018
Epoch: 16, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.589 Vali Acc: 0.251 Test Loss: 1.589 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.942979097366333
Epoch: 17, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.638 Vali Acc: 0.289 Test Loss: 1.638 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288957).  Saving model ...
Epoch: 18 cost time: 0.9000270366668701
Epoch: 18, Steps: 17 | Train Loss: 0.863 Vali Loss: 1.675 Vali Acc: 0.240 Test Loss: 1.675 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9132106304168701
Epoch: 19, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.806 Vali Acc: 0.262 Test Loss: 1.806 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8602762222290039
Epoch: 20, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.783 Vali Acc: 0.262 Test Loss: 1.783 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9326109886169434
Epoch: 21, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.866 Vali Acc: 0.247 Test Loss: 1.866 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9650833606719971
Epoch: 22, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.881 Vali Acc: 0.281 Test Loss: 1.881 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.930870532989502
Epoch: 23, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.990 Vali Acc: 0.278 Test Loss: 1.990 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9435021877288818
Epoch: 24, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.103 Vali Acc: 0.266 Test Loss: 2.103 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9422564506530762
Epoch: 25, Steps: 17 | Train Loss: 0.712 Vali Loss: 2.183 Vali Acc: 0.266 Test Loss: 2.183 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0408265590667725
Epoch: 26, Steps: 17 | Train Loss: 0.664 Vali Loss: 2.210 Vali Acc: 0.278 Test Loss: 2.210 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8820459842681885
Epoch: 27, Steps: 17 | Train Loss: 0.631 Vali Loss: 2.332 Vali Acc: 0.274 Test Loss: 2.332 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 190116
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4906516075134277
Epoch: 1, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.414 Vali Acc: 0.247 Test Loss: 1.414 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.9570977687835693
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.393 Vali Acc: 0.259 Test Loss: 1.393 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.9575726985931396
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.402 Vali Acc: 0.255 Test Loss: 1.402 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9766252040863037
Epoch: 4, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9869875907897949
Epoch: 5, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9488999843597412
Epoch: 6, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.400 Vali Acc: 0.247 Test Loss: 1.400 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9902286529541016
Epoch: 7, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 8 cost time: 1.007002830505371
Epoch: 8, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9824659824371338
Epoch: 9, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.446 Vali Acc: 0.251 Test Loss: 1.446 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9017589092254639
Epoch: 10, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.452 Vali Acc: 0.289 Test Loss: 1.452 Test Acc: 0.289
Validation loss decreased (-0.266146 --> -0.288959).  Saving model ...
Epoch: 11 cost time: 1.0025453567504883
Epoch: 11, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.466 Vali Acc: 0.243 Test Loss: 1.466 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0205085277557373
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.467 Vali Acc: 0.262 Test Loss: 1.467 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9785032272338867
Epoch: 13, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.483 Vali Acc: 0.266 Test Loss: 1.483 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0104038715362549
Epoch: 14, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.556 Vali Acc: 0.259 Test Loss: 1.556 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0268759727478027
Epoch: 15, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.547 Vali Acc: 0.247 Test Loss: 1.547 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0087308883666992
Epoch: 16, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.544 Vali Acc: 0.224 Test Loss: 1.544 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.012300729751587
Epoch: 17, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.580 Vali Acc: 0.247 Test Loss: 1.580 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0712933540344238
Epoch: 18, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.618 Vali Acc: 0.259 Test Loss: 1.618 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0270140171051025
Epoch: 19, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.642 Vali Acc: 0.270 Test Loss: 1.642 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0056488513946533
Epoch: 20, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.666 Vali Acc: 0.247 Test Loss: 1.666 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 186916
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2793331146240234
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 0.9177796840667725
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.393 Vali Acc: 0.243 Test Loss: 1.393 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9587345123291016
Epoch: 3, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.389 Vali Acc: 0.312 Test Loss: 1.389 Test Acc: 0.312
Validation loss decreased (-0.250936 --> -0.311773).  Saving model ...
Epoch: 4 cost time: 1.003767490386963
Epoch: 4, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9635493755340576
Epoch: 5, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.397 Vali Acc: 0.251 Test Loss: 1.397 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9449844360351562
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.393 Vali Acc: 0.285 Test Loss: 1.393 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9761233329772949
Epoch: 7, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.414 Vali Acc: 0.266 Test Loss: 1.414 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9273500442504883
Epoch: 8, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.406 Vali Acc: 0.274 Test Loss: 1.406 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8949921131134033
Epoch: 9, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.414 Vali Acc: 0.266 Test Loss: 1.414 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7961232662200928
Epoch: 10, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9195737838745117
Epoch: 11, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.413 Vali Acc: 0.243 Test Loss: 1.413 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9016306400299072
Epoch: 12, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.435 Vali Acc: 0.266 Test Loss: 1.435 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9265387058258057
Epoch: 13, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.475 Vali Acc: 0.251 Test Loss: 1.475 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 185252
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.399609327316284
Epoch: 1, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.388 Vali Acc: 0.270 Test Loss: 1.388 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 0.9462680816650391
Epoch: 2, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.382 Vali Acc: 0.243 Test Loss: 1.382 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9564864635467529
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.380 Vali Acc: 0.255 Test Loss: 1.380 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9747507572174072
Epoch: 4, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.387 Vali Acc: 0.266 Test Loss: 1.387 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9801714420318604
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.390 Vali Acc: 0.236 Test Loss: 1.390 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8904612064361572
Epoch: 6, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (-0.269948 --> -0.269948).  Saving model ...
Epoch: 7 cost time: 0.91025710105896
Epoch: 7, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.390 Vali Acc: 0.255 Test Loss: 1.390 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9969420433044434
Epoch: 8, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8745615482330322
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.398 Vali Acc: 0.251 Test Loss: 1.398 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.918297290802002
Epoch: 10, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.430 Vali Acc: 0.240 Test Loss: 1.430 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9017200469970703
Epoch: 11, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.899970531463623
Epoch: 12, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.442 Vali Acc: 0.281 Test Loss: 1.442 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281354).  Saving model ...
Epoch: 13 cost time: 0.8982000350952148
Epoch: 13, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.448 Vali Acc: 0.266 Test Loss: 1.448 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8842384815216064
Epoch: 14, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.503 Vali Acc: 0.243 Test Loss: 1.503 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8621664047241211
Epoch: 15, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.474 Vali Acc: 0.266 Test Loss: 1.474 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9287247657775879
Epoch: 16, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.525 Vali Acc: 0.243 Test Loss: 1.525 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9642283916473389
Epoch: 17, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.540 Vali Acc: 0.236 Test Loss: 1.540 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9651589393615723
Epoch: 18, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.583 Vali Acc: 0.232 Test Loss: 1.583 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9762980937957764
Epoch: 19, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9760646820068359
Epoch: 20, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.643 Vali Acc: 0.217 Test Loss: 1.643 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9551973342895508
Epoch: 21, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.673 Vali Acc: 0.259 Test Loss: 1.673 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9590573310852051
Epoch: 22, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.651 Vali Acc: 0.262 Test Loss: 1.651 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 186500
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.35518217086792
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.393 Vali Acc: 0.255 Test Loss: 1.393 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.9779694080352783
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.393 Vali Acc: 0.281 Test Loss: 1.393 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.985947847366333
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.388 Vali Acc: 0.255 Test Loss: 1.388 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.04591703414917
Epoch: 4, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9918253421783447
Epoch: 5, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.401 Vali Acc: 0.278 Test Loss: 1.401 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.026569128036499
Epoch: 6, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.412 Vali Acc: 0.240 Test Loss: 1.412 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0083942413330078
Epoch: 7, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.419 Vali Acc: 0.289 Test Loss: 1.419 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288959).  Saving model ...
Epoch: 8 cost time: 0.9485805034637451
Epoch: 8, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.424 Vali Acc: 0.262 Test Loss: 1.424 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0039520263671875
Epoch: 9, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9644894599914551
Epoch: 10, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.434 Vali Acc: 0.243 Test Loss: 1.434 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0107486248016357
Epoch: 11, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.441 Vali Acc: 0.262 Test Loss: 1.441 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1136159896850586
Epoch: 12, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.470 Vali Acc: 0.259 Test Loss: 1.470 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0321590900421143
Epoch: 13, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.467 Vali Acc: 0.243 Test Loss: 1.467 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.943129301071167
Epoch: 14, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.490 Vali Acc: 0.240 Test Loss: 1.490 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9694931507110596
Epoch: 15, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.494 Vali Acc: 0.262 Test Loss: 1.494 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9340121746063232
Epoch: 16, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.487 Vali Acc: 0.266 Test Loss: 1.487 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9634835720062256
Epoch: 17, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.560 Vali Acc: 0.262 Test Loss: 1.560 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 187780
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2537035942077637
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (inf --> -0.296564).  Saving model ...
Epoch: 2 cost time: 0.9101767539978027
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.382 Vali Acc: 0.278 Test Loss: 1.382 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9357495307922363
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.382 Vali Acc: 0.289 Test Loss: 1.382 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9513447284698486
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.390 Vali Acc: 0.278 Test Loss: 1.390 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.943892240524292
Epoch: 5, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.382 Vali Acc: 0.274 Test Loss: 1.382 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9508390426635742
Epoch: 6, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.388 Vali Acc: 0.259 Test Loss: 1.388 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8732171058654785
Epoch: 7, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.401 Vali Acc: 0.236 Test Loss: 1.401 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9555680751800537
Epoch: 8, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.398 Vali Acc: 0.251 Test Loss: 1.398 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9131724834442139
Epoch: 9, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9498918056488037
Epoch: 10, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.397 Vali Acc: 0.255 Test Loss: 1.397 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0713655948638916
Epoch: 11, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.423 Vali Acc: 0.224 Test Loss: 1.423 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 189028
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4685115814208984
Epoch: 1, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.418 Vali Acc: 0.247 Test Loss: 1.418 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.8841416835784912
Epoch: 2, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.393 Vali Acc: 0.251 Test Loss: 1.393 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 0.8736822605133057
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
Validation loss decreased (-0.250937 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 0.8937032222747803
Epoch: 4, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8988027572631836
Epoch: 5, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.411 Vali Acc: 0.247 Test Loss: 1.411 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8801181316375732
Epoch: 6, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.442 Vali Acc: 0.232 Test Loss: 1.442 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8219811916351318
Epoch: 7, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.474 Vali Acc: 0.251 Test Loss: 1.474 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9928114414215088
Epoch: 8, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9905691146850586
Epoch: 9, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.466 Vali Acc: 0.274 Test Loss: 1.466 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 0.9912583827972412
Epoch: 10, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.562 Vali Acc: 0.266 Test Loss: 1.562 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9622368812561035
Epoch: 11, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.558 Vali Acc: 0.266 Test Loss: 1.558 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.965395450592041
Epoch: 12, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.654 Vali Acc: 0.289 Test Loss: 1.654 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288957).  Saving model ...
Epoch: 13 cost time: 1.0109796524047852
Epoch: 13, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.591 Vali Acc: 0.304 Test Loss: 1.591 Test Acc: 0.304
Validation loss decreased (-0.288957 --> -0.304167).  Saving model ...
Epoch: 14 cost time: 1.048830270767212
Epoch: 14, Steps: 17 | Train Loss: 0.804 Vali Loss: 1.666 Vali Acc: 0.278 Test Loss: 1.666 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9061894416809082
Epoch: 15, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.831 Vali Acc: 0.270 Test Loss: 1.831 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.015742540359497
Epoch: 16, Steps: 17 | Train Loss: 0.765 Vali Loss: 1.788 Vali Acc: 0.266 Test Loss: 1.788 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.91774582862854
Epoch: 17, Steps: 17 | Train Loss: 0.723 Vali Loss: 2.013 Vali Acc: 0.293 Test Loss: 2.013 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0101864337921143
Epoch: 18, Steps: 17 | Train Loss: 0.756 Vali Loss: 2.152 Vali Acc: 0.259 Test Loss: 2.152 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9706437587738037
Epoch: 19, Steps: 17 | Train Loss: 0.683 Vali Loss: 2.172 Vali Acc: 0.293 Test Loss: 2.172 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.007314920425415
Epoch: 20, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.293 Vali Acc: 0.278 Test Loss: 2.293 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9995720386505127
Epoch: 21, Steps: 17 | Train Loss: 0.595 Vali Loss: 2.532 Vali Acc: 0.289 Test Loss: 2.532 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9922094345092773
Epoch: 22, Steps: 17 | Train Loss: 0.617 Vali Loss: 2.534 Vali Acc: 0.262 Test Loss: 2.534 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0841412544250488
Epoch: 23, Steps: 17 | Train Loss: 0.541 Vali Loss: 2.729 Vali Acc: 0.262 Test Loss: 2.729 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 201380
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.332312822341919
Epoch: 1, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.389 Vali Acc: 0.259 Test Loss: 1.389 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.9898538589477539
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.379 Vali Acc: 0.259 Test Loss: 1.379 Test Acc: 0.259
Validation loss decreased (-0.258541 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.9065628051757812
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.382 Vali Acc: 0.243 Test Loss: 1.382 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9637088775634766
Epoch: 4, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9021964073181152
Epoch: 5, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.392 Vali Acc: 0.274 Test Loss: 1.392 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 0.8936939239501953
Epoch: 6, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.396 Vali Acc: 0.221 Test Loss: 1.396 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9431469440460205
Epoch: 7, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.403 Vali Acc: 0.259 Test Loss: 1.403 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9548437595367432
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 0.9118852615356445
Epoch: 9, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.424 Vali Acc: 0.262 Test Loss: 1.424 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9375894069671631
Epoch: 10, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.409 Vali Acc: 0.278 Test Loss: 1.409 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277552).  Saving model ...
Epoch: 11 cost time: 0.954207181930542
Epoch: 11, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.445 Vali Acc: 0.259 Test Loss: 1.445 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9568591117858887
Epoch: 12, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.482 Vali Acc: 0.259 Test Loss: 1.482 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9883079528808594
Epoch: 13, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.469 Vali Acc: 0.240 Test Loss: 1.469 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9410653114318848
Epoch: 14, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.513 Vali Acc: 0.243 Test Loss: 1.513 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9098162651062012
Epoch: 15, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.547 Vali Acc: 0.259 Test Loss: 1.547 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8718960285186768
Epoch: 16, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.619 Vali Acc: 0.255 Test Loss: 1.619 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9150705337524414
Epoch: 17, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.643 Vali Acc: 0.293 Test Loss: 1.643 Test Acc: 0.293
Validation loss decreased (-0.277552 --> -0.292759).  Saving model ...
Epoch: 18 cost time: 0.9818754196166992
Epoch: 18, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.655 Vali Acc: 0.247 Test Loss: 1.655 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9747371673583984
Epoch: 19, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.717 Vali Acc: 0.262 Test Loss: 1.717 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0189340114593506
Epoch: 20, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.687 Vali Acc: 0.243 Test Loss: 1.687 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9177682399749756
Epoch: 21, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.825 Vali Acc: 0.285 Test Loss: 1.825 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.004636287689209
Epoch: 22, Steps: 17 | Train Loss: 0.746 Vali Loss: 1.939 Vali Acc: 0.274 Test Loss: 1.939 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9321339130401611
Epoch: 23, Steps: 17 | Train Loss: 0.763 Vali Loss: 1.945 Vali Acc: 0.259 Test Loss: 1.945 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.941859245300293
Epoch: 24, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.041 Vali Acc: 0.255 Test Loss: 2.041 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9790921211242676
Epoch: 25, Steps: 17 | Train Loss: 0.659 Vali Loss: 2.142 Vali Acc: 0.251 Test Loss: 2.142 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9266655445098877
Epoch: 26, Steps: 17 | Train Loss: 0.657 Vali Loss: 2.239 Vali Acc: 0.274 Test Loss: 2.239 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.868121862411499
Epoch: 27, Steps: 17 | Train Loss: 0.660 Vali Loss: 2.272 Vali Acc: 0.266 Test Loss: 2.272 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 187428
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1956160068511963
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.393 Vali Acc: 0.224 Test Loss: 1.393 Test Acc: 0.224
Validation loss decreased (inf --> -0.224321).  Saving model ...
Epoch: 2 cost time: 0.9317207336425781
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.391 Vali Acc: 0.232 Test Loss: 1.391 Test Acc: 0.232
Validation loss decreased (-0.224321 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.035447597503662
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.383 Vali Acc: 0.232 Test Loss: 1.383 Test Acc: 0.232
Validation loss decreased (-0.231925 --> -0.231925).  Saving model ...
Epoch: 4 cost time: 0.990534782409668
Epoch: 4, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.392 Vali Acc: 0.251 Test Loss: 1.392 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250937).  Saving model ...
Epoch: 5 cost time: 0.9699223041534424
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.962592601776123
Epoch: 6, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.392 Vali Acc: 0.251 Test Loss: 1.392 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0766899585723877
Epoch: 7, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.408 Vali Acc: 0.278 Test Loss: 1.408 Test Acc: 0.278
Validation loss decreased (-0.250937 --> -0.277552).  Saving model ...
Epoch: 8 cost time: 0.9366698265075684
Epoch: 8, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.421 Vali Acc: 0.266 Test Loss: 1.421 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9725210666656494
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.436 Vali Acc: 0.262 Test Loss: 1.436 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9554693698883057
Epoch: 10, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9292137622833252
Epoch: 11, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.451 Vali Acc: 0.240 Test Loss: 1.451 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9470734596252441
Epoch: 12, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.498 Vali Acc: 0.259 Test Loss: 1.498 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9135415554046631
Epoch: 13, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.495 Vali Acc: 0.224 Test Loss: 1.495 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9052965641021729
Epoch: 14, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.497 Vali Acc: 0.247 Test Loss: 1.497 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9322829246520996
Epoch: 15, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.526 Vali Acc: 0.228 Test Loss: 1.526 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.018435001373291
Epoch: 16, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.582 Vali Acc: 0.228 Test Loss: 1.582 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.006124496459961
Epoch: 17, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.623 Vali Acc: 0.243 Test Loss: 1.623 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 184228
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.441746711730957
Epoch: 1, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.386 Vali Acc: 0.232 Test Loss: 1.386 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 0.9263007640838623
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.378 Vali Acc: 0.281 Test Loss: 1.378 Test Acc: 0.281
Validation loss decreased (-0.231925 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.0253722667694092
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.376 Vali Acc: 0.274 Test Loss: 1.376 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0136873722076416
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.380 Vali Acc: 0.274 Test Loss: 1.380 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9553830623626709
Epoch: 5, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.381 Vali Acc: 0.270 Test Loss: 1.381 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9711205959320068
Epoch: 6, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.394 Vali Acc: 0.262 Test Loss: 1.394 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9611456394195557
Epoch: 7, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.387 Vali Acc: 0.274 Test Loss: 1.387 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0082132816314697
Epoch: 8, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296564).  Saving model ...
Epoch: 9 cost time: 0.9985575675964355
Epoch: 9, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.405 Vali Acc: 0.259 Test Loss: 1.405 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9634110927581787
Epoch: 10, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.436 Vali Acc: 0.270 Test Loss: 1.436 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9629104137420654
Epoch: 11, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.407 Vali Acc: 0.289 Test Loss: 1.407 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9496703147888184
Epoch: 12, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.462 Vali Acc: 0.281 Test Loss: 1.462 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.922161340713501
Epoch: 13, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.445 Vali Acc: 0.259 Test Loss: 1.445 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9428913593292236
Epoch: 14, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.472 Vali Acc: 0.266 Test Loss: 1.472 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.925729513168335
Epoch: 15, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.472 Vali Acc: 0.289 Test Loss: 1.472 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.920543909072876
Epoch: 16, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.493 Vali Acc: 0.281 Test Loss: 1.493 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9859066009521484
Epoch: 17, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.511 Vali Acc: 0.274 Test Loss: 1.511 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9709911346435547
Epoch: 18, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.538 Vali Acc: 0.278 Test Loss: 1.538 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 182564
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.099963903427124
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.9289524555206299
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.389 Vali Acc: 0.236 Test Loss: 1.389 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9763166904449463
Epoch: 3, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.398 Vali Acc: 0.255 Test Loss: 1.398 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 0.8819875717163086
Epoch: 4, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.392 Vali Acc: 0.228 Test Loss: 1.392 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9338803291320801
Epoch: 5, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.397 Vali Acc: 0.262 Test Loss: 1.397 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 1.0106334686279297
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.395 Vali Acc: 0.274 Test Loss: 1.395 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 0.9497764110565186
Epoch: 7, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9725453853607178
Epoch: 8, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.397 Vali Acc: 0.262 Test Loss: 1.397 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9520199298858643
Epoch: 9, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277553).  Saving model ...
Epoch: 10 cost time: 0.9092321395874023
Epoch: 10, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.401 Vali Acc: 0.270 Test Loss: 1.401 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.911027193069458
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.420 Vali Acc: 0.274 Test Loss: 1.420 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9823133945465088
Epoch: 12, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.423 Vali Acc: 0.274 Test Loss: 1.423 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8856825828552246
Epoch: 13, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.430 Vali Acc: 0.266 Test Loss: 1.430 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8967416286468506
Epoch: 14, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.450 Vali Acc: 0.278 Test Loss: 1.450 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9067158699035645
Epoch: 15, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.467 Vali Acc: 0.247 Test Loss: 1.467 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9777960777282715
Epoch: 16, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.528 Vali Acc: 0.289 Test Loss: 1.528 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288958).  Saving model ...
Epoch: 17 cost time: 0.9576795101165771
Epoch: 17, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.484 Vali Acc: 0.262 Test Loss: 1.484 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8945553302764893
Epoch: 18, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.553 Vali Acc: 0.289 Test Loss: 1.553 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9387218952178955
Epoch: 19, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.489 Vali Acc: 0.278 Test Loss: 1.489 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9144341945648193
Epoch: 20, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.584 Vali Acc: 0.251 Test Loss: 1.584 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9616901874542236
Epoch: 21, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.605 Vali Acc: 0.278 Test Loss: 1.605 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9232025146484375
Epoch: 22, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.592 Vali Acc: 0.266 Test Loss: 1.592 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.005173921585083
Epoch: 23, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.674 Vali Acc: 0.289 Test Loss: 1.674 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.979057788848877
Epoch: 24, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.697 Vali Acc: 0.255 Test Loss: 1.697 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.972383975982666
Epoch: 25, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.726 Vali Acc: 0.255 Test Loss: 1.726 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9823446273803711
Epoch: 26, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.773 Vali Acc: 0.243 Test Loss: 1.773 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 183812
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3863394260406494
Epoch: 1, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.387 Vali Acc: 0.289 Test Loss: 1.387 Test Acc: 0.289
Validation loss decreased (inf --> -0.288960).  Saving model ...
Epoch: 2 cost time: 0.9720709323883057
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.387 Vali Acc: 0.251 Test Loss: 1.387 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0356464385986328
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.386 Vali Acc: 0.259 Test Loss: 1.386 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9704370498657227
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.389 Vali Acc: 0.285 Test Loss: 1.389 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9402074813842773
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.389 Vali Acc: 0.285 Test Loss: 1.389 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.973731517791748
Epoch: 6, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.397 Vali Acc: 0.236 Test Loss: 1.397 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9864747524261475
Epoch: 7, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.410 Vali Acc: 0.224 Test Loss: 1.410 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.921187162399292
Epoch: 8, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.402 Vali Acc: 0.262 Test Loss: 1.402 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9956178665161133
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.412 Vali Acc: 0.240 Test Loss: 1.412 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9470701217651367
Epoch: 10, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.403 Vali Acc: 0.236 Test Loss: 1.403 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9076778888702393
Epoch: 11, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 185092
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0680441856384277
Epoch: 1, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.385 Vali Acc: 0.247 Test Loss: 1.385 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.8988039493560791
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.381 Vali Acc: 0.316 Test Loss: 1.381 Test Acc: 0.316
Validation loss decreased (-0.247134 --> -0.315576).  Saving model ...
Epoch: 3 cost time: 0.932807445526123
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.380 Vali Acc: 0.274 Test Loss: 1.380 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9317317008972168
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.382 Vali Acc: 0.281 Test Loss: 1.382 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8853411674499512
Epoch: 5, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.383 Vali Acc: 0.274 Test Loss: 1.383 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9165592193603516
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9376180171966553
Epoch: 7, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9214770793914795
Epoch: 8, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9039664268493652
Epoch: 9, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.414 Vali Acc: 0.262 Test Loss: 1.414 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9555470943450928
Epoch: 10, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.438 Vali Acc: 0.259 Test Loss: 1.438 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8990464210510254
Epoch: 11, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0272057056427002
Epoch: 12, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.457 Vali Acc: 0.247 Test Loss: 1.457 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 186340
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3466625213623047
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.0959961414337158
Epoch: 2, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.444 Vali Acc: 0.247 Test Loss: 1.444 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.1105046272277832
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.437 Vali Acc: 0.240 Test Loss: 1.437 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.109755039215088
Epoch: 4, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.430 Vali Acc: 0.221 Test Loss: 1.430 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0486328601837158
Epoch: 5, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.857 Vali Acc: 0.281 Test Loss: 1.857 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281350).  Saving model ...
Epoch: 6 cost time: 1.0449941158294678
Epoch: 6, Steps: 17 | Train Loss: 1.166 Vali Loss: 2.004 Vali Acc: 0.266 Test Loss: 2.004 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0461316108703613
Epoch: 7, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.658 Vali Acc: 0.270 Test Loss: 1.658 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1282975673675537
Epoch: 8, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.758 Vali Acc: 0.266 Test Loss: 1.758 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1186788082122803
Epoch: 9, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.877 Vali Acc: 0.221 Test Loss: 1.877 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1670377254486084
Epoch: 10, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.999 Vali Acc: 0.251 Test Loss: 1.999 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1034455299377441
Epoch: 11, Steps: 17 | Train Loss: 0.675 Vali Loss: 2.314 Vali Acc: 0.262 Test Loss: 2.314 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1411433219909668
Epoch: 12, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.404 Vali Acc: 0.243 Test Loss: 2.404 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1381633281707764
Epoch: 13, Steps: 17 | Train Loss: 0.616 Vali Loss: 2.657 Vali Acc: 0.240 Test Loss: 2.657 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1604599952697754
Epoch: 14, Steps: 17 | Train Loss: 0.644 Vali Loss: 3.161 Vali Acc: 0.281 Test Loss: 3.161 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0701465606689453
Epoch: 15, Steps: 17 | Train Loss: 0.558 Vali Loss: 3.079 Vali Acc: 0.259 Test Loss: 3.079 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 724100
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.647869110107422
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.386 Vali Acc: 0.274 Test Loss: 1.386 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.1593692302703857
Epoch: 2, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1151306629180908
Epoch: 3, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0633361339569092
Epoch: 4, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.439 Vali Acc: 0.293 Test Loss: 1.439 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292761).  Saving model ...
Epoch: 5 cost time: 1.1750171184539795
Epoch: 5, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.450 Vali Acc: 0.259 Test Loss: 1.450 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.105302095413208
Epoch: 6, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.512 Vali Acc: 0.266 Test Loss: 1.512 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1554546356201172
Epoch: 7, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.616 Vali Acc: 0.262 Test Loss: 1.616 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1022999286651611
Epoch: 8, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.698 Vali Acc: 0.255 Test Loss: 1.698 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0592565536499023
Epoch: 9, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.590 Vali Acc: 0.270 Test Loss: 1.590 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1047108173370361
Epoch: 10, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.683 Vali Acc: 0.255 Test Loss: 1.683 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.982891321182251
Epoch: 11, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.000 Vali Acc: 0.270 Test Loss: 2.000 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.162170648574829
Epoch: 12, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.046 Vali Acc: 0.259 Test Loss: 2.046 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1368529796600342
Epoch: 13, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.044 Vali Acc: 0.255 Test Loss: 2.044 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.13791823387146
Epoch: 14, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.193 Vali Acc: 0.236 Test Loss: 2.193 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 668292
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3815643787384033
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.037945032119751
Epoch: 2, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.386 Vali Acc: 0.224 Test Loss: 1.386 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9816079139709473
Epoch: 3, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.404 Vali Acc: 0.262 Test Loss: 1.404 Test Acc: 0.262
Validation loss decreased (-0.243332 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 0.9602177143096924
Epoch: 4, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.503 Vali Acc: 0.236 Test Loss: 1.503 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0214293003082275
Epoch: 5, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.053084135055542
Epoch: 6, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.514 Vali Acc: 0.247 Test Loss: 1.514 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0683166980743408
Epoch: 7, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.489 Vali Acc: 0.228 Test Loss: 1.489 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0581800937652588
Epoch: 8, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.542 Vali Acc: 0.224 Test Loss: 1.542 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9626824855804443
Epoch: 9, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.569 Vali Acc: 0.224 Test Loss: 1.569 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9561784267425537
Epoch: 10, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.696 Vali Acc: 0.232 Test Loss: 1.696 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1002819538116455
Epoch: 11, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.731 Vali Acc: 0.247 Test Loss: 1.731 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0381379127502441
Epoch: 12, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.941 Vali Acc: 0.262 Test Loss: 1.941 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0184292793273926
Epoch: 13, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.842 Vali Acc: 0.255 Test Loss: 1.842 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.985595703125
Epoch: 14, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.019 Vali Acc: 0.255 Test Loss: 2.019 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9654324054718018
Epoch: 15, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.053 Vali Acc: 0.221 Test Loss: 2.053 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 652420
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2634479999542236
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.394 Vali Acc: 0.213 Test Loss: 1.394 Test Acc: 0.213
Validation loss decreased (inf --> -0.212914).  Saving model ...
Epoch: 2 cost time: 0.9957320690155029
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.387 Vali Acc: 0.262 Test Loss: 1.387 Test Acc: 0.262
Validation loss decreased (-0.212914 --> -0.262344).  Saving model ...
Epoch: 3 cost time: 0.99350905418396
Epoch: 3, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.464 Vali Acc: 0.240 Test Loss: 1.464 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0714871883392334
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.418 Vali Acc: 0.240 Test Loss: 1.418 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9837758541107178
Epoch: 5, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.424 Vali Acc: 0.217 Test Loss: 1.424 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0113441944122314
Epoch: 6, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.442 Vali Acc: 0.236 Test Loss: 1.442 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9867019653320312
Epoch: 7, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.434 Vali Acc: 0.228 Test Loss: 1.434 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.005859375
Epoch: 8, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.473 Vali Acc: 0.259 Test Loss: 1.473 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.065605640411377
Epoch: 9, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.512 Vali Acc: 0.209 Test Loss: 1.512 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9116249084472656
Epoch: 10, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.578 Vali Acc: 0.247 Test Loss: 1.578 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0549182891845703
Epoch: 11, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.690 Vali Acc: 0.240 Test Loss: 1.690 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0205984115600586
Epoch: 12, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.698 Vali Acc: 0.247 Test Loss: 1.698 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 648836
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.321887493133545
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.388 Vali Acc: 0.255 Test Loss: 1.388 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.0270543098449707
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.0501763820648193
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.401 Vali Acc: 0.247 Test Loss: 1.401 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.994565486907959
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.400 Vali Acc: 0.262 Test Loss: 1.400 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9224474430084229
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.406 Vali Acc: 0.240 Test Loss: 1.406 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.025282382965088
Epoch: 6, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.413 Vali Acc: 0.247 Test Loss: 1.413 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0245919227600098
Epoch: 7, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.447 Vali Acc: 0.266 Test Loss: 1.447 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0200855731964111
Epoch: 8, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.496 Vali Acc: 0.228 Test Loss: 1.496 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1158301830291748
Epoch: 9, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.536 Vali Acc: 0.270 Test Loss: 1.536 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0789146423339844
Epoch: 10, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.493 Vali Acc: 0.232 Test Loss: 1.493 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.015028476715088
Epoch: 11, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.563 Vali Acc: 0.247 Test Loss: 1.563 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8923547267913818
Epoch: 12, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.571 Vali Acc: 0.243 Test Loss: 1.571 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 650756
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2406206130981445
Epoch: 1, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.391 Vali Acc: 0.281 Test Loss: 1.391 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 0.9939255714416504
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0554096698760986
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.430 Vali Acc: 0.243 Test Loss: 1.430 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0114142894744873
Epoch: 4, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.436 Vali Acc: 0.232 Test Loss: 1.436 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0689709186553955
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.448 Vali Acc: 0.232 Test Loss: 1.448 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9799380302429199
Epoch: 6, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.467 Vali Acc: 0.213 Test Loss: 1.467 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0205333232879639
Epoch: 7, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.496 Vali Acc: 0.270 Test Loss: 1.496 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.946112871170044
Epoch: 8, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.481 Vali Acc: 0.224 Test Loss: 1.481 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0146758556365967
Epoch: 9, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.533 Vali Acc: 0.270 Test Loss: 1.533 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0490455627441406
Epoch: 10, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.540 Vali Acc: 0.236 Test Loss: 1.540 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9242219924926758
Epoch: 11, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.564 Vali Acc: 0.270 Test Loss: 1.564 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 655876
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4056894779205322
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.388 Vali Acc: 0.251 Test Loss: 1.388 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.9841220378875732
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.380 Vali Acc: 0.270 Test Loss: 1.380 Test Acc: 0.270
Validation loss decreased (-0.250937 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 0.9965848922729492
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.395 Vali Acc: 0.255 Test Loss: 1.395 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9074180126190186
Epoch: 4, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.408 Vali Acc: 0.281 Test Loss: 1.408 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 0.9076838493347168
Epoch: 5, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.403 Vali Acc: 0.259 Test Loss: 1.403 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9165511131286621
Epoch: 6, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.442 Vali Acc: 0.262 Test Loss: 1.442 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9898190498352051
Epoch: 7, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.437 Vali Acc: 0.236 Test Loss: 1.437 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.927865743637085
Epoch: 8, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.432 Vali Acc: 0.259 Test Loss: 1.432 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9621808528900146
Epoch: 9, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.593 Vali Acc: 0.259 Test Loss: 1.593 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9535112380981445
Epoch: 10, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.547 Vali Acc: 0.247 Test Loss: 1.547 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9225680828094482
Epoch: 11, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.560 Vali Acc: 0.259 Test Loss: 1.560 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9422075748443604
Epoch: 12, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.573 Vali Acc: 0.281 Test Loss: 1.573 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9549698829650879
Epoch: 13, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.679 Vali Acc: 0.266 Test Loss: 1.679 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0163109302520752
Epoch: 14, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.618 Vali Acc: 0.255 Test Loss: 1.618 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 663940
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1869988441467285
Epoch: 1, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.391 Vali Acc: 0.262 Test Loss: 1.391 Test Acc: 0.262
Validation loss decreased (inf --> -0.262344).  Saving model ...
Epoch: 2 cost time: 0.9464137554168701
Epoch: 2, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.386 Vali Acc: 0.255 Test Loss: 1.386 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7968261241912842
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.379 Vali Acc: 0.304 Test Loss: 1.379 Test Acc: 0.304
Validation loss decreased (-0.262344 --> -0.304169).  Saving model ...
Epoch: 4 cost time: 0.9181118011474609
Epoch: 4, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.474 Vali Acc: 0.281 Test Loss: 1.474 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8327820301055908
Epoch: 5, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.414 Vali Acc: 0.262 Test Loss: 1.414 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7729384899139404
Epoch: 6, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7859969139099121
Epoch: 7, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.497 Vali Acc: 0.266 Test Loss: 1.497 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8269028663635254
Epoch: 8, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.585 Vali Acc: 0.259 Test Loss: 1.585 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7362079620361328
Epoch: 9, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.596 Vali Acc: 0.274 Test Loss: 1.596 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7744889259338379
Epoch: 10, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.654 Vali Acc: 0.224 Test Loss: 1.654 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.76589035987854
Epoch: 11, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.771 Vali Acc: 0.259 Test Loss: 1.771 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.844641923904419
Epoch: 12, Steps: 17 | Train Loss: 0.788 Vali Loss: 1.924 Vali Acc: 0.285 Test Loss: 1.924 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9000072479248047
Epoch: 13, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.996 Vali Acc: 0.262 Test Loss: 1.996 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 222788
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1715826988220215
Epoch: 1, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 0.8650569915771484
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.382 Vali Acc: 0.259 Test Loss: 1.382 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8076410293579102
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.810248851776123
Epoch: 4, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.401 Vali Acc: 0.255 Test Loss: 1.401 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8346974849700928
Epoch: 5, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.424 Vali Acc: 0.274 Test Loss: 1.424 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 0.8509893417358398
Epoch: 6, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.429 Vali Acc: 0.262 Test Loss: 1.429 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8106703758239746
Epoch: 7, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8420226573944092
Epoch: 8, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.434 Vali Acc: 0.262 Test Loss: 1.434 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.887453556060791
Epoch: 9, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.476 Vali Acc: 0.243 Test Loss: 1.476 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8208715915679932
Epoch: 10, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.484 Vali Acc: 0.266 Test Loss: 1.484 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8785898685455322
Epoch: 11, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.527 Vali Acc: 0.266 Test Loss: 1.527 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8878772258758545
Epoch: 12, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.573 Vali Acc: 0.262 Test Loss: 1.573 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8930585384368896
Epoch: 13, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.683 Vali Acc: 0.274 Test Loss: 1.683 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8689501285552979
Epoch: 14, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.679 Vali Acc: 0.262 Test Loss: 1.679 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8957126140594482
Epoch: 15, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.858 Vali Acc: 0.262 Test Loss: 1.858 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 194884
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2424657344818115
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.378 Vali Acc: 0.278 Test Loss: 1.378 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 0.8754689693450928
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.374 Vali Acc: 0.304 Test Loss: 1.374 Test Acc: 0.304
Validation loss decreased (-0.277553 --> -0.304169).  Saving model ...
Epoch: 3 cost time: 0.8452966213226318
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.385 Vali Acc: 0.266 Test Loss: 1.385 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8614852428436279
Epoch: 4, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.389 Vali Acc: 0.232 Test Loss: 1.389 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9408278465270996
Epoch: 5, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8623385429382324
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.389 Vali Acc: 0.262 Test Loss: 1.389 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9231901168823242
Epoch: 7, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.417 Vali Acc: 0.259 Test Loss: 1.417 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.817795991897583
Epoch: 8, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8674278259277344
Epoch: 9, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.473 Vali Acc: 0.270 Test Loss: 1.473 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8941986560821533
Epoch: 10, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8629302978515625
Epoch: 11, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.494 Vali Acc: 0.266 Test Loss: 1.494 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8814430236816406
Epoch: 12, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.517 Vali Acc: 0.270 Test Loss: 1.517 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 186948
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2430942058563232
Epoch: 1, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.8692238330841064
Epoch: 2, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.9136977195739746
Epoch: 3, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.829728364944458
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.406 Vali Acc: 0.278 Test Loss: 1.406 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 0.8697998523712158
Epoch: 5, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.413 Vali Acc: 0.243 Test Loss: 1.413 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9298865795135498
Epoch: 6, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.420 Vali Acc: 0.243 Test Loss: 1.420 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7607676982879639
Epoch: 7, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.442 Vali Acc: 0.240 Test Loss: 1.442 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8690185546875
Epoch: 8, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.424 Vali Acc: 0.251 Test Loss: 1.424 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8451359272003174
Epoch: 9, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.475 Vali Acc: 0.236 Test Loss: 1.475 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8783342838287354
Epoch: 10, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9006402492523193
Epoch: 11, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.485 Vali Acc: 0.247 Test Loss: 1.485 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8241684436798096
Epoch: 12, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.593 Vali Acc: 0.243 Test Loss: 1.593 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8799400329589844
Epoch: 13, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8092279434204102
Epoch: 14, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.585 Vali Acc: 0.278 Test Loss: 1.585 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 185156
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2871673107147217
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.403 Vali Acc: 0.232 Test Loss: 1.403 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 0.81355881690979
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (-0.231925 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 0.8217771053314209
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.392 Vali Acc: 0.251 Test Loss: 1.392 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9066159725189209
Epoch: 4, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.400 Vali Acc: 0.247 Test Loss: 1.400 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8164315223693848
Epoch: 5, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8547232151031494
Epoch: 6, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.411 Vali Acc: 0.224 Test Loss: 1.411 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8468267917633057
Epoch: 7, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8152379989624023
Epoch: 8, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8521544933319092
Epoch: 9, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.429 Vali Acc: 0.255 Test Loss: 1.429 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8653490543365479
Epoch: 10, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.457 Vali Acc: 0.236 Test Loss: 1.457 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8391988277435303
Epoch: 11, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7450563907623291
Epoch: 12, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 186116
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1704909801483154
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.382 Vali Acc: 0.255 Test Loss: 1.382 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.8040390014648438
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.390 Vali Acc: 0.297 Test Loss: 1.390 Test Acc: 0.297
Validation loss decreased (-0.254739 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 0.8585875034332275
Epoch: 3, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.390 Vali Acc: 0.247 Test Loss: 1.390 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8342134952545166
Epoch: 4, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.391 Vali Acc: 0.281 Test Loss: 1.391 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8817486763000488
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.398 Vali Acc: 0.251 Test Loss: 1.398 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9045569896697998
Epoch: 6, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8202288150787354
Epoch: 7, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.436 Vali Acc: 0.259 Test Loss: 1.436 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.819732666015625
Epoch: 8, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7624785900115967
Epoch: 9, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.403 Vali Acc: 0.202 Test Loss: 1.403 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7792842388153076
Epoch: 10, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.453 Vali Acc: 0.243 Test Loss: 1.453 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8021595478057861
Epoch: 11, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.441 Vali Acc: 0.266 Test Loss: 1.441 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7888169288635254
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.458 Vali Acc: 0.240 Test Loss: 1.458 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 188676
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.163677930831909
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.378 Vali Acc: 0.281 Test Loss: 1.378 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 0.8349909782409668
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.375 Vali Acc: 0.255 Test Loss: 1.375 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8272967338562012
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.398 Vali Acc: 0.247 Test Loss: 1.398 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7855191230773926
Epoch: 4, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.373 Vali Acc: 0.217 Test Loss: 1.373 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.879314661026001
Epoch: 5, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.384 Vali Acc: 0.255 Test Loss: 1.384 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7967371940612793
Epoch: 6, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.388 Vali Acc: 0.247 Test Loss: 1.388 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7708947658538818
Epoch: 7, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.388 Vali Acc: 0.243 Test Loss: 1.388 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8735229969024658
Epoch: 8, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8394534587860107
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.414 Vali Acc: 0.262 Test Loss: 1.414 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8681352138519287
Epoch: 10, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.429 Vali Acc: 0.262 Test Loss: 1.429 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8237879276275635
Epoch: 11, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 192708
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.23321270942688
Epoch: 1, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.7635760307312012
Epoch: 2, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.414 Vali Acc: 0.232 Test Loss: 1.414 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7737894058227539
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.404 Vali Acc: 0.247 Test Loss: 1.404 Test Acc: 0.247
Validation loss decreased (-0.247134 --> -0.247134).  Saving model ...
Epoch: 4 cost time: 0.8103423118591309
Epoch: 4, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.403 Vali Acc: 0.285 Test Loss: 1.403 Test Acc: 0.285
Validation loss decreased (-0.247134 --> -0.285157).  Saving model ...
Epoch: 5 cost time: 0.7944271564483643
Epoch: 5, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.434 Vali Acc: 0.240 Test Loss: 1.434 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8441948890686035
Epoch: 6, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7740199565887451
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.437 Vali Acc: 0.289 Test Loss: 1.437 Test Acc: 0.289
Validation loss decreased (-0.285157 --> -0.288959).  Saving model ...
Epoch: 8 cost time: 0.8250300884246826
Epoch: 8, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8274741172790527
Epoch: 9, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.469 Vali Acc: 0.297 Test Loss: 1.469 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296563).  Saving model ...
Epoch: 10 cost time: 0.7315964698791504
Epoch: 10, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.468 Vali Acc: 0.266 Test Loss: 1.468 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7755770683288574
Epoch: 11, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.521 Vali Acc: 0.251 Test Loss: 1.521 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8546128273010254
Epoch: 12, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.551 Vali Acc: 0.259 Test Loss: 1.551 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7627179622650146
Epoch: 13, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.564 Vali Acc: 0.278 Test Loss: 1.564 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7786266803741455
Epoch: 14, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.672 Vali Acc: 0.255 Test Loss: 1.672 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8071997165679932
Epoch: 15, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.679 Vali Acc: 0.247 Test Loss: 1.679 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7843997478485107
Epoch: 16, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.731 Vali Acc: 0.278 Test Loss: 1.731 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.753882884979248
Epoch: 17, Steps: 17 | Train Loss: 0.774 Vali Loss: 1.876 Vali Acc: 0.266 Test Loss: 1.876 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8250510692596436
Epoch: 18, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.882 Vali Acc: 0.289 Test Loss: 1.882 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7717328071594238
Epoch: 19, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.076 Vali Acc: 0.278 Test Loss: 2.076 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 76580
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.036510467529297
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.400 Vali Acc: 0.278 Test Loss: 1.400 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 0.7533981800079346
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7843587398529053
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.392 Vali Acc: 0.255 Test Loss: 1.392 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7649738788604736
Epoch: 4, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7523705959320068
Epoch: 5, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.399 Vali Acc: 0.247 Test Loss: 1.399 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7963151931762695
Epoch: 6, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.396 Vali Acc: 0.240 Test Loss: 1.396 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7807121276855469
Epoch: 7, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.403 Vali Acc: 0.274 Test Loss: 1.403 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.778649091720581
Epoch: 8, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.400 Vali Acc: 0.274 Test Loss: 1.400 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7479007244110107
Epoch: 9, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.430 Vali Acc: 0.266 Test Loss: 1.430 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.781813383102417
Epoch: 10, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.409 Vali Acc: 0.289 Test Loss: 1.409 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288959).  Saving model ...
Epoch: 11 cost time: 0.7335309982299805
Epoch: 11, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.444 Vali Acc: 0.262 Test Loss: 1.444 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7616188526153564
Epoch: 12, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7834773063659668
Epoch: 13, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.453 Vali Acc: 0.281 Test Loss: 1.453 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7735610008239746
Epoch: 14, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.465 Vali Acc: 0.255 Test Loss: 1.465 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7433319091796875
Epoch: 15, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.499 Vali Acc: 0.285 Test Loss: 1.499 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8981804847717285
Epoch: 16, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.487 Vali Acc: 0.251 Test Loss: 1.487 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.749941349029541
Epoch: 17, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.568 Vali Acc: 0.285 Test Loss: 1.568 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8016870021820068
Epoch: 18, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.554 Vali Acc: 0.262 Test Loss: 1.554 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7973721027374268
Epoch: 19, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.599 Vali Acc: 0.278 Test Loss: 1.599 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7785220146179199
Epoch: 20, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.591 Vali Acc: 0.274 Test Loss: 1.591 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 62628
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2884862422943115
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.384 Vali Acc: 0.251 Test Loss: 1.384 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.7715544700622559
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.380 Vali Acc: 0.262 Test Loss: 1.380 Test Acc: 0.262
Validation loss decreased (-0.250937 --> -0.262344).  Saving model ...
Epoch: 3 cost time: 0.7765612602233887
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.379 Vali Acc: 0.293 Test Loss: 1.379 Test Acc: 0.293
Validation loss decreased (-0.262344 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 0.742516279220581
Epoch: 4, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.386 Vali Acc: 0.289 Test Loss: 1.386 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7997431755065918
Epoch: 5, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.380 Vali Acc: 0.278 Test Loss: 1.380 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8080308437347412
Epoch: 6, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.389 Vali Acc: 0.259 Test Loss: 1.389 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7938783168792725
Epoch: 7, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.405 Vali Acc: 0.221 Test Loss: 1.405 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8041441440582275
Epoch: 8, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.400 Vali Acc: 0.251 Test Loss: 1.400 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7836387157440186
Epoch: 9, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.418 Vali Acc: 0.213 Test Loss: 1.418 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8184492588043213
Epoch: 10, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7322587966918945
Epoch: 11, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.428 Vali Acc: 0.278 Test Loss: 1.428 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7880878448486328
Epoch: 12, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.460 Vali Acc: 0.274 Test Loss: 1.460 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7256901264190674
Epoch: 13, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 58660
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9226219654083252
Epoch: 1, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.394 Vali Acc: 0.262 Test Loss: 1.394 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.7812271118164062
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.389 Vali Acc: 0.285 Test Loss: 1.389 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 0.8118021488189697
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.388 Vali Acc: 0.266 Test Loss: 1.388 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7895736694335938
Epoch: 4, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.384 Vali Acc: 0.228 Test Loss: 1.384 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8406884670257568
Epoch: 5, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.387 Vali Acc: 0.251 Test Loss: 1.387 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7986183166503906
Epoch: 6, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.384 Vali Acc: 0.274 Test Loss: 1.384 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.836540937423706
Epoch: 7, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.382 Vali Acc: 0.278 Test Loss: 1.382 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6997101306915283
Epoch: 8, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.388 Vali Acc: 0.247 Test Loss: 1.388 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7755210399627686
Epoch: 9, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7405598163604736
Epoch: 10, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.391 Vali Acc: 0.247 Test Loss: 1.391 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8076565265655518
Epoch: 11, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7634778022766113
Epoch: 12, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.411 Vali Acc: 0.259 Test Loss: 1.411 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 57764
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.110262632369995
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.397 Vali Acc: 0.274 Test Loss: 1.397 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.8283038139343262
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.387 Vali Acc: 0.251 Test Loss: 1.387 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8158829212188721
Epoch: 3, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.392 Vali Acc: 0.266 Test Loss: 1.392 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7941935062408447
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.384 Vali Acc: 0.232 Test Loss: 1.384 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.829486608505249
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.387 Vali Acc: 0.243 Test Loss: 1.387 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8191854953765869
Epoch: 6, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.392 Vali Acc: 0.240 Test Loss: 1.392 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7731163501739502
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.386 Vali Acc: 0.243 Test Loss: 1.386 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.785574197769165
Epoch: 8, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.393 Vali Acc: 0.285 Test Loss: 1.393 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 0.8320527076721191
Epoch: 9, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.796015739440918
Epoch: 10, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.399 Vali Acc: 0.262 Test Loss: 1.399 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7719161510467529
Epoch: 11, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.406 Vali Acc: 0.266 Test Loss: 1.406 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8037629127502441
Epoch: 12, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.412 Vali Acc: 0.266 Test Loss: 1.412 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8178465366363525
Epoch: 13, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.407 Vali Acc: 0.266 Test Loss: 1.407 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8333494663238525
Epoch: 14, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.439 Vali Acc: 0.281 Test Loss: 1.439 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7540891170501709
Epoch: 15, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.446 Vali Acc: 0.281 Test Loss: 1.446 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7863614559173584
Epoch: 16, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.443 Vali Acc: 0.259 Test Loss: 1.443 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8216841220855713
Epoch: 17, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.435 Vali Acc: 0.270 Test Loss: 1.435 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8165328502655029
Epoch: 18, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.443 Vali Acc: 0.278 Test Loss: 1.443 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 58244
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.123056173324585
Epoch: 1, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.387 Vali Acc: 0.240 Test Loss: 1.387 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 0.7767226696014404
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.382 Vali Acc: 0.251 Test Loss: 1.382 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 0.7722203731536865
Epoch: 3, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.382 Vali Acc: 0.266 Test Loss: 1.382 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 0.7344746589660645
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.390 Vali Acc: 0.266 Test Loss: 1.390 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7861533164978027
Epoch: 5, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.385 Vali Acc: 0.255 Test Loss: 1.385 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8164641857147217
Epoch: 6, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277553).  Saving model ...
Epoch: 7 cost time: 0.7284741401672363
Epoch: 7, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.404 Vali Acc: 0.266 Test Loss: 1.404 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7939231395721436
Epoch: 8, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.398 Vali Acc: 0.255 Test Loss: 1.398 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7507812976837158
Epoch: 9, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.401 Vali Acc: 0.236 Test Loss: 1.401 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7539253234863281
Epoch: 10, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.411 Vali Acc: 0.274 Test Loss: 1.411 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7894067764282227
Epoch: 11, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.411 Vali Acc: 0.224 Test Loss: 1.411 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.794105052947998
Epoch: 12, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.420 Vali Acc: 0.285 Test Loss: 1.420 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285157).  Saving model ...
Epoch: 13 cost time: 0.7949926853179932
Epoch: 13, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.447 Vali Acc: 0.232 Test Loss: 1.447 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7746543884277344
Epoch: 14, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8119995594024658
Epoch: 15, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.439 Vali Acc: 0.289 Test Loss: 1.439 Test Acc: 0.289
Validation loss decreased (-0.285157 --> -0.288959).  Saving model ...
Epoch: 16 cost time: 0.8180124759674072
Epoch: 16, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.75687575340271
Epoch: 17, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.463 Vali Acc: 0.259 Test Loss: 1.463 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7611780166625977
Epoch: 18, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.801210880279541
Epoch: 19, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.530 Vali Acc: 0.270 Test Loss: 1.530 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.754450798034668
Epoch: 20, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.523 Vali Acc: 0.285 Test Loss: 1.523 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7790336608886719
Epoch: 21, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.512 Vali Acc: 0.255 Test Loss: 1.512 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7722399234771729
Epoch: 22, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.541 Vali Acc: 0.240 Test Loss: 1.541 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8080525398254395
Epoch: 23, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.552 Vali Acc: 0.278 Test Loss: 1.552 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7733879089355469
Epoch: 24, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.556 Vali Acc: 0.274 Test Loss: 1.556 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7610878944396973
Epoch: 25, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.560 Vali Acc: 0.224 Test Loss: 1.560 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 59524
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.84804105758667
Epoch: 1, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.385 Vali Acc: 0.243 Test Loss: 1.385 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 0.7407565116882324
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.384 Vali Acc: 0.251 Test Loss: 1.384 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 0.7519321441650391
Epoch: 3, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.382 Vali Acc: 0.266 Test Loss: 1.382 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 0.7134466171264648
Epoch: 4, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.392 Vali Acc: 0.236 Test Loss: 1.392 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7350828647613525
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.381 Vali Acc: 0.255 Test Loss: 1.381 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7468845844268799
Epoch: 6, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.391 Vali Acc: 0.209 Test Loss: 1.391 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8627095222473145
Epoch: 7, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.396 Vali Acc: 0.232 Test Loss: 1.396 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7911608219146729
Epoch: 8, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.401 Vali Acc: 0.202 Test Loss: 1.401 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.738889217376709
Epoch: 9, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.412 Vali Acc: 0.281 Test Loss: 1.412 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281355).  Saving model ...
Epoch: 10 cost time: 0.7648484706878662
Epoch: 10, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.406 Vali Acc: 0.217 Test Loss: 1.406 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.761641263961792
Epoch: 11, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.417 Vali Acc: 0.240 Test Loss: 1.417 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7352249622344971
Epoch: 12, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.459 Vali Acc: 0.281 Test Loss: 1.459 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7353038787841797
Epoch: 13, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.430 Vali Acc: 0.228 Test Loss: 1.430 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7898502349853516
Epoch: 14, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.453 Vali Acc: 0.221 Test Loss: 1.453 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7813451290130615
Epoch: 15, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.456 Vali Acc: 0.232 Test Loss: 1.456 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8069086074829102
Epoch: 16, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.474 Vali Acc: 0.236 Test Loss: 1.474 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7505707740783691
Epoch: 17, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.556 Vali Acc: 0.262 Test Loss: 1.556 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7866201400756836
Epoch: 18, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7963728904724121
Epoch: 19, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.512 Vali Acc: 0.262 Test Loss: 1.512 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 61540
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.45969295501709
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.419 Vali Acc: 0.274 Test Loss: 1.419 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.0389513969421387
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.524 Vali Acc: 0.243 Test Loss: 1.524 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0786716938018799
Epoch: 3, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.652 Vali Acc: 0.259 Test Loss: 1.652 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0004441738128662
Epoch: 4, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.487 Vali Acc: 0.316 Test Loss: 1.487 Test Acc: 0.316
Validation loss decreased (-0.273750 --> -0.315574).  Saving model ...
Epoch: 5 cost time: 1.1076972484588623
Epoch: 5, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.623 Vali Acc: 0.274 Test Loss: 1.623 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1432747840881348
Epoch: 6, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.583 Vali Acc: 0.270 Test Loss: 1.583 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.10093355178833
Epoch: 7, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.599 Vali Acc: 0.278 Test Loss: 1.599 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1178300380706787
Epoch: 8, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.983 Vali Acc: 0.259 Test Loss: 1.983 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1281154155731201
Epoch: 9, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.976 Vali Acc: 0.247 Test Loss: 1.976 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.076730728149414
Epoch: 10, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.119 Vali Acc: 0.255 Test Loss: 2.119 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9968647956848145
Epoch: 11, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.327 Vali Acc: 0.236 Test Loss: 2.327 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0786597728729248
Epoch: 12, Steps: 17 | Train Loss: 0.657 Vali Loss: 2.348 Vali Acc: 0.251 Test Loss: 2.348 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1464440822601318
Epoch: 13, Steps: 17 | Train Loss: 0.642 Vali Loss: 2.624 Vali Acc: 0.243 Test Loss: 2.624 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.094940423965454
Epoch: 14, Steps: 17 | Train Loss: 0.548 Vali Loss: 2.657 Vali Acc: 0.255 Test Loss: 2.657 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 719492
model size : 2.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2110683917999268
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.418 Vali Acc: 0.285 Test Loss: 1.418 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.1380045413970947
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1751868724822998
Epoch: 3, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.465 Vali Acc: 0.266 Test Loss: 1.465 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0458147525787354
Epoch: 4, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.496 Vali Acc: 0.278 Test Loss: 1.496 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.109788417816162
Epoch: 5, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.451 Vali Acc: 0.274 Test Loss: 1.451 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1113219261169434
Epoch: 6, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.466 Vali Acc: 0.255 Test Loss: 1.466 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0740585327148438
Epoch: 7, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.493 Vali Acc: 0.251 Test Loss: 1.493 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0968937873840332
Epoch: 8, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.698 Vali Acc: 0.274 Test Loss: 1.698 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0189895629882812
Epoch: 9, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.810 Vali Acc: 0.270 Test Loss: 1.810 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1347126960754395
Epoch: 10, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.742 Vali Acc: 0.255 Test Loss: 1.742 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1022305488586426
Epoch: 11, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.009 Vali Acc: 0.251 Test Loss: 2.009 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 663684
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.460057020187378
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.388 Vali Acc: 0.259 Test Loss: 1.388 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.1200690269470215
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.064591407775879
Epoch: 3, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.406 Vali Acc: 0.274 Test Loss: 1.406 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 1.034527063369751
Epoch: 4, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.419 Vali Acc: 0.266 Test Loss: 1.419 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0800611972808838
Epoch: 5, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.456 Vali Acc: 0.262 Test Loss: 1.456 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0923981666564941
Epoch: 6, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0265493392944336
Epoch: 7, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.450 Vali Acc: 0.240 Test Loss: 1.450 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0861880779266357
Epoch: 8, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.571 Vali Acc: 0.243 Test Loss: 1.571 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1038074493408203
Epoch: 9, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.551 Vali Acc: 0.278 Test Loss: 1.551 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277551).  Saving model ...
Epoch: 10 cost time: 1.1035635471343994
Epoch: 10, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.622 Vali Acc: 0.243 Test Loss: 1.622 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.10752534866333
Epoch: 11, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.677 Vali Acc: 0.274 Test Loss: 1.677 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1102335453033447
Epoch: 12, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.846 Vali Acc: 0.259 Test Loss: 1.846 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0305471420288086
Epoch: 13, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.891 Vali Acc: 0.274 Test Loss: 1.891 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.119910478591919
Epoch: 14, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.968 Vali Acc: 0.240 Test Loss: 1.968 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0820741653442383
Epoch: 15, Steps: 17 | Train Loss: 0.771 Vali Loss: 2.064 Vali Acc: 0.251 Test Loss: 2.064 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0521841049194336
Epoch: 16, Steps: 17 | Train Loss: 0.746 Vali Loss: 2.092 Vali Acc: 0.262 Test Loss: 2.092 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1041028499603271
Epoch: 17, Steps: 17 | Train Loss: 0.708 Vali Loss: 2.248 Vali Acc: 0.259 Test Loss: 2.248 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1090631484985352
Epoch: 18, Steps: 17 | Train Loss: 0.696 Vali Loss: 2.188 Vali Acc: 0.259 Test Loss: 2.188 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.072725534439087
Epoch: 19, Steps: 17 | Train Loss: 0.634 Vali Loss: 2.365 Vali Acc: 0.259 Test Loss: 2.365 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 647812
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6808433532714844
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.0434815883636475
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.389 Vali Acc: 0.247 Test Loss: 1.389 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.0044023990631104
Epoch: 3, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.411 Vali Acc: 0.255 Test Loss: 1.411 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 1.074425458908081
Epoch: 4, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.430 Vali Acc: 0.221 Test Loss: 1.430 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1702406406402588
Epoch: 5, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.447 Vali Acc: 0.240 Test Loss: 1.447 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.125173568725586
Epoch: 6, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.471 Vali Acc: 0.232 Test Loss: 1.471 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.082345962524414
Epoch: 7, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.458 Vali Acc: 0.202 Test Loss: 1.458 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0959622859954834
Epoch: 8, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.474 Vali Acc: 0.240 Test Loss: 1.474 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.063227653503418
Epoch: 9, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.105797290802002
Epoch: 10, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.595 Vali Acc: 0.270 Test Loss: 1.595 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269946).  Saving model ...
Epoch: 11 cost time: 1.0693697929382324
Epoch: 11, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.681 Vali Acc: 0.243 Test Loss: 1.681 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9938561916351318
Epoch: 12, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.665 Vali Acc: 0.224 Test Loss: 1.665 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0522713661193848
Epoch: 13, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.760 Vali Acc: 0.255 Test Loss: 1.760 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0437090396881104
Epoch: 14, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.729 Vali Acc: 0.240 Test Loss: 1.729 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.037252426147461
Epoch: 15, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.870 Vali Acc: 0.243 Test Loss: 1.870 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0400042533874512
Epoch: 16, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.918 Vali Acc: 0.236 Test Loss: 1.918 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0648770332336426
Epoch: 17, Steps: 17 | Train Loss: 0.734 Vali Loss: 2.035 Vali Acc: 0.243 Test Loss: 2.035 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.093834638595581
Epoch: 18, Steps: 17 | Train Loss: 0.703 Vali Loss: 2.057 Vali Acc: 0.247 Test Loss: 2.057 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1012959480285645
Epoch: 19, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.144 Vali Acc: 0.255 Test Loss: 2.144 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1243231296539307
Epoch: 20, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.249 Vali Acc: 0.270 Test Loss: 2.249 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 644228
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.196070432662964
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.389 Vali Acc: 0.274 Test Loss: 1.389 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.0415732860565186
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.0873212814331055
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.409 Vali Acc: 0.255 Test Loss: 1.409 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9183251857757568
Epoch: 4, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.123020887374878
Epoch: 5, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0448062419891357
Epoch: 6, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0873115062713623
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.466 Vali Acc: 0.262 Test Loss: 1.466 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1071453094482422
Epoch: 8, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.440 Vali Acc: 0.262 Test Loss: 1.440 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.114847183227539
Epoch: 9, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.490 Vali Acc: 0.289 Test Loss: 1.490 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288958).  Saving model ...
Epoch: 10 cost time: 1.0351300239562988
Epoch: 10, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.546 Vali Acc: 0.262 Test Loss: 1.546 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.116196632385254
Epoch: 11, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.586 Vali Acc: 0.262 Test Loss: 1.586 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1119296550750732
Epoch: 12, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.583 Vali Acc: 0.274 Test Loss: 1.583 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0505328178405762
Epoch: 13, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.678 Vali Acc: 0.240 Test Loss: 1.678 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0207481384277344
Epoch: 14, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.655 Vali Acc: 0.243 Test Loss: 1.655 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0224189758300781
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.737 Vali Acc: 0.266 Test Loss: 1.737 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0276930332183838
Epoch: 16, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.735 Vali Acc: 0.259 Test Loss: 1.735 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1799075603485107
Epoch: 17, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.968 Vali Acc: 0.289 Test Loss: 1.968 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0801920890808105
Epoch: 18, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.827 Vali Acc: 0.247 Test Loss: 1.827 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0706727504730225
Epoch: 19, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.971 Vali Acc: 0.240 Test Loss: 1.971 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 646148
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.188685178756714
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.385 Vali Acc: 0.247 Test Loss: 1.385 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.9734809398651123
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.390 Vali Acc: 0.255 Test Loss: 1.390 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.0314695835113525
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.399 Vali Acc: 0.221 Test Loss: 1.399 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.045731782913208
Epoch: 4, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.419 Vali Acc: 0.278 Test Loss: 1.419 Test Acc: 0.278
Validation loss decreased (-0.254739 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 1.1075878143310547
Epoch: 5, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.419 Vali Acc: 0.262 Test Loss: 1.419 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1438946723937988
Epoch: 6, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.442 Vali Acc: 0.251 Test Loss: 1.442 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9848473072052002
Epoch: 7, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0276076793670654
Epoch: 8, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.518 Vali Acc: 0.247 Test Loss: 1.518 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1587424278259277
Epoch: 9, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.469 Vali Acc: 0.247 Test Loss: 1.469 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0558395385742188
Epoch: 10, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.502 Vali Acc: 0.262 Test Loss: 1.502 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.041731595993042
Epoch: 11, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.521 Vali Acc: 0.240 Test Loss: 1.521 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0641629695892334
Epoch: 12, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.561 Vali Acc: 0.259 Test Loss: 1.561 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.041473388671875
Epoch: 13, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.580 Vali Acc: 0.278 Test Loss: 1.580 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9561374187469482
Epoch: 14, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.692 Vali Acc: 0.274 Test Loss: 1.692 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 651268
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.427239179611206
Epoch: 1, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.061755895614624
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.382 Vali Acc: 0.278 Test Loss: 1.382 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 1.020498275756836
Epoch: 3, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.385 Vali Acc: 0.259 Test Loss: 1.385 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9903347492218018
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.395 Vali Acc: 0.278 Test Loss: 1.395 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9730803966522217
Epoch: 5, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0663132667541504
Epoch: 6, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.450 Vali Acc: 0.255 Test Loss: 1.450 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.028421401977539
Epoch: 7, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.404 Vali Acc: 0.274 Test Loss: 1.404 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9799208641052246
Epoch: 8, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.427 Vali Acc: 0.240 Test Loss: 1.427 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9736137390136719
Epoch: 9, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.496 Vali Acc: 0.240 Test Loss: 1.496 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0775468349456787
Epoch: 10, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.535 Vali Acc: 0.247 Test Loss: 1.535 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0791261196136475
Epoch: 11, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.523 Vali Acc: 0.270 Test Loss: 1.523 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1144049167633057
Epoch: 12, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.576 Vali Acc: 0.297 Test Loss: 1.576 Test Acc: 0.297
Validation loss decreased (-0.277553 --> -0.296562).  Saving model ...
Epoch: 13 cost time: 1.0675334930419922
Epoch: 13, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.625 Vali Acc: 0.270 Test Loss: 1.625 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9942851066589355
Epoch: 14, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.632 Vali Acc: 0.243 Test Loss: 1.632 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0778582096099854
Epoch: 15, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.667 Vali Acc: 0.255 Test Loss: 1.667 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.088183879852295
Epoch: 16, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.696 Vali Acc: 0.266 Test Loss: 1.696 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0237541198730469
Epoch: 17, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.789 Vali Acc: 0.278 Test Loss: 1.789 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0891025066375732
Epoch: 18, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.744 Vali Acc: 0.266 Test Loss: 1.744 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0186150074005127
Epoch: 19, Steps: 17 | Train Loss: 0.813 Vali Loss: 1.859 Vali Acc: 0.259 Test Loss: 1.859 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9236247539520264
Epoch: 20, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.933 Vali Acc: 0.255 Test Loss: 1.933 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.005718469619751
Epoch: 21, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.037 Vali Acc: 0.251 Test Loss: 2.037 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0763425827026367
Epoch: 22, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.964 Vali Acc: 0.270 Test Loss: 1.964 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 659332
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.068955421447754
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.404 Vali Acc: 0.259 Test Loss: 1.404 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.9199414253234863
Epoch: 2, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9054014682769775
Epoch: 3, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 0.8985581398010254
Epoch: 4, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.477 Vali Acc: 0.255 Test Loss: 1.477 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8191418647766113
Epoch: 5, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.423 Vali Acc: 0.293 Test Loss: 1.423 Test Acc: 0.293
Validation loss decreased (-0.262343 --> -0.292761).  Saving model ...
Epoch: 6 cost time: 0.9112229347229004
Epoch: 6, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.466 Vali Acc: 0.270 Test Loss: 1.466 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8878402709960938
Epoch: 7, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9039576053619385
Epoch: 8, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.528 Vali Acc: 0.278 Test Loss: 1.528 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9046416282653809
Epoch: 9, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.611 Vali Acc: 0.285 Test Loss: 1.611 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9101710319519043
Epoch: 10, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.682 Vali Acc: 0.300 Test Loss: 1.682 Test Acc: 0.300
Validation loss decreased (-0.292761 --> -0.300363).  Saving model ...
Epoch: 11 cost time: 0.9235665798187256
Epoch: 11, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.739 Vali Acc: 0.281 Test Loss: 1.739 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8414201736450195
Epoch: 12, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.886 Vali Acc: 0.274 Test Loss: 1.886 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.967674732208252
Epoch: 13, Steps: 17 | Train Loss: 0.715 Vali Loss: 1.984 Vali Acc: 0.274 Test Loss: 1.984 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9328272342681885
Epoch: 14, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.068 Vali Acc: 0.262 Test Loss: 2.068 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9781904220581055
Epoch: 15, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.217 Vali Acc: 0.270 Test Loss: 2.217 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9012556076049805
Epoch: 16, Steps: 17 | Train Loss: 0.609 Vali Loss: 2.297 Vali Acc: 0.278 Test Loss: 2.297 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0077996253967285
Epoch: 17, Steps: 17 | Train Loss: 0.564 Vali Loss: 2.633 Vali Acc: 0.281 Test Loss: 2.633 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8604171276092529
Epoch: 18, Steps: 17 | Train Loss: 0.557 Vali Loss: 2.734 Vali Acc: 0.255 Test Loss: 2.734 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9019074440002441
Epoch: 19, Steps: 17 | Train Loss: 0.506 Vali Loss: 3.023 Vali Acc: 0.281 Test Loss: 3.023 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9325704574584961
Epoch: 20, Steps: 17 | Train Loss: 0.501 Vali Loss: 2.964 Vali Acc: 0.266 Test Loss: 2.964 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 220484
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.120710611343384
Epoch: 1, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.377 Vali Acc: 0.266 Test Loss: 1.377 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 0.7853422164916992
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.377 Vali Acc: 0.270 Test Loss: 1.377 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 0.7907600402832031
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7854673862457275
Epoch: 4, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.381 Vali Acc: 0.232 Test Loss: 1.381 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8408992290496826
Epoch: 5, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.410 Vali Acc: 0.274 Test Loss: 1.410 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 0.856550931930542
Epoch: 6, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.408 Vali Acc: 0.285 Test Loss: 1.408 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285157).  Saving model ...
Epoch: 7 cost time: 0.9389028549194336
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9692916870117188
Epoch: 8, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.439 Vali Acc: 0.240 Test Loss: 1.439 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9111423492431641
Epoch: 9, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.528 Vali Acc: 0.281 Test Loss: 1.528 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9278433322906494
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.490 Vali Acc: 0.274 Test Loss: 1.490 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9847402572631836
Epoch: 11, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.512 Vali Acc: 0.198 Test Loss: 1.512 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.908031702041626
Epoch: 12, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.628 Vali Acc: 0.278 Test Loss: 1.628 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9642195701599121
Epoch: 13, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.641 Vali Acc: 0.300 Test Loss: 1.641 Test Acc: 0.300
Validation loss decreased (-0.285157 --> -0.300364).  Saving model ...
Epoch: 14 cost time: 0.8788731098175049
Epoch: 14, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.649 Vali Acc: 0.281 Test Loss: 1.649 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8473443984985352
Epoch: 15, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.702 Vali Acc: 0.266 Test Loss: 1.702 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8356201648712158
Epoch: 16, Steps: 17 | Train Loss: 0.793 Vali Loss: 1.682 Vali Acc: 0.278 Test Loss: 1.682 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8930599689483643
Epoch: 17, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.800 Vali Acc: 0.243 Test Loss: 1.800 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9634914398193359
Epoch: 18, Steps: 17 | Train Loss: 0.730 Vali Loss: 2.003 Vali Acc: 0.228 Test Loss: 2.003 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9409830570220947
Epoch: 19, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.077 Vali Acc: 0.240 Test Loss: 2.077 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.993384838104248
Epoch: 20, Steps: 17 | Train Loss: 0.665 Vali Loss: 2.186 Vali Acc: 0.243 Test Loss: 2.186 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.918203592300415
Epoch: 21, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.392 Vali Acc: 0.236 Test Loss: 2.392 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8538558483123779
Epoch: 22, Steps: 17 | Train Loss: 0.628 Vali Loss: 2.315 Vali Acc: 0.228 Test Loss: 2.315 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8828754425048828
Epoch: 23, Steps: 17 | Train Loss: 0.622 Vali Loss: 2.401 Vali Acc: 0.240 Test Loss: 2.401 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 192580
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.4451792240142822
Epoch: 1, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 0.8560278415679932
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.386 Vali Acc: 0.259 Test Loss: 1.386 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8423831462860107
Epoch: 3, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.403 Vali Acc: 0.278 Test Loss: 1.403 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 0.8912100791931152
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9349641799926758
Epoch: 5, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.417 Vali Acc: 0.285 Test Loss: 1.417 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 0.9169974327087402
Epoch: 6, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9205105304718018
Epoch: 7, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.459 Vali Acc: 0.285 Test Loss: 1.459 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9386656284332275
Epoch: 8, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.441 Vali Acc: 0.213 Test Loss: 1.441 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.912362813949585
Epoch: 9, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.468 Vali Acc: 0.243 Test Loss: 1.468 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.962965726852417
Epoch: 10, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.485 Vali Acc: 0.255 Test Loss: 1.485 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9632401466369629
Epoch: 11, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.492 Vali Acc: 0.243 Test Loss: 1.492 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.874826192855835
Epoch: 12, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.577 Vali Acc: 0.293 Test Loss: 1.577 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292760).  Saving model ...
Epoch: 13 cost time: 0.8710644245147705
Epoch: 13, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.606 Vali Acc: 0.240 Test Loss: 1.606 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8650870323181152
Epoch: 14, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.570 Vali Acc: 0.247 Test Loss: 1.570 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8698890209197998
Epoch: 15, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.611 Vali Acc: 0.232 Test Loss: 1.611 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9441683292388916
Epoch: 16, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.678 Vali Acc: 0.228 Test Loss: 1.678 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9294910430908203
Epoch: 17, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.737 Vali Acc: 0.266 Test Loss: 1.737 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.943669319152832
Epoch: 18, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.755 Vali Acc: 0.278 Test Loss: 1.755 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9572279453277588
Epoch: 19, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.801 Vali Acc: 0.247 Test Loss: 1.801 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9329228401184082
Epoch: 20, Steps: 17 | Train Loss: 0.740 Vali Loss: 1.859 Vali Acc: 0.243 Test Loss: 1.859 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9594123363494873
Epoch: 21, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.975 Vali Acc: 0.247 Test Loss: 1.975 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8966162204742432
Epoch: 22, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.026 Vali Acc: 0.247 Test Loss: 2.026 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 184644
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2562530040740967
Epoch: 1, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.388 Vali Acc: 0.274 Test Loss: 1.388 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.8797340393066406
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.386 Vali Acc: 0.259 Test Loss: 1.386 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8546347618103027
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.381 Vali Acc: 0.255 Test Loss: 1.381 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9352412223815918
Epoch: 4, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.391 Vali Acc: 0.278 Test Loss: 1.391 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277553).  Saving model ...
Epoch: 5 cost time: 0.9627704620361328
Epoch: 5, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9422776699066162
Epoch: 6, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.080094814300537
Epoch: 7, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.399 Vali Acc: 0.251 Test Loss: 1.399 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9908571243286133
Epoch: 8, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.422 Vali Acc: 0.255 Test Loss: 1.422 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8837873935699463
Epoch: 9, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.484 Vali Acc: 0.262 Test Loss: 1.484 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9084031581878662
Epoch: 10, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.462 Vali Acc: 0.259 Test Loss: 1.462 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9460935592651367
Epoch: 11, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.523 Vali Acc: 0.224 Test Loss: 1.523 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9682056903839111
Epoch: 12, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.489 Vali Acc: 0.232 Test Loss: 1.489 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8704760074615479
Epoch: 13, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.519 Vali Acc: 0.240 Test Loss: 1.519 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.849590539932251
Epoch: 14, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.543 Vali Acc: 0.255 Test Loss: 1.543 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 182852
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3139967918395996
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.385 Vali Acc: 0.274 Test Loss: 1.385 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.871809720993042
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8810756206512451
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.385 Vali Acc: 0.274 Test Loss: 1.385 Test Acc: 0.274
Validation loss decreased (-0.273750 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 0.8827862739562988
Epoch: 4, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.389 Vali Acc: 0.259 Test Loss: 1.389 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8353102207183838
Epoch: 5, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8342347145080566
Epoch: 6, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.384 Vali Acc: 0.232 Test Loss: 1.384 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9883747100830078
Epoch: 7, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8555693626403809
Epoch: 8, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.408 Vali Acc: 0.259 Test Loss: 1.408 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9286515712738037
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.413 Vali Acc: 0.251 Test Loss: 1.413 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8684208393096924
Epoch: 10, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8603625297546387
Epoch: 11, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.430 Vali Acc: 0.255 Test Loss: 1.430 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7982769012451172
Epoch: 12, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.461 Vali Acc: 0.251 Test Loss: 1.461 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8492372035980225
Epoch: 13, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 183812
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2298359870910645
Epoch: 1, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.392 Vali Acc: 0.232 Test Loss: 1.392 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 0.8198385238647461
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.392 Vali Acc: 0.281 Test Loss: 1.392 Test Acc: 0.281
Validation loss decreased (-0.231925 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.8048093318939209
Epoch: 3, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.389 Vali Acc: 0.251 Test Loss: 1.389 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8423547744750977
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.398 Vali Acc: 0.259 Test Loss: 1.398 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8395323753356934
Epoch: 5, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8472349643707275
Epoch: 6, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.402 Vali Acc: 0.247 Test Loss: 1.402 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9591264724731445
Epoch: 7, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.407 Vali Acc: 0.251 Test Loss: 1.407 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8410377502441406
Epoch: 8, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.426 Vali Acc: 0.266 Test Loss: 1.426 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8131978511810303
Epoch: 9, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.428 Vali Acc: 0.247 Test Loss: 1.428 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9120612144470215
Epoch: 10, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.439 Vali Acc: 0.251 Test Loss: 1.439 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8372993469238281
Epoch: 11, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.448 Vali Acc: 0.240 Test Loss: 1.448 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8658158779144287
Epoch: 12, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.445 Vali Acc: 0.274 Test Loss: 1.445 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 186372
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.298327922821045
Epoch: 1, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.404 Vali Acc: 0.251 Test Loss: 1.404 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.861818790435791
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.388 Vali Acc: 0.278 Test Loss: 1.388 Test Acc: 0.278
Validation loss decreased (-0.250937 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 0.8314712047576904
Epoch: 3, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.391 Vali Acc: 0.251 Test Loss: 1.391 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8751211166381836
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8706948757171631
Epoch: 5, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8975732326507568
Epoch: 6, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8397953510284424
Epoch: 7, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.393 Vali Acc: 0.236 Test Loss: 1.393 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8794801235198975
Epoch: 8, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.414 Vali Acc: 0.266 Test Loss: 1.414 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8445909023284912
Epoch: 9, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.412 Vali Acc: 0.266 Test Loss: 1.412 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8771328926086426
Epoch: 10, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.397 Vali Acc: 0.240 Test Loss: 1.397 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9202394485473633
Epoch: 11, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.423 Vali Acc: 0.247 Test Loss: 1.423 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8336749076843262
Epoch: 12, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.428 Vali Acc: 0.262 Test Loss: 1.428 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 190404
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.127312421798706
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.389 Vali Acc: 0.247 Test Loss: 1.389 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.8367388248443604
Epoch: 2, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8628008365631104
Epoch: 3, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.390 Vali Acc: 0.262 Test Loss: 1.390 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262344).  Saving model ...
Epoch: 4 cost time: 0.7782771587371826
Epoch: 4, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.417 Vali Acc: 0.251 Test Loss: 1.417 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7691745758056641
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8077478408813477
Epoch: 6, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.405 Vali Acc: 0.259 Test Loss: 1.405 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8086574077606201
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.407 Vali Acc: 0.266 Test Loss: 1.407 Test Acc: 0.266
Validation loss decreased (-0.262344 --> -0.266146).  Saving model ...
Epoch: 8 cost time: 0.8308119773864746
Epoch: 8, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8786487579345703
Epoch: 9, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.490 Vali Acc: 0.278 Test Loss: 1.490 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277552).  Saving model ...
Epoch: 10 cost time: 0.7829759120941162
Epoch: 10, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.515 Vali Acc: 0.243 Test Loss: 1.515 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8075802326202393
Epoch: 11, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7633764743804932
Epoch: 12, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.573 Vali Acc: 0.285 Test Loss: 1.573 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285155).  Saving model ...
Epoch: 13 cost time: 0.8503618240356445
Epoch: 13, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.599 Vali Acc: 0.270 Test Loss: 1.599 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7894458770751953
Epoch: 14, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.662 Vali Acc: 0.289 Test Loss: 1.662 Test Acc: 0.289
Validation loss decreased (-0.285155 --> -0.288957).  Saving model ...
Epoch: 15 cost time: 0.7616517543792725
Epoch: 15, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.722 Vali Acc: 0.281 Test Loss: 1.722 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7586653232574463
Epoch: 16, Steps: 17 | Train Loss: 0.762 Vali Loss: 1.701 Vali Acc: 0.270 Test Loss: 1.701 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8428277969360352
Epoch: 17, Steps: 17 | Train Loss: 0.745 Vali Loss: 1.836 Vali Acc: 0.304 Test Loss: 1.836 Test Acc: 0.304
Validation loss decreased (-0.288957 --> -0.304164).  Saving model ...
Epoch: 18 cost time: 0.8617627620697021
Epoch: 18, Steps: 17 | Train Loss: 0.736 Vali Loss: 1.922 Vali Acc: 0.289 Test Loss: 1.922 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8789148330688477
Epoch: 19, Steps: 17 | Train Loss: 0.686 Vali Loss: 1.955 Vali Acc: 0.281 Test Loss: 1.955 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8832817077636719
Epoch: 20, Steps: 17 | Train Loss: 0.675 Vali Loss: 1.905 Vali Acc: 0.312 Test Loss: 1.905 Test Acc: 0.312
Validation loss decreased (-0.304164 --> -0.311768).  Saving model ...
Epoch: 21 cost time: 0.8124809265136719
Epoch: 21, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.202 Vali Acc: 0.281 Test Loss: 2.202 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8273639678955078
Epoch: 22, Steps: 17 | Train Loss: 0.621 Vali Loss: 2.297 Vali Acc: 0.281 Test Loss: 2.297 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8395991325378418
Epoch: 23, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.376 Vali Acc: 0.300 Test Loss: 2.376 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8938627243041992
Epoch: 24, Steps: 17 | Train Loss: 0.568 Vali Loss: 2.605 Vali Acc: 0.262 Test Loss: 2.605 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7923116683959961
Epoch: 25, Steps: 17 | Train Loss: 0.534 Vali Loss: 2.516 Vali Acc: 0.278 Test Loss: 2.516 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8186819553375244
Epoch: 26, Steps: 17 | Train Loss: 0.527 Vali Loss: 2.585 Vali Acc: 0.278 Test Loss: 2.585 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8570172786712646
Epoch: 27, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.753 Vali Acc: 0.274 Test Loss: 2.753 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7825496196746826
Epoch: 28, Steps: 17 | Train Loss: 0.467 Vali Loss: 2.809 Vali Acc: 0.285 Test Loss: 2.809 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8572235107421875
Epoch: 29, Steps: 17 | Train Loss: 0.462 Vali Loss: 2.994 Vali Acc: 0.255 Test Loss: 2.994 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7691454887390137
Epoch: 30, Steps: 17 | Train Loss: 0.498 Vali Loss: 2.555 Vali Acc: 0.270 Test Loss: 2.555 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 75428
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1540613174438477
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.372 Vali Acc: 0.289 Test Loss: 1.372 Test Acc: 0.289
Validation loss decreased (inf --> -0.288960).  Saving model ...
Epoch: 2 cost time: 0.7956748008728027
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.377 Vali Acc: 0.255 Test Loss: 1.377 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8460438251495361
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.388 Vali Acc: 0.262 Test Loss: 1.388 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8640334606170654
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.810126781463623
Epoch: 5, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.386 Vali Acc: 0.278 Test Loss: 1.386 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.824073076248169
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.396 Vali Acc: 0.266 Test Loss: 1.396 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7725155353546143
Epoch: 7, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.394 Vali Acc: 0.278 Test Loss: 1.394 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8726205825805664
Epoch: 8, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.386 Vali Acc: 0.255 Test Loss: 1.386 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8097870349884033
Epoch: 9, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.404 Vali Acc: 0.293 Test Loss: 1.404 Test Acc: 0.293
Validation loss decreased (-0.288960 --> -0.292762).  Saving model ...
Epoch: 10 cost time: 0.7408299446105957
Epoch: 10, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.405 Vali Acc: 0.278 Test Loss: 1.405 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8172452449798584
Epoch: 11, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.446 Vali Acc: 0.285 Test Loss: 1.446 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7892041206359863
Epoch: 12, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.435 Vali Acc: 0.270 Test Loss: 1.435 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8621585369110107
Epoch: 13, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.504 Vali Acc: 0.259 Test Loss: 1.504 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8199453353881836
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.474 Vali Acc: 0.285 Test Loss: 1.474 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7240347862243652
Epoch: 15, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.533 Vali Acc: 0.274 Test Loss: 1.533 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7901227474212646
Epoch: 16, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.502 Vali Acc: 0.293 Test Loss: 1.502 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7980527877807617
Epoch: 17, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.600 Vali Acc: 0.285 Test Loss: 1.600 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8398373126983643
Epoch: 18, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.610 Vali Acc: 0.281 Test Loss: 1.610 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8005282878875732
Epoch: 19, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.658 Vali Acc: 0.274 Test Loss: 1.658 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 61476
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.22825288772583
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.390 Vali Acc: 0.247 Test Loss: 1.390 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 0.8891439437866211
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.385 Vali Acc: 0.270 Test Loss: 1.385 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 0.8158812522888184
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.386 Vali Acc: 0.281 Test Loss: 1.386 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 0.8324844837188721
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.387 Vali Acc: 0.247 Test Loss: 1.387 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8105576038360596
Epoch: 5, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.383 Vali Acc: 0.293 Test Loss: 1.383 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292762).  Saving model ...
Epoch: 6 cost time: 0.7275853157043457
Epoch: 6, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.384 Vali Acc: 0.251 Test Loss: 1.384 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8700766563415527
Epoch: 7, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.389 Vali Acc: 0.278 Test Loss: 1.389 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8044600486755371
Epoch: 8, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.840174674987793
Epoch: 9, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.393 Vali Acc: 0.247 Test Loss: 1.393 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7725155353546143
Epoch: 10, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7722699642181396
Epoch: 11, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7617695331573486
Epoch: 12, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.436 Vali Acc: 0.243 Test Loss: 1.436 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7676739692687988
Epoch: 13, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.445 Vali Acc: 0.224 Test Loss: 1.445 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7535481452941895
Epoch: 14, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.468 Vali Acc: 0.262 Test Loss: 1.468 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7901959419250488
Epoch: 15, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.500 Vali Acc: 0.228 Test Loss: 1.500 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 57508
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.084549903869629
Epoch: 1, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 0.82387375831604
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.375 Vali Acc: 0.281 Test Loss: 1.375 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.8513283729553223
Epoch: 3, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.373 Vali Acc: 0.285 Test Loss: 1.373 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 0.7685940265655518
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.376 Vali Acc: 0.247 Test Loss: 1.376 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7629959583282471
Epoch: 5, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.377 Vali Acc: 0.270 Test Loss: 1.377 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8167986869812012
Epoch: 6, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.377 Vali Acc: 0.247 Test Loss: 1.377 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7821321487426758
Epoch: 7, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.388 Vali Acc: 0.240 Test Loss: 1.388 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8326992988586426
Epoch: 8, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.788071870803833
Epoch: 9, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.392 Vali Acc: 0.236 Test Loss: 1.392 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7587900161743164
Epoch: 10, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7574124336242676
Epoch: 11, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.389 Vali Acc: 0.243 Test Loss: 1.389 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8173270225524902
Epoch: 12, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.402 Vali Acc: 0.247 Test Loss: 1.402 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8202250003814697
Epoch: 13, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.396 Vali Acc: 0.285 Test Loss: 1.396 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 56612
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.270963668823242
Epoch: 1, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.384 Vali Acc: 0.251 Test Loss: 1.384 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 0.7379233837127686
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.379 Vali Acc: 0.221 Test Loss: 1.379 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7260596752166748
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.376 Vali Acc: 0.232 Test Loss: 1.376 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7791531085968018
Epoch: 4, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.382 Vali Acc: 0.247 Test Loss: 1.382 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8200147151947021
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.379 Vali Acc: 0.232 Test Loss: 1.379 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8263885974884033
Epoch: 6, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.378 Vali Acc: 0.232 Test Loss: 1.378 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7810840606689453
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.382 Vali Acc: 0.247 Test Loss: 1.382 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8676114082336426
Epoch: 8, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.385 Vali Acc: 0.247 Test Loss: 1.385 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8653523921966553
Epoch: 9, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.388 Vali Acc: 0.251 Test Loss: 1.388 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8890268802642822
Epoch: 10, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.383 Vali Acc: 0.259 Test Loss: 1.383 Test Acc: 0.259
Validation loss decreased (-0.250937 --> -0.258541).  Saving model ...
Epoch: 11 cost time: 0.7705957889556885
Epoch: 11, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.387 Vali Acc: 0.236 Test Loss: 1.387 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7300975322723389
Epoch: 12, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.404 Vali Acc: 0.278 Test Loss: 1.404 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277553).  Saving model ...
Epoch: 13 cost time: 0.8808162212371826
Epoch: 13, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.402 Vali Acc: 0.278 Test Loss: 1.402 Test Acc: 0.278
Validation loss decreased (-0.277553 --> -0.277553).  Saving model ...
Epoch: 14 cost time: 0.8488421440124512
Epoch: 14, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9781196117401123
Epoch: 15, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.429 Vali Acc: 0.262 Test Loss: 1.429 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8552935123443604
Epoch: 16, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.426 Vali Acc: 0.259 Test Loss: 1.426 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7154073715209961
Epoch: 17, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.435 Vali Acc: 0.247 Test Loss: 1.435 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7822813987731934
Epoch: 18, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.436 Vali Acc: 0.270 Test Loss: 1.436 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8222618103027344
Epoch: 19, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.443 Vali Acc: 0.262 Test Loss: 1.443 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8876261711120605
Epoch: 20, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.494 Vali Acc: 0.243 Test Loss: 1.494 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9022502899169922
Epoch: 21, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.850792646408081
Epoch: 22, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.497 Vali Acc: 0.259 Test Loss: 1.497 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9588119983673096
Epoch: 23, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 57092
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2511749267578125
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.404 Vali Acc: 0.240 Test Loss: 1.404 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 0.8007135391235352
Epoch: 2, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.389 Vali Acc: 0.217 Test Loss: 1.389 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8538985252380371
Epoch: 3, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.389 Vali Acc: 0.209 Test Loss: 1.389 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8502609729766846
Epoch: 4, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.394 Vali Acc: 0.274 Test Loss: 1.394 Test Acc: 0.274
Validation loss decreased (-0.239530 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 0.8200128078460693
Epoch: 5, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.384 Vali Acc: 0.255 Test Loss: 1.384 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8147256374359131
Epoch: 6, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.385 Vali Acc: 0.259 Test Loss: 1.385 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7891373634338379
Epoch: 7, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.384 Vali Acc: 0.255 Test Loss: 1.384 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8547394275665283
Epoch: 8, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.382 Vali Acc: 0.255 Test Loss: 1.382 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7914161682128906
Epoch: 9, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.395 Vali Acc: 0.240 Test Loss: 1.395 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8189136981964111
Epoch: 10, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.389 Vali Acc: 0.236 Test Loss: 1.389 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8467836380004883
Epoch: 11, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.413 Vali Acc: 0.236 Test Loss: 1.413 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8352720737457275
Epoch: 12, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.395 Vali Acc: 0.228 Test Loss: 1.395 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8052043914794922
Epoch: 13, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.387 Vali Acc: 0.278 Test Loss: 1.387 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277553).  Saving model ...
Epoch: 14 cost time: 0.8283228874206543
Epoch: 14, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.394 Vali Acc: 0.259 Test Loss: 1.394 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8274486064910889
Epoch: 15, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8826673030853271
Epoch: 16, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.404 Vali Acc: 0.240 Test Loss: 1.404 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8391010761260986
Epoch: 17, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8184092044830322
Epoch: 18, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8338110446929932
Epoch: 19, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.465 Vali Acc: 0.251 Test Loss: 1.465 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8500518798828125
Epoch: 20, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.439 Vali Acc: 0.243 Test Loss: 1.439 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8176398277282715
Epoch: 21, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.488 Vali Acc: 0.278 Test Loss: 1.488 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.779137372970581
Epoch: 22, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.468 Vali Acc: 0.236 Test Loss: 1.468 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.838507890701294
Epoch: 23, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.493 Vali Acc: 0.255 Test Loss: 1.493 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 58372
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0031843185424805
Epoch: 1, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.395 Vali Acc: 0.259 Test Loss: 1.395 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.8233346939086914
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.389 Vali Acc: 0.247 Test Loss: 1.389 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7566251754760742
Epoch: 3, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.394 Vali Acc: 0.281 Test Loss: 1.394 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 0.7787566184997559
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.391 Vali Acc: 0.278 Test Loss: 1.391 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8781111240386963
Epoch: 5, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.390 Vali Acc: 0.228 Test Loss: 1.390 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8195400238037109
Epoch: 6, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.385 Vali Acc: 0.247 Test Loss: 1.385 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8904261589050293
Epoch: 7, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.387 Vali Acc: 0.240 Test Loss: 1.387 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8265595436096191
Epoch: 8, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.414 Vali Acc: 0.209 Test Loss: 1.414 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8413963317871094
Epoch: 9, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.388 Vali Acc: 0.236 Test Loss: 1.388 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8017175197601318
Epoch: 10, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8144903182983398
Epoch: 11, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8516714572906494
Epoch: 12, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.432 Vali Acc: 0.217 Test Loss: 1.432 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7683217525482178
Epoch: 13, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.438 Vali Acc: 0.224 Test Loss: 1.438 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 60388
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3930325508117676
Epoch: 1, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.717 Vali Acc: 0.240 Test Loss: 1.717 Test Acc: 0.240
Validation loss decreased (inf --> -0.239527).  Saving model ...
Epoch: 2 cost time: 1.0385584831237793
Epoch: 2, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.603 Vali Acc: 0.259 Test Loss: 1.603 Test Acc: 0.259
Validation loss decreased (-0.239527 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 0.8618028163909912
Epoch: 3, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.827 Vali Acc: 0.262 Test Loss: 1.827 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262339).  Saving model ...
Epoch: 4 cost time: 1.1725289821624756
Epoch: 4, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.782 Vali Acc: 0.240 Test Loss: 1.782 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1481690406799316
Epoch: 5, Steps: 17 | Train Loss: 1.098 Vali Loss: 2.277 Vali Acc: 0.255 Test Loss: 2.277 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1936912536621094
Epoch: 6, Steps: 17 | Train Loss: 1.311 Vali Loss: 2.106 Vali Acc: 0.270 Test Loss: 2.106 Test Acc: 0.270
Validation loss decreased (-0.262339 --> -0.269941).  Saving model ...
Epoch: 7 cost time: 1.0405538082122803
Epoch: 7, Steps: 17 | Train Loss: 0.960 Vali Loss: 2.238 Vali Acc: 0.259 Test Loss: 2.238 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1048071384429932
Epoch: 8, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.655 Vali Acc: 0.240 Test Loss: 2.655 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.997330904006958
Epoch: 9, Steps: 17 | Train Loss: 0.910 Vali Loss: 2.784 Vali Acc: 0.270 Test Loss: 2.784 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.012803077697754
Epoch: 10, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.356 Vali Acc: 0.224 Test Loss: 2.356 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0265789031982422
Epoch: 11, Steps: 17 | Train Loss: 0.754 Vali Loss: 2.668 Vali Acc: 0.259 Test Loss: 2.668 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0975213050842285
Epoch: 12, Steps: 17 | Train Loss: 0.710 Vali Loss: 3.070 Vali Acc: 0.266 Test Loss: 3.070 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.09698486328125
Epoch: 13, Steps: 17 | Train Loss: 0.747 Vali Loss: 3.169 Vali Acc: 0.266 Test Loss: 3.169 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0975048542022705
Epoch: 14, Steps: 17 | Train Loss: 0.562 Vali Loss: 3.301 Vali Acc: 0.293 Test Loss: 3.301 Test Acc: 0.293
Validation loss decreased (-0.269941 --> -0.292743).  Saving model ...
Epoch: 15 cost time: 0.9977536201477051
Epoch: 15, Steps: 17 | Train Loss: 0.698 Vali Loss: 3.938 Vali Acc: 0.289 Test Loss: 3.938 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0849800109863281
Epoch: 16, Steps: 17 | Train Loss: 0.667 Vali Loss: 3.279 Vali Acc: 0.243 Test Loss: 3.279 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0829575061798096
Epoch: 17, Steps: 17 | Train Loss: 0.448 Vali Loss: 3.529 Vali Acc: 0.274 Test Loss: 3.529 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0423245429992676
Epoch: 18, Steps: 17 | Train Loss: 0.430 Vali Loss: 3.900 Vali Acc: 0.278 Test Loss: 3.900 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.104269027709961
Epoch: 19, Steps: 17 | Train Loss: 0.452 Vali Loss: 4.905 Vali Acc: 0.255 Test Loss: 4.905 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1562845706939697
Epoch: 20, Steps: 17 | Train Loss: 0.420 Vali Loss: 3.914 Vali Acc: 0.270 Test Loss: 3.914 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1182520389556885
Epoch: 21, Steps: 17 | Train Loss: 0.592 Vali Loss: 4.869 Vali Acc: 0.240 Test Loss: 4.869 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1351344585418701
Epoch: 22, Steps: 17 | Train Loss: 0.454 Vali Loss: 5.324 Vali Acc: 0.243 Test Loss: 5.324 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0668034553527832
Epoch: 23, Steps: 17 | Train Loss: 0.382 Vali Loss: 5.632 Vali Acc: 0.266 Test Loss: 5.632 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0490608215332031
Epoch: 24, Steps: 17 | Train Loss: 0.436 Vali Loss: 5.522 Vali Acc: 0.255 Test Loss: 5.522 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 673028
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.922222375869751
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 0.7675390243530273
Epoch: 2, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.653 Vali Acc: 0.266 Test Loss: 1.653 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8217871189117432
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.582 Vali Acc: 0.255 Test Loss: 1.582 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.733417272567749
Epoch: 4, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.589 Vali Acc: 0.289 Test Loss: 1.589 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288957).  Saving model ...
Epoch: 5 cost time: 0.7209641933441162
Epoch: 5, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.704 Vali Acc: 0.255 Test Loss: 1.704 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.736851692199707
Epoch: 6, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.793 Vali Acc: 0.255 Test Loss: 1.793 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8526673316955566
Epoch: 7, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.801 Vali Acc: 0.259 Test Loss: 1.801 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8631644248962402
Epoch: 8, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.792 Vali Acc: 0.243 Test Loss: 1.792 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8852145671844482
Epoch: 9, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.930 Vali Acc: 0.274 Test Loss: 1.930 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8719439506530762
Epoch: 10, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.159 Vali Acc: 0.255 Test Loss: 2.159 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8280913829803467
Epoch: 11, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.252 Vali Acc: 0.259 Test Loss: 2.252 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8813316822052002
Epoch: 12, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.499 Vali Acc: 0.262 Test Loss: 2.499 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.806511402130127
Epoch: 13, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.565 Vali Acc: 0.262 Test Loss: 2.565 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.860675573348999
Epoch: 14, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.527 Vali Acc: 0.281 Test Loss: 2.527 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 561412
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.096811056137085
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.8435008525848389
Epoch: 2, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.464 Vali Acc: 0.255 Test Loss: 1.464 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8739047050476074
Epoch: 3, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.468 Vali Acc: 0.259 Test Loss: 1.468 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9855465888977051
Epoch: 4, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.518 Vali Acc: 0.247 Test Loss: 1.518 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8837101459503174
Epoch: 5, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.674 Vali Acc: 0.247 Test Loss: 1.674 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9330282211303711
Epoch: 6, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.579 Vali Acc: 0.232 Test Loss: 1.579 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.863861083984375
Epoch: 7, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.731 Vali Acc: 0.232 Test Loss: 1.731 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9386930465698242
Epoch: 8, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.890 Vali Acc: 0.205 Test Loss: 1.890 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.011711835861206
Epoch: 9, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.808 Vali Acc: 0.221 Test Loss: 1.808 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9157850742340088
Epoch: 10, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.976 Vali Acc: 0.262 Test Loss: 1.976 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262338).  Saving model ...
Epoch: 11 cost time: 0.9692583084106445
Epoch: 11, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.988 Vali Acc: 0.251 Test Loss: 1.988 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8595485687255859
Epoch: 12, Steps: 17 | Train Loss: 0.876 Vali Loss: 2.014 Vali Acc: 0.243 Test Loss: 2.014 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9025857448577881
Epoch: 13, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.118 Vali Acc: 0.278 Test Loss: 2.118 Test Acc: 0.278
Validation loss decreased (-0.262338 --> -0.277545).  Saving model ...
Epoch: 14 cost time: 0.8519594669342041
Epoch: 14, Steps: 17 | Train Loss: 0.766 Vali Loss: 2.198 Vali Acc: 0.240 Test Loss: 2.198 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.034508466720581
Epoch: 15, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.209 Vali Acc: 0.247 Test Loss: 2.209 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9510982036590576
Epoch: 16, Steps: 17 | Train Loss: 0.628 Vali Loss: 2.435 Vali Acc: 0.259 Test Loss: 2.435 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.925670862197876
Epoch: 17, Steps: 17 | Train Loss: 0.686 Vali Loss: 2.453 Vali Acc: 0.262 Test Loss: 2.453 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9552195072174072
Epoch: 18, Steps: 17 | Train Loss: 0.650 Vali Loss: 2.934 Vali Acc: 0.251 Test Loss: 2.934 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.953885555267334
Epoch: 19, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.651 Vali Acc: 0.255 Test Loss: 2.651 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8845651149749756
Epoch: 20, Steps: 17 | Train Loss: 0.533 Vali Loss: 2.959 Vali Acc: 0.259 Test Loss: 2.959 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8806848526000977
Epoch: 21, Steps: 17 | Train Loss: 0.614 Vali Loss: 2.735 Vali Acc: 0.259 Test Loss: 2.735 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8741893768310547
Epoch: 22, Steps: 17 | Train Loss: 0.619 Vali Loss: 3.076 Vali Acc: 0.232 Test Loss: 3.076 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.833906888961792
Epoch: 23, Steps: 17 | Train Loss: 0.626 Vali Loss: 2.704 Vali Acc: 0.224 Test Loss: 2.704 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 532740
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.343430280685425
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.450 Vali Acc: 0.255 Test Loss: 1.450 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 0.8884978294372559
Epoch: 2, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.494 Vali Acc: 0.270 Test Loss: 1.494 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 0.9759624004364014
Epoch: 3, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.563 Vali Acc: 0.247 Test Loss: 1.563 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8294727802276611
Epoch: 4, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.508 Vali Acc: 0.274 Test Loss: 1.508 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 0.847653865814209
Epoch: 5, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.542 Vali Acc: 0.247 Test Loss: 1.542 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8839597702026367
Epoch: 6, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.530 Vali Acc: 0.259 Test Loss: 1.530 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9218499660491943
Epoch: 7, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.657 Vali Acc: 0.266 Test Loss: 1.657 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8301177024841309
Epoch: 8, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.719 Vali Acc: 0.285 Test Loss: 1.719 Test Acc: 0.285
Validation loss decreased (-0.273749 --> -0.285154).  Saving model ...
Epoch: 9 cost time: 0.8756239414215088
Epoch: 9, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.785 Vali Acc: 0.243 Test Loss: 1.785 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8412060737609863
Epoch: 10, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.671 Vali Acc: 0.255 Test Loss: 1.671 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8438661098480225
Epoch: 11, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.912 Vali Acc: 0.232 Test Loss: 1.912 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9589056968688965
Epoch: 12, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.876 Vali Acc: 0.232 Test Loss: 1.876 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9409091472625732
Epoch: 13, Steps: 17 | Train Loss: 0.777 Vali Loss: 2.007 Vali Acc: 0.247 Test Loss: 2.007 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9019713401794434
Epoch: 14, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.137 Vali Acc: 0.247 Test Loss: 2.137 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9409606456756592
Epoch: 15, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.101 Vali Acc: 0.240 Test Loss: 2.101 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8829052448272705
Epoch: 16, Steps: 17 | Train Loss: 0.729 Vali Loss: 2.140 Vali Acc: 0.259 Test Loss: 2.140 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.838550329208374
Epoch: 17, Steps: 17 | Train Loss: 0.635 Vali Loss: 2.011 Vali Acc: 0.251 Test Loss: 2.011 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8953580856323242
Epoch: 18, Steps: 17 | Train Loss: 0.719 Vali Loss: 2.311 Vali Acc: 0.251 Test Loss: 2.311 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 522500
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2524852752685547
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.417 Vali Acc: 0.251 Test Loss: 1.417 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 0.853489875793457
Epoch: 2, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.467 Vali Acc: 0.262 Test Loss: 1.467 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 0.8291265964508057
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.495 Vali Acc: 0.243 Test Loss: 1.495 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.897820234298706
Epoch: 4, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.492 Vali Acc: 0.281 Test Loss: 1.492 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 0.8135910034179688
Epoch: 5, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.563 Vali Acc: 0.262 Test Loss: 1.563 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9345860481262207
Epoch: 6, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.521 Vali Acc: 0.236 Test Loss: 1.521 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8085789680480957
Epoch: 7, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.517 Vali Acc: 0.209 Test Loss: 1.517 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8577075004577637
Epoch: 8, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.595 Vali Acc: 0.274 Test Loss: 1.595 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8537206649780273
Epoch: 9, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.770 Vali Acc: 0.274 Test Loss: 1.770 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8380715847015381
Epoch: 10, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.633 Vali Acc: 0.240 Test Loss: 1.633 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8015551567077637
Epoch: 11, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.733 Vali Acc: 0.255 Test Loss: 1.733 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8296210765838623
Epoch: 12, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.657 Vali Acc: 0.243 Test Loss: 1.657 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8179633617401123
Epoch: 13, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.698 Vali Acc: 0.259 Test Loss: 1.698 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.883359432220459
Epoch: 14, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.943 Vali Acc: 0.285 Test Loss: 1.943 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285152).  Saving model ...
Epoch: 15 cost time: 0.8813045024871826
Epoch: 15, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.816 Vali Acc: 0.278 Test Loss: 1.816 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8736464977264404
Epoch: 16, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.869 Vali Acc: 0.251 Test Loss: 1.869 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8370659351348877
Epoch: 17, Steps: 17 | Train Loss: 0.781 Vali Loss: 1.871 Vali Acc: 0.243 Test Loss: 1.871 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9054727554321289
Epoch: 18, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.992 Vali Acc: 0.247 Test Loss: 1.992 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8391246795654297
Epoch: 19, Steps: 17 | Train Loss: 0.696 Vali Loss: 2.073 Vali Acc: 0.247 Test Loss: 2.073 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8132696151733398
Epoch: 20, Steps: 17 | Train Loss: 0.723 Vali Loss: 2.080 Vali Acc: 0.240 Test Loss: 2.080 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8794686794281006
Epoch: 21, Steps: 17 | Train Loss: 0.769 Vali Loss: 2.156 Vali Acc: 0.243 Test Loss: 2.156 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8965029716491699
Epoch: 22, Steps: 17 | Train Loss: 0.765 Vali Loss: 2.200 Vali Acc: 0.262 Test Loss: 2.200 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8304872512817383
Epoch: 23, Steps: 17 | Train Loss: 0.696 Vali Loss: 2.614 Vali Acc: 0.251 Test Loss: 2.614 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9094493389129639
Epoch: 24, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.262 Vali Acc: 0.251 Test Loss: 2.262 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 526340
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1130475997924805
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.411 Vali Acc: 0.316 Test Loss: 1.411 Test Acc: 0.316
Validation loss decreased (inf --> -0.315575).  Saving model ...
Epoch: 2 cost time: 0.8227453231811523
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.421 Vali Acc: 0.281 Test Loss: 1.421 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.905829668045044
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.391 Vali Acc: 0.251 Test Loss: 1.391 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7862327098846436
Epoch: 4, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.440 Vali Acc: 0.247 Test Loss: 1.440 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8158648014068604
Epoch: 5, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.535 Vali Acc: 0.262 Test Loss: 1.535 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8262283802032471
Epoch: 6, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.475 Vali Acc: 0.247 Test Loss: 1.475 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8620796203613281
Epoch: 7, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.587 Vali Acc: 0.251 Test Loss: 1.587 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8000073432922363
Epoch: 8, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8292391300201416
Epoch: 9, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.523 Vali Acc: 0.240 Test Loss: 1.523 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7798933982849121
Epoch: 10, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.657 Vali Acc: 0.247 Test Loss: 1.657 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8471405506134033
Epoch: 11, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.862 Vali Acc: 0.251 Test Loss: 1.862 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 536580
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0700159072875977
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.434 Vali Acc: 0.251 Test Loss: 1.434 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 0.850966215133667
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.504 Vali Acc: 0.217 Test Loss: 1.504 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8683335781097412
Epoch: 3, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.422 Vali Acc: 0.240 Test Loss: 1.422 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9201085567474365
Epoch: 4, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.448 Vali Acc: 0.240 Test Loss: 1.448 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7929067611694336
Epoch: 5, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.568 Vali Acc: 0.213 Test Loss: 1.568 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8547666072845459
Epoch: 6, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.494 Vali Acc: 0.255 Test Loss: 1.494 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254738).  Saving model ...
Epoch: 7 cost time: 0.8311276435852051
Epoch: 7, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.521 Vali Acc: 0.228 Test Loss: 1.521 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9122469425201416
Epoch: 8, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.527 Vali Acc: 0.228 Test Loss: 1.527 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8885252475738525
Epoch: 9, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.875 Vali Acc: 0.262 Test Loss: 1.875 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262339).  Saving model ...
Epoch: 10 cost time: 0.8683719635009766
Epoch: 10, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.716 Vali Acc: 0.232 Test Loss: 1.716 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8609945774078369
Epoch: 11, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.808 Vali Acc: 0.251 Test Loss: 1.808 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8347845077514648
Epoch: 12, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.806 Vali Acc: 0.255 Test Loss: 1.806 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7632803916931152
Epoch: 13, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.664 Vali Acc: 0.251 Test Loss: 1.664 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.814650297164917
Epoch: 14, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.813 Vali Acc: 0.232 Test Loss: 1.813 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.839653491973877
Epoch: 15, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.793 Vali Acc: 0.251 Test Loss: 1.793 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.802436351776123
Epoch: 16, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.991 Vali Acc: 0.240 Test Loss: 1.991 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.735762357711792
Epoch: 17, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.844 Vali Acc: 0.236 Test Loss: 1.844 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7185225486755371
Epoch: 18, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.165 Vali Acc: 0.247 Test Loss: 2.165 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8311758041381836
Epoch: 19, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.916 Vali Acc: 0.243 Test Loss: 1.916 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 552708
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0778205394744873
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.430 Vali Acc: 0.255 Test Loss: 1.430 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.7935817241668701
Epoch: 2, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8437886238098145
Epoch: 3, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.617 Vali Acc: 0.274 Test Loss: 1.617 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273748).  Saving model ...
Epoch: 4 cost time: 0.79789137840271
Epoch: 4, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.585 Vali Acc: 0.236 Test Loss: 1.585 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7880837917327881
Epoch: 5, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.828 Vali Acc: 0.251 Test Loss: 1.828 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8356738090515137
Epoch: 6, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.813 Vali Acc: 0.251 Test Loss: 1.813 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.773090124130249
Epoch: 7, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.965 Vali Acc: 0.262 Test Loss: 1.965 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8728048801422119
Epoch: 8, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.893 Vali Acc: 0.243 Test Loss: 1.893 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8893134593963623
Epoch: 9, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.184 Vali Acc: 0.240 Test Loss: 2.184 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8967206478118896
Epoch: 10, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.137 Vali Acc: 0.247 Test Loss: 2.137 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8121190071105957
Epoch: 11, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.617 Vali Acc: 0.259 Test Loss: 2.617 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8358454704284668
Epoch: 12, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.585 Vali Acc: 0.209 Test Loss: 2.585 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8688583374023438
Epoch: 13, Steps: 17 | Train Loss: 0.730 Vali Loss: 2.819 Vali Acc: 0.240 Test Loss: 2.819 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 238212
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2041280269622803
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.443 Vali Acc: 0.255 Test Loss: 1.443 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 0.8094346523284912
Epoch: 2, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.436 Vali Acc: 0.247 Test Loss: 1.436 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8062150478363037
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.507 Vali Acc: 0.274 Test Loss: 1.507 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 0.7803802490234375
Epoch: 4, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.466 Vali Acc: 0.266 Test Loss: 1.466 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8616354465484619
Epoch: 5, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.525 Vali Acc: 0.262 Test Loss: 1.525 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7853224277496338
Epoch: 6, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.604 Vali Acc: 0.274 Test Loss: 1.604 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.841681957244873
Epoch: 7, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.661 Vali Acc: 0.274 Test Loss: 1.661 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8306691646575928
Epoch: 8, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.611 Vali Acc: 0.224 Test Loss: 1.611 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8473935127258301
Epoch: 9, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.726 Vali Acc: 0.240 Test Loss: 1.726 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8400588035583496
Epoch: 10, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.748 Vali Acc: 0.255 Test Loss: 1.748 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7428905963897705
Epoch: 11, Steps: 17 | Train Loss: 0.808 Vali Loss: 1.894 Vali Acc: 0.251 Test Loss: 1.894 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7585892677307129
Epoch: 12, Steps: 17 | Train Loss: 0.745 Vali Loss: 1.878 Vali Acc: 0.255 Test Loss: 1.878 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6999273300170898
Epoch: 13, Steps: 17 | Train Loss: 0.754 Vali Loss: 2.264 Vali Acc: 0.274 Test Loss: 2.264 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 182404
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.029160261154175
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.376 Vali Acc: 0.308 Test Loss: 1.376 Test Acc: 0.308
Validation loss decreased (inf --> -0.307971).  Saving model ...
Epoch: 2 cost time: 0.8224036693572998
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.410 Vali Acc: 0.289 Test Loss: 1.410 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.777998685836792
Epoch: 3, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.771735429763794
Epoch: 4, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.587 Vali Acc: 0.259 Test Loss: 1.587 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6898214817047119
Epoch: 5, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.566 Vali Acc: 0.285 Test Loss: 1.566 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.718541145324707
Epoch: 6, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.591 Vali Acc: 0.285 Test Loss: 1.591 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7620832920074463
Epoch: 7, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.538 Vali Acc: 0.266 Test Loss: 1.538 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.74369215965271
Epoch: 8, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.528 Vali Acc: 0.270 Test Loss: 1.528 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7933454513549805
Epoch: 9, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.543 Vali Acc: 0.266 Test Loss: 1.543 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7921276092529297
Epoch: 10, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.676 Vali Acc: 0.266 Test Loss: 1.676 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7625393867492676
Epoch: 11, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.825 Vali Acc: 0.262 Test Loss: 1.825 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 168068
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1452746391296387
Epoch: 1, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.433 Vali Acc: 0.255 Test Loss: 1.433 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.8540589809417725
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.445 Vali Acc: 0.247 Test Loss: 1.445 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7821485996246338
Epoch: 3, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.445 Vali Acc: 0.209 Test Loss: 1.445 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7181031703948975
Epoch: 4, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.432 Vali Acc: 0.255 Test Loss: 1.432 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 5 cost time: 0.7179625034332275
Epoch: 5, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.541 Vali Acc: 0.255 Test Loss: 1.541 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.696270227432251
Epoch: 6, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.569 Vali Acc: 0.281 Test Loss: 1.569 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281353).  Saving model ...
Epoch: 7 cost time: 0.7168765068054199
Epoch: 7, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.492 Vali Acc: 0.240 Test Loss: 1.492 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7219283580780029
Epoch: 8, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.606 Vali Acc: 0.247 Test Loss: 1.606 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6855142116546631
Epoch: 9, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.559 Vali Acc: 0.243 Test Loss: 1.559 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7493765354156494
Epoch: 10, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7565362453460693
Epoch: 11, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.628 Vali Acc: 0.270 Test Loss: 1.628 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7536840438842773
Epoch: 12, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.637 Vali Acc: 0.297 Test Loss: 1.637 Test Acc: 0.297
Validation loss decreased (-0.281353 --> -0.296562).  Saving model ...
Epoch: 13 cost time: 0.7767164707183838
Epoch: 13, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.688 Vali Acc: 0.251 Test Loss: 1.688 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7296452522277832
Epoch: 14, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.722 Vali Acc: 0.243 Test Loss: 1.722 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7225117683410645
Epoch: 15, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.788 Vali Acc: 0.255 Test Loss: 1.788 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7444760799407959
Epoch: 16, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.026 Vali Acc: 0.270 Test Loss: 2.026 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7736067771911621
Epoch: 17, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.975 Vali Acc: 0.251 Test Loss: 1.975 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7135050296783447
Epoch: 18, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.002 Vali Acc: 0.285 Test Loss: 2.002 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7264821529388428
Epoch: 19, Steps: 17 | Train Loss: 0.695 Vali Loss: 2.030 Vali Acc: 0.266 Test Loss: 2.030 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.814690351486206
Epoch: 20, Steps: 17 | Train Loss: 0.749 Vali Loss: 2.002 Vali Acc: 0.232 Test Loss: 2.002 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7795820236206055
Epoch: 21, Steps: 17 | Train Loss: 0.685 Vali Loss: 2.093 Vali Acc: 0.270 Test Loss: 2.093 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7896718978881836
Epoch: 22, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.183 Vali Acc: 0.281 Test Loss: 2.183 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 162948
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0994200706481934
Epoch: 1, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.397 Vali Acc: 0.266 Test Loss: 1.397 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 0.8307409286499023
Epoch: 2, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.397 Vali Acc: 0.266 Test Loss: 1.397 Test Acc: 0.266
Validation loss decreased (-0.266146 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 0.8244755268096924
Epoch: 3, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.412 Vali Acc: 0.232 Test Loss: 1.412 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7994060516357422
Epoch: 4, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.433 Vali Acc: 0.274 Test Loss: 1.433 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 0.9430997371673584
Epoch: 5, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.462 Vali Acc: 0.278 Test Loss: 1.462 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 0.718085527420044
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.465 Vali Acc: 0.266 Test Loss: 1.465 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7973904609680176
Epoch: 7, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6692123413085938
Epoch: 8, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.449 Vali Acc: 0.281 Test Loss: 1.449 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 9 cost time: 0.7014496326446533
Epoch: 9, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.479 Vali Acc: 0.266 Test Loss: 1.479 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6538488864898682
Epoch: 10, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.550 Vali Acc: 0.247 Test Loss: 1.550 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.852494478225708
Epoch: 11, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.518 Vali Acc: 0.266 Test Loss: 1.518 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7949323654174805
Epoch: 12, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.594 Vali Acc: 0.255 Test Loss: 1.594 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8916823863983154
Epoch: 13, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.572 Vali Acc: 0.251 Test Loss: 1.572 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8774495124816895
Epoch: 14, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.621 Vali Acc: 0.255 Test Loss: 1.621 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8052048683166504
Epoch: 15, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.643 Vali Acc: 0.266 Test Loss: 1.643 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9065062999725342
Epoch: 16, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.776 Vali Acc: 0.266 Test Loss: 1.776 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7985966205596924
Epoch: 17, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.762 Vali Acc: 0.243 Test Loss: 1.762 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7234988212585449
Epoch: 18, Steps: 17 | Train Loss: 0.804 Vali Loss: 1.694 Vali Acc: 0.228 Test Loss: 1.694 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 164868
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.986067295074463
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.385 Vali Acc: 0.255 Test Loss: 1.385 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 0.7577102184295654
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.383 Vali Acc: 0.281 Test Loss: 1.383 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 0.8306055068969727
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.412 Vali Acc: 0.259 Test Loss: 1.412 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7430241107940674
Epoch: 4, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6582651138305664
Epoch: 5, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.457 Vali Acc: 0.228 Test Loss: 1.457 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7280352115631104
Epoch: 6, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.444 Vali Acc: 0.304 Test Loss: 1.444 Test Acc: 0.304
Validation loss decreased (-0.281355 --> -0.304168).  Saving model ...
Epoch: 7 cost time: 0.6830089092254639
Epoch: 7, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.553 Vali Acc: 0.285 Test Loss: 1.553 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6712517738342285
Epoch: 8, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.548 Vali Acc: 0.232 Test Loss: 1.548 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.718071460723877
Epoch: 9, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.542 Vali Acc: 0.281 Test Loss: 1.542 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7915925979614258
Epoch: 10, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.531 Vali Acc: 0.251 Test Loss: 1.531 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8526859283447266
Epoch: 11, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.532 Vali Acc: 0.190 Test Loss: 1.532 Test Acc: 0.190
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.768488883972168
Epoch: 12, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.570 Vali Acc: 0.243 Test Loss: 1.570 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7932968139648438
Epoch: 13, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.591 Vali Acc: 0.247 Test Loss: 1.591 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7425072193145752
Epoch: 14, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.650 Vali Acc: 0.251 Test Loss: 1.650 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8044958114624023
Epoch: 15, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.665 Vali Acc: 0.232 Test Loss: 1.665 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7847511768341064
Epoch: 16, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.872 Vali Acc: 0.270 Test Loss: 1.872 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 169988
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2178800106048584
Epoch: 1, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.417 Vali Acc: 0.300 Test Loss: 1.417 Test Acc: 0.300
Validation loss decreased (inf --> -0.300366).  Saving model ...
Epoch: 2 cost time: 0.7960505485534668
Epoch: 2, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.391 Vali Acc: 0.304 Test Loss: 1.391 Test Acc: 0.304
Validation loss decreased (-0.300366 --> -0.304169).  Saving model ...
Epoch: 3 cost time: 0.815990686416626
Epoch: 3, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.395 Vali Acc: 0.240 Test Loss: 1.395 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7682225704193115
Epoch: 4, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.417 Vali Acc: 0.278 Test Loss: 1.417 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7737388610839844
Epoch: 5, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7982320785522461
Epoch: 6, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.450 Vali Acc: 0.278 Test Loss: 1.450 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7690930366516113
Epoch: 7, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.443 Vali Acc: 0.232 Test Loss: 1.443 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7923202514648438
Epoch: 8, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.467 Vali Acc: 0.243 Test Loss: 1.467 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8710384368896484
Epoch: 9, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.456 Vali Acc: 0.259 Test Loss: 1.456 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8078224658966064
Epoch: 10, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.504 Vali Acc: 0.281 Test Loss: 1.504 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6567642688751221
Epoch: 11, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.610 Vali Acc: 0.281 Test Loss: 1.610 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7704005241394043
Epoch: 12, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.527 Vali Acc: 0.255 Test Loss: 1.527 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 178052
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.035745859146118
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.413 Vali Acc: 0.240 Test Loss: 1.413 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 0.7599234580993652
Epoch: 2, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.445 Vali Acc: 0.251 Test Loss: 1.445 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 0.9105527400970459
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.681 Vali Acc: 0.247 Test Loss: 1.681 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8263649940490723
Epoch: 4, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.431 Vali Acc: 0.247 Test Loss: 1.431 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7878038883209229
Epoch: 5, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.514 Vali Acc: 0.262 Test Loss: 1.514 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262342).  Saving model ...
Epoch: 6 cost time: 0.791801929473877
Epoch: 6, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.499 Vali Acc: 0.247 Test Loss: 1.499 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7519228458404541
Epoch: 7, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.656 Vali Acc: 0.251 Test Loss: 1.656 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7111978530883789
Epoch: 8, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.609 Vali Acc: 0.255 Test Loss: 1.609 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7445220947265625
Epoch: 9, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.754 Vali Acc: 0.247 Test Loss: 1.754 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7286410331726074
Epoch: 10, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.764 Vali Acc: 0.262 Test Loss: 1.764 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7750513553619385
Epoch: 11, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.849 Vali Acc: 0.270 Test Loss: 1.849 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269943).  Saving model ...
Epoch: 12 cost time: 0.6924166679382324
Epoch: 12, Steps: 17 | Train Loss: 0.733 Vali Loss: 1.892 Vali Acc: 0.262 Test Loss: 1.892 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.750417947769165
Epoch: 13, Steps: 17 | Train Loss: 0.711 Vali Loss: 1.879 Vali Acc: 0.274 Test Loss: 1.879 Test Acc: 0.274
Validation loss decreased (-0.269943 --> -0.273745).  Saving model ...
Epoch: 14 cost time: 0.7460775375366211
Epoch: 14, Steps: 17 | Train Loss: 0.667 Vali Loss: 2.059 Vali Acc: 0.247 Test Loss: 2.059 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7926206588745117
Epoch: 15, Steps: 17 | Train Loss: 0.642 Vali Loss: 2.305 Vali Acc: 0.270 Test Loss: 2.305 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6232602596282959
Epoch: 16, Steps: 17 | Train Loss: 0.707 Vali Loss: 2.240 Vali Acc: 0.270 Test Loss: 2.240 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7376985549926758
Epoch: 17, Steps: 17 | Train Loss: 0.627 Vali Loss: 2.468 Vali Acc: 0.281 Test Loss: 2.468 Test Acc: 0.281
Validation loss decreased (-0.273745 --> -0.281344).  Saving model ...
Epoch: 18 cost time: 0.731356143951416
Epoch: 18, Steps: 17 | Train Loss: 0.558 Vali Loss: 2.405 Vali Acc: 0.243 Test Loss: 2.405 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6794023513793945
Epoch: 19, Steps: 17 | Train Loss: 0.569 Vali Loss: 2.661 Vali Acc: 0.297 Test Loss: 2.661 Test Acc: 0.297
Validation loss decreased (-0.281344 --> -0.296551).  Saving model ...
Epoch: 20 cost time: 0.718827486038208
Epoch: 20, Steps: 17 | Train Loss: 0.543 Vali Loss: 2.757 Vali Acc: 0.285 Test Loss: 2.757 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7222700119018555
Epoch: 21, Steps: 17 | Train Loss: 0.560 Vali Loss: 2.903 Vali Acc: 0.270 Test Loss: 2.903 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7143411636352539
Epoch: 22, Steps: 17 | Train Loss: 0.536 Vali Loss: 2.833 Vali Acc: 0.236 Test Loss: 2.833 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8200163841247559
Epoch: 23, Steps: 17 | Train Loss: 0.466 Vali Loss: 3.051 Vali Acc: 0.236 Test Loss: 3.051 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.825639009475708
Epoch: 24, Steps: 17 | Train Loss: 0.528 Vali Loss: 2.750 Vali Acc: 0.278 Test Loss: 2.750 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7720663547515869
Epoch: 25, Steps: 17 | Train Loss: 0.491 Vali Loss: 3.088 Vali Acc: 0.270 Test Loss: 3.088 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.678675651550293
Epoch: 26, Steps: 17 | Train Loss: 0.418 Vali Loss: 3.206 Vali Acc: 0.243 Test Loss: 3.206 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7632443904876709
Epoch: 27, Steps: 17 | Train Loss: 0.457 Vali Loss: 3.490 Vali Acc: 0.259 Test Loss: 3.490 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.694572925567627
Epoch: 28, Steps: 17 | Train Loss: 0.404 Vali Loss: 3.236 Vali Acc: 0.247 Test Loss: 3.236 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6887590885162354
Epoch: 29, Steps: 17 | Train Loss: 0.394 Vali Loss: 3.728 Vali Acc: 0.262 Test Loss: 3.728 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 94532
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9497556686401367
Epoch: 1, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 0.7297728061676025
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.407 Vali Acc: 0.240 Test Loss: 1.407 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7760772705078125
Epoch: 3, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.402 Vali Acc: 0.236 Test Loss: 1.402 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.700897216796875
Epoch: 4, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.451 Vali Acc: 0.304 Test Loss: 1.451 Test Acc: 0.304
Validation loss decreased (-0.258541 --> -0.304168).  Saving model ...
Epoch: 5 cost time: 0.7055935859680176
Epoch: 5, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.436 Vali Acc: 0.247 Test Loss: 1.436 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7160773277282715
Epoch: 6, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7230734825134277
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.496 Vali Acc: 0.224 Test Loss: 1.496 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6913094520568848
Epoch: 8, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.521 Vali Acc: 0.262 Test Loss: 1.521 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7225048542022705
Epoch: 9, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.599 Vali Acc: 0.228 Test Loss: 1.599 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7302618026733398
Epoch: 10, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.545 Vali Acc: 0.228 Test Loss: 1.545 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7099881172180176
Epoch: 11, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.841 Vali Acc: 0.228 Test Loss: 1.841 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7121963500976562
Epoch: 12, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.658 Vali Acc: 0.228 Test Loss: 1.658 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6934115886688232
Epoch: 13, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.708 Vali Acc: 0.236 Test Loss: 1.708 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7008528709411621
Epoch: 14, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.655 Vali Acc: 0.251 Test Loss: 1.655 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 66628
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9175090789794922
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.442 Vali Acc: 0.228 Test Loss: 1.442 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 0.6672706604003906
Epoch: 2, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.456 Vali Acc: 0.236 Test Loss: 1.456 Test Acc: 0.236
Validation loss decreased (-0.228122 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 0.7141430377960205
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 4 cost time: 0.652656078338623
Epoch: 4, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.456 Vali Acc: 0.259 Test Loss: 1.456 Test Acc: 0.259
Validation loss decreased (-0.243331 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 0.7295126914978027
Epoch: 5, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.489 Vali Acc: 0.228 Test Loss: 1.489 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6882576942443848
Epoch: 6, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.489 Vali Acc: 0.259 Test Loss: 1.489 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7528097629547119
Epoch: 7, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.503 Vali Acc: 0.236 Test Loss: 1.503 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7657420635223389
Epoch: 8, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.501 Vali Acc: 0.247 Test Loss: 1.501 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7351901531219482
Epoch: 9, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.528 Vali Acc: 0.228 Test Loss: 1.528 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.749603271484375
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.584 Vali Acc: 0.251 Test Loss: 1.584 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.729755163192749
Epoch: 11, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.552 Vali Acc: 0.205 Test Loss: 1.552 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7437551021575928
Epoch: 12, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.629 Vali Acc: 0.243 Test Loss: 1.629 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7248985767364502
Epoch: 13, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.612 Vali Acc: 0.243 Test Loss: 1.612 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7117264270782471
Epoch: 14, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.661 Vali Acc: 0.240 Test Loss: 1.661 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 59460
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0515758991241455
Epoch: 1, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.399 Vali Acc: 0.224 Test Loss: 1.399 Test Acc: 0.224
Validation loss decreased (inf --> -0.224321).  Saving model ...
Epoch: 2 cost time: 0.7612981796264648
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.396 Vali Acc: 0.232 Test Loss: 1.396 Test Acc: 0.232
Validation loss decreased (-0.224321 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 0.714618444442749
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.410 Vali Acc: 0.236 Test Loss: 1.410 Test Acc: 0.236
Validation loss decreased (-0.231925 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 0.717041015625
Epoch: 4, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
Validation loss decreased (-0.235727 --> -0.250936).  Saving model ...
Epoch: 5 cost time: 0.7676308155059814
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.425 Vali Acc: 0.240 Test Loss: 1.425 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7607088088989258
Epoch: 6, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.424 Vali Acc: 0.247 Test Loss: 1.424 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8089644908905029
Epoch: 7, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.413 Vali Acc: 0.255 Test Loss: 1.413 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254739).  Saving model ...
Epoch: 8 cost time: 0.7800371646881104
Epoch: 8, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7863063812255859
Epoch: 9, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.463 Vali Acc: 0.243 Test Loss: 1.463 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.78898024559021
Epoch: 10, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.474 Vali Acc: 0.285 Test Loss: 1.474 Test Acc: 0.285
Validation loss decreased (-0.254739 --> -0.285156).  Saving model ...
Epoch: 11 cost time: 0.7732183933258057
Epoch: 11, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.473 Vali Acc: 0.259 Test Loss: 1.473 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7245643138885498
Epoch: 12, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.478 Vali Acc: 0.259 Test Loss: 1.478 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7858312129974365
Epoch: 13, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.569 Vali Acc: 0.232 Test Loss: 1.569 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7290389537811279
Epoch: 14, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.536 Vali Acc: 0.243 Test Loss: 1.536 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7629055976867676
Epoch: 15, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.533 Vali Acc: 0.247 Test Loss: 1.533 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6994929313659668
Epoch: 16, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.547 Vali Acc: 0.259 Test Loss: 1.547 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7693660259246826
Epoch: 17, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.604 Vali Acc: 0.243 Test Loss: 1.604 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.719947338104248
Epoch: 18, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.713 Vali Acc: 0.232 Test Loss: 1.713 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7536087036132812
Epoch: 19, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.646 Vali Acc: 0.278 Test Loss: 1.646 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.640678882598877
Epoch: 20, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.682 Vali Acc: 0.232 Test Loss: 1.682 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 56900
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1768875122070312
Epoch: 1, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.372 Vali Acc: 0.281 Test Loss: 1.372 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 0.6547534465789795
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.372 Vali Acc: 0.278 Test Loss: 1.372 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6974484920501709
Epoch: 3, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.389 Vali Acc: 0.274 Test Loss: 1.389 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7302556037902832
Epoch: 4, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.382 Vali Acc: 0.281 Test Loss: 1.382 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7009599208831787
Epoch: 5, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.391 Vali Acc: 0.251 Test Loss: 1.391 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7675342559814453
Epoch: 6, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.401 Vali Acc: 0.274 Test Loss: 1.401 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7058525085449219
Epoch: 7, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.422 Vali Acc: 0.247 Test Loss: 1.422 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6595206260681152
Epoch: 8, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.419 Vali Acc: 0.289 Test Loss: 1.419 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288959).  Saving model ...
Epoch: 9 cost time: 0.7303400039672852
Epoch: 9, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.436 Vali Acc: 0.285 Test Loss: 1.436 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6677818298339844
Epoch: 10, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6595385074615479
Epoch: 11, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.437 Vali Acc: 0.285 Test Loss: 1.437 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.660407543182373
Epoch: 12, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.490 Vali Acc: 0.243 Test Loss: 1.490 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6557602882385254
Epoch: 13, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.471 Vali Acc: 0.281 Test Loss: 1.471 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.620612621307373
Epoch: 14, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.473 Vali Acc: 0.251 Test Loss: 1.473 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8352830410003662
Epoch: 15, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.480 Vali Acc: 0.232 Test Loss: 1.480 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7014999389648438
Epoch: 16, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.537 Vali Acc: 0.251 Test Loss: 1.537 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6709799766540527
Epoch: 17, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.564 Vali Acc: 0.259 Test Loss: 1.564 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.677600622177124
Epoch: 18, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.571 Vali Acc: 0.274 Test Loss: 1.571 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 57860
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1435132026672363
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.408 Vali Acc: 0.274 Test Loss: 1.408 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.6373882293701172
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.400 Vali Acc: 0.247 Test Loss: 1.400 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6750855445861816
Epoch: 3, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.403 Vali Acc: 0.262 Test Loss: 1.403 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7123117446899414
Epoch: 4, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.412 Vali Acc: 0.251 Test Loss: 1.412 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6859252452850342
Epoch: 5, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.409 Vali Acc: 0.281 Test Loss: 1.409 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281355).  Saving model ...
Epoch: 6 cost time: 0.7176198959350586
Epoch: 6, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.432 Vali Acc: 0.251 Test Loss: 1.432 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6554539203643799
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.427 Vali Acc: 0.228 Test Loss: 1.427 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7126152515411377
Epoch: 8, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.450 Vali Acc: 0.236 Test Loss: 1.450 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8110425472259521
Epoch: 9, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.475 Vali Acc: 0.266 Test Loss: 1.475 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6846928596496582
Epoch: 10, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.457 Vali Acc: 0.217 Test Loss: 1.457 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6699991226196289
Epoch: 11, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.499 Vali Acc: 0.255 Test Loss: 1.499 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6680750846862793
Epoch: 12, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.495 Vali Acc: 0.217 Test Loss: 1.495 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7059271335601807
Epoch: 13, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.509 Vali Acc: 0.247 Test Loss: 1.509 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.70064377784729
Epoch: 14, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.542 Vali Acc: 0.240 Test Loss: 1.542 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7553648948669434
Epoch: 15, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.503 Vali Acc: 0.266 Test Loss: 1.503 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 60420
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.893094778060913
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.406 Vali Acc: 0.224 Test Loss: 1.406 Test Acc: 0.224
Validation loss decreased (inf --> -0.224321).  Saving model ...
Epoch: 2 cost time: 0.6811702251434326
Epoch: 2, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
Validation loss decreased (-0.224321 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 0.7043068408966064
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 0.6755342483520508
Epoch: 4, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.408 Vali Acc: 0.221 Test Loss: 1.408 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7275476455688477
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.399 Vali Acc: 0.247 Test Loss: 1.399 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6776251792907715
Epoch: 6, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.417 Vali Acc: 0.232 Test Loss: 1.417 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7286744117736816
Epoch: 7, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6907458305358887
Epoch: 8, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.426 Vali Acc: 0.247 Test Loss: 1.426 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6735029220581055
Epoch: 9, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.422 Vali Acc: 0.228 Test Loss: 1.422 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6828012466430664
Epoch: 10, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.436 Vali Acc: 0.247 Test Loss: 1.436 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7002646923065186
Epoch: 11, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.442 Vali Acc: 0.240 Test Loss: 1.442 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7182202339172363
Epoch: 12, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.483 Vali Acc: 0.236 Test Loss: 1.483 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.678950309753418
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.524 Vali Acc: 0.304 Test Loss: 1.524 Test Acc: 0.304
Validation loss decreased (-0.266146 --> -0.304167).  Saving model ...
Epoch: 14 cost time: 0.657292366027832
Epoch: 14, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.509 Vali Acc: 0.240 Test Loss: 1.509 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.67708420753479
Epoch: 15, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.536 Vali Acc: 0.247 Test Loss: 1.536 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6889517307281494
Epoch: 16, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.570 Vali Acc: 0.312 Test Loss: 1.570 Test Acc: 0.312
Validation loss decreased (-0.304167 --> -0.311771).  Saving model ...
Epoch: 17 cost time: 0.6935617923736572
Epoch: 17, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.503 Vali Acc: 0.259 Test Loss: 1.503 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7245955467224121
Epoch: 18, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.535 Vali Acc: 0.228 Test Loss: 1.535 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7219729423522949
Epoch: 19, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.667 Vali Acc: 0.247 Test Loss: 1.667 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6720385551452637
Epoch: 20, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.705 Vali Acc: 0.240 Test Loss: 1.705 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7096741199493408
Epoch: 21, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.694 Vali Acc: 0.243 Test Loss: 1.694 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7033758163452148
Epoch: 22, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.590723991394043
Epoch: 23, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.709 Vali Acc: 0.262 Test Loss: 1.709 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6685614585876465
Epoch: 24, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.715 Vali Acc: 0.289 Test Loss: 1.715 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.702415943145752
Epoch: 25, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.826 Vali Acc: 0.262 Test Loss: 1.826 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.705214262008667
Epoch: 26, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.770 Vali Acc: 0.251 Test Loss: 1.770 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 64452
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2861571311950684
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.369 Vali Acc: 0.262 Test Loss: 1.369 Test Acc: 0.262
Validation loss decreased (inf --> -0.262344).  Saving model ...
Epoch: 2 cost time: 0.764777421951294
Epoch: 2, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.396 Vali Acc: 0.266 Test Loss: 1.396 Test Acc: 0.266
Validation loss decreased (-0.262344 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 0.773916482925415
Epoch: 3, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 0.7778723239898682
Epoch: 4, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.419 Vali Acc: 0.289 Test Loss: 1.419 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 0.6523613929748535
Epoch: 5, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6881823539733887
Epoch: 6, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.430 Vali Acc: 0.224 Test Loss: 1.430 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7556681632995605
Epoch: 7, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.618 Vali Acc: 0.285 Test Loss: 1.618 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7822794914245605
Epoch: 8, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.510 Vali Acc: 0.274 Test Loss: 1.510 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8106038570404053
Epoch: 9, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.541 Vali Acc: 0.255 Test Loss: 1.541 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7672255039215088
Epoch: 10, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.526 Vali Acc: 0.262 Test Loss: 1.526 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7504260540008545
Epoch: 11, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.599 Vali Acc: 0.266 Test Loss: 1.599 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7072868347167969
Epoch: 12, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.749 Vali Acc: 0.247 Test Loss: 1.749 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7519867420196533
Epoch: 13, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.656 Vali Acc: 0.278 Test Loss: 1.656 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7773890495300293
Epoch: 14, Steps: 17 | Train Loss: 0.819 Vali Loss: 1.696 Vali Acc: 0.247 Test Loss: 1.696 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps44_str22_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 41124
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1970255374908447
Epoch: 1, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.426 Vali Acc: 0.266 Test Loss: 1.426 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 0.6981029510498047
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.451 Vali Acc: 0.224 Test Loss: 1.451 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6944353580474854
Epoch: 3, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.428 Vali Acc: 0.251 Test Loss: 1.428 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7740828990936279
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6882176399230957
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.408 Vali Acc: 0.297 Test Loss: 1.408 Test Acc: 0.297
Validation loss decreased (-0.266145 --> -0.296564).  Saving model ...
Epoch: 6 cost time: 0.7291250228881836
Epoch: 6, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.443 Vali Acc: 0.289 Test Loss: 1.443 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6930892467498779
Epoch: 7, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7257852554321289
Epoch: 8, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.481 Vali Acc: 0.224 Test Loss: 1.481 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7502813339233398
Epoch: 9, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.472 Vali Acc: 0.262 Test Loss: 1.472 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7530615329742432
Epoch: 10, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.478 Vali Acc: 0.285 Test Loss: 1.478 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8102645874023438
Epoch: 11, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.513 Vali Acc: 0.232 Test Loss: 1.513 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7623841762542725
Epoch: 12, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.499 Vali Acc: 0.297 Test Loss: 1.499 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7346832752227783
Epoch: 13, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.514 Vali Acc: 0.255 Test Loss: 1.514 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7077219486236572
Epoch: 14, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.562 Vali Acc: 0.278 Test Loss: 1.562 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6765694618225098
Epoch: 15, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.561 Vali Acc: 0.281 Test Loss: 1.561 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps88_str44_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 27172
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.023331642150879
Epoch: 1, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.434 Vali Acc: 0.205 Test Loss: 1.434 Test Acc: 0.205
Validation loss decreased (inf --> -0.205309).  Saving model ...
Epoch: 2 cost time: 0.7921421527862549
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.412 Vali Acc: 0.224 Test Loss: 1.412 Test Acc: 0.224
Validation loss decreased (-0.205309 --> -0.224320).  Saving model ...
Epoch: 3 cost time: 0.703087329864502
Epoch: 3, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.430 Vali Acc: 0.224 Test Loss: 1.430 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6968157291412354
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
Validation loss decreased (-0.224320 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 0.7637746334075928
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.440 Vali Acc: 0.213 Test Loss: 1.440 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7267639636993408
Epoch: 6, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.432 Vali Acc: 0.224 Test Loss: 1.432 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.746523380279541
Epoch: 7, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.443 Vali Acc: 0.247 Test Loss: 1.443 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7920935153961182
Epoch: 8, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.487 Vali Acc: 0.240 Test Loss: 1.487 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7598593235015869
Epoch: 9, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.499 Vali Acc: 0.247 Test Loss: 1.499 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7422270774841309
Epoch: 10, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.494 Vali Acc: 0.243 Test Loss: 1.494 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7307460308074951
Epoch: 11, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.512 Vali Acc: 0.217 Test Loss: 1.512 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6567933559417725
Epoch: 12, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.530 Vali Acc: 0.232 Test Loss: 1.530 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.76444411277771
Epoch: 13, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.539 Vali Acc: 0.243 Test Loss: 1.539 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7824835777282715
Epoch: 14, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.559 Vali Acc: 0.232 Test Loss: 1.559 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps132_str66_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 23588
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.038174629211426
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.401 Vali Acc: 0.289 Test Loss: 1.401 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 0.8009672164916992
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.389 Vali Acc: 0.281 Test Loss: 1.389 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7713503837585449
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.387 Vali Acc: 0.285 Test Loss: 1.387 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7434566020965576
Epoch: 4, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7970521450042725
Epoch: 5, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.393 Vali Acc: 0.251 Test Loss: 1.393 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7829041481018066
Epoch: 6, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.391 Vali Acc: 0.259 Test Loss: 1.391 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7415440082550049
Epoch: 7, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.405 Vali Acc: 0.251 Test Loss: 1.405 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7802934646606445
Epoch: 8, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.416 Vali Acc: 0.255 Test Loss: 1.416 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7709417343139648
Epoch: 9, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.425 Vali Acc: 0.224 Test Loss: 1.425 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8417794704437256
Epoch: 10, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8033053874969482
Epoch: 11, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps176_str88_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 22308
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.076552629470825
Epoch: 1, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.394 Vali Acc: 0.274 Test Loss: 1.394 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 0.7344808578491211
Epoch: 2, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.395 Vali Acc: 0.293 Test Loss: 1.395 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292762).  Saving model ...
Epoch: 3 cost time: 0.7934901714324951
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7620327472686768
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.413 Vali Acc: 0.274 Test Loss: 1.413 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8157243728637695
Epoch: 5, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.386 Vali Acc: 0.297 Test Loss: 1.386 Test Acc: 0.297
Validation loss decreased (-0.292762 --> -0.296564).  Saving model ...
Epoch: 6 cost time: 0.7750120162963867
Epoch: 6, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.399 Vali Acc: 0.274 Test Loss: 1.399 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7400722503662109
Epoch: 7, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.394 Vali Acc: 0.312 Test Loss: 1.394 Test Acc: 0.312
Validation loss decreased (-0.296564 --> -0.311773).  Saving model ...
Epoch: 8 cost time: 0.7293961048126221
Epoch: 8, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.407 Vali Acc: 0.281 Test Loss: 1.407 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7110512256622314
Epoch: 9, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.402 Vali Acc: 0.300 Test Loss: 1.402 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6662266254425049
Epoch: 10, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.408 Vali Acc: 0.274 Test Loss: 1.408 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6464090347290039
Epoch: 11, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.433 Vali Acc: 0.240 Test Loss: 1.433 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6766157150268555
Epoch: 12, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6714346408843994
Epoch: 13, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.444 Vali Acc: 0.255 Test Loss: 1.444 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7331364154815674
Epoch: 14, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.439 Vali Acc: 0.240 Test Loss: 1.439 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7902810573577881
Epoch: 15, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.440 Vali Acc: 0.281 Test Loss: 1.440 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.789776086807251
Epoch: 16, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.489 Vali Acc: 0.255 Test Loss: 1.489 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7620368003845215
Epoch: 17, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.464 Vali Acc: 0.240 Test Loss: 1.464 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps263_str132_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 22788
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9402272701263428
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.429 Vali Acc: 0.232 Test Loss: 1.429 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 0.6691691875457764
Epoch: 2, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.418 Vali Acc: 0.266 Test Loss: 1.418 Test Acc: 0.266
Validation loss decreased (-0.231925 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 0.7725005149841309
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.415 Vali Acc: 0.240 Test Loss: 1.415 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7447137832641602
Epoch: 4, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.413 Vali Acc: 0.243 Test Loss: 1.413 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7368197441101074
Epoch: 5, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.403 Vali Acc: 0.262 Test Loss: 1.403 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7487790584564209
Epoch: 6, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7440483570098877
Epoch: 7, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 8 cost time: 0.7226340770721436
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7563040256500244
Epoch: 9, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.412 Vali Acc: 0.259 Test Loss: 1.412 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6927099227905273
Epoch: 10, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.413 Vali Acc: 0.255 Test Loss: 1.413 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7890746593475342
Epoch: 11, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.435 Vali Acc: 0.274 Test Loss: 1.435 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273750).  Saving model ...
Epoch: 12 cost time: 0.7871053218841553
Epoch: 12, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.444 Vali Acc: 0.243 Test Loss: 1.444 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7919881343841553
Epoch: 13, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8010575771331787
Epoch: 14, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.455 Vali Acc: 0.255 Test Loss: 1.455 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7833325862884521
Epoch: 15, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.484 Vali Acc: 0.255 Test Loss: 1.484 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8367869853973389
Epoch: 16, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.448 Vali Acc: 0.266 Test Loss: 1.448 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7835991382598877
Epoch: 17, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.517 Vali Acc: 0.270 Test Loss: 1.517 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7599985599517822
Epoch: 18, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.504 Vali Acc: 0.251 Test Loss: 1.504 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7492425441741943
Epoch: 19, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.526 Vali Acc: 0.259 Test Loss: 1.526 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.700920820236206
Epoch: 20, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.519 Vali Acc: 0.243 Test Loss: 1.519 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8362319469451904
Epoch: 21, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.562 Vali Acc: 0.270 Test Loss: 1.562 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps351_str176_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 24068
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0331852436065674
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.457 Vali Acc: 0.262 Test Loss: 1.457 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 0.8145232200622559
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.416 Vali Acc: 0.221 Test Loss: 1.416 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8075714111328125
Epoch: 3, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.403 Vali Acc: 0.236 Test Loss: 1.403 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7734997272491455
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.402 Vali Acc: 0.259 Test Loss: 1.402 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7871055603027344
Epoch: 5, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.397 Vali Acc: 0.232 Test Loss: 1.397 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9136781692504883
Epoch: 6, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.401 Vali Acc: 0.228 Test Loss: 1.401 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7961940765380859
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.396 Vali Acc: 0.240 Test Loss: 1.396 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8481206893920898
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.411 Vali Acc: 0.278 Test Loss: 1.411 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 0.8185250759124756
Epoch: 9, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7945072650909424
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.402 Vali Acc: 0.281 Test Loss: 1.402 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281355).  Saving model ...
Epoch: 11 cost time: 0.7853286266326904
Epoch: 11, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.417 Vali Acc: 0.255 Test Loss: 1.417 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7372779846191406
Epoch: 12, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.416 Vali Acc: 0.266 Test Loss: 1.416 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.749943733215332
Epoch: 13, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.438 Vali Acc: 0.262 Test Loss: 1.438 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.754225492477417
Epoch: 14, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.420 Vali Acc: 0.297 Test Loss: 1.420 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296564).  Saving model ...
Epoch: 15 cost time: 0.79099440574646
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.430 Vali Acc: 0.281 Test Loss: 1.430 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7882444858551025
Epoch: 16, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.479 Vali Acc: 0.270 Test Loss: 1.479 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.770740270614624
Epoch: 17, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.455 Vali Acc: 0.255 Test Loss: 1.455 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8064625263214111
Epoch: 18, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.455 Vali Acc: 0.319 Test Loss: 1.455 Test Acc: 0.319
Validation loss decreased (-0.296564 --> -0.319377).  Saving model ...
Epoch: 19 cost time: 0.8161606788635254
Epoch: 19, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.477 Vali Acc: 0.281 Test Loss: 1.477 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8272461891174316
Epoch: 20, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.483 Vali Acc: 0.274 Test Loss: 1.483 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8294110298156738
Epoch: 21, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.507 Vali Acc: 0.312 Test Loss: 1.507 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7865736484527588
Epoch: 22, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.507 Vali Acc: 0.270 Test Loss: 1.507 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7757043838500977
Epoch: 23, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.564 Vali Acc: 0.278 Test Loss: 1.564 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.799757719039917
Epoch: 24, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.529 Vali Acc: 0.297 Test Loss: 1.529 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7938535213470459
Epoch: 25, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.503 Vali Acc: 0.304 Test Loss: 1.503 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7761456966400146
Epoch: 26, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.593 Vali Acc: 0.270 Test Loss: 1.593 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7602205276489258
Epoch: 27, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.560 Vali Acc: 0.285 Test Loss: 1.560 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.738898515701294
Epoch: 28, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.612 Vali Acc: 0.270 Test Loss: 1.612 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_ModernTCN_UEA_ftM_sl1751_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps438_str219_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 26084
model size : 0.11MB
