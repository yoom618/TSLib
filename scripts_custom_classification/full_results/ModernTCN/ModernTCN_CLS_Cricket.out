Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8514485359191895
Epoch: 1, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.452 Vali Acc: 0.153 Test Loss: 2.452 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.4959757328033447
Epoch: 2, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.326 Vali Acc: 0.444 Test Loss: 2.326 Test Acc: 0.444
Validation loss decreased (-0.152753 --> -0.444421).  Saving model ...
Epoch: 3 cost time: 0.5258047580718994
Epoch: 3, Steps: 7 | Train Loss: 1.898 Vali Loss: 2.063 Vali Acc: 0.806 Test Loss: 2.063 Test Acc: 0.806
Validation loss decreased (-0.444421 --> -0.805535).  Saving model ...
Epoch: 4 cost time: 0.5801253318786621
Epoch: 4, Steps: 7 | Train Loss: 1.438 Vali Loss: 1.652 Vali Acc: 0.833 Test Loss: 1.652 Test Acc: 0.833
Validation loss decreased (-0.805535 --> -0.833317).  Saving model ...
Epoch: 5 cost time: 0.5234074592590332
Epoch: 5, Steps: 7 | Train Loss: 0.930 Vali Loss: 1.145 Vali Acc: 0.889 Test Loss: 1.145 Test Acc: 0.889
Validation loss decreased (-0.833317 --> -0.888877).  Saving model ...
Epoch: 6 cost time: 0.5140116214752197
Epoch: 6, Steps: 7 | Train Loss: 0.480 Vali Loss: 0.705 Vali Acc: 0.903 Test Loss: 0.705 Test Acc: 0.903
Validation loss decreased (-0.888877 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 0.4908714294433594
Epoch: 7, Steps: 7 | Train Loss: 0.195 Vali Loss: 0.417 Vali Acc: 0.917 Test Loss: 0.417 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.5117073059082031
Epoch: 8, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.5175948143005371
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.5664660930633545
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5251946449279785
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5361623764038086
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5523166656494141
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.49817347526550293
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.46991634368896484
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.48644423484802246
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.44944143295288086
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6284472942352295
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.48889994621276855
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.4511699676513672
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.6271662712097168
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5180432796478271
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.48003149032592773
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.5622644424438477
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5152809619903564
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5029709339141846
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5614123344421387
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.49440574645996094
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5573453903198242
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5032157897949219
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5173337459564209
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5420167446136475
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5606975555419922
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.47483372688293457
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.48995065689086914
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.5426816940307617
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5038723945617676
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5251388549804688
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5897154808044434
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.49131274223327637
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.562751054763794
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5878677368164062
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5090427398681641
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.5440113544464111
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.4860367774963379
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5046401023864746
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.5372359752655029
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5125019550323486
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5310678482055664
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5101606845855713
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1346412
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5874333381652832
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.496 Vali Acc: 0.042 Test Loss: 2.496 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 0.48482227325439453
Epoch: 2, Steps: 7 | Train Loss: 2.442 Vali Loss: 2.405 Vali Acc: 0.236 Test Loss: 2.405 Test Acc: 0.236
Validation loss decreased (-0.041642 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 0.4725329875946045
Epoch: 3, Steps: 7 | Train Loss: 2.175 Vali Loss: 2.216 Vali Acc: 0.625 Test Loss: 2.216 Test Acc: 0.625
Validation loss decreased (-0.236087 --> -0.624978).  Saving model ...
Epoch: 4 cost time: 0.5263564586639404
Epoch: 4, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.918 Vali Acc: 0.750 Test Loss: 1.918 Test Acc: 0.750
Validation loss decreased (-0.624978 --> -0.749981).  Saving model ...
Epoch: 5 cost time: 0.5323467254638672
Epoch: 5, Steps: 7 | Train Loss: 1.453 Vali Loss: 1.535 Vali Acc: 0.806 Test Loss: 1.535 Test Acc: 0.806
Validation loss decreased (-0.749981 --> -0.805540).  Saving model ...
Epoch: 6 cost time: 0.49754858016967773
Epoch: 6, Steps: 7 | Train Loss: 1.047 Vali Loss: 1.114 Vali Acc: 0.847 Test Loss: 1.114 Test Acc: 0.847
Validation loss decreased (-0.805540 --> -0.847211).  Saving model ...
Epoch: 7 cost time: 0.5110311508178711
Epoch: 7, Steps: 7 | Train Loss: 0.651 Vali Loss: 0.733 Vali Acc: 0.889 Test Loss: 0.733 Test Acc: 0.889
Validation loss decreased (-0.847211 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 0.49242711067199707
Epoch: 8, Steps: 7 | Train Loss: 0.345 Vali Loss: 0.483 Vali Acc: 0.917 Test Loss: 0.483 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.49712204933166504
Epoch: 9, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.370 Vali Acc: 0.931 Test Loss: 0.370 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.49071168899536133
Epoch: 10, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4878509044647217
Epoch: 11, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.49634242057800293
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.47316527366638184
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.4967787265777588
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.4983530044555664
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5319790840148926
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.49943017959594727
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5014159679412842
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.533179521560669
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5114059448242188
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.47840023040771484
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6300709247589111
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5070116519927979
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.4855639934539795
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5044808387756348
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4567408561706543
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4981241226196289
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5134379863739014
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.49457764625549316
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5232515335083008
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5217235088348389
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.46140193939208984
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5172269344329834
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1255212
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4786670207977295
Epoch: 1, Steps: 7 | Train Loss: 2.478 Vali Loss: 2.452 Vali Acc: 0.097 Test Loss: 2.452 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.5469038486480713
Epoch: 2, Steps: 7 | Train Loss: 2.375 Vali Loss: 2.372 Vali Acc: 0.319 Test Loss: 2.372 Test Acc: 0.319
Validation loss decreased (-0.097198 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 0.5509374141693115
Epoch: 3, Steps: 7 | Train Loss: 2.188 Vali Loss: 2.222 Vali Acc: 0.611 Test Loss: 2.222 Test Acc: 0.611
Validation loss decreased (-0.319421 --> -0.611089).  Saving model ...
Epoch: 4 cost time: 0.5118374824523926
Epoch: 4, Steps: 7 | Train Loss: 1.958 Vali Loss: 2.012 Vali Acc: 0.792 Test Loss: 2.012 Test Acc: 0.792
Validation loss decreased (-0.611089 --> -0.791647).  Saving model ...
Epoch: 5 cost time: 0.46209239959716797
Epoch: 5, Steps: 7 | Train Loss: 1.687 Vali Loss: 1.745 Vali Acc: 0.847 Test Loss: 1.745 Test Acc: 0.847
Validation loss decreased (-0.791647 --> -0.847205).  Saving model ...
Epoch: 6 cost time: 0.5373554229736328
Epoch: 6, Steps: 7 | Train Loss: 1.351 Vali Loss: 1.432 Vali Acc: 0.889 Test Loss: 1.432 Test Acc: 0.889
Validation loss decreased (-0.847205 --> -0.888875).  Saving model ...
Epoch: 7 cost time: 0.5732371807098389
Epoch: 7, Steps: 7 | Train Loss: 1.030 Vali Loss: 1.113 Vali Acc: 0.903 Test Loss: 1.113 Test Acc: 0.903
Validation loss decreased (-0.888875 --> -0.902767).  Saving model ...
Epoch: 8 cost time: 0.6074357032775879
Epoch: 8, Steps: 7 | Train Loss: 0.698 Vali Loss: 0.811 Vali Acc: 0.903 Test Loss: 0.811 Test Acc: 0.903
Validation loss decreased (-0.902767 --> -0.902770).  Saving model ...
Epoch: 9 cost time: 0.5131022930145264
Epoch: 9, Steps: 7 | Train Loss: 0.427 Vali Loss: 0.584 Vali Acc: 0.917 Test Loss: 0.584 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916661).  Saving model ...
Epoch: 10 cost time: 0.5122063159942627
Epoch: 10, Steps: 7 | Train Loss: 0.242 Vali Loss: 0.441 Vali Acc: 0.917 Test Loss: 0.441 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 0.4926445484161377
Epoch: 11, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.355 Vali Acc: 0.931 Test Loss: 0.355 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.48929882049560547
Epoch: 12, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.315 Vali Acc: 0.958 Test Loss: 0.315 Test Acc: 0.958
Validation loss decreased (-0.930552 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 0.5162780284881592
Epoch: 13, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5095629692077637
Epoch: 14, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7016758918762207
Epoch: 15, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6172380447387695
Epoch: 16, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6838390827178955
Epoch: 17, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5831751823425293
Epoch: 18, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.686415433883667
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.669588565826416
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6554129123687744
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.7203195095062256
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6975033283233643
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.6829793453216553
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.6940741539001465
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.6369285583496094
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.6372406482696533
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7651386260986328
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.8409805297851562
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.7081418037414551
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.6033217906951904
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6825816631317139
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.6373155117034912
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.6905460357666016
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.6753103733062744
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.6127777099609375
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.6386396884918213
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.6262423992156982
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.6466543674468994
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.6311442852020264
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.7402300834655762
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.7730965614318848
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.6989307403564453
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.6384694576263428
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.6048803329467773
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.7324297428131104
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.562654972076416
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.6664166450500488
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.5703887939453125
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.5996494293212891
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1228524
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9314351081848145
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.494 Vali Acc: 0.083 Test Loss: 2.494 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.633232831954956
Epoch: 2, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.437 Vali Acc: 0.153 Test Loss: 2.437 Test Acc: 0.153
Validation loss decreased (-0.083308 --> -0.152753).  Saving model ...
Epoch: 3 cost time: 0.6493182182312012
Epoch: 3, Steps: 7 | Train Loss: 2.281 Vali Loss: 2.321 Vali Acc: 0.389 Test Loss: 2.321 Test Acc: 0.389
Validation loss decreased (-0.152753 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 0.7079908847808838
Epoch: 4, Steps: 7 | Train Loss: 2.075 Vali Loss: 2.149 Vali Acc: 0.583 Test Loss: 2.149 Test Acc: 0.583
Validation loss decreased (-0.388866 --> -0.583312).  Saving model ...
Epoch: 5 cost time: 0.6145796775817871
Epoch: 5, Steps: 7 | Train Loss: 1.843 Vali Loss: 1.931 Vali Acc: 0.681 Test Loss: 1.931 Test Acc: 0.681
Validation loss decreased (-0.583312 --> -0.680536).  Saving model ...
Epoch: 6 cost time: 0.5488238334655762
Epoch: 6, Steps: 7 | Train Loss: 1.554 Vali Loss: 1.681 Vali Acc: 0.764 Test Loss: 1.681 Test Acc: 0.764
Validation loss decreased (-0.680536 --> -0.763872).  Saving model ...
Epoch: 7 cost time: 0.6213328838348389
Epoch: 7, Steps: 7 | Train Loss: 1.267 Vali Loss: 1.400 Vali Acc: 0.778 Test Loss: 1.400 Test Acc: 0.778
Validation loss decreased (-0.763872 --> -0.777764).  Saving model ...
Epoch: 8 cost time: 0.6190528869628906
Epoch: 8, Steps: 7 | Train Loss: 0.964 Vali Loss: 1.114 Vali Acc: 0.833 Test Loss: 1.114 Test Acc: 0.833
Validation loss decreased (-0.777764 --> -0.833322).  Saving model ...
Epoch: 9 cost time: 0.6781654357910156
Epoch: 9, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.854 Vali Acc: 0.875 Test Loss: 0.854 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.6333432197570801
Epoch: 10, Steps: 7 | Train Loss: 0.452 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 0.7914724349975586
Epoch: 11, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 0.6696360111236572
Epoch: 12, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 0.6711902618408203
Epoch: 13, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.642345666885376
Epoch: 14, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.6951963901519775
Epoch: 15, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7058935165405273
Epoch: 16, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.6507620811462402
Epoch: 17, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.7039051055908203
Epoch: 18, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6089799404144287
Epoch: 19, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7021796703338623
Epoch: 20, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.6047308444976807
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.6334476470947266
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6496336460113525
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6193451881408691
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6733050346374512
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6171116828918457
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6797971725463867
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6407036781311035
Epoch: 28, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6472806930541992
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6817848682403564
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.634037971496582
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6204564571380615
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6018970012664795
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6997764110565186
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6363439559936523
Epoch: 35, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6096413135528564
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.662193775177002
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.6821846961975098
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6863517761230469
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7650158405303955
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6792328357696533
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6336209774017334
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.6298019886016846
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.6640665531158447
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6074905395507812
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6326210498809814
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.7696559429168701
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.7153794765472412
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7605724334716797
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.713752031326294
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1211052
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.069777488708496
Epoch: 1, Steps: 7 | Train Loss: 2.481 Vali Loss: 2.463 Vali Acc: 0.097 Test Loss: 2.463 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6725122928619385
Epoch: 2, Steps: 7 | Train Loss: 2.403 Vali Loss: 2.414 Vali Acc: 0.194 Test Loss: 2.414 Test Acc: 0.194
Validation loss decreased (-0.097198 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.6948428153991699
Epoch: 3, Steps: 7 | Train Loss: 2.278 Vali Loss: 2.316 Vali Acc: 0.403 Test Loss: 2.316 Test Acc: 0.403
Validation loss decreased (-0.194420 --> -0.402755).  Saving model ...
Epoch: 4 cost time: 0.643923282623291
Epoch: 4, Steps: 7 | Train Loss: 2.113 Vali Loss: 2.168 Vali Acc: 0.597 Test Loss: 2.168 Test Acc: 0.597
Validation loss decreased (-0.402755 --> -0.597201).  Saving model ...
Epoch: 5 cost time: 0.6071286201477051
Epoch: 5, Steps: 7 | Train Loss: 1.899 Vali Loss: 1.973 Vali Acc: 0.681 Test Loss: 1.973 Test Acc: 0.681
Validation loss decreased (-0.597201 --> -0.680536).  Saving model ...
Epoch: 6 cost time: 0.7044415473937988
Epoch: 6, Steps: 7 | Train Loss: 1.665 Vali Loss: 1.739 Vali Acc: 0.764 Test Loss: 1.739 Test Acc: 0.764
Validation loss decreased (-0.680536 --> -0.763872).  Saving model ...
Epoch: 7 cost time: 0.7073237895965576
Epoch: 7, Steps: 7 | Train Loss: 1.408 Vali Loss: 1.482 Vali Acc: 0.806 Test Loss: 1.482 Test Acc: 0.806
Validation loss decreased (-0.763872 --> -0.805541).  Saving model ...
Epoch: 8 cost time: 0.6007599830627441
Epoch: 8, Steps: 7 | Train Loss: 1.134 Vali Loss: 1.225 Vali Acc: 0.833 Test Loss: 1.225 Test Acc: 0.833
Validation loss decreased (-0.805541 --> -0.833321).  Saving model ...
Epoch: 9 cost time: 0.6914820671081543
Epoch: 9, Steps: 7 | Train Loss: 0.856 Vali Loss: 0.984 Vali Acc: 0.875 Test Loss: 0.984 Test Acc: 0.875
Validation loss decreased (-0.833321 --> -0.874990).  Saving model ...
Epoch: 10 cost time: 0.6949670314788818
Epoch: 10, Steps: 7 | Train Loss: 0.629 Vali Loss: 0.772 Vali Acc: 0.903 Test Loss: 0.772 Test Acc: 0.903
Validation loss decreased (-0.874990 --> -0.902770).  Saving model ...
Epoch: 11 cost time: 0.7541470527648926
Epoch: 11, Steps: 7 | Train Loss: 0.433 Vali Loss: 0.609 Vali Acc: 0.931 Test Loss: 0.609 Test Acc: 0.931
Validation loss decreased (-0.902770 --> -0.930549).  Saving model ...
Epoch: 12 cost time: 0.5940463542938232
Epoch: 12, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.495 Vali Acc: 0.944 Test Loss: 0.495 Test Acc: 0.944
Validation loss decreased (-0.930549 --> -0.944439).  Saving model ...
Epoch: 13 cost time: 0.6662826538085938
Epoch: 13, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.430 Vali Acc: 0.944 Test Loss: 0.430 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.5902829170227051
Epoch: 14, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.377 Vali Acc: 0.931 Test Loss: 0.377 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.664337158203125
Epoch: 15, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.332 Vali Acc: 0.944 Test Loss: 0.332 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.6692595481872559
Epoch: 16, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.307 Vali Acc: 0.958 Test Loss: 0.307 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 17 cost time: 0.6238446235656738
Epoch: 17, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6943790912628174
Epoch: 18, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6296091079711914
Epoch: 19, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6868317127227783
Epoch: 20, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.641392707824707
Epoch: 21, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.972 Test Loss: 0.237 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.6750063896179199
Epoch: 22, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7230913639068604
Epoch: 23, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7321591377258301
Epoch: 24, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7494621276855469
Epoch: 25, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6558516025543213
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6561179161071777
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7690057754516602
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6277961730957031
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6443803310394287
Epoch: 30, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6883478164672852
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 1203756
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1780645847320557
Epoch: 1, Steps: 7 | Train Loss: 2.521 Vali Loss: 2.493 Vali Acc: 0.028 Test Loss: 2.493 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.6951174736022949
Epoch: 2, Steps: 7 | Train Loss: 2.441 Vali Loss: 2.450 Vali Acc: 0.111 Test Loss: 2.450 Test Acc: 0.111
Validation loss decreased (-0.027753 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.7358798980712891
Epoch: 3, Steps: 7 | Train Loss: 2.333 Vali Loss: 2.361 Vali Acc: 0.278 Test Loss: 2.361 Test Acc: 0.278
Validation loss decreased (-0.111087 --> -0.277754).  Saving model ...
Epoch: 4 cost time: 0.6880128383636475
Epoch: 4, Steps: 7 | Train Loss: 2.178 Vali Loss: 2.230 Vali Acc: 0.431 Test Loss: 2.230 Test Acc: 0.431
Validation loss decreased (-0.277754 --> -0.430533).  Saving model ...
Epoch: 5 cost time: 0.6471178531646729
Epoch: 5, Steps: 7 | Train Loss: 1.995 Vali Loss: 2.074 Vali Acc: 0.597 Test Loss: 2.074 Test Acc: 0.597
Validation loss decreased (-0.430533 --> -0.597201).  Saving model ...
Epoch: 6 cost time: 0.7061777114868164
Epoch: 6, Steps: 7 | Train Loss: 1.786 Vali Loss: 1.894 Vali Acc: 0.722 Test Loss: 1.894 Test Acc: 0.722
Validation loss decreased (-0.597201 --> -0.722203).  Saving model ...
Epoch: 7 cost time: 0.6869759559631348
Epoch: 7, Steps: 7 | Train Loss: 1.579 Vali Loss: 1.693 Vali Acc: 0.819 Test Loss: 1.693 Test Acc: 0.819
Validation loss decreased (-0.722203 --> -0.819428).  Saving model ...
Epoch: 8 cost time: 0.7077465057373047
Epoch: 8, Steps: 7 | Train Loss: 1.346 Vali Loss: 1.473 Vali Acc: 0.819 Test Loss: 1.473 Test Acc: 0.819
Validation loss decreased (-0.819428 --> -0.819430).  Saving model ...
Epoch: 9 cost time: 0.7048311233520508
Epoch: 9, Steps: 7 | Train Loss: 1.108 Vali Loss: 1.251 Vali Acc: 0.833 Test Loss: 1.251 Test Acc: 0.833
Validation loss decreased (-0.819430 --> -0.833321).  Saving model ...
Epoch: 10 cost time: 0.7005391120910645
Epoch: 10, Steps: 7 | Train Loss: 0.883 Vali Loss: 1.038 Vali Acc: 0.833 Test Loss: 1.038 Test Acc: 0.833
Validation loss decreased (-0.833321 --> -0.833323).  Saving model ...
Epoch: 11 cost time: 0.7072019577026367
Epoch: 11, Steps: 7 | Train Loss: 0.665 Vali Loss: 0.862 Vali Acc: 0.875 Test Loss: 0.862 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.685910701751709
Epoch: 12, Steps: 7 | Train Loss: 0.486 Vali Loss: 0.720 Vali Acc: 0.875 Test Loss: 0.720 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.6199781894683838
Epoch: 13, Steps: 7 | Train Loss: 0.345 Vali Loss: 0.621 Vali Acc: 0.889 Test Loss: 0.621 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888883).  Saving model ...
Epoch: 14 cost time: 0.7122340202331543
Epoch: 14, Steps: 7 | Train Loss: 0.248 Vali Loss: 0.540 Vali Acc: 0.903 Test Loss: 0.540 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 15 cost time: 0.6532108783721924
Epoch: 15, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.485 Vali Acc: 0.903 Test Loss: 0.485 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 0.658466100692749
Epoch: 16, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.439 Vali Acc: 0.903 Test Loss: 0.439 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 17 cost time: 0.6285543441772461
Epoch: 17, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.408 Vali Acc: 0.931 Test Loss: 0.408 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930551).  Saving model ...
Epoch: 18 cost time: 0.6332798004150391
Epoch: 18, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.608924150466919
Epoch: 19, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.363 Vali Acc: 0.931 Test Loss: 0.363 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 0.679816722869873
Epoch: 20, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6758637428283691
Epoch: 21, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5997860431671143
Epoch: 22, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6763916015625
Epoch: 23, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5585291385650635
Epoch: 24, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.7223505973815918
Epoch: 25, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6498935222625732
Epoch: 26, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6346435546875
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6798229217529297
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6160526275634766
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7356326580047607
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7739708423614502
Epoch: 31, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6573042869567871
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6472246646881104
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7092528343200684
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1196460
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.969297170639038
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.490 Vali Acc: 0.069 Test Loss: 2.490 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.6043984889984131
Epoch: 2, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.459 Vali Acc: 0.111 Test Loss: 2.459 Test Acc: 0.111
Validation loss decreased (-0.069420 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.5375361442565918
Epoch: 3, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.396 Vali Acc: 0.250 Test Loss: 2.396 Test Acc: 0.250
Validation loss decreased (-0.111087 --> -0.249976).  Saving model ...
Epoch: 4 cost time: 0.6325912475585938
Epoch: 4, Steps: 7 | Train Loss: 2.264 Vali Loss: 2.306 Vali Acc: 0.347 Test Loss: 2.306 Test Acc: 0.347
Validation loss decreased (-0.249976 --> -0.347199).  Saving model ...
Epoch: 5 cost time: 0.7471129894256592
Epoch: 5, Steps: 7 | Train Loss: 2.129 Vali Loss: 2.188 Vali Acc: 0.458 Test Loss: 2.188 Test Acc: 0.458
Validation loss decreased (-0.347199 --> -0.458311).  Saving model ...
Epoch: 6 cost time: 0.6140599250793457
Epoch: 6, Steps: 7 | Train Loss: 1.963 Vali Loss: 2.051 Vali Acc: 0.681 Test Loss: 2.051 Test Acc: 0.681
Validation loss decreased (-0.458311 --> -0.680535).  Saving model ...
Epoch: 7 cost time: 0.6526761054992676
Epoch: 7, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.889 Vali Acc: 0.736 Test Loss: 1.889 Test Acc: 0.736
Validation loss decreased (-0.680535 --> -0.736092).  Saving model ...
Epoch: 8 cost time: 0.5770583152770996
Epoch: 8, Steps: 7 | Train Loss: 1.592 Vali Loss: 1.716 Vali Acc: 0.764 Test Loss: 1.716 Test Acc: 0.764
Validation loss decreased (-0.736092 --> -0.763872).  Saving model ...
Epoch: 9 cost time: 0.6247997283935547
Epoch: 9, Steps: 7 | Train Loss: 1.380 Vali Loss: 1.517 Vali Acc: 0.792 Test Loss: 1.517 Test Acc: 0.792
Validation loss decreased (-0.763872 --> -0.791651).  Saving model ...
Epoch: 10 cost time: 0.6256499290466309
Epoch: 10, Steps: 7 | Train Loss: 1.155 Vali Loss: 1.316 Vali Acc: 0.806 Test Loss: 1.316 Test Acc: 0.806
Validation loss decreased (-0.791651 --> -0.805542).  Saving model ...
Epoch: 11 cost time: 0.6555173397064209
Epoch: 11, Steps: 7 | Train Loss: 0.951 Vali Loss: 1.127 Vali Acc: 0.819 Test Loss: 1.127 Test Acc: 0.819
Validation loss decreased (-0.805542 --> -0.819433).  Saving model ...
Epoch: 12 cost time: 0.6721434593200684
Epoch: 12, Steps: 7 | Train Loss: 0.746 Vali Loss: 0.958 Vali Acc: 0.875 Test Loss: 0.958 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874990).  Saving model ...
Epoch: 13 cost time: 0.6529817581176758
Epoch: 13, Steps: 7 | Train Loss: 0.577 Vali Loss: 0.815 Vali Acc: 0.875 Test Loss: 0.815 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 0.6939234733581543
Epoch: 14, Steps: 7 | Train Loss: 0.428 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.5787019729614258
Epoch: 15, Steps: 7 | Train Loss: 0.306 Vali Loss: 0.612 Vali Acc: 0.903 Test Loss: 0.612 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902772).  Saving model ...
Epoch: 16 cost time: 0.7754180431365967
Epoch: 16, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6798715591430664
Epoch: 17, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.508 Vali Acc: 0.875 Test Loss: 0.508 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7178406715393066
Epoch: 18, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7291338443756104
Epoch: 19, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.662020206451416
Epoch: 20, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6756844520568848
Epoch: 21, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.7401540279388428
Epoch: 22, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.378 Vali Acc: 0.917 Test Loss: 0.378 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.561251163482666
Epoch: 23, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7226178646087646
Epoch: 24, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6786899566650391
Epoch: 25, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6309881210327148
Epoch: 26, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 0.6730411052703857
Epoch: 27, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 0.6703338623046875
Epoch: 28, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 0.7063791751861572
Epoch: 29, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 0.6373112201690674
Epoch: 30, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 31 cost time: 0.8557484149932861
Epoch: 31, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6613931655883789
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6162116527557373
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7531156539916992
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7037136554718018
Epoch: 35, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6401827335357666
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.6648139953613281
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5936791896820068
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6219584941864014
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.6015338897705078
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6122305393218994
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.6287264823913574
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.6432573795318604
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.6744663715362549
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6211757659912109
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6499946117401123
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6893613338470459
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7435085773468018
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7349872589111328
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6468098163604736
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1189164
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.142573833465576
Epoch: 1, Steps: 7 | Train Loss: 2.478 Vali Loss: 2.478 Vali Acc: 0.083 Test Loss: 2.478 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.864638090133667
Epoch: 2, Steps: 7 | Train Loss: 2.296 Vali Loss: 2.359 Vali Acc: 0.444 Test Loss: 2.359 Test Acc: 0.444
Validation loss decreased (-0.083309 --> -0.444421).  Saving model ...
Epoch: 3 cost time: 0.7991750240325928
Epoch: 3, Steps: 7 | Train Loss: 1.923 Vali Loss: 2.100 Vali Acc: 0.736 Test Loss: 2.100 Test Acc: 0.736
Validation loss decreased (-0.444421 --> -0.736090).  Saving model ...
Epoch: 4 cost time: 0.7355403900146484
Epoch: 4, Steps: 7 | Train Loss: 1.442 Vali Loss: 1.691 Vali Acc: 0.861 Test Loss: 1.691 Test Acc: 0.861
Validation loss decreased (-0.736090 --> -0.861094).  Saving model ...
Epoch: 5 cost time: 0.7073216438293457
Epoch: 5, Steps: 7 | Train Loss: 0.926 Vali Loss: 1.166 Vali Acc: 0.889 Test Loss: 1.166 Test Acc: 0.889
Validation loss decreased (-0.861094 --> -0.888877).  Saving model ...
Epoch: 6 cost time: 0.7869770526885986
Epoch: 6, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.706 Vali Acc: 0.917 Test Loss: 0.706 Test Acc: 0.917
Validation loss decreased (-0.888877 --> -0.916660).  Saving model ...
Epoch: 7 cost time: 0.7638812065124512
Epoch: 7, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.7854132652282715
Epoch: 8, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.317 Vali Acc: 0.931 Test Loss: 0.317 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.7580208778381348
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.77120041847229
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.7274882793426514
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7763798236846924
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.739177942276001
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7020106315612793
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7090363502502441
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6919033527374268
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.8450682163238525
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.7086865901947021
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.7256574630737305
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7894821166992188
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8347911834716797
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.8445465564727783
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.695512056350708
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.7421185970306396
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.6630184650421143
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.7386205196380615
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.7373912334442139
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7137041091918945
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.7295742034912109
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.6601390838623047
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.7223246097564697
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.7389390468597412
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.7512779235839844
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.6064004898071289
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.728600025177002
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.7610507011413574
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.6977241039276123
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.7698512077331543
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7463736534118652
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7389676570892334
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.7340860366821289
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.6835775375366211
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.8021149635314941
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.8583319187164307
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6646823883056641
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.749312162399292
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.8364362716674805
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.7496840953826904
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.7432219982147217
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.8529973030090332
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1341036
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1177115440368652
Epoch: 1, Steps: 7 | Train Loss: 2.495 Vali Loss: 2.450 Vali Acc: 0.139 Test Loss: 2.450 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.7497055530548096
Epoch: 2, Steps: 7 | Train Loss: 2.369 Vali Loss: 2.352 Vali Acc: 0.444 Test Loss: 2.352 Test Acc: 0.444
Validation loss decreased (-0.138864 --> -0.444421).  Saving model ...
Epoch: 3 cost time: 0.7356386184692383
Epoch: 3, Steps: 7 | Train Loss: 2.118 Vali Loss: 2.157 Vali Acc: 0.583 Test Loss: 2.157 Test Acc: 0.583
Validation loss decreased (-0.444421 --> -0.583312).  Saving model ...
Epoch: 4 cost time: 0.7735989093780518
Epoch: 4, Steps: 7 | Train Loss: 1.798 Vali Loss: 1.855 Vali Acc: 0.806 Test Loss: 1.855 Test Acc: 0.806
Validation loss decreased (-0.583312 --> -0.805537).  Saving model ...
Epoch: 5 cost time: 0.6832301616668701
Epoch: 5, Steps: 7 | Train Loss: 1.416 Vali Loss: 1.466 Vali Acc: 0.861 Test Loss: 1.466 Test Acc: 0.861
Validation loss decreased (-0.805537 --> -0.861096).  Saving model ...
Epoch: 6 cost time: 0.7058708667755127
Epoch: 6, Steps: 7 | Train Loss: 0.970 Vali Loss: 1.045 Vali Acc: 0.903 Test Loss: 1.045 Test Acc: 0.903
Validation loss decreased (-0.861096 --> -0.902767).  Saving model ...
Epoch: 7 cost time: 0.613807201385498
Epoch: 7, Steps: 7 | Train Loss: 0.589 Vali Loss: 0.692 Vali Acc: 0.944 Test Loss: 0.692 Test Acc: 0.944
Validation loss decreased (-0.902767 --> -0.944438).  Saving model ...
Epoch: 8 cost time: 0.5976355075836182
Epoch: 8, Steps: 7 | Train Loss: 0.318 Vali Loss: 0.465 Vali Acc: 0.958 Test Loss: 0.465 Test Acc: 0.958
Validation loss decreased (-0.944438 --> -0.958329).  Saving model ...
Epoch: 9 cost time: 0.7304668426513672
Epoch: 9, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.343 Vali Acc: 0.958 Test Loss: 0.343 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.7353813648223877
Epoch: 10, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.288 Vali Acc: 0.958 Test Loss: 0.288 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.6767244338989258
Epoch: 11, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.6904339790344238
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.7757067680358887
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.6052098274230957
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7079339027404785
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6339290142059326
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6415481567382812
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.7099275588989258
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.7305343151092529
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.6922330856323242
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6985123157501221
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.591754674911499
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7449822425842285
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7774136066436768
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.666156530380249
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 0.7514328956604004
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 0.7135269641876221
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 0.8192892074584961
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 0.6279709339141846
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.7359881401062012
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.6338279247283936
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 0.5782790184020996
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6845448017120361
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6273360252380371
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6714358329772949
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5595977306365967
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6739511489868164
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5790214538574219
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7306196689605713
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6923131942749023
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7378685474395752
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1249836
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1500823497772217
Epoch: 1, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.450 Vali Acc: 0.208 Test Loss: 2.450 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.6869728565216064
Epoch: 2, Steps: 7 | Train Loss: 2.352 Vali Loss: 2.368 Vali Acc: 0.389 Test Loss: 2.368 Test Acc: 0.389
Validation loss decreased (-0.208309 --> -0.388865).  Saving model ...
Epoch: 3 cost time: 0.6497046947479248
Epoch: 3, Steps: 7 | Train Loss: 2.187 Vali Loss: 2.225 Vali Acc: 0.569 Test Loss: 2.225 Test Acc: 0.569
Validation loss decreased (-0.388865 --> -0.569422).  Saving model ...
Epoch: 4 cost time: 0.7014999389648438
Epoch: 4, Steps: 7 | Train Loss: 1.945 Vali Loss: 2.016 Vali Acc: 0.778 Test Loss: 2.016 Test Acc: 0.778
Validation loss decreased (-0.569422 --> -0.777758).  Saving model ...
Epoch: 5 cost time: 0.7218549251556396
Epoch: 5, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.755 Vali Acc: 0.833 Test Loss: 1.755 Test Acc: 0.833
Validation loss decreased (-0.777758 --> -0.833316).  Saving model ...
Epoch: 6 cost time: 0.7068831920623779
Epoch: 6, Steps: 7 | Train Loss: 1.351 Vali Loss: 1.452 Vali Acc: 0.875 Test Loss: 1.452 Test Acc: 0.875
Validation loss decreased (-0.833316 --> -0.874985).  Saving model ...
Epoch: 7 cost time: 0.6575443744659424
Epoch: 7, Steps: 7 | Train Loss: 1.037 Vali Loss: 1.131 Vali Acc: 0.917 Test Loss: 1.131 Test Acc: 0.917
Validation loss decreased (-0.874985 --> -0.916655).  Saving model ...
Epoch: 8 cost time: 0.6836373805999756
Epoch: 8, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.835 Vali Acc: 0.917 Test Loss: 0.835 Test Acc: 0.917
Validation loss decreased (-0.916655 --> -0.916658).  Saving model ...
Epoch: 9 cost time: 0.6013059616088867
Epoch: 9, Steps: 7 | Train Loss: 0.432 Vali Loss: 0.605 Vali Acc: 0.903 Test Loss: 0.605 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6249716281890869
Epoch: 10, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.455 Vali Acc: 0.903 Test Loss: 0.455 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6725654602050781
Epoch: 11, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.916658 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.6805577278137207
Epoch: 12, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.7061920166015625
Epoch: 13, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6644539833068848
Epoch: 14, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.6663780212402344
Epoch: 15, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6033358573913574
Epoch: 16, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7057735919952393
Epoch: 17, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.7001581192016602
Epoch: 18, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5686647891998291
Epoch: 19, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6097548007965088
Epoch: 20, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7776424884796143
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6838469505310059
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6143655776977539
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6733100414276123
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.632216215133667
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.7457976341247559
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.6098253726959229
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6361086368560791
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5729804039001465
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5443770885467529
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5488150119781494
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5995705127716064
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.687457799911499
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.7236135005950928
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.6304075717926025
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.621140718460083
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.6176164150238037
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6601378917694092
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.7034752368927002
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.6163864135742188
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.6249032020568848
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.6528894901275635
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.7200021743774414
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.6530556678771973
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.632300615310669
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.7081305980682373
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7084932327270508
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.7994599342346191
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.7278497219085693
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.7749807834625244
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1223148
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.103600263595581
Epoch: 1, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.443 Vali Acc: 0.181 Test Loss: 2.443 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.6538748741149902
Epoch: 2, Steps: 7 | Train Loss: 2.404 Vali Loss: 2.376 Vali Acc: 0.292 Test Loss: 2.376 Test Acc: 0.292
Validation loss decreased (-0.180531 --> -0.291643).  Saving model ...
Epoch: 3 cost time: 0.8041973114013672
Epoch: 3, Steps: 7 | Train Loss: 2.261 Vali Loss: 2.258 Vali Acc: 0.500 Test Loss: 2.258 Test Acc: 0.500
Validation loss decreased (-0.291643 --> -0.499977).  Saving model ...
Epoch: 4 cost time: 0.7451963424682617
Epoch: 4, Steps: 7 | Train Loss: 2.049 Vali Loss: 2.093 Vali Acc: 0.625 Test Loss: 2.093 Test Acc: 0.625
Validation loss decreased (-0.499977 --> -0.624979).  Saving model ...
Epoch: 5 cost time: 0.6546270847320557
Epoch: 5, Steps: 7 | Train Loss: 1.831 Vali Loss: 1.884 Vali Acc: 0.750 Test Loss: 1.884 Test Acc: 0.750
Validation loss decreased (-0.624979 --> -0.749981).  Saving model ...
Epoch: 6 cost time: 0.6284096240997314
Epoch: 6, Steps: 7 | Train Loss: 1.566 Vali Loss: 1.644 Vali Acc: 0.806 Test Loss: 1.644 Test Acc: 0.806
Validation loss decreased (-0.749981 --> -0.805539).  Saving model ...
Epoch: 7 cost time: 0.6795804500579834
Epoch: 7, Steps: 7 | Train Loss: 1.272 Vali Loss: 1.383 Vali Acc: 0.847 Test Loss: 1.383 Test Acc: 0.847
Validation loss decreased (-0.805539 --> -0.847208).  Saving model ...
Epoch: 8 cost time: 0.6194384098052979
Epoch: 8, Steps: 7 | Train Loss: 0.976 Vali Loss: 1.128 Vali Acc: 0.861 Test Loss: 1.128 Test Acc: 0.861
Validation loss decreased (-0.847208 --> -0.861100).  Saving model ...
Epoch: 9 cost time: 0.6589207649230957
Epoch: 9, Steps: 7 | Train Loss: 0.699 Vali Loss: 0.869 Vali Acc: 0.875 Test Loss: 0.869 Test Acc: 0.875
Validation loss decreased (-0.861100 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.7423036098480225
Epoch: 10, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.678 Vali Acc: 0.889 Test Loss: 0.678 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 11 cost time: 0.6543290615081787
Epoch: 11, Steps: 7 | Train Loss: 0.292 Vali Loss: 0.542 Vali Acc: 0.903 Test Loss: 0.542 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902772).  Saving model ...
Epoch: 12 cost time: 0.7550289630889893
Epoch: 12, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.456 Vali Acc: 0.931 Test Loss: 0.456 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 13 cost time: 0.624267578125
Epoch: 13, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7065346240997314
Epoch: 14, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5684459209442139
Epoch: 15, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6566550731658936
Epoch: 16, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6558983325958252
Epoch: 17, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6868047714233398
Epoch: 18, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5862443447113037
Epoch: 19, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6680581569671631
Epoch: 20, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6617915630340576
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7064394950866699
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1205676
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0632431507110596
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.486 Vali Acc: 0.111 Test Loss: 2.486 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5892233848571777
Epoch: 2, Steps: 7 | Train Loss: 2.452 Vali Loss: 2.437 Vali Acc: 0.194 Test Loss: 2.437 Test Acc: 0.194
Validation loss decreased (-0.111086 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.6885159015655518
Epoch: 3, Steps: 7 | Train Loss: 2.321 Vali Loss: 2.344 Vali Acc: 0.389 Test Loss: 2.344 Test Acc: 0.389
Validation loss decreased (-0.194420 --> -0.388865).  Saving model ...
Epoch: 4 cost time: 0.5934126377105713
Epoch: 4, Steps: 7 | Train Loss: 2.153 Vali Loss: 2.205 Vali Acc: 0.569 Test Loss: 2.205 Test Acc: 0.569
Validation loss decreased (-0.388865 --> -0.569422).  Saving model ...
Epoch: 5 cost time: 0.6026577949523926
Epoch: 5, Steps: 7 | Train Loss: 1.964 Vali Loss: 2.022 Vali Acc: 0.694 Test Loss: 2.022 Test Acc: 0.694
Validation loss decreased (-0.569422 --> -0.694424).  Saving model ...
Epoch: 6 cost time: 0.6573050022125244
Epoch: 6, Steps: 7 | Train Loss: 1.720 Vali Loss: 1.804 Vali Acc: 0.819 Test Loss: 1.804 Test Acc: 0.819
Validation loss decreased (-0.694424 --> -0.819426).  Saving model ...
Epoch: 7 cost time: 0.6730279922485352
Epoch: 7, Steps: 7 | Train Loss: 1.455 Vali Loss: 1.559 Vali Acc: 0.833 Test Loss: 1.559 Test Acc: 0.833
Validation loss decreased (-0.819426 --> -0.833318).  Saving model ...
Epoch: 8 cost time: 0.8376076221466064
Epoch: 8, Steps: 7 | Train Loss: 1.189 Vali Loss: 1.280 Vali Acc: 0.861 Test Loss: 1.280 Test Acc: 0.861
Validation loss decreased (-0.833318 --> -0.861098).  Saving model ...
Epoch: 9 cost time: 0.6453847885131836
Epoch: 9, Steps: 7 | Train Loss: 0.924 Vali Loss: 1.021 Vali Acc: 0.875 Test Loss: 1.021 Test Acc: 0.875
Validation loss decreased (-0.861098 --> -0.874990).  Saving model ...
Epoch: 10 cost time: 0.6406033039093018
Epoch: 10, Steps: 7 | Train Loss: 0.645 Vali Loss: 0.778 Vali Acc: 0.903 Test Loss: 0.778 Test Acc: 0.903
Validation loss decreased (-0.874990 --> -0.902770).  Saving model ...
Epoch: 11 cost time: 0.6709640026092529
Epoch: 11, Steps: 7 | Train Loss: 0.439 Vali Loss: 0.602 Vali Acc: 0.917 Test Loss: 0.602 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916661).  Saving model ...
Epoch: 12 cost time: 0.659625768661499
Epoch: 12, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.494 Vali Acc: 0.944 Test Loss: 0.494 Test Acc: 0.944
Validation loss decreased (-0.916661 --> -0.944440).  Saving model ...
Epoch: 13 cost time: 0.6871802806854248
Epoch: 13, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.407 Vali Acc: 0.944 Test Loss: 0.407 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.5740280151367188
Epoch: 14, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.6164100170135498
Epoch: 15, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.326 Vali Acc: 0.958 Test Loss: 0.326 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 16 cost time: 0.5878667831420898
Epoch: 16, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.295 Vali Acc: 0.958 Test Loss: 0.295 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 17 cost time: 0.6060521602630615
Epoch: 17, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.6127007007598877
Epoch: 18, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.260 Vali Acc: 0.958 Test Loss: 0.260 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.6667780876159668
Epoch: 19, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.645521879196167
Epoch: 20, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6221787929534912
Epoch: 21, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.6957697868347168
Epoch: 22, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6015195846557617
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.6330022811889648
Epoch: 24, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.7738502025604248
Epoch: 25, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.707923173904419
Epoch: 26, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.737119197845459
Epoch: 27, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7087657451629639
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5836329460144043
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.6155784130096436
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6114370822906494
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6360929012298584
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.6621146202087402
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.7194573879241943
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.6100382804870605
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.6841952800750732
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.6278035640716553
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.5913710594177246
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.5664868354797363
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.6764354705810547
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.7435159683227539
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.5792291164398193
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.6301980018615723
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.6734864711761475
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6849188804626465
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5956714153289795
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5730717182159424
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6747288703918457
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.6266965866088867
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.6274046897888184
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1198380
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.953972578048706
Epoch: 1, Steps: 7 | Train Loss: 2.478 Vali Loss: 2.456 Vali Acc: 0.194 Test Loss: 2.456 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.6630940437316895
Epoch: 2, Steps: 7 | Train Loss: 2.428 Vali Loss: 2.402 Vali Acc: 0.250 Test Loss: 2.402 Test Acc: 0.250
Validation loss decreased (-0.194420 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.8288471698760986
Epoch: 3, Steps: 7 | Train Loss: 2.295 Vali Loss: 2.305 Vali Acc: 0.333 Test Loss: 2.305 Test Acc: 0.333
Validation loss decreased (-0.249976 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 0.6951932907104492
Epoch: 4, Steps: 7 | Train Loss: 2.141 Vali Loss: 2.168 Vali Acc: 0.583 Test Loss: 2.168 Test Acc: 0.583
Validation loss decreased (-0.333310 --> -0.583312).  Saving model ...
Epoch: 5 cost time: 0.7286601066589355
Epoch: 5, Steps: 7 | Train Loss: 1.968 Vali Loss: 2.000 Vali Acc: 0.681 Test Loss: 2.000 Test Acc: 0.681
Validation loss decreased (-0.583312 --> -0.680536).  Saving model ...
Epoch: 6 cost time: 0.6999416351318359
Epoch: 6, Steps: 7 | Train Loss: 1.752 Vali Loss: 1.798 Vali Acc: 0.750 Test Loss: 1.798 Test Acc: 0.750
Validation loss decreased (-0.680536 --> -0.749982).  Saving model ...
Epoch: 7 cost time: 0.7697849273681641
Epoch: 7, Steps: 7 | Train Loss: 1.514 Vali Loss: 1.578 Vali Acc: 0.806 Test Loss: 1.578 Test Acc: 0.806
Validation loss decreased (-0.749982 --> -0.805540).  Saving model ...
Epoch: 8 cost time: 0.6875865459442139
Epoch: 8, Steps: 7 | Train Loss: 1.290 Vali Loss: 1.346 Vali Acc: 0.819 Test Loss: 1.346 Test Acc: 0.819
Validation loss decreased (-0.805540 --> -0.819431).  Saving model ...
Epoch: 9 cost time: 0.7011053562164307
Epoch: 9, Steps: 7 | Train Loss: 1.035 Vali Loss: 1.118 Vali Acc: 0.847 Test Loss: 1.118 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847211).  Saving model ...
Epoch: 10 cost time: 0.7939023971557617
Epoch: 10, Steps: 7 | Train Loss: 0.810 Vali Loss: 0.918 Vali Acc: 0.861 Test Loss: 0.918 Test Acc: 0.861
Validation loss decreased (-0.847211 --> -0.861102).  Saving model ...
Epoch: 11 cost time: 0.6379835605621338
Epoch: 11, Steps: 7 | Train Loss: 0.589 Vali Loss: 0.752 Vali Acc: 0.889 Test Loss: 0.752 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888881).  Saving model ...
Epoch: 12 cost time: 0.7322611808776855
Epoch: 12, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 13 cost time: 0.7823078632354736
Epoch: 13, Steps: 7 | Train Loss: 0.303 Vali Loss: 0.521 Vali Acc: 0.903 Test Loss: 0.521 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.7424676418304443
Epoch: 14, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 15 cost time: 0.7451901435852051
Epoch: 15, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.410 Vali Acc: 0.917 Test Loss: 0.410 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.6382079124450684
Epoch: 16, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.8056089878082275
Epoch: 17, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.359 Vali Acc: 0.917 Test Loss: 0.359 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.7713420391082764
Epoch: 18, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.7599382400512695
Epoch: 19, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 0.8487834930419922
Epoch: 20, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7599446773529053
Epoch: 21, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7029922008514404
Epoch: 22, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7609922885894775
Epoch: 23, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6848487854003906
Epoch: 24, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6707680225372314
Epoch: 25, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6765985488891602
Epoch: 26, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6481654644012451
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7100069522857666
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6256988048553467
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1191084
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0700321197509766
Epoch: 1, Steps: 7 | Train Loss: 2.549 Vali Loss: 2.482 Vali Acc: 0.056 Test Loss: 2.482 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.6604042053222656
Epoch: 2, Steps: 7 | Train Loss: 2.466 Vali Loss: 2.444 Vali Acc: 0.125 Test Loss: 2.444 Test Acc: 0.125
Validation loss decreased (-0.055531 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.6208508014678955
Epoch: 3, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.372 Vali Acc: 0.236 Test Loss: 2.372 Test Acc: 0.236
Validation loss decreased (-0.124976 --> -0.236087).  Saving model ...
Epoch: 4 cost time: 0.6270744800567627
Epoch: 4, Steps: 7 | Train Loss: 2.239 Vali Loss: 2.266 Vali Acc: 0.458 Test Loss: 2.266 Test Acc: 0.458
Validation loss decreased (-0.236087 --> -0.458311).  Saving model ...
Epoch: 5 cost time: 0.6945257186889648
Epoch: 5, Steps: 7 | Train Loss: 2.095 Vali Loss: 2.134 Vali Acc: 0.625 Test Loss: 2.134 Test Acc: 0.625
Validation loss decreased (-0.458311 --> -0.624979).  Saving model ...
Epoch: 6 cost time: 0.7812986373901367
Epoch: 6, Steps: 7 | Train Loss: 1.921 Vali Loss: 1.981 Vali Acc: 0.667 Test Loss: 1.981 Test Acc: 0.667
Validation loss decreased (-0.624979 --> -0.666647).  Saving model ...
Epoch: 7 cost time: 0.7198820114135742
Epoch: 7, Steps: 7 | Train Loss: 1.733 Vali Loss: 1.807 Vali Acc: 0.764 Test Loss: 1.807 Test Acc: 0.764
Validation loss decreased (-0.666647 --> -0.763871).  Saving model ...
Epoch: 8 cost time: 0.7485311031341553
Epoch: 8, Steps: 7 | Train Loss: 1.512 Vali Loss: 1.606 Vali Acc: 0.778 Test Loss: 1.606 Test Acc: 0.778
Validation loss decreased (-0.763871 --> -0.777762).  Saving model ...
Epoch: 9 cost time: 0.6571981906890869
Epoch: 9, Steps: 7 | Train Loss: 1.301 Vali Loss: 1.403 Vali Acc: 0.833 Test Loss: 1.403 Test Acc: 0.833
Validation loss decreased (-0.777762 --> -0.833319).  Saving model ...
Epoch: 10 cost time: 0.7320659160614014
Epoch: 10, Steps: 7 | Train Loss: 1.065 Vali Loss: 1.197 Vali Acc: 0.861 Test Loss: 1.197 Test Acc: 0.861
Validation loss decreased (-0.833319 --> -0.861099).  Saving model ...
Epoch: 11 cost time: 0.6157162189483643
Epoch: 11, Steps: 7 | Train Loss: 0.848 Vali Loss: 1.014 Vali Acc: 0.861 Test Loss: 1.014 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861101).  Saving model ...
Epoch: 12 cost time: 0.7156431674957275
Epoch: 12, Steps: 7 | Train Loss: 0.664 Vali Loss: 0.858 Vali Acc: 0.875 Test Loss: 0.858 Test Acc: 0.875
Validation loss decreased (-0.861101 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.8241732120513916
Epoch: 13, Steps: 7 | Train Loss: 0.495 Vali Loss: 0.735 Vali Acc: 0.889 Test Loss: 0.735 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 14 cost time: 0.6961688995361328
Epoch: 14, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.633 Vali Acc: 0.903 Test Loss: 0.633 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902771).  Saving model ...
Epoch: 15 cost time: 0.7422683238983154
Epoch: 15, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.560 Vali Acc: 0.889 Test Loss: 0.560 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7422709465026855
Epoch: 16, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.668414831161499
Epoch: 17, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6735494136810303
Epoch: 18, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6716725826263428
Epoch: 19, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7023863792419434
Epoch: 20, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 0.5688679218292236
Epoch: 21, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.7254304885864258
Epoch: 22, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.6128389835357666
Epoch: 23, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.371 Vali Acc: 0.903 Test Loss: 0.371 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.662583589553833
Epoch: 24, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.6227951049804688
Epoch: 25, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.7954437732696533
Epoch: 26, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.8050942420959473
Epoch: 27, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.738497257232666
Epoch: 28, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.886497974395752
Epoch: 29, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.6944365501403809
Epoch: 30, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 31 cost time: 0.7379810810089111
Epoch: 31, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.8076426982879639
Epoch: 32, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 33 cost time: 0.7311985492706299
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.7203769683837891
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.6768636703491211
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.7780396938323975
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8272325992584229
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7798919677734375
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7514750957489014
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7503054141998291
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8504035472869873
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.722496509552002
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.7804293632507324
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6848673820495605
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.7844271659851074
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.6678762435913086
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.7692797183990479
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.7729380130767822
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.70709228515625
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7359161376953125
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 1183788
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.935882329940796
Epoch: 1, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.325 Vali Acc: 0.403 Test Loss: 2.325 Test Acc: 0.403
Validation loss decreased (inf --> -0.402755).  Saving model ...
Epoch: 2 cost time: 0.9236562252044678
Epoch: 2, Steps: 7 | Train Loss: 1.778 Vali Loss: 1.558 Vali Acc: 0.819 Test Loss: 1.558 Test Acc: 0.819
Validation loss decreased (-0.402755 --> -0.819429).  Saving model ...
Epoch: 3 cost time: 1.0566699504852295
Epoch: 3, Steps: 7 | Train Loss: 0.663 Vali Loss: 0.745 Vali Acc: 0.931 Test Loss: 0.745 Test Acc: 0.931
Validation loss decreased (-0.819429 --> -0.930548).  Saving model ...
Epoch: 4 cost time: 1.2499260902404785
Epoch: 4, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 1.1867907047271729
Epoch: 5, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3140668869018555
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.241593837738037
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3249762058258057
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1708145141601562
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1971426010131836
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.296694040298462
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.7842316627502441
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.122826337814331
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.0938894748687744
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.8987643718719482
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.0987749099731445
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.1132700443267822
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2210183143615723
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2644741535186768
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.180314064025879
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3827698230743408
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3535113334655762
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.469724416732788
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.330561637878418
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0645949840545654
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0286567211151123
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4924812
model size : 18.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.215428352355957
Epoch: 1, Steps: 7 | Train Loss: 2.459 Vali Loss: 2.340 Vali Acc: 0.306 Test Loss: 2.340 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 0.8581080436706543
Epoch: 2, Steps: 7 | Train Loss: 1.985 Vali Loss: 1.855 Vali Acc: 0.792 Test Loss: 1.855 Test Acc: 0.792
Validation loss decreased (-0.305532 --> -0.791648).  Saving model ...
Epoch: 3 cost time: 0.9068162441253662
Epoch: 3, Steps: 7 | Train Loss: 1.156 Vali Loss: 1.167 Vali Acc: 0.889 Test Loss: 1.167 Test Acc: 0.889
Validation loss decreased (-0.791648 --> -0.888877).  Saving model ...
Epoch: 4 cost time: 0.9013960361480713
Epoch: 4, Steps: 7 | Train Loss: 0.466 Vali Loss: 0.589 Vali Acc: 0.889 Test Loss: 0.589 Test Acc: 0.889
Validation loss decreased (-0.888877 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 0.9941616058349609
Epoch: 5, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.0556237697601318
Epoch: 6, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.8288383483886719
Epoch: 7, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.9898483753204346
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.0027050971984863
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.9766781330108643
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.9154913425445557
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.8415787220001221
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.029700756072998
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8573386669158936
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9127810001373291
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9412660598754883
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8365757465362549
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9631357192993164
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9569015502929688
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9531457424163818
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8995034694671631
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9463961124420166
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4560012
model size : 17.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1971096992492676
Epoch: 1, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.386 Vali Acc: 0.264 Test Loss: 2.386 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.8095390796661377
Epoch: 2, Steps: 7 | Train Loss: 2.157 Vali Loss: 2.045 Vali Acc: 0.778 Test Loss: 2.045 Test Acc: 0.778
Validation loss decreased (-0.263865 --> -0.777757).  Saving model ...
Epoch: 3 cost time: 0.6855635643005371
Epoch: 3, Steps: 7 | Train Loss: 1.520 Vali Loss: 1.514 Vali Acc: 0.931 Test Loss: 1.514 Test Acc: 0.931
Validation loss decreased (-0.777757 --> -0.930540).  Saving model ...
Epoch: 4 cost time: 0.7730321884155273
Epoch: 4, Steps: 7 | Train Loss: 0.846 Vali Loss: 0.915 Vali Acc: 0.931 Test Loss: 0.915 Test Acc: 0.931
Validation loss decreased (-0.930540 --> -0.930546).  Saving model ...
Epoch: 5 cost time: 0.8262050151824951
Epoch: 5, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.499 Vali Acc: 0.931 Test Loss: 0.499 Test Acc: 0.931
Validation loss decreased (-0.930546 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 0.7459583282470703
Epoch: 6, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.838886022567749
Epoch: 7, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.7744791507720947
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7230243682861328
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8780157566070557
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.6928465366363525
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8870227336883545
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8644146919250488
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9032108783721924
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8668105602264404
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8358602523803711
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8508164882659912
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8413102626800537
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6580643653869629
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6078031063079834
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8055133819580078
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7537045478820801
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9499039649963379
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8426246643066406
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.9829778671264648
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.8450706005096436
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.9471895694732666
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.8478798866271973
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.8174588680267334
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.9270651340484619
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.8741929531097412
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.9102673530578613
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.9385933876037598
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.9505267143249512
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8106734752655029
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6998045444488525
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.7364037036895752
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.8719675540924072
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7454185485839844
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.677391767501831
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6782915592193604
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7265844345092773
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.926992654800415
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8010880947113037
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.9079525470733643
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8594865798950195
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8177757263183594
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8925561904907227
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8192627429962158
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9414486885070801
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4434828
model size : 16.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1006906032562256
Epoch: 1, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.431 Vali Acc: 0.292 Test Loss: 2.431 Test Acc: 0.292
Validation loss decreased (inf --> -0.291642).  Saving model ...
Epoch: 2 cost time: 0.6958990097045898
Epoch: 2, Steps: 7 | Train Loss: 2.249 Vali Loss: 2.169 Vali Acc: 0.556 Test Loss: 2.169 Test Acc: 0.556
Validation loss decreased (-0.291642 --> -0.555534).  Saving model ...
Epoch: 3 cost time: 0.7835440635681152
Epoch: 3, Steps: 7 | Train Loss: 1.752 Vali Loss: 1.741 Vali Acc: 0.736 Test Loss: 1.741 Test Acc: 0.736
Validation loss decreased (-0.555534 --> -0.736094).  Saving model ...
Epoch: 4 cost time: 0.7298679351806641
Epoch: 4, Steps: 7 | Train Loss: 1.168 Vali Loss: 1.225 Vali Acc: 0.847 Test Loss: 1.225 Test Acc: 0.847
Validation loss decreased (-0.736094 --> -0.847210).  Saving model ...
Epoch: 5 cost time: 0.8957536220550537
Epoch: 5, Steps: 7 | Train Loss: 0.621 Vali Loss: 0.762 Vali Acc: 0.861 Test Loss: 0.762 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 0.6527268886566162
Epoch: 6, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.78352952003479
Epoch: 7, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.8063080310821533
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.321 Vali Acc: 0.861 Test Loss: 0.321 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8697843551635742
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8379073143005371
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8357856273651123
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.861480712890625
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.7890172004699707
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.8720552921295166
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7732341289520264
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.652031421661377
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.823509931564331
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7367649078369141
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.733149528503418
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6951291561126709
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.8314542770385742
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.6856300830841064
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.7178835868835449
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7804570198059082
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.8561859130859375
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.7205049991607666
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.8050429821014404
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.7294712066650391
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.7951104640960693
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.7900209426879883
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.8234107494354248
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.8562982082366943
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.8370034694671631
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8537335395812988
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8856298923492432
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7177684307098389
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7408103942871094
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6459653377532959
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7664096355438232
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.616478681564331
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8583030700683594
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7409930229187012
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.7664215564727783
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8210752010345459
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.8076798915863037
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.662177562713623
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7570950984954834
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.7205395698547363
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7343833446502686
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.7721226215362549
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4383372
model size : 16.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.062441349029541
Epoch: 1, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.442 Vali Acc: 0.208 Test Loss: 2.442 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.7498788833618164
Epoch: 2, Steps: 7 | Train Loss: 2.271 Vali Loss: 2.223 Vali Acc: 0.542 Test Loss: 2.223 Test Acc: 0.542
Validation loss decreased (-0.208309 --> -0.541644).  Saving model ...
Epoch: 3 cost time: 0.7961685657501221
Epoch: 3, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.865 Vali Acc: 0.764 Test Loss: 1.865 Test Acc: 0.764
Validation loss decreased (-0.541644 --> -0.763870).  Saving model ...
Epoch: 4 cost time: 0.8341081142425537
Epoch: 4, Steps: 7 | Train Loss: 1.378 Vali Loss: 1.401 Vali Acc: 0.847 Test Loss: 1.401 Test Acc: 0.847
Validation loss decreased (-0.763870 --> -0.847208).  Saving model ...
Epoch: 5 cost time: 0.878371000289917
Epoch: 5, Steps: 7 | Train Loss: 0.852 Vali Loss: 0.951 Vali Acc: 0.889 Test Loss: 0.951 Test Acc: 0.889
Validation loss decreased (-0.847208 --> -0.888879).  Saving model ...
Epoch: 6 cost time: 0.769860029220581
Epoch: 6, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.578 Vali Acc: 0.944 Test Loss: 0.578 Test Acc: 0.944
Validation loss decreased (-0.888879 --> -0.944439).  Saving model ...
Epoch: 7 cost time: 0.9250812530517578
Epoch: 7, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.380 Vali Acc: 0.944 Test Loss: 0.380 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 0.8166489601135254
Epoch: 8, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7041335105895996
Epoch: 9, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6738402843475342
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.797717809677124
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.972 Test Loss: 0.229 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 0.8098061084747314
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.972 Test Loss: 0.219 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.6669065952301025
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6872577667236328
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 0.76688551902771
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6348397731781006
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7143967151641846
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7360749244689941
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.9042713642120361
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.7369019985198975
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.8178746700286865
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.7805137634277344
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.7462317943572998
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.8664140701293945
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 25 cost time: 0.7977027893066406
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.8068547248840332
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 27 cost time: 0.827171802520752
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 28 cost time: 0.8630006313323975
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 29 cost time: 0.7884762287139893
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 30 cost time: 0.8064420223236084
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 31 cost time: 0.6864490509033203
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 32 cost time: 0.7115998268127441
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 33 cost time: 0.7255804538726807
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 34 cost time: 0.6114425659179688
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 35 cost time: 0.6210386753082275
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 36 cost time: 0.6564126014709473
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 37 cost time: 0.6157808303833008
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 38 cost time: 0.5821983814239502
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 39 cost time: 0.657095193862915
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 40 cost time: 0.75858473777771
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 41 cost time: 0.7604589462280273
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 42 cost time: 0.8331665992736816
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 43 cost time: 0.8859260082244873
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 44 cost time: 0.7911913394927979
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 45 cost time: 0.7426164150238037
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 46 cost time: 0.8528029918670654
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 47 cost time: 0.8052268028259277
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9158926010131836
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 49 cost time: 0.7033498287200928
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 50 cost time: 0.7807409763336182
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 4335756
model size : 16.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.83842134475708
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.439 Vali Acc: 0.139 Test Loss: 2.439 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.899543046951294
Epoch: 2, Steps: 7 | Train Loss: 2.287 Vali Loss: 2.254 Vali Acc: 0.583 Test Loss: 2.254 Test Acc: 0.583
Validation loss decreased (-0.138864 --> -0.583311).  Saving model ...
Epoch: 3 cost time: 0.9207103252410889
Epoch: 3, Steps: 7 | Train Loss: 1.922 Vali Loss: 1.957 Vali Acc: 0.722 Test Loss: 1.957 Test Acc: 0.722
Validation loss decreased (-0.583311 --> -0.722203).  Saving model ...
Epoch: 4 cost time: 0.8506197929382324
Epoch: 4, Steps: 7 | Train Loss: 1.499 Vali Loss: 1.576 Vali Acc: 0.847 Test Loss: 1.576 Test Acc: 0.847
Validation loss decreased (-0.722203 --> -0.847206).  Saving model ...
Epoch: 5 cost time: 0.8093745708465576
Epoch: 5, Steps: 7 | Train Loss: 1.052 Vali Loss: 1.156 Vali Acc: 0.875 Test Loss: 1.156 Test Acc: 0.875
Validation loss decreased (-0.847206 --> -0.874988).  Saving model ...
Epoch: 6 cost time: 0.8126475811004639
Epoch: 6, Steps: 7 | Train Loss: 0.641 Vali Loss: 0.799 Vali Acc: 0.861 Test Loss: 0.799 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8090877532958984
Epoch: 7, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7794127464294434
Epoch: 8, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.874988 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.7306184768676758
Epoch: 9, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.6982274055480957
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.667985200881958
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6714382171630859
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6295623779296875
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6603059768676758
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.739605188369751
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.776019811630249
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8114480972290039
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7944810390472412
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7937016487121582
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.9337794780731201
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.8789334297180176
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.7518014907836914
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6894674301147461
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7350380420684814
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.7889924049377441
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.8126053810119629
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.7109169960021973
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6330549716949463
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6854705810546875
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6847813129425049
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.8145077228546143
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.8081135749816895
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.9043262004852295
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.8576042652130127
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.9290235042572021
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7913675308227539
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7898478507995605
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.8305299282073975
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.7541658878326416
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7788002490997314
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.7760531902313232
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8884191513061523
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.7875699996948242
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.8458733558654785
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.8459150791168213
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.6636838912963867
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.7055542469024658
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6816179752349854
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7527580261230469
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7267351150512695
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 4306572
model size : 16.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3306446075439453
Epoch: 1, Steps: 7 | Train Loss: 2.485 Vali Loss: 2.438 Vali Acc: 0.097 Test Loss: 2.438 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.8423311710357666
Epoch: 2, Steps: 7 | Train Loss: 2.342 Vali Loss: 2.283 Vali Acc: 0.403 Test Loss: 2.283 Test Acc: 0.403
Validation loss decreased (-0.097198 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.7645595073699951
Epoch: 3, Steps: 7 | Train Loss: 2.037 Vali Loss: 2.022 Vali Acc: 0.708 Test Loss: 2.022 Test Acc: 0.708
Validation loss decreased (-0.402755 --> -0.708313).  Saving model ...
Epoch: 4 cost time: 0.7566709518432617
Epoch: 4, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.694 Vali Acc: 0.778 Test Loss: 1.694 Test Acc: 0.778
Validation loss decreased (-0.708313 --> -0.777761).  Saving model ...
Epoch: 5 cost time: 0.8173210620880127
Epoch: 5, Steps: 7 | Train Loss: 1.236 Vali Loss: 1.319 Vali Acc: 0.819 Test Loss: 1.319 Test Acc: 0.819
Validation loss decreased (-0.777761 --> -0.819431).  Saving model ...
Epoch: 6 cost time: 0.7748920917510986
Epoch: 6, Steps: 7 | Train Loss: 0.821 Vali Loss: 0.971 Vali Acc: 0.847 Test Loss: 0.971 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847213).  Saving model ...
Epoch: 7 cost time: 0.8201837539672852
Epoch: 7, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.685 Vali Acc: 0.889 Test Loss: 0.685 Test Acc: 0.889
Validation loss decreased (-0.847213 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 0.7698376178741455
Epoch: 8, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.524 Vali Acc: 0.903 Test Loss: 0.524 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.8916010856628418
Epoch: 9, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7032241821289062
Epoch: 10, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7260231971740723
Epoch: 11, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7737843990325928
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.696387767791748
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8081417083740234
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7366166114807129
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7363684177398682
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7238101959228516
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7903010845184326
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.8986802101135254
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.7083008289337158
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7387864589691162
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7388343811035156
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.6514265537261963
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.7212910652160645
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 25 cost time: 0.7450132369995117
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.8231790065765381
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 0.750037670135498
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 0.7264370918273926
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8057029247283936
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7223548889160156
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 31 cost time: 0.8374266624450684
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 32 cost time: 0.8432466983795166
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7396092414855957
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8635733127593994
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.633704423904419
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7992937564849854
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.8177142143249512
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.7274594306945801
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.5943348407745361
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.7086915969848633
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5919220447540283
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.7423520088195801
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.7067534923553467
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.6926047801971436
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7471334934234619
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.621880054473877
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6214015483856201
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7698302268981934
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7541394233703613
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9302666187286377
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 4295820
model size : 16.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0796024799346924
Epoch: 1, Steps: 7 | Train Loss: 2.437 Vali Loss: 2.384 Vali Acc: 0.222 Test Loss: 2.384 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.7173168659210205
Epoch: 2, Steps: 7 | Train Loss: 2.073 Vali Loss: 2.023 Vali Acc: 0.722 Test Loss: 2.023 Test Acc: 0.722
Validation loss decreased (-0.222198 --> -0.722202).  Saving model ...
Epoch: 3 cost time: 0.7683980464935303
Epoch: 3, Steps: 7 | Train Loss: 1.354 Vali Loss: 1.442 Vali Acc: 0.847 Test Loss: 1.442 Test Acc: 0.847
Validation loss decreased (-0.722202 --> -0.847208).  Saving model ...
Epoch: 4 cost time: 0.6316726207733154
Epoch: 4, Steps: 7 | Train Loss: 0.636 Vali Loss: 0.847 Vali Acc: 0.944 Test Loss: 0.847 Test Acc: 0.944
Validation loss decreased (-0.847208 --> -0.944436).  Saving model ...
Epoch: 5 cost time: 0.7662899494171143
Epoch: 5, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.459 Vali Acc: 0.944 Test Loss: 0.459 Test Acc: 0.944
Validation loss decreased (-0.944436 --> -0.944440).  Saving model ...
Epoch: 6 cost time: 0.7905099391937256
Epoch: 6, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 0.6882431507110596
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.7629117965698242
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.8081264495849609
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6646223068237305
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.8689346313476562
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.6728367805480957
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8617713451385498
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7357926368713379
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5757629871368408
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.675997257232666
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6557333469390869
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6827490329742432
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6532530784606934
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6581368446350098
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5695405006408691
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6988205909729004
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6934628486633301
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7404913902282715
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5384097099304199
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.755136251449585
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.8042430877685547
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8129589557647705
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6959524154663086
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6843760013580322
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.8501548767089844
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.748370885848999
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.8570590019226074
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.8064229488372803
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.7454628944396973
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.8069825172424316
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.7752974033355713
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7622673511505127
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8846750259399414
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8205838203430176
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7304658889770508
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7767801284790039
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.6609036922454834
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.754295825958252
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.6879394054412842
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6891090869903564
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6884636878967285
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7184445858001709
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7879867553710938
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6807742118835449
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1462988
model size : 5.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.987288236618042
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.405 Vali Acc: 0.167 Test Loss: 2.405 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.6198883056640625
Epoch: 2, Steps: 7 | Train Loss: 2.236 Vali Loss: 2.145 Vali Acc: 0.625 Test Loss: 2.145 Test Acc: 0.625
Validation loss decreased (-0.166643 --> -0.624979).  Saving model ...
Epoch: 3 cost time: 0.7398576736450195
Epoch: 3, Steps: 7 | Train Loss: 1.778 Vali Loss: 1.730 Vali Acc: 0.819 Test Loss: 1.730 Test Acc: 0.819
Validation loss decreased (-0.624979 --> -0.819427).  Saving model ...
Epoch: 4 cost time: 0.6711680889129639
Epoch: 4, Steps: 7 | Train Loss: 1.195 Vali Loss: 1.242 Vali Acc: 0.875 Test Loss: 1.242 Test Acc: 0.875
Validation loss decreased (-0.819427 --> -0.874988).  Saving model ...
Epoch: 5 cost time: 0.6606266498565674
Epoch: 5, Steps: 7 | Train Loss: 0.657 Vali Loss: 0.778 Vali Acc: 0.931 Test Loss: 0.778 Test Acc: 0.931
Validation loss decreased (-0.874988 --> -0.930548).  Saving model ...
Epoch: 6 cost time: 0.5878207683563232
Epoch: 6, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.471 Vali Acc: 0.917 Test Loss: 0.471 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7784724235534668
Epoch: 7, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.5702500343322754
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.6546874046325684
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.7479538917541504
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.6644244194030762
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7067070007324219
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7027554512023926
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6754112243652344
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7276818752288818
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.7267904281616211
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6755659580230713
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.7596745491027832
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.7307569980621338
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7100815773010254
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.7667694091796875
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.811898946762085
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.7958571910858154
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.6938104629516602
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.6748268604278564
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.889786958694458
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.7890348434448242
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7161097526550293
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 0.6202285289764404
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.7795712947845459
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.7807369232177734
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 0.7801294326782227
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.6914143562316895
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.7008030414581299
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.6142380237579346
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7012979984283447
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.6626732349395752
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.6074016094207764
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.6602351665496826
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.6956222057342529
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.6083660125732422
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.7136185169219971
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.7042505741119385
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.8035645484924316
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.7306234836578369
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7604196071624756
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.8074467182159424
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.690497636795044
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.7376160621643066
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.69930100440979
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1280588
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9404876232147217
Epoch: 1, Steps: 7 | Train Loss: 2.462 Vali Loss: 2.416 Vali Acc: 0.278 Test Loss: 2.416 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 0.6135702133178711
Epoch: 2, Steps: 7 | Train Loss: 2.294 Vali Loss: 2.260 Vali Acc: 0.417 Test Loss: 2.260 Test Acc: 0.417
Validation loss decreased (-0.277754 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 0.6349942684173584
Epoch: 3, Steps: 7 | Train Loss: 2.011 Vali Loss: 1.996 Vali Acc: 0.736 Test Loss: 1.996 Test Acc: 0.736
Validation loss decreased (-0.416644 --> -0.736091).  Saving model ...
Epoch: 4 cost time: 0.6111478805541992
Epoch: 4, Steps: 7 | Train Loss: 1.598 Vali Loss: 1.650 Vali Acc: 0.764 Test Loss: 1.650 Test Acc: 0.764
Validation loss decreased (-0.736091 --> -0.763872).  Saving model ...
Epoch: 5 cost time: 0.7260887622833252
Epoch: 5, Steps: 7 | Train Loss: 1.177 Vali Loss: 1.248 Vali Acc: 0.847 Test Loss: 1.248 Test Acc: 0.847
Validation loss decreased (-0.763872 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 0.6251564025878906
Epoch: 6, Steps: 7 | Train Loss: 0.712 Vali Loss: 0.854 Vali Acc: 0.903 Test Loss: 0.854 Test Acc: 0.903
Validation loss decreased (-0.847210 --> -0.902769).  Saving model ...
Epoch: 7 cost time: 0.7321741580963135
Epoch: 7, Steps: 7 | Train Loss: 0.366 Vali Loss: 0.568 Vali Acc: 0.903 Test Loss: 0.568 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 0.5440096855163574
Epoch: 8, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.409 Vali Acc: 0.903 Test Loss: 0.409 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.5857152938842773
Epoch: 9, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.6165964603424072
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.6082634925842285
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6860442161560059
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7071843147277832
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5836062431335449
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6660850048065186
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6367332935333252
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6775927543640137
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7005314826965332
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6485238075256348
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7035741806030273
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1217996
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8366055488586426
Epoch: 1, Steps: 7 | Train Loss: 2.479 Vali Loss: 2.469 Vali Acc: 0.056 Test Loss: 2.469 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.6470358371734619
Epoch: 2, Steps: 7 | Train Loss: 2.344 Vali Loss: 2.324 Vali Acc: 0.389 Test Loss: 2.324 Test Acc: 0.389
Validation loss decreased (-0.055531 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 0.590623140335083
Epoch: 3, Steps: 7 | Train Loss: 2.064 Vali Loss: 2.078 Vali Acc: 0.597 Test Loss: 2.078 Test Acc: 0.597
Validation loss decreased (-0.388866 --> -0.597201).  Saving model ...
Epoch: 4 cost time: 0.6770823001861572
Epoch: 4, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.736 Vali Acc: 0.778 Test Loss: 1.736 Test Acc: 0.778
Validation loss decreased (-0.597201 --> -0.777760).  Saving model ...
Epoch: 5 cost time: 0.6108496189117432
Epoch: 5, Steps: 7 | Train Loss: 1.283 Vali Loss: 1.331 Vali Acc: 0.833 Test Loss: 1.331 Test Acc: 0.833
Validation loss decreased (-0.777760 --> -0.833320).  Saving model ...
Epoch: 6 cost time: 0.5764217376708984
Epoch: 6, Steps: 7 | Train Loss: 0.859 Vali Loss: 0.928 Vali Acc: 0.875 Test Loss: 0.928 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.5576381683349609
Epoch: 7, Steps: 7 | Train Loss: 0.503 Vali Loss: 0.633 Vali Acc: 0.889 Test Loss: 0.633 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.5272376537322998
Epoch: 8, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.467 Vali Acc: 0.931 Test Loss: 0.467 Test Acc: 0.931
Validation loss decreased (-0.888883 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 0.5574610233306885
Epoch: 9, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6597254276275635
Epoch: 10, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6610093116760254
Epoch: 11, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6772181987762451
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.667128324508667
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5916531085968018
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5410096645355225
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.6221935749053955
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6037933826446533
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.5939285755157471
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.659665584564209
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6461672782897949
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5959179401397705
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5947103500366211
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6540987491607666
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.7336418628692627
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6224336624145508
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6874897480010986
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5840599536895752
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6436235904693604
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6533751487731934
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.606414794921875
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.4953479766845703
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6054422855377197
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5874669551849365
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6631567478179932
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.518831729888916
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.5648727416992188
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.6014385223388672
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5625133514404297
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6504192352294922
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.5352835655212402
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6296920776367188
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5781118869781494
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5724098682403564
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.570080041885376
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5449450016021729
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.677480936050415
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6263241767883301
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5965902805328369
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6268689632415771
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7571914196014404
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1192268
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.11236572265625
Epoch: 1, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.455 Vali Acc: 0.069 Test Loss: 2.455 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.6012399196624756
Epoch: 2, Steps: 7 | Train Loss: 2.379 Vali Loss: 2.340 Vali Acc: 0.375 Test Loss: 2.340 Test Acc: 0.375
Validation loss decreased (-0.069420 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.6825840473175049
Epoch: 3, Steps: 7 | Train Loss: 2.173 Vali Loss: 2.153 Vali Acc: 0.625 Test Loss: 2.153 Test Acc: 0.625
Validation loss decreased (-0.374977 --> -0.624978).  Saving model ...
Epoch: 4 cost time: 0.6305267810821533
Epoch: 4, Steps: 7 | Train Loss: 1.903 Vali Loss: 1.895 Vali Acc: 0.778 Test Loss: 1.895 Test Acc: 0.778
Validation loss decreased (-0.624978 --> -0.777759).  Saving model ...
Epoch: 5 cost time: 0.7323088645935059
Epoch: 5, Steps: 7 | Train Loss: 1.578 Vali Loss: 1.577 Vali Acc: 0.792 Test Loss: 1.577 Test Acc: 0.792
Validation loss decreased (-0.777759 --> -0.791651).  Saving model ...
Epoch: 6 cost time: 0.591027021408081
Epoch: 6, Steps: 7 | Train Loss: 1.229 Vali Loss: 1.242 Vali Acc: 0.875 Test Loss: 1.242 Test Acc: 0.875
Validation loss decreased (-0.791651 --> -0.874988).  Saving model ...
Epoch: 7 cost time: 0.5953843593597412
Epoch: 7, Steps: 7 | Train Loss: 0.861 Vali Loss: 0.918 Vali Acc: 0.889 Test Loss: 0.918 Test Acc: 0.889
Validation loss decreased (-0.874988 --> -0.888880).  Saving model ...
Epoch: 8 cost time: 0.5956780910491943
Epoch: 8, Steps: 7 | Train Loss: 0.547 Vali Loss: 0.657 Vali Acc: 0.903 Test Loss: 0.657 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902771).  Saving model ...
Epoch: 9 cost time: 0.5947203636169434
Epoch: 9, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.478 Vali Acc: 0.944 Test Loss: 0.478 Test Acc: 0.944
Validation loss decreased (-0.902771 --> -0.944440).  Saving model ...
Epoch: 10 cost time: 0.5980610847473145
Epoch: 10, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6723897457122803
Epoch: 11, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6314809322357178
Epoch: 12, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6094391345977783
Epoch: 13, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6288893222808838
Epoch: 14, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.6304106712341309
Epoch: 15, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6093344688415527
Epoch: 16, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6916611194610596
Epoch: 17, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.6058332920074463
Epoch: 18, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5417523384094238
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.6702172756195068
Epoch: 20, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6603975296020508
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.7035324573516846
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6913337707519531
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5783348083496094
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.6893703937530518
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6479494571685791
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.563453197479248
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5543193817138672
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7206141948699951
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5537352561950684
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.7194461822509766
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 0.6780085563659668
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.6457977294921875
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.6309435367584229
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.6369929313659668
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.6115906238555908
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.7270889282226562
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.7617125511169434
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.6263091564178467
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.6064846515655518
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.6973912715911865
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6357507705688477
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.7841849327087402
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5564959049224854
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7487685680389404
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7038569450378418
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6762583255767822
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.6062729358673096
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.6422688961029053
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.6923732757568359
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1168460
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.017997980117798
Epoch: 1, Steps: 7 | Train Loss: 2.518 Vali Loss: 2.505 Vali Acc: 0.083 Test Loss: 2.505 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.6153490543365479
Epoch: 2, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.427 Vali Acc: 0.167 Test Loss: 2.427 Test Acc: 0.167
Validation loss decreased (-0.083308 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.5302679538726807
Epoch: 3, Steps: 7 | Train Loss: 2.247 Vali Loss: 2.288 Vali Acc: 0.417 Test Loss: 2.288 Test Acc: 0.417
Validation loss decreased (-0.166642 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 0.5316307544708252
Epoch: 4, Steps: 7 | Train Loss: 2.028 Vali Loss: 2.094 Vali Acc: 0.611 Test Loss: 2.094 Test Acc: 0.611
Validation loss decreased (-0.416644 --> -0.611090).  Saving model ...
Epoch: 5 cost time: 0.6238648891448975
Epoch: 5, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.850 Vali Acc: 0.708 Test Loss: 1.850 Test Acc: 0.708
Validation loss decreased (-0.611090 --> -0.708315).  Saving model ...
Epoch: 6 cost time: 0.639458417892456
Epoch: 6, Steps: 7 | Train Loss: 1.479 Vali Loss: 1.571 Vali Acc: 0.792 Test Loss: 1.571 Test Acc: 0.792
Validation loss decreased (-0.708315 --> -0.791651).  Saving model ...
Epoch: 7 cost time: 0.5920968055725098
Epoch: 7, Steps: 7 | Train Loss: 1.152 Vali Loss: 1.268 Vali Acc: 0.806 Test Loss: 1.268 Test Acc: 0.806
Validation loss decreased (-0.791651 --> -0.805543).  Saving model ...
Epoch: 8 cost time: 0.6285524368286133
Epoch: 8, Steps: 7 | Train Loss: 0.839 Vali Loss: 0.992 Vali Acc: 0.819 Test Loss: 0.992 Test Acc: 0.819
Validation loss decreased (-0.805543 --> -0.819435).  Saving model ...
Epoch: 9 cost time: 0.5820658206939697
Epoch: 9, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.766 Vali Acc: 0.847 Test Loss: 0.766 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847215).  Saving model ...
Epoch: 10 cost time: 0.6389708518981934
Epoch: 10, Steps: 7 | Train Loss: 0.369 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 11 cost time: 0.753427267074585
Epoch: 11, Steps: 7 | Train Loss: 0.223 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 12 cost time: 0.5270695686340332
Epoch: 12, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 0.6628000736236572
Epoch: 13, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 0.5430243015289307
Epoch: 14, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.6195287704467773
Epoch: 15, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.6368985176086426
Epoch: 16, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.6267802715301514
Epoch: 17, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6096076965332031
Epoch: 18, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6679680347442627
Epoch: 19, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5765204429626465
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6393184661865234
Epoch: 21, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6680872440338135
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6641955375671387
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6615159511566162
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.722848653793335
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6338810920715332
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5349109172821045
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.667933464050293
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5896952152252197
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5974652767181396
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5308432579040527
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5522665977478027
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6803250312805176
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6376416683197021
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.641979455947876
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.5677788257598877
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.7212979793548584
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.5671637058258057
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6660604476928711
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.6433939933776855
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6389844417572021
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.680225133895874
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6810884475708008
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5675215721130371
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.692786693572998
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6197233200073242
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6009845733642578
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6033432483673096
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6284401416778564
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1153868
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.789917230606079
Epoch: 1, Steps: 7 | Train Loss: 2.486 Vali Loss: 2.499 Vali Acc: 0.125 Test Loss: 2.499 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.5736544132232666
Epoch: 2, Steps: 7 | Train Loss: 2.414 Vali Loss: 2.429 Vali Acc: 0.250 Test Loss: 2.429 Test Acc: 0.250
Validation loss decreased (-0.124975 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.506181001663208
Epoch: 3, Steps: 7 | Train Loss: 2.257 Vali Loss: 2.304 Vali Acc: 0.472 Test Loss: 2.304 Test Acc: 0.472
Validation loss decreased (-0.249976 --> -0.472199).  Saving model ...
Epoch: 4 cost time: 0.5977833271026611
Epoch: 4, Steps: 7 | Train Loss: 2.069 Vali Loss: 2.133 Vali Acc: 0.667 Test Loss: 2.133 Test Acc: 0.667
Validation loss decreased (-0.472199 --> -0.666645).  Saving model ...
Epoch: 5 cost time: 0.5995471477508545
Epoch: 5, Steps: 7 | Train Loss: 1.845 Vali Loss: 1.917 Vali Acc: 0.778 Test Loss: 1.917 Test Acc: 0.778
Validation loss decreased (-0.666645 --> -0.777759).  Saving model ...
Epoch: 6 cost time: 0.49819517135620117
Epoch: 6, Steps: 7 | Train Loss: 1.594 Vali Loss: 1.661 Vali Acc: 0.806 Test Loss: 1.661 Test Acc: 0.806
Validation loss decreased (-0.777759 --> -0.805539).  Saving model ...
Epoch: 7 cost time: 0.5345826148986816
Epoch: 7, Steps: 7 | Train Loss: 1.302 Vali Loss: 1.390 Vali Acc: 0.806 Test Loss: 1.390 Test Acc: 0.806
Validation loss decreased (-0.805539 --> -0.805542).  Saving model ...
Epoch: 8 cost time: 0.5617752075195312
Epoch: 8, Steps: 7 | Train Loss: 1.005 Vali Loss: 1.136 Vali Acc: 0.806 Test Loss: 1.136 Test Acc: 0.806
Validation loss decreased (-0.805542 --> -0.805544).  Saving model ...
Epoch: 9 cost time: 0.47220826148986816
Epoch: 9, Steps: 7 | Train Loss: 0.736 Vali Loss: 0.906 Vali Acc: 0.819 Test Loss: 0.906 Test Acc: 0.819
Validation loss decreased (-0.805544 --> -0.819435).  Saving model ...
Epoch: 10 cost time: 0.5641651153564453
Epoch: 10, Steps: 7 | Train Loss: 0.512 Vali Loss: 0.725 Vali Acc: 0.833 Test Loss: 0.725 Test Acc: 0.833
Validation loss decreased (-0.819435 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 0.5682833194732666
Epoch: 11, Steps: 7 | Train Loss: 0.337 Vali Loss: 0.600 Vali Acc: 0.847 Test Loss: 0.600 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847216).  Saving model ...
Epoch: 12 cost time: 0.6211168766021729
Epoch: 12, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.5057942867279053
Epoch: 13, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5390472412109375
Epoch: 14, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.6374433040618896
Epoch: 15, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6329953670501709
Epoch: 16, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.5115940570831299
Epoch: 17, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.6047723293304443
Epoch: 18, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.5971236228942871
Epoch: 19, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 0.5924394130706787
Epoch: 20, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 0.5465841293334961
Epoch: 21, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.5862104892730713
Epoch: 22, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.7437899112701416
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 24 cost time: 0.5878984928131104
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6588263511657715
Epoch: 25, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5664587020874023
Epoch: 26, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 0.7256526947021484
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 28 cost time: 0.6205122470855713
Epoch: 28, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 29 cost time: 0.6204257011413574
Epoch: 29, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 30 cost time: 0.6229434013366699
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 31 cost time: 0.6123735904693604
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 32 cost time: 0.6414422988891602
Epoch: 32, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 33 cost time: 0.7102017402648926
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 34 cost time: 0.6656844615936279
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 35 cost time: 0.5911448001861572
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 36 cost time: 0.6742792129516602
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.5888752937316895
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.544550895690918
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.5836379528045654
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.6306033134460449
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5932235717773438
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6066925525665283
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 43 cost time: 0.564530611038208
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 44 cost time: 0.694495677947998
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5167322158813477
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6594326496124268
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6833164691925049
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 48 cost time: 0.6070973873138428
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6463234424591064
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6021978855133057
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1148492
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8845858573913574
Epoch: 1, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.423 Vali Acc: 0.153 Test Loss: 2.423 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.4867374897003174
Epoch: 2, Steps: 7 | Train Loss: 2.282 Vali Loss: 2.230 Vali Acc: 0.500 Test Loss: 2.230 Test Acc: 0.500
Validation loss decreased (-0.152754 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 0.5940651893615723
Epoch: 3, Steps: 7 | Train Loss: 1.863 Vali Loss: 1.900 Vali Acc: 0.764 Test Loss: 1.900 Test Acc: 0.764
Validation loss decreased (-0.499978 --> -0.763870).  Saving model ...
Epoch: 4 cost time: 0.5286529064178467
Epoch: 4, Steps: 7 | Train Loss: 1.364 Vali Loss: 1.465 Vali Acc: 0.806 Test Loss: 1.465 Test Acc: 0.806
Validation loss decreased (-0.763870 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.5653605461120605
Epoch: 5, Steps: 7 | Train Loss: 0.859 Vali Loss: 1.023 Vali Acc: 0.847 Test Loss: 1.023 Test Acc: 0.847
Validation loss decreased (-0.805541 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.5187482833862305
Epoch: 6, Steps: 7 | Train Loss: 0.445 Vali Loss: 0.652 Vali Acc: 0.917 Test Loss: 0.652 Test Acc: 0.917
Validation loss decreased (-0.847212 --> -0.916660).  Saving model ...
Epoch: 7 cost time: 0.5219426155090332
Epoch: 7, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.447 Vali Acc: 0.917 Test Loss: 0.447 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.6126425266265869
Epoch: 8, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.5870683193206787
Epoch: 9, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.7250757217407227
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.6255428791046143
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.7146961688995361
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5665974617004395
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.6989645957946777
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.74131178855896
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.6406683921813965
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.638594388961792
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7431504726409912
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5756683349609375
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6035258769989014
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.7077956199645996
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.6340131759643555
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6004486083984375
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6411936283111572
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5899391174316406
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5452966690063477
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6164212226867676
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5244920253753662
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5186665058135986
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5105843544006348
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6566059589385986
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6302521228790283
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6235916614532471
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.6591918468475342
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.6200504302978516
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.7063083648681641
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.5542161464691162
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6487100124359131
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.6096930503845215
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5677356719970703
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6027228832244873
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.575568437576294
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5960171222686768
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.7125136852264404
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5678951740264893
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6806166172027588
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.6296324729919434
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.6764566898345947
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.6707792282104492
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5754053592681885
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 481644
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8389463424682617
Epoch: 1, Steps: 7 | Train Loss: 2.535 Vali Loss: 2.410 Vali Acc: 0.222 Test Loss: 2.410 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.6097457408905029
Epoch: 2, Steps: 7 | Train Loss: 2.392 Vali Loss: 2.299 Vali Acc: 0.431 Test Loss: 2.299 Test Acc: 0.431
Validation loss decreased (-0.222198 --> -0.430533).  Saving model ...
Epoch: 3 cost time: 0.5877788066864014
Epoch: 3, Steps: 7 | Train Loss: 2.161 Vali Loss: 2.108 Vali Acc: 0.681 Test Loss: 2.108 Test Acc: 0.681
Validation loss decreased (-0.430533 --> -0.680534).  Saving model ...
Epoch: 4 cost time: 0.5385816097259521
Epoch: 4, Steps: 7 | Train Loss: 1.855 Vali Loss: 1.826 Vali Acc: 0.833 Test Loss: 1.826 Test Acc: 0.833
Validation loss decreased (-0.680534 --> -0.833315).  Saving model ...
Epoch: 5 cost time: 0.6297221183776855
Epoch: 5, Steps: 7 | Train Loss: 1.494 Vali Loss: 1.494 Vali Acc: 0.889 Test Loss: 1.494 Test Acc: 0.889
Validation loss decreased (-0.833315 --> -0.888874).  Saving model ...
Epoch: 6 cost time: 0.612518310546875
Epoch: 6, Steps: 7 | Train Loss: 1.119 Vali Loss: 1.149 Vali Acc: 0.917 Test Loss: 1.149 Test Acc: 0.917
Validation loss decreased (-0.888874 --> -0.916655).  Saving model ...
Epoch: 7 cost time: 0.5768442153930664
Epoch: 7, Steps: 7 | Train Loss: 0.742 Vali Loss: 0.832 Vali Acc: 0.931 Test Loss: 0.832 Test Acc: 0.931
Validation loss decreased (-0.916655 --> -0.930547).  Saving model ...
Epoch: 8 cost time: 0.5788869857788086
Epoch: 8, Steps: 7 | Train Loss: 0.455 Vali Loss: 0.587 Vali Acc: 0.944 Test Loss: 0.587 Test Acc: 0.944
Validation loss decreased (-0.930547 --> -0.944439).  Saving model ...
Epoch: 9 cost time: 0.6260120868682861
Epoch: 9, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.429 Vali Acc: 0.958 Test Loss: 0.429 Test Acc: 0.958
Validation loss decreased (-0.944439 --> -0.958329).  Saving model ...
Epoch: 10 cost time: 0.6115667819976807
Epoch: 10, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.350 Vali Acc: 0.958 Test Loss: 0.350 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.5783569812774658
Epoch: 11, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.316 Vali Acc: 0.944 Test Loss: 0.316 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6699416637420654
Epoch: 12, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5629053115844727
Epoch: 13, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6254994869232178
Epoch: 14, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6820070743560791
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7212281227111816
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6489303112030029
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6663675308227539
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6159851551055908
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6699168682098389
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 390444
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0313403606414795
Epoch: 1, Steps: 7 | Train Loss: 2.541 Vali Loss: 2.454 Vali Acc: 0.097 Test Loss: 2.454 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.5496768951416016
Epoch: 2, Steps: 7 | Train Loss: 2.457 Vali Loss: 2.355 Vali Acc: 0.319 Test Loss: 2.355 Test Acc: 0.319
Validation loss decreased (-0.097198 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 0.613478422164917
Epoch: 3, Steps: 7 | Train Loss: 2.285 Vali Loss: 2.204 Vali Acc: 0.569 Test Loss: 2.204 Test Acc: 0.569
Validation loss decreased (-0.319421 --> -0.569422).  Saving model ...
Epoch: 4 cost time: 0.575061559677124
Epoch: 4, Steps: 7 | Train Loss: 2.052 Vali Loss: 1.997 Vali Acc: 0.722 Test Loss: 1.997 Test Acc: 0.722
Validation loss decreased (-0.569422 --> -0.722202).  Saving model ...
Epoch: 5 cost time: 0.5292539596557617
Epoch: 5, Steps: 7 | Train Loss: 1.771 Vali Loss: 1.739 Vali Acc: 0.861 Test Loss: 1.739 Test Acc: 0.861
Validation loss decreased (-0.722202 --> -0.861094).  Saving model ...
Epoch: 6 cost time: 0.6152095794677734
Epoch: 6, Steps: 7 | Train Loss: 1.472 Vali Loss: 1.448 Vali Acc: 0.889 Test Loss: 1.448 Test Acc: 0.889
Validation loss decreased (-0.861094 --> -0.888874).  Saving model ...
Epoch: 7 cost time: 0.5385172367095947
Epoch: 7, Steps: 7 | Train Loss: 1.136 Vali Loss: 1.139 Vali Acc: 0.917 Test Loss: 1.139 Test Acc: 0.917
Validation loss decreased (-0.888874 --> -0.916655).  Saving model ...
Epoch: 8 cost time: 0.5541689395904541
Epoch: 8, Steps: 7 | Train Loss: 0.811 Vali Loss: 0.867 Vali Acc: 0.917 Test Loss: 0.867 Test Acc: 0.917
Validation loss decreased (-0.916655 --> -0.916658).  Saving model ...
Epoch: 9 cost time: 0.5284411907196045
Epoch: 9, Steps: 7 | Train Loss: 0.524 Vali Loss: 0.643 Vali Acc: 0.917 Test Loss: 0.643 Test Acc: 0.917
Validation loss decreased (-0.916658 --> -0.916660).  Saving model ...
Epoch: 10 cost time: 0.5518829822540283
Epoch: 10, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.503 Vali Acc: 0.903 Test Loss: 0.503 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6114087104797363
Epoch: 11, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6256494522094727
Epoch: 12, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.603548526763916
Epoch: 13, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.6060075759887695
Epoch: 14, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5795400142669678
Epoch: 15, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.542365550994873
Epoch: 16, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5387325286865234
Epoch: 17, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6915276050567627
Epoch: 18, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6890997886657715
Epoch: 19, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5903453826904297
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.61307692527771
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5944981575012207
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.6280033588409424
Epoch: 23, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.5930304527282715
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5747857093811035
Epoch: 25, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5852718353271484
Epoch: 26, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5995757579803467
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.5978450775146484
Epoch: 28, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5879473686218262
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6726484298706055
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6301240921020508
Epoch: 31, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5296926498413086
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7193508148193359
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5908031463623047
Epoch: 34, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5512652397155762
Epoch: 35, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5781688690185547
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.5215585231781006
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6103713512420654
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.7310495376586914
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6470072269439697
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5367202758789062
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5001006126403809
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5444560050964355
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5178425312042236
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5505790710449219
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6041793823242188
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6082193851470947
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5292768478393555
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5645115375518799
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.4937267303466797
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 359148
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.846524953842163
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.471 Vali Acc: 0.208 Test Loss: 2.471 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.5749595165252686
Epoch: 2, Steps: 7 | Train Loss: 2.416 Vali Loss: 2.387 Vali Acc: 0.278 Test Loss: 2.387 Test Acc: 0.278
Validation loss decreased (-0.208309 --> -0.277754).  Saving model ...
Epoch: 3 cost time: 0.5914759635925293
Epoch: 3, Steps: 7 | Train Loss: 2.285 Vali Loss: 2.252 Vali Acc: 0.458 Test Loss: 2.252 Test Acc: 0.458
Validation loss decreased (-0.277754 --> -0.458311).  Saving model ...
Epoch: 4 cost time: 0.5429527759552002
Epoch: 4, Steps: 7 | Train Loss: 2.092 Vali Loss: 2.068 Vali Acc: 0.583 Test Loss: 2.068 Test Acc: 0.583
Validation loss decreased (-0.458311 --> -0.583313).  Saving model ...
Epoch: 5 cost time: 0.5792601108551025
Epoch: 5, Steps: 7 | Train Loss: 1.832 Vali Loss: 1.834 Vali Acc: 0.764 Test Loss: 1.834 Test Acc: 0.764
Validation loss decreased (-0.583313 --> -0.763871).  Saving model ...
Epoch: 6 cost time: 0.5599031448364258
Epoch: 6, Steps: 7 | Train Loss: 1.552 Vali Loss: 1.569 Vali Acc: 0.806 Test Loss: 1.569 Test Acc: 0.806
Validation loss decreased (-0.763871 --> -0.805540).  Saving model ...
Epoch: 7 cost time: 0.6313128471374512
Epoch: 7, Steps: 7 | Train Loss: 1.266 Vali Loss: 1.292 Vali Acc: 0.847 Test Loss: 1.292 Test Acc: 0.847
Validation loss decreased (-0.805540 --> -0.847209).  Saving model ...
Epoch: 8 cost time: 0.5696308612823486
Epoch: 8, Steps: 7 | Train Loss: 0.960 Vali Loss: 1.021 Vali Acc: 0.875 Test Loss: 1.021 Test Acc: 0.875
Validation loss decreased (-0.847209 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.6015055179595947
Epoch: 9, Steps: 7 | Train Loss: 0.695 Vali Loss: 0.791 Vali Acc: 0.903 Test Loss: 0.791 Test Acc: 0.903
Validation loss decreased (-0.874990 --> -0.902770).  Saving model ...
Epoch: 10 cost time: 0.5416512489318848
Epoch: 10, Steps: 7 | Train Loss: 0.472 Vali Loss: 0.615 Vali Acc: 0.903 Test Loss: 0.615 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902772).  Saving model ...
Epoch: 11 cost time: 0.5475773811340332
Epoch: 11, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5332870483398438
Epoch: 12, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.5472161769866943
Epoch: 13, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.5907676219940186
Epoch: 14, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.586519718170166
Epoch: 15, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.5300078392028809
Epoch: 16, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5334422588348389
Epoch: 17, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.5971517562866211
Epoch: 18, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5673928260803223
Epoch: 19, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5388376712799072
Epoch: 20, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.5595791339874268
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5536134243011475
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.541215181350708
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5654411315917969
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5378711223602295
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6425161361694336
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6365385055541992
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.5562758445739746
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5313854217529297
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.5239639282226562
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.5193531513214111
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.5458226203918457
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.574188232421875
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7330436706542969
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.5538952350616455
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6043975353240967
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.5336782932281494
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.58620285987854
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.5333409309387207
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5971112251281738
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6661789417266846
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5476067066192627
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5169782638549805
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.598177433013916
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.5381174087524414
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.6413800716400146
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.6500372886657715
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.579578161239624
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.644559383392334
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.5639455318450928
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 346284
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8156991004943848
Epoch: 1, Steps: 7 | Train Loss: 2.464 Vali Loss: 2.441 Vali Acc: 0.181 Test Loss: 2.441 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.5139875411987305
Epoch: 2, Steps: 7 | Train Loss: 2.428 Vali Loss: 2.384 Vali Acc: 0.264 Test Loss: 2.384 Test Acc: 0.264
Validation loss decreased (-0.180531 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 0.49675583839416504
Epoch: 3, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.290 Vali Acc: 0.417 Test Loss: 2.290 Test Acc: 0.417
Validation loss decreased (-0.263865 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 0.5199694633483887
Epoch: 4, Steps: 7 | Train Loss: 2.184 Vali Loss: 2.167 Vali Acc: 0.556 Test Loss: 2.167 Test Acc: 0.556
Validation loss decreased (-0.416644 --> -0.555534).  Saving model ...
Epoch: 5 cost time: 0.5285184383392334
Epoch: 5, Steps: 7 | Train Loss: 2.005 Vali Loss: 2.011 Vali Acc: 0.694 Test Loss: 2.011 Test Acc: 0.694
Validation loss decreased (-0.555534 --> -0.694424).  Saving model ...
Epoch: 6 cost time: 0.6262688636779785
Epoch: 6, Steps: 7 | Train Loss: 1.814 Vali Loss: 1.814 Vali Acc: 0.722 Test Loss: 1.814 Test Acc: 0.722
Validation loss decreased (-0.694424 --> -0.722204).  Saving model ...
Epoch: 7 cost time: 0.6195805072784424
Epoch: 7, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.597 Vali Acc: 0.847 Test Loss: 1.597 Test Acc: 0.847
Validation loss decreased (-0.722204 --> -0.847206).  Saving model ...
Epoch: 8 cost time: 0.5967681407928467
Epoch: 8, Steps: 7 | Train Loss: 1.346 Vali Loss: 1.373 Vali Acc: 0.889 Test Loss: 1.373 Test Acc: 0.889
Validation loss decreased (-0.847206 --> -0.888875).  Saving model ...
Epoch: 9 cost time: 0.6367995738983154
Epoch: 9, Steps: 7 | Train Loss: 1.099 Vali Loss: 1.155 Vali Acc: 0.917 Test Loss: 1.155 Test Acc: 0.917
Validation loss decreased (-0.888875 --> -0.916655).  Saving model ...
Epoch: 10 cost time: 0.5166914463043213
Epoch: 10, Steps: 7 | Train Loss: 0.831 Vali Loss: 0.934 Vali Acc: 0.931 Test Loss: 0.934 Test Acc: 0.931
Validation loss decreased (-0.916655 --> -0.930546).  Saving model ...
Epoch: 11 cost time: 0.5727016925811768
Epoch: 11, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.745 Vali Acc: 0.931 Test Loss: 0.745 Test Acc: 0.931
Validation loss decreased (-0.930546 --> -0.930548).  Saving model ...
Epoch: 12 cost time: 0.5982911586761475
Epoch: 12, Steps: 7 | Train Loss: 0.448 Vali Loss: 0.602 Vali Acc: 0.931 Test Loss: 0.602 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930550).  Saving model ...
Epoch: 13 cost time: 0.5918936729431152
Epoch: 13, Steps: 7 | Train Loss: 0.308 Vali Loss: 0.509 Vali Acc: 0.944 Test Loss: 0.509 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944439).  Saving model ...
Epoch: 14 cost time: 0.5975165367126465
Epoch: 14, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.445 Vali Acc: 0.944 Test Loss: 0.445 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 15 cost time: 0.6305642127990723
Epoch: 15, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5058960914611816
Epoch: 16, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6411607265472412
Epoch: 17, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.5129547119140625
Epoch: 18, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.5912070274353027
Epoch: 19, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.5543115139007568
Epoch: 20, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5347530841827393
Epoch: 21, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5588541030883789
Epoch: 22, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5269687175750732
Epoch: 23, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.549527645111084
Epoch: 24, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.572108268737793
Epoch: 25, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5793740749359131
Epoch: 26, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6405141353607178
Epoch: 27, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6160566806793213
Epoch: 28, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6550807952880859
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 334380
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.191986560821533
Epoch: 1, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.474 Vali Acc: 0.153 Test Loss: 2.474 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.4781503677368164
Epoch: 2, Steps: 7 | Train Loss: 2.431 Vali Loss: 2.428 Vali Acc: 0.194 Test Loss: 2.428 Test Acc: 0.194
Validation loss decreased (-0.152753 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.543205738067627
Epoch: 3, Steps: 7 | Train Loss: 2.348 Vali Loss: 2.349 Vali Acc: 0.264 Test Loss: 2.349 Test Acc: 0.264
Validation loss decreased (-0.194420 --> -0.263865).  Saving model ...
Epoch: 4 cost time: 0.5517597198486328
Epoch: 4, Steps: 7 | Train Loss: 2.227 Vali Loss: 2.247 Vali Acc: 0.431 Test Loss: 2.247 Test Acc: 0.431
Validation loss decreased (-0.263865 --> -0.430533).  Saving model ...
Epoch: 5 cost time: 0.5278027057647705
Epoch: 5, Steps: 7 | Train Loss: 2.089 Vali Loss: 2.116 Vali Acc: 0.528 Test Loss: 2.116 Test Acc: 0.528
Validation loss decreased (-0.430533 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 0.6493110656738281
Epoch: 6, Steps: 7 | Train Loss: 1.931 Vali Loss: 1.963 Vali Acc: 0.667 Test Loss: 1.963 Test Acc: 0.667
Validation loss decreased (-0.527757 --> -0.666647).  Saving model ...
Epoch: 7 cost time: 0.6055855751037598
Epoch: 7, Steps: 7 | Train Loss: 1.746 Vali Loss: 1.789 Vali Acc: 0.694 Test Loss: 1.789 Test Acc: 0.694
Validation loss decreased (-0.666647 --> -0.694427).  Saving model ...
Epoch: 8 cost time: 0.529104471206665
Epoch: 8, Steps: 7 | Train Loss: 1.552 Vali Loss: 1.599 Vali Acc: 0.736 Test Loss: 1.599 Test Acc: 0.736
Validation loss decreased (-0.694427 --> -0.736095).  Saving model ...
Epoch: 9 cost time: 0.5364232063293457
Epoch: 9, Steps: 7 | Train Loss: 1.340 Vali Loss: 1.408 Vali Acc: 0.819 Test Loss: 1.408 Test Acc: 0.819
Validation loss decreased (-0.736095 --> -0.819430).  Saving model ...
Epoch: 10 cost time: 0.6173937320709229
Epoch: 10, Steps: 7 | Train Loss: 1.133 Vali Loss: 1.216 Vali Acc: 0.806 Test Loss: 1.216 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6190102100372314
Epoch: 11, Steps: 7 | Train Loss: 0.911 Vali Loss: 1.034 Vali Acc: 0.861 Test Loss: 1.034 Test Acc: 0.861
Validation loss decreased (-0.819430 --> -0.861101).  Saving model ...
Epoch: 12 cost time: 0.8180875778198242
Epoch: 12, Steps: 7 | Train Loss: 0.741 Vali Loss: 0.869 Vali Acc: 0.903 Test Loss: 0.869 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902769).  Saving model ...
Epoch: 13 cost time: 0.657249927520752
Epoch: 13, Steps: 7 | Train Loss: 0.563 Vali Loss: 0.727 Vali Acc: 0.931 Test Loss: 0.727 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930548).  Saving model ...
Epoch: 14 cost time: 0.6271481513977051
Epoch: 14, Steps: 7 | Train Loss: 0.419 Vali Loss: 0.617 Vali Acc: 0.931 Test Loss: 0.617 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930549).  Saving model ...
Epoch: 15 cost time: 0.6042282581329346
Epoch: 15, Steps: 7 | Train Loss: 0.321 Vali Loss: 0.539 Vali Acc: 0.931 Test Loss: 0.539 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930550).  Saving model ...
Epoch: 16 cost time: 0.5938432216644287
Epoch: 16, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.485 Vali Acc: 0.931 Test Loss: 0.485 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 17 cost time: 0.6384913921356201
Epoch: 17, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.440 Vali Acc: 0.931 Test Loss: 0.440 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 18 cost time: 0.5627987384796143
Epoch: 18, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.403 Vali Acc: 0.931 Test Loss: 0.403 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 0.6679189205169678
Epoch: 19, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.376 Vali Acc: 0.931 Test Loss: 0.376 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 0.5605034828186035
Epoch: 20, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.355 Vali Acc: 0.944 Test Loss: 0.355 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.6767861843109131
Epoch: 21, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.339 Vali Acc: 0.931 Test Loss: 0.339 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5867660045623779
Epoch: 22, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5152530670166016
Epoch: 23, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5861191749572754
Epoch: 24, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5787889957427979
Epoch: 25, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5973062515258789
Epoch: 26, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7036232948303223
Epoch: 27, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5786731243133545
Epoch: 28, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5585849285125732
Epoch: 29, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5783710479736328
Epoch: 30, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 327084
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8049306869506836
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.460 Vali Acc: 0.125 Test Loss: 2.460 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.5719952583312988
Epoch: 2, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.417 Vali Acc: 0.153 Test Loss: 2.417 Test Acc: 0.153
Validation loss decreased (-0.124975 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.5411496162414551
Epoch: 3, Steps: 7 | Train Loss: 2.357 Vali Loss: 2.340 Vali Acc: 0.278 Test Loss: 2.340 Test Acc: 0.278
Validation loss decreased (-0.152754 --> -0.277754).  Saving model ...
Epoch: 4 cost time: 0.6215000152587891
Epoch: 4, Steps: 7 | Train Loss: 2.235 Vali Loss: 2.234 Vali Acc: 0.514 Test Loss: 2.234 Test Acc: 0.514
Validation loss decreased (-0.277754 --> -0.513867).  Saving model ...
Epoch: 5 cost time: 0.5611305236816406
Epoch: 5, Steps: 7 | Train Loss: 2.097 Vali Loss: 2.095 Vali Acc: 0.653 Test Loss: 2.095 Test Acc: 0.653
Validation loss decreased (-0.513867 --> -0.652757).  Saving model ...
Epoch: 6 cost time: 0.5467450618743896
Epoch: 6, Steps: 7 | Train Loss: 1.951 Vali Loss: 1.936 Vali Acc: 0.722 Test Loss: 1.936 Test Acc: 0.722
Validation loss decreased (-0.652757 --> -0.722203).  Saving model ...
Epoch: 7 cost time: 0.5769233703613281
Epoch: 7, Steps: 7 | Train Loss: 1.753 Vali Loss: 1.759 Vali Acc: 0.736 Test Loss: 1.759 Test Acc: 0.736
Validation loss decreased (-0.722203 --> -0.736094).  Saving model ...
Epoch: 8 cost time: 0.5719711780548096
Epoch: 8, Steps: 7 | Train Loss: 1.577 Vali Loss: 1.572 Vali Acc: 0.736 Test Loss: 1.572 Test Acc: 0.736
Validation loss decreased (-0.736094 --> -0.736095).  Saving model ...
Epoch: 9 cost time: 0.5669186115264893
Epoch: 9, Steps: 7 | Train Loss: 1.363 Vali Loss: 1.387 Vali Acc: 0.819 Test Loss: 1.387 Test Acc: 0.819
Validation loss decreased (-0.736095 --> -0.819431).  Saving model ...
Epoch: 10 cost time: 0.5704469680786133
Epoch: 10, Steps: 7 | Train Loss: 1.153 Vali Loss: 1.196 Vali Acc: 0.861 Test Loss: 1.196 Test Acc: 0.861
Validation loss decreased (-0.819431 --> -0.861099).  Saving model ...
Epoch: 11 cost time: 0.5956146717071533
Epoch: 11, Steps: 7 | Train Loss: 0.962 Vali Loss: 1.028 Vali Acc: 0.847 Test Loss: 1.028 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5758273601531982
Epoch: 12, Steps: 7 | Train Loss: 0.771 Vali Loss: 0.878 Vali Acc: 0.875 Test Loss: 0.878 Test Acc: 0.875
Validation loss decreased (-0.861099 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.5854451656341553
Epoch: 13, Steps: 7 | Train Loss: 0.612 Vali Loss: 0.754 Vali Acc: 0.861 Test Loss: 0.754 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6666259765625
Epoch: 14, Steps: 7 | Train Loss: 0.474 Vali Loss: 0.658 Vali Acc: 0.889 Test Loss: 0.658 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 0.5578272342681885
Epoch: 15, Steps: 7 | Train Loss: 0.366 Vali Loss: 0.581 Vali Acc: 0.903 Test Loss: 0.581 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902772).  Saving model ...
Epoch: 16 cost time: 0.5225274562835693
Epoch: 16, Steps: 7 | Train Loss: 0.295 Vali Loss: 0.520 Vali Acc: 0.903 Test Loss: 0.520 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 17 cost time: 0.535632848739624
Epoch: 17, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.480 Vali Acc: 0.903 Test Loss: 0.480 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 18 cost time: 0.530097484588623
Epoch: 18, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.449 Vali Acc: 0.917 Test Loss: 0.449 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 0.586406946182251
Epoch: 19, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.428 Vali Acc: 0.903 Test Loss: 0.428 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5977840423583984
Epoch: 20, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.408 Vali Acc: 0.917 Test Loss: 0.408 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.5869057178497314
Epoch: 21, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.4864211082458496
Epoch: 22, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.374 Vali Acc: 0.931 Test Loss: 0.374 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.5409796237945557
Epoch: 23, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.5540106296539307
Epoch: 24, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.5633218288421631
Epoch: 25, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.5808634757995605
Epoch: 26, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.335 Vali Acc: 0.931 Test Loss: 0.335 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.4783616065979004
Epoch: 27, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.5478918552398682
Epoch: 28, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 29 cost time: 0.5051352977752686
Epoch: 29, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.5319056510925293
Epoch: 30, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5247251987457275
Epoch: 31, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.55861496925354
Epoch: 32, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5103867053985596
Epoch: 33, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.517235517501831
Epoch: 34, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5397696495056152
Epoch: 35, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6503150463104248
Epoch: 36, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5156669616699219
Epoch: 37, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6077284812927246
Epoch: 38, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5164890289306641
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5939416885375977
Epoch: 40, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5414869785308838
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5776312351226807
Epoch: 42, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.5209829807281494
Epoch: 43, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.536095142364502
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5916986465454102
Epoch: 45, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5441164970397949
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6286129951477051
Epoch: 47, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5083417892456055
Epoch: 48, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5343785285949707
Epoch: 49, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5849668979644775
Epoch: 50, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 324396
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2317068576812744
Epoch: 1, Steps: 7 | Train Loss: 2.468 Vali Loss: 2.317 Vali Acc: 0.417 Test Loss: 2.317 Test Acc: 0.417
Validation loss decreased (inf --> -0.416643).  Saving model ...
Epoch: 2 cost time: 1.0563178062438965
Epoch: 2, Steps: 7 | Train Loss: 1.735 Vali Loss: 1.564 Vali Acc: 0.903 Test Loss: 1.564 Test Acc: 0.903
Validation loss decreased (-0.416643 --> -0.902762).  Saving model ...
Epoch: 3 cost time: 0.987022876739502
Epoch: 3, Steps: 7 | Train Loss: 0.633 Vali Loss: 0.699 Vali Acc: 0.889 Test Loss: 0.699 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.001821756362915
Epoch: 4, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
Validation loss decreased (-0.902762 --> -0.944441).  Saving model ...
Epoch: 5 cost time: 1.3193995952606201
Epoch: 5, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 1.238145351409912
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 1.177821397781372
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 0.9460701942443848
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 1.2167260646820068
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.9876711368560791
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 1.1787035465240479
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.9474787712097168
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 1.1053557395935059
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.9286291599273682
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.8719236850738525
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.8881692886352539
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.9755117893218994
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.8196859359741211
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.1015641689300537
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.1189048290252686
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.9311771392822266
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.8595473766326904
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.9603800773620605
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 1.1081926822662354
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 1.0933163166046143
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.9705855846405029
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.9875154495239258
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 1.117739200592041
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.956878662109375
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 1.0674021244049072
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 1.045029878616333
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.1481990814208984
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 1.1473753452301025
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.168074369430542
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 1.1372888088226318
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 1.0744833946228027
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 1.2296783924102783
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 1.2203288078308105
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 1.3645691871643066
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 1.131897211074829
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 1.1584446430206299
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 1.064218521118164
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 1.069732904434204
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 1.049344539642334
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.9027166366577148
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.90262770652771
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.8951771259307861
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 1.1159231662750244
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.997889518737793
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.9618630409240723
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4915596
model size : 18.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.162365436553955
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.406 Vali Acc: 0.208 Test Loss: 2.406 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.958160400390625
Epoch: 2, Steps: 7 | Train Loss: 2.044 Vali Loss: 1.918 Vali Acc: 0.736 Test Loss: 1.918 Test Acc: 0.736
Validation loss decreased (-0.208309 --> -0.736092).  Saving model ...
Epoch: 3 cost time: 0.7838025093078613
Epoch: 3, Steps: 7 | Train Loss: 1.203 Vali Loss: 1.224 Vali Acc: 0.889 Test Loss: 1.224 Test Acc: 0.889
Validation loss decreased (-0.736092 --> -0.888877).  Saving model ...
Epoch: 4 cost time: 0.87322998046875
Epoch: 4, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
Validation loss decreased (-0.888877 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 0.93471360206604
Epoch: 5, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.902771 --> -0.944441).  Saving model ...
Epoch: 6 cost time: 0.7581872940063477
Epoch: 6, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.048478364944458
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7986965179443359
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8092679977416992
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8192341327667236
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9631295204162598
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.8860573768615723
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7415080070495605
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6830222606658936
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7608110904693604
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.8623788356781006
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7600851058959961
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6838054656982422
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7954070568084717
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7883739471435547
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.9018495082855225
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.8433356285095215
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.825984001159668
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.9915993213653564
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.9079535007476807
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9447681903839111
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.7963724136352539
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8111345767974854
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.9128901958465576
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.8956763744354248
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.0121538639068604
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7752187252044678
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7491195201873779
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.745579719543457
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8361752033233643
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7551453113555908
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.7637691497802734
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.96868896484375
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.906923770904541
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.9034645557403564
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.9208569526672363
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.940361499786377
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8135714530944824
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9325950145721436
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8486089706420898
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8192799091339111
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8140869140625
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.8518829345703125
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.8823614120483398
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6655333042144775
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4550796
model size : 17.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.007657527923584
Epoch: 1, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.465 Vali Acc: 0.056 Test Loss: 2.465 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.7719526290893555
Epoch: 2, Steps: 7 | Train Loss: 2.163 Vali Loss: 2.105 Vali Acc: 0.694 Test Loss: 2.105 Test Acc: 0.694
Validation loss decreased (-0.055531 --> -0.694423).  Saving model ...
Epoch: 3 cost time: 0.6513919830322266
Epoch: 3, Steps: 7 | Train Loss: 1.542 Vali Loss: 1.555 Vali Acc: 0.750 Test Loss: 1.555 Test Acc: 0.750
Validation loss decreased (-0.694423 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 0.7614459991455078
Epoch: 4, Steps: 7 | Train Loss: 0.860 Vali Loss: 0.974 Vali Acc: 0.861 Test Loss: 0.974 Test Acc: 0.861
Validation loss decreased (-0.749984 --> -0.861101).  Saving model ...
Epoch: 5 cost time: 0.9643027782440186
Epoch: 5, Steps: 7 | Train Loss: 0.347 Vali Loss: 0.532 Vali Acc: 0.903 Test Loss: 0.532 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 0.7045192718505859
Epoch: 6, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.8205504417419434
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.8880929946899414
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8122396469116211
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8042089939117432
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8654906749725342
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8265852928161621
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.945166826248169
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.810309886932373
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9134197235107422
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7856733798980713
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.9370052814483643
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.7699971199035645
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.7965550422668457
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.6916618347167969
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6784095764160156
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.8822669982910156
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6874635219573975
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.7034873962402344
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7877368927001953
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8800938129425049
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.047018051147461
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7929277420043945
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8748598098754883
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8165969848632812
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9821624755859375
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.881948709487915
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9614498615264893
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 4425612
model size : 16.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8399531841278076
Epoch: 1, Steps: 7 | Train Loss: 2.463 Vali Loss: 2.446 Vali Acc: 0.181 Test Loss: 2.446 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.8472471237182617
Epoch: 2, Steps: 7 | Train Loss: 2.215 Vali Loss: 2.177 Vali Acc: 0.597 Test Loss: 2.177 Test Acc: 0.597
Validation loss decreased (-0.180531 --> -0.597200).  Saving model ...
Epoch: 3 cost time: 0.769296407699585
Epoch: 3, Steps: 7 | Train Loss: 1.717 Vali Loss: 1.763 Vali Acc: 0.778 Test Loss: 1.763 Test Acc: 0.778
Validation loss decreased (-0.597200 --> -0.777760).  Saving model ...
Epoch: 4 cost time: 0.8103795051574707
Epoch: 4, Steps: 7 | Train Loss: 1.144 Vali Loss: 1.249 Vali Acc: 0.861 Test Loss: 1.249 Test Acc: 0.861
Validation loss decreased (-0.777760 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 0.7271537780761719
Epoch: 5, Steps: 7 | Train Loss: 0.608 Vali Loss: 0.764 Vali Acc: 0.903 Test Loss: 0.764 Test Acc: 0.903
Validation loss decreased (-0.861099 --> -0.902770).  Saving model ...
Epoch: 6 cost time: 0.6876363754272461
Epoch: 6, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 0.7549192905426025
Epoch: 7, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.79274582862854
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.8128397464752197
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.8442802429199219
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.6340372562408447
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.852250337600708
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7948074340820312
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7516605854034424
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.9184401035308838
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.9406352043151855
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8214797973632812
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7107734680175781
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7019670009613037
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8112607002258301
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7964766025543213
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6611146926879883
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8314588069915771
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7480576038360596
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7485718727111816
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.8821325302124023
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.7812163829803467
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8561925888061523
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7532453536987305
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7879962921142578
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7480387687683105
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9399373531341553
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.8841087818145752
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.8559646606445312
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9023239612579346
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8491933345794678
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.007612943649292
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9794926643371582
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.914982795715332
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.88055419921875
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.7701520919799805
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6947286128997803
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8745744228363037
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8133354187011719
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7258822917938232
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7648365497589111
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9636580944061279
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.8737673759460449
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.9130074977874756
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.952185869216919
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4374156
model size : 16.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.923835039138794
Epoch: 1, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.416 Vali Acc: 0.181 Test Loss: 2.416 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.7357063293457031
Epoch: 2, Steps: 7 | Train Loss: 2.242 Vali Loss: 2.207 Vali Acc: 0.597 Test Loss: 2.207 Test Acc: 0.597
Validation loss decreased (-0.180531 --> -0.597200).  Saving model ...
Epoch: 3 cost time: 0.73598313331604
Epoch: 3, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.850 Vali Acc: 0.792 Test Loss: 1.850 Test Acc: 0.792
Validation loss decreased (-0.597200 --> -0.791648).  Saving model ...
Epoch: 4 cost time: 0.632880687713623
Epoch: 4, Steps: 7 | Train Loss: 1.360 Vali Loss: 1.414 Vali Acc: 0.875 Test Loss: 1.414 Test Acc: 0.875
Validation loss decreased (-0.791648 --> -0.874986).  Saving model ...
Epoch: 5 cost time: 0.7232799530029297
Epoch: 5, Steps: 7 | Train Loss: 0.856 Vali Loss: 0.951 Vali Acc: 0.889 Test Loss: 0.951 Test Acc: 0.889
Validation loss decreased (-0.874986 --> -0.888879).  Saving model ...
Epoch: 6 cost time: 0.9439337253570557
Epoch: 6, Steps: 7 | Train Loss: 0.433 Vali Loss: 0.605 Vali Acc: 0.917 Test Loss: 0.605 Test Acc: 0.917
Validation loss decreased (-0.888879 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 0.8683605194091797
Epoch: 7, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.397 Vali Acc: 0.972 Test Loss: 0.397 Test Acc: 0.972
Validation loss decreased (-0.916661 --> -0.972218).  Saving model ...
Epoch: 8 cost time: 0.6366274356842041
Epoch: 8, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7311789989471436
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7187459468841553
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6165437698364258
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6753582954406738
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
Validation loss decreased (-0.972218 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.793614387512207
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 0.7507612705230713
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.972 Test Loss: 0.209 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 0.7316598892211914
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 0.820852518081665
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.7733485698699951
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.8574166297912598
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7897379398345947
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.6372323036193848
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.6776227951049805
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.6944658756256104
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.79866623878479
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.7896277904510498
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9092833995819092
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6470608711242676
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8023412227630615
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7176849842071533
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8026814460754395
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.766880989074707
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7841410636901855
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6918346881866455
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.665916919708252
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 4326540
model size : 16.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.085718870162964
Epoch: 1, Steps: 7 | Train Loss: 2.483 Vali Loss: 2.417 Vali Acc: 0.181 Test Loss: 2.417 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.8962736129760742
Epoch: 2, Steps: 7 | Train Loss: 2.299 Vali Loss: 2.233 Vali Acc: 0.472 Test Loss: 2.233 Test Acc: 0.472
Validation loss decreased (-0.180531 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 0.8829913139343262
Epoch: 3, Steps: 7 | Train Loss: 1.951 Vali Loss: 1.928 Vali Acc: 0.708 Test Loss: 1.928 Test Acc: 0.708
Validation loss decreased (-0.472200 --> -0.708314).  Saving model ...
Epoch: 4 cost time: 0.7531132698059082
Epoch: 4, Steps: 7 | Train Loss: 1.521 Vali Loss: 1.536 Vali Acc: 0.806 Test Loss: 1.536 Test Acc: 0.806
Validation loss decreased (-0.708314 --> -0.805540).  Saving model ...
Epoch: 5 cost time: 0.7678518295288086
Epoch: 5, Steps: 7 | Train Loss: 1.075 Vali Loss: 1.129 Vali Acc: 0.819 Test Loss: 1.129 Test Acc: 0.819
Validation loss decreased (-0.805540 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 0.7569475173950195
Epoch: 6, Steps: 7 | Train Loss: 0.664 Vali Loss: 0.789 Vali Acc: 0.861 Test Loss: 0.789 Test Acc: 0.861
Validation loss decreased (-0.819433 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.6523900032043457
Epoch: 7, Steps: 7 | Train Loss: 0.365 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.8881995677947998
Epoch: 8, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.428 Vali Acc: 0.903 Test Loss: 0.428 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.7430591583251953
Epoch: 9, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.903 Test Loss: 0.362 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.8207592964172363
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.683699369430542
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6546311378479004
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7171788215637207
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7639918327331543
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.8947041034698486
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.6141254901885986
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.8466193675994873
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7266330718994141
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.8223941326141357
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.8649158477783203
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8555171489715576
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.8346045017242432
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.761030912399292
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7859458923339844
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7680201530456543
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.9309837818145752
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.746394157409668
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8160343170166016
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7248249053955078
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.8171043395996094
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7687268257141113
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.8028969764709473
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7530307769775391
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.695070743560791
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.7107701301574707
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.7015359401702881
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.7812895774841309
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.846825122833252
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6273438930511475
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.7655248641967773
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7335965633392334
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7052664756774902
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7723245620727539
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.69331955909729
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.704535722732544
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7312562465667725
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.7664802074432373
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.7990436553955078
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.8337235450744629
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6405138969421387
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 4297356
model size : 16.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2755632400512695
Epoch: 1, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.378 Vali Acc: 0.264 Test Loss: 2.378 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.7997894287109375
Epoch: 2, Steps: 7 | Train Loss: 2.249 Vali Loss: 2.205 Vali Acc: 0.569 Test Loss: 2.205 Test Acc: 0.569
Validation loss decreased (-0.263865 --> -0.569422).  Saving model ...
Epoch: 3 cost time: 0.9206550121307373
Epoch: 3, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.940 Vali Acc: 0.708 Test Loss: 1.940 Test Acc: 0.708
Validation loss decreased (-0.569422 --> -0.708314).  Saving model ...
Epoch: 4 cost time: 0.827446699142456
Epoch: 4, Steps: 7 | Train Loss: 1.569 Vali Loss: 1.592 Vali Acc: 0.792 Test Loss: 1.592 Test Acc: 0.792
Validation loss decreased (-0.708314 --> -0.791651).  Saving model ...
Epoch: 5 cost time: 0.8074996471405029
Epoch: 5, Steps: 7 | Train Loss: 1.150 Vali Loss: 1.224 Vali Acc: 0.833 Test Loss: 1.224 Test Acc: 0.833
Validation loss decreased (-0.791651 --> -0.833321).  Saving model ...
Epoch: 6 cost time: 0.7568192481994629
Epoch: 6, Steps: 7 | Train Loss: 0.761 Vali Loss: 0.885 Vali Acc: 0.861 Test Loss: 0.885 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 0.8456940650939941
Epoch: 7, Steps: 7 | Train Loss: 0.441 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 0.7943811416625977
Epoch: 8, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8640811443328857
Epoch: 9, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 0.8258576393127441
Epoch: 10, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.425 Vali Acc: 0.903 Test Loss: 0.425 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.8486533164978027
Epoch: 11, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7543783187866211
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8689689636230469
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7812600135803223
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7616832256317139
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7695200443267822
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8295588493347168
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8252565860748291
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7688729763031006
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6034982204437256
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 4286604
model size : 16.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.998497724533081
Epoch: 1, Steps: 7 | Train Loss: 2.464 Vali Loss: 2.381 Vali Acc: 0.347 Test Loss: 2.381 Test Acc: 0.347
Validation loss decreased (inf --> -0.347198).  Saving model ...
Epoch: 2 cost time: 0.5747635364532471
Epoch: 2, Steps: 7 | Train Loss: 2.088 Vali Loss: 2.026 Vali Acc: 0.764 Test Loss: 2.026 Test Acc: 0.764
Validation loss decreased (-0.347198 --> -0.763869).  Saving model ...
Epoch: 3 cost time: 0.5787618160247803
Epoch: 3, Steps: 7 | Train Loss: 1.399 Vali Loss: 1.470 Vali Acc: 0.861 Test Loss: 1.470 Test Acc: 0.861
Validation loss decreased (-0.763869 --> -0.861096).  Saving model ...
Epoch: 4 cost time: 0.6716485023498535
Epoch: 4, Steps: 7 | Train Loss: 0.687 Vali Loss: 0.864 Vali Acc: 0.903 Test Loss: 0.864 Test Acc: 0.903
Validation loss decreased (-0.861096 --> -0.902769).  Saving model ...
Epoch: 5 cost time: 0.6916029453277588
Epoch: 5, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.452 Vali Acc: 0.931 Test Loss: 0.452 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 0.6116921901702881
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 0.6183819770812988
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.588951587677002
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.5860953330993652
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.708355188369751
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.602548360824585
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7684640884399414
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7976963520050049
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.8169519901275635
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.729259729385376
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6492388248443604
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6979420185089111
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.633307933807373
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6759076118469238
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6687908172607422
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7108352184295654
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7440371513366699
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.692051887512207
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7174229621887207
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7020785808563232
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7649927139282227
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.6891701221466064
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.6985809803009033
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6614408493041992
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.7202785015106201
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.5560615062713623
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.7371225357055664
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8118636608123779
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.738490104675293
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.5989184379577637
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.6717960834503174
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.6866559982299805
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.7891998291015625
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.8378036022186279
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.5984950065612793
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.704139232635498
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6636803150177002
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.7326805591583252
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.805518388748169
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.7555887699127197
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.8144769668579102
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7485959529876709
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6569530963897705
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7824032306671143
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.763207197189331
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1458380
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8402588367462158
Epoch: 1, Steps: 7 | Train Loss: 2.522 Vali Loss: 2.441 Vali Acc: 0.181 Test Loss: 2.441 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.7029621601104736
Epoch: 2, Steps: 7 | Train Loss: 2.282 Vali Loss: 2.176 Vali Acc: 0.597 Test Loss: 2.176 Test Acc: 0.597
Validation loss decreased (-0.180531 --> -0.597200).  Saving model ...
Epoch: 3 cost time: 0.6445908546447754
Epoch: 3, Steps: 7 | Train Loss: 1.785 Vali Loss: 1.764 Vali Acc: 0.778 Test Loss: 1.764 Test Acc: 0.778
Validation loss decreased (-0.597200 --> -0.777760).  Saving model ...
Epoch: 4 cost time: 0.6555733680725098
Epoch: 4, Steps: 7 | Train Loss: 1.204 Vali Loss: 1.257 Vali Acc: 0.875 Test Loss: 1.257 Test Acc: 0.875
Validation loss decreased (-0.777760 --> -0.874987).  Saving model ...
Epoch: 5 cost time: 0.7129440307617188
Epoch: 5, Steps: 7 | Train Loss: 0.668 Vali Loss: 0.802 Vali Acc: 0.931 Test Loss: 0.802 Test Acc: 0.931
Validation loss decreased (-0.874987 --> -0.930548).  Saving model ...
Epoch: 6 cost time: 0.6926374435424805
Epoch: 6, Steps: 7 | Train Loss: 0.295 Vali Loss: 0.488 Vali Acc: 0.917 Test Loss: 0.488 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6995477676391602
Epoch: 7, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6966290473937988
Epoch: 8, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6217913627624512
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5742778778076172
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5554192066192627
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6490130424499512
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.7205967903137207
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.567535400390625
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5492405891418457
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.7159795761108398
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6678383350372314
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6365230083465576
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6757783889770508
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5899984836578369
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6128454208374023
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5843477249145508
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6341414451599121
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6364777088165283
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6765813827514648
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5854618549346924
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5690369606018066
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5989658832550049
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7160854339599609
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6347460746765137
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7060689926147461
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5578906536102295
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6439340114593506
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5535612106323242
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.7048091888427734
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6010861396789551
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6674516201019287
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5634059906005859
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6970639228820801
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6332225799560547
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6222367286682129
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6953451633453369
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6145193576812744
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6271677017211914
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.6458449363708496
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.5883302688598633
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5464844703674316
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5658936500549316
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.6316909790039062
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6054539680480957
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1275980
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8370258808135986
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.431 Vali Acc: 0.139 Test Loss: 2.431 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.5579826831817627
Epoch: 2, Steps: 7 | Train Loss: 2.348 Vali Loss: 2.274 Vali Acc: 0.528 Test Loss: 2.274 Test Acc: 0.528
Validation loss decreased (-0.138865 --> -0.527755).  Saving model ...
Epoch: 3 cost time: 0.682546854019165
Epoch: 3, Steps: 7 | Train Loss: 2.049 Vali Loss: 2.014 Vali Acc: 0.764 Test Loss: 2.014 Test Acc: 0.764
Validation loss decreased (-0.527755 --> -0.763869).  Saving model ...
Epoch: 4 cost time: 0.5530002117156982
Epoch: 4, Steps: 7 | Train Loss: 1.635 Vali Loss: 1.649 Vali Acc: 0.847 Test Loss: 1.649 Test Acc: 0.847
Validation loss decreased (-0.763869 --> -0.847206).  Saving model ...
Epoch: 5 cost time: 0.5489034652709961
Epoch: 5, Steps: 7 | Train Loss: 1.179 Vali Loss: 1.225 Vali Acc: 0.903 Test Loss: 1.225 Test Acc: 0.903
Validation loss decreased (-0.847206 --> -0.902766).  Saving model ...
Epoch: 6 cost time: 0.5270709991455078
Epoch: 6, Steps: 7 | Train Loss: 0.745 Vali Loss: 0.835 Vali Acc: 0.903 Test Loss: 0.835 Test Acc: 0.903
Validation loss decreased (-0.902766 --> -0.902769).  Saving model ...
Epoch: 7 cost time: 0.5975246429443359
Epoch: 7, Steps: 7 | Train Loss: 0.391 Vali Loss: 0.528 Vali Acc: 0.931 Test Loss: 0.528 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.6164588928222656
Epoch: 8, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.402 Vali Acc: 0.903 Test Loss: 0.402 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6214807033538818
Epoch: 9, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.6216015815734863
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.6190595626831055
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6611523628234863
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.6472346782684326
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7151873111724854
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6825902462005615
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.7096915245056152
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6705799102783203
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6553542613983154
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5948059558868408
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6084098815917969
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.7188253402709961
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.6500933170318604
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6771869659423828
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6478161811828613
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7333559989929199
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.7578930854797363
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6227066516876221
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5932190418243408
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6655740737915039
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.5539252758026123
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6357011795043945
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7320384979248047
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6205084323883057
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.7658424377441406
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.6737399101257324
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.7823946475982666
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.7460463047027588
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.7303674221038818
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5938572883605957
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7158730030059814
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.7009477615356445
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7858548164367676
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.6969866752624512
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.6229181289672852
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.7363893985748291
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8040995597839355
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.7083656787872314
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.6513056755065918
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7407197952270508
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.7635753154754639
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1213388
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0319550037384033
Epoch: 1, Steps: 7 | Train Loss: 2.426 Vali Loss: 2.429 Vali Acc: 0.153 Test Loss: 2.429 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.5691545009613037
Epoch: 2, Steps: 7 | Train Loss: 2.310 Vali Loss: 2.272 Vali Acc: 0.444 Test Loss: 2.272 Test Acc: 0.444
Validation loss decreased (-0.152753 --> -0.444422).  Saving model ...
Epoch: 3 cost time: 0.5637993812561035
Epoch: 3, Steps: 7 | Train Loss: 2.027 Vali Loss: 2.019 Vali Acc: 0.694 Test Loss: 2.019 Test Acc: 0.694
Validation loss decreased (-0.444422 --> -0.694424).  Saving model ...
Epoch: 4 cost time: 0.6203160285949707
Epoch: 4, Steps: 7 | Train Loss: 1.660 Vali Loss: 1.685 Vali Acc: 0.847 Test Loss: 1.685 Test Acc: 0.847
Validation loss decreased (-0.694424 --> -0.847205).  Saving model ...
Epoch: 5 cost time: 0.5791351795196533
Epoch: 5, Steps: 7 | Train Loss: 1.266 Vali Loss: 1.300 Vali Acc: 0.875 Test Loss: 1.300 Test Acc: 0.875
Validation loss decreased (-0.847205 --> -0.874987).  Saving model ...
Epoch: 6 cost time: 0.6819376945495605
Epoch: 6, Steps: 7 | Train Loss: 0.863 Vali Loss: 0.919 Vali Acc: 0.903 Test Loss: 0.919 Test Acc: 0.903
Validation loss decreased (-0.874987 --> -0.902769).  Saving model ...
Epoch: 7 cost time: 0.6933138370513916
Epoch: 7, Steps: 7 | Train Loss: 0.499 Vali Loss: 0.639 Vali Acc: 0.903 Test Loss: 0.639 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 0.6221318244934082
Epoch: 8, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.471 Vali Acc: 0.931 Test Loss: 0.471 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 0.5903286933898926
Epoch: 9, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.6072754859924316
Epoch: 10, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.314 Vali Acc: 0.958 Test Loss: 0.314 Test Acc: 0.958
Validation loss decreased (-0.930552 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.4992368221282959
Epoch: 11, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.283 Vali Acc: 0.958 Test Loss: 0.283 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.6286728382110596
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.271 Vali Acc: 0.958 Test Loss: 0.271 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.5473501682281494
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.6144685745239258
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.6006429195404053
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.5472180843353271
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5361921787261963
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.6118776798248291
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.6578993797302246
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.5985469818115234
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6443557739257812
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.6980664730072021
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.5588598251342773
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.5981833934783936
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.5816617012023926
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.678654670715332
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6067743301391602
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6760246753692627
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.6219758987426758
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5534062385559082
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.6310205459594727
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6358604431152344
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7189457416534424
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.6660547256469727
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.5942447185516357
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.537449836730957
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.6594338417053223
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.6104531288146973
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.644406795501709
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.6394453048706055
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.6419863700866699
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.6283760070800781
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.5460076332092285
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.6388795375823975
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.6474502086639404
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.689476728439331
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5960054397583008
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.672250509262085
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7101600170135498
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.6935129165649414
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1187660
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9489355087280273
Epoch: 1, Steps: 7 | Train Loss: 2.409 Vali Loss: 2.390 Vali Acc: 0.264 Test Loss: 2.390 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.6406102180480957
Epoch: 2, Steps: 7 | Train Loss: 2.284 Vali Loss: 2.267 Vali Acc: 0.403 Test Loss: 2.267 Test Acc: 0.403
Validation loss decreased (-0.263865 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.620690107345581
Epoch: 3, Steps: 7 | Train Loss: 2.088 Vali Loss: 2.071 Vali Acc: 0.681 Test Loss: 2.071 Test Acc: 0.681
Validation loss decreased (-0.402755 --> -0.680535).  Saving model ...
Epoch: 4 cost time: 0.7055156230926514
Epoch: 4, Steps: 7 | Train Loss: 1.801 Vali Loss: 1.802 Vali Acc: 0.778 Test Loss: 1.802 Test Acc: 0.778
Validation loss decreased (-0.680535 --> -0.777760).  Saving model ...
Epoch: 5 cost time: 0.6169953346252441
Epoch: 5, Steps: 7 | Train Loss: 1.462 Vali Loss: 1.495 Vali Acc: 0.833 Test Loss: 1.495 Test Acc: 0.833
Validation loss decreased (-0.777760 --> -0.833318).  Saving model ...
Epoch: 6 cost time: 0.5232017040252686
Epoch: 6, Steps: 7 | Train Loss: 1.121 Vali Loss: 1.162 Vali Acc: 0.903 Test Loss: 1.162 Test Acc: 0.903
Validation loss decreased (-0.833318 --> -0.902766).  Saving model ...
Epoch: 7 cost time: 0.6422157287597656
Epoch: 7, Steps: 7 | Train Loss: 0.760 Vali Loss: 0.845 Vali Acc: 0.903 Test Loss: 0.845 Test Acc: 0.903
Validation loss decreased (-0.902766 --> -0.902769).  Saving model ...
Epoch: 8 cost time: 0.6462268829345703
Epoch: 8, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6109673976898193
Epoch: 9, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.448 Vali Acc: 0.917 Test Loss: 0.448 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 0.5640060901641846
Epoch: 10, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.365 Vali Acc: 0.944 Test Loss: 0.365 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.5674583911895752
Epoch: 11, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.5424661636352539
Epoch: 12, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7604248523712158
Epoch: 13, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.555229902267456
Epoch: 14, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5904445648193359
Epoch: 15, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5787312984466553
Epoch: 16, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7095544338226318
Epoch: 17, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5940456390380859
Epoch: 18, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6443393230438232
Epoch: 19, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6562082767486572
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.669708251953125
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6069068908691406
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6768159866333008
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5792908668518066
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6278927326202393
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6261165142059326
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6382505893707275
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5686557292938232
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6676032543182373
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7030713558197021
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6446201801300049
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5680673122406006
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6436922550201416
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5987379550933838
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6160573959350586
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6082048416137695
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5628671646118164
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.542717456817627
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.56300950050354
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.617713451385498
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5614638328552246
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.7092132568359375
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.559190034866333
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5816714763641357
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.6009695529937744
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.5295000076293945
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.6302351951599121
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5578503608703613
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5579967498779297
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5791904926300049
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1163852
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8929808139801025
Epoch: 1, Steps: 7 | Train Loss: 2.453 Vali Loss: 2.412 Vali Acc: 0.167 Test Loss: 2.412 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.7161538600921631
Epoch: 2, Steps: 7 | Train Loss: 2.362 Vali Loss: 2.317 Vali Acc: 0.333 Test Loss: 2.317 Test Acc: 0.333
Validation loss decreased (-0.166643 --> -0.333310).  Saving model ...
Epoch: 3 cost time: 0.6092817783355713
Epoch: 3, Steps: 7 | Train Loss: 2.166 Vali Loss: 2.155 Vali Acc: 0.514 Test Loss: 2.155 Test Acc: 0.514
Validation loss decreased (-0.333310 --> -0.513867).  Saving model ...
Epoch: 4 cost time: 0.5936152935028076
Epoch: 4, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.941 Vali Acc: 0.681 Test Loss: 1.941 Test Acc: 0.681
Validation loss decreased (-0.513867 --> -0.680536).  Saving model ...
Epoch: 5 cost time: 0.6245160102844238
Epoch: 5, Steps: 7 | Train Loss: 1.671 Vali Loss: 1.679 Vali Acc: 0.847 Test Loss: 1.679 Test Acc: 0.847
Validation loss decreased (-0.680536 --> -0.847205).  Saving model ...
Epoch: 6 cost time: 0.6400246620178223
Epoch: 6, Steps: 7 | Train Loss: 1.382 Vali Loss: 1.389 Vali Acc: 0.847 Test Loss: 1.389 Test Acc: 0.847
Validation loss decreased (-0.847205 --> -0.847208).  Saving model ...
Epoch: 7 cost time: 0.7041563987731934
Epoch: 7, Steps: 7 | Train Loss: 1.048 Vali Loss: 1.091 Vali Acc: 0.861 Test Loss: 1.091 Test Acc: 0.861
Validation loss decreased (-0.847208 --> -0.861100).  Saving model ...
Epoch: 8 cost time: 0.582047700881958
Epoch: 8, Steps: 7 | Train Loss: 0.753 Vali Loss: 0.844 Vali Acc: 0.875 Test Loss: 0.844 Test Acc: 0.875
Validation loss decreased (-0.861100 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.6815354824066162
Epoch: 9, Steps: 7 | Train Loss: 0.485 Vali Loss: 0.648 Vali Acc: 0.847 Test Loss: 0.648 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6941449642181396
Epoch: 10, Steps: 7 | Train Loss: 0.308 Vali Loss: 0.496 Vali Acc: 0.903 Test Loss: 0.496 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902773).  Saving model ...
Epoch: 11 cost time: 0.6572566032409668
Epoch: 11, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.421 Vali Acc: 0.903 Test Loss: 0.421 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.6866257190704346
Epoch: 12, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.6472470760345459
Epoch: 13, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.6585264205932617
Epoch: 14, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.6653668880462646
Epoch: 15, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.6330902576446533
Epoch: 16, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.6233510971069336
Epoch: 17, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.7183380126953125
Epoch: 18, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.570171594619751
Epoch: 19, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7013111114501953
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.5747466087341309
Epoch: 21, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6223139762878418
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5746438503265381
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.6538219451904297
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6474564075469971
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6544625759124756
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6819348335266113
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.638700008392334
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.6048204898834229
Epoch: 29, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6889071464538574
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6388933658599854
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.7665235996246338
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.659379243850708
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6275155544281006
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.7024118900299072
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6398410797119141
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.682326078414917
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6210989952087402
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7546634674072266
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6254818439483643
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.6442222595214844
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.6271402835845947
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.5957334041595459
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.6745710372924805
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.6783897876739502
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.5878751277923584
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5287089347839355
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6618387699127197
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5168092250823975
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6603882312774658
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1149260
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9960718154907227
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.463 Vali Acc: 0.111 Test Loss: 2.463 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5937685966491699
Epoch: 2, Steps: 7 | Train Loss: 2.406 Vali Loss: 2.380 Vali Acc: 0.222 Test Loss: 2.380 Test Acc: 0.222
Validation loss decreased (-0.111086 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.6013846397399902
Epoch: 3, Steps: 7 | Train Loss: 2.249 Vali Loss: 2.242 Vali Acc: 0.472 Test Loss: 2.242 Test Acc: 0.472
Validation loss decreased (-0.222198 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 0.6095418930053711
Epoch: 4, Steps: 7 | Train Loss: 2.048 Vali Loss: 2.056 Vali Acc: 0.708 Test Loss: 2.056 Test Acc: 0.708
Validation loss decreased (-0.472200 --> -0.708313).  Saving model ...
Epoch: 5 cost time: 0.5815410614013672
Epoch: 5, Steps: 7 | Train Loss: 1.829 Vali Loss: 1.835 Vali Acc: 0.792 Test Loss: 1.835 Test Acc: 0.792
Validation loss decreased (-0.708313 --> -0.791648).  Saving model ...
Epoch: 6 cost time: 0.6455514430999756
Epoch: 6, Steps: 7 | Train Loss: 1.550 Vali Loss: 1.591 Vali Acc: 0.792 Test Loss: 1.591 Test Acc: 0.792
Validation loss decreased (-0.791648 --> -0.791651).  Saving model ...
Epoch: 7 cost time: 0.6179115772247314
Epoch: 7, Steps: 7 | Train Loss: 1.276 Vali Loss: 1.330 Vali Acc: 0.819 Test Loss: 1.330 Test Acc: 0.819
Validation loss decreased (-0.791651 --> -0.819431).  Saving model ...
Epoch: 8 cost time: 0.5161120891571045
Epoch: 8, Steps: 7 | Train Loss: 0.989 Vali Loss: 1.076 Vali Acc: 0.833 Test Loss: 1.076 Test Acc: 0.833
Validation loss decreased (-0.819431 --> -0.833323).  Saving model ...
Epoch: 9 cost time: 0.5799813270568848
Epoch: 9, Steps: 7 | Train Loss: 0.736 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 0.5982670783996582
Epoch: 10, Steps: 7 | Train Loss: 0.512 Vali Loss: 0.686 Vali Acc: 0.889 Test Loss: 0.686 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888882).  Saving model ...
Epoch: 11 cost time: 0.5965571403503418
Epoch: 11, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.569 Vali Acc: 0.889 Test Loss: 0.569 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 12 cost time: 0.6205062866210938
Epoch: 12, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.490 Vali Acc: 0.903 Test Loss: 0.490 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.5820910930633545
Epoch: 13, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.6386110782623291
Epoch: 14, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.6253342628479004
Epoch: 15, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.6744849681854248
Epoch: 16, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.6226012706756592
Epoch: 17, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6921460628509521
Epoch: 18, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6092381477355957
Epoch: 19, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.5808601379394531
Epoch: 20, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6545491218566895
Epoch: 21, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.530674934387207
Epoch: 22, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6886494159698486
Epoch: 23, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6170814037322998
Epoch: 24, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5225024223327637
Epoch: 25, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6298892498016357
Epoch: 26, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.5871877670288086
Epoch: 27, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.537830114364624
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.570671796798706
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5673637390136719
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6098053455352783
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.6974143981933594
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.5580921173095703
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6075360774993896
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.5614404678344727
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.5360414981842041
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5810813903808594
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5772545337677002
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6194605827331543
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5810909271240234
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5186691284179688
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.5616662502288818
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.5667123794555664
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.5236952304840088
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.5624716281890869
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.5788512229919434
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5860023498535156
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7248284816741943
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.654820442199707
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5627682209014893
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 1143884
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.900012731552124
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.438 Vali Acc: 0.181 Test Loss: 2.438 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.6384899616241455
Epoch: 2, Steps: 7 | Train Loss: 2.282 Vali Loss: 2.247 Vali Acc: 0.583 Test Loss: 2.247 Test Acc: 0.583
Validation loss decreased (-0.180531 --> -0.583311).  Saving model ...
Epoch: 3 cost time: 0.5638954639434814
Epoch: 3, Steps: 7 | Train Loss: 1.878 Vali Loss: 1.920 Vali Acc: 0.847 Test Loss: 1.920 Test Acc: 0.847
Validation loss decreased (-0.583311 --> -0.847203).  Saving model ...
Epoch: 4 cost time: 0.621525764465332
Epoch: 4, Steps: 7 | Train Loss: 1.390 Vali Loss: 1.499 Vali Acc: 0.889 Test Loss: 1.499 Test Acc: 0.889
Validation loss decreased (-0.847203 --> -0.888874).  Saving model ...
Epoch: 5 cost time: 0.6821291446685791
Epoch: 5, Steps: 7 | Train Loss: 0.884 Vali Loss: 1.040 Vali Acc: 0.944 Test Loss: 1.040 Test Acc: 0.944
Validation loss decreased (-0.888874 --> -0.944434).  Saving model ...
Epoch: 6 cost time: 0.560978889465332
Epoch: 6, Steps: 7 | Train Loss: 0.473 Vali Loss: 0.662 Vali Acc: 0.944 Test Loss: 0.662 Test Acc: 0.944
Validation loss decreased (-0.944434 --> -0.944438).  Saving model ...
Epoch: 7 cost time: 0.5315485000610352
Epoch: 7, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.430 Vali Acc: 0.944 Test Loss: 0.430 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 0.6418533325195312
Epoch: 8, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.5913455486297607
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6359424591064453
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.612769365310669
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6094284057617188
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5770578384399414
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6560173034667969
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6540412902832031
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6101791858673096
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6287021636962891
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6886215209960938
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6347756385803223
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6437928676605225
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 479340
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7235634326934814
Epoch: 1, Steps: 7 | Train Loss: 2.444 Vali Loss: 2.419 Vali Acc: 0.236 Test Loss: 2.419 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.49494409561157227
Epoch: 2, Steps: 7 | Train Loss: 2.313 Vali Loss: 2.306 Vali Acc: 0.444 Test Loss: 2.306 Test Acc: 0.444
Validation loss decreased (-0.236087 --> -0.444421).  Saving model ...
Epoch: 3 cost time: 0.5304145812988281
Epoch: 3, Steps: 7 | Train Loss: 2.100 Vali Loss: 2.114 Vali Acc: 0.653 Test Loss: 2.114 Test Acc: 0.653
Validation loss decreased (-0.444421 --> -0.652757).  Saving model ...
Epoch: 4 cost time: 0.5356223583221436
Epoch: 4, Steps: 7 | Train Loss: 1.783 Vali Loss: 1.851 Vali Acc: 0.806 Test Loss: 1.851 Test Acc: 0.806
Validation loss decreased (-0.652757 --> -0.805537).  Saving model ...
Epoch: 5 cost time: 0.4914541244506836
Epoch: 5, Steps: 7 | Train Loss: 1.448 Vali Loss: 1.522 Vali Acc: 0.792 Test Loss: 1.522 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5327954292297363
Epoch: 6, Steps: 7 | Train Loss: 1.054 Vali Loss: 1.172 Vali Acc: 0.833 Test Loss: 1.172 Test Acc: 0.833
Validation loss decreased (-0.805537 --> -0.833322).  Saving model ...
Epoch: 7 cost time: 0.48753905296325684
Epoch: 7, Steps: 7 | Train Loss: 0.695 Vali Loss: 0.855 Vali Acc: 0.875 Test Loss: 0.855 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 0.47136878967285156
Epoch: 8, Steps: 7 | Train Loss: 0.415 Vali Loss: 0.622 Vali Acc: 0.903 Test Loss: 0.622 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 0.5010459423065186
Epoch: 9, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.483 Vali Acc: 0.931 Test Loss: 0.483 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 0.5722107887268066
Epoch: 10, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.5103378295898438
Epoch: 11, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.335 Vali Acc: 0.944 Test Loss: 0.335 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.5491864681243896
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.4953634738922119
Epoch: 13, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.509965181350708
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.44916224479675293
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.4922518730163574
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5247089862823486
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5017776489257812
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5235416889190674
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.47249817848205566
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5092012882232666
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.4837825298309326
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.45708179473876953
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.48054075241088867
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5543704032897949
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6257226467132568
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5436482429504395
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5472986698150635
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6211545467376709
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5427312850952148
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5156848430633545
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5408861637115479
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.4975905418395996
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.4885823726654053
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5534572601318359
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6178145408630371
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5434882640838623
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5293138027191162
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5408105850219727
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.520517110824585
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6090662479400635
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5428266525268555
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.659562349319458
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4761519432067871
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5761549472808838
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.5765609741210938
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5034935474395752
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5409531593322754
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5955688953399658
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.5090415477752686
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 388140
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0244338512420654
Epoch: 1, Steps: 7 | Train Loss: 2.429 Vali Loss: 2.441 Vali Acc: 0.208 Test Loss: 2.441 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.5150556564331055
Epoch: 2, Steps: 7 | Train Loss: 2.351 Vali Loss: 2.349 Vali Acc: 0.250 Test Loss: 2.349 Test Acc: 0.250
Validation loss decreased (-0.208309 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 0.5348572731018066
Epoch: 3, Steps: 7 | Train Loss: 2.177 Vali Loss: 2.201 Vali Acc: 0.431 Test Loss: 2.201 Test Acc: 0.431
Validation loss decreased (-0.249977 --> -0.430534).  Saving model ...
Epoch: 4 cost time: 0.5848064422607422
Epoch: 4, Steps: 7 | Train Loss: 1.950 Vali Loss: 1.990 Vali Acc: 0.694 Test Loss: 1.990 Test Acc: 0.694
Validation loss decreased (-0.430534 --> -0.694425).  Saving model ...
Epoch: 5 cost time: 0.6092493534088135
Epoch: 5, Steps: 7 | Train Loss: 1.673 Vali Loss: 1.719 Vali Acc: 0.792 Test Loss: 1.719 Test Acc: 0.792
Validation loss decreased (-0.694425 --> -0.791649).  Saving model ...
Epoch: 6 cost time: 0.548715353012085
Epoch: 6, Steps: 7 | Train Loss: 1.358 Vali Loss: 1.426 Vali Acc: 0.833 Test Loss: 1.426 Test Acc: 0.833
Validation loss decreased (-0.791649 --> -0.833319).  Saving model ...
Epoch: 7 cost time: 0.5766313076019287
Epoch: 7, Steps: 7 | Train Loss: 1.045 Vali Loss: 1.117 Vali Acc: 0.917 Test Loss: 1.117 Test Acc: 0.917
Validation loss decreased (-0.833319 --> -0.916655).  Saving model ...
Epoch: 8 cost time: 0.510565996170044
Epoch: 8, Steps: 7 | Train Loss: 0.735 Vali Loss: 0.850 Vali Acc: 0.944 Test Loss: 0.850 Test Acc: 0.944
Validation loss decreased (-0.916655 --> -0.944436).  Saving model ...
Epoch: 9 cost time: 0.5164709091186523
Epoch: 9, Steps: 7 | Train Loss: 0.463 Vali Loss: 0.627 Vali Acc: 0.944 Test Loss: 0.627 Test Acc: 0.944
Validation loss decreased (-0.944436 --> -0.944438).  Saving model ...
Epoch: 10 cost time: 0.5166113376617432
Epoch: 10, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.485 Vali Acc: 0.944 Test Loss: 0.485 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944440).  Saving model ...
Epoch: 11 cost time: 0.5632064342498779
Epoch: 11, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.406 Vali Acc: 0.931 Test Loss: 0.406 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.549022912979126
Epoch: 12, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.354 Vali Acc: 0.931 Test Loss: 0.354 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4828977584838867
Epoch: 13, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.335 Vali Acc: 0.931 Test Loss: 0.335 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5296680927276611
Epoch: 14, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5406842231750488
Epoch: 15, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5788683891296387
Epoch: 16, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.49744510650634766
Epoch: 17, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5458400249481201
Epoch: 18, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5478823184967041
Epoch: 19, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6144578456878662
Epoch: 20, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 356844
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7969624996185303
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.482 Vali Acc: 0.125 Test Loss: 2.482 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.5362608432769775
Epoch: 2, Steps: 7 | Train Loss: 2.418 Vali Loss: 2.402 Vali Acc: 0.167 Test Loss: 2.402 Test Acc: 0.167
Validation loss decreased (-0.124975 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.5570740699768066
Epoch: 3, Steps: 7 | Train Loss: 2.289 Vali Loss: 2.270 Vali Acc: 0.347 Test Loss: 2.270 Test Acc: 0.347
Validation loss decreased (-0.166643 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.6562497615814209
Epoch: 4, Steps: 7 | Train Loss: 2.098 Vali Loss: 2.094 Vali Acc: 0.569 Test Loss: 2.094 Test Acc: 0.569
Validation loss decreased (-0.347200 --> -0.569424).  Saving model ...
Epoch: 5 cost time: 0.5942409038543701
Epoch: 5, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.877 Vali Acc: 0.764 Test Loss: 1.877 Test Acc: 0.764
Validation loss decreased (-0.569424 --> -0.763870).  Saving model ...
Epoch: 6 cost time: 0.6042747497558594
Epoch: 6, Steps: 7 | Train Loss: 1.593 Vali Loss: 1.623 Vali Acc: 0.764 Test Loss: 1.623 Test Acc: 0.764
Validation loss decreased (-0.763870 --> -0.763873).  Saving model ...
Epoch: 7 cost time: 0.5447540283203125
Epoch: 7, Steps: 7 | Train Loss: 1.304 Vali Loss: 1.346 Vali Acc: 0.750 Test Loss: 1.346 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5556731224060059
Epoch: 8, Steps: 7 | Train Loss: 1.003 Vali Loss: 1.096 Vali Acc: 0.833 Test Loss: 1.096 Test Acc: 0.833
Validation loss decreased (-0.763873 --> -0.833322).  Saving model ...
Epoch: 9 cost time: 0.5297729969024658
Epoch: 9, Steps: 7 | Train Loss: 0.736 Vali Loss: 0.872 Vali Acc: 0.861 Test Loss: 0.872 Test Acc: 0.861
Validation loss decreased (-0.833322 --> -0.861102).  Saving model ...
Epoch: 10 cost time: 0.5450611114501953
Epoch: 10, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.695 Vali Acc: 0.861 Test Loss: 0.695 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861104).  Saving model ...
Epoch: 11 cost time: 0.5597600936889648
Epoch: 11, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 12 cost time: 0.579383134841919
Epoch: 12, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.6117565631866455
Epoch: 13, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 0.5197970867156982
Epoch: 14, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.5127010345458984
Epoch: 15, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.6452467441558838
Epoch: 16, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 0.568073034286499
Epoch: 17, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 0.5878539085388184
Epoch: 18, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 0.5258421897888184
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.6726906299591064
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5968432426452637
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.5460994243621826
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5375845432281494
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5625441074371338
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.6053237915039062
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.6440036296844482
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5334467887878418
Epoch: 27, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.5252039432525635
Epoch: 28, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.5111541748046875
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.5378894805908203
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.6298828125
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6023273468017578
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5881240367889404
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.7220752239227295
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.6219308376312256
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.6190869808197021
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.5519344806671143
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.6520934104919434
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.5402138233184814
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.5593483448028564
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.5206928253173828
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.5390486717224121
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5624144077301025
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.574296236038208
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.5371015071868896
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.5588729381561279
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.5805537700653076
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.5567691326141357
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.5488808155059814
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5884604454040527
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 343980
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6269934177398682
Epoch: 1, Steps: 7 | Train Loss: 2.504 Vali Loss: 2.461 Vali Acc: 0.111 Test Loss: 2.461 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.49941086769104004
Epoch: 2, Steps: 7 | Train Loss: 2.435 Vali Loss: 2.408 Vali Acc: 0.250 Test Loss: 2.408 Test Acc: 0.250
Validation loss decreased (-0.111086 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.5186026096343994
Epoch: 3, Steps: 7 | Train Loss: 2.339 Vali Loss: 2.324 Vali Acc: 0.403 Test Loss: 2.324 Test Acc: 0.403
Validation loss decreased (-0.249976 --> -0.402755).  Saving model ...
Epoch: 4 cost time: 0.5752427577972412
Epoch: 4, Steps: 7 | Train Loss: 2.204 Vali Loss: 2.210 Vali Acc: 0.528 Test Loss: 2.210 Test Acc: 0.528
Validation loss decreased (-0.402755 --> -0.527756).  Saving model ...
Epoch: 5 cost time: 0.5440213680267334
Epoch: 5, Steps: 7 | Train Loss: 2.061 Vali Loss: 2.065 Vali Acc: 0.681 Test Loss: 2.065 Test Acc: 0.681
Validation loss decreased (-0.527756 --> -0.680535).  Saving model ...
Epoch: 6 cost time: 0.5896682739257812
Epoch: 6, Steps: 7 | Train Loss: 1.861 Vali Loss: 1.887 Vali Acc: 0.778 Test Loss: 1.887 Test Acc: 0.778
Validation loss decreased (-0.680535 --> -0.777759).  Saving model ...
Epoch: 7 cost time: 0.5587878227233887
Epoch: 7, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.674 Vali Acc: 0.861 Test Loss: 1.674 Test Acc: 0.861
Validation loss decreased (-0.777759 --> -0.861094).  Saving model ...
Epoch: 8 cost time: 0.5993742942810059
Epoch: 8, Steps: 7 | Train Loss: 1.412 Vali Loss: 1.436 Vali Acc: 0.889 Test Loss: 1.436 Test Acc: 0.889
Validation loss decreased (-0.861094 --> -0.888875).  Saving model ...
Epoch: 9 cost time: 0.6644830703735352
Epoch: 9, Steps: 7 | Train Loss: 1.156 Vali Loss: 1.196 Vali Acc: 0.889 Test Loss: 1.196 Test Acc: 0.889
Validation loss decreased (-0.888875 --> -0.888877).  Saving model ...
Epoch: 10 cost time: 0.6351718902587891
Epoch: 10, Steps: 7 | Train Loss: 0.890 Vali Loss: 0.977 Vali Acc: 0.875 Test Loss: 0.977 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5962135791778564
Epoch: 11, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.793 Vali Acc: 0.889 Test Loss: 0.793 Test Acc: 0.889
Validation loss decreased (-0.888877 --> -0.888881).  Saving model ...
Epoch: 12 cost time: 0.6019299030303955
Epoch: 12, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.646 Vali Acc: 0.889 Test Loss: 0.646 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 0.5379807949066162
Epoch: 13, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 14 cost time: 0.5195033550262451
Epoch: 14, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 15 cost time: 0.6164548397064209
Epoch: 15, Steps: 7 | Train Loss: 0.162 Vali Loss: 0.404 Vali Acc: 0.903 Test Loss: 0.404 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.6429080963134766
Epoch: 16, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.371 Vali Acc: 0.903 Test Loss: 0.371 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.5885577201843262
Epoch: 17, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.5472791194915771
Epoch: 18, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5661001205444336
Epoch: 19, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5465836524963379
Epoch: 20, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5659379959106445
Epoch: 21, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.632016658782959
Epoch: 22, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.502223014831543
Epoch: 23, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.48047709465026855
Epoch: 24, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5868620872497559
Epoch: 25, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6853814125061035
Epoch: 26, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5758702754974365
Epoch: 27, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.5842061042785645
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.4889094829559326
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6003289222717285
Epoch: 30, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.5723588466644287
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.5716385841369629
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6171107292175293
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.62278151512146
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.5790081024169922
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.659649133682251
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.600238561630249
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6541941165924072
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5866260528564453
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.6575038433074951
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6039481163024902
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.6071805953979492
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 0.596966028213501
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.673612117767334
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 0.5783731937408447
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 0.5342562198638916
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 0.5560348033905029
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 0.6084048748016357
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 0.5391273498535156
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5661661624908447
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 332076
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.053159236907959
Epoch: 1, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.441 Vali Acc: 0.222 Test Loss: 2.441 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.48639345169067383
Epoch: 2, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.390 Vali Acc: 0.264 Test Loss: 2.390 Test Acc: 0.264
Validation loss decreased (-0.222198 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 0.491363525390625
Epoch: 3, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.311 Vali Acc: 0.347 Test Loss: 2.311 Test Acc: 0.347
Validation loss decreased (-0.263865 --> -0.347199).  Saving model ...
Epoch: 4 cost time: 0.5093972682952881
Epoch: 4, Steps: 7 | Train Loss: 2.236 Vali Loss: 2.216 Vali Acc: 0.389 Test Loss: 2.216 Test Acc: 0.389
Validation loss decreased (-0.347199 --> -0.388867).  Saving model ...
Epoch: 5 cost time: 0.6045098304748535
Epoch: 5, Steps: 7 | Train Loss: 2.117 Vali Loss: 2.101 Vali Acc: 0.542 Test Loss: 2.101 Test Acc: 0.542
Validation loss decreased (-0.388867 --> -0.541646).  Saving model ...
Epoch: 6 cost time: 0.5021471977233887
Epoch: 6, Steps: 7 | Train Loss: 1.972 Vali Loss: 1.962 Vali Acc: 0.681 Test Loss: 1.962 Test Acc: 0.681
Validation loss decreased (-0.541646 --> -0.680536).  Saving model ...
Epoch: 7 cost time: 0.523406982421875
Epoch: 7, Steps: 7 | Train Loss: 1.785 Vali Loss: 1.798 Vali Acc: 0.750 Test Loss: 1.798 Test Acc: 0.750
Validation loss decreased (-0.680536 --> -0.749982).  Saving model ...
Epoch: 8 cost time: 0.5946469306945801
Epoch: 8, Steps: 7 | Train Loss: 1.620 Vali Loss: 1.624 Vali Acc: 0.778 Test Loss: 1.624 Test Acc: 0.778
Validation loss decreased (-0.749982 --> -0.777762).  Saving model ...
Epoch: 9 cost time: 0.5792808532714844
Epoch: 9, Steps: 7 | Train Loss: 1.391 Vali Loss: 1.433 Vali Acc: 0.792 Test Loss: 1.433 Test Acc: 0.792
Validation loss decreased (-0.777762 --> -0.791652).  Saving model ...
Epoch: 10 cost time: 0.6191341876983643
Epoch: 10, Steps: 7 | Train Loss: 1.186 Vali Loss: 1.244 Vali Acc: 0.875 Test Loss: 1.244 Test Acc: 0.875
Validation loss decreased (-0.791652 --> -0.874988).  Saving model ...
Epoch: 11 cost time: 0.5247175693511963
Epoch: 11, Steps: 7 | Train Loss: 0.971 Vali Loss: 1.070 Vali Acc: 0.889 Test Loss: 1.070 Test Acc: 0.889
Validation loss decreased (-0.874988 --> -0.888878).  Saving model ...
Epoch: 12 cost time: 0.4998030662536621
Epoch: 12, Steps: 7 | Train Loss: 0.774 Vali Loss: 0.902 Vali Acc: 0.889 Test Loss: 0.902 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888880).  Saving model ...
Epoch: 13 cost time: 0.5597090721130371
Epoch: 13, Steps: 7 | Train Loss: 0.601 Vali Loss: 0.761 Vali Acc: 0.889 Test Loss: 0.761 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 0.4828910827636719
Epoch: 14, Steps: 7 | Train Loss: 0.448 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902771).  Saving model ...
Epoch: 15 cost time: 0.5135705471038818
Epoch: 15, Steps: 7 | Train Loss: 0.344 Vali Loss: 0.569 Vali Acc: 0.917 Test Loss: 0.569 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 16 cost time: 0.5406837463378906
Epoch: 16, Steps: 7 | Train Loss: 0.258 Vali Loss: 0.511 Vali Acc: 0.917 Test Loss: 0.511 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 0.5588600635528564
Epoch: 17, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.475 Vali Acc: 0.903 Test Loss: 0.475 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5270230770111084
Epoch: 18, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.449 Vali Acc: 0.903 Test Loss: 0.449 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5289416313171387
Epoch: 19, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.417 Vali Acc: 0.903 Test Loss: 0.417 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6176891326904297
Epoch: 20, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4772958755493164
Epoch: 21, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.371 Vali Acc: 0.931 Test Loss: 0.371 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 22 cost time: 0.6193084716796875
Epoch: 22, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.355 Vali Acc: 0.931 Test Loss: 0.355 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.5439305305480957
Epoch: 23, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.5090961456298828
Epoch: 24, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.5331072807312012
Epoch: 25, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.49582338333129883
Epoch: 26, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.46389293670654297
Epoch: 27, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.48743724822998047
Epoch: 28, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5713884830474854
Epoch: 29, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.5413217544555664
Epoch: 30, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.457974910736084
Epoch: 31, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5588395595550537
Epoch: 32, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.513390302658081
Epoch: 33, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.49855685234069824
Epoch: 34, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.558704137802124
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.5262205600738525
Epoch: 36, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.5248322486877441
Epoch: 37, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5164523124694824
Epoch: 38, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.4907217025756836
Epoch: 39, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.5211470127105713
Epoch: 40, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6731510162353516
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5638141632080078
Epoch: 42, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.5549485683441162
Epoch: 43, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.5398273468017578
Epoch: 44, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5416419506072998
Epoch: 45, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5150265693664551
Epoch: 46, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6011438369750977
Epoch: 47, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5378603935241699
Epoch: 48, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.5792996883392334
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.5331907272338867
Epoch: 50, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 324780
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.764481782913208
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.503 Vali Acc: 0.056 Test Loss: 2.503 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.5145618915557861
Epoch: 2, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.459 Vali Acc: 0.083 Test Loss: 2.459 Test Acc: 0.083
Validation loss decreased (-0.055531 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 0.4587390422821045
Epoch: 3, Steps: 7 | Train Loss: 2.413 Vali Loss: 2.387 Vali Acc: 0.319 Test Loss: 2.387 Test Acc: 0.319
Validation loss decreased (-0.083309 --> -0.319421).  Saving model ...
Epoch: 4 cost time: 0.4717254638671875
Epoch: 4, Steps: 7 | Train Loss: 2.308 Vali Loss: 2.296 Vali Acc: 0.431 Test Loss: 2.296 Test Acc: 0.431
Validation loss decreased (-0.319421 --> -0.430533).  Saving model ...
Epoch: 5 cost time: 0.5679128170013428
Epoch: 5, Steps: 7 | Train Loss: 2.184 Vali Loss: 2.185 Vali Acc: 0.528 Test Loss: 2.185 Test Acc: 0.528
Validation loss decreased (-0.430533 --> -0.527756).  Saving model ...
Epoch: 6 cost time: 0.5200262069702148
Epoch: 6, Steps: 7 | Train Loss: 2.038 Vali Loss: 2.060 Vali Acc: 0.667 Test Loss: 2.060 Test Acc: 0.667
Validation loss decreased (-0.527756 --> -0.666646).  Saving model ...
Epoch: 7 cost time: 0.5449833869934082
Epoch: 7, Steps: 7 | Train Loss: 1.887 Vali Loss: 1.916 Vali Acc: 0.722 Test Loss: 1.916 Test Acc: 0.722
Validation loss decreased (-0.666646 --> -0.722203).  Saving model ...
Epoch: 8 cost time: 0.5524077415466309
Epoch: 8, Steps: 7 | Train Loss: 1.716 Vali Loss: 1.755 Vali Acc: 0.750 Test Loss: 1.755 Test Acc: 0.750
Validation loss decreased (-0.722203 --> -0.749982).  Saving model ...
Epoch: 9 cost time: 0.6241483688354492
Epoch: 9, Steps: 7 | Train Loss: 1.549 Vali Loss: 1.584 Vali Acc: 0.778 Test Loss: 1.584 Test Acc: 0.778
Validation loss decreased (-0.749982 --> -0.777762).  Saving model ...
Epoch: 10 cost time: 0.540186882019043
Epoch: 10, Steps: 7 | Train Loss: 1.351 Vali Loss: 1.403 Vali Acc: 0.806 Test Loss: 1.403 Test Acc: 0.806
Validation loss decreased (-0.777762 --> -0.805542).  Saving model ...
Epoch: 11 cost time: 0.5794284343719482
Epoch: 11, Steps: 7 | Train Loss: 1.154 Vali Loss: 1.224 Vali Acc: 0.833 Test Loss: 1.224 Test Acc: 0.833
Validation loss decreased (-0.805542 --> -0.833321).  Saving model ...
Epoch: 12 cost time: 0.5744524002075195
Epoch: 12, Steps: 7 | Train Loss: 0.955 Vali Loss: 1.060 Vali Acc: 0.847 Test Loss: 1.060 Test Acc: 0.847
Validation loss decreased (-0.833321 --> -0.847212).  Saving model ...
Epoch: 13 cost time: 0.6083831787109375
Epoch: 13, Steps: 7 | Train Loss: 0.782 Vali Loss: 0.910 Vali Acc: 0.847 Test Loss: 0.910 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847213).  Saving model ...
Epoch: 14 cost time: 0.5246472358703613
Epoch: 14, Steps: 7 | Train Loss: 0.627 Vali Loss: 0.785 Vali Acc: 0.847 Test Loss: 0.785 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847214).  Saving model ...
Epoch: 15 cost time: 0.5741486549377441
Epoch: 15, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.5518279075622559
Epoch: 16, Steps: 7 | Train Loss: 0.387 Vali Loss: 0.607 Vali Acc: 0.917 Test Loss: 0.607 Test Acc: 0.917
Validation loss decreased (-0.874993 --> -0.916661).  Saving model ...
Epoch: 17 cost time: 0.6024777889251709
Epoch: 17, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.548 Vali Acc: 0.917 Test Loss: 0.548 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916661).  Saving model ...
Epoch: 18 cost time: 0.5467920303344727
Epoch: 18, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.506 Vali Acc: 0.917 Test Loss: 0.506 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 0.5987751483917236
Epoch: 19, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.470 Vali Acc: 0.917 Test Loss: 0.470 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 20 cost time: 0.5204429626464844
Epoch: 20, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.442 Vali Acc: 0.903 Test Loss: 0.442 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5072455406188965
Epoch: 21, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.418 Vali Acc: 0.917 Test Loss: 0.418 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 0.6136071681976318
Epoch: 22, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.403 Vali Acc: 0.903 Test Loss: 0.403 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5877039432525635
Epoch: 23, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5886225700378418
Epoch: 24, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5735738277435303
Epoch: 25, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5504367351531982
Epoch: 26, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6137638092041016
Epoch: 27, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 0.5988936424255371
Epoch: 28, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5515265464782715
Epoch: 29, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5354108810424805
Epoch: 30, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6284804344177246
Epoch: 31, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5053322315216064
Epoch: 32, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 33 cost time: 0.5358648300170898
Epoch: 33, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 34 cost time: 0.5391082763671875
Epoch: 34, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5055990219116211
Epoch: 35, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.48122739791870117
Epoch: 36, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5319962501525879
Epoch: 37, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5841803550720215
Epoch: 38, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.581355094909668
Epoch: 39, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5152666568756104
Epoch: 40, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5518724918365479
Epoch: 41, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.48499345779418945
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6123859882354736
Epoch: 43, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 322092
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2139534950256348
Epoch: 1, Steps: 7 | Train Loss: 2.370 Vali Loss: 1.908 Vali Acc: 0.694 Test Loss: 1.908 Test Acc: 0.694
Validation loss decreased (inf --> -0.694425).  Saving model ...
Epoch: 2 cost time: 0.9812729358673096
Epoch: 2, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.519 Vali Acc: 0.917 Test Loss: 0.519 Test Acc: 0.917
Validation loss decreased (-0.694425 --> -0.916661).  Saving model ...
Epoch: 3 cost time: 0.9552557468414307
Epoch: 3, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.779494047164917
Epoch: 4, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7345967292785645
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7997035980224609
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9357244968414307
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9351317882537842
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7358615398406982
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.903 Test Loss: 0.491 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9243752956390381
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9065377712249756
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9558186531066895
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.903 Test Loss: 0.439 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 4733708
model size : 18.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9191303253173828
Epoch: 1, Steps: 7 | Train Loss: 2.413 Vali Loss: 2.141 Vali Acc: 0.583 Test Loss: 2.141 Test Acc: 0.583
Validation loss decreased (inf --> -0.583312).  Saving model ...
Epoch: 2 cost time: 0.6051313877105713
Epoch: 2, Steps: 7 | Train Loss: 1.149 Vali Loss: 0.984 Vali Acc: 0.917 Test Loss: 0.984 Test Acc: 0.917
Validation loss decreased (-0.583312 --> -0.916657).  Saving model ...
Epoch: 3 cost time: 0.6036486625671387
Epoch: 3, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
Validation loss decreased (-0.916657 --> -0.930552).  Saving model ...
Epoch: 4 cost time: 0.8429934978485107
Epoch: 4, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6650676727294922
Epoch: 5, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.6761512756347656
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6892173290252686
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.6897990703582764
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.6466512680053711
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7601962089538574
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6669793128967285
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6520729064941406
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5740468502044678
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6565463542938232
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.515399694442749
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.7641446590423584
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6362643241882324
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 0.7522163391113281
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 0.6901884078979492
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 0.6846306324005127
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 0.7293167114257812
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 0.693122148513794
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 0.677067756652832
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 0.6975293159484863
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6431264877319336
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7769780158996582
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6927640438079834
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7513065338134766
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8313682079315186
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7072925567626953
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7423248291015625
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8413159847259521
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.684781551361084
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 4004108
model size : 15.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0355708599090576
Epoch: 1, Steps: 7 | Train Loss: 2.511 Vali Loss: 2.256 Vali Acc: 0.250 Test Loss: 2.256 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 0.6855981349945068
Epoch: 2, Steps: 7 | Train Loss: 1.548 Vali Loss: 1.306 Vali Acc: 0.889 Test Loss: 1.306 Test Acc: 0.889
Validation loss decreased (-0.249977 --> -0.888876).  Saving model ...
Epoch: 3 cost time: 0.6156213283538818
Epoch: 3, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.593 Vali Acc: 0.931 Test Loss: 0.593 Test Acc: 0.931
Validation loss decreased (-0.888876 --> -0.930550).  Saving model ...
Epoch: 4 cost time: 0.6255619525909424
Epoch: 4, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 0.5805461406707764
Epoch: 5, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.8322863578796387
Epoch: 6, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 0.6999034881591797
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7221171855926514
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6766974925994873
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6653063297271729
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7219796180725098
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7270033359527588
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5688364505767822
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7137291431427002
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7263023853302002
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6663146018981934
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3772172
model size : 14.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.134519577026367
Epoch: 1, Steps: 7 | Train Loss: 2.386 Vali Loss: 2.229 Vali Acc: 0.458 Test Loss: 2.229 Test Acc: 0.458
Validation loss decreased (inf --> -0.458311).  Saving model ...
Epoch: 2 cost time: 0.7455830574035645
Epoch: 2, Steps: 7 | Train Loss: 1.629 Vali Loss: 1.461 Vali Acc: 0.806 Test Loss: 1.461 Test Acc: 0.806
Validation loss decreased (-0.458311 --> -0.805541).  Saving model ...
Epoch: 3 cost time: 0.6382904052734375
Epoch: 3, Steps: 7 | Train Loss: 0.640 Vali Loss: 0.771 Vali Acc: 0.889 Test Loss: 0.771 Test Acc: 0.889
Validation loss decreased (-0.805541 --> -0.888881).  Saving model ...
Epoch: 4 cost time: 0.6772587299346924
Epoch: 4, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.411 Vali Acc: 0.944 Test Loss: 0.411 Test Acc: 0.944
Validation loss decreased (-0.888881 --> -0.944440).  Saving model ...
Epoch: 5 cost time: 0.727510929107666
Epoch: 5, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.303 Vali Acc: 0.958 Test Loss: 0.303 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958330).  Saving model ...
Epoch: 6 cost time: 0.7310981750488281
Epoch: 6, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 0.6451442241668701
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5823245048522949
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6813151836395264
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5276877880096436
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5058748722076416
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5107574462890625
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5490636825561523
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5824861526489258
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5771548748016357
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6976866722106934
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3650828
model size : 13.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0063390731811523
Epoch: 1, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.381 Vali Acc: 0.236 Test Loss: 2.381 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.7135412693023682
Epoch: 2, Steps: 7 | Train Loss: 1.868 Vali Loss: 1.755 Vali Acc: 0.778 Test Loss: 1.755 Test Acc: 0.778
Validation loss decreased (-0.236087 --> -0.777760).  Saving model ...
Epoch: 3 cost time: 0.6382520198822021
Epoch: 3, Steps: 7 | Train Loss: 0.951 Vali Loss: 1.048 Vali Acc: 0.861 Test Loss: 1.048 Test Acc: 0.861
Validation loss decreased (-0.777760 --> -0.861101).  Saving model ...
Epoch: 4 cost time: 0.5623724460601807
Epoch: 4, Steps: 7 | Train Loss: 0.369 Vali Loss: 0.597 Vali Acc: 0.917 Test Loss: 0.597 Test Acc: 0.917
Validation loss decreased (-0.861101 --> -0.916661).  Saving model ...
Epoch: 5 cost time: 0.6789834499359131
Epoch: 5, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 6 cost time: 0.6813235282897949
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 0.6100327968597412
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.7153770923614502
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.6196706295013428
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6518611907958984
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.7592165470123291
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.6429874897003174
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6272139549255371
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6049776077270508
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.6781256198883057
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6196904182434082
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6081345081329346
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6282858848571777
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6554045677185059
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7133092880249023
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.6891202926635742
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6066174507141113
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5672192573547363
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6348230838775635
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5778892040252686
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5987989902496338
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.738511323928833
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6297821998596191
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6383473873138428
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6370141506195068
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6754727363586426
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6901824474334717
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.717972993850708
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6772563457489014
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6612324714660645
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5998682975769043
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6597936153411865
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.6973264217376709
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6400737762451172
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6713018417358398
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5712549686431885
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6454474925994873
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6443097591400146
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5826132297515869
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7960379123687744
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7184631824493408
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.6441371440887451
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.7467193603515625
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.6130046844482422
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6581707000732422
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3555596
model size : 13.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8537437915802002
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.395 Vali Acc: 0.236 Test Loss: 2.395 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.7974250316619873
Epoch: 2, Steps: 7 | Train Loss: 2.112 Vali Loss: 1.927 Vali Acc: 0.639 Test Loss: 1.927 Test Acc: 0.639
Validation loss decreased (-0.236087 --> -0.638870).  Saving model ...
Epoch: 3 cost time: 0.6505270004272461
Epoch: 3, Steps: 7 | Train Loss: 1.350 Vali Loss: 1.310 Vali Acc: 0.889 Test Loss: 1.310 Test Acc: 0.889
Validation loss decreased (-0.638870 --> -0.888876).  Saving model ...
Epoch: 4 cost time: 0.6228256225585938
Epoch: 4, Steps: 7 | Train Loss: 0.666 Vali Loss: 0.814 Vali Acc: 0.931 Test Loss: 0.814 Test Acc: 0.931
Validation loss decreased (-0.888876 --> -0.930547).  Saving model ...
Epoch: 5 cost time: 0.7076973915100098
Epoch: 5, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.545 Vali Acc: 0.931 Test Loss: 0.545 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930550).  Saving model ...
Epoch: 6 cost time: 0.7094433307647705
Epoch: 6, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6585109233856201
Epoch: 7, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.373 Vali Acc: 0.944 Test Loss: 0.373 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 0.7499041557312012
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.6758639812469482
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 0.6879677772521973
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.958 Test Loss: 0.282 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.5575168132781982
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7670934200286865
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.958 Test Loss: 0.269 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.6837413311004639
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.958 Test Loss: 0.264 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.5597944259643555
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.5995087623596191
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.958 Test Loss: 0.260 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.648003339767456
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.958 Test Loss: 0.257 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6855864524841309
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.958 Test Loss: 0.255 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5866847038269043
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.7474265098571777
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.6885380744934082
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.8594927787780762
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.7821307182312012
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6670374870300293
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.668299674987793
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7000288963317871
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.958 Test Loss: 0.243 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.6229109764099121
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.7472438812255859
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7560231685638428
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.6611807346343994
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.689842939376831
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.792762041091919
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.5898990631103516
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.670896053314209
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.7223045825958252
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6120021343231201
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6863400936126709
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.6383397579193115
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.7192606925964355
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.6120517253875732
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.7244360446929932
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.6811192035675049
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.6286225318908691
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.683527946472168
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6858665943145752
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6240601539611816
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.7482399940490723
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6427466869354248
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.7292628288269043
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.6461136341094971
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.7130990028381348
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 3497228
model size : 13.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7876906394958496
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.405 Vali Acc: 0.208 Test Loss: 2.405 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.6132347583770752
Epoch: 2, Steps: 7 | Train Loss: 2.142 Vali Loss: 2.018 Vali Acc: 0.514 Test Loss: 2.018 Test Acc: 0.514
Validation loss decreased (-0.208309 --> -0.513869).  Saving model ...
Epoch: 3 cost time: 0.5802042484283447
Epoch: 3, Steps: 7 | Train Loss: 1.482 Vali Loss: 1.468 Vali Acc: 0.764 Test Loss: 1.468 Test Acc: 0.764
Validation loss decreased (-0.513869 --> -0.763874).  Saving model ...
Epoch: 4 cost time: 0.6078970432281494
Epoch: 4, Steps: 7 | Train Loss: 0.830 Vali Loss: 0.995 Vali Acc: 0.861 Test Loss: 0.995 Test Acc: 0.861
Validation loss decreased (-0.763874 --> -0.861101).  Saving model ...
Epoch: 5 cost time: 0.7186877727508545
Epoch: 5, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.702 Vali Acc: 0.889 Test Loss: 0.702 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 0.7077882289886475
Epoch: 6, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.493 Vali Acc: 0.903 Test Loss: 0.493 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.6900169849395752
Epoch: 7, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.6806166172027588
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.365 Vali Acc: 0.931 Test Loss: 0.365 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.639962911605835
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6494076251983643
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.337 Vali Acc: 0.931 Test Loss: 0.337 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.6782231330871582
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.329 Vali Acc: 0.931 Test Loss: 0.329 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.6426761150360107
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.321 Vali Acc: 0.931 Test Loss: 0.321 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.6335008144378662
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.931 Test Loss: 0.313 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.6971418857574463
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 0.7302532196044922
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.6955533027648926
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.6393465995788574
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7344694137573242
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5573849678039551
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6829562187194824
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.692188024520874
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5913665294647217
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5723602771759033
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5729165077209473
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6084542274475098
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6179471015930176
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6077404022216797
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5658032894134521
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5864949226379395
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5495548248291016
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6495163440704346
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6084225177764893
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6915960311889648
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5942771434783936
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6221134662628174
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6530699729919434
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.7114861011505127
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6425344944000244
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5501768589019775
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5943801403045654
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6851518154144287
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5958538055419922
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.7296102046966553
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.6080501079559326
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.675987720489502
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6851580142974854
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.6420328617095947
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6784205436706543
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6450526714324951
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6151607036590576
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 3475724
model size : 13.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9064884185791016
Epoch: 1, Steps: 7 | Train Loss: 2.425 Vali Loss: 2.143 Vali Acc: 0.514 Test Loss: 2.143 Test Acc: 0.514
Validation loss decreased (inf --> -0.513867).  Saving model ...
Epoch: 2 cost time: 0.5589840412139893
Epoch: 2, Steps: 7 | Train Loss: 1.163 Vali Loss: 0.961 Vali Acc: 0.861 Test Loss: 0.961 Test Acc: 0.861
Validation loss decreased (-0.513867 --> -0.861102).  Saving model ...
Epoch: 3 cost time: 0.6290922164916992
Epoch: 3, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.415 Vali Acc: 0.931 Test Loss: 0.415 Test Acc: 0.931
Validation loss decreased (-0.861102 --> -0.930551).  Saving model ...
Epoch: 4 cost time: 0.6532900333404541
Epoch: 4, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6076200008392334
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6412253379821777
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7942461967468262
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6195945739746094
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8416900634765625
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.6949214935302734
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5657100677490234
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.635418176651001
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6613786220550537
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7321317195892334
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.603240966796875
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.67205810546875
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5858063697814941
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4994664192199707
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6426799297332764
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5920810699462891
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.6334846019744873
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5487511157989502
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6466174125671387
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6490097045898438
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5785622596740723
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5611929893493652
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5923581123352051
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.7048394680023193
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7433042526245117
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7864010334014893
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7125561237335205
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.8027791976928711
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5697834491729736
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6611878871917725
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.6319968700408936
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.5709331035614014
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.5555257797241211
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.4977602958679199
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.5178391933441162
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.47042322158813477
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.581486701965332
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.5502402782440186
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.5741362571716309
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.6235432624816895
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.6143794059753418
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.6719353199005127
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.5904207229614258
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.6394305229187012
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.589015007019043
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5757050514221191
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1580428
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7014765739440918
Epoch: 1, Steps: 7 | Train Loss: 2.532 Vali Loss: 2.340 Vali Acc: 0.306 Test Loss: 2.340 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 0.5486204624176025
Epoch: 2, Steps: 7 | Train Loss: 1.793 Vali Loss: 1.503 Vali Acc: 0.764 Test Loss: 1.503 Test Acc: 0.764
Validation loss decreased (-0.305532 --> -0.763874).  Saving model ...
Epoch: 3 cost time: 0.4662959575653076
Epoch: 3, Steps: 7 | Train Loss: 0.699 Vali Loss: 0.759 Vali Acc: 0.903 Test Loss: 0.759 Test Acc: 0.903
Validation loss decreased (-0.763874 --> -0.902770).  Saving model ...
Epoch: 4 cost time: 0.558537483215332
Epoch: 4, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.408 Vali Acc: 0.917 Test Loss: 0.408 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 0.5377740859985352
Epoch: 5, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.5438189506530762
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5698673725128174
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5350208282470703
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.48920369148254395
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6232116222381592
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.63995361328125
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5530979633331299
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 0.5611536502838135
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.944443 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 0.6104230880737305
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 0.5464694499969482
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 0.5271782875061035
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.5500481128692627
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.5304594039916992
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.5407428741455078
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.45417141914367676
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6050417423248291
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6620984077453613
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6178364753723145
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5760998725891113
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7290260791778564
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5521702766418457
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6397030353546143
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.605931282043457
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 1215628
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9657738208770752
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.367 Vali Acc: 0.250 Test Loss: 2.367 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 0.4448869228363037
Epoch: 2, Steps: 7 | Train Loss: 1.969 Vali Loss: 1.770 Vali Acc: 0.764 Test Loss: 1.770 Test Acc: 0.764
Validation loss decreased (-0.249976 --> -0.763871).  Saving model ...
Epoch: 3 cost time: 0.6296141147613525
Epoch: 3, Steps: 7 | Train Loss: 1.076 Vali Loss: 1.081 Vali Acc: 0.875 Test Loss: 1.081 Test Acc: 0.875
Validation loss decreased (-0.763871 --> -0.874989).  Saving model ...
Epoch: 4 cost time: 0.6557090282440186
Epoch: 4, Steps: 7 | Train Loss: 0.421 Vali Loss: 0.616 Vali Acc: 0.917 Test Loss: 0.616 Test Acc: 0.917
Validation loss decreased (-0.874989 --> -0.916661).  Saving model ...
Epoch: 5 cost time: 0.5633208751678467
Epoch: 5, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 0.6586284637451172
Epoch: 6, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 0.5557832717895508
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.5665438175201416
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 0.6042649745941162
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.518613338470459
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6943941116333008
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.605443000793457
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.6199901103973389
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.6338982582092285
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.6428723335266113
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6147103309631348
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6200475692749023
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5550720691680908
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5976290702819824
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.6856088638305664
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.667978048324585
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.653576135635376
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6067342758178711
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7217569351196289
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.684088945388794
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7043464183807373
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.662909746170044
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7570476531982422
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.6191408634185791
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.579369068145752
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.5932729244232178
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6104538440704346
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.6636989116668701
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.6670262813568115
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.7082736492156982
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6578307151794434
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6341309547424316
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.583606481552124
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.5929150581359863
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.4821643829345703
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.5456893444061279
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.5403885841369629
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.47966933250427246
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.5319724082946777
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.6965696811676025
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.5580658912658691
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.5039782524108887
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.5992529392242432
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.5101115703582764
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.5756285190582275
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1099660
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.842604398727417
Epoch: 1, Steps: 7 | Train Loss: 2.394 Vali Loss: 2.321 Vali Acc: 0.292 Test Loss: 2.321 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 0.5556328296661377
Epoch: 2, Steps: 7 | Train Loss: 1.951 Vali Loss: 1.880 Vali Acc: 0.597 Test Loss: 1.880 Test Acc: 0.597
Validation loss decreased (-0.291643 --> -0.597203).  Saving model ...
Epoch: 3 cost time: 0.567166805267334
Epoch: 3, Steps: 7 | Train Loss: 1.250 Vali Loss: 1.305 Vali Acc: 0.861 Test Loss: 1.305 Test Acc: 0.861
Validation loss decreased (-0.597203 --> -0.861098).  Saving model ...
Epoch: 4 cost time: 0.5699059963226318
Epoch: 4, Steps: 7 | Train Loss: 0.638 Vali Loss: 0.824 Vali Acc: 0.917 Test Loss: 0.824 Test Acc: 0.917
Validation loss decreased (-0.861098 --> -0.916658).  Saving model ...
Epoch: 5 cost time: 0.5483336448669434
Epoch: 5, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.550 Vali Acc: 0.944 Test Loss: 0.550 Test Acc: 0.944
Validation loss decreased (-0.916658 --> -0.944439).  Saving model ...
Epoch: 6 cost time: 0.6610910892486572
Epoch: 6, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.390 Vali Acc: 0.931 Test Loss: 0.390 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.512453556060791
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 0.518963098526001
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.5462312698364258
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.958 Test Loss: 0.301 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.5185081958770752
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.958 Test Loss: 0.284 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.5209596157073975
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.958 Test Loss: 0.270 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.5474326610565186
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.6003029346466064
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.5120453834533691
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.49015021324157715
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.4913315773010254
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5005602836608887
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5369915962219238
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5215733051300049
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.5237524509429932
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.5924572944641113
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.44535017013549805
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.46962523460388184
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.46270751953125
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.49367475509643555
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.5906903743743896
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.5273492336273193
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.5197792053222656
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.6015486717224121
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5910358428955078
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.5805544853210449
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.5894196033477783
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5160245895385742
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.48456788063049316
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6292088031768799
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.49222493171691895
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.5687718391418457
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.5294065475463867
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.5656964778900146
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.48078370094299316
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.5429754257202148
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.4730982780456543
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.5576667785644531
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.4877889156341553
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.5435402393341064
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.5043590068817139
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5356733798980713
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6034600734710693
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5397214889526367
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.44585299491882324
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1038988
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7325263023376465
Epoch: 1, Steps: 7 | Train Loss: 2.521 Vali Loss: 2.388 Vali Acc: 0.153 Test Loss: 2.388 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.5538508892059326
Epoch: 2, Steps: 7 | Train Loss: 2.215 Vali Loss: 2.078 Vali Acc: 0.556 Test Loss: 2.078 Test Acc: 0.556
Validation loss decreased (-0.152754 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 0.5379135608673096
Epoch: 3, Steps: 7 | Train Loss: 1.624 Vali Loss: 1.603 Vali Acc: 0.750 Test Loss: 1.603 Test Acc: 0.750
Validation loss decreased (-0.555535 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 0.5291464328765869
Epoch: 4, Steps: 7 | Train Loss: 1.017 Vali Loss: 1.128 Vali Acc: 0.861 Test Loss: 1.128 Test Acc: 0.861
Validation loss decreased (-0.749984 --> -0.861100).  Saving model ...
Epoch: 5 cost time: 0.5373613834381104
Epoch: 5, Steps: 7 | Train Loss: 0.548 Vali Loss: 0.764 Vali Acc: 0.917 Test Loss: 0.764 Test Acc: 0.917
Validation loss decreased (-0.861100 --> -0.916659).  Saving model ...
Epoch: 6 cost time: 0.4746279716491699
Epoch: 6, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.526 Vali Acc: 0.931 Test Loss: 0.526 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930550).  Saving model ...
Epoch: 7 cost time: 0.5395071506500244
Epoch: 7, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.406 Vali Acc: 0.944 Test Loss: 0.406 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 0.5319106578826904
Epoch: 8, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.350 Vali Acc: 0.958 Test Loss: 0.350 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958330).  Saving model ...
Epoch: 9 cost time: 0.529550313949585
Epoch: 9, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.322 Vali Acc: 0.958 Test Loss: 0.322 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.568535327911377
Epoch: 10, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.301 Vali Acc: 0.958 Test Loss: 0.301 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.5193109512329102
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.283 Vali Acc: 0.958 Test Loss: 0.283 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.5896224975585938
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.272 Vali Acc: 0.958 Test Loss: 0.272 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.5906755924224854
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.958 Test Loss: 0.265 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.5734274387359619
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.618950366973877
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.972 Test Loss: 0.255 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 0.5961463451385498
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.972 Test Loss: 0.249 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.5206632614135742
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.972 Test Loss: 0.247 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.5698950290679932
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.972 Test Loss: 0.244 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.645801305770874
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6123011112213135
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6168746948242188
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5109927654266357
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.972 Test Loss: 0.233 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.5223169326782227
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.972 Test Loss: 0.231 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.6108381748199463
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.972 Test Loss: 0.229 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 25 cost time: 0.6338143348693848
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.6113717555999756
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5669753551483154
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5657587051391602
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.972 Test Loss: 0.219 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 29 cost time: 0.5521903038024902
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 30 cost time: 0.5398232936859131
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 31 cost time: 0.579164981842041
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6040244102478027
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6358275413513184
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5569705963134766
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5660650730133057
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.6621792316436768
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.972 Test Loss: 0.212 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5835349559783936
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.6101460456848145
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.972 Test Loss: 0.209 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 0.5368595123291016
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 0.6370534896850586
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 41 cost time: 0.5473828315734863
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 42 cost time: 0.5137696266174316
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4763505458831787
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.546377420425415
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.5450615882873535
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.5674388408660889
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6750977039337158
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.4725468158721924
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 0.5675721168518066
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.6206865310668945
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 991372
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8231704235076904
Epoch: 1, Steps: 7 | Train Loss: 2.449 Vali Loss: 2.395 Vali Acc: 0.153 Test Loss: 2.395 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.5610926151275635
Epoch: 2, Steps: 7 | Train Loss: 2.206 Vali Loss: 2.121 Vali Acc: 0.556 Test Loss: 2.121 Test Acc: 0.556
Validation loss decreased (-0.152754 --> -0.555534).  Saving model ...
Epoch: 3 cost time: 0.5597686767578125
Epoch: 3, Steps: 7 | Train Loss: 1.755 Vali Loss: 1.708 Vali Acc: 0.792 Test Loss: 1.708 Test Acc: 0.792
Validation loss decreased (-0.555534 --> -0.791650).  Saving model ...
Epoch: 4 cost time: 0.5591280460357666
Epoch: 4, Steps: 7 | Train Loss: 1.258 Vali Loss: 1.289 Vali Acc: 0.819 Test Loss: 1.289 Test Acc: 0.819
Validation loss decreased (-0.791650 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 0.555903434753418
Epoch: 5, Steps: 7 | Train Loss: 0.796 Vali Loss: 0.952 Vali Acc: 0.889 Test Loss: 0.952 Test Acc: 0.889
Validation loss decreased (-0.819432 --> -0.888879).  Saving model ...
Epoch: 6 cost time: 0.5313422679901123
Epoch: 6, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.708 Vali Acc: 0.889 Test Loss: 0.708 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 0.571669340133667
Epoch: 7, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 0.5227904319763184
Epoch: 8, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.443 Vali Acc: 0.931 Test Loss: 0.443 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 0.5814375877380371
Epoch: 9, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.393 Vali Acc: 0.931 Test Loss: 0.393 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.5594511032104492
Epoch: 10, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.5905055999755859
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.337 Vali Acc: 0.931 Test Loss: 0.337 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.5021967887878418
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5639591217041016
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5152068138122559
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5061426162719727
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5587315559387207
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.5431256294250488
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.5632388591766357
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5731637477874756
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.561734676361084
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5548186302185059
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5457875728607178
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5339117050170898
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.5702528953552246
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5638020038604736
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6008429527282715
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5427467823028564
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.5128772258758545
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.4764087200164795
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.5803873538970947
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.4736475944519043
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.52632737159729
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.5212264060974121
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4781770706176758
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.537764310836792
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5925054550170898
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.529041051864624
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.59067702293396
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5190088748931885
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6074035167694092
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5705890655517578
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.49980711936950684
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 962188
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8445532321929932
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.415 Vali Acc: 0.097 Test Loss: 2.415 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.5386512279510498
Epoch: 2, Steps: 7 | Train Loss: 2.247 Vali Loss: 2.201 Vali Acc: 0.361 Test Loss: 2.201 Test Acc: 0.361
Validation loss decreased (-0.097198 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.682612419128418
Epoch: 3, Steps: 7 | Train Loss: 1.868 Vali Loss: 1.865 Vali Acc: 0.583 Test Loss: 1.865 Test Acc: 0.583
Validation loss decreased (-0.361089 --> -0.583315).  Saving model ...
Epoch: 4 cost time: 0.6351056098937988
Epoch: 4, Steps: 7 | Train Loss: 1.445 Vali Loss: 1.507 Vali Acc: 0.722 Test Loss: 1.507 Test Acc: 0.722
Validation loss decreased (-0.583315 --> -0.722207).  Saving model ...
Epoch: 5 cost time: 0.5729753971099854
Epoch: 5, Steps: 7 | Train Loss: 1.039 Vali Loss: 1.179 Vali Acc: 0.792 Test Loss: 1.179 Test Acc: 0.792
Validation loss decreased (-0.722207 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 0.5478694438934326
Epoch: 6, Steps: 7 | Train Loss: 0.682 Vali Loss: 0.904 Vali Acc: 0.833 Test Loss: 0.904 Test Acc: 0.833
Validation loss decreased (-0.791655 --> -0.833324).  Saving model ...
Epoch: 7 cost time: 0.558635950088501
Epoch: 7, Steps: 7 | Train Loss: 0.419 Vali Loss: 0.717 Vali Acc: 0.847 Test Loss: 0.717 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847215).  Saving model ...
Epoch: 8 cost time: 0.6393935680389404
Epoch: 8, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.577 Vali Acc: 0.889 Test Loss: 0.577 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 0.5259487628936768
Epoch: 9, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 0.6188333034515381
Epoch: 10, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.455 Vali Acc: 0.903 Test Loss: 0.455 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 11 cost time: 0.4815816879272461
Epoch: 11, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.421 Vali Acc: 0.903 Test Loss: 0.421 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.5142271518707275
Epoch: 12, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 0.5719966888427734
Epoch: 13, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5377025604248047
Epoch: 14, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5465610027313232
Epoch: 15, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.49225783348083496
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.4952383041381836
Epoch: 17, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.49994659423828125
Epoch: 18, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.600834846496582
Epoch: 19, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.4776499271392822
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5066897869110107
Epoch: 21, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6401422023773193
Epoch: 22, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.538689374923706
Epoch: 23, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.5333025455474854
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.6632299423217773
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.57920241355896
Epoch: 26, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5965175628662109
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 0.5740182399749756
Epoch: 28, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 0.5912652015686035
Epoch: 29, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 0.5985207557678223
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 31 cost time: 0.6441450119018555
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5400533676147461
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5542910099029541
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5918829441070557
Epoch: 34, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5893552303314209
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5266315937042236
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5635101795196533
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.5314662456512451
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5029740333557129
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5392382144927979
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6444237232208252
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.580446720123291
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4964759349822998
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5369775295257568
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5659692287445068
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5477547645568848
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.4755978584289551
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 951436
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6379985809326172
Epoch: 1, Steps: 7 | Train Loss: 2.437 Vali Loss: 2.342 Vali Acc: 0.222 Test Loss: 2.342 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 0.6349644660949707
Epoch: 2, Steps: 7 | Train Loss: 1.704 Vali Loss: 1.639 Vali Acc: 0.778 Test Loss: 1.639 Test Acc: 0.778
Validation loss decreased (-0.222199 --> -0.777761).  Saving model ...
Epoch: 3 cost time: 0.570547342300415
Epoch: 3, Steps: 7 | Train Loss: 0.720 Vali Loss: 0.883 Vali Acc: 0.903 Test Loss: 0.883 Test Acc: 0.903
Validation loss decreased (-0.777761 --> -0.902769).  Saving model ...
Epoch: 4 cost time: 0.5850968360900879
Epoch: 4, Steps: 7 | Train Loss: 0.190 Vali Loss: 0.454 Vali Acc: 0.931 Test Loss: 0.454 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930551).  Saving model ...
Epoch: 5 cost time: 0.5590765476226807
Epoch: 5, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5507640838623047
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7394046783447266
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.6037654876708984
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 0.5634937286376953
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.5729882717132568
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 11 cost time: 0.5657749176025391
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 0.591632604598999
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.5559515953063965
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 0.5983600616455078
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6103858947753906
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5228967666625977
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.602703332901001
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5537052154541016
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5438275337219238
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5453054904937744
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5387189388275146
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.47734785079956055
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6463241577148438
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 24 cost time: 0.5868039131164551
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 25 cost time: 0.5238287448883057
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 0.6023828983306885
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 27 cost time: 0.5812621116638184
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 28 cost time: 0.5618445873260498
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 29 cost time: 0.5261173248291016
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 30 cost time: 0.5697314739227295
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 31 cost time: 0.5218789577484131
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 32 cost time: 0.6146373748779297
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 33 cost time: 0.5434551239013672
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 34 cost time: 0.5571339130401611
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 35 cost time: 0.6574077606201172
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5396509170532227
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 37 cost time: 0.5446643829345703
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6230118274688721
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5774781703948975
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 40 cost time: 0.5005514621734619
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5211019515991211
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.528357982635498
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 43 cost time: 0.5387003421783447
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 44 cost time: 0.5420477390289307
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 45 cost time: 0.6549816131591797
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 46 cost time: 0.608454704284668
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 47 cost time: 0.5952315330505371
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 48 cost time: 0.5816202163696289
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 49 cost time: 0.5444860458374023
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5321812629699707
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 593612
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.888230323791504
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.390 Vali Acc: 0.167 Test Loss: 2.390 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.5263936519622803
Epoch: 2, Steps: 7 | Train Loss: 2.050 Vali Loss: 1.932 Vali Acc: 0.639 Test Loss: 1.932 Test Acc: 0.639
Validation loss decreased (-0.166643 --> -0.638870).  Saving model ...
Epoch: 3 cost time: 0.5475444793701172
Epoch: 3, Steps: 7 | Train Loss: 1.286 Vali Loss: 1.342 Vali Acc: 0.806 Test Loss: 1.342 Test Acc: 0.806
Validation loss decreased (-0.638870 --> -0.805542).  Saving model ...
Epoch: 4 cost time: 0.5666468143463135
Epoch: 4, Steps: 7 | Train Loss: 0.674 Vali Loss: 0.839 Vali Acc: 0.889 Test Loss: 0.839 Test Acc: 0.889
Validation loss decreased (-0.805542 --> -0.888880).  Saving model ...
Epoch: 5 cost time: 0.5613236427307129
Epoch: 5, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.540 Vali Acc: 0.903 Test Loss: 0.540 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 0.4885270595550537
Epoch: 6, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.395 Vali Acc: 0.917 Test Loss: 0.395 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.41866064071655273
Epoch: 7, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.4260282516479492
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5514004230499268
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5063743591308594
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.48194432258605957
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.42818117141723633
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4577200412750244
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.46730661392211914
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4913046360015869
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5484933853149414
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.46187853813171387
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.45099782943725586
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5271692276000977
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5585415363311768
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4799537658691406
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 411212
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8905739784240723
Epoch: 1, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.461 Vali Acc: 0.125 Test Loss: 2.461 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.48551011085510254
Epoch: 2, Steps: 7 | Train Loss: 2.272 Vali Loss: 2.138 Vali Acc: 0.417 Test Loss: 2.138 Test Acc: 0.417
Validation loss decreased (-0.124975 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.5267267227172852
Epoch: 3, Steps: 7 | Train Loss: 1.683 Vali Loss: 1.663 Vali Acc: 0.750 Test Loss: 1.663 Test Acc: 0.750
Validation loss decreased (-0.416645 --> -0.749983).  Saving model ...
Epoch: 4 cost time: 0.5267291069030762
Epoch: 4, Steps: 7 | Train Loss: 1.086 Vali Loss: 1.173 Vali Acc: 0.889 Test Loss: 1.173 Test Acc: 0.889
Validation loss decreased (-0.749983 --> -0.888877).  Saving model ...
Epoch: 5 cost time: 0.5553624629974365
Epoch: 5, Steps: 7 | Train Loss: 0.602 Vali Loss: 0.789 Vali Acc: 0.875 Test Loss: 0.789 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5567770004272461
Epoch: 6, Steps: 7 | Train Loss: 0.306 Vali Loss: 0.561 Vali Acc: 0.917 Test Loss: 0.561 Test Acc: 0.917
Validation loss decreased (-0.888877 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 0.511559009552002
Epoch: 7, Steps: 7 | Train Loss: 0.143 Vali Loss: 0.411 Vali Acc: 0.903 Test Loss: 0.411 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4576079845428467
Epoch: 8, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.5565450191497803
Epoch: 9, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.5010442733764648
Epoch: 10, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.47219252586364746
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.5179455280303955
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.547868013381958
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5052037239074707
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.576707124710083
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5519590377807617
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6010615825653076
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.500678300857544
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5957019329071045
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5258955955505371
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5096957683563232
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5520715713500977
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5766949653625488
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.535527229309082
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.4701192378997803
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.48446011543273926
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5086357593536377
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.5550355911254883
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.48497748374938965
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.526280403137207
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.479233980178833
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6189122200012207
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 0.5365607738494873
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 0.47633862495422363
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5262222290039062
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 0.5070719718933105
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.5177567005157471
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 0.5482883453369141
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 0.5205798149108887
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 40 cost time: 0.4697136878967285
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 0.4860379695892334
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.49231505393981934
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5071263313293457
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5141608715057373
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 0.4992351531982422
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 0.5639371871948242
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 0.5110626220703125
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 0.5271315574645996
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.49443793296813965
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 0.5476467609405518
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 353228
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7407245635986328
Epoch: 1, Steps: 7 | Train Loss: 2.605 Vali Loss: 2.517 Vali Acc: 0.083 Test Loss: 2.517 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.46474123001098633
Epoch: 2, Steps: 7 | Train Loss: 2.299 Vali Loss: 2.259 Vali Acc: 0.278 Test Loss: 2.259 Test Acc: 0.278
Validation loss decreased (-0.083308 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.5002057552337646
Epoch: 3, Steps: 7 | Train Loss: 1.870 Vali Loss: 1.870 Vali Acc: 0.667 Test Loss: 1.870 Test Acc: 0.667
Validation loss decreased (-0.277755 --> -0.666648).  Saving model ...
Epoch: 4 cost time: 0.5701913833618164
Epoch: 4, Steps: 7 | Train Loss: 1.411 Vali Loss: 1.444 Vali Acc: 0.847 Test Loss: 1.444 Test Acc: 0.847
Validation loss decreased (-0.666648 --> -0.847208).  Saving model ...
Epoch: 5 cost time: 0.5500037670135498
Epoch: 5, Steps: 7 | Train Loss: 0.921 Vali Loss: 1.083 Vali Acc: 0.903 Test Loss: 1.083 Test Acc: 0.903
Validation loss decreased (-0.847208 --> -0.902767).  Saving model ...
Epoch: 6 cost time: 0.4949214458465576
Epoch: 6, Steps: 7 | Train Loss: 0.569 Vali Loss: 0.777 Vali Acc: 0.917 Test Loss: 0.777 Test Acc: 0.917
Validation loss decreased (-0.902767 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 0.4407222270965576
Epoch: 7, Steps: 7 | Train Loss: 0.322 Vali Loss: 0.569 Vali Acc: 0.917 Test Loss: 0.569 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916661).  Saving model ...
Epoch: 8 cost time: 0.5508944988250732
Epoch: 8, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.450 Vali Acc: 0.931 Test Loss: 0.450 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 0.5675113201141357
Epoch: 9, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.389 Vali Acc: 0.931 Test Loss: 0.389 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.5886204242706299
Epoch: 10, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.351 Vali Acc: 0.931 Test Loss: 0.351 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.5178277492523193
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6526153087615967
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.5151281356811523
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5701472759246826
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.47192883491516113
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.6129083633422852
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.5800220966339111
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.5253949165344238
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.4593064785003662
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5412647724151611
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.43331050872802734
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.48288917541503906
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.44919657707214355
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6150619983673096
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.49753308296203613
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.4843311309814453
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5324571132659912
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.48813724517822266
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.561626672744751
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.44208478927612305
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.5875945091247559
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.5515918731689453
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.5555453300476074
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.5960922241210938
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.573451042175293
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.542060136795044
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.5706613063812256
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5101132392883301
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5087628364562988
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.5776622295379639
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.5421199798583984
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5068747997283936
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5459649562835693
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5367038249969482
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5598406791687012
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.48639702796936035
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5118460655212402
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5460224151611328
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4964025020599365
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5560884475708008
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 322892
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7449445724487305
Epoch: 1, Steps: 7 | Train Loss: 2.484 Vali Loss: 2.434 Vali Acc: 0.139 Test Loss: 2.434 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.4819185733795166
Epoch: 2, Steps: 7 | Train Loss: 2.283 Vali Loss: 2.243 Vali Acc: 0.347 Test Loss: 2.243 Test Acc: 0.347
Validation loss decreased (-0.138865 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.5910086631774902
Epoch: 3, Steps: 7 | Train Loss: 1.953 Vali Loss: 1.949 Vali Acc: 0.681 Test Loss: 1.949 Test Acc: 0.681
Validation loss decreased (-0.347200 --> -0.680536).  Saving model ...
Epoch: 4 cost time: 0.45085620880126953
Epoch: 4, Steps: 7 | Train Loss: 1.554 Vali Loss: 1.603 Vali Acc: 0.833 Test Loss: 1.603 Test Acc: 0.833
Validation loss decreased (-0.680536 --> -0.833317).  Saving model ...
Epoch: 5 cost time: 0.61692214012146
Epoch: 5, Steps: 7 | Train Loss: 1.161 Vali Loss: 1.264 Vali Acc: 0.903 Test Loss: 1.264 Test Acc: 0.903
Validation loss decreased (-0.833317 --> -0.902765).  Saving model ...
Epoch: 6 cost time: 0.6057987213134766
Epoch: 6, Steps: 7 | Train Loss: 0.823 Vali Loss: 0.974 Vali Acc: 0.903 Test Loss: 0.974 Test Acc: 0.903
Validation loss decreased (-0.902765 --> -0.902768).  Saving model ...
Epoch: 7 cost time: 0.4895930290222168
Epoch: 7, Steps: 7 | Train Loss: 0.545 Vali Loss: 0.760 Vali Acc: 0.917 Test Loss: 0.760 Test Acc: 0.917
Validation loss decreased (-0.902768 --> -0.916659).  Saving model ...
Epoch: 8 cost time: 0.4381248950958252
Epoch: 8, Steps: 7 | Train Loss: 0.360 Vali Loss: 0.612 Vali Acc: 0.931 Test Loss: 0.612 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930549).  Saving model ...
Epoch: 9 cost time: 0.45367956161499023
Epoch: 9, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.495 Vali Acc: 0.917 Test Loss: 0.495 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5977942943572998
Epoch: 10, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.428 Vali Acc: 0.944 Test Loss: 0.428 Test Acc: 0.944
Validation loss decreased (-0.930549 --> -0.944440).  Saving model ...
Epoch: 11 cost time: 0.5482571125030518
Epoch: 11, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.389 Vali Acc: 0.944 Test Loss: 0.389 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.5541541576385498
Epoch: 12, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.358 Vali Acc: 0.944 Test Loss: 0.358 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.506415605545044
Epoch: 13, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.5498263835906982
Epoch: 14, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.5039639472961426
Epoch: 15, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.5248091220855713
Epoch: 16, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.5312545299530029
Epoch: 17, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.294 Vali Acc: 0.958 Test Loss: 0.294 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 18 cost time: 0.5116653442382812
Epoch: 18, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.972 Test Loss: 0.285 Test Acc: 0.972
Validation loss decreased (-0.958330 --> -0.972219).  Saving model ...
Epoch: 19 cost time: 0.5082526206970215
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.282 Vali Acc: 0.958 Test Loss: 0.282 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5212063789367676
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5755228996276855
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.272 Vali Acc: 0.958 Test Loss: 0.272 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5012753009796143
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.958 Test Loss: 0.270 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5438659191131592
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.266 Vali Acc: 0.958 Test Loss: 0.266 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.49649858474731445
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6034915447235107
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5599839687347412
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.972 Test Loss: 0.253 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972220).  Saving model ...
Epoch: 27 cost time: 0.46466922760009766
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.972 Test Loss: 0.251 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 28 cost time: 0.6090600490570068
Epoch: 28, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.972 Test Loss: 0.248 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 29 cost time: 0.5137808322906494
Epoch: 29, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 30 cost time: 0.607072114944458
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5756137371063232
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.972 Test Loss: 0.242 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.4773714542388916
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5048465728759766
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5222067832946777
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5355300903320312
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.5029690265655518
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.972 Test Loss: 0.230 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 0.5713057518005371
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.972 Test Loss: 0.229 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.5303127765655518
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.972 Test Loss: 0.228 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 0.5439085960388184
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 0.5454490184783936
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.972 Test Loss: 0.224 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 41 cost time: 0.5384390354156494
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 42 cost time: 0.5154528617858887
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.47328877449035645
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.588752269744873
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.972 Test Loss: 0.220 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.5495598316192627
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.4879772663116455
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.972 Test Loss: 0.216 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 0.5043134689331055
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.972 Test Loss: 0.215 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.5342872142791748
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 0.5071685314178467
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.5582318305969238
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.972 Test Loss: 0.212 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 299084
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8816790580749512
Epoch: 1, Steps: 7 | Train Loss: 2.657 Vali Loss: 2.493 Vali Acc: 0.069 Test Loss: 2.493 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.4760420322418213
Epoch: 2, Steps: 7 | Train Loss: 2.506 Vali Loss: 2.361 Vali Acc: 0.139 Test Loss: 2.361 Test Acc: 0.139
Validation loss decreased (-0.069420 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 0.5144772529602051
Epoch: 3, Steps: 7 | Train Loss: 2.259 Vali Loss: 2.144 Vali Acc: 0.361 Test Loss: 2.144 Test Acc: 0.361
Validation loss decreased (-0.138865 --> -0.361090).  Saving model ...
Epoch: 4 cost time: 0.44818854331970215
Epoch: 4, Steps: 7 | Train Loss: 1.921 Vali Loss: 1.873 Vali Acc: 0.597 Test Loss: 1.873 Test Acc: 0.597
Validation loss decreased (-0.361090 --> -0.597203).  Saving model ...
Epoch: 5 cost time: 0.4293172359466553
Epoch: 5, Steps: 7 | Train Loss: 1.565 Vali Loss: 1.585 Vali Acc: 0.806 Test Loss: 1.585 Test Acc: 0.806
Validation loss decreased (-0.597203 --> -0.805540).  Saving model ...
Epoch: 6 cost time: 0.5181369781494141
Epoch: 6, Steps: 7 | Train Loss: 1.219 Vali Loss: 1.309 Vali Acc: 0.847 Test Loss: 1.309 Test Acc: 0.847
Validation loss decreased (-0.805540 --> -0.847209).  Saving model ...
Epoch: 7 cost time: 0.4830453395843506
Epoch: 7, Steps: 7 | Train Loss: 0.927 Vali Loss: 1.058 Vali Acc: 0.903 Test Loss: 1.058 Test Acc: 0.903
Validation loss decreased (-0.847209 --> -0.902767).  Saving model ...
Epoch: 8 cost time: 0.5431468486785889
Epoch: 8, Steps: 7 | Train Loss: 0.663 Vali Loss: 0.848 Vali Acc: 0.903 Test Loss: 0.848 Test Acc: 0.903
Validation loss decreased (-0.902767 --> -0.902769).  Saving model ...
Epoch: 9 cost time: 0.45444440841674805
Epoch: 9, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.697 Vali Acc: 0.931 Test Loss: 0.697 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930549).  Saving model ...
Epoch: 10 cost time: 0.45039892196655273
Epoch: 10, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.589 Vali Acc: 0.944 Test Loss: 0.589 Test Acc: 0.944
Validation loss decreased (-0.930549 --> -0.944439).  Saving model ...
Epoch: 11 cost time: 0.5081930160522461
Epoch: 11, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.508 Vali Acc: 0.944 Test Loss: 0.508 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 12 cost time: 0.544938325881958
Epoch: 12, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.455 Vali Acc: 0.931 Test Loss: 0.455 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4766578674316406
Epoch: 13, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.423 Vali Acc: 0.931 Test Loss: 0.423 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5586879253387451
Epoch: 14, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.404 Vali Acc: 0.931 Test Loss: 0.404 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5060210227966309
Epoch: 15, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.387 Vali Acc: 0.931 Test Loss: 0.387 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5807845592498779
Epoch: 16, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.373 Vali Acc: 0.944 Test Loss: 0.373 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.5663528442382812
Epoch: 17, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.359 Vali Acc: 0.931 Test Loss: 0.359 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4924006462097168
Epoch: 18, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4860496520996094
Epoch: 19, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.335 Vali Acc: 0.931 Test Loss: 0.335 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5275075435638428
Epoch: 20, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.329 Vali Acc: 0.931 Test Loss: 0.329 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5062482357025146
Epoch: 21, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.59417724609375
Epoch: 22, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.5388729572296143
Epoch: 23, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.49419188499450684
Epoch: 24, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.46970438957214355
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5199670791625977
Epoch: 26, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5323419570922852
Epoch: 27, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5683667659759521
Epoch: 28, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5709199905395508
Epoch: 29, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5064518451690674
Epoch: 30, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.45978283882141113
Epoch: 31, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5191178321838379
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 284492
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5379748344421387
Epoch: 1, Steps: 7 | Train Loss: 2.526 Vali Loss: 2.514 Vali Acc: 0.083 Test Loss: 2.514 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.4780097007751465
Epoch: 2, Steps: 7 | Train Loss: 2.388 Vali Loss: 2.404 Vali Acc: 0.167 Test Loss: 2.404 Test Acc: 0.167
Validation loss decreased (-0.083308 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.536158561706543
Epoch: 3, Steps: 7 | Train Loss: 2.181 Vali Loss: 2.228 Vali Acc: 0.361 Test Loss: 2.228 Test Acc: 0.361
Validation loss decreased (-0.166643 --> -0.361089).  Saving model ...
Epoch: 4 cost time: 0.5107531547546387
Epoch: 4, Steps: 7 | Train Loss: 1.933 Vali Loss: 2.006 Vali Acc: 0.528 Test Loss: 2.006 Test Acc: 0.528
Validation loss decreased (-0.361089 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 0.47831130027770996
Epoch: 5, Steps: 7 | Train Loss: 1.643 Vali Loss: 1.764 Vali Acc: 0.750 Test Loss: 1.764 Test Acc: 0.750
Validation loss decreased (-0.527758 --> -0.749982).  Saving model ...
Epoch: 6 cost time: 0.5518183708190918
Epoch: 6, Steps: 7 | Train Loss: 1.332 Vali Loss: 1.530 Vali Acc: 0.819 Test Loss: 1.530 Test Acc: 0.819
Validation loss decreased (-0.749982 --> -0.819429).  Saving model ...
Epoch: 7 cost time: 0.45965027809143066
Epoch: 7, Steps: 7 | Train Loss: 1.091 Vali Loss: 1.306 Vali Acc: 0.875 Test Loss: 1.306 Test Acc: 0.875
Validation loss decreased (-0.819429 --> -0.874987).  Saving model ...
Epoch: 8 cost time: 0.4469285011291504
Epoch: 8, Steps: 7 | Train Loss: 0.851 Vali Loss: 1.095 Vali Acc: 0.875 Test Loss: 1.095 Test Acc: 0.875
Validation loss decreased (-0.874987 --> -0.874989).  Saving model ...
Epoch: 9 cost time: 0.5156605243682861
Epoch: 9, Steps: 7 | Train Loss: 0.629 Vali Loss: 0.925 Vali Acc: 0.931 Test Loss: 0.925 Test Acc: 0.931
Validation loss decreased (-0.874989 --> -0.930546).  Saving model ...
Epoch: 10 cost time: 0.5788750648498535
Epoch: 10, Steps: 7 | Train Loss: 0.471 Vali Loss: 0.793 Vali Acc: 0.917 Test Loss: 0.793 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4979536533355713
Epoch: 11, Steps: 7 | Train Loss: 0.348 Vali Loss: 0.691 Vali Acc: 0.903 Test Loss: 0.691 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4792304039001465
Epoch: 12, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.605 Vali Acc: 0.903 Test Loss: 0.605 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5075972080230713
Epoch: 13, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.543 Vali Acc: 0.917 Test Loss: 0.543 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5090866088867188
Epoch: 14, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.503 Vali Acc: 0.931 Test Loss: 0.503 Test Acc: 0.931
Validation loss decreased (-0.930546 --> -0.930551).  Saving model ...
Epoch: 15 cost time: 0.4814417362213135
Epoch: 15, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5409433841705322
Epoch: 16, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.462 Vali Acc: 0.917 Test Loss: 0.462 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5574274063110352
Epoch: 17, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.442 Vali Acc: 0.917 Test Loss: 0.442 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5587024688720703
Epoch: 18, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.425 Vali Acc: 0.917 Test Loss: 0.425 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5402235984802246
Epoch: 19, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.406 Vali Acc: 0.917 Test Loss: 0.406 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.536566972732544
Epoch: 20, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5627079010009766
Epoch: 21, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 22 cost time: 0.49567461013793945
Epoch: 22, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.378 Vali Acc: 0.931 Test Loss: 0.378 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.49285173416137695
Epoch: 23, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.367 Vali Acc: 0.931 Test Loss: 0.367 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.6018445491790771
Epoch: 24, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.360 Vali Acc: 0.931 Test Loss: 0.360 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.48930788040161133
Epoch: 25, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.354 Vali Acc: 0.931 Test Loss: 0.354 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.48316144943237305
Epoch: 26, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.346 Vali Acc: 0.931 Test Loss: 0.346 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.4770662784576416
Epoch: 27, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.343 Vali Acc: 0.931 Test Loss: 0.343 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.47380685806274414
Epoch: 28, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 29 cost time: 0.5204157829284668
Epoch: 29, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.42754483222961426
Epoch: 30, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 31 cost time: 0.6573078632354736
Epoch: 31, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 32 cost time: 0.5779175758361816
Epoch: 32, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.321 Vali Acc: 0.931 Test Loss: 0.321 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 33 cost time: 0.4699118137359619
Epoch: 33, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 34 cost time: 0.6125888824462891
Epoch: 34, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 35 cost time: 0.5110626220703125
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 36 cost time: 0.504741907119751
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 37 cost time: 0.47873568534851074
Epoch: 37, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 38 cost time: 0.49712395668029785
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 39 cost time: 0.49428749084472656
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 40 cost time: 0.4823334217071533
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.541614294052124
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5084357261657715
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.524071216583252
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5045444965362549
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5772397518157959
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.4989142417907715
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.5117180347442627
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.5593032836914062
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.4814028739929199
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.4783961772918701
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 279116
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.818598747253418
Epoch: 1, Steps: 7 | Train Loss: 2.453 Vali Loss: 2.411 Vali Acc: 0.153 Test Loss: 2.411 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.5617730617523193
Epoch: 2, Steps: 7 | Train Loss: 2.023 Vali Loss: 2.029 Vali Acc: 0.569 Test Loss: 2.029 Test Acc: 0.569
Validation loss decreased (-0.152754 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 0.5304141044616699
Epoch: 3, Steps: 7 | Train Loss: 1.332 Vali Loss: 1.480 Vali Acc: 0.861 Test Loss: 1.480 Test Acc: 0.861
Validation loss decreased (-0.569424 --> -0.861096).  Saving model ...
Epoch: 4 cost time: 0.5354046821594238
Epoch: 4, Steps: 7 | Train Loss: 0.701 Vali Loss: 0.930 Vali Acc: 0.875 Test Loss: 0.930 Test Acc: 0.875
Validation loss decreased (-0.861096 --> -0.874991).  Saving model ...
Epoch: 5 cost time: 0.5228836536407471
Epoch: 5, Steps: 7 | Train Loss: 0.299 Vali Loss: 0.586 Vali Acc: 0.944 Test Loss: 0.586 Test Acc: 0.944
Validation loss decreased (-0.874991 --> -0.944439).  Saving model ...
Epoch: 6 cost time: 0.5672860145568848
Epoch: 6, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.386 Vali Acc: 0.917 Test Loss: 0.386 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5007085800170898
Epoch: 7, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4904184341430664
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.5607540607452393
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.48619914054870605
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.5201458930969238
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.47904014587402344
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.5014398097991943
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.5262422561645508
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.47593235969543457
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.44938182830810547
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.46090078353881836
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.47356581687927246
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.46779942512512207
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.44403576850891113
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.4707143306732178
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.4889392852783203
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.4787783622741699
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.4604218006134033
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.4818542003631592
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5169532299041748
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5193142890930176
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.43514394760131836
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.42943668365478516
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.41734814643859863
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.48093295097351074
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 0.44053173065185547
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.5169816017150879
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.49547433853149414
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.45596981048583984
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.43569278717041016
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.4578428268432617
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.47399067878723145
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.5665080547332764
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.505608081817627
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.5267329216003418
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.5579524040222168
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.39592742919921875
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.4906604290008545
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.4722170829772949
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6313345432281494
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4820396900177002
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.44881558418273926
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.4765300750732422
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.4415254592895508
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 247660
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8707270622253418
Epoch: 1, Steps: 7 | Train Loss: 2.520 Vali Loss: 2.450 Vali Acc: 0.194 Test Loss: 2.450 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.4512064456939697
Epoch: 2, Steps: 7 | Train Loss: 2.279 Vali Loss: 2.221 Vali Acc: 0.389 Test Loss: 2.221 Test Acc: 0.389
Validation loss decreased (-0.194420 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 0.4875624179840088
Epoch: 3, Steps: 7 | Train Loss: 1.849 Vali Loss: 1.859 Vali Acc: 0.681 Test Loss: 1.859 Test Acc: 0.681
Validation loss decreased (-0.388867 --> -0.680537).  Saving model ...
Epoch: 4 cost time: 0.548515796661377
Epoch: 4, Steps: 7 | Train Loss: 1.329 Vali Loss: 1.429 Vali Acc: 0.806 Test Loss: 1.429 Test Acc: 0.806
Validation loss decreased (-0.680537 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.5316042900085449
Epoch: 5, Steps: 7 | Train Loss: 0.888 Vali Loss: 1.039 Vali Acc: 0.861 Test Loss: 1.039 Test Acc: 0.861
Validation loss decreased (-0.805541 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 0.5358707904815674
Epoch: 6, Steps: 7 | Train Loss: 0.513 Vali Loss: 0.724 Vali Acc: 0.903 Test Loss: 0.724 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 0.5090274810791016
Epoch: 7, Steps: 7 | Train Loss: 0.291 Vali Loss: 0.526 Vali Acc: 0.903 Test Loss: 0.526 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.44945263862609863
Epoch: 8, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.410 Vali Acc: 0.903 Test Loss: 0.410 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.5477454662322998
Epoch: 9, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.5527420043945312
Epoch: 10, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.4772629737854004
Epoch: 11, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.52054762840271
Epoch: 12, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5215966701507568
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.523313045501709
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.483856201171875
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48882007598876953
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5117661952972412
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4391810894012451
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.46582937240600586
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.47754621505737305
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.469862699508667
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5116193294525146
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5399975776672363
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4461390972137451
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 156460
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6704483032226562
Epoch: 1, Steps: 7 | Train Loss: 2.503 Vali Loss: 2.389 Vali Acc: 0.153 Test Loss: 2.389 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.48226428031921387
Epoch: 2, Steps: 7 | Train Loss: 2.349 Vali Loss: 2.215 Vali Acc: 0.458 Test Loss: 2.215 Test Acc: 0.458
Validation loss decreased (-0.152754 --> -0.458311).  Saving model ...
Epoch: 3 cost time: 0.4632601737976074
Epoch: 3, Steps: 7 | Train Loss: 2.022 Vali Loss: 1.953 Vali Acc: 0.667 Test Loss: 1.953 Test Acc: 0.667
Validation loss decreased (-0.458311 --> -0.666647).  Saving model ...
Epoch: 4 cost time: 0.47261571884155273
Epoch: 4, Steps: 7 | Train Loss: 1.681 Vali Loss: 1.641 Vali Acc: 0.806 Test Loss: 1.641 Test Acc: 0.806
Validation loss decreased (-0.666647 --> -0.805539).  Saving model ...
Epoch: 5 cost time: 0.567070484161377
Epoch: 5, Steps: 7 | Train Loss: 1.292 Vali Loss: 1.324 Vali Acc: 0.889 Test Loss: 1.324 Test Acc: 0.889
Validation loss decreased (-0.805539 --> -0.888876).  Saving model ...
Epoch: 6 cost time: 0.49297356605529785
Epoch: 6, Steps: 7 | Train Loss: 0.953 Vali Loss: 1.034 Vali Acc: 0.917 Test Loss: 1.034 Test Acc: 0.917
Validation loss decreased (-0.888876 --> -0.916656).  Saving model ...
Epoch: 7 cost time: 0.49726128578186035
Epoch: 7, Steps: 7 | Train Loss: 0.667 Vali Loss: 0.803 Vali Acc: 0.958 Test Loss: 0.803 Test Acc: 0.958
Validation loss decreased (-0.916656 --> -0.958325).  Saving model ...
Epoch: 8 cost time: 0.4382493495941162
Epoch: 8, Steps: 7 | Train Loss: 0.417 Vali Loss: 0.636 Vali Acc: 0.958 Test Loss: 0.636 Test Acc: 0.958
Validation loss decreased (-0.958325 --> -0.958327).  Saving model ...
Epoch: 9 cost time: 0.5037198066711426
Epoch: 9, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.501 Vali Acc: 0.958 Test Loss: 0.501 Test Acc: 0.958
Validation loss decreased (-0.958327 --> -0.958328).  Saving model ...
Epoch: 10 cost time: 0.46746397018432617
Epoch: 10, Steps: 7 | Train Loss: 0.169 Vali Loss: 0.416 Vali Acc: 0.958 Test Loss: 0.416 Test Acc: 0.958
Validation loss decreased (-0.958328 --> -0.958329).  Saving model ...
Epoch: 11 cost time: 0.544743537902832
Epoch: 11, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.368 Vali Acc: 0.958 Test Loss: 0.368 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958330).  Saving model ...
Epoch: 12 cost time: 0.5434467792510986
Epoch: 12, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.331 Vali Acc: 0.958 Test Loss: 0.331 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 0.6295747756958008
Epoch: 13, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.306 Vali Acc: 0.958 Test Loss: 0.306 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 14 cost time: 0.5725464820861816
Epoch: 14, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.291 Vali Acc: 0.958 Test Loss: 0.291 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 15 cost time: 0.5995867252349854
Epoch: 15, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.276 Vali Acc: 0.958 Test Loss: 0.276 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.5047953128814697
Epoch: 16, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.264 Vali Acc: 0.958 Test Loss: 0.264 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5324831008911133
Epoch: 17, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.501262903213501
Epoch: 18, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5898311138153076
Epoch: 19, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.5718190670013428
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.539445161819458
Epoch: 21, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.4426569938659668
Epoch: 22, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.47353482246398926
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.49443531036376953
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.4602224826812744
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.44666194915771484
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.4951896667480469
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.4171319007873535
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5497326850891113
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.596665620803833
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.4557914733886719
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.5109114646911621
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.4491243362426758
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.47647523880004883
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4757809638977051
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.49680256843566895
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.49137187004089355
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.5217492580413818
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.4567878246307373
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.5168445110321045
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.5681726932525635
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.510822057723999
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.5204811096191406
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.6012835502624512
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.533372163772583
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.6007671356201172
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.5764369964599609
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.5663919448852539
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5340640544891357
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.4856071472167969
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 127468
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.913358211517334
Epoch: 1, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.388 Vali Acc: 0.347 Test Loss: 2.388 Test Acc: 0.347
Validation loss decreased (inf --> -0.347198).  Saving model ...
Epoch: 2 cost time: 0.44768238067626953
Epoch: 2, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.235 Vali Acc: 0.361 Test Loss: 2.235 Test Acc: 0.361
Validation loss decreased (-0.347198 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.4359004497528076
Epoch: 3, Steps: 7 | Train Loss: 2.073 Vali Loss: 2.010 Vali Acc: 0.486 Test Loss: 2.010 Test Acc: 0.486
Validation loss decreased (-0.361089 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 0.4893827438354492
Epoch: 4, Steps: 7 | Train Loss: 1.747 Vali Loss: 1.738 Vali Acc: 0.722 Test Loss: 1.738 Test Acc: 0.722
Validation loss decreased (-0.486091 --> -0.722205).  Saving model ...
Epoch: 5 cost time: 0.5057098865509033
Epoch: 5, Steps: 7 | Train Loss: 1.463 Vali Loss: 1.458 Vali Acc: 0.819 Test Loss: 1.458 Test Acc: 0.819
Validation loss decreased (-0.722205 --> -0.819430).  Saving model ...
Epoch: 6 cost time: 0.4853808879852295
Epoch: 6, Steps: 7 | Train Loss: 1.126 Vali Loss: 1.191 Vali Acc: 0.875 Test Loss: 1.191 Test Acc: 0.875
Validation loss decreased (-0.819430 --> -0.874988).  Saving model ...
Epoch: 7 cost time: 0.3916280269622803
Epoch: 7, Steps: 7 | Train Loss: 0.843 Vali Loss: 0.968 Vali Acc: 0.889 Test Loss: 0.968 Test Acc: 0.889
Validation loss decreased (-0.874988 --> -0.888879).  Saving model ...
Epoch: 8 cost time: 0.5675554275512695
Epoch: 8, Steps: 7 | Train Loss: 0.612 Vali Loss: 0.783 Vali Acc: 0.917 Test Loss: 0.783 Test Acc: 0.917
Validation loss decreased (-0.888879 --> -0.916659).  Saving model ...
Epoch: 9 cost time: 0.4726576805114746
Epoch: 9, Steps: 7 | Train Loss: 0.433 Vali Loss: 0.637 Vali Acc: 0.917 Test Loss: 0.637 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916660).  Saving model ...
Epoch: 10 cost time: 0.503521203994751
Epoch: 10, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.531 Vali Acc: 0.917 Test Loss: 0.531 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916661).  Saving model ...
Epoch: 11 cost time: 0.45797300338745117
Epoch: 11, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.459 Vali Acc: 0.917 Test Loss: 0.459 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 0.5058493614196777
Epoch: 12, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.412 Vali Acc: 0.931 Test Loss: 0.412 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 13 cost time: 0.508493185043335
Epoch: 13, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5326271057128906
Epoch: 14, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5429649353027344
Epoch: 15, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.4570133686065674
Epoch: 16, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.4779510498046875
Epoch: 17, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.4784848690032959
Epoch: 18, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.4646914005279541
Epoch: 19, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.49636340141296387
Epoch: 20, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.6026294231414795
Epoch: 21, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5347228050231934
Epoch: 22, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5462145805358887
Epoch: 23, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.4744887351989746
Epoch: 24, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5541784763336182
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6309592723846436
Epoch: 26, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.4633979797363281
Epoch: 27, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.45561671257019043
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.43476176261901855
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.4302217960357666
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.4330465793609619
Epoch: 31, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.43316006660461426
Epoch: 32, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.43228888511657715
Epoch: 33, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.4856877326965332
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.5279133319854736
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.5418195724487305
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.5043692588806152
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5195720195770264
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5273988246917725
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.4702615737915039
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.4905219078063965
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5270462036132812
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.4578979015350342
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.4274919033050537
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.4380326271057129
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5304832458496094
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.47866296768188477
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.586759090423584
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.4775714874267578
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.5441477298736572
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 112300
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9383645057678223
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.468 Vali Acc: 0.167 Test Loss: 2.468 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.5319108963012695
Epoch: 2, Steps: 7 | Train Loss: 2.449 Vali Loss: 2.373 Vali Acc: 0.250 Test Loss: 2.373 Test Acc: 0.250
Validation loss decreased (-0.166642 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.5174787044525146
Epoch: 3, Steps: 7 | Train Loss: 2.224 Vali Loss: 2.214 Vali Acc: 0.347 Test Loss: 2.214 Test Acc: 0.347
Validation loss decreased (-0.249976 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.516066312789917
Epoch: 4, Steps: 7 | Train Loss: 2.009 Vali Loss: 2.010 Vali Acc: 0.528 Test Loss: 2.010 Test Acc: 0.528
Validation loss decreased (-0.347200 --> -0.527758).  Saving model ...
Epoch: 5 cost time: 0.5691225528717041
Epoch: 5, Steps: 7 | Train Loss: 1.750 Vali Loss: 1.782 Vali Acc: 0.653 Test Loss: 1.782 Test Acc: 0.653
Validation loss decreased (-0.527758 --> -0.652760).  Saving model ...
Epoch: 6 cost time: 0.44893336296081543
Epoch: 6, Steps: 7 | Train Loss: 1.479 Vali Loss: 1.558 Vali Acc: 0.681 Test Loss: 1.558 Test Acc: 0.681
Validation loss decreased (-0.652760 --> -0.680540).  Saving model ...
Epoch: 7 cost time: 0.4305708408355713
Epoch: 7, Steps: 7 | Train Loss: 1.247 Vali Loss: 1.345 Vali Acc: 0.708 Test Loss: 1.345 Test Acc: 0.708
Validation loss decreased (-0.680540 --> -0.708320).  Saving model ...
Epoch: 8 cost time: 0.4746665954589844
Epoch: 8, Steps: 7 | Train Loss: 1.027 Vali Loss: 1.154 Vali Acc: 0.764 Test Loss: 1.154 Test Acc: 0.764
Validation loss decreased (-0.708320 --> -0.763877).  Saving model ...
Epoch: 9 cost time: 0.43025851249694824
Epoch: 9, Steps: 7 | Train Loss: 0.808 Vali Loss: 0.992 Vali Acc: 0.806 Test Loss: 0.992 Test Acc: 0.806
Validation loss decreased (-0.763877 --> -0.805546).  Saving model ...
Epoch: 10 cost time: 0.4614388942718506
Epoch: 10, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.853 Vali Acc: 0.833 Test Loss: 0.853 Test Acc: 0.833
Validation loss decreased (-0.805546 --> -0.833325).  Saving model ...
Epoch: 11 cost time: 0.49793505668640137
Epoch: 11, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.738 Vali Acc: 0.861 Test Loss: 0.738 Test Acc: 0.861
Validation loss decreased (-0.833325 --> -0.861104).  Saving model ...
Epoch: 12 cost time: 0.4381551742553711
Epoch: 12, Steps: 7 | Train Loss: 0.351 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 0.4361751079559326
Epoch: 13, Steps: 7 | Train Loss: 0.266 Vali Loss: 0.575 Vali Acc: 0.889 Test Loss: 0.575 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888883).  Saving model ...
Epoch: 14 cost time: 0.4765613079071045
Epoch: 14, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5120677947998047
Epoch: 15, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4685029983520508
Epoch: 16, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5376479625701904
Epoch: 17, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.511812686920166
Epoch: 18, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 0.5241458415985107
Epoch: 19, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5107221603393555
Epoch: 20, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5740451812744141
Epoch: 21, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4801974296569824
Epoch: 22, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 23 cost time: 0.5814015865325928
Epoch: 23, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5246226787567139
Epoch: 24, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5733199119567871
Epoch: 25, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.4575068950653076
Epoch: 26, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4997875690460205
Epoch: 27, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5540347099304199
Epoch: 28, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5878872871398926
Epoch: 29, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4770946502685547
Epoch: 30, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4230613708496094
Epoch: 31, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5508987903594971
Epoch: 32, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.44242334365844727
Epoch: 33, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5589122772216797
Epoch: 34, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4753708839416504
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 100396
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.701669692993164
Epoch: 1, Steps: 7 | Train Loss: 2.573 Vali Loss: 2.459 Vali Acc: 0.167 Test Loss: 2.459 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.5386078357696533
Epoch: 2, Steps: 7 | Train Loss: 2.432 Vali Loss: 2.380 Vali Acc: 0.250 Test Loss: 2.380 Test Acc: 0.250
Validation loss decreased (-0.166642 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.4577968120574951
Epoch: 3, Steps: 7 | Train Loss: 2.309 Vali Loss: 2.257 Vali Acc: 0.333 Test Loss: 2.257 Test Acc: 0.333
Validation loss decreased (-0.249976 --> -0.333311).  Saving model ...
Epoch: 4 cost time: 0.4987165927886963
Epoch: 4, Steps: 7 | Train Loss: 2.152 Vali Loss: 2.104 Vali Acc: 0.542 Test Loss: 2.104 Test Acc: 0.542
Validation loss decreased (-0.333311 --> -0.541646).  Saving model ...
Epoch: 5 cost time: 0.43905210494995117
Epoch: 5, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.926 Vali Acc: 0.653 Test Loss: 1.926 Test Acc: 0.653
Validation loss decreased (-0.541646 --> -0.652759).  Saving model ...
Epoch: 6 cost time: 0.43310070037841797
Epoch: 6, Steps: 7 | Train Loss: 1.736 Vali Loss: 1.741 Vali Acc: 0.778 Test Loss: 1.741 Test Acc: 0.778
Validation loss decreased (-0.652759 --> -0.777760).  Saving model ...
Epoch: 7 cost time: 0.4535815715789795
Epoch: 7, Steps: 7 | Train Loss: 1.521 Vali Loss: 1.557 Vali Acc: 0.833 Test Loss: 1.557 Test Acc: 0.833
Validation loss decreased (-0.777760 --> -0.833318).  Saving model ...
Epoch: 8 cost time: 0.5703949928283691
Epoch: 8, Steps: 7 | Train Loss: 1.305 Vali Loss: 1.384 Vali Acc: 0.847 Test Loss: 1.384 Test Acc: 0.847
Validation loss decreased (-0.833318 --> -0.847208).  Saving model ...
Epoch: 9 cost time: 0.46022844314575195
Epoch: 9, Steps: 7 | Train Loss: 1.112 Vali Loss: 1.220 Vali Acc: 0.875 Test Loss: 1.220 Test Acc: 0.875
Validation loss decreased (-0.847208 --> -0.874988).  Saving model ...
Epoch: 10 cost time: 0.40837621688842773
Epoch: 10, Steps: 7 | Train Loss: 0.906 Vali Loss: 1.072 Vali Acc: 0.875 Test Loss: 1.072 Test Acc: 0.875
Validation loss decreased (-0.874988 --> -0.874989).  Saving model ...
Epoch: 11 cost time: 0.381732702255249
Epoch: 11, Steps: 7 | Train Loss: 0.766 Vali Loss: 0.936 Vali Acc: 0.875 Test Loss: 0.936 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.4371638298034668
Epoch: 12, Steps: 7 | Train Loss: 0.604 Vali Loss: 0.815 Vali Acc: 0.889 Test Loss: 0.815 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888881).  Saving model ...
Epoch: 13 cost time: 0.3761012554168701
Epoch: 13, Steps: 7 | Train Loss: 0.490 Vali Loss: 0.720 Vali Acc: 0.917 Test Loss: 0.720 Test Acc: 0.917
Validation loss decreased (-0.888881 --> -0.916659).  Saving model ...
Epoch: 14 cost time: 0.4006826877593994
Epoch: 14, Steps: 7 | Train Loss: 0.387 Vali Loss: 0.645 Vali Acc: 0.917 Test Loss: 0.645 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916660).  Saving model ...
Epoch: 15 cost time: 0.4838738441467285
Epoch: 15, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.587 Vali Acc: 0.903 Test Loss: 0.587 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4236726760864258
Epoch: 16, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.546 Vali Acc: 0.903 Test Loss: 0.546 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.41191601753234863
Epoch: 17, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.510 Vali Acc: 0.917 Test Loss: 0.510 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916662).  Saving model ...
Epoch: 18 cost time: 0.4447488784790039
Epoch: 18, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 0.5889706611633301
Epoch: 19, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.454 Vali Acc: 0.917 Test Loss: 0.454 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 20 cost time: 0.4487898349761963
Epoch: 20, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.439 Vali Acc: 0.917 Test Loss: 0.439 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 0.4480705261230469
Epoch: 21, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 0.429135799407959
Epoch: 22, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.407 Vali Acc: 0.917 Test Loss: 0.407 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.515937089920044
Epoch: 23, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.394 Vali Acc: 0.931 Test Loss: 0.394 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.42080187797546387
Epoch: 24, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.378 Vali Acc: 0.931 Test Loss: 0.378 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.45257091522216797
Epoch: 25, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.369 Vali Acc: 0.931 Test Loss: 0.369 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.4838693141937256
Epoch: 26, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.359 Vali Acc: 0.931 Test Loss: 0.359 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.5004842281341553
Epoch: 27, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.353 Vali Acc: 0.931 Test Loss: 0.353 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.4073340892791748
Epoch: 28, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.344 Vali Acc: 0.931 Test Loss: 0.344 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 29 cost time: 0.42848825454711914
Epoch: 29, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.451768159866333
Epoch: 30, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 31 cost time: 0.45665502548217773
Epoch: 31, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 32 cost time: 0.5303409099578857
Epoch: 32, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 33 cost time: 0.49517107009887695
Epoch: 33, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 34 cost time: 0.4635176658630371
Epoch: 34, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 35 cost time: 0.5089795589447021
Epoch: 35, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.4351050853729248
Epoch: 36, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.4663255214691162
Epoch: 37, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.39829540252685547
Epoch: 38, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.48734140396118164
Epoch: 39, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.5064816474914551
Epoch: 40, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.49697113037109375
Epoch: 41, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.3953876495361328
Epoch: 42, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.46922922134399414
Epoch: 43, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.3989686965942383
Epoch: 44, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5065522193908691
Epoch: 45, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.457611083984375
Epoch: 46, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.40874290466308594
Epoch: 47, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.4401681423187256
Epoch: 48, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.46920251846313477
Epoch: 49, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.4582085609436035
Epoch: 50, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 93100
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.726686716079712
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.534 Vali Acc: 0.056 Test Loss: 2.534 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.48037052154541016
Epoch: 2, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.473 Vali Acc: 0.083 Test Loss: 2.473 Test Acc: 0.083
Validation loss decreased (-0.055530 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 0.44289731979370117
Epoch: 3, Steps: 7 | Train Loss: 2.397 Vali Loss: 2.362 Vali Acc: 0.222 Test Loss: 2.362 Test Acc: 0.222
Validation loss decreased (-0.083309 --> -0.222199).  Saving model ...
Epoch: 4 cost time: 0.4445066452026367
Epoch: 4, Steps: 7 | Train Loss: 2.211 Vali Loss: 2.216 Vali Acc: 0.361 Test Loss: 2.216 Test Acc: 0.361
Validation loss decreased (-0.222199 --> -0.361089).  Saving model ...
Epoch: 5 cost time: 0.4393928050994873
Epoch: 5, Steps: 7 | Train Loss: 2.056 Vali Loss: 2.057 Vali Acc: 0.472 Test Loss: 2.057 Test Acc: 0.472
Validation loss decreased (-0.361089 --> -0.472202).  Saving model ...
Epoch: 6 cost time: 0.44188857078552246
Epoch: 6, Steps: 7 | Train Loss: 1.845 Vali Loss: 1.889 Vali Acc: 0.667 Test Loss: 1.889 Test Acc: 0.667
Validation loss decreased (-0.472202 --> -0.666648).  Saving model ...
Epoch: 7 cost time: 0.401630163192749
Epoch: 7, Steps: 7 | Train Loss: 1.638 Vali Loss: 1.721 Vali Acc: 0.736 Test Loss: 1.721 Test Acc: 0.736
Validation loss decreased (-0.666648 --> -0.736094).  Saving model ...
Epoch: 8 cost time: 0.4233856201171875
Epoch: 8, Steps: 7 | Train Loss: 1.468 Vali Loss: 1.562 Vali Acc: 0.750 Test Loss: 1.562 Test Acc: 0.750
Validation loss decreased (-0.736094 --> -0.749984).  Saving model ...
Epoch: 9 cost time: 0.40213775634765625
Epoch: 9, Steps: 7 | Train Loss: 1.268 Vali Loss: 1.401 Vali Acc: 0.778 Test Loss: 1.401 Test Acc: 0.778
Validation loss decreased (-0.749984 --> -0.777764).  Saving model ...
Epoch: 10 cost time: 0.5505740642547607
Epoch: 10, Steps: 7 | Train Loss: 1.077 Vali Loss: 1.256 Vali Acc: 0.792 Test Loss: 1.256 Test Acc: 0.792
Validation loss decreased (-0.777764 --> -0.791654).  Saving model ...
Epoch: 11 cost time: 0.4519045352935791
Epoch: 11, Steps: 7 | Train Loss: 0.920 Vali Loss: 1.123 Vali Acc: 0.806 Test Loss: 1.123 Test Acc: 0.806
Validation loss decreased (-0.791654 --> -0.805544).  Saving model ...
Epoch: 12 cost time: 0.5053305625915527
Epoch: 12, Steps: 7 | Train Loss: 0.748 Vali Loss: 1.007 Vali Acc: 0.819 Test Loss: 1.007 Test Acc: 0.819
Validation loss decreased (-0.805544 --> -0.819434).  Saving model ...
Epoch: 13 cost time: 0.5062568187713623
Epoch: 13, Steps: 7 | Train Loss: 0.632 Vali Loss: 0.906 Vali Acc: 0.819 Test Loss: 0.906 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819435).  Saving model ...
Epoch: 14 cost time: 0.4136214256286621
Epoch: 14, Steps: 7 | Train Loss: 0.526 Vali Loss: 0.821 Vali Acc: 0.875 Test Loss: 0.821 Test Acc: 0.875
Validation loss decreased (-0.819435 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.540600061416626
Epoch: 15, Steps: 7 | Train Loss: 0.423 Vali Loss: 0.747 Vali Acc: 0.875 Test Loss: 0.747 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.4947018623352051
Epoch: 16, Steps: 7 | Train Loss: 0.353 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.4283139705657959
Epoch: 17, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5010342597961426
Epoch: 18, Steps: 7 | Train Loss: 0.261 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 0.5554707050323486
Epoch: 19, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 0.5129711627960205
Epoch: 20, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.553 Vali Acc: 0.889 Test Loss: 0.553 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 21 cost time: 0.5427646636962891
Epoch: 21, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.529 Vali Acc: 0.889 Test Loss: 0.529 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 0.5000979900360107
Epoch: 22, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 23 cost time: 0.5394413471221924
Epoch: 23, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 24 cost time: 0.48633646965026855
Epoch: 24, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 25 cost time: 0.45517611503601074
Epoch: 25, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 26 cost time: 0.47832655906677246
Epoch: 26, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 0.4384617805480957
Epoch: 27, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.440 Vali Acc: 0.903 Test Loss: 0.440 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 28 cost time: 0.5528073310852051
Epoch: 28, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.429 Vali Acc: 0.903 Test Loss: 0.429 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 29 cost time: 0.49469947814941406
Epoch: 29, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.46544861793518066
Epoch: 30, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.410 Vali Acc: 0.903 Test Loss: 0.410 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 31 cost time: 0.4981844425201416
Epoch: 31, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.408 Vali Acc: 0.903 Test Loss: 0.408 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.4796478748321533
Epoch: 32, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.49172353744506836
Epoch: 33, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5066595077514648
Epoch: 34, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 35 cost time: 0.4598863124847412
Epoch: 35, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 36 cost time: 0.45658183097839355
Epoch: 36, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.48561644554138184
Epoch: 37, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4732849597930908
Epoch: 38, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5050969123840332
Epoch: 39, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4353461265563965
Epoch: 40, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.53887939453125
Epoch: 41, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5900568962097168
Epoch: 42, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5323522090911865
Epoch: 43, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.44878315925598145
Epoch: 44, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.3953518867492676
Epoch: 45, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 90412
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1174628734588623
Epoch: 1, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.473 Vali Acc: 0.069 Test Loss: 2.473 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.6444711685180664
Epoch: 2, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.366 Vali Acc: 0.403 Test Loss: 2.366 Test Acc: 0.403
Validation loss decreased (-0.069420 --> -0.402754).  Saving model ...
Epoch: 3 cost time: 0.6630833148956299
Epoch: 3, Steps: 7 | Train Loss: 1.996 Vali Loss: 2.141 Vali Acc: 0.639 Test Loss: 2.141 Test Acc: 0.639
Validation loss decreased (-0.402754 --> -0.638867).  Saving model ...
Epoch: 4 cost time: 0.7171463966369629
Epoch: 4, Steps: 7 | Train Loss: 1.542 Vali Loss: 1.766 Vali Acc: 0.778 Test Loss: 1.766 Test Acc: 0.778
Validation loss decreased (-0.638867 --> -0.777760).  Saving model ...
Epoch: 5 cost time: 0.6929006576538086
Epoch: 5, Steps: 7 | Train Loss: 1.059 Vali Loss: 1.282 Vali Acc: 0.833 Test Loss: 1.282 Test Acc: 0.833
Validation loss decreased (-0.777760 --> -0.833321).  Saving model ...
Epoch: 6 cost time: 0.6666288375854492
Epoch: 6, Steps: 7 | Train Loss: 0.599 Vali Loss: 0.821 Vali Acc: 0.861 Test Loss: 0.821 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.6409335136413574
Epoch: 7, Steps: 7 | Train Loss: 0.271 Vali Loss: 0.514 Vali Acc: 0.931 Test Loss: 0.514 Test Acc: 0.931
Validation loss decreased (-0.861103 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.5697009563446045
Epoch: 8, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.379 Vali Acc: 0.931 Test Loss: 0.379 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.702019214630127
Epoch: 9, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.6333920955657959
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.257 Vali Acc: 0.958 Test Loss: 0.257 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.6646192073822021
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.972 Test Loss: 0.239 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 0.5739617347717285
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.5801577568054199
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.668731689453125
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6418495178222656
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6003646850585938
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7061450481414795
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.675199031829834
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5805139541625977
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6604273319244385
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.679145336151123
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7091176509857178
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 792684
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8574025630950928
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.494 Vali Acc: 0.056 Test Loss: 2.494 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.6254613399505615
Epoch: 2, Steps: 7 | Train Loss: 2.416 Vali Loss: 2.407 Vali Acc: 0.194 Test Loss: 2.407 Test Acc: 0.194
Validation loss decreased (-0.055531 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.5779082775115967
Epoch: 3, Steps: 7 | Train Loss: 2.177 Vali Loss: 2.230 Vali Acc: 0.556 Test Loss: 2.230 Test Acc: 0.556
Validation loss decreased (-0.194420 --> -0.555533).  Saving model ...
Epoch: 4 cost time: 0.5566623210906982
Epoch: 4, Steps: 7 | Train Loss: 1.882 Vali Loss: 1.957 Vali Acc: 0.736 Test Loss: 1.957 Test Acc: 0.736
Validation loss decreased (-0.555533 --> -0.736092).  Saving model ...
Epoch: 5 cost time: 0.5443344116210938
Epoch: 5, Steps: 7 | Train Loss: 1.493 Vali Loss: 1.599 Vali Acc: 0.806 Test Loss: 1.599 Test Acc: 0.806
Validation loss decreased (-0.736092 --> -0.805540).  Saving model ...
Epoch: 6 cost time: 0.5515668392181396
Epoch: 6, Steps: 7 | Train Loss: 1.104 Vali Loss: 1.203 Vali Acc: 0.931 Test Loss: 1.203 Test Acc: 0.931
Validation loss decreased (-0.805540 --> -0.930544).  Saving model ...
Epoch: 7 cost time: 0.5620765686035156
Epoch: 7, Steps: 7 | Train Loss: 0.728 Vali Loss: 0.845 Vali Acc: 0.944 Test Loss: 0.845 Test Acc: 0.944
Validation loss decreased (-0.930544 --> -0.944436).  Saving model ...
Epoch: 8 cost time: 0.7102396488189697
Epoch: 8, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.577 Vali Acc: 0.917 Test Loss: 0.577 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5764846801757812
Epoch: 9, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.421 Vali Acc: 0.917 Test Loss: 0.421 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6520655155181885
Epoch: 10, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5948834419250488
Epoch: 11, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.297 Vali Acc: 0.958 Test Loss: 0.297 Test Acc: 0.958
Validation loss decreased (-0.944436 --> -0.958330).  Saving model ...
Epoch: 12 cost time: 0.6184003353118896
Epoch: 12, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.267 Vali Acc: 0.972 Test Loss: 0.267 Test Acc: 0.972
Validation loss decreased (-0.958330 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.6619787216186523
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6303014755249023
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5803325176239014
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.626568078994751
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6214261054992676
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7337009906768799
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7161769866943359
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6933567523956299
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6738021373748779
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7120528221130371
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 701484
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.924778938293457
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.483 Vali Acc: 0.125 Test Loss: 2.483 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.731468915939331
Epoch: 2, Steps: 7 | Train Loss: 2.418 Vali Loss: 2.414 Vali Acc: 0.208 Test Loss: 2.414 Test Acc: 0.208
Validation loss decreased (-0.124975 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 0.5570564270019531
Epoch: 3, Steps: 7 | Train Loss: 2.253 Vali Loss: 2.280 Vali Acc: 0.458 Test Loss: 2.280 Test Acc: 0.458
Validation loss decreased (-0.208309 --> -0.458311).  Saving model ...
Epoch: 4 cost time: 0.6033151149749756
Epoch: 4, Steps: 7 | Train Loss: 2.027 Vali Loss: 2.088 Vali Acc: 0.625 Test Loss: 2.088 Test Acc: 0.625
Validation loss decreased (-0.458311 --> -0.624979).  Saving model ...
Epoch: 5 cost time: 0.527951717376709
Epoch: 5, Steps: 7 | Train Loss: 1.777 Vali Loss: 1.840 Vali Acc: 0.819 Test Loss: 1.840 Test Acc: 0.819
Validation loss decreased (-0.624979 --> -0.819426).  Saving model ...
Epoch: 6 cost time: 0.5436995029449463
Epoch: 6, Steps: 7 | Train Loss: 1.466 Vali Loss: 1.545 Vali Acc: 0.861 Test Loss: 1.545 Test Acc: 0.861
Validation loss decreased (-0.819426 --> -0.861096).  Saving model ...
Epoch: 7 cost time: 0.5387563705444336
Epoch: 7, Steps: 7 | Train Loss: 1.116 Vali Loss: 1.225 Vali Acc: 0.903 Test Loss: 1.225 Test Acc: 0.903
Validation loss decreased (-0.861096 --> -0.902766).  Saving model ...
Epoch: 8 cost time: 0.5539653301239014
Epoch: 8, Steps: 7 | Train Loss: 0.815 Vali Loss: 0.910 Vali Acc: 0.931 Test Loss: 0.910 Test Acc: 0.931
Validation loss decreased (-0.902766 --> -0.930546).  Saving model ...
Epoch: 9 cost time: 0.5688319206237793
Epoch: 9, Steps: 7 | Train Loss: 0.535 Vali Loss: 0.656 Vali Acc: 0.958 Test Loss: 0.656 Test Acc: 0.958
Validation loss decreased (-0.930546 --> -0.958327).  Saving model ...
Epoch: 10 cost time: 0.6988222599029541
Epoch: 10, Steps: 7 | Train Loss: 0.310 Vali Loss: 0.491 Vali Acc: 0.972 Test Loss: 0.491 Test Acc: 0.972
Validation loss decreased (-0.958327 --> -0.972217).  Saving model ...
Epoch: 11 cost time: 0.6584658622741699
Epoch: 11, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.390 Vali Acc: 0.972 Test Loss: 0.390 Test Acc: 0.972
Validation loss decreased (-0.972217 --> -0.972218).  Saving model ...
Epoch: 12 cost time: 0.6315886974334717
Epoch: 12, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.327 Vali Acc: 0.972 Test Loss: 0.327 Test Acc: 0.972
Validation loss decreased (-0.972218 --> -0.972219).  Saving model ...
Epoch: 13 cost time: 0.5836198329925537
Epoch: 13, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.293 Vali Acc: 0.972 Test Loss: 0.293 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 14 cost time: 0.6227571964263916
Epoch: 14, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.972 Test Loss: 0.277 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 15 cost time: 0.5871596336364746
Epoch: 15, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.258 Vali Acc: 0.972 Test Loss: 0.258 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 0.6609680652618408
Epoch: 16, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.241 Vali Acc: 0.972 Test Loss: 0.241 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.6323850154876709
Epoch: 17, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.5689303874969482
Epoch: 18, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.6029202938079834
Epoch: 19, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.5448653697967529
Epoch: 20, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.972 Test Loss: 0.216 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.622093915939331
Epoch: 21, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.6527597904205322
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.6245927810668945
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.6181247234344482
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 25 cost time: 0.571911096572876
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.642707109451294
Epoch: 26, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6354038715362549
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 28 cost time: 0.6946506500244141
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 29 cost time: 0.6228377819061279
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 30 cost time: 0.6616096496582031
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 31 cost time: 0.6770622730255127
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.6002345085144043
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.6463871002197266
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.643592119216919
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6137714385986328
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.6112587451934814
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 0.5810253620147705
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.7012858390808105
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 39 cost time: 0.6873948574066162
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 40 cost time: 0.6196568012237549
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 41 cost time: 0.7195236682891846
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 42 cost time: 0.5821099281311035
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 43 cost time: 0.6201395988464355
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 44 cost time: 0.575793981552124
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 45 cost time: 0.6421196460723877
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 46 cost time: 0.5871286392211914
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 47 cost time: 0.7353622913360596
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 48 cost time: 0.5972428321838379
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 49 cost time: 0.6576786041259766
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 50 cost time: 0.5676233768463135
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 674796
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0212550163269043
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.454 Vali Acc: 0.028 Test Loss: 2.454 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.6423275470733643
Epoch: 2, Steps: 7 | Train Loss: 2.412 Vali Loss: 2.392 Vali Acc: 0.111 Test Loss: 2.392 Test Acc: 0.111
Validation loss decreased (-0.027753 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.6520843505859375
Epoch: 3, Steps: 7 | Train Loss: 2.283 Vali Loss: 2.279 Vali Acc: 0.403 Test Loss: 2.279 Test Acc: 0.403
Validation loss decreased (-0.111087 --> -0.402755).  Saving model ...
Epoch: 4 cost time: 0.6525156497955322
Epoch: 4, Steps: 7 | Train Loss: 2.085 Vali Loss: 2.119 Vali Acc: 0.597 Test Loss: 2.119 Test Acc: 0.597
Validation loss decreased (-0.402755 --> -0.597201).  Saving model ...
Epoch: 5 cost time: 0.5786278247833252
Epoch: 5, Steps: 7 | Train Loss: 1.885 Vali Loss: 1.926 Vali Acc: 0.694 Test Loss: 1.926 Test Acc: 0.694
Validation loss decreased (-0.597201 --> -0.694425).  Saving model ...
Epoch: 6 cost time: 0.637033224105835
Epoch: 6, Steps: 7 | Train Loss: 1.635 Vali Loss: 1.699 Vali Acc: 0.764 Test Loss: 1.699 Test Acc: 0.764
Validation loss decreased (-0.694425 --> -0.763872).  Saving model ...
Epoch: 7 cost time: 0.6289217472076416
Epoch: 7, Steps: 7 | Train Loss: 1.360 Vali Loss: 1.437 Vali Acc: 0.806 Test Loss: 1.437 Test Acc: 0.806
Validation loss decreased (-0.763872 --> -0.805541).  Saving model ...
Epoch: 8 cost time: 0.5639376640319824
Epoch: 8, Steps: 7 | Train Loss: 1.058 Vali Loss: 1.164 Vali Acc: 0.847 Test Loss: 1.164 Test Acc: 0.847
Validation loss decreased (-0.805541 --> -0.847211).  Saving model ...
Epoch: 9 cost time: 0.5677430629730225
Epoch: 9, Steps: 7 | Train Loss: 0.763 Vali Loss: 0.889 Vali Acc: 0.861 Test Loss: 0.889 Test Acc: 0.861
Validation loss decreased (-0.847211 --> -0.861102).  Saving model ...
Epoch: 10 cost time: 0.6563782691955566
Epoch: 10, Steps: 7 | Train Loss: 0.511 Vali Loss: 0.668 Vali Acc: 0.917 Test Loss: 0.668 Test Acc: 0.917
Validation loss decreased (-0.861102 --> -0.916660).  Saving model ...
Epoch: 11 cost time: 0.6107182502746582
Epoch: 11, Steps: 7 | Train Loss: 0.329 Vali Loss: 0.526 Vali Acc: 0.903 Test Loss: 0.526 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5801258087158203
Epoch: 12, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.446 Vali Acc: 0.931 Test Loss: 0.446 Test Acc: 0.931
Validation loss decreased (-0.916660 --> -0.930551).  Saving model ...
Epoch: 13 cost time: 0.7256426811218262
Epoch: 13, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6769194602966309
Epoch: 14, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6070101261138916
Epoch: 15, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7632768154144287
Epoch: 16, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6867403984069824
Epoch: 17, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.647352933883667
Epoch: 18, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.579808235168457
Epoch: 19, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5955805778503418
Epoch: 20, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.6892540454864502
Epoch: 21, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5377423763275146
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6060943603515625
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6030001640319824
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5458776950836182
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.5816683769226074
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.61354660987854
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6333024501800537
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.7014541625976562
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.7026729583740234
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6448791027069092
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7113456726074219
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6398565769195557
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6825587749481201
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.7040035724639893
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.6726646423339844
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.6652545928955078
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6639969348907471
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.7319798469543457
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.6526899337768555
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6352055072784424
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5955562591552734
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.6510813236236572
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.6604092121124268
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5341293811798096
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7197322845458984
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6841318607330322
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.6911063194274902
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.6135306358337402
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.633690595626831
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 657324
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.891258716583252
Epoch: 1, Steps: 7 | Train Loss: 2.495 Vali Loss: 2.467 Vali Acc: 0.083 Test Loss: 2.467 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.6913199424743652
Epoch: 2, Steps: 7 | Train Loss: 2.425 Vali Loss: 2.415 Vali Acc: 0.208 Test Loss: 2.415 Test Acc: 0.208
Validation loss decreased (-0.083309 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 0.6474828720092773
Epoch: 3, Steps: 7 | Train Loss: 2.310 Vali Loss: 2.317 Vali Acc: 0.403 Test Loss: 2.317 Test Acc: 0.403
Validation loss decreased (-0.208309 --> -0.402755).  Saving model ...
Epoch: 4 cost time: 0.7282283306121826
Epoch: 4, Steps: 7 | Train Loss: 2.134 Vali Loss: 2.177 Vali Acc: 0.583 Test Loss: 2.177 Test Acc: 0.583
Validation loss decreased (-0.402755 --> -0.583312).  Saving model ...
Epoch: 5 cost time: 0.5575666427612305
Epoch: 5, Steps: 7 | Train Loss: 1.962 Vali Loss: 2.001 Vali Acc: 0.722 Test Loss: 2.001 Test Acc: 0.722
Validation loss decreased (-0.583312 --> -0.722202).  Saving model ...
Epoch: 6 cost time: 0.6765692234039307
Epoch: 6, Steps: 7 | Train Loss: 1.745 Vali Loss: 1.796 Vali Acc: 0.792 Test Loss: 1.796 Test Acc: 0.792
Validation loss decreased (-0.722202 --> -0.791649).  Saving model ...
Epoch: 7 cost time: 0.6094627380371094
Epoch: 7, Steps: 7 | Train Loss: 1.518 Vali Loss: 1.562 Vali Acc: 0.806 Test Loss: 1.562 Test Acc: 0.806
Validation loss decreased (-0.791649 --> -0.805540).  Saving model ...
Epoch: 8 cost time: 0.6519303321838379
Epoch: 8, Steps: 7 | Train Loss: 1.240 Vali Loss: 1.310 Vali Acc: 0.847 Test Loss: 1.310 Test Acc: 0.847
Validation loss decreased (-0.805540 --> -0.847209).  Saving model ...
Epoch: 9 cost time: 0.5668556690216064
Epoch: 9, Steps: 7 | Train Loss: 0.962 Vali Loss: 1.051 Vali Acc: 0.889 Test Loss: 1.051 Test Acc: 0.889
Validation loss decreased (-0.847209 --> -0.888878).  Saving model ...
Epoch: 10 cost time: 0.5137262344360352
Epoch: 10, Steps: 7 | Train Loss: 0.704 Vali Loss: 0.837 Vali Acc: 0.917 Test Loss: 0.837 Test Acc: 0.917
Validation loss decreased (-0.888878 --> -0.916658).  Saving model ...
Epoch: 11 cost time: 0.6089911460876465
Epoch: 11, Steps: 7 | Train Loss: 0.498 Vali Loss: 0.660 Vali Acc: 0.903 Test Loss: 0.660 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6650879383087158
Epoch: 12, Steps: 7 | Train Loss: 0.337 Vali Loss: 0.525 Vali Acc: 0.931 Test Loss: 0.525 Test Acc: 0.931
Validation loss decreased (-0.916658 --> -0.930550).  Saving model ...
Epoch: 13 cost time: 0.5849223136901855
Epoch: 13, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.442 Vali Acc: 0.944 Test Loss: 0.442 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.5647680759429932
Epoch: 14, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.387 Vali Acc: 0.944 Test Loss: 0.387 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.6097614765167236
Epoch: 15, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.6111769676208496
Epoch: 16, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.6498081684112549
Epoch: 17, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.6172091960906982
Epoch: 18, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.662663459777832
Epoch: 19, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7165660858154297
Epoch: 20, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6717751026153564
Epoch: 21, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6419556140899658
Epoch: 22, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6364657878875732
Epoch: 23, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6592531204223633
Epoch: 24, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6217536926269531
Epoch: 25, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6397671699523926
Epoch: 26, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5678427219390869
Epoch: 27, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.674147367477417
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6284389495849609
Epoch: 29, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5758514404296875
Epoch: 30, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5465891361236572
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6152405738830566
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.657264232635498
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.5824737548828125
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.572779655456543
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.6426408290863037
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.6520462036132812
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6338367462158203
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.5466725826263428
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.5655593872070312
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.5463905334472656
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.599416971206665
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.6920967102050781
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.58408522605896
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.6474227905273438
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.6221120357513428
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.6412668228149414
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5655715465545654
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.6497766971588135
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.6176342964172363
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 650028
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9140987396240234
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.495 Vali Acc: 0.125 Test Loss: 2.495 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7085189819335938
Epoch: 2, Steps: 7 | Train Loss: 2.465 Vali Loss: 2.458 Vali Acc: 0.139 Test Loss: 2.458 Test Acc: 0.139
Validation loss decreased (-0.124975 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 0.6455478668212891
Epoch: 3, Steps: 7 | Train Loss: 2.373 Vali Loss: 2.383 Vali Acc: 0.236 Test Loss: 2.383 Test Acc: 0.236
Validation loss decreased (-0.138864 --> -0.236087).  Saving model ...
Epoch: 4 cost time: 0.6145594120025635
Epoch: 4, Steps: 7 | Train Loss: 2.239 Vali Loss: 2.277 Vali Acc: 0.375 Test Loss: 2.277 Test Acc: 0.375
Validation loss decreased (-0.236087 --> -0.374977).  Saving model ...
Epoch: 5 cost time: 0.6488168239593506
Epoch: 5, Steps: 7 | Train Loss: 2.087 Vali Loss: 2.144 Vali Acc: 0.514 Test Loss: 2.144 Test Acc: 0.514
Validation loss decreased (-0.374977 --> -0.513867).  Saving model ...
Epoch: 6 cost time: 0.6542456150054932
Epoch: 6, Steps: 7 | Train Loss: 1.895 Vali Loss: 1.981 Vali Acc: 0.667 Test Loss: 1.981 Test Acc: 0.667
Validation loss decreased (-0.513867 --> -0.666647).  Saving model ...
Epoch: 7 cost time: 0.6662032604217529
Epoch: 7, Steps: 7 | Train Loss: 1.691 Vali Loss: 1.797 Vali Acc: 0.750 Test Loss: 1.797 Test Acc: 0.750
Validation loss decreased (-0.666647 --> -0.749982).  Saving model ...
Epoch: 8 cost time: 0.6632575988769531
Epoch: 8, Steps: 7 | Train Loss: 1.493 Vali Loss: 1.585 Vali Acc: 0.792 Test Loss: 1.585 Test Acc: 0.792
Validation loss decreased (-0.749982 --> -0.791651).  Saving model ...
Epoch: 9 cost time: 0.6492114067077637
Epoch: 9, Steps: 7 | Train Loss: 1.246 Vali Loss: 1.363 Vali Acc: 0.778 Test Loss: 1.363 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.659043550491333
Epoch: 10, Steps: 7 | Train Loss: 0.995 Vali Loss: 1.133 Vali Acc: 0.833 Test Loss: 1.133 Test Acc: 0.833
Validation loss decreased (-0.791651 --> -0.833322).  Saving model ...
Epoch: 11 cost time: 0.6839263439178467
Epoch: 11, Steps: 7 | Train Loss: 0.778 Vali Loss: 0.943 Vali Acc: 0.833 Test Loss: 0.943 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833324).  Saving model ...
Epoch: 12 cost time: 0.5947167873382568
Epoch: 12, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.776 Vali Acc: 0.875 Test Loss: 0.776 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.6377387046813965
Epoch: 13, Steps: 7 | Train Loss: 0.423 Vali Loss: 0.645 Vali Acc: 0.889 Test Loss: 0.645 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888882).  Saving model ...
Epoch: 14 cost time: 0.5922839641571045
Epoch: 14, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902772).  Saving model ...
Epoch: 15 cost time: 0.5670409202575684
Epoch: 15, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 0.5684032440185547
Epoch: 16, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.441 Vali Acc: 0.889 Test Loss: 0.441 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6677258014678955
Epoch: 17, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.396 Vali Acc: 0.917 Test Loss: 0.396 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.6423897743225098
Epoch: 18, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.6490640640258789
Epoch: 19, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.5888667106628418
Epoch: 20, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.6084072589874268
Epoch: 21, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.6338050365447998
Epoch: 22, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.6244363784790039
Epoch: 23, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.6101946830749512
Epoch: 24, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6224701404571533
Epoch: 25, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6196775436401367
Epoch: 26, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.7604026794433594
Epoch: 27, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6253037452697754
Epoch: 28, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.662463903427124
Epoch: 29, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6177670955657959
Epoch: 30, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7039299011230469
Epoch: 31, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.6772441864013672
Epoch: 32, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7130095958709717
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6023530960083008
Epoch: 34, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.6425371170043945
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6165285110473633
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.5811629295349121
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.6256191730499268
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6780836582183838
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.6616301536560059
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.6314306259155273
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.6854302883148193
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.657508134841919
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.6518869400024414
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6912755966186523
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6957695484161377
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6522290706634521
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.6830778121948242
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.6521017551422119
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.631472110748291
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 642732
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0335533618927
Epoch: 1, Steps: 7 | Train Loss: 2.498 Vali Loss: 2.474 Vali Acc: 0.056 Test Loss: 2.474 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.5915749073028564
Epoch: 2, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.443 Vali Acc: 0.125 Test Loss: 2.443 Test Acc: 0.125
Validation loss decreased (-0.055531 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.6485812664031982
Epoch: 3, Steps: 7 | Train Loss: 2.360 Vali Loss: 2.380 Vali Acc: 0.264 Test Loss: 2.380 Test Acc: 0.264
Validation loss decreased (-0.124976 --> -0.263865).  Saving model ...
Epoch: 4 cost time: 0.7223954200744629
Epoch: 4, Steps: 7 | Train Loss: 2.227 Vali Loss: 2.286 Vali Acc: 0.389 Test Loss: 2.286 Test Acc: 0.389
Validation loss decreased (-0.263865 --> -0.388866).  Saving model ...
Epoch: 5 cost time: 0.70159912109375
Epoch: 5, Steps: 7 | Train Loss: 2.107 Vali Loss: 2.168 Vali Acc: 0.528 Test Loss: 2.168 Test Acc: 0.528
Validation loss decreased (-0.388866 --> -0.527756).  Saving model ...
Epoch: 6 cost time: 0.5732161998748779
Epoch: 6, Steps: 7 | Train Loss: 1.955 Vali Loss: 2.028 Vali Acc: 0.611 Test Loss: 2.028 Test Acc: 0.611
Validation loss decreased (-0.527756 --> -0.611091).  Saving model ...
Epoch: 7 cost time: 0.6460704803466797
Epoch: 7, Steps: 7 | Train Loss: 1.781 Vali Loss: 1.870 Vali Acc: 0.708 Test Loss: 1.870 Test Acc: 0.708
Validation loss decreased (-0.611091 --> -0.708315).  Saving model ...
Epoch: 8 cost time: 0.6001827716827393
Epoch: 8, Steps: 7 | Train Loss: 1.579 Vali Loss: 1.696 Vali Acc: 0.722 Test Loss: 1.696 Test Acc: 0.722
Validation loss decreased (-0.708315 --> -0.722205).  Saving model ...
Epoch: 9 cost time: 0.7268698215484619
Epoch: 9, Steps: 7 | Train Loss: 1.409 Vali Loss: 1.512 Vali Acc: 0.750 Test Loss: 1.512 Test Acc: 0.750
Validation loss decreased (-0.722205 --> -0.749985).  Saving model ...
Epoch: 10 cost time: 0.6036996841430664
Epoch: 10, Steps: 7 | Train Loss: 1.195 Vali Loss: 1.327 Vali Acc: 0.736 Test Loss: 1.327 Test Acc: 0.736
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6043620109558105
Epoch: 11, Steps: 7 | Train Loss: 0.992 Vali Loss: 1.148 Vali Acc: 0.792 Test Loss: 1.148 Test Acc: 0.792
Validation loss decreased (-0.749985 --> -0.791655).  Saving model ...
Epoch: 12 cost time: 0.6699540615081787
Epoch: 12, Steps: 7 | Train Loss: 0.801 Vali Loss: 0.981 Vali Acc: 0.806 Test Loss: 0.981 Test Acc: 0.806
Validation loss decreased (-0.791655 --> -0.805546).  Saving model ...
Epoch: 13 cost time: 0.7453124523162842
Epoch: 13, Steps: 7 | Train Loss: 0.638 Vali Loss: 0.835 Vali Acc: 0.806 Test Loss: 0.835 Test Acc: 0.806
Validation loss decreased (-0.805546 --> -0.805547).  Saving model ...
Epoch: 14 cost time: 0.6413295269012451
Epoch: 14, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
Validation loss decreased (-0.805547 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 0.6164066791534424
Epoch: 15, Steps: 7 | Train Loss: 0.364 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 0.5494377613067627
Epoch: 16, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.559 Vali Acc: 0.875 Test Loss: 0.559 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.597407341003418
Epoch: 17, Steps: 7 | Train Loss: 0.221 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 0.5942783355712891
Epoch: 18, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 19 cost time: 0.6930296421051025
Epoch: 19, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7047266960144043
Epoch: 20, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.405 Vali Acc: 0.917 Test Loss: 0.405 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.7144701480865479
Epoch: 21, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.389 Vali Acc: 0.917 Test Loss: 0.389 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.629880428314209
Epoch: 22, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6861650943756104
Epoch: 23, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6619150638580322
Epoch: 24, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6165566444396973
Epoch: 25, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6107327938079834
Epoch: 26, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6594064235687256
Epoch: 27, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6479678153991699
Epoch: 28, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6438701152801514
Epoch: 29, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6394867897033691
Epoch: 30, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.686121940612793
Epoch: 31, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 635436
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.002631902694702
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.468 Vali Acc: 0.139 Test Loss: 2.468 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.62154221534729
Epoch: 2, Steps: 7 | Train Loss: 2.362 Vali Loss: 2.361 Vali Acc: 0.458 Test Loss: 2.361 Test Acc: 0.458
Validation loss decreased (-0.138864 --> -0.458310).  Saving model ...
Epoch: 3 cost time: 0.5921995639801025
Epoch: 3, Steps: 7 | Train Loss: 2.009 Vali Loss: 2.127 Vali Acc: 0.667 Test Loss: 2.127 Test Acc: 0.667
Validation loss decreased (-0.458310 --> -0.666645).  Saving model ...
Epoch: 4 cost time: 0.7263264656066895
Epoch: 4, Steps: 7 | Train Loss: 1.569 Vali Loss: 1.739 Vali Acc: 0.819 Test Loss: 1.739 Test Acc: 0.819
Validation loss decreased (-0.666645 --> -0.819427).  Saving model ...
Epoch: 5 cost time: 0.7905871868133545
Epoch: 5, Steps: 7 | Train Loss: 1.053 Vali Loss: 1.265 Vali Acc: 0.889 Test Loss: 1.265 Test Acc: 0.889
Validation loss decreased (-0.819427 --> -0.888876).  Saving model ...
Epoch: 6 cost time: 0.7033417224884033
Epoch: 6, Steps: 7 | Train Loss: 0.583 Vali Loss: 0.811 Vali Acc: 0.889 Test Loss: 0.811 Test Acc: 0.889
Validation loss decreased (-0.888876 --> -0.888881).  Saving model ...
Epoch: 7 cost time: 0.8157176971435547
Epoch: 7, Steps: 7 | Train Loss: 0.260 Vali Loss: 0.497 Vali Acc: 0.944 Test Loss: 0.497 Test Acc: 0.944
Validation loss decreased (-0.888881 --> -0.944439).  Saving model ...
Epoch: 8 cost time: 0.6918566226959229
Epoch: 8, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.345 Vali Acc: 0.958 Test Loss: 0.345 Test Acc: 0.958
Validation loss decreased (-0.944439 --> -0.958330).  Saving model ...
Epoch: 9 cost time: 0.7899255752563477
Epoch: 9, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.289 Vali Acc: 0.958 Test Loss: 0.289 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.73067307472229
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6339764595031738
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7020483016967773
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6611220836639404
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8014061450958252
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6469449996948242
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6515598297119141
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6470956802368164
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.6825788021087646
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.7120785713195801
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.8717949390411377
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.8599147796630859
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.7731475830078125
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.7897002696990967
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.7897546291351318
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.7733433246612549
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.7467231750488281
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.7693109512329102
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7731413841247559
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.6763193607330322
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.790834903717041
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.6308443546295166
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.7322487831115723
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.7356922626495361
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.722465991973877
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6574621200561523
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.7715897560119629
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8006629943847656
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.7890112400054932
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.8159465789794922
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.8544893264770508
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.8534650802612305
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.7408349514007568
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.7978525161743164
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.8740684986114502
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.8092191219329834
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.7553482055664062
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7361698150634766
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.6665256023406982
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.8189725875854492
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.7635374069213867
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 787308
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9624531269073486
Epoch: 1, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.495 Vali Acc: 0.083 Test Loss: 2.495 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7175512313842773
Epoch: 2, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.405 Vali Acc: 0.181 Test Loss: 2.405 Test Acc: 0.181
Validation loss decreased (-0.083308 --> -0.180532).  Saving model ...
Epoch: 3 cost time: 0.6634402275085449
Epoch: 3, Steps: 7 | Train Loss: 2.166 Vali Loss: 2.220 Vali Acc: 0.500 Test Loss: 2.220 Test Acc: 0.500
Validation loss decreased (-0.180532 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 0.7273352146148682
Epoch: 4, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.942 Vali Acc: 0.708 Test Loss: 1.942 Test Acc: 0.708
Validation loss decreased (-0.499978 --> -0.708314).  Saving model ...
Epoch: 5 cost time: 0.7680799961090088
Epoch: 5, Steps: 7 | Train Loss: 1.485 Vali Loss: 1.584 Vali Acc: 0.833 Test Loss: 1.584 Test Acc: 0.833
Validation loss decreased (-0.708314 --> -0.833317).  Saving model ...
Epoch: 6 cost time: 0.6585524082183838
Epoch: 6, Steps: 7 | Train Loss: 1.074 Vali Loss: 1.187 Vali Acc: 0.875 Test Loss: 1.187 Test Acc: 0.875
Validation loss decreased (-0.833317 --> -0.874988).  Saving model ...
Epoch: 7 cost time: 0.6462118625640869
Epoch: 7, Steps: 7 | Train Loss: 0.705 Vali Loss: 0.817 Vali Acc: 0.875 Test Loss: 0.817 Test Acc: 0.875
Validation loss decreased (-0.874988 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.7275247573852539
Epoch: 8, Steps: 7 | Train Loss: 0.390 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 0.7137978076934814
Epoch: 9, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.407 Vali Acc: 0.917 Test Loss: 0.407 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.7202239036560059
Epoch: 10, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.6747362613677979
Epoch: 11, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8297405242919922
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.7011158466339111
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.7296721935272217
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6610581874847412
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.6532680988311768
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7145736217498779
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7432348728179932
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7510707378387451
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8002240657806396
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7827882766723633
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6136910915374756
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6798491477966309
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6622486114501953
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6529257297515869
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6613559722900391
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6749498844146729
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 696108
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.718074083328247
Epoch: 1, Steps: 7 | Train Loss: 2.501 Vali Loss: 2.455 Vali Acc: 0.097 Test Loss: 2.455 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6074771881103516
Epoch: 2, Steps: 7 | Train Loss: 2.396 Vali Loss: 2.383 Vali Acc: 0.278 Test Loss: 2.383 Test Acc: 0.278
Validation loss decreased (-0.097198 --> -0.277754).  Saving model ...
Epoch: 3 cost time: 0.6877715587615967
Epoch: 3, Steps: 7 | Train Loss: 2.245 Vali Loss: 2.240 Vali Acc: 0.500 Test Loss: 2.240 Test Acc: 0.500
Validation loss decreased (-0.277754 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 0.7163493633270264
Epoch: 4, Steps: 7 | Train Loss: 2.026 Vali Loss: 2.038 Vali Acc: 0.639 Test Loss: 2.038 Test Acc: 0.639
Validation loss decreased (-0.499978 --> -0.638869).  Saving model ...
Epoch: 5 cost time: 0.7056407928466797
Epoch: 5, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.782 Vali Acc: 0.764 Test Loss: 1.782 Test Acc: 0.764
Validation loss decreased (-0.638869 --> -0.763871).  Saving model ...
Epoch: 6 cost time: 0.5923974514007568
Epoch: 6, Steps: 7 | Train Loss: 1.438 Vali Loss: 1.475 Vali Acc: 0.833 Test Loss: 1.475 Test Acc: 0.833
Validation loss decreased (-0.763871 --> -0.833319).  Saving model ...
Epoch: 7 cost time: 0.7569143772125244
Epoch: 7, Steps: 7 | Train Loss: 1.114 Vali Loss: 1.150 Vali Acc: 0.931 Test Loss: 1.150 Test Acc: 0.931
Validation loss decreased (-0.833319 --> -0.930544).  Saving model ...
Epoch: 8 cost time: 0.6782817840576172
Epoch: 8, Steps: 7 | Train Loss: 0.774 Vali Loss: 0.859 Vali Acc: 0.931 Test Loss: 0.859 Test Acc: 0.931
Validation loss decreased (-0.930544 --> -0.930547).  Saving model ...
Epoch: 9 cost time: 0.661888599395752
Epoch: 9, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.625 Vali Acc: 0.931 Test Loss: 0.625 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930549).  Saving model ...
Epoch: 10 cost time: 0.6761817932128906
Epoch: 10, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.458 Vali Acc: 0.958 Test Loss: 0.458 Test Acc: 0.958
Validation loss decreased (-0.930549 --> -0.958329).  Saving model ...
Epoch: 11 cost time: 0.7180154323577881
Epoch: 11, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8027312755584717
Epoch: 12, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6851067543029785
Epoch: 13, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6853549480438232
Epoch: 14, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6796247959136963
Epoch: 15, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.822376012802124
Epoch: 16, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5644359588623047
Epoch: 17, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7015702724456787
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6643996238708496
Epoch: 19, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6884381771087646
Epoch: 20, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 669420
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8823175430297852
Epoch: 1, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.467 Vali Acc: 0.125 Test Loss: 2.467 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.6429786682128906
Epoch: 2, Steps: 7 | Train Loss: 2.367 Vali Loss: 2.404 Vali Acc: 0.194 Test Loss: 2.404 Test Acc: 0.194
Validation loss decreased (-0.124975 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.6425588130950928
Epoch: 3, Steps: 7 | Train Loss: 2.230 Vali Loss: 2.291 Vali Acc: 0.472 Test Loss: 2.291 Test Acc: 0.472
Validation loss decreased (-0.194420 --> -0.472199).  Saving model ...
Epoch: 4 cost time: 0.6399047374725342
Epoch: 4, Steps: 7 | Train Loss: 2.051 Vali Loss: 2.133 Vali Acc: 0.611 Test Loss: 2.133 Test Acc: 0.611
Validation loss decreased (-0.472199 --> -0.611090).  Saving model ...
Epoch: 5 cost time: 0.626828670501709
Epoch: 5, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.938 Vali Acc: 0.722 Test Loss: 1.938 Test Acc: 0.722
Validation loss decreased (-0.611090 --> -0.722203).  Saving model ...
Epoch: 6 cost time: 0.5991542339324951
Epoch: 6, Steps: 7 | Train Loss: 1.581 Vali Loss: 1.699 Vali Acc: 0.750 Test Loss: 1.699 Test Acc: 0.750
Validation loss decreased (-0.722203 --> -0.749983).  Saving model ...
Epoch: 7 cost time: 0.6253206729888916
Epoch: 7, Steps: 7 | Train Loss: 1.313 Vali Loss: 1.445 Vali Acc: 0.819 Test Loss: 1.445 Test Acc: 0.819
Validation loss decreased (-0.749983 --> -0.819430).  Saving model ...
Epoch: 8 cost time: 0.5886218547821045
Epoch: 8, Steps: 7 | Train Loss: 1.036 Vali Loss: 1.168 Vali Acc: 0.847 Test Loss: 1.168 Test Acc: 0.847
Validation loss decreased (-0.819430 --> -0.847211).  Saving model ...
Epoch: 9 cost time: 0.5704360008239746
Epoch: 9, Steps: 7 | Train Loss: 0.756 Vali Loss: 0.918 Vali Acc: 0.861 Test Loss: 0.918 Test Acc: 0.861
Validation loss decreased (-0.847211 --> -0.861102).  Saving model ...
Epoch: 10 cost time: 0.5830037593841553
Epoch: 10, Steps: 7 | Train Loss: 0.517 Vali Loss: 0.705 Vali Acc: 0.889 Test Loss: 0.705 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888882).  Saving model ...
Epoch: 11 cost time: 0.44810938835144043
Epoch: 11, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.558 Vali Acc: 0.903 Test Loss: 0.558 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902772).  Saving model ...
Epoch: 12 cost time: 0.6874711513519287
Epoch: 12, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.466 Vali Acc: 0.903 Test Loss: 0.466 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.5550222396850586
Epoch: 13, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.401 Vali Acc: 0.917 Test Loss: 0.401 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.5623102188110352
Epoch: 14, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.5519685745239258
Epoch: 15, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.5157089233398438
Epoch: 16, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.5677356719970703
Epoch: 17, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.5403423309326172
Epoch: 18, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 0.6208302974700928
Epoch: 19, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5715539455413818
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.6573638916015625
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.6185996532440186
Epoch: 22, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6727347373962402
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6067492961883545
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6636490821838379
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6847100257873535
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5994875431060791
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.7002882957458496
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6741061210632324
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.628626823425293
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.557091236114502
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6104347705841064
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.597893238067627
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5849370956420898
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6179783344268799
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5479047298431396
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5907497406005859
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5537145137786865
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 651948
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8350987434387207
Epoch: 1, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.465 Vali Acc: 0.056 Test Loss: 2.465 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.6070067882537842
Epoch: 2, Steps: 7 | Train Loss: 2.392 Vali Loss: 2.413 Vali Acc: 0.250 Test Loss: 2.413 Test Acc: 0.250
Validation loss decreased (-0.055531 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.5099780559539795
Epoch: 3, Steps: 7 | Train Loss: 2.295 Vali Loss: 2.318 Vali Acc: 0.444 Test Loss: 2.318 Test Acc: 0.444
Validation loss decreased (-0.249976 --> -0.444421).  Saving model ...
Epoch: 4 cost time: 0.5658807754516602
Epoch: 4, Steps: 7 | Train Loss: 2.123 Vali Loss: 2.180 Vali Acc: 0.583 Test Loss: 2.180 Test Acc: 0.583
Validation loss decreased (-0.444421 --> -0.583312).  Saving model ...
Epoch: 5 cost time: 0.683215856552124
Epoch: 5, Steps: 7 | Train Loss: 1.943 Vali Loss: 2.007 Vali Acc: 0.597 Test Loss: 2.007 Test Acc: 0.597
Validation loss decreased (-0.583312 --> -0.597202).  Saving model ...
Epoch: 6 cost time: 0.5909562110900879
Epoch: 6, Steps: 7 | Train Loss: 1.745 Vali Loss: 1.798 Vali Acc: 0.750 Test Loss: 1.798 Test Acc: 0.750
Validation loss decreased (-0.597202 --> -0.749982).  Saving model ...
Epoch: 7 cost time: 0.5552899837493896
Epoch: 7, Steps: 7 | Train Loss: 1.481 Vali Loss: 1.556 Vali Acc: 0.875 Test Loss: 1.556 Test Acc: 0.875
Validation loss decreased (-0.749982 --> -0.874984).  Saving model ...
Epoch: 8 cost time: 0.5536181926727295
Epoch: 8, Steps: 7 | Train Loss: 1.247 Vali Loss: 1.310 Vali Acc: 0.903 Test Loss: 1.310 Test Acc: 0.903
Validation loss decreased (-0.874984 --> -0.902765).  Saving model ...
Epoch: 9 cost time: 0.6757729053497314
Epoch: 9, Steps: 7 | Train Loss: 0.984 Vali Loss: 1.060 Vali Acc: 0.903 Test Loss: 1.060 Test Acc: 0.903
Validation loss decreased (-0.902765 --> -0.902767).  Saving model ...
Epoch: 10 cost time: 0.6340930461883545
Epoch: 10, Steps: 7 | Train Loss: 0.735 Vali Loss: 0.828 Vali Acc: 0.903 Test Loss: 0.828 Test Acc: 0.903
Validation loss decreased (-0.902767 --> -0.902769).  Saving model ...
Epoch: 11 cost time: 0.6810622215270996
Epoch: 11, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.650 Vali Acc: 0.917 Test Loss: 0.650 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916660).  Saving model ...
Epoch: 12 cost time: 0.6319735050201416
Epoch: 12, Steps: 7 | Train Loss: 0.351 Vali Loss: 0.520 Vali Acc: 0.931 Test Loss: 0.520 Test Acc: 0.931
Validation loss decreased (-0.916660 --> -0.930550).  Saving model ...
Epoch: 13 cost time: 0.5789601802825928
Epoch: 13, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.445 Vali Acc: 0.931 Test Loss: 0.445 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 14 cost time: 0.5593068599700928
Epoch: 14, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.388 Vali Acc: 0.944 Test Loss: 0.388 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.5823957920074463
Epoch: 15, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.352 Vali Acc: 0.944 Test Loss: 0.352 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.5638730525970459
Epoch: 16, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.331 Vali Acc: 0.958 Test Loss: 0.331 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 17 cost time: 0.6369035243988037
Epoch: 17, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.313 Vali Acc: 0.958 Test Loss: 0.313 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 18 cost time: 0.6206676959991455
Epoch: 18, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.295 Vali Acc: 0.958 Test Loss: 0.295 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 19 cost time: 0.5963428020477295
Epoch: 19, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.272 Vali Acc: 0.958 Test Loss: 0.272 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.607917070388794
Epoch: 20, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6111156940460205
Epoch: 21, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.6756439208984375
Epoch: 22, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.255 Vali Acc: 0.958 Test Loss: 0.255 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6384849548339844
Epoch: 23, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.5212209224700928
Epoch: 24, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.6122267246246338
Epoch: 25, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.6557409763336182
Epoch: 26, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.6899652481079102
Epoch: 27, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.700791597366333
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5456829071044922
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5645551681518555
Epoch: 30, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.6144511699676514
Epoch: 31, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.7200584411621094
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5712015628814697
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6504929065704346
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6142697334289551
Epoch: 35, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.5704443454742432
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.5967080593109131
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.6723518371582031
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.703315258026123
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.5631544589996338
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5715982913970947
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.5747065544128418
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.6186401844024658
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.6371471881866455
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.5959973335266113
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.604400634765625
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6597304344177246
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5739316940307617
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.634002685546875
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6404249668121338
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 644652
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9446401596069336
Epoch: 1, Steps: 7 | Train Loss: 2.553 Vali Loss: 2.503 Vali Acc: 0.083 Test Loss: 2.503 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7114388942718506
Epoch: 2, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.463 Vali Acc: 0.097 Test Loss: 2.463 Test Acc: 0.097
Validation loss decreased (-0.083308 --> -0.097198).  Saving model ...
Epoch: 3 cost time: 0.6785483360290527
Epoch: 3, Steps: 7 | Train Loss: 2.371 Vali Loss: 2.379 Vali Acc: 0.208 Test Loss: 2.379 Test Acc: 0.208
Validation loss decreased (-0.097198 --> -0.208310).  Saving model ...
Epoch: 4 cost time: 0.7809360027313232
Epoch: 4, Steps: 7 | Train Loss: 2.238 Vali Loss: 2.257 Vali Acc: 0.431 Test Loss: 2.257 Test Acc: 0.431
Validation loss decreased (-0.208310 --> -0.430533).  Saving model ...
Epoch: 5 cost time: 0.6420094966888428
Epoch: 5, Steps: 7 | Train Loss: 2.069 Vali Loss: 2.106 Vali Acc: 0.694 Test Loss: 2.106 Test Acc: 0.694
Validation loss decreased (-0.430533 --> -0.694423).  Saving model ...
Epoch: 6 cost time: 0.6041836738586426
Epoch: 6, Steps: 7 | Train Loss: 1.893 Vali Loss: 1.935 Vali Acc: 0.764 Test Loss: 1.935 Test Acc: 0.764
Validation loss decreased (-0.694423 --> -0.763870).  Saving model ...
Epoch: 7 cost time: 0.6735749244689941
Epoch: 7, Steps: 7 | Train Loss: 1.672 Vali Loss: 1.729 Vali Acc: 0.792 Test Loss: 1.729 Test Acc: 0.792
Validation loss decreased (-0.763870 --> -0.791649).  Saving model ...
Epoch: 8 cost time: 0.6940135955810547
Epoch: 8, Steps: 7 | Train Loss: 1.467 Vali Loss: 1.506 Vali Acc: 0.819 Test Loss: 1.506 Test Acc: 0.819
Validation loss decreased (-0.791649 --> -0.819429).  Saving model ...
Epoch: 9 cost time: 0.6407954692840576
Epoch: 9, Steps: 7 | Train Loss: 1.217 Vali Loss: 1.275 Vali Acc: 0.847 Test Loss: 1.275 Test Acc: 0.847
Validation loss decreased (-0.819429 --> -0.847209).  Saving model ...
Epoch: 10 cost time: 0.6085152626037598
Epoch: 10, Steps: 7 | Train Loss: 0.972 Vali Loss: 1.048 Vali Acc: 0.889 Test Loss: 1.048 Test Acc: 0.889
Validation loss decreased (-0.847209 --> -0.888878).  Saving model ...
Epoch: 11 cost time: 0.6244263648986816
Epoch: 11, Steps: 7 | Train Loss: 0.754 Vali Loss: 0.851 Vali Acc: 0.861 Test Loss: 0.851 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6895391941070557
Epoch: 12, Steps: 7 | Train Loss: 0.565 Vali Loss: 0.686 Vali Acc: 0.917 Test Loss: 0.686 Test Acc: 0.917
Validation loss decreased (-0.888878 --> -0.916660).  Saving model ...
Epoch: 13 cost time: 0.6464872360229492
Epoch: 13, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.568 Vali Acc: 0.917 Test Loss: 0.568 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916661).  Saving model ...
Epoch: 14 cost time: 0.6059722900390625
Epoch: 14, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.481 Vali Acc: 0.917 Test Loss: 0.481 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 15 cost time: 0.7169206142425537
Epoch: 15, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.425 Vali Acc: 0.931 Test Loss: 0.425 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 16 cost time: 0.6216170787811279
Epoch: 16, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.380 Vali Acc: 0.931 Test Loss: 0.380 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.6489579677581787
Epoch: 17, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.355 Vali Acc: 0.931 Test Loss: 0.355 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.6633293628692627
Epoch: 18, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.6391613483428955
Epoch: 19, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.6088871955871582
Epoch: 20, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.5665726661682129
Epoch: 21, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6978209018707275
Epoch: 22, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6881053447723389
Epoch: 23, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6220893859863281
Epoch: 24, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7199809551239014
Epoch: 25, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6633803844451904
Epoch: 26, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5993850231170654
Epoch: 27, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6330220699310303
Epoch: 28, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7232711315155029
Epoch: 29, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6996614933013916
Epoch: 30, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.692392110824585
Epoch: 31, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6179940700531006
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5555763244628906
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5843427181243896
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6622278690338135
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6103701591491699
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6267564296722412
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.6449379920959473
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6487126350402832
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5710930824279785
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6262476444244385
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6587986946105957
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.6388053894042969
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.6317451000213623
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6440181732177734
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6634852886199951
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.7451646327972412
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.6073169708251953
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.6994521617889404
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.6167511940002441
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 637356
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9529573917388916
Epoch: 1, Steps: 7 | Train Loss: 2.493 Vali Loss: 2.453 Vali Acc: 0.222 Test Loss: 2.453 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.6130180358886719
Epoch: 2, Steps: 7 | Train Loss: 2.419 Vali Loss: 2.405 Vali Acc: 0.264 Test Loss: 2.405 Test Acc: 0.264
Validation loss decreased (-0.222198 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 0.5860950946807861
Epoch: 3, Steps: 7 | Train Loss: 2.327 Vali Loss: 2.324 Vali Acc: 0.319 Test Loss: 2.324 Test Acc: 0.319
Validation loss decreased (-0.263865 --> -0.319421).  Saving model ...
Epoch: 4 cost time: 0.5468904972076416
Epoch: 4, Steps: 7 | Train Loss: 2.197 Vali Loss: 2.215 Vali Acc: 0.458 Test Loss: 2.215 Test Acc: 0.458
Validation loss decreased (-0.319421 --> -0.458311).  Saving model ...
Epoch: 5 cost time: 0.6262238025665283
Epoch: 5, Steps: 7 | Train Loss: 2.083 Vali Loss: 2.083 Vali Acc: 0.569 Test Loss: 2.083 Test Acc: 0.569
Validation loss decreased (-0.458311 --> -0.569424).  Saving model ...
Epoch: 6 cost time: 0.7035913467407227
Epoch: 6, Steps: 7 | Train Loss: 1.904 Vali Loss: 1.934 Vali Acc: 0.611 Test Loss: 1.934 Test Acc: 0.611
Validation loss decreased (-0.569424 --> -0.611092).  Saving model ...
Epoch: 7 cost time: 0.592681884765625
Epoch: 7, Steps: 7 | Train Loss: 1.722 Vali Loss: 1.777 Vali Acc: 0.667 Test Loss: 1.777 Test Acc: 0.667
Validation loss decreased (-0.611092 --> -0.666649).  Saving model ...
Epoch: 8 cost time: 0.6605145931243896
Epoch: 8, Steps: 7 | Train Loss: 1.545 Vali Loss: 1.602 Vali Acc: 0.694 Test Loss: 1.602 Test Acc: 0.694
Validation loss decreased (-0.666649 --> -0.694428).  Saving model ...
Epoch: 9 cost time: 0.5782909393310547
Epoch: 9, Steps: 7 | Train Loss: 1.343 Vali Loss: 1.431 Vali Acc: 0.722 Test Loss: 1.431 Test Acc: 0.722
Validation loss decreased (-0.694428 --> -0.722208).  Saving model ...
Epoch: 10 cost time: 0.6239495277404785
Epoch: 10, Steps: 7 | Train Loss: 1.139 Vali Loss: 1.261 Vali Acc: 0.764 Test Loss: 1.261 Test Acc: 0.764
Validation loss decreased (-0.722208 --> -0.763876).  Saving model ...
Epoch: 11 cost time: 0.6285703182220459
Epoch: 11, Steps: 7 | Train Loss: 0.933 Vali Loss: 1.097 Vali Acc: 0.792 Test Loss: 1.097 Test Acc: 0.792
Validation loss decreased (-0.763876 --> -0.791656).  Saving model ...
Epoch: 12 cost time: 0.5773684978485107
Epoch: 12, Steps: 7 | Train Loss: 0.745 Vali Loss: 0.956 Vali Acc: 0.792 Test Loss: 0.956 Test Acc: 0.792
Validation loss decreased (-0.791656 --> -0.791657).  Saving model ...
Epoch: 13 cost time: 0.6019248962402344
Epoch: 13, Steps: 7 | Train Loss: 0.578 Vali Loss: 0.833 Vali Acc: 0.833 Test Loss: 0.833 Test Acc: 0.833
Validation loss decreased (-0.791657 --> -0.833325).  Saving model ...
Epoch: 14 cost time: 0.626903772354126
Epoch: 14, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.735 Vali Acc: 0.847 Test Loss: 0.735 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847215).  Saving model ...
Epoch: 15 cost time: 0.6696791648864746
Epoch: 15, Steps: 7 | Train Loss: 0.354 Vali Loss: 0.655 Vali Acc: 0.861 Test Loss: 0.655 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 0.6132125854492188
Epoch: 16, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.597 Vali Acc: 0.847 Test Loss: 0.597 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5906813144683838
Epoch: 17, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.5922775268554688
Epoch: 18, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.518 Vali Acc: 0.889 Test Loss: 0.518 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 19 cost time: 0.5524587631225586
Epoch: 19, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 0.6253018379211426
Epoch: 20, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 0.5251996517181396
Epoch: 21, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 0.6806702613830566
Epoch: 22, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.446 Vali Acc: 0.903 Test Loss: 0.446 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 23 cost time: 0.5476188659667969
Epoch: 23, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5986795425415039
Epoch: 24, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.426 Vali Acc: 0.903 Test Loss: 0.426 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.5203571319580078
Epoch: 25, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.5577797889709473
Epoch: 26, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.5385081768035889
Epoch: 27, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.49208569526672363
Epoch: 28, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.6040632724761963
Epoch: 29, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.6201958656311035
Epoch: 30, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6156985759735107
Epoch: 31, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.5737440586090088
Epoch: 32, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 33 cost time: 0.6873271465301514
Epoch: 33, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.6114747524261475
Epoch: 34, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7151377201080322
Epoch: 35, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6205439567565918
Epoch: 36, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6197171211242676
Epoch: 37, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 38 cost time: 0.613473653793335
Epoch: 38, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 39 cost time: 0.6346533298492432
Epoch: 39, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 40 cost time: 0.6906988620758057
Epoch: 40, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 41 cost time: 0.6137955188751221
Epoch: 41, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6552689075469971
Epoch: 42, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6397645473480225
Epoch: 43, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6168348789215088
Epoch: 44, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6837193965911865
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5824871063232422
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6746847629547119
Epoch: 47, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.785853385925293
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 49 cost time: 0.6654050350189209
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 50 cost time: 0.7042615413665771
Epoch: 50, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 630060
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9530320167541504
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.339 Vali Acc: 0.361 Test Loss: 2.339 Test Acc: 0.361
Validation loss decreased (inf --> -0.361088).  Saving model ...
Epoch: 2 cost time: 0.7452800273895264
Epoch: 2, Steps: 7 | Train Loss: 1.806 Vali Loss: 1.579 Vali Acc: 0.764 Test Loss: 1.579 Test Acc: 0.764
Validation loss decreased (-0.361088 --> -0.763873).  Saving model ...
Epoch: 3 cost time: 0.8185510635375977
Epoch: 3, Steps: 7 | Train Loss: 0.671 Vali Loss: 0.751 Vali Acc: 0.917 Test Loss: 0.751 Test Acc: 0.917
Validation loss decreased (-0.763873 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 0.7330427169799805
Epoch: 4, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
Validation loss decreased (-0.916659 --> -0.944441).  Saving model ...
Epoch: 5 cost time: 0.7449133396148682
Epoch: 5, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8504328727722168
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8438162803649902
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.882084846496582
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9006989002227783
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8478026390075684
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.74418044090271
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7163100242614746
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8269386291503906
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7947876453399658
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9164376258850098
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.832963228225708
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.741283655166626
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.0585720539093018
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9129893779754639
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 1.0043983459472656
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8688580989837646
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.8604836463928223
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8433990478515625
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7189474105834961
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.9782092571258545
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.8346052169799805
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.8024215698242188
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8814361095428467
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7538743019104004
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7755160331726074
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.9729537963867188
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.8914785385131836
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.981898307800293
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.7875363826751709
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.9436395168304443
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.8204405307769775
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.8578107357025146
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.8865547180175781
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.8613426685333252
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.9582822322845459
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.7760255336761475
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.8384566307067871
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.7181105613708496
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.8656864166259766
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.7975835800170898
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.7471694946289062
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7046654224395752
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.9074094295501709
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.857802152633667
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.922461986541748
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2894220
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1680855751037598
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.373 Vali Acc: 0.264 Test Loss: 2.373 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.7218613624572754
Epoch: 2, Steps: 7 | Train Loss: 2.091 Vali Loss: 1.907 Vali Acc: 0.764 Test Loss: 1.907 Test Acc: 0.764
Validation loss decreased (-0.263865 --> -0.763870).  Saving model ...
Epoch: 3 cost time: 0.8173058032989502
Epoch: 3, Steps: 7 | Train Loss: 1.248 Vali Loss: 1.225 Vali Acc: 0.875 Test Loss: 1.225 Test Acc: 0.875
Validation loss decreased (-0.763870 --> -0.874988).  Saving model ...
Epoch: 4 cost time: 0.8558533191680908
Epoch: 4, Steps: 7 | Train Loss: 0.526 Vali Loss: 0.650 Vali Acc: 0.931 Test Loss: 0.650 Test Acc: 0.931
Validation loss decreased (-0.874988 --> -0.930549).  Saving model ...
Epoch: 5 cost time: 0.9203064441680908
Epoch: 5, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.930549 --> -0.944441).  Saving model ...
Epoch: 6 cost time: 0.7205255031585693
Epoch: 6, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7975666522979736
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8198144435882568
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.8915188312530518
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.9926762580871582
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.7931098937988281
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8045949935913086
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7233421802520752
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.763801097869873
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8494694232940674
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.7762241363525391
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7710602283477783
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.8094587326049805
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6496176719665527
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.8254227638244629
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.6912698745727539
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7765061855316162
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.7825157642364502
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6440258026123047
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.920947790145874
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8748779296875
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.9604017734527588
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.7756059169769287
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9431805610656738
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9678606986999512
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7823481559753418
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.8546159267425537
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.9903061389923096
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.9403204917907715
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.991511344909668
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.952747106552124
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.9934935569763184
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9207479953765869
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8103668689727783
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8378615379333496
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.749565601348877
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7537736892700195
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.816718339920044
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8270251750946045
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9444513320922852
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7775106430053711
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2529420
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.052320718765259
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.415 Vali Acc: 0.208 Test Loss: 2.415 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.7518179416656494
Epoch: 2, Steps: 7 | Train Loss: 2.181 Vali Loss: 2.083 Vali Acc: 0.667 Test Loss: 2.083 Test Acc: 0.667
Validation loss decreased (-0.208309 --> -0.666646).  Saving model ...
Epoch: 3 cost time: 0.8335621356964111
Epoch: 3, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.554 Vali Acc: 0.806 Test Loss: 1.554 Test Acc: 0.806
Validation loss decreased (-0.666646 --> -0.805540).  Saving model ...
Epoch: 4 cost time: 0.795738697052002
Epoch: 4, Steps: 7 | Train Loss: 0.921 Vali Loss: 0.991 Vali Acc: 0.875 Test Loss: 0.991 Test Acc: 0.875
Validation loss decreased (-0.805540 --> -0.874990).  Saving model ...
Epoch: 5 cost time: 0.801203727722168
Epoch: 5, Steps: 7 | Train Loss: 0.384 Vali Loss: 0.561 Vali Acc: 0.889 Test Loss: 0.561 Test Acc: 0.889
Validation loss decreased (-0.874990 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.655318021774292
Epoch: 6, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.7479231357574463
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 0.6716749668121338
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.649552583694458
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7542588710784912
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6633648872375488
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7956771850585938
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6862466335296631
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.8490869998931885
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7246522903442383
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.793560266494751
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7368147373199463
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7892372608184814
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7895514965057373
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.8280103206634521
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7000038623809814
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7472691535949707
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.7366859912872314
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7387003898620605
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7267289161682129
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.7634396553039551
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7392067909240723
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6117286682128906
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5997490882873535
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5865445137023926
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.8222048282623291
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.605339765548706
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5230612754821777
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6160061359405518
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6760635375976562
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6122117042541504
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7020101547241211
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7122535705566406
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.706127405166626
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8473308086395264
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.858379602432251
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8431589603424072
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7833678722381592
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7219269275665283
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2404236
model size : 9.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2975845336914062
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.448 Vali Acc: 0.194 Test Loss: 2.448 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.764441728591919
Epoch: 2, Steps: 7 | Train Loss: 2.242 Vali Loss: 2.193 Vali Acc: 0.569 Test Loss: 2.193 Test Acc: 0.569
Validation loss decreased (-0.194420 --> -0.569423).  Saving model ...
Epoch: 3 cost time: 0.6433506011962891
Epoch: 3, Steps: 7 | Train Loss: 1.768 Vali Loss: 1.780 Vali Acc: 0.792 Test Loss: 1.780 Test Acc: 0.792
Validation loss decreased (-0.569423 --> -0.791649).  Saving model ...
Epoch: 4 cost time: 0.6444835662841797
Epoch: 4, Steps: 7 | Train Loss: 1.195 Vali Loss: 1.266 Vali Acc: 0.847 Test Loss: 1.266 Test Acc: 0.847
Validation loss decreased (-0.791649 --> -0.847210).  Saving model ...
Epoch: 5 cost time: 0.6983106136322021
Epoch: 5, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.784 Vali Acc: 0.889 Test Loss: 0.784 Test Acc: 0.889
Validation loss decreased (-0.847210 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 0.7824361324310303
Epoch: 6, Steps: 7 | Train Loss: 0.255 Vali Loss: 0.492 Vali Acc: 0.903 Test Loss: 0.492 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.7652120590209961
Epoch: 7, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.6028187274932861
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.7650880813598633
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6445386409759521
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7971222400665283
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5940587520599365
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6867468357086182
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6337096691131592
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6513001918792725
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8487913608551025
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7833740711212158
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7583732604980469
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8310766220092773
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2352780
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1419990062713623
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.447 Vali Acc: 0.083 Test Loss: 2.447 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.7353518009185791
Epoch: 2, Steps: 7 | Train Loss: 2.292 Vali Loss: 2.251 Vali Acc: 0.472 Test Loss: 2.251 Test Acc: 0.472
Validation loss decreased (-0.083309 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 0.8247690200805664
Epoch: 3, Steps: 7 | Train Loss: 1.914 Vali Loss: 1.925 Vali Acc: 0.736 Test Loss: 1.925 Test Acc: 0.736
Validation loss decreased (-0.472200 --> -0.736092).  Saving model ...
Epoch: 4 cost time: 0.7547078132629395
Epoch: 4, Steps: 7 | Train Loss: 1.410 Vali Loss: 1.493 Vali Acc: 0.875 Test Loss: 1.493 Test Acc: 0.875
Validation loss decreased (-0.736092 --> -0.874985).  Saving model ...
Epoch: 5 cost time: 0.795398473739624
Epoch: 5, Steps: 7 | Train Loss: 0.897 Vali Loss: 1.007 Vali Acc: 0.917 Test Loss: 1.007 Test Acc: 0.917
Validation loss decreased (-0.874985 --> -0.916657).  Saving model ...
Epoch: 6 cost time: 0.7495565414428711
Epoch: 6, Steps: 7 | Train Loss: 0.485 Vali Loss: 0.635 Vali Acc: 0.931 Test Loss: 0.635 Test Acc: 0.931
Validation loss decreased (-0.916657 --> -0.930549).  Saving model ...
Epoch: 7 cost time: 0.8665461540222168
Epoch: 7, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930551).  Saving model ...
Epoch: 8 cost time: 0.8736891746520996
Epoch: 8, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.327 Vali Acc: 0.931 Test Loss: 0.327 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.7940866947174072
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.8733847141265869
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.7973239421844482
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7739818096160889
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7813446521759033
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.8433716297149658
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.8305225372314453
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.9163491725921631
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.9136085510253906
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.7850298881530762
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.8392486572265625
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.9159884452819824
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.822495698928833
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.779677152633667
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.9684522151947021
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.665057897567749
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.8211843967437744
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.7921929359436035
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.7813770771026611
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.8168694972991943
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 0.8283779621124268
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.8993406295776367
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.7180671691894531
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 0.8919699192047119
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.700800895690918
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.8851664066314697
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.7400839328765869
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.7722673416137695
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.6823585033416748
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.6782679557800293
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.7461929321289062
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.843663215637207
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8472027778625488
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.7167575359344482
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.94637131690979
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.7915151119232178
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.834061861038208
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7229526042938232
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.8618655204772949
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.7146029472351074
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7709529399871826
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.6831538677215576
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2305164
model size : 8.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0503172874450684
Epoch: 1, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.439 Vali Acc: 0.181 Test Loss: 2.439 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.6549172401428223
Epoch: 2, Steps: 7 | Train Loss: 2.332 Vali Loss: 2.253 Vali Acc: 0.458 Test Loss: 2.253 Test Acc: 0.458
Validation loss decreased (-0.180531 --> -0.458311).  Saving model ...
Epoch: 3 cost time: 0.7693929672241211
Epoch: 3, Steps: 7 | Train Loss: 2.003 Vali Loss: 1.962 Vali Acc: 0.736 Test Loss: 1.962 Test Acc: 0.736
Validation loss decreased (-0.458311 --> -0.736091).  Saving model ...
Epoch: 4 cost time: 0.7053215503692627
Epoch: 4, Steps: 7 | Train Loss: 1.613 Vali Loss: 1.584 Vali Acc: 0.833 Test Loss: 1.584 Test Acc: 0.833
Validation loss decreased (-0.736091 --> -0.833317).  Saving model ...
Epoch: 5 cost time: 0.763176441192627
Epoch: 5, Steps: 7 | Train Loss: 1.140 Vali Loss: 1.169 Vali Acc: 0.903 Test Loss: 1.169 Test Acc: 0.903
Validation loss decreased (-0.833317 --> -0.902766).  Saving model ...
Epoch: 6 cost time: 0.626934289932251
Epoch: 6, Steps: 7 | Train Loss: 0.715 Vali Loss: 0.803 Vali Acc: 0.889 Test Loss: 0.803 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7244315147399902
Epoch: 7, Steps: 7 | Train Loss: 0.395 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5401034355163574
Epoch: 8, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.406 Vali Acc: 0.944 Test Loss: 0.406 Test Acc: 0.944
Validation loss decreased (-0.902766 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 0.7206122875213623
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.579538106918335
Epoch: 10, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7559399604797363
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7914063930511475
Epoch: 12, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7695119380950928
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6537570953369141
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7882156372070312
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.7246894836425781
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.8557934761047363
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6633286476135254
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7124214172363281
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.761852502822876
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7275526523590088
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7646875381469727
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.9510402679443359
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.8453006744384766
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.8069188594818115
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.7546837329864502
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.8873324394226074
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.740300178527832
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7933623790740967
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7711553573608398
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7350947856903076
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.7656455039978027
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6418087482452393
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6540408134460449
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5834088325500488
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5414426326751709
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6881067752838135
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.6356797218322754
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6490075588226318
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7669177055358887
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6945083141326904
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7326164245605469
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6192798614501953
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.7103636264801025
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.7312548160552979
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.7301864624023438
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.7739307880401611
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.725170373916626
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.7053790092468262
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.757720947265625
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2275980
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8893165588378906
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.430 Vali Acc: 0.181 Test Loss: 2.430 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.7244241237640381
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.274 Vali Acc: 0.431 Test Loss: 2.274 Test Acc: 0.431
Validation loss decreased (-0.180531 --> -0.430533).  Saving model ...
Epoch: 3 cost time: 0.7285048961639404
Epoch: 3, Steps: 7 | Train Loss: 2.067 Vali Loss: 2.025 Vali Acc: 0.792 Test Loss: 2.025 Test Acc: 0.792
Validation loss decreased (-0.430533 --> -0.791646).  Saving model ...
Epoch: 4 cost time: 0.7839577198028564
Epoch: 4, Steps: 7 | Train Loss: 1.714 Vali Loss: 1.707 Vali Acc: 0.889 Test Loss: 1.707 Test Acc: 0.889
Validation loss decreased (-0.791646 --> -0.888872).  Saving model ...
Epoch: 5 cost time: 0.7168724536895752
Epoch: 5, Steps: 7 | Train Loss: 1.291 Vali Loss: 1.352 Vali Acc: 0.847 Test Loss: 1.352 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5757739543914795
Epoch: 6, Steps: 7 | Train Loss: 0.916 Vali Loss: 0.992 Vali Acc: 0.847 Test Loss: 0.992 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6138887405395508
Epoch: 7, Steps: 7 | Train Loss: 0.556 Vali Loss: 0.700 Vali Acc: 0.889 Test Loss: 0.700 Test Acc: 0.889
Validation loss decreased (-0.888872 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 0.7257318496704102
Epoch: 8, Steps: 7 | Train Loss: 0.313 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.7446117401123047
Epoch: 9, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.438 Vali Acc: 0.903 Test Loss: 0.438 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 0.8282008171081543
Epoch: 10, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.390 Vali Acc: 0.917 Test Loss: 0.390 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.6826393604278564
Epoch: 11, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.787926435470581
Epoch: 12, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7496602535247803
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7813405990600586
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8463118076324463
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8658127784729004
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7738139629364014
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.7764122486114502
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9135921001434326
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7581439018249512
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.8058924674987793
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.7166106700897217
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7696185111999512
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.780949592590332
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7075691223144531
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7327718734741211
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6660778522491455
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7210628986358643
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.660088062286377
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6165838241577148
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6014809608459473
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2265228
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7289752960205078
Epoch: 1, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.395 Vali Acc: 0.389 Test Loss: 2.395 Test Acc: 0.389
Validation loss decreased (inf --> -0.388865).  Saving model ...
Epoch: 2 cost time: 0.5536389350891113
Epoch: 2, Steps: 7 | Train Loss: 2.113 Vali Loss: 2.043 Vali Acc: 0.764 Test Loss: 2.043 Test Acc: 0.764
Validation loss decreased (-0.388865 --> -0.763868).  Saving model ...
Epoch: 3 cost time: 0.5831127166748047
Epoch: 3, Steps: 7 | Train Loss: 1.411 Vali Loss: 1.471 Vali Acc: 0.875 Test Loss: 1.471 Test Acc: 0.875
Validation loss decreased (-0.763868 --> -0.874985).  Saving model ...
Epoch: 4 cost time: 0.6141259670257568
Epoch: 4, Steps: 7 | Train Loss: 0.701 Vali Loss: 0.873 Vali Acc: 0.903 Test Loss: 0.873 Test Acc: 0.903
Validation loss decreased (-0.874985 --> -0.902769).  Saving model ...
Epoch: 5 cost time: 0.672757625579834
Epoch: 5, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.482 Vali Acc: 0.931 Test Loss: 0.482 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 0.5849754810333252
Epoch: 6, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 0.7437098026275635
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6705904006958008
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6732223033905029
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.590139627456665
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6755309104919434
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6582326889038086
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6219232082366943
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6363215446472168
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.762493371963501
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.641942024230957
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 939212
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8781158924102783
Epoch: 1, Steps: 7 | Train Loss: 2.537 Vali Loss: 2.396 Vali Acc: 0.167 Test Loss: 2.396 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.5488040447235107
Epoch: 2, Steps: 7 | Train Loss: 2.275 Vali Loss: 2.133 Vali Acc: 0.597 Test Loss: 2.133 Test Acc: 0.597
Validation loss decreased (-0.166643 --> -0.597201).  Saving model ...
Epoch: 3 cost time: 0.5849394798278809
Epoch: 3, Steps: 7 | Train Loss: 1.809 Vali Loss: 1.725 Vali Acc: 0.847 Test Loss: 1.725 Test Acc: 0.847
Validation loss decreased (-0.597201 --> -0.847205).  Saving model ...
Epoch: 4 cost time: 0.5521774291992188
Epoch: 4, Steps: 7 | Train Loss: 1.267 Vali Loss: 1.246 Vali Acc: 0.931 Test Loss: 1.246 Test Acc: 0.931
Validation loss decreased (-0.847205 --> -0.930543).  Saving model ...
Epoch: 5 cost time: 0.5539696216583252
Epoch: 5, Steps: 7 | Train Loss: 0.737 Vali Loss: 0.789 Vali Acc: 0.889 Test Loss: 0.789 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5991687774658203
Epoch: 6, Steps: 7 | Train Loss: 0.341 Vali Loss: 0.466 Vali Acc: 0.944 Test Loss: 0.466 Test Acc: 0.944
Validation loss decreased (-0.930543 --> -0.944440).  Saving model ...
Epoch: 7 cost time: 0.6134243011474609
Epoch: 7, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5364730358123779
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.607933759689331
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6284456253051758
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5258457660675049
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6271357536315918
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5310587882995605
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7451388835906982
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.5984816551208496
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.6058540344238281
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.5945320129394531
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.5734295845031738
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.4871373176574707
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 0.4949488639831543
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5036115646362305
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5655183792114258
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5672616958618164
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4866666793823242
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5138838291168213
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4980125427246094
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5881979465484619
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5413029193878174
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5773231983184814
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 756812
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7767906188964844
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.483 Vali Acc: 0.111 Test Loss: 2.483 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6896753311157227
Epoch: 2, Steps: 7 | Train Loss: 2.360 Vali Loss: 2.326 Vali Acc: 0.403 Test Loss: 2.326 Test Acc: 0.403
Validation loss decreased (-0.111086 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.6018731594085693
Epoch: 3, Steps: 7 | Train Loss: 2.053 Vali Loss: 2.070 Vali Acc: 0.667 Test Loss: 2.070 Test Acc: 0.667
Validation loss decreased (-0.402755 --> -0.666646).  Saving model ...
Epoch: 4 cost time: 0.5714240074157715
Epoch: 4, Steps: 7 | Train Loss: 1.650 Vali Loss: 1.709 Vali Acc: 0.833 Test Loss: 1.709 Test Acc: 0.833
Validation loss decreased (-0.666646 --> -0.833316).  Saving model ...
Epoch: 5 cost time: 0.5991251468658447
Epoch: 5, Steps: 7 | Train Loss: 1.192 Vali Loss: 1.291 Vali Acc: 0.792 Test Loss: 1.291 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5823216438293457
Epoch: 6, Steps: 7 | Train Loss: 0.745 Vali Loss: 0.896 Vali Acc: 0.861 Test Loss: 0.896 Test Acc: 0.861
Validation loss decreased (-0.833316 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 0.514317512512207
Epoch: 7, Steps: 7 | Train Loss: 0.388 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.5703024864196777
Epoch: 8, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.5578656196594238
Epoch: 9, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.5760104656219482
Epoch: 10, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.6260364055633545
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6100049018859863
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5900347232818604
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.6403493881225586
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6070647239685059
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5430467128753662
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.5949275493621826
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.540353536605835
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5157601833343506
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5754618644714355
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5797700881958008
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5790748596191406
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6088621616363525
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.5804781913757324
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5277879238128662
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6035444736480713
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.606318473815918
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.5877468585968018
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.5675158500671387
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5584423542022705
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6741423606872559
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6042802333831787
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6146368980407715
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6464343070983887
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.5720720291137695
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.6569082736968994
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5446419715881348
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5833644866943359
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5157046318054199
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5423662662506104
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5245108604431152
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.518240213394165
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5897183418273926
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5764436721801758
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5815188884735107
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 694220
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8231430053710938
Epoch: 1, Steps: 7 | Train Loss: 2.519 Vali Loss: 2.447 Vali Acc: 0.194 Test Loss: 2.447 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.5582733154296875
Epoch: 2, Steps: 7 | Train Loss: 2.374 Vali Loss: 2.310 Vali Acc: 0.458 Test Loss: 2.310 Test Acc: 0.458
Validation loss decreased (-0.194420 --> -0.458310).  Saving model ...
Epoch: 3 cost time: 0.5496888160705566
Epoch: 3, Steps: 7 | Train Loss: 2.117 Vali Loss: 2.079 Vali Acc: 0.722 Test Loss: 2.079 Test Acc: 0.722
Validation loss decreased (-0.458310 --> -0.722201).  Saving model ...
Epoch: 4 cost time: 0.612769365310669
Epoch: 4, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.761 Vali Acc: 0.806 Test Loss: 1.761 Test Acc: 0.806
Validation loss decreased (-0.722201 --> -0.805538).  Saving model ...
Epoch: 5 cost time: 0.587094783782959
Epoch: 5, Steps: 7 | Train Loss: 1.356 Vali Loss: 1.374 Vali Acc: 0.889 Test Loss: 1.374 Test Acc: 0.889
Validation loss decreased (-0.805538 --> -0.888875).  Saving model ...
Epoch: 6 cost time: 0.5873458385467529
Epoch: 6, Steps: 7 | Train Loss: 0.934 Vali Loss: 0.986 Vali Acc: 0.875 Test Loss: 0.986 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6051483154296875
Epoch: 7, Steps: 7 | Train Loss: 0.565 Vali Loss: 0.683 Vali Acc: 0.903 Test Loss: 0.683 Test Acc: 0.903
Validation loss decreased (-0.888875 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 0.5805773735046387
Epoch: 8, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.472 Vali Acc: 0.903 Test Loss: 0.472 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.5647726058959961
Epoch: 9, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.373 Vali Acc: 0.931 Test Loss: 0.373 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.5477488040924072
Epoch: 10, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6057174205780029
Epoch: 11, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.60064697265625
Epoch: 12, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5405399799346924
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5350878238677979
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5198843479156494
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6239809989929199
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5229625701904297
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5930609703063965
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5907063484191895
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.5865640640258789
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.5384426116943359
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.5216941833496094
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5038778781890869
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.5816948413848877
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5782647132873535
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.5770411491394043
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.6030361652374268
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.5628471374511719
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5246222019195557
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5737314224243164
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6296467781066895
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6156156063079834
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5837576389312744
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5647056102752686
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6824727058410645
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.5451452732086182
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.5687379837036133
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.576430082321167
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.6176934242248535
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.5931746959686279
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.6135172843933105
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6150751113891602
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.573789119720459
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.6082162857055664
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.5948076248168945
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.5966653823852539
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.5971872806549072
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.6048345565795898
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.6705434322357178
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.6349849700927734
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 668492
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.79026460647583
Epoch: 1, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.412 Vali Acc: 0.208 Test Loss: 2.412 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.5653350353240967
Epoch: 2, Steps: 7 | Train Loss: 2.325 Vali Loss: 2.301 Vali Acc: 0.403 Test Loss: 2.301 Test Acc: 0.403
Validation loss decreased (-0.208309 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.5745368003845215
Epoch: 3, Steps: 7 | Train Loss: 2.144 Vali Loss: 2.119 Vali Acc: 0.639 Test Loss: 2.119 Test Acc: 0.639
Validation loss decreased (-0.402755 --> -0.638868).  Saving model ...
Epoch: 4 cost time: 0.6386785507202148
Epoch: 4, Steps: 7 | Train Loss: 1.869 Vali Loss: 1.877 Vali Acc: 0.764 Test Loss: 1.877 Test Acc: 0.764
Validation loss decreased (-0.638868 --> -0.763870).  Saving model ...
Epoch: 5 cost time: 0.542360782623291
Epoch: 5, Steps: 7 | Train Loss: 1.553 Vali Loss: 1.573 Vali Acc: 0.819 Test Loss: 1.573 Test Acc: 0.819
Validation loss decreased (-0.763870 --> -0.819429).  Saving model ...
Epoch: 6 cost time: 0.5680081844329834
Epoch: 6, Steps: 7 | Train Loss: 1.190 Vali Loss: 1.252 Vali Acc: 0.861 Test Loss: 1.252 Test Acc: 0.861
Validation loss decreased (-0.819429 --> -0.861099).  Saving model ...
Epoch: 7 cost time: 0.5956439971923828
Epoch: 7, Steps: 7 | Train Loss: 0.864 Vali Loss: 0.940 Vali Acc: 0.903 Test Loss: 0.940 Test Acc: 0.903
Validation loss decreased (-0.861099 --> -0.902768).  Saving model ...
Epoch: 8 cost time: 0.5558388233184814
Epoch: 8, Steps: 7 | Train Loss: 0.574 Vali Loss: 0.695 Vali Acc: 0.931 Test Loss: 0.695 Test Acc: 0.931
Validation loss decreased (-0.902768 --> -0.930549).  Saving model ...
Epoch: 9 cost time: 0.5486862659454346
Epoch: 9, Steps: 7 | Train Loss: 0.342 Vali Loss: 0.511 Vali Acc: 0.944 Test Loss: 0.511 Test Acc: 0.944
Validation loss decreased (-0.930549 --> -0.944439).  Saving model ...
Epoch: 10 cost time: 0.6072502136230469
Epoch: 10, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.418 Vali Acc: 0.917 Test Loss: 0.418 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5688991546630859
Epoch: 11, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6089344024658203
Epoch: 12, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6832940578460693
Epoch: 13, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.536567211151123
Epoch: 14, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5340299606323242
Epoch: 15, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5784857273101807
Epoch: 16, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5608384609222412
Epoch: 17, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5995707511901855
Epoch: 18, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5393948554992676
Epoch: 19, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.63350510597229
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5707926750183105
Epoch: 21, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5494914054870605
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5738365650177002
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5660085678100586
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5811641216278076
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5875182151794434
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5873043537139893
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6083970069885254
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5710790157318115
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6169381141662598
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6621291637420654
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5877971649169922
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5604848861694336
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.56280517578125
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5775418281555176
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5948231220245361
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5262060165405273
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5786788463592529
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5858354568481445
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5467016696929932
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6163246631622314
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5100207328796387
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.6174211502075195
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.5417311191558838
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.5431432723999023
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5532212257385254
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.5969173908233643
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5668842792510986
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5708127021789551
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.6399588584899902
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 644684
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.734325647354126
Epoch: 1, Steps: 7 | Train Loss: 2.549 Vali Loss: 2.493 Vali Acc: 0.069 Test Loss: 2.493 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.5324220657348633
Epoch: 2, Steps: 7 | Train Loss: 2.449 Vali Loss: 2.406 Vali Acc: 0.181 Test Loss: 2.406 Test Acc: 0.181
Validation loss decreased (-0.069420 --> -0.180531).  Saving model ...
Epoch: 3 cost time: 0.5037367343902588
Epoch: 3, Steps: 7 | Train Loss: 2.281 Vali Loss: 2.264 Vali Acc: 0.319 Test Loss: 2.264 Test Acc: 0.319
Validation loss decreased (-0.180531 --> -0.319422).  Saving model ...
Epoch: 4 cost time: 0.588050365447998
Epoch: 4, Steps: 7 | Train Loss: 2.065 Vali Loss: 2.074 Vali Acc: 0.556 Test Loss: 2.074 Test Acc: 0.556
Validation loss decreased (-0.319422 --> -0.555535).  Saving model ...
Epoch: 5 cost time: 0.5126817226409912
Epoch: 5, Steps: 7 | Train Loss: 1.795 Vali Loss: 1.844 Vali Acc: 0.736 Test Loss: 1.844 Test Acc: 0.736
Validation loss decreased (-0.555535 --> -0.736093).  Saving model ...
Epoch: 6 cost time: 0.5764532089233398
Epoch: 6, Steps: 7 | Train Loss: 1.507 Vali Loss: 1.584 Vali Acc: 0.792 Test Loss: 1.584 Test Acc: 0.792
Validation loss decreased (-0.736093 --> -0.791651).  Saving model ...
Epoch: 7 cost time: 0.5946457386016846
Epoch: 7, Steps: 7 | Train Loss: 1.201 Vali Loss: 1.299 Vali Acc: 0.847 Test Loss: 1.299 Test Acc: 0.847
Validation loss decreased (-0.791651 --> -0.847209).  Saving model ...
Epoch: 8 cost time: 0.5316324234008789
Epoch: 8, Steps: 7 | Train Loss: 0.893 Vali Loss: 1.027 Vali Acc: 0.861 Test Loss: 1.027 Test Acc: 0.861
Validation loss decreased (-0.847209 --> -0.861101).  Saving model ...
Epoch: 9 cost time: 0.5696887969970703
Epoch: 9, Steps: 7 | Train Loss: 0.620 Vali Loss: 0.797 Vali Acc: 0.889 Test Loss: 0.797 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888881).  Saving model ...
Epoch: 10 cost time: 0.5816569328308105
Epoch: 10, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.615 Vali Acc: 0.903 Test Loss: 0.615 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902772).  Saving model ...
Epoch: 11 cost time: 0.5332179069519043
Epoch: 11, Steps: 7 | Train Loss: 0.244 Vali Loss: 0.499 Vali Acc: 0.917 Test Loss: 0.499 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 0.5587396621704102
Epoch: 12, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5617668628692627
Epoch: 13, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49303746223449707
Epoch: 14, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.5841424465179443
Epoch: 15, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.49747180938720703
Epoch: 16, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.567192792892456
Epoch: 17, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.606097936630249
Epoch: 18, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.6045618057250977
Epoch: 19, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.5382509231567383
Epoch: 20, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.588446855545044
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.5074045658111572
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5359628200531006
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.6094996929168701
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5806107521057129
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.5229966640472412
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6105239391326904
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.5706541538238525
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5468339920043945
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.5299386978149414
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5528318881988525
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7079131603240967
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5103731155395508
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.5512754917144775
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.5830433368682861
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.5464608669281006
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.5789825916290283
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.5680370330810547
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.5588414669036865
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.6170659065246582
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.5465288162231445
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5606398582458496
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.5104670524597168
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.5212192535400391
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5858821868896484
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6612331867218018
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5836777687072754
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6376857757568359
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5847253799438477
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5665979385375977
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 630092
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8625953197479248
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.426 Vali Acc: 0.250 Test Loss: 2.426 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 0.5865433216094971
Epoch: 2, Steps: 7 | Train Loss: 2.406 Vali Loss: 2.352 Vali Acc: 0.417 Test Loss: 2.352 Test Acc: 0.417
Validation loss decreased (-0.249976 --> -0.416643).  Saving model ...
Epoch: 3 cost time: 0.5787022113800049
Epoch: 3, Steps: 7 | Train Loss: 2.263 Vali Loss: 2.232 Vali Acc: 0.500 Test Loss: 2.232 Test Acc: 0.500
Validation loss decreased (-0.416643 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 0.5265331268310547
Epoch: 4, Steps: 7 | Train Loss: 2.090 Vali Loss: 2.075 Vali Acc: 0.653 Test Loss: 2.075 Test Acc: 0.653
Validation loss decreased (-0.499978 --> -0.652757).  Saving model ...
Epoch: 5 cost time: 0.5306930541992188
Epoch: 5, Steps: 7 | Train Loss: 1.880 Vali Loss: 1.889 Vali Acc: 0.792 Test Loss: 1.889 Test Acc: 0.792
Validation loss decreased (-0.652757 --> -0.791648).  Saving model ...
Epoch: 6 cost time: 0.501373291015625
Epoch: 6, Steps: 7 | Train Loss: 1.627 Vali Loss: 1.671 Vali Acc: 0.847 Test Loss: 1.671 Test Acc: 0.847
Validation loss decreased (-0.791648 --> -0.847206).  Saving model ...
Epoch: 7 cost time: 0.5487902164459229
Epoch: 7, Steps: 7 | Train Loss: 1.372 Vali Loss: 1.440 Vali Acc: 0.861 Test Loss: 1.440 Test Acc: 0.861
Validation loss decreased (-0.847206 --> -0.861097).  Saving model ...
Epoch: 8 cost time: 0.5944616794586182
Epoch: 8, Steps: 7 | Train Loss: 1.103 Vali Loss: 1.196 Vali Acc: 0.875 Test Loss: 1.196 Test Acc: 0.875
Validation loss decreased (-0.861097 --> -0.874988).  Saving model ...
Epoch: 9 cost time: 0.5229167938232422
Epoch: 9, Steps: 7 | Train Loss: 0.852 Vali Loss: 0.975 Vali Acc: 0.889 Test Loss: 0.975 Test Acc: 0.889
Validation loss decreased (-0.874988 --> -0.888879).  Saving model ...
Epoch: 10 cost time: 0.5157220363616943
Epoch: 10, Steps: 7 | Train Loss: 0.601 Vali Loss: 0.790 Vali Acc: 0.903 Test Loss: 0.790 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902770).  Saving model ...
Epoch: 11 cost time: 0.559375524520874
Epoch: 11, Steps: 7 | Train Loss: 0.407 Vali Loss: 0.657 Vali Acc: 0.889 Test Loss: 0.657 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4767920970916748
Epoch: 12, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.556 Vali Acc: 0.903 Test Loss: 0.556 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902772).  Saving model ...
Epoch: 13 cost time: 0.5167512893676758
Epoch: 13, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6154587268829346
Epoch: 14, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 0.5342025756835938
Epoch: 15, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5429456233978271
Epoch: 16, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6084091663360596
Epoch: 17, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5410401821136475
Epoch: 18, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5874185562133789
Epoch: 19, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5107448101043701
Epoch: 20, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5566821098327637
Epoch: 21, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5113446712493896
Epoch: 22, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5523991584777832
Epoch: 23, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4946472644805908
Epoch: 24, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.5342285633087158
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.5694217681884766
Epoch: 26, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.5478200912475586
Epoch: 27, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.4974484443664551
Epoch: 28, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5593602657318115
Epoch: 29, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5384681224822998
Epoch: 30, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5264644622802734
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.5338010787963867
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.5668799877166748
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.5675556659698486
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.5778892040252686
Epoch: 35, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.6338436603546143
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.5896091461181641
Epoch: 37, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.6106586456298828
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.6134707927703857
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5848312377929688
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6241536140441895
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.605255126953125
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.5788516998291016
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.5466752052307129
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.5093181133270264
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.506669282913208
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6078741550445557
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.5593318939208984
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.5729413032531738
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5646836757659912
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 624716
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8971588611602783
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.461 Vali Acc: 0.069 Test Loss: 2.461 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.622936487197876
Epoch: 2, Steps: 7 | Train Loss: 2.288 Vali Loss: 2.275 Vali Acc: 0.528 Test Loss: 2.275 Test Acc: 0.528
Validation loss decreased (-0.069420 --> -0.527755).  Saving model ...
Epoch: 3 cost time: 0.5319864749908447
Epoch: 3, Steps: 7 | Train Loss: 1.900 Vali Loss: 1.981 Vali Acc: 0.806 Test Loss: 1.981 Test Acc: 0.806
Validation loss decreased (-0.527755 --> -0.805536).  Saving model ...
Epoch: 4 cost time: 0.5948581695556641
Epoch: 4, Steps: 7 | Train Loss: 1.409 Vali Loss: 1.564 Vali Acc: 0.889 Test Loss: 1.564 Test Acc: 0.889
Validation loss decreased (-0.805536 --> -0.888873).  Saving model ...
Epoch: 5 cost time: 0.6184101104736328
Epoch: 5, Steps: 7 | Train Loss: 0.909 Vali Loss: 1.115 Vali Acc: 0.889 Test Loss: 1.115 Test Acc: 0.889
Validation loss decreased (-0.888873 --> -0.888878).  Saving model ...
Epoch: 6 cost time: 0.5619704723358154
Epoch: 6, Steps: 7 | Train Loss: 0.504 Vali Loss: 0.723 Vali Acc: 0.917 Test Loss: 0.723 Test Acc: 0.917
Validation loss decreased (-0.888878 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 0.6103589534759521
Epoch: 7, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.477 Vali Acc: 0.931 Test Loss: 0.477 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930551).  Saving model ...
Epoch: 8 cost time: 0.6360666751861572
Epoch: 8, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.355 Vali Acc: 0.931 Test Loss: 0.355 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.6391141414642334
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.5683770179748535
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5498194694519043
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6102657318115234
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5690817832946777
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5747518539428711
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5997271537780762
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5693421363830566
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.5452163219451904
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5291728973388672
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5700020790100098
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5818741321563721
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5622975826263428
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.559739351272583
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5225012302398682
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.4832913875579834
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5115871429443359
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.48643970489501953
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.542802095413208
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4486575126647949
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.530634880065918
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5173478126525879
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6535155773162842
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5234606266021729
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.5739023685455322
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.538398027420044
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.5726845264434814
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.5701310634613037
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.607147216796875
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6224596500396729
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.5239999294281006
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.640697717666626
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.6140027046203613
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.6233034133911133
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.6175961494445801
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.5648939609527588
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.5159311294555664
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.5023324489593506
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.5264418125152588
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5834035873413086
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.53322434425354
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5472478866577148
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 342636
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9108660221099854
Epoch: 1, Steps: 7 | Train Loss: 2.462 Vali Loss: 2.408 Vali Acc: 0.167 Test Loss: 2.408 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.5408453941345215
Epoch: 2, Steps: 7 | Train Loss: 2.351 Vali Loss: 2.298 Vali Acc: 0.500 Test Loss: 2.298 Test Acc: 0.500
Validation loss decreased (-0.166643 --> -0.499977).  Saving model ...
Epoch: 3 cost time: 0.5921311378479004
Epoch: 3, Steps: 7 | Train Loss: 2.117 Vali Loss: 2.117 Vali Acc: 0.722 Test Loss: 2.117 Test Acc: 0.722
Validation loss decreased (-0.499977 --> -0.722201).  Saving model ...
Epoch: 4 cost time: 0.6097488403320312
Epoch: 4, Steps: 7 | Train Loss: 1.820 Vali Loss: 1.860 Vali Acc: 0.819 Test Loss: 1.860 Test Acc: 0.819
Validation loss decreased (-0.722201 --> -0.819426).  Saving model ...
Epoch: 5 cost time: 0.5877389907836914
Epoch: 5, Steps: 7 | Train Loss: 1.504 Vali Loss: 1.538 Vali Acc: 0.847 Test Loss: 1.538 Test Acc: 0.847
Validation loss decreased (-0.819426 --> -0.847207).  Saving model ...
Epoch: 6 cost time: 0.5318090915679932
Epoch: 6, Steps: 7 | Train Loss: 1.129 Vali Loss: 1.197 Vali Acc: 0.861 Test Loss: 1.197 Test Acc: 0.861
Validation loss decreased (-0.847207 --> -0.861099).  Saving model ...
Epoch: 7 cost time: 0.5229098796844482
Epoch: 7, Steps: 7 | Train Loss: 0.770 Vali Loss: 0.890 Vali Acc: 0.875 Test Loss: 0.890 Test Acc: 0.875
Validation loss decreased (-0.861099 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 0.5231039524078369
Epoch: 8, Steps: 7 | Train Loss: 0.465 Vali Loss: 0.642 Vali Acc: 0.931 Test Loss: 0.642 Test Acc: 0.931
Validation loss decreased (-0.874991 --> -0.930549).  Saving model ...
Epoch: 9 cost time: 0.5816986560821533
Epoch: 9, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.478 Vali Acc: 0.931 Test Loss: 0.478 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 0.45420169830322266
Epoch: 10, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.374 Vali Acc: 0.931 Test Loss: 0.374 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.5469543933868408
Epoch: 11, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.5511760711669922
Epoch: 12, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.5431749820709229
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5127944946289062
Epoch: 14, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.454817533493042
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5697522163391113
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.546433687210083
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.47639012336730957
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5193939208984375
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5472445487976074
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.48868656158447266
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5231270790100098
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.48917365074157715
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5193829536437988
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5547559261322021
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5272047519683838
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4930572509765625
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4841911792755127
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.4831845760345459
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.4877898693084717
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5281026363372803
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.4749279022216797
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.553502082824707
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5295259952545166
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.47524166107177734
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5150601863861084
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6083238124847412
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5222628116607666
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5748844146728516
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5467343330383301
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.45395517349243164
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5801749229431152
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5515034198760986
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5693802833557129
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.47689056396484375
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.4942646026611328
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.513822078704834
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.49272656440734863
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5136055946350098
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.4790370464324951
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 251436
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7078182697296143
Epoch: 1, Steps: 7 | Train Loss: 2.500 Vali Loss: 2.476 Vali Acc: 0.056 Test Loss: 2.476 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.5488853454589844
Epoch: 2, Steps: 7 | Train Loss: 2.399 Vali Loss: 2.387 Vali Acc: 0.167 Test Loss: 2.387 Test Acc: 0.167
Validation loss decreased (-0.055531 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.5803523063659668
Epoch: 3, Steps: 7 | Train Loss: 2.239 Vali Loss: 2.237 Vali Acc: 0.528 Test Loss: 2.237 Test Acc: 0.528
Validation loss decreased (-0.166643 --> -0.527755).  Saving model ...
Epoch: 4 cost time: 0.5404205322265625
Epoch: 4, Steps: 7 | Train Loss: 2.028 Vali Loss: 2.040 Vali Acc: 0.639 Test Loss: 2.040 Test Acc: 0.639
Validation loss decreased (-0.527755 --> -0.638868).  Saving model ...
Epoch: 5 cost time: 0.5743649005889893
Epoch: 5, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.805 Vali Acc: 0.778 Test Loss: 1.805 Test Acc: 0.778
Validation loss decreased (-0.638868 --> -0.777760).  Saving model ...
Epoch: 6 cost time: 0.5429835319519043
Epoch: 6, Steps: 7 | Train Loss: 1.480 Vali Loss: 1.519 Vali Acc: 0.806 Test Loss: 1.519 Test Acc: 0.806
Validation loss decreased (-0.777760 --> -0.805540).  Saving model ...
Epoch: 7 cost time: 0.5854837894439697
Epoch: 7, Steps: 7 | Train Loss: 1.153 Vali Loss: 1.241 Vali Acc: 0.861 Test Loss: 1.241 Test Acc: 0.861
Validation loss decreased (-0.805540 --> -0.861099).  Saving model ...
Epoch: 8 cost time: 0.5694136619567871
Epoch: 8, Steps: 7 | Train Loss: 0.853 Vali Loss: 0.963 Vali Acc: 0.917 Test Loss: 0.963 Test Acc: 0.917
Validation loss decreased (-0.861099 --> -0.916657).  Saving model ...
Epoch: 9 cost time: 0.5857884883880615
Epoch: 9, Steps: 7 | Train Loss: 0.567 Vali Loss: 0.743 Vali Acc: 0.903 Test Loss: 0.743 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.688014030456543
Epoch: 10, Steps: 7 | Train Loss: 0.364 Vali Loss: 0.588 Vali Acc: 0.889 Test Loss: 0.588 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5465562343597412
Epoch: 11, Steps: 7 | Train Loss: 0.221 Vali Loss: 0.484 Vali Acc: 0.889 Test Loss: 0.484 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6554207801818848
Epoch: 12, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.417 Vali Acc: 0.917 Test Loss: 0.417 Test Acc: 0.917
Validation loss decreased (-0.916657 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 0.6068005561828613
Epoch: 13, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.5958855152130127
Epoch: 14, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.5688307285308838
Epoch: 15, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.6097311973571777
Epoch: 16, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.605445384979248
Epoch: 17, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6322133541107178
Epoch: 18, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5311071872711182
Epoch: 19, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5585570335388184
Epoch: 20, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6198077201843262
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5330424308776855
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5556590557098389
Epoch: 23, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5339784622192383
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.641690731048584
Epoch: 25, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6514873504638672
Epoch: 26, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 220140
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.690131664276123
Epoch: 1, Steps: 7 | Train Loss: 2.528 Vali Loss: 2.487 Vali Acc: 0.028 Test Loss: 2.487 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.6420409679412842
Epoch: 2, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.414 Vali Acc: 0.194 Test Loss: 2.414 Test Acc: 0.194
Validation loss decreased (-0.027753 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.550910234451294
Epoch: 3, Steps: 7 | Train Loss: 2.298 Vali Loss: 2.291 Vali Acc: 0.444 Test Loss: 2.291 Test Acc: 0.444
Validation loss decreased (-0.194420 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 0.5130236148834229
Epoch: 4, Steps: 7 | Train Loss: 2.132 Vali Loss: 2.122 Vali Acc: 0.625 Test Loss: 2.122 Test Acc: 0.625
Validation loss decreased (-0.444422 --> -0.624979).  Saving model ...
Epoch: 5 cost time: 0.5136356353759766
Epoch: 5, Steps: 7 | Train Loss: 1.901 Vali Loss: 1.909 Vali Acc: 0.750 Test Loss: 1.909 Test Acc: 0.750
Validation loss decreased (-0.624979 --> -0.749981).  Saving model ...
Epoch: 6 cost time: 0.5510516166687012
Epoch: 6, Steps: 7 | Train Loss: 1.641 Vali Loss: 1.656 Vali Acc: 0.806 Test Loss: 1.656 Test Acc: 0.806
Validation loss decreased (-0.749981 --> -0.805539).  Saving model ...
Epoch: 7 cost time: 0.6643826961517334
Epoch: 7, Steps: 7 | Train Loss: 1.330 Vali Loss: 1.368 Vali Acc: 0.847 Test Loss: 1.368 Test Acc: 0.847
Validation loss decreased (-0.805539 --> -0.847209).  Saving model ...
Epoch: 8 cost time: 0.5988359451293945
Epoch: 8, Steps: 7 | Train Loss: 1.042 Vali Loss: 1.099 Vali Acc: 0.889 Test Loss: 1.099 Test Acc: 0.889
Validation loss decreased (-0.847209 --> -0.888878).  Saving model ...
Epoch: 9 cost time: 0.4979593753814697
Epoch: 9, Steps: 7 | Train Loss: 0.753 Vali Loss: 0.860 Vali Acc: 0.917 Test Loss: 0.860 Test Acc: 0.917
Validation loss decreased (-0.888878 --> -0.916658).  Saving model ...
Epoch: 10 cost time: 0.5317070484161377
Epoch: 10, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.657 Vali Acc: 0.889 Test Loss: 0.657 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.502478837966919
Epoch: 11, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5391483306884766
Epoch: 12, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5147876739501953
Epoch: 13, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5560250282287598
Epoch: 14, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
Validation loss decreased (-0.916658 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.5145795345306396
Epoch: 15, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.5414891242980957
Epoch: 16, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.6125478744506836
Epoch: 17, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.6600508689880371
Epoch: 18, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.558912992477417
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.5527417659759521
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6060326099395752
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.5769414901733398
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.6046702861785889
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.5755500793457031
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5868620872497559
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.5697870254516602
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.572045087814331
Epoch: 27, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.5818254947662354
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5346829891204834
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.5174424648284912
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.5894451141357422
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.6320688724517822
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.6089785099029541
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.6248302459716797
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.5742533206939697
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.5528576374053955
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.5909090042114258
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.5554509162902832
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.5438249111175537
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5933642387390137
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.521683931350708
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5594093799591064
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.5395243167877197
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 44 cost time: 0.6061890125274658
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 45 cost time: 0.6105310916900635
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 0.5889782905578613
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 47 cost time: 0.5970308780670166
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 48 cost time: 0.5766861438751221
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.598059892654419
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 50 cost time: 0.5582089424133301
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 207276
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.958500862121582
Epoch: 1, Steps: 7 | Train Loss: 2.485 Vali Loss: 2.484 Vali Acc: 0.083 Test Loss: 2.484 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.5592236518859863
Epoch: 2, Steps: 7 | Train Loss: 2.425 Vali Loss: 2.426 Vali Acc: 0.111 Test Loss: 2.426 Test Acc: 0.111
Validation loss decreased (-0.083308 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.5100600719451904
Epoch: 3, Steps: 7 | Train Loss: 2.323 Vali Loss: 2.331 Vali Acc: 0.333 Test Loss: 2.331 Test Acc: 0.333
Validation loss decreased (-0.111087 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 0.5176405906677246
Epoch: 4, Steps: 7 | Train Loss: 2.174 Vali Loss: 2.204 Vali Acc: 0.486 Test Loss: 2.204 Test Acc: 0.486
Validation loss decreased (-0.333310 --> -0.486089).  Saving model ...
Epoch: 5 cost time: 0.4919555187225342
Epoch: 5, Steps: 7 | Train Loss: 2.032 Vali Loss: 2.052 Vali Acc: 0.653 Test Loss: 2.052 Test Acc: 0.653
Validation loss decreased (-0.486089 --> -0.652757).  Saving model ...
Epoch: 6 cost time: 0.5633363723754883
Epoch: 6, Steps: 7 | Train Loss: 1.846 Vali Loss: 1.866 Vali Acc: 0.792 Test Loss: 1.866 Test Acc: 0.792
Validation loss decreased (-0.652757 --> -0.791648).  Saving model ...
Epoch: 7 cost time: 0.545626163482666
Epoch: 7, Steps: 7 | Train Loss: 1.617 Vali Loss: 1.652 Vali Acc: 0.847 Test Loss: 1.652 Test Acc: 0.847
Validation loss decreased (-0.791648 --> -0.847206).  Saving model ...
Epoch: 8 cost time: 0.49222493171691895
Epoch: 8, Steps: 7 | Train Loss: 1.382 Vali Loss: 1.410 Vali Acc: 0.875 Test Loss: 1.410 Test Acc: 0.875
Validation loss decreased (-0.847206 --> -0.874986).  Saving model ...
Epoch: 9 cost time: 0.4758594036102295
Epoch: 9, Steps: 7 | Train Loss: 1.125 Vali Loss: 1.168 Vali Acc: 0.903 Test Loss: 1.168 Test Acc: 0.903
Validation loss decreased (-0.874986 --> -0.902766).  Saving model ...
Epoch: 10 cost time: 0.5261645317077637
Epoch: 10, Steps: 7 | Train Loss: 0.879 Vali Loss: 0.949 Vali Acc: 0.931 Test Loss: 0.949 Test Acc: 0.931
Validation loss decreased (-0.902766 --> -0.930546).  Saving model ...
Epoch: 11 cost time: 0.5727798938751221
Epoch: 11, Steps: 7 | Train Loss: 0.658 Vali Loss: 0.753 Vali Acc: 0.944 Test Loss: 0.753 Test Acc: 0.944
Validation loss decreased (-0.930546 --> -0.944437).  Saving model ...
Epoch: 12 cost time: 0.4820413589477539
Epoch: 12, Steps: 7 | Train Loss: 0.472 Vali Loss: 0.613 Vali Acc: 0.944 Test Loss: 0.613 Test Acc: 0.944
Validation loss decreased (-0.944437 --> -0.944438).  Saving model ...
Epoch: 13 cost time: 0.5066285133361816
Epoch: 13, Steps: 7 | Train Loss: 0.339 Vali Loss: 0.512 Vali Acc: 0.931 Test Loss: 0.512 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4963712692260742
Epoch: 14, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.436 Vali Acc: 0.917 Test Loss: 0.436 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5426421165466309
Epoch: 15, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.387 Vali Acc: 0.931 Test Loss: 0.387 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5355126857757568
Epoch: 16, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.350 Vali Acc: 0.931 Test Loss: 0.350 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5579369068145752
Epoch: 17, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.5515110492706299
Epoch: 18, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.5667669773101807
Epoch: 19, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5454535484313965
Epoch: 20, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.530785083770752
Epoch: 21, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.554187536239624
Epoch: 22, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5256898403167725
Epoch: 23, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5262179374694824
Epoch: 24, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4845156669616699
Epoch: 25, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5385708808898926
Epoch: 26, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5205771923065186
Epoch: 27, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4846076965332031
Epoch: 28, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5002810955047607
Epoch: 29, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5482597351074219
Epoch: 30, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5238749980926514
Epoch: 31, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5354413986206055
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5900592803955078
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5046989917755127
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5681827068328857
Epoch: 35, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.4806857109069824
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5213854312896729
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.518702507019043
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5463688373565674
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5193283557891846
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5356833934783936
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.48223066329956055
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5820932388305664
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.5033681392669678
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.5250773429870605
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.5558164119720459
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.45322108268737793
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5921549797058105
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5449063777923584
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5989911556243896
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 195372
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7768194675445557
Epoch: 1, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.486 Vali Acc: 0.056 Test Loss: 2.486 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.5201351642608643
Epoch: 2, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.442 Vali Acc: 0.167 Test Loss: 2.442 Test Acc: 0.167
Validation loss decreased (-0.055531 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.5394108295440674
Epoch: 3, Steps: 7 | Train Loss: 2.385 Vali Loss: 2.364 Vali Acc: 0.222 Test Loss: 2.364 Test Acc: 0.222
Validation loss decreased (-0.166642 --> -0.222199).  Saving model ...
Epoch: 4 cost time: 0.5215232372283936
Epoch: 4, Steps: 7 | Train Loss: 2.256 Vali Loss: 2.257 Vali Acc: 0.389 Test Loss: 2.257 Test Acc: 0.389
Validation loss decreased (-0.222199 --> -0.388866).  Saving model ...
Epoch: 5 cost time: 0.4999573230743408
Epoch: 5, Steps: 7 | Train Loss: 2.120 Vali Loss: 2.128 Vali Acc: 0.528 Test Loss: 2.128 Test Acc: 0.528
Validation loss decreased (-0.388866 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 0.5234231948852539
Epoch: 6, Steps: 7 | Train Loss: 1.970 Vali Loss: 1.978 Vali Acc: 0.611 Test Loss: 1.978 Test Acc: 0.611
Validation loss decreased (-0.527757 --> -0.611091).  Saving model ...
Epoch: 7 cost time: 0.544957160949707
Epoch: 7, Steps: 7 | Train Loss: 1.789 Vali Loss: 1.804 Vali Acc: 0.694 Test Loss: 1.804 Test Acc: 0.694
Validation loss decreased (-0.611091 --> -0.694426).  Saving model ...
Epoch: 8 cost time: 0.5699470043182373
Epoch: 8, Steps: 7 | Train Loss: 1.602 Vali Loss: 1.612 Vali Acc: 0.750 Test Loss: 1.612 Test Acc: 0.750
Validation loss decreased (-0.694426 --> -0.749984).  Saving model ...
Epoch: 9 cost time: 0.5307266712188721
Epoch: 9, Steps: 7 | Train Loss: 1.389 Vali Loss: 1.421 Vali Acc: 0.792 Test Loss: 1.421 Test Acc: 0.792
Validation loss decreased (-0.749984 --> -0.791652).  Saving model ...
Epoch: 10 cost time: 0.4626328945159912
Epoch: 10, Steps: 7 | Train Loss: 1.177 Vali Loss: 1.233 Vali Acc: 0.819 Test Loss: 1.233 Test Acc: 0.819
Validation loss decreased (-0.791652 --> -0.819432).  Saving model ...
Epoch: 11 cost time: 0.461824893951416
Epoch: 11, Steps: 7 | Train Loss: 0.956 Vali Loss: 1.050 Vali Acc: 0.819 Test Loss: 1.050 Test Acc: 0.819
Validation loss decreased (-0.819432 --> -0.819434).  Saving model ...
Epoch: 12 cost time: 0.5431890487670898
Epoch: 12, Steps: 7 | Train Loss: 0.775 Vali Loss: 0.885 Vali Acc: 0.819 Test Loss: 0.885 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819436).  Saving model ...
Epoch: 13 cost time: 0.5043144226074219
Epoch: 13, Steps: 7 | Train Loss: 0.597 Vali Loss: 0.744 Vali Acc: 0.875 Test Loss: 0.744 Test Acc: 0.875
Validation loss decreased (-0.819436 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.5109508037567139
Epoch: 14, Steps: 7 | Train Loss: 0.462 Vali Loss: 0.634 Vali Acc: 0.875 Test Loss: 0.634 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.501500129699707
Epoch: 15, Steps: 7 | Train Loss: 0.348 Vali Loss: 0.553 Vali Acc: 0.889 Test Loss: 0.553 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 0.6039721965789795
Epoch: 16, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.491 Vali Acc: 0.917 Test Loss: 0.491 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 0.5307977199554443
Epoch: 17, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.458 Vali Acc: 0.903 Test Loss: 0.458 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5688095092773438
Epoch: 18, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.421 Vali Acc: 0.903 Test Loss: 0.421 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6090505123138428
Epoch: 19, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.397 Vali Acc: 0.931 Test Loss: 0.397 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 0.49523019790649414
Epoch: 20, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5091724395751953
Epoch: 21, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.360 Vali Acc: 0.931 Test Loss: 0.360 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 22 cost time: 0.5319135189056396
Epoch: 22, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.346 Vali Acc: 0.931 Test Loss: 0.346 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.5436160564422607
Epoch: 23, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.5880122184753418
Epoch: 24, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.5380425453186035
Epoch: 25, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.44519543647766113
Epoch: 26, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.499997615814209
Epoch: 27, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4902644157409668
Epoch: 28, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4846229553222656
Epoch: 29, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5430498123168945
Epoch: 30, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5478487014770508
Epoch: 31, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5270340442657471
Epoch: 32, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5048573017120361
Epoch: 33, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4929804801940918
Epoch: 34, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5790610313415527
Epoch: 35, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 188076
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6783363819122314
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.489 Vali Acc: 0.125 Test Loss: 2.489 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.43903470039367676
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.448 Vali Acc: 0.139 Test Loss: 2.448 Test Acc: 0.139
Validation loss decreased (-0.124975 --> -0.138864).  Saving model ...
Epoch: 3 cost time: 0.5985381603240967
Epoch: 3, Steps: 7 | Train Loss: 2.389 Vali Loss: 2.380 Vali Acc: 0.250 Test Loss: 2.380 Test Acc: 0.250
Validation loss decreased (-0.138864 --> -0.249976).  Saving model ...
Epoch: 4 cost time: 0.5112593173980713
Epoch: 4, Steps: 7 | Train Loss: 2.278 Vali Loss: 2.287 Vali Acc: 0.417 Test Loss: 2.287 Test Acc: 0.417
Validation loss decreased (-0.249976 --> -0.416644).  Saving model ...
Epoch: 5 cost time: 0.5514910221099854
Epoch: 5, Steps: 7 | Train Loss: 2.160 Vali Loss: 2.177 Vali Acc: 0.486 Test Loss: 2.177 Test Acc: 0.486
Validation loss decreased (-0.416644 --> -0.486089).  Saving model ...
Epoch: 6 cost time: 0.4901084899902344
Epoch: 6, Steps: 7 | Train Loss: 2.003 Vali Loss: 2.042 Vali Acc: 0.625 Test Loss: 2.042 Test Acc: 0.625
Validation loss decreased (-0.486089 --> -0.624980).  Saving model ...
Epoch: 7 cost time: 0.5200498104095459
Epoch: 7, Steps: 7 | Train Loss: 1.859 Vali Loss: 1.888 Vali Acc: 0.708 Test Loss: 1.888 Test Acc: 0.708
Validation loss decreased (-0.624980 --> -0.708314).  Saving model ...
Epoch: 8 cost time: 0.4745161533355713
Epoch: 8, Steps: 7 | Train Loss: 1.660 Vali Loss: 1.712 Vali Acc: 0.792 Test Loss: 1.712 Test Acc: 0.792
Validation loss decreased (-0.708314 --> -0.791650).  Saving model ...
Epoch: 9 cost time: 0.4991269111633301
Epoch: 9, Steps: 7 | Train Loss: 1.465 Vali Loss: 1.531 Vali Acc: 0.806 Test Loss: 1.531 Test Acc: 0.806
Validation loss decreased (-0.791650 --> -0.805540).  Saving model ...
Epoch: 10 cost time: 0.5532755851745605
Epoch: 10, Steps: 7 | Train Loss: 1.266 Vali Loss: 1.359 Vali Acc: 0.819 Test Loss: 1.359 Test Acc: 0.819
Validation loss decreased (-0.805540 --> -0.819431).  Saving model ...
Epoch: 11 cost time: 0.4886021614074707
Epoch: 11, Steps: 7 | Train Loss: 1.086 Vali Loss: 1.186 Vali Acc: 0.861 Test Loss: 1.186 Test Acc: 0.861
Validation loss decreased (-0.819431 --> -0.861099).  Saving model ...
Epoch: 12 cost time: 0.48639392852783203
Epoch: 12, Steps: 7 | Train Loss: 0.899 Vali Loss: 1.032 Vali Acc: 0.861 Test Loss: 1.032 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861101).  Saving model ...
Epoch: 13 cost time: 0.4772357940673828
Epoch: 13, Steps: 7 | Train Loss: 0.720 Vali Loss: 0.890 Vali Acc: 0.875 Test Loss: 0.890 Test Acc: 0.875
Validation loss decreased (-0.861101 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.5276243686676025
Epoch: 14, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.775 Vali Acc: 0.889 Test Loss: 0.775 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888881).  Saving model ...
Epoch: 15 cost time: 0.5000925064086914
Epoch: 15, Steps: 7 | Train Loss: 0.453 Vali Loss: 0.681 Vali Acc: 0.889 Test Loss: 0.681 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 0.5481753349304199
Epoch: 16, Steps: 7 | Train Loss: 0.360 Vali Loss: 0.607 Vali Acc: 0.903 Test Loss: 0.607 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902772).  Saving model ...
Epoch: 17 cost time: 0.5071899890899658
Epoch: 17, Steps: 7 | Train Loss: 0.299 Vali Loss: 0.553 Vali Acc: 0.903 Test Loss: 0.553 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 18 cost time: 0.4974372386932373
Epoch: 18, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.513 Vali Acc: 0.917 Test Loss: 0.513 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 19 cost time: 0.5498571395874023
Epoch: 19, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.478 Vali Acc: 0.931 Test Loss: 0.478 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 20 cost time: 0.5180189609527588
Epoch: 20, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.455 Vali Acc: 0.917 Test Loss: 0.455 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.523411750793457
Epoch: 21, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.430 Vali Acc: 0.917 Test Loss: 0.430 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5434370040893555
Epoch: 22, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.404 Vali Acc: 0.931 Test Loss: 0.404 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.4715406894683838
Epoch: 23, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.389 Vali Acc: 0.917 Test Loss: 0.389 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4912753105163574
Epoch: 24, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5936493873596191
Epoch: 25, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5328423976898193
Epoch: 26, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5442907810211182
Epoch: 27, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4858100414276123
Epoch: 28, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5093634128570557
Epoch: 29, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.532557487487793
Epoch: 30, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5310583114624023
Epoch: 31, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5660865306854248
Epoch: 32, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 185388
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9456055164337158
Epoch: 1, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.347 Vali Acc: 0.347 Test Loss: 2.347 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 0.6417624950408936
Epoch: 2, Steps: 7 | Train Loss: 1.719 Vali Loss: 1.573 Vali Acc: 0.833 Test Loss: 1.573 Test Acc: 0.833
Validation loss decreased (-0.347199 --> -0.833318).  Saving model ...
Epoch: 3 cost time: 0.6249165534973145
Epoch: 3, Steps: 7 | Train Loss: 0.625 Vali Loss: 0.724 Vali Acc: 0.917 Test Loss: 0.724 Test Acc: 0.917
Validation loss decreased (-0.833318 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 0.7751438617706299
Epoch: 4, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7520506381988525
Epoch: 5, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 0.7673015594482422
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 0.6942949295043945
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7096149921417236
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7549216747283936
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.7680201530456543
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.8446938991546631
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.7295548915863037
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.681767463684082
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7008578777313232
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7371323108673096
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.788506269454956
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8231296539306641
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6336851119995117
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.9043154716491699
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.706956148147583
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.7353682518005371
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5920581817626953
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6273741722106934
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.7053344249725342
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6743838787078857
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.567570686340332
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.6480798721313477
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.7158308029174805
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.692814826965332
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.703455924987793
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6955204010009766
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7618403434753418
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.7272763252258301
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.7817976474761963
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.7713923454284668
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.8520255088806152
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.7786684036254883
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.7037513256072998
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6819579601287842
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7142868041992188
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6456155776977539
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7650094032287598
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.687493085861206
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.7252683639526367
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.7412283420562744
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.6921417713165283
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.67799973487854
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.652336835861206
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7118968963623047
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.6539177894592285
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2885004
model size : 11.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.914970874786377
Epoch: 1, Steps: 7 | Train Loss: 2.435 Vali Loss: 2.340 Vali Acc: 0.361 Test Loss: 2.340 Test Acc: 0.361
Validation loss decreased (inf --> -0.361088).  Saving model ...
Epoch: 2 cost time: 0.6963820457458496
Epoch: 2, Steps: 7 | Train Loss: 2.001 Vali Loss: 1.881 Vali Acc: 0.875 Test Loss: 1.881 Test Acc: 0.875
Validation loss decreased (-0.361088 --> -0.874981).  Saving model ...
Epoch: 3 cost time: 0.6993682384490967
Epoch: 3, Steps: 7 | Train Loss: 1.192 Vali Loss: 1.205 Vali Acc: 0.903 Test Loss: 1.205 Test Acc: 0.903
Validation loss decreased (-0.874981 --> -0.902766).  Saving model ...
Epoch: 4 cost time: 0.712360143661499
Epoch: 4, Steps: 7 | Train Loss: 0.487 Vali Loss: 0.638 Vali Acc: 0.944 Test Loss: 0.638 Test Acc: 0.944
Validation loss decreased (-0.902766 --> -0.944438).  Saving model ...
Epoch: 5 cost time: 0.8170561790466309
Epoch: 5, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6897225379943848
Epoch: 6, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.668074369430542
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6540100574493408
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5767183303833008
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6640725135803223
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.5465753078460693
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5998954772949219
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6648995876312256
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.5404422283172607
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.66031813621521
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5965747833251953
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6373465061187744
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.675757646560669
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7491636276245117
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6607410907745361
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5911421775817871
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6659843921661377
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6058621406555176
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.633387565612793
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6669869422912598
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6998696327209473
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.7667031288146973
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6444897651672363
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7004201412200928
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6235935688018799
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6588194370269775
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6028821468353271
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6253666877746582
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6441378593444824
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.7569656372070312
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.715660572052002
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.7127301692962646
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7549581527709961
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6138389110565186
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6634223461151123
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.73848557472229
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6904668807983398
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.6847171783447266
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.6292786598205566
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.7710192203521729
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6288490295410156
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.7148897647857666
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.6437182426452637
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6205976009368896
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6094844341278076
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2520204
model size : 9.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.894111156463623
Epoch: 1, Steps: 7 | Train Loss: 2.582 Vali Loss: 2.473 Vali Acc: 0.111 Test Loss: 2.473 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6641137599945068
Epoch: 2, Steps: 7 | Train Loss: 2.253 Vali Loss: 2.147 Vali Acc: 0.653 Test Loss: 2.147 Test Acc: 0.653
Validation loss decreased (-0.111086 --> -0.652756).  Saving model ...
Epoch: 3 cost time: 0.6068670749664307
Epoch: 3, Steps: 7 | Train Loss: 1.635 Vali Loss: 1.638 Vali Acc: 0.861 Test Loss: 1.638 Test Acc: 0.861
Validation loss decreased (-0.652756 --> -0.861095).  Saving model ...
Epoch: 4 cost time: 0.6590847969055176
Epoch: 4, Steps: 7 | Train Loss: 0.956 Vali Loss: 1.048 Vali Acc: 0.889 Test Loss: 1.048 Test Acc: 0.889
Validation loss decreased (-0.861095 --> -0.888878).  Saving model ...
Epoch: 5 cost time: 0.7633070945739746
Epoch: 5, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.580 Vali Acc: 0.917 Test Loss: 0.580 Test Acc: 0.917
Validation loss decreased (-0.888878 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 0.8205685615539551
Epoch: 6, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6739482879638672
Epoch: 7, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.6617221832275391
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.6580228805541992
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.7086989879608154
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7220628261566162
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8034732341766357
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.6883716583251953
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6999824047088623
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.8105907440185547
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7017369270324707
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.7098708152770996
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.798600435256958
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.8321435451507568
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7475128173828125
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6071445941925049
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.6717946529388428
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6817357540130615
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.702932596206665
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6725666522979736
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.645164966583252
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.6870415210723877
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.7008349895477295
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.7358965873718262
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6938974857330322
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6505746841430664
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6253378391265869
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6786818504333496
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.5398340225219727
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.5440678596496582
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.616199254989624
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6653881072998047
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5283637046813965
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.6251559257507324
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7494473457336426
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.7137632369995117
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7280559539794922
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.7938220500946045
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.7701189517974854
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.7866706848144531
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.8901329040527344
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.8405473232269287
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.7430338859558105
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7102396488189697
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.723762035369873
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2395020
model size : 9.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9050452709197998
Epoch: 1, Steps: 7 | Train Loss: 2.457 Vali Loss: 2.427 Vali Acc: 0.181 Test Loss: 2.427 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.7047648429870605
Epoch: 2, Steps: 7 | Train Loss: 2.217 Vali Loss: 2.179 Vali Acc: 0.556 Test Loss: 2.179 Test Acc: 0.556
Validation loss decreased (-0.180531 --> -0.555534).  Saving model ...
Epoch: 3 cost time: 0.7180452346801758
Epoch: 3, Steps: 7 | Train Loss: 1.723 Vali Loss: 1.760 Vali Acc: 0.806 Test Loss: 1.760 Test Acc: 0.806
Validation loss decreased (-0.555534 --> -0.805538).  Saving model ...
Epoch: 4 cost time: 0.6985030174255371
Epoch: 4, Steps: 7 | Train Loss: 1.139 Vali Loss: 1.237 Vali Acc: 0.861 Test Loss: 1.237 Test Acc: 0.861
Validation loss decreased (-0.805538 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 0.6624021530151367
Epoch: 5, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
Validation loss decreased (-0.861099 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.8199093341827393
Epoch: 6, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.7341830730438232
Epoch: 7, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.7600336074829102
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7932600975036621
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.5636262893676758
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6819174289703369
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.5884220600128174
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.6031992435455322
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6385886669158936
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.640934944152832
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.6681475639343262
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6566610336303711
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7203059196472168
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.7637031078338623
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7019534111022949
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.7321033477783203
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.639197587966919
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6544785499572754
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6463985443115234
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6502959728240967
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.851529598236084
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7416651248931885
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6717503070831299
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.6138758659362793
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7107644081115723
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5571041107177734
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.7771956920623779
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.7070727348327637
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.7426514625549316
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.812281608581543
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.8003535270690918
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7174966335296631
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7280969619750977
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.7271018028259277
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.7297160625457764
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6559758186340332
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.7272152900695801
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.6719582080841064
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.6825511455535889
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6051008701324463
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.645587682723999
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6851534843444824
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7315855026245117
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6329324245452881
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6564669609069824
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 2343564
model size : 9.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7877140045166016
Epoch: 1, Steps: 7 | Train Loss: 2.483 Vali Loss: 2.463 Vali Acc: 0.153 Test Loss: 2.463 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.6938650608062744
Epoch: 2, Steps: 7 | Train Loss: 2.280 Vali Loss: 2.258 Vali Acc: 0.514 Test Loss: 2.258 Test Acc: 0.514
Validation loss decreased (-0.152753 --> -0.513866).  Saving model ...
Epoch: 3 cost time: 0.6856822967529297
Epoch: 3, Steps: 7 | Train Loss: 1.918 Vali Loss: 1.911 Vali Acc: 0.833 Test Loss: 1.911 Test Acc: 0.833
Validation loss decreased (-0.513866 --> -0.833314).  Saving model ...
Epoch: 4 cost time: 0.6065635681152344
Epoch: 4, Steps: 7 | Train Loss: 1.432 Vali Loss: 1.462 Vali Acc: 0.889 Test Loss: 1.462 Test Acc: 0.889
Validation loss decreased (-0.833314 --> -0.888874).  Saving model ...
Epoch: 5 cost time: 0.61503005027771
Epoch: 5, Steps: 7 | Train Loss: 0.927 Vali Loss: 1.019 Vali Acc: 0.875 Test Loss: 1.019 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.59279465675354
Epoch: 6, Steps: 7 | Train Loss: 0.504 Vali Loss: 0.644 Vali Acc: 0.903 Test Loss: 0.644 Test Acc: 0.903
Validation loss decreased (-0.888874 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 0.714064359664917
Epoch: 7, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.444 Vali Acc: 0.931 Test Loss: 0.444 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930551).  Saving model ...
Epoch: 8 cost time: 0.5807888507843018
Epoch: 8, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.364 Vali Acc: 0.944 Test Loss: 0.364 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.6064333915710449
Epoch: 9, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5924999713897705
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5416336059570312
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5728447437286377
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5435686111450195
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5493130683898926
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5244572162628174
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6809039115905762
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.6473467350006104
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.8258712291717529
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.538811445236206
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6385440826416016
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5804178714752197
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.63423752784729
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6591851711273193
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.6789569854736328
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.6707515716552734
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.6643245220184326
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.6362779140472412
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.5987977981567383
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.6887657642364502
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5896294116973877
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6254057884216309
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6438355445861816
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.6469333171844482
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.614654541015625
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.602118968963623
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6483120918273926
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.6542165279388428
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.599614143371582
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.6508164405822754
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.7060074806213379
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.639373779296875
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.6304893493652344
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.7749180793762207
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.5803682804107666
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.6108829975128174
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6373558044433594
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6277568340301514
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6201181411743164
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.6652593612670898
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6851084232330322
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2295948
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8956525325775146
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.444 Vali Acc: 0.139 Test Loss: 2.444 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.6211564540863037
Epoch: 2, Steps: 7 | Train Loss: 2.333 Vali Loss: 2.263 Vali Acc: 0.444 Test Loss: 2.263 Test Acc: 0.444
Validation loss decreased (-0.138864 --> -0.444422).  Saving model ...
Epoch: 3 cost time: 0.5939457416534424
Epoch: 3, Steps: 7 | Train Loss: 2.017 Vali Loss: 1.964 Vali Acc: 0.764 Test Loss: 1.964 Test Acc: 0.764
Validation loss decreased (-0.444422 --> -0.763869).  Saving model ...
Epoch: 4 cost time: 0.6674628257751465
Epoch: 4, Steps: 7 | Train Loss: 1.603 Vali Loss: 1.587 Vali Acc: 0.833 Test Loss: 1.587 Test Acc: 0.833
Validation loss decreased (-0.763869 --> -0.833317).  Saving model ...
Epoch: 5 cost time: 0.6097445487976074
Epoch: 5, Steps: 7 | Train Loss: 1.140 Vali Loss: 1.175 Vali Acc: 0.861 Test Loss: 1.175 Test Acc: 0.861
Validation loss decreased (-0.833317 --> -0.861099).  Saving model ...
Epoch: 6 cost time: 0.6158959865570068
Epoch: 6, Steps: 7 | Train Loss: 0.716 Vali Loss: 0.793 Vali Acc: 0.861 Test Loss: 0.793 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.6715219020843506
Epoch: 7, Steps: 7 | Train Loss: 0.385 Vali Loss: 0.535 Vali Acc: 0.889 Test Loss: 0.535 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.6917412281036377
Epoch: 8, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.6279585361480713
Epoch: 9, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.5895578861236572
Epoch: 10, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.6534254550933838
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.737694501876831
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.6010282039642334
Epoch: 13, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.6234519481658936
Epoch: 14, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6479043960571289
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5790102481842041
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5812697410583496
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5919559001922607
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6711084842681885
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6834614276885986
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.6366639137268066
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6709413528442383
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6971108913421631
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6466503143310547
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7368147373199463
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6240968704223633
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.638486385345459
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6616578102111816
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6179232597351074
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5884513854980469
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7078413963317871
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.7057676315307617
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6601662635803223
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.660480260848999
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6299998760223389
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5928566455841064
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5769321918487549
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6696367263793945
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6630990505218506
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7319796085357666
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6924772262573242
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5965156555175781
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6285252571105957
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6445841789245605
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2266764
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.742234706878662
Epoch: 1, Steps: 7 | Train Loss: 2.513 Vali Loss: 2.475 Vali Acc: 0.111 Test Loss: 2.475 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6507461071014404
Epoch: 2, Steps: 7 | Train Loss: 2.361 Vali Loss: 2.316 Vali Acc: 0.375 Test Loss: 2.316 Test Acc: 0.375
Validation loss decreased (-0.111086 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.767345666885376
Epoch: 3, Steps: 7 | Train Loss: 2.057 Vali Loss: 2.064 Vali Acc: 0.597 Test Loss: 2.064 Test Acc: 0.597
Validation loss decreased (-0.374977 --> -0.597202).  Saving model ...
Epoch: 4 cost time: 0.7244951725006104
Epoch: 4, Steps: 7 | Train Loss: 1.711 Vali Loss: 1.743 Vali Acc: 0.722 Test Loss: 1.743 Test Acc: 0.722
Validation loss decreased (-0.597202 --> -0.722205).  Saving model ...
Epoch: 5 cost time: 0.6692967414855957
Epoch: 5, Steps: 7 | Train Loss: 1.316 Vali Loss: 1.366 Vali Acc: 0.792 Test Loss: 1.366 Test Acc: 0.792
Validation loss decreased (-0.722205 --> -0.791653).  Saving model ...
Epoch: 6 cost time: 0.6437582969665527
Epoch: 6, Steps: 7 | Train Loss: 0.902 Vali Loss: 0.998 Vali Acc: 0.847 Test Loss: 0.998 Test Acc: 0.847
Validation loss decreased (-0.791653 --> -0.847212).  Saving model ...
Epoch: 7 cost time: 0.71974778175354
Epoch: 7, Steps: 7 | Train Loss: 0.552 Vali Loss: 0.699 Vali Acc: 0.875 Test Loss: 0.699 Test Acc: 0.875
Validation loss decreased (-0.847212 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.6905450820922852
Epoch: 8, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6866564750671387
Epoch: 9, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888884).  Saving model ...
Epoch: 10 cost time: 0.6906824111938477
Epoch: 10, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.6791903972625732
Epoch: 11, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.6449029445648193
Epoch: 12, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6664774417877197
Epoch: 13, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7168142795562744
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7291393280029297
Epoch: 15, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6530499458312988
Epoch: 16, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6640558242797852
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 0.6182019710540771
Epoch: 18, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.692791223526001
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.6008279323577881
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.6004397869110107
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.5813648700714111
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6354765892028809
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6827383041381836
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6173105239868164
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5913481712341309
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6826841831207275
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6588811874389648
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.7044932842254639
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.5916857719421387
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6305856704711914
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6181375980377197
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6058354377746582
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5981574058532715
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6561226844787598
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6610507965087891
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6920294761657715
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6541893482208252
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.6778469085693359
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.6171655654907227
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6864783763885498
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.666682243347168
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6495022773742676
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6084091663360596
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.6354069709777832
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6249332427978516
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.706397533416748
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.623560905456543
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6414930820465088
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6444380283355713
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 2256012
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6743714809417725
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.424 Vali Acc: 0.236 Test Loss: 2.424 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.6032662391662598
Epoch: 2, Steps: 7 | Train Loss: 2.155 Vali Loss: 2.089 Vali Acc: 0.708 Test Loss: 2.089 Test Acc: 0.708
Validation loss decreased (-0.236087 --> -0.708312).  Saving model ...
Epoch: 3 cost time: 0.5531120300292969
Epoch: 3, Steps: 7 | Train Loss: 1.453 Vali Loss: 1.520 Vali Acc: 0.861 Test Loss: 1.520 Test Acc: 0.861
Validation loss decreased (-0.708312 --> -0.861096).  Saving model ...
Epoch: 4 cost time: 0.5521254539489746
Epoch: 4, Steps: 7 | Train Loss: 0.728 Vali Loss: 0.898 Vali Acc: 0.903 Test Loss: 0.898 Test Acc: 0.903
Validation loss decreased (-0.861096 --> -0.902769).  Saving model ...
Epoch: 5 cost time: 0.5365047454833984
Epoch: 5, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.492 Vali Acc: 0.931 Test Loss: 0.492 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930551).  Saving model ...
Epoch: 6 cost time: 0.5302112102508545
Epoch: 6, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5603427886962891
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
Validation loss decreased (-0.930551 --> -0.958331).  Saving model ...
Epoch: 8 cost time: 0.5235893726348877
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 0.5116546154022217
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.5095062255859375
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.5301134586334229
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.6125471591949463
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5105385780334473
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6606168746948242
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5569419860839844
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5467929840087891
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4927847385406494
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4712955951690674
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5927891731262207
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6481492519378662
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.547130823135376
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 934604
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7823362350463867
Epoch: 1, Steps: 7 | Train Loss: 2.522 Vali Loss: 2.444 Vali Acc: 0.125 Test Loss: 2.444 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.5879063606262207
Epoch: 2, Steps: 7 | Train Loss: 2.269 Vali Loss: 2.179 Vali Acc: 0.556 Test Loss: 2.179 Test Acc: 0.556
Validation loss decreased (-0.124976 --> -0.555534).  Saving model ...
Epoch: 3 cost time: 0.674990177154541
Epoch: 3, Steps: 7 | Train Loss: 1.820 Vali Loss: 1.770 Vali Acc: 0.792 Test Loss: 1.770 Test Acc: 0.792
Validation loss decreased (-0.555534 --> -0.791649).  Saving model ...
Epoch: 4 cost time: 0.5959515571594238
Epoch: 4, Steps: 7 | Train Loss: 1.259 Vali Loss: 1.294 Vali Acc: 0.889 Test Loss: 1.294 Test Acc: 0.889
Validation loss decreased (-0.791649 --> -0.888876).  Saving model ...
Epoch: 5 cost time: 0.6605184078216553
Epoch: 5, Steps: 7 | Train Loss: 0.725 Vali Loss: 0.818 Vali Acc: 0.917 Test Loss: 0.818 Test Acc: 0.917
Validation loss decreased (-0.888876 --> -0.916658).  Saving model ...
Epoch: 6 cost time: 0.5705151557922363
Epoch: 6, Steps: 7 | Train Loss: 0.322 Vali Loss: 0.503 Vali Acc: 0.931 Test Loss: 0.503 Test Acc: 0.931
Validation loss decreased (-0.916658 --> -0.930551).  Saving model ...
Epoch: 7 cost time: 0.6499569416046143
Epoch: 7, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6365816593170166
Epoch: 8, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.592320442199707
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.6793928146362305
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.6250734329223633
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.762542724609375
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7079780101776123
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6015653610229492
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5821828842163086
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.7223074436187744
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7159261703491211
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.698786735534668
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7033920288085938
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7058558464050293
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7709915637969971
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7526993751525879
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6977105140686035
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7424900531768799
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7207238674163818
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.7221877574920654
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6592633724212646
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6636312007904053
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6359667778015137
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7587625980377197
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7104320526123047
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.7175896167755127
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.7067327499389648
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6675019264221191
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.680539608001709
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5353820323944092
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.7628440856933594
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5956392288208008
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.6598970890045166
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.6111083030700684
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.6754324436187744
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.6682779788970947
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8293590545654297
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6455812454223633
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.719254732131958
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.6645550727844238
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.6708900928497314
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.6793222427368164
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.7051022052764893
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.6449263095855713
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 752204
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8394768238067627
Epoch: 1, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.416 Vali Acc: 0.167 Test Loss: 2.416 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.6325953006744385
Epoch: 2, Steps: 7 | Train Loss: 2.331 Vali Loss: 2.247 Vali Acc: 0.458 Test Loss: 2.247 Test Acc: 0.458
Validation loss decreased (-0.166643 --> -0.458311).  Saving model ...
Epoch: 3 cost time: 0.5057027339935303
Epoch: 3, Steps: 7 | Train Loss: 2.006 Vali Loss: 1.967 Vali Acc: 0.750 Test Loss: 1.967 Test Acc: 0.750
Validation loss decreased (-0.458311 --> -0.749980).  Saving model ...
Epoch: 4 cost time: 0.6361277103424072
Epoch: 4, Steps: 7 | Train Loss: 1.618 Vali Loss: 1.615 Vali Acc: 0.847 Test Loss: 1.615 Test Acc: 0.847
Validation loss decreased (-0.749980 --> -0.847206).  Saving model ...
Epoch: 5 cost time: 0.5174357891082764
Epoch: 5, Steps: 7 | Train Loss: 1.149 Vali Loss: 1.184 Vali Acc: 0.917 Test Loss: 1.184 Test Acc: 0.917
Validation loss decreased (-0.847206 --> -0.916655).  Saving model ...
Epoch: 6 cost time: 0.5470588207244873
Epoch: 6, Steps: 7 | Train Loss: 0.705 Vali Loss: 0.793 Vali Acc: 0.917 Test Loss: 0.793 Test Acc: 0.917
Validation loss decreased (-0.916655 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 0.6115145683288574
Epoch: 7, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.516 Vali Acc: 0.931 Test Loss: 0.516 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.4754784107208252
Epoch: 8, Steps: 7 | Train Loss: 0.169 Vali Loss: 0.383 Vali Acc: 0.917 Test Loss: 0.383 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5903868675231934
Epoch: 9, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.6126606464385986
Epoch: 10, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.6020183563232422
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5927393436431885
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.5672006607055664
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.5207397937774658
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5086016654968262
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5824625492095947
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5650348663330078
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5722284317016602
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.466705322265625
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.4904310703277588
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5273487567901611
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5646123886108398
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.577411413192749
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6138291358947754
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5839047431945801
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4903714656829834
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5169692039489746
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.535099983215332
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5686123371124268
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5710179805755615
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6212131977081299
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.583843469619751
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5905594825744629
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5184142589569092
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6077075004577637
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5716381072998047
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5587456226348877
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6074793338775635
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5633070468902588
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5774872303009033
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5426855087280273
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5730013847351074
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.6126923561096191
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5513308048248291
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5971329212188721
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6409881114959717
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5182602405548096
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.541863203048706
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5962543487548828
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5100200176239014
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 689612
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8441977500915527
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.469 Vali Acc: 0.097 Test Loss: 2.469 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6679673194885254
Epoch: 2, Steps: 7 | Train Loss: 2.394 Vali Loss: 2.334 Vali Acc: 0.403 Test Loss: 2.334 Test Acc: 0.403
Validation loss decreased (-0.097198 --> -0.402754).  Saving model ...
Epoch: 3 cost time: 0.5813639163970947
Epoch: 3, Steps: 7 | Train Loss: 2.106 Vali Loss: 2.102 Vali Acc: 0.681 Test Loss: 2.102 Test Acc: 0.681
Validation loss decreased (-0.402754 --> -0.680535).  Saving model ...
Epoch: 4 cost time: 0.6797568798065186
Epoch: 4, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.779 Vali Acc: 0.750 Test Loss: 1.779 Test Acc: 0.750
Validation loss decreased (-0.680535 --> -0.749982).  Saving model ...
Epoch: 5 cost time: 0.6020901203155518
Epoch: 5, Steps: 7 | Train Loss: 1.380 Vali Loss: 1.399 Vali Acc: 0.792 Test Loss: 1.399 Test Acc: 0.792
Validation loss decreased (-0.749982 --> -0.791653).  Saving model ...
Epoch: 6 cost time: 0.5800602436065674
Epoch: 6, Steps: 7 | Train Loss: 0.963 Vali Loss: 1.017 Vali Acc: 0.889 Test Loss: 1.017 Test Acc: 0.889
Validation loss decreased (-0.791653 --> -0.888879).  Saving model ...
Epoch: 7 cost time: 0.5607545375823975
Epoch: 7, Steps: 7 | Train Loss: 0.569 Vali Loss: 0.698 Vali Acc: 0.875 Test Loss: 0.698 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5182070732116699
Epoch: 8, Steps: 7 | Train Loss: 0.313 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.5598416328430176
Epoch: 9, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.5686540603637695
Epoch: 10, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.5309481620788574
Epoch: 11, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.5162196159362793
Epoch: 12, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.552532434463501
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.541616678237915
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.523320198059082
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5793416500091553
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5807757377624512
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5921976566314697
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6419539451599121
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5419824123382568
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6158349514007568
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6089992523193359
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5625181198120117
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5658800601959229
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 663884
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9327178001403809
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.517 Vali Acc: 0.056 Test Loss: 2.517 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.610912561416626
Epoch: 2, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.407 Vali Acc: 0.208 Test Loss: 2.407 Test Acc: 0.208
Validation loss decreased (-0.055530 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 0.5950629711151123
Epoch: 3, Steps: 7 | Train Loss: 2.244 Vali Loss: 2.222 Vali Acc: 0.472 Test Loss: 2.222 Test Acc: 0.472
Validation loss decreased (-0.208309 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 0.5518972873687744
Epoch: 4, Steps: 7 | Train Loss: 1.981 Vali Loss: 1.971 Vali Acc: 0.708 Test Loss: 1.971 Test Acc: 0.708
Validation loss decreased (-0.472200 --> -0.708314).  Saving model ...
Epoch: 5 cost time: 0.5773553848266602
Epoch: 5, Steps: 7 | Train Loss: 1.661 Vali Loss: 1.659 Vali Acc: 0.847 Test Loss: 1.659 Test Acc: 0.847
Validation loss decreased (-0.708314 --> -0.847206).  Saving model ...
Epoch: 6 cost time: 0.5802536010742188
Epoch: 6, Steps: 7 | Train Loss: 1.302 Vali Loss: 1.322 Vali Acc: 0.889 Test Loss: 1.322 Test Acc: 0.889
Validation loss decreased (-0.847206 --> -0.888876).  Saving model ...
Epoch: 7 cost time: 0.5381467342376709
Epoch: 7, Steps: 7 | Train Loss: 0.945 Vali Loss: 0.994 Vali Acc: 0.931 Test Loss: 0.994 Test Acc: 0.931
Validation loss decreased (-0.888876 --> -0.930546).  Saving model ...
Epoch: 8 cost time: 0.5374782085418701
Epoch: 8, Steps: 7 | Train Loss: 0.620 Vali Loss: 0.717 Vali Acc: 0.917 Test Loss: 0.717 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5636165142059326
Epoch: 9, Steps: 7 | Train Loss: 0.368 Vali Loss: 0.522 Vali Acc: 0.931 Test Loss: 0.522 Test Acc: 0.931
Validation loss decreased (-0.930546 --> -0.930550).  Saving model ...
Epoch: 10 cost time: 0.5665276050567627
Epoch: 10, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.400 Vali Acc: 0.931 Test Loss: 0.400 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.5320258140563965
Epoch: 11, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.5726253986358643
Epoch: 12, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.315 Vali Acc: 0.958 Test Loss: 0.315 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 0.5860421657562256
Epoch: 13, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.290 Vali Acc: 0.958 Test Loss: 0.290 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 14 cost time: 0.6009202003479004
Epoch: 14, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.5403544902801514
Epoch: 15, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6525678634643555
Epoch: 16, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5836455821990967
Epoch: 17, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6077966690063477
Epoch: 18, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5737757682800293
Epoch: 19, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.513089656829834
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.637035608291626
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5141997337341309
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5415234565734863
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6517429351806641
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5547857284545898
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 640076
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8270337581634521
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.494 Vali Acc: 0.097 Test Loss: 2.494 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5735228061676025
Epoch: 2, Steps: 7 | Train Loss: 2.430 Vali Loss: 2.403 Vali Acc: 0.153 Test Loss: 2.403 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.60994553565979
Epoch: 3, Steps: 7 | Train Loss: 2.252 Vali Loss: 2.251 Vali Acc: 0.458 Test Loss: 2.251 Test Acc: 0.458
Validation loss decreased (-0.152754 --> -0.458311).  Saving model ...
Epoch: 4 cost time: 0.5774474143981934
Epoch: 4, Steps: 7 | Train Loss: 2.023 Vali Loss: 2.053 Vali Acc: 0.653 Test Loss: 2.053 Test Acc: 0.653
Validation loss decreased (-0.458311 --> -0.652757).  Saving model ...
Epoch: 5 cost time: 0.5516064167022705
Epoch: 5, Steps: 7 | Train Loss: 1.766 Vali Loss: 1.811 Vali Acc: 0.722 Test Loss: 1.811 Test Acc: 0.722
Validation loss decreased (-0.652757 --> -0.722204).  Saving model ...
Epoch: 6 cost time: 0.4993133544921875
Epoch: 6, Steps: 7 | Train Loss: 1.480 Vali Loss: 1.531 Vali Acc: 0.806 Test Loss: 1.531 Test Acc: 0.806
Validation loss decreased (-0.722204 --> -0.805540).  Saving model ...
Epoch: 7 cost time: 0.5937099456787109
Epoch: 7, Steps: 7 | Train Loss: 1.173 Vali Loss: 1.243 Vali Acc: 0.819 Test Loss: 1.243 Test Acc: 0.819
Validation loss decreased (-0.805540 --> -0.819432).  Saving model ...
Epoch: 8 cost time: 0.57871413230896
Epoch: 8, Steps: 7 | Train Loss: 0.866 Vali Loss: 0.980 Vali Acc: 0.847 Test Loss: 0.980 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847212).  Saving model ...
Epoch: 9 cost time: 0.5439639091491699
Epoch: 9, Steps: 7 | Train Loss: 0.589 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
Validation loss decreased (-0.847212 --> -0.888881).  Saving model ...
Epoch: 10 cost time: 0.5089976787567139
Epoch: 10, Steps: 7 | Train Loss: 0.387 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5841526985168457
Epoch: 11, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5775587558746338
Epoch: 12, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.5150063037872314
Epoch: 13, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.5057322978973389
Epoch: 14, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.5486814975738525
Epoch: 15, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.559828519821167
Epoch: 16, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5345199108123779
Epoch: 17, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.5368273258209229
Epoch: 18, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.5512540340423584
Epoch: 19, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.5778193473815918
Epoch: 20, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.4853670597076416
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5845189094543457
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5350282192230225
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5199155807495117
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5789244174957275
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6083085536956787
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6008532047271729
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5568699836730957
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5886588096618652
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.570967435836792
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6059949398040771
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5561785697937012
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 625484
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.858546495437622
Epoch: 1, Steps: 7 | Train Loss: 2.523 Vali Loss: 2.488 Vali Acc: 0.097 Test Loss: 2.488 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6510672569274902
Epoch: 2, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.424 Vali Acc: 0.153 Test Loss: 2.424 Test Acc: 0.153
Validation loss decreased (-0.097197 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.53668212890625
Epoch: 3, Steps: 7 | Train Loss: 2.315 Vali Loss: 2.312 Vali Acc: 0.306 Test Loss: 2.312 Test Acc: 0.306
Validation loss decreased (-0.152754 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 0.5844895839691162
Epoch: 4, Steps: 7 | Train Loss: 2.117 Vali Loss: 2.167 Vali Acc: 0.528 Test Loss: 2.167 Test Acc: 0.528
Validation loss decreased (-0.305532 --> -0.527756).  Saving model ...
Epoch: 5 cost time: 0.5412905216217041
Epoch: 5, Steps: 7 | Train Loss: 1.922 Vali Loss: 1.986 Vali Acc: 0.667 Test Loss: 1.986 Test Acc: 0.667
Validation loss decreased (-0.527756 --> -0.666647).  Saving model ...
Epoch: 6 cost time: 0.5721602439880371
Epoch: 6, Steps: 7 | Train Loss: 1.694 Vali Loss: 1.772 Vali Acc: 0.708 Test Loss: 1.772 Test Acc: 0.708
Validation loss decreased (-0.666647 --> -0.708316).  Saving model ...
Epoch: 7 cost time: 0.5531501770019531
Epoch: 7, Steps: 7 | Train Loss: 1.425 Vali Loss: 1.536 Vali Acc: 0.764 Test Loss: 1.536 Test Acc: 0.764
Validation loss decreased (-0.708316 --> -0.763874).  Saving model ...
Epoch: 8 cost time: 0.5397520065307617
Epoch: 8, Steps: 7 | Train Loss: 1.159 Vali Loss: 1.286 Vali Acc: 0.819 Test Loss: 1.286 Test Acc: 0.819
Validation loss decreased (-0.763874 --> -0.819432).  Saving model ...
Epoch: 9 cost time: 0.4995567798614502
Epoch: 9, Steps: 7 | Train Loss: 0.901 Vali Loss: 1.056 Vali Acc: 0.833 Test Loss: 1.056 Test Acc: 0.833
Validation loss decreased (-0.819432 --> -0.833323).  Saving model ...
Epoch: 10 cost time: 0.7067325115203857
Epoch: 10, Steps: 7 | Train Loss: 0.646 Vali Loss: 0.853 Vali Acc: 0.889 Test Loss: 0.853 Test Acc: 0.889
Validation loss decreased (-0.833323 --> -0.888880).  Saving model ...
Epoch: 11 cost time: 0.5820162296295166
Epoch: 11, Steps: 7 | Train Loss: 0.460 Vali Loss: 0.699 Vali Acc: 0.903 Test Loss: 0.699 Test Acc: 0.903
Validation loss decreased (-0.888880 --> -0.902771).  Saving model ...
Epoch: 12 cost time: 0.6367950439453125
Epoch: 12, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.588 Vali Acc: 0.917 Test Loss: 0.588 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 13 cost time: 0.48817873001098633
Epoch: 13, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.502 Vali Acc: 0.917 Test Loss: 0.502 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 14 cost time: 0.6608219146728516
Epoch: 14, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.446 Vali Acc: 0.931 Test Loss: 0.446 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 15 cost time: 0.6237268447875977
Epoch: 15, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.422 Vali Acc: 0.931 Test Loss: 0.422 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 16 cost time: 0.6290521621704102
Epoch: 16, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.397 Vali Acc: 0.931 Test Loss: 0.397 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.5467846393585205
Epoch: 17, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5733628273010254
Epoch: 18, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5319321155548096
Epoch: 19, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6524381637573242
Epoch: 20, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5307061672210693
Epoch: 21, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.49422550201416016
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.630774974822998
Epoch: 23, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5610189437866211
Epoch: 24, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.576664924621582
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6183595657348633
Epoch: 26, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 620108
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7272002696990967
Epoch: 1, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.451 Vali Acc: 0.208 Test Loss: 2.451 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.5309233665466309
Epoch: 2, Steps: 7 | Train Loss: 2.259 Vali Loss: 2.268 Vali Acc: 0.444 Test Loss: 2.268 Test Acc: 0.444
Validation loss decreased (-0.208309 --> -0.444422).  Saving model ...
Epoch: 3 cost time: 0.5683553218841553
Epoch: 3, Steps: 7 | Train Loss: 1.871 Vali Loss: 1.950 Vali Acc: 0.736 Test Loss: 1.950 Test Acc: 0.736
Validation loss decreased (-0.444422 --> -0.736092).  Saving model ...
Epoch: 4 cost time: 0.5340304374694824
Epoch: 4, Steps: 7 | Train Loss: 1.375 Vali Loss: 1.530 Vali Acc: 0.847 Test Loss: 1.530 Test Acc: 0.847
Validation loss decreased (-0.736092 --> -0.847207).  Saving model ...
Epoch: 5 cost time: 0.542050838470459
Epoch: 5, Steps: 7 | Train Loss: 0.889 Vali Loss: 1.076 Vali Acc: 0.889 Test Loss: 1.076 Test Acc: 0.889
Validation loss decreased (-0.847207 --> -0.888878).  Saving model ...
Epoch: 6 cost time: 0.5246288776397705
Epoch: 6, Steps: 7 | Train Loss: 0.475 Vali Loss: 0.691 Vali Acc: 0.944 Test Loss: 0.691 Test Acc: 0.944
Validation loss decreased (-0.888878 --> -0.944438).  Saving model ...
Epoch: 7 cost time: 0.6749579906463623
Epoch: 7, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.465 Vali Acc: 0.931 Test Loss: 0.465 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6419422626495361
Epoch: 8, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5070896148681641
Epoch: 9, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5126066207885742
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5366504192352295
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5224528312683105
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5259079933166504
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.545872688293457
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4569892883300781
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.571678638458252
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 340332
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6880619525909424
Epoch: 1, Steps: 7 | Train Loss: 2.468 Vali Loss: 2.473 Vali Acc: 0.111 Test Loss: 2.473 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5003578662872314
Epoch: 2, Steps: 7 | Train Loss: 2.349 Vali Loss: 2.360 Vali Acc: 0.306 Test Loss: 2.360 Test Acc: 0.306
Validation loss decreased (-0.111086 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 0.4941256046295166
Epoch: 3, Steps: 7 | Train Loss: 2.134 Vali Loss: 2.167 Vali Acc: 0.542 Test Loss: 2.167 Test Acc: 0.542
Validation loss decreased (-0.305532 --> -0.541645).  Saving model ...
Epoch: 4 cost time: 0.5776348114013672
Epoch: 4, Steps: 7 | Train Loss: 1.818 Vali Loss: 1.889 Vali Acc: 0.708 Test Loss: 1.889 Test Acc: 0.708
Validation loss decreased (-0.541645 --> -0.708314).  Saving model ...
Epoch: 5 cost time: 0.5180454254150391
Epoch: 5, Steps: 7 | Train Loss: 1.468 Vali Loss: 1.557 Vali Acc: 0.806 Test Loss: 1.557 Test Acc: 0.806
Validation loss decreased (-0.708314 --> -0.805540).  Saving model ...
Epoch: 6 cost time: 0.5543689727783203
Epoch: 6, Steps: 7 | Train Loss: 1.084 Vali Loss: 1.211 Vali Acc: 0.847 Test Loss: 1.211 Test Acc: 0.847
Validation loss decreased (-0.805540 --> -0.847210).  Saving model ...
Epoch: 7 cost time: 0.5279033184051514
Epoch: 7, Steps: 7 | Train Loss: 0.730 Vali Loss: 0.899 Vali Acc: 0.861 Test Loss: 0.899 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861102).  Saving model ...
Epoch: 8 cost time: 0.49025607109069824
Epoch: 8, Steps: 7 | Train Loss: 0.451 Vali Loss: 0.654 Vali Acc: 0.903 Test Loss: 0.654 Test Acc: 0.903
Validation loss decreased (-0.861102 --> -0.902771).  Saving model ...
Epoch: 9 cost time: 0.5254864692687988
Epoch: 9, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.487 Vali Acc: 0.917 Test Loss: 0.487 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 0.53468918800354
Epoch: 10, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.5228965282440186
Epoch: 11, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.344 Vali Acc: 0.931 Test Loss: 0.344 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.48180198669433594
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.5206742286682129
Epoch: 13, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.5239322185516357
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5186443328857422
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6020731925964355
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5718019008636475
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4999420642852783
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.4882771968841553
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.47337913513183594
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.4512639045715332
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5179102420806885
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5711369514465332
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5447249412536621
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5339875221252441
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5509703159332275
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5519003868103027
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5392787456512451
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5919234752655029
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5669348239898682
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5887765884399414
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5845808982849121
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5747523307800293
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5433974266052246
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5514349937438965
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5691564083099365
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5373063087463379
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5404496192932129
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5427579879760742
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5323443412780762
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5344676971435547
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5641980171203613
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5552551746368408
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5606250762939453
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5437121391296387
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5850162506103516
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5761871337890625
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5736293792724609
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6436214447021484
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5780758857727051
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 249132
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.966831922531128
Epoch: 1, Steps: 7 | Train Loss: 2.479 Vali Loss: 2.446 Vali Acc: 0.125 Test Loss: 2.446 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.5481221675872803
Epoch: 2, Steps: 7 | Train Loss: 2.382 Vali Loss: 2.353 Vali Acc: 0.306 Test Loss: 2.353 Test Acc: 0.306
Validation loss decreased (-0.124976 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 0.4999580383300781
Epoch: 3, Steps: 7 | Train Loss: 2.216 Vali Loss: 2.202 Vali Acc: 0.389 Test Loss: 2.202 Test Acc: 0.389
Validation loss decreased (-0.305532 --> -0.388867).  Saving model ...
Epoch: 4 cost time: 0.6268608570098877
Epoch: 4, Steps: 7 | Train Loss: 1.991 Vali Loss: 2.001 Vali Acc: 0.653 Test Loss: 2.001 Test Acc: 0.653
Validation loss decreased (-0.388867 --> -0.652758).  Saving model ...
Epoch: 5 cost time: 0.5128934383392334
Epoch: 5, Steps: 7 | Train Loss: 1.725 Vali Loss: 1.746 Vali Acc: 0.806 Test Loss: 1.746 Test Acc: 0.806
Validation loss decreased (-0.652758 --> -0.805538).  Saving model ...
Epoch: 6 cost time: 0.6153960227966309
Epoch: 6, Steps: 7 | Train Loss: 1.416 Vali Loss: 1.469 Vali Acc: 0.833 Test Loss: 1.469 Test Acc: 0.833
Validation loss decreased (-0.805538 --> -0.833319).  Saving model ...
Epoch: 7 cost time: 0.5589673519134521
Epoch: 7, Steps: 7 | Train Loss: 1.127 Vali Loss: 1.185 Vali Acc: 0.861 Test Loss: 1.185 Test Acc: 0.861
Validation loss decreased (-0.833319 --> -0.861099).  Saving model ...
Epoch: 8 cost time: 0.5686168670654297
Epoch: 8, Steps: 7 | Train Loss: 0.806 Vali Loss: 0.919 Vali Acc: 0.875 Test Loss: 0.919 Test Acc: 0.875
Validation loss decreased (-0.861099 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.5397171974182129
Epoch: 9, Steps: 7 | Train Loss: 0.546 Vali Loss: 0.687 Vali Acc: 0.903 Test Loss: 0.687 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902771).  Saving model ...
Epoch: 10 cost time: 0.5774290561676025
Epoch: 10, Steps: 7 | Train Loss: 0.332 Vali Loss: 0.543 Vali Acc: 0.903 Test Loss: 0.543 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 11 cost time: 0.5119287967681885
Epoch: 11, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.444 Vali Acc: 0.931 Test Loss: 0.444 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930551).  Saving model ...
Epoch: 12 cost time: 0.5081048011779785
Epoch: 12, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.394 Vali Acc: 0.931 Test Loss: 0.394 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.49768900871276855
Epoch: 13, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5349631309509277
Epoch: 14, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5173196792602539
Epoch: 15, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5015249252319336
Epoch: 16, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5566043853759766
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5266573429107666
Epoch: 18, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5886895656585693
Epoch: 19, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.49758338928222656
Epoch: 20, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5504686832427979
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5240099430084229
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 217836
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7196266651153564
Epoch: 1, Steps: 7 | Train Loss: 2.483 Vali Loss: 2.487 Vali Acc: 0.097 Test Loss: 2.487 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5683279037475586
Epoch: 2, Steps: 7 | Train Loss: 2.394 Vali Loss: 2.409 Vali Acc: 0.167 Test Loss: 2.409 Test Acc: 0.167
Validation loss decreased (-0.097197 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.5345828533172607
Epoch: 3, Steps: 7 | Train Loss: 2.273 Vali Loss: 2.285 Vali Acc: 0.319 Test Loss: 2.285 Test Acc: 0.319
Validation loss decreased (-0.166643 --> -0.319422).  Saving model ...
Epoch: 4 cost time: 0.6213934421539307
Epoch: 4, Steps: 7 | Train Loss: 2.091 Vali Loss: 2.121 Vali Acc: 0.556 Test Loss: 2.121 Test Acc: 0.556
Validation loss decreased (-0.319422 --> -0.555534).  Saving model ...
Epoch: 5 cost time: 0.6184780597686768
Epoch: 5, Steps: 7 | Train Loss: 1.872 Vali Loss: 1.906 Vali Acc: 0.681 Test Loss: 1.906 Test Acc: 0.681
Validation loss decreased (-0.555534 --> -0.680536).  Saving model ...
Epoch: 6 cost time: 0.5408511161804199
Epoch: 6, Steps: 7 | Train Loss: 1.612 Vali Loss: 1.655 Vali Acc: 0.792 Test Loss: 1.655 Test Acc: 0.792
Validation loss decreased (-0.680536 --> -0.791650).  Saving model ...
Epoch: 7 cost time: 0.5048284530639648
Epoch: 7, Steps: 7 | Train Loss: 1.315 Vali Loss: 1.377 Vali Acc: 0.819 Test Loss: 1.377 Test Acc: 0.819
Validation loss decreased (-0.791650 --> -0.819431).  Saving model ...
Epoch: 8 cost time: 0.4828476905822754
Epoch: 8, Steps: 7 | Train Loss: 1.001 Vali Loss: 1.101 Vali Acc: 0.806 Test Loss: 1.101 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5667657852172852
Epoch: 9, Steps: 7 | Train Loss: 0.736 Vali Loss: 0.863 Vali Acc: 0.861 Test Loss: 0.863 Test Acc: 0.861
Validation loss decreased (-0.819431 --> -0.861102).  Saving model ...
Epoch: 10 cost time: 0.5670068264007568
Epoch: 10, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.662 Vali Acc: 0.847 Test Loss: 0.662 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7167613506317139
Epoch: 11, Steps: 7 | Train Loss: 0.315 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861106).  Saving model ...
Epoch: 12 cost time: 0.6635801792144775
Epoch: 12, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.442 Vali Acc: 0.889 Test Loss: 0.442 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888884).  Saving model ...
Epoch: 13 cost time: 0.5722017288208008
Epoch: 13, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.5568408966064453
Epoch: 14, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.5731539726257324
Epoch: 15, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.5964598655700684
Epoch: 16, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.5569303035736084
Epoch: 17, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.5777130126953125
Epoch: 18, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.5677921772003174
Epoch: 19, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.5449545383453369
Epoch: 20, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.5548043251037598
Epoch: 21, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.5375711917877197
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.556293249130249
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.5248534679412842
Epoch: 24, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5370528697967529
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.5936305522918701
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5301475524902344
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6228258609771729
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5394871234893799
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5439348220825195
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5488014221191406
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5719249248504639
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.570911169052124
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5542576313018799
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5539884567260742
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5399212837219238
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5592906475067139
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6075723171234131
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5910704135894775
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5561575889587402
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5254158973693848
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5433135032653809
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5241994857788086
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.523961067199707
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5865154266357422
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5620617866516113
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 204972
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6030149459838867
Epoch: 1, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.397 Vali Acc: 0.250 Test Loss: 2.397 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 0.565746545791626
Epoch: 2, Steps: 7 | Train Loss: 2.397 Vali Loss: 2.338 Vali Acc: 0.333 Test Loss: 2.338 Test Acc: 0.333
Validation loss decreased (-0.249976 --> -0.333310).  Saving model ...
Epoch: 3 cost time: 0.6232266426086426
Epoch: 3, Steps: 7 | Train Loss: 2.290 Vali Loss: 2.243 Vali Acc: 0.500 Test Loss: 2.243 Test Acc: 0.500
Validation loss decreased (-0.333310 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 0.5135543346405029
Epoch: 4, Steps: 7 | Train Loss: 2.174 Vali Loss: 2.113 Vali Acc: 0.611 Test Loss: 2.113 Test Acc: 0.611
Validation loss decreased (-0.499978 --> -0.611090).  Saving model ...
Epoch: 5 cost time: 0.5442929267883301
Epoch: 5, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.947 Vali Acc: 0.722 Test Loss: 1.947 Test Acc: 0.722
Validation loss decreased (-0.611090 --> -0.722203).  Saving model ...
Epoch: 6 cost time: 0.5138840675354004
Epoch: 6, Steps: 7 | Train Loss: 1.789 Vali Loss: 1.746 Vali Acc: 0.792 Test Loss: 1.746 Test Acc: 0.792
Validation loss decreased (-0.722203 --> -0.791649).  Saving model ...
Epoch: 7 cost time: 0.5147080421447754
Epoch: 7, Steps: 7 | Train Loss: 1.563 Vali Loss: 1.514 Vali Acc: 0.819 Test Loss: 1.514 Test Acc: 0.819
Validation loss decreased (-0.791649 --> -0.819429).  Saving model ...
Epoch: 8 cost time: 0.5395259857177734
Epoch: 8, Steps: 7 | Train Loss: 1.316 Vali Loss: 1.286 Vali Acc: 0.833 Test Loss: 1.286 Test Acc: 0.833
Validation loss decreased (-0.819429 --> -0.833320).  Saving model ...
Epoch: 9 cost time: 0.4868342876434326
Epoch: 9, Steps: 7 | Train Loss: 1.055 Vali Loss: 1.053 Vali Acc: 0.861 Test Loss: 1.053 Test Acc: 0.861
Validation loss decreased (-0.833320 --> -0.861101).  Saving model ...
Epoch: 10 cost time: 0.6742355823516846
Epoch: 10, Steps: 7 | Train Loss: 0.817 Vali Loss: 0.842 Vali Acc: 0.917 Test Loss: 0.842 Test Acc: 0.917
Validation loss decreased (-0.861101 --> -0.916658).  Saving model ...
Epoch: 11 cost time: 0.4946713447570801
Epoch: 11, Steps: 7 | Train Loss: 0.608 Vali Loss: 0.671 Vali Acc: 0.931 Test Loss: 0.671 Test Acc: 0.931
Validation loss decreased (-0.916658 --> -0.930549).  Saving model ...
Epoch: 12 cost time: 0.585432767868042
Epoch: 12, Steps: 7 | Train Loss: 0.431 Vali Loss: 0.541 Vali Acc: 0.917 Test Loss: 0.541 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5246109962463379
Epoch: 13, Steps: 7 | Train Loss: 0.300 Vali Loss: 0.449 Vali Acc: 0.917 Test Loss: 0.449 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.501589298248291
Epoch: 14, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.395 Vali Acc: 0.917 Test Loss: 0.395 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5216324329376221
Epoch: 15, Steps: 7 | Train Loss: 0.149 Vali Loss: 0.355 Vali Acc: 0.931 Test Loss: 0.355 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.5395736694335938
Epoch: 16, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.49309325218200684
Epoch: 17, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.5181601047515869
Epoch: 18, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5199999809265137
Epoch: 19, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5362153053283691
Epoch: 20, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5238211154937744
Epoch: 21, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.4527561664581299
Epoch: 22, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4975697994232178
Epoch: 23, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5778927803039551
Epoch: 24, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4579124450683594
Epoch: 25, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5178453922271729
Epoch: 26, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5341165065765381
Epoch: 27, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4408690929412842
Epoch: 28, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5213320255279541
Epoch: 29, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5933711528778076
Epoch: 30, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.47785162925720215
Epoch: 31, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5363049507141113
Epoch: 32, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5131158828735352
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.4895026683807373
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5057427883148193
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5314979553222656
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.586641788482666
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5066637992858887
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5537490844726562
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5549952983856201
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5136394500732422
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.5699138641357422
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.5336568355560303
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.5063440799713135
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.5280113220214844
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.5436427593231201
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.5548865795135498
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5269992351531982
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5475726127624512
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.47319936752319336
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 193068
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.77101469039917
Epoch: 1, Steps: 7 | Train Loss: 2.496 Vali Loss: 2.450 Vali Acc: 0.153 Test Loss: 2.450 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.5788326263427734
Epoch: 2, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.400 Vali Acc: 0.194 Test Loss: 2.400 Test Acc: 0.194
Validation loss decreased (-0.152753 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.5514917373657227
Epoch: 3, Steps: 7 | Train Loss: 2.368 Vali Loss: 2.317 Vali Acc: 0.306 Test Loss: 2.317 Test Acc: 0.306
Validation loss decreased (-0.194420 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 0.4844093322753906
Epoch: 4, Steps: 7 | Train Loss: 2.262 Vali Loss: 2.208 Vali Acc: 0.514 Test Loss: 2.208 Test Acc: 0.514
Validation loss decreased (-0.305532 --> -0.513867).  Saving model ...
Epoch: 5 cost time: 0.5331747531890869
Epoch: 5, Steps: 7 | Train Loss: 2.088 Vali Loss: 2.075 Vali Acc: 0.597 Test Loss: 2.075 Test Acc: 0.597
Validation loss decreased (-0.513867 --> -0.597201).  Saving model ...
Epoch: 6 cost time: 0.5028994083404541
Epoch: 6, Steps: 7 | Train Loss: 1.940 Vali Loss: 1.913 Vali Acc: 0.708 Test Loss: 1.913 Test Acc: 0.708
Validation loss decreased (-0.597201 --> -0.708314).  Saving model ...
Epoch: 7 cost time: 0.5417129993438721
Epoch: 7, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.734 Vali Acc: 0.792 Test Loss: 1.734 Test Acc: 0.792
Validation loss decreased (-0.708314 --> -0.791649).  Saving model ...
Epoch: 8 cost time: 0.5186634063720703
Epoch: 8, Steps: 7 | Train Loss: 1.581 Vali Loss: 1.546 Vali Acc: 0.792 Test Loss: 1.546 Test Acc: 0.792
Validation loss decreased (-0.791649 --> -0.791651).  Saving model ...
Epoch: 9 cost time: 0.5516109466552734
Epoch: 9, Steps: 7 | Train Loss: 1.375 Vali Loss: 1.353 Vali Acc: 0.792 Test Loss: 1.353 Test Acc: 0.792
Validation loss decreased (-0.791651 --> -0.791653).  Saving model ...
Epoch: 10 cost time: 0.5024352073669434
Epoch: 10, Steps: 7 | Train Loss: 1.152 Vali Loss: 1.171 Vali Acc: 0.819 Test Loss: 1.171 Test Acc: 0.819
Validation loss decreased (-0.791653 --> -0.819433).  Saving model ...
Epoch: 11 cost time: 0.5497713088989258
Epoch: 11, Steps: 7 | Train Loss: 0.952 Vali Loss: 1.002 Vali Acc: 0.847 Test Loss: 1.002 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847212).  Saving model ...
Epoch: 12 cost time: 0.513723611831665
Epoch: 12, Steps: 7 | Train Loss: 0.753 Vali Loss: 0.854 Vali Acc: 0.875 Test Loss: 0.854 Test Acc: 0.875
Validation loss decreased (-0.847212 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.48247194290161133
Epoch: 13, Steps: 7 | Train Loss: 0.605 Vali Loss: 0.721 Vali Acc: 0.861 Test Loss: 0.721 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.48682594299316406
Epoch: 14, Steps: 7 | Train Loss: 0.466 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4601924419403076
Epoch: 15, Steps: 7 | Train Loss: 0.355 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 0.6053886413574219
Epoch: 16, Steps: 7 | Train Loss: 0.283 Vali Loss: 0.487 Vali Acc: 0.903 Test Loss: 0.487 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 17 cost time: 0.6355419158935547
Epoch: 17, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4947807788848877
Epoch: 18, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6105623245239258
Epoch: 19, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.552504301071167
Epoch: 20, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.518596887588501
Epoch: 21, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.515251636505127
Epoch: 22, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.5131640434265137
Epoch: 23, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.5101978778839111
Epoch: 24, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.561284065246582
Epoch: 25, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5654456615447998
Epoch: 26, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5230894088745117
Epoch: 27, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5706305503845215
Epoch: 28, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.47690296173095703
Epoch: 29, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.48239994049072266
Epoch: 30, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5723574161529541
Epoch: 31, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5857400894165039
Epoch: 32, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5459854602813721
Epoch: 33, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 185772
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6854608058929443
Epoch: 1, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.465 Vali Acc: 0.111 Test Loss: 2.465 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.47220301628112793
Epoch: 2, Steps: 7 | Train Loss: 2.481 Vali Loss: 2.429 Vali Acc: 0.125 Test Loss: 2.429 Test Acc: 0.125
Validation loss decreased (-0.111086 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.5488138198852539
Epoch: 3, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.363 Vali Acc: 0.208 Test Loss: 2.363 Test Acc: 0.208
Validation loss decreased (-0.124976 --> -0.208310).  Saving model ...
Epoch: 4 cost time: 0.500497579574585
Epoch: 4, Steps: 7 | Train Loss: 2.290 Vali Loss: 2.276 Vali Acc: 0.375 Test Loss: 2.276 Test Acc: 0.375
Validation loss decreased (-0.208310 --> -0.374977).  Saving model ...
Epoch: 5 cost time: 0.4880642890930176
Epoch: 5, Steps: 7 | Train Loss: 2.186 Vali Loss: 2.164 Vali Acc: 0.556 Test Loss: 2.164 Test Acc: 0.556
Validation loss decreased (-0.374977 --> -0.555534).  Saving model ...
Epoch: 6 cost time: 0.523698091506958
Epoch: 6, Steps: 7 | Train Loss: 2.036 Vali Loss: 2.040 Vali Acc: 0.625 Test Loss: 2.040 Test Acc: 0.625
Validation loss decreased (-0.555534 --> -0.624980).  Saving model ...
Epoch: 7 cost time: 0.5154173374176025
Epoch: 7, Steps: 7 | Train Loss: 1.894 Vali Loss: 1.890 Vali Acc: 0.667 Test Loss: 1.890 Test Acc: 0.667
Validation loss decreased (-0.624980 --> -0.666648).  Saving model ...
Epoch: 8 cost time: 0.5036535263061523
Epoch: 8, Steps: 7 | Train Loss: 1.710 Vali Loss: 1.721 Vali Acc: 0.708 Test Loss: 1.721 Test Acc: 0.708
Validation loss decreased (-0.666648 --> -0.708316).  Saving model ...
Epoch: 9 cost time: 0.5088295936584473
Epoch: 9, Steps: 7 | Train Loss: 1.540 Vali Loss: 1.546 Vali Acc: 0.750 Test Loss: 1.546 Test Acc: 0.750
Validation loss decreased (-0.708316 --> -0.749985).  Saving model ...
Epoch: 10 cost time: 0.48931455612182617
Epoch: 10, Steps: 7 | Train Loss: 1.350 Vali Loss: 1.370 Vali Acc: 0.778 Test Loss: 1.370 Test Acc: 0.778
Validation loss decreased (-0.749985 --> -0.777764).  Saving model ...
Epoch: 11 cost time: 0.4251532554626465
Epoch: 11, Steps: 7 | Train Loss: 1.146 Vali Loss: 1.202 Vali Acc: 0.806 Test Loss: 1.202 Test Acc: 0.806
Validation loss decreased (-0.777764 --> -0.805544).  Saving model ...
Epoch: 12 cost time: 0.465360164642334
Epoch: 12, Steps: 7 | Train Loss: 0.932 Vali Loss: 1.038 Vali Acc: 0.833 Test Loss: 1.038 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833323).  Saving model ...
Epoch: 13 cost time: 0.47664403915405273
Epoch: 13, Steps: 7 | Train Loss: 0.766 Vali Loss: 0.893 Vali Acc: 0.861 Test Loss: 0.893 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861102).  Saving model ...
Epoch: 14 cost time: 0.5076680183410645
Epoch: 14, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.774 Vali Acc: 0.875 Test Loss: 0.774 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.5123212337493896
Epoch: 15, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.677 Vali Acc: 0.889 Test Loss: 0.677 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 0.4508504867553711
Epoch: 16, Steps: 7 | Train Loss: 0.371 Vali Loss: 0.601 Vali Acc: 0.889 Test Loss: 0.601 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 17 cost time: 0.5085310935974121
Epoch: 17, Steps: 7 | Train Loss: 0.292 Vali Loss: 0.539 Vali Acc: 0.903 Test Loss: 0.539 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 18 cost time: 0.47034120559692383
Epoch: 18, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5157818794250488
Epoch: 19, Steps: 7 | Train Loss: 0.190 Vali Loss: 0.472 Vali Acc: 0.903 Test Loss: 0.472 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 20 cost time: 0.5257363319396973
Epoch: 20, Steps: 7 | Train Loss: 0.162 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 21 cost time: 0.4791686534881592
Epoch: 21, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.416 Vali Acc: 0.903 Test Loss: 0.416 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.48534440994262695
Epoch: 22, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.4821650981903076
Epoch: 23, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.48272252082824707
Epoch: 24, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.5008869171142578
Epoch: 25, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.45014429092407227
Epoch: 26, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.358 Vali Acc: 0.931 Test Loss: 0.358 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.5252184867858887
Epoch: 27, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.346 Vali Acc: 0.931 Test Loss: 0.346 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.5028619766235352
Epoch: 28, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 29 cost time: 0.43137121200561523
Epoch: 29, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.48560285568237305
Epoch: 30, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 31 cost time: 0.4903085231781006
Epoch: 31, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 32 cost time: 0.4763679504394531
Epoch: 32, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 33 cost time: 0.5018343925476074
Epoch: 33, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 34 cost time: 0.47997260093688965
Epoch: 34, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 35 cost time: 0.5196526050567627
Epoch: 35, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 36 cost time: 0.4460630416870117
Epoch: 36, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.49794507026672363
Epoch: 37, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4694230556488037
Epoch: 38, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.47486424446105957
Epoch: 39, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4586024284362793
Epoch: 40, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 41 cost time: 0.4718821048736572
Epoch: 41, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 42 cost time: 0.517751932144165
Epoch: 42, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 43 cost time: 0.566476583480835
Epoch: 43, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5080931186676025
Epoch: 44, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.47861409187316895
Epoch: 45, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5268738269805908
Epoch: 46, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4799072742462158
Epoch: 47, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 48 cost time: 0.4753227233886719
Epoch: 48, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.4954681396484375
Epoch: 49, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.4984757900238037
Epoch: 50, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 183084
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8173892498016357
Epoch: 1, Steps: 7 | Train Loss: 2.431 Vali Loss: 1.916 Vali Acc: 0.625 Test Loss: 1.916 Test Acc: 0.625
Validation loss decreased (inf --> -0.624981).  Saving model ...
Epoch: 2 cost time: 0.7778265476226807
Epoch: 2, Steps: 7 | Train Loss: 0.690 Vali Loss: 0.491 Vali Acc: 0.931 Test Loss: 0.491 Test Acc: 0.931
Validation loss decreased (-0.624981 --> -0.930551).  Saving model ...
Epoch: 3 cost time: 0.8274059295654297
Epoch: 3, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6829226016998291
Epoch: 4, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8067138195037842
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6832807064056396
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7765729427337646
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7694716453552246
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8257999420166016
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6661725044250488
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7242186069488525
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8029277324676514
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 3117836
model size : 11.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7546114921569824
Epoch: 1, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.162 Vali Acc: 0.500 Test Loss: 2.162 Test Acc: 0.500
Validation loss decreased (inf --> -0.499978).  Saving model ...
Epoch: 2 cost time: 0.6194064617156982
Epoch: 2, Steps: 7 | Train Loss: 1.225 Vali Loss: 1.024 Vali Acc: 0.833 Test Loss: 1.024 Test Acc: 0.833
Validation loss decreased (-0.499978 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 0.6734778881072998
Epoch: 3, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.393 Vali Acc: 0.931 Test Loss: 0.393 Test Acc: 0.931
Validation loss decreased (-0.833323 --> -0.930552).  Saving model ...
Epoch: 4 cost time: 0.5388741493225098
Epoch: 4, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6390342712402344
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.5475184917449951
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 0.5154316425323486
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.5482745170593262
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.5359828472137451
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.6252374649047852
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.594085693359375
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.6421432495117188
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6415438652038574
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6860222816467285
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.6570982933044434
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5776939392089844
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.606787919998169
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6069848537445068
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5926675796508789
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5418527126312256
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.604060173034668
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5906565189361572
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6710073947906494
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6757795810699463
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7545311450958252
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5938999652862549
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.682171106338501
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6334872245788574
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6620187759399414
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6368591785430908
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6851081848144531
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.6410284042358398
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.709571361541748
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.6641750335693359
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.5993843078613281
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.5519602298736572
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.5789868831634521
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6277575492858887
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.5388400554656982
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.6724786758422852
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.6177515983581543
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.6799075603485107
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.6931066513061523
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.6792299747467041
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.6369779109954834
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.6797175407409668
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.6613385677337646
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5760576725006104
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6422576904296875
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5815544128417969
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2388236
model size : 9.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7680397033691406
Epoch: 1, Steps: 7 | Train Loss: 2.387 Vali Loss: 2.212 Vali Acc: 0.375 Test Loss: 2.212 Test Acc: 0.375
Validation loss decreased (inf --> -0.374978).  Saving model ...
Epoch: 2 cost time: 0.5484836101531982
Epoch: 2, Steps: 7 | Train Loss: 1.464 Vali Loss: 1.283 Vali Acc: 0.861 Test Loss: 1.283 Test Acc: 0.861
Validation loss decreased (-0.374978 --> -0.861098).  Saving model ...
Epoch: 3 cost time: 0.592979907989502
Epoch: 3, Steps: 7 | Train Loss: 0.411 Vali Loss: 0.565 Vali Acc: 0.903 Test Loss: 0.565 Test Acc: 0.903
Validation loss decreased (-0.861098 --> -0.902772).  Saving model ...
Epoch: 4 cost time: 0.5818121433258057
Epoch: 4, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.366 Vali Acc: 0.931 Test Loss: 0.366 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 0.5770368576049805
Epoch: 5, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.6205811500549316
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 0.6602568626403809
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 0.5785624980926514
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 0.6130108833312988
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.597536563873291
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 0.6176996231079102
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 0.6343140602111816
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 0.6423161029815674
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6593377590179443
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6038429737091064
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5818274021148682
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6228370666503906
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5611171722412109
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6287574768066406
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6032321453094482
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6606895923614502
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5519025325775146
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 2156300
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.709078311920166
Epoch: 1, Steps: 7 | Train Loss: 2.533 Vali Loss: 2.254 Vali Acc: 0.306 Test Loss: 2.254 Test Acc: 0.306
Validation loss decreased (inf --> -0.305533).  Saving model ...
Epoch: 2 cost time: 0.5100288391113281
Epoch: 2, Steps: 7 | Train Loss: 1.775 Vali Loss: 1.479 Vali Acc: 0.833 Test Loss: 1.479 Test Acc: 0.833
Validation loss decreased (-0.305533 --> -0.833319).  Saving model ...
Epoch: 3 cost time: 0.5615558624267578
Epoch: 3, Steps: 7 | Train Loss: 0.757 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
Validation loss decreased (-0.833319 --> -0.874992).  Saving model ...
Epoch: 4 cost time: 0.5577237606048584
Epoch: 4, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.409 Vali Acc: 0.917 Test Loss: 0.409 Test Acc: 0.917
Validation loss decreased (-0.874992 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 0.49828386306762695
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.47980237007141113
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 7 cost time: 0.47276997566223145
Epoch: 7, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.5093498229980469
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.5180621147155762
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.5700149536132812
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5474121570587158
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5544509887695312
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5315244197845459
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.5488309860229492
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5233664512634277
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5851840972900391
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.5111384391784668
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.5401556491851807
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.5333001613616943
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.5756561756134033
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.5461544990539551
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.5468766689300537
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.5637736320495605
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.5553104877471924
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.6021921634674072
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.5825989246368408
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.5331888198852539
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.586510181427002
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.5565550327301025
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5989320278167725
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.5918381214141846
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.5394406318664551
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5577518939971924
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.5464186668395996
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.5275764465332031
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.49365973472595215
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.5511264801025391
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5925164222717285
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5609922409057617
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5916225910186768
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5874359607696533
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.5249764919281006
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.5283751487731934
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.5369045734405518
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.5458962917327881
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.5147886276245117
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.5172121524810791
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5882937908172607
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5664021968841553
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.6206345558166504
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2034956
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7548396587371826
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.355 Vali Acc: 0.250 Test Loss: 2.355 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 0.5690808296203613
Epoch: 2, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.724 Vali Acc: 0.708 Test Loss: 1.724 Test Acc: 0.708
Validation loss decreased (-0.249976 --> -0.708316).  Saving model ...
Epoch: 3 cost time: 0.5292248725891113
Epoch: 3, Steps: 7 | Train Loss: 1.049 Vali Loss: 1.058 Vali Acc: 0.806 Test Loss: 1.058 Test Acc: 0.806
Validation loss decreased (-0.708316 --> -0.805545).  Saving model ...
Epoch: 4 cost time: 0.5514488220214844
Epoch: 4, Steps: 7 | Train Loss: 0.400 Vali Loss: 0.595 Vali Acc: 0.931 Test Loss: 0.595 Test Acc: 0.931
Validation loss decreased (-0.805545 --> -0.930550).  Saving model ...
Epoch: 5 cost time: 0.5799045562744141
Epoch: 5, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944441).  Saving model ...
Epoch: 6 cost time: 0.5549063682556152
Epoch: 6, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6094372272491455
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5859827995300293
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.532271146774292
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.5787389278411865
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.5992865562438965
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.5375821590423584
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.6366438865661621
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.589346170425415
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.6143529415130615
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6191942691802979
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.535876989364624
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5405735969543457
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5323271751403809
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.5115056037902832
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.4664900302886963
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.5619359016418457
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.5858302116394043
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.5468401908874512
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.5445754528045654
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.6083517074584961
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.6252069473266602
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.6103668212890625
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5740516185760498
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5547740459442139
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.5433909893035889
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6250958442687988
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.6129827499389648
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.5671961307525635
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.6174516677856445
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.5859503746032715
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.5201165676116943
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.650122880935669
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.6137332916259766
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.5908372402191162
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.6198828220367432
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.5855116844177246
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6385807991027832
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.5908002853393555
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.5727698802947998
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.5742204189300537
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.6168110370635986
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.599193811416626
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.5317738056182861
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.6484324932098389
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1939724
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6824052333831787
Epoch: 1, Steps: 7 | Train Loss: 2.429 Vali Loss: 2.410 Vali Acc: 0.222 Test Loss: 2.410 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.516737699508667
Epoch: 2, Steps: 7 | Train Loss: 1.997 Vali Loss: 1.949 Vali Acc: 0.667 Test Loss: 1.949 Test Acc: 0.667
Validation loss decreased (-0.222198 --> -0.666647).  Saving model ...
Epoch: 3 cost time: 0.47626614570617676
Epoch: 3, Steps: 7 | Train Loss: 1.303 Vali Loss: 1.345 Vali Acc: 0.833 Test Loss: 1.345 Test Acc: 0.833
Validation loss decreased (-0.666647 --> -0.833320).  Saving model ...
Epoch: 4 cost time: 0.539278507232666
Epoch: 4, Steps: 7 | Train Loss: 0.650 Vali Loss: 0.861 Vali Acc: 0.875 Test Loss: 0.861 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874991).  Saving model ...
Epoch: 5 cost time: 0.6595518589019775
Epoch: 5, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.5700891017913818
Epoch: 6, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.6543588638305664
Epoch: 7, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
Validation loss decreased (-0.888885 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 0.6820785999298096
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.322 Vali Acc: 0.958 Test Loss: 0.322 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 9 cost time: 0.5946378707885742
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.307 Vali Acc: 0.958 Test Loss: 0.307 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.6039583683013916
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.958 Test Loss: 0.299 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.5848486423492432
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6185469627380371
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6509230136871338
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5821003913879395
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.958 Test Loss: 0.283 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.6284589767456055
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6774744987487793
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5884215831756592
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.958 Test Loss: 0.272 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.642829179763794
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.6336696147918701
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.958 Test Loss: 0.265 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.6148796081542969
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.6837944984436035
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.6475276947021484
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.6172800064086914
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6210625171661377
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6397476196289062
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.5607147216796875
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.5671284198760986
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.582747220993042
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.572197437286377
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5713369846343994
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.972 Test Loss: 0.249 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 31 cost time: 0.5511810779571533
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.6323907375335693
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.5755832195281982
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.972 Test Loss: 0.244 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.6257591247558594
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.958 Test Loss: 0.243 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6173708438873291
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5968034267425537
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5596311092376709
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5838394165039062
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6067416667938232
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.972 Test Loss: 0.238 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 0.62034010887146
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.972 Test Loss: 0.237 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 41 cost time: 0.695746898651123
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.972 Test Loss: 0.236 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 42 cost time: 0.609565258026123
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.972 Test Loss: 0.236 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.6493556499481201
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.972 Test Loss: 0.236 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.6873483657836914
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.6188535690307617
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.5858738422393799
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 0.6547155380249023
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.6453070640563965
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 0.6365649700164795
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.555931806564331
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 1881356
model size : 7.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6679847240447998
Epoch: 1, Steps: 7 | Train Loss: 2.562 Vali Loss: 2.487 Vali Acc: 0.111 Test Loss: 2.487 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5315761566162109
Epoch: 2, Steps: 7 | Train Loss: 2.195 Vali Loss: 2.073 Vali Acc: 0.556 Test Loss: 2.073 Test Acc: 0.556
Validation loss decreased (-0.111086 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 0.6194286346435547
Epoch: 3, Steps: 7 | Train Loss: 1.525 Vali Loss: 1.516 Vali Acc: 0.764 Test Loss: 1.516 Test Acc: 0.764
Validation loss decreased (-0.555535 --> -0.763874).  Saving model ...
Epoch: 4 cost time: 0.5688984394073486
Epoch: 4, Steps: 7 | Train Loss: 0.863 Vali Loss: 1.017 Vali Acc: 0.889 Test Loss: 1.017 Test Acc: 0.889
Validation loss decreased (-0.763874 --> -0.888879).  Saving model ...
Epoch: 5 cost time: 0.6281383037567139
Epoch: 5, Steps: 7 | Train Loss: 0.430 Vali Loss: 0.674 Vali Acc: 0.944 Test Loss: 0.674 Test Acc: 0.944
Validation loss decreased (-0.888879 --> -0.944438).  Saving model ...
Epoch: 6 cost time: 0.6004438400268555
Epoch: 6, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.504 Vali Acc: 0.944 Test Loss: 0.504 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944439).  Saving model ...
Epoch: 7 cost time: 0.5373153686523438
Epoch: 7, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6148800849914551
Epoch: 8, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.396 Vali Acc: 0.917 Test Loss: 0.396 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5931024551391602
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.587273120880127
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5829846858978271
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5576150417327881
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.5574429035186768
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.573723316192627
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.6339352130889893
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.6137006282806396
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.6867928504943848
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5951433181762695
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5407235622406006
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5796661376953125
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5778169631958008
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6025280952453613
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6046442985534668
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5827603340148926
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5927672386169434
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5889115333557129
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6108815670013428
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5528404712677002
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6045584678649902
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5466480255126953
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.6028735637664795
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5762965679168701
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6603744029998779
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5716602802276611
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6280660629272461
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6359248161315918
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6048035621643066
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5773906707763672
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7289309501647949
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6370871067047119
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6672906875610352
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.65120530128479
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7011227607727051
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6496009826660156
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.696007251739502
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.5990884304046631
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5739679336547852
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5695009231567383
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.6811058521270752
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6064026355743408
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1859852
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8132033348083496
Epoch: 1, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.083 Vali Acc: 0.514 Test Loss: 2.083 Test Acc: 0.514
Validation loss decreased (inf --> -0.513868).  Saving model ...
Epoch: 2 cost time: 0.6056325435638428
Epoch: 2, Steps: 7 | Train Loss: 1.226 Vali Loss: 0.991 Vali Acc: 0.861 Test Loss: 0.991 Test Acc: 0.861
Validation loss decreased (-0.513868 --> -0.861101).  Saving model ...
Epoch: 3 cost time: 0.5996856689453125
Epoch: 3, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.406 Vali Acc: 0.917 Test Loss: 0.406 Test Acc: 0.917
Validation loss decreased (-0.861101 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 0.5727853775024414
Epoch: 4, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 0.6015300750732422
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 6 cost time: 0.5764429569244385
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 0.5660758018493652
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 8 cost time: 0.5988688468933105
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 9 cost time: 0.46033287048339844
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 10 cost time: 0.5862963199615479
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 11 cost time: 0.5545682907104492
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 0.5727658271789551
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 0.5111596584320068
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 0.6313436031341553
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 0.5839371681213379
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 0.6616175174713135
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 0.5362799167633057
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 0.5775270462036133
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.917 Test Loss: 0.174 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 0.616840124130249
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.917 Test Loss: 0.173 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 0.6208169460296631
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 0.49247121810913086
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5845546722412109
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.47891807556152344
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.917 Test Loss: 0.171 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.47057437896728516
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.49938344955444336
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 0.5282895565032959
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 0.5403859615325928
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 0.5719771385192871
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.553617000579834
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 0.4987359046936035
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 0.5952591896057129
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 0.5447533130645752
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 0.5597102642059326
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5786361694335938
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5958132743835449
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.605025053024292
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5819768905639648
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5167231559753418
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5676066875457764
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5602295398712158
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5044589042663574
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5876646041870117
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1165708
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.723588228225708
Epoch: 1, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.310 Vali Acc: 0.250 Test Loss: 2.310 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 0.5496871471405029
Epoch: 2, Steps: 7 | Train Loss: 1.705 Vali Loss: 1.507 Vali Acc: 0.778 Test Loss: 1.507 Test Acc: 0.778
Validation loss decreased (-0.249977 --> -0.777763).  Saving model ...
Epoch: 3 cost time: 0.5454068183898926
Epoch: 3, Steps: 7 | Train Loss: 0.659 Vali Loss: 0.769 Vali Acc: 0.917 Test Loss: 0.769 Test Acc: 0.917
Validation loss decreased (-0.777763 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 0.5774071216583252
Epoch: 4, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.427 Vali Acc: 0.931 Test Loss: 0.427 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930551).  Saving model ...
Epoch: 5 cost time: 0.5305840969085693
Epoch: 5, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.4751710891723633
Epoch: 6, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.511803388595581
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.49962306022644043
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.5105657577514648
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.5828690528869629
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5797932147979736
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5148169994354248
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5233392715454102
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.520261287689209
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5257351398468018
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5536713600158691
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5648674964904785
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5800178050994873
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5099294185638428
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5876245498657227
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6014969348907471
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 800908
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7645573616027832
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.313 Vali Acc: 0.306 Test Loss: 2.313 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 0.5753302574157715
Epoch: 2, Steps: 7 | Train Loss: 1.945 Vali Loss: 1.723 Vali Acc: 0.778 Test Loss: 1.723 Test Acc: 0.778
Validation loss decreased (-0.305532 --> -0.777761).  Saving model ...
Epoch: 3 cost time: 0.5451333522796631
Epoch: 3, Steps: 7 | Train Loss: 1.062 Vali Loss: 1.039 Vali Acc: 0.861 Test Loss: 1.039 Test Acc: 0.861
Validation loss decreased (-0.777761 --> -0.861101).  Saving model ...
Epoch: 4 cost time: 0.5897715091705322
Epoch: 4, Steps: 7 | Train Loss: 0.426 Vali Loss: 0.613 Vali Acc: 0.903 Test Loss: 0.613 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 0.5103428363800049
Epoch: 5, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.397 Vali Acc: 0.917 Test Loss: 0.397 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.5174462795257568
Epoch: 6, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 0.5488219261169434
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.5658531188964844
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.958 Test Loss: 0.243 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 0.5587544441223145
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.5257995128631592
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.549666166305542
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.583545446395874
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.5774886608123779
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.4946751594543457
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.5931441783905029
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.5668678283691406
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.507300853729248
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5852260589599609
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5045936107635498
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4858527183532715
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5299839973449707
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.4934384822845459
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5400180816650391
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.49500131607055664
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 25 cost time: 0.5131475925445557
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.5023684501647949
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 27 cost time: 0.531545877456665
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5840530395507812
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5977325439453125
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.525733470916748
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 31 cost time: 0.6015782356262207
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6177308559417725
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.6021552085876465
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5958995819091797
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5683310031890869
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5671279430389404
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6147041320800781
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5974524021148682
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5748159885406494
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6474769115447998
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5674498081207275
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6391675472259521
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 684940
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6604030132293701
Epoch: 1, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.401 Vali Acc: 0.208 Test Loss: 2.401 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.47455501556396484
Epoch: 2, Steps: 7 | Train Loss: 2.053 Vali Loss: 1.964 Vali Acc: 0.569 Test Loss: 1.964 Test Acc: 0.569
Validation loss decreased (-0.208309 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 0.5287275314331055
Epoch: 3, Steps: 7 | Train Loss: 1.331 Vali Loss: 1.383 Vali Acc: 0.792 Test Loss: 1.383 Test Acc: 0.792
Validation loss decreased (-0.569425 --> -0.791653).  Saving model ...
Epoch: 4 cost time: 0.5175032615661621
Epoch: 4, Steps: 7 | Train Loss: 0.688 Vali Loss: 0.887 Vali Acc: 0.903 Test Loss: 0.887 Test Acc: 0.903
Validation loss decreased (-0.791653 --> -0.902769).  Saving model ...
Epoch: 5 cost time: 0.587052583694458
Epoch: 5, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.558 Vali Acc: 0.917 Test Loss: 0.558 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 0.5564613342285156
Epoch: 6, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.397 Vali Acc: 0.931 Test Loss: 0.397 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 0.6053297519683838
Epoch: 7, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6134641170501709
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.5262994766235352
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.5183196067810059
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5076513290405273
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.5753331184387207
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5400180816650391
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5205662250518799
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5427134037017822
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5267772674560547
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6025724411010742
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.5445492267608643
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5653870105743408
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.49544429779052734
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.515782356262207
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.511768102645874
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.4896540641784668
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.4848930835723877
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.49016427993774414
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.561873197555542
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5579960346221924
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5430686473846436
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.555272102355957
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.579766035079956
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5696382522583008
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5039582252502441
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.553074836730957
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.496539831161499
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5095877647399902
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.4788548946380615
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5190775394439697
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5396738052368164
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.541313886642456
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.49020862579345703
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5594296455383301
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5154135227203369
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5189998149871826
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5164833068847656
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.4959595203399658
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.5292460918426514
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5384392738342285
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5515446662902832
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5390114784240723
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6492059230804443
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 624268
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.563110113143921
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.467 Vali Acc: 0.125 Test Loss: 2.467 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.487041711807251
Epoch: 2, Steps: 7 | Train Loss: 2.205 Vali Loss: 2.141 Vali Acc: 0.458 Test Loss: 2.141 Test Acc: 0.458
Validation loss decreased (-0.124975 --> -0.458312).  Saving model ...
Epoch: 3 cost time: 0.5038630962371826
Epoch: 3, Steps: 7 | Train Loss: 1.638 Vali Loss: 1.656 Vali Acc: 0.667 Test Loss: 1.656 Test Acc: 0.667
Validation loss decreased (-0.458312 --> -0.666650).  Saving model ...
Epoch: 4 cost time: 0.5689060688018799
Epoch: 4, Steps: 7 | Train Loss: 1.016 Vali Loss: 1.180 Vali Acc: 0.889 Test Loss: 1.180 Test Acc: 0.889
Validation loss decreased (-0.666650 --> -0.888877).  Saving model ...
Epoch: 5 cost time: 0.5277137756347656
Epoch: 5, Steps: 7 | Train Loss: 0.566 Vali Loss: 0.817 Vali Acc: 0.889 Test Loss: 0.817 Test Acc: 0.889
Validation loss decreased (-0.888877 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 0.5086812973022461
Epoch: 6, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.566 Vali Acc: 0.903 Test Loss: 0.566 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.510185956954956
Epoch: 7, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.44896554946899414
Epoch: 8, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.5168335437774658
Epoch: 9, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.5755789279937744
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5036859512329102
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.45512843132019043
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.4985384941101074
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.4508943557739258
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.4717216491699219
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.4708371162414551
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.4845142364501953
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.5750081539154053
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.48821496963500977
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5853197574615479
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5450856685638428
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.4850282669067383
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5349752902984619
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6117775440216064
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5383284091949463
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6253979206085205
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.478837251663208
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5489828586578369
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5212855339050293
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.486222505569458
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.4631235599517822
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5124800205230713
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.48328375816345215
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5315077304840088
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5865483283996582
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5255017280578613
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5390017032623291
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5318539142608643
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.49657630920410156
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5725610256195068
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5249841213226318
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5387957096099854
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.49086737632751465
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5759329795837402
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5301921367645264
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.5055704116821289
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5352602005004883
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5754473209381104
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5059688091278076
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.5451538562774658
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 576652
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8229055404663086
Epoch: 1, Steps: 7 | Train Loss: 2.504 Vali Loss: 2.403 Vali Acc: 0.278 Test Loss: 2.403 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 0.5200932025909424
Epoch: 2, Steps: 7 | Train Loss: 2.246 Vali Loss: 2.154 Vali Acc: 0.500 Test Loss: 2.154 Test Acc: 0.500
Validation loss decreased (-0.277754 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 0.49395036697387695
Epoch: 3, Steps: 7 | Train Loss: 1.810 Vali Loss: 1.793 Vali Acc: 0.708 Test Loss: 1.793 Test Acc: 0.708
Validation loss decreased (-0.499978 --> -0.708315).  Saving model ...
Epoch: 4 cost time: 0.4644780158996582
Epoch: 4, Steps: 7 | Train Loss: 1.326 Vali Loss: 1.423 Vali Acc: 0.764 Test Loss: 1.423 Test Acc: 0.764
Validation loss decreased (-0.708315 --> -0.763875).  Saving model ...
Epoch: 5 cost time: 0.5374741554260254
Epoch: 5, Steps: 7 | Train Loss: 0.891 Vali Loss: 1.089 Vali Acc: 0.806 Test Loss: 1.089 Test Acc: 0.806
Validation loss decreased (-0.763875 --> -0.805545).  Saving model ...
Epoch: 6 cost time: 0.47540831565856934
Epoch: 6, Steps: 7 | Train Loss: 0.543 Vali Loss: 0.826 Vali Acc: 0.847 Test Loss: 0.826 Test Acc: 0.847
Validation loss decreased (-0.805545 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 0.4141123294830322
Epoch: 7, Steps: 7 | Train Loss: 0.320 Vali Loss: 0.633 Vali Acc: 0.889 Test Loss: 0.633 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.502556324005127
Epoch: 8, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.511 Vali Acc: 0.917 Test Loss: 0.511 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.44641733169555664
Epoch: 9, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.461 Vali Acc: 0.931 Test Loss: 0.461 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 0.4547398090362549
Epoch: 10, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.416 Vali Acc: 0.903 Test Loss: 0.416 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.464552640914917
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.45909929275512695
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.44161415100097656
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4659695625305176
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5079841613769531
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.43355655670166016
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.48595118522644043
Epoch: 17, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.4902839660644531
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5115466117858887
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4703812599182129
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 21 cost time: 0.4648551940917969
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.49400830268859863
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.49068546295166016
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.5097100734710693
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.45442867279052734
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.4839043617248535
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4843473434448242
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.44612550735473633
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.4833245277404785
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.4873695373535156
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.44087839126586914
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.4609866142272949
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.4814610481262207
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.4778285026550293
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.46291089057922363
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.4718930721282959
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.48166871070861816
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.4884026050567627
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5469841957092285
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.47252798080444336
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.4140806198120117
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.4883546829223633
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.4488637447357178
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.47754740715026855
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5088033676147461
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5055675506591797
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.5184369087219238
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.4657440185546875
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.4678807258605957
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.4574558734893799
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 547468
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6708922386169434
Epoch: 1, Steps: 7 | Train Loss: 2.445 Vali Loss: 2.411 Vali Acc: 0.167 Test Loss: 2.411 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.48920607566833496
Epoch: 2, Steps: 7 | Train Loss: 2.269 Vali Loss: 2.192 Vali Acc: 0.431 Test Loss: 2.192 Test Acc: 0.431
Validation loss decreased (-0.166643 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.4605255126953125
Epoch: 3, Steps: 7 | Train Loss: 1.877 Vali Loss: 1.860 Vali Acc: 0.667 Test Loss: 1.860 Test Acc: 0.667
Validation loss decreased (-0.430534 --> -0.666648).  Saving model ...
Epoch: 4 cost time: 0.47995638847351074
Epoch: 4, Steps: 7 | Train Loss: 1.452 Vali Loss: 1.499 Vali Acc: 0.722 Test Loss: 1.499 Test Acc: 0.722
Validation loss decreased (-0.666648 --> -0.722207).  Saving model ...
Epoch: 5 cost time: 0.43800878524780273
Epoch: 5, Steps: 7 | Train Loss: 1.042 Vali Loss: 1.161 Vali Acc: 0.833 Test Loss: 1.161 Test Acc: 0.833
Validation loss decreased (-0.722207 --> -0.833322).  Saving model ...
Epoch: 6 cost time: 0.4997868537902832
Epoch: 6, Steps: 7 | Train Loss: 0.695 Vali Loss: 0.909 Vali Acc: 0.847 Test Loss: 0.909 Test Acc: 0.847
Validation loss decreased (-0.833322 --> -0.847213).  Saving model ...
Epoch: 7 cost time: 0.464188814163208
Epoch: 7, Steps: 7 | Train Loss: 0.440 Vali Loss: 0.721 Vali Acc: 0.889 Test Loss: 0.721 Test Acc: 0.889
Validation loss decreased (-0.847213 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 0.45265936851501465
Epoch: 8, Steps: 7 | Train Loss: 0.263 Vali Loss: 0.583 Vali Acc: 0.917 Test Loss: 0.583 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916661).  Saving model ...
Epoch: 9 cost time: 0.49667859077453613
Epoch: 9, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.503 Vali Acc: 0.931 Test Loss: 0.503 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 0.5801339149475098
Epoch: 10, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.457 Vali Acc: 0.931 Test Loss: 0.457 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 11 cost time: 0.5306830406188965
Epoch: 11, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5220286846160889
Epoch: 12, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.401 Vali Acc: 0.917 Test Loss: 0.401 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5578882694244385
Epoch: 13, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.380 Vali Acc: 0.931 Test Loss: 0.380 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.5222904682159424
Epoch: 14, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.367 Vali Acc: 0.931 Test Loss: 0.367 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 0.5215284824371338
Epoch: 15, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.5647909641265869
Epoch: 16, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.359 Vali Acc: 0.917 Test Loss: 0.359 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4585278034210205
Epoch: 17, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5452573299407959
Epoch: 18, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.351 Vali Acc: 0.917 Test Loss: 0.351 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5363430976867676
Epoch: 19, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 0.46697115898132324
Epoch: 20, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.339 Vali Acc: 0.931 Test Loss: 0.339 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 21 cost time: 0.5136797428131104
Epoch: 21, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 22 cost time: 0.5212957859039307
Epoch: 22, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.329 Vali Acc: 0.931 Test Loss: 0.329 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.5001978874206543
Epoch: 23, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.327 Vali Acc: 0.931 Test Loss: 0.327 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.5216267108917236
Epoch: 24, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.322 Vali Acc: 0.931 Test Loss: 0.322 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.5734515190124512
Epoch: 25, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.5068562030792236
Epoch: 26, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.5500388145446777
Epoch: 27, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.316 Vali Acc: 0.931 Test Loss: 0.316 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.5481095314025879
Epoch: 28, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 29 cost time: 0.49251532554626465
Epoch: 29, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.5404222011566162
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 31 cost time: 0.532930850982666
Epoch: 31, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6084694862365723
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5048813819885254
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5402765274047852
Epoch: 34, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5014669895172119
Epoch: 35, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.52980637550354
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.536069393157959
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5215129852294922
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5734789371490479
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.485032320022583
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.5116696357727051
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5588521957397461
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.5392603874206543
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5295593738555908
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.931 Test Loss: 0.296 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5980753898620605
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5733120441436768
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.5313155651092529
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.46369481086730957
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.555133581161499
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.4956471920013428
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 536716
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7343661785125732
Epoch: 1, Steps: 7 | Train Loss: 2.495 Vali Loss: 2.355 Vali Acc: 0.264 Test Loss: 2.355 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.47826242446899414
Epoch: 2, Steps: 7 | Train Loss: 1.754 Vali Loss: 1.657 Vali Acc: 0.847 Test Loss: 1.657 Test Acc: 0.847
Validation loss decreased (-0.263865 --> -0.847206).  Saving model ...
Epoch: 3 cost time: 0.48139095306396484
Epoch: 3, Steps: 7 | Train Loss: 0.686 Vali Loss: 0.862 Vali Acc: 0.917 Test Loss: 0.862 Test Acc: 0.917
Validation loss decreased (-0.847206 --> -0.916658).  Saving model ...
Epoch: 4 cost time: 0.488539457321167
Epoch: 4, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.451 Vali Acc: 0.944 Test Loss: 0.451 Test Acc: 0.944
Validation loss decreased (-0.916658 --> -0.944440).  Saving model ...
Epoch: 5 cost time: 0.522280216217041
Epoch: 5, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.260 Vali Acc: 0.958 Test Loss: 0.260 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958331).  Saving model ...
Epoch: 6 cost time: 0.573775053024292
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 0.47683286666870117
Epoch: 7, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 8 cost time: 0.527421236038208
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 9 cost time: 0.4887089729309082
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 10 cost time: 0.4927799701690674
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4741981029510498
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.46558094024658203
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4967074394226074
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5233461856842041
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4999418258666992
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5208747386932373
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5236761569976807
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4803323745727539
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5304334163665771
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 484556
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6813983917236328
Epoch: 1, Steps: 7 | Train Loss: 2.516 Vali Loss: 2.412 Vali Acc: 0.181 Test Loss: 2.412 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.4541015625
Epoch: 2, Steps: 7 | Train Loss: 2.066 Vali Loss: 1.944 Vali Acc: 0.597 Test Loss: 1.944 Test Acc: 0.597
Validation loss decreased (-0.180531 --> -0.597203).  Saving model ...
Epoch: 3 cost time: 0.47554731369018555
Epoch: 3, Steps: 7 | Train Loss: 1.311 Vali Loss: 1.339 Vali Acc: 0.833 Test Loss: 1.339 Test Acc: 0.833
Validation loss decreased (-0.597203 --> -0.833320).  Saving model ...
Epoch: 4 cost time: 0.45969295501708984
Epoch: 4, Steps: 7 | Train Loss: 0.663 Vali Loss: 0.838 Vali Acc: 0.875 Test Loss: 0.838 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 0.45874786376953125
Epoch: 5, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.540 Vali Acc: 0.903 Test Loss: 0.540 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 0.45283007621765137
Epoch: 6, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.511707067489624
Epoch: 7, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.4538555145263672
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.4888947010040283
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.4339437484741211
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.49244141578674316
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.44963836669921875
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.46663928031921387
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.4522538185119629
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.43587231636047363
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4415929317474365
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.43990373611450195
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.42825818061828613
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5118420124053955
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.4271242618560791
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.45520567893981934
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.46276235580444336
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.45988917350769043
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.48415231704711914
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5546133518218994
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.49506068229675293
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.512852668762207
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.45176267623901367
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4840970039367676
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5040504932403564
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4712395668029785
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4143543243408203
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.503669261932373
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 0.5110945701599121
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.4727797508239746
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5132319927215576
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4667208194732666
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4912734031677246
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4840712547302246
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5474400520324707
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.48261570930480957
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5072286128997803
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5058588981628418
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.4378974437713623
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 0.47597813606262207
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5651559829711914
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5363538265228271
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 0.44092321395874023
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 0.45620179176330566
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4757401943206787
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 302156
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6953704357147217
Epoch: 1, Steps: 7 | Train Loss: 2.509 Vali Loss: 2.411 Vali Acc: 0.222 Test Loss: 2.411 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.5167033672332764
Epoch: 2, Steps: 7 | Train Loss: 2.154 Vali Loss: 2.078 Vali Acc: 0.597 Test Loss: 2.078 Test Acc: 0.597
Validation loss decreased (-0.222198 --> -0.597201).  Saving model ...
Epoch: 3 cost time: 0.4336268901824951
Epoch: 3, Steps: 7 | Train Loss: 1.603 Vali Loss: 1.600 Vali Acc: 0.847 Test Loss: 1.600 Test Acc: 0.847
Validation loss decreased (-0.597201 --> -0.847206).  Saving model ...
Epoch: 4 cost time: 0.5006334781646729
Epoch: 4, Steps: 7 | Train Loss: 1.072 Vali Loss: 1.143 Vali Acc: 0.889 Test Loss: 1.143 Test Acc: 0.889
Validation loss decreased (-0.847206 --> -0.888877).  Saving model ...
Epoch: 5 cost time: 0.4506363868713379
Epoch: 5, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.768 Vali Acc: 0.958 Test Loss: 0.768 Test Acc: 0.958
Validation loss decreased (-0.888877 --> -0.958326).  Saving model ...
Epoch: 6 cost time: 0.44385290145874023
Epoch: 6, Steps: 7 | Train Loss: 0.306 Vali Loss: 0.533 Vali Acc: 0.958 Test Loss: 0.533 Test Acc: 0.958
Validation loss decreased (-0.958326 --> -0.958328).  Saving model ...
Epoch: 7 cost time: 0.43922901153564453
Epoch: 7, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.388 Vali Acc: 0.972 Test Loss: 0.388 Test Acc: 0.972
Validation loss decreased (-0.958328 --> -0.972218).  Saving model ...
Epoch: 8 cost time: 0.44812870025634766
Epoch: 8, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.323 Vali Acc: 0.958 Test Loss: 0.323 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44971227645874023
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.290 Vali Acc: 0.972 Test Loss: 0.290 Test Acc: 0.972
Validation loss decreased (-0.972218 --> -0.972219).  Saving model ...
Epoch: 10 cost time: 0.4455289840698242
Epoch: 10, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.272 Vali Acc: 0.972 Test Loss: 0.272 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972220).  Saving model ...
Epoch: 11 cost time: 0.45067405700683594
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.972 Test Loss: 0.256 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 0.45995330810546875
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.972 Test Loss: 0.241 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.4259202480316162
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 0.49292421340942383
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 0.4780902862548828
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.972 Test Loss: 0.221 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 0.4944145679473877
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.47394323348999023
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.48780250549316406
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.4777488708496094
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.49925756454467773
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.483884334564209
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.49282336235046387
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.45035696029663086
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.4746999740600586
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 25 cost time: 0.44699764251708984
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.40519285202026367
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 27 cost time: 0.45595264434814453
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 28 cost time: 0.43799924850463867
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 29 cost time: 0.39829516410827637
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 30 cost time: 0.4987447261810303
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 31 cost time: 0.44822263717651367
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.46428346633911133
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.4107997417449951
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.47101402282714844
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 35 cost time: 0.46332597732543945
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4393885135650635
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 0.47788476943969727
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.42807745933532715
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 0.45237278938293457
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 0.42522239685058594
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 41 cost time: 0.44259166717529297
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 42 cost time: 0.4725983142852783
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.42280006408691406
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.4718503952026367
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.47281813621520996
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.44494080543518066
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 0.4497978687286377
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.47850823402404785
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 49 cost time: 0.46126651763916016
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 50 cost time: 0.4809856414794922
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 244172
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5843095779418945
Epoch: 1, Steps: 7 | Train Loss: 2.555 Vali Loss: 2.413 Vali Acc: 0.097 Test Loss: 2.413 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.4487953186035156
Epoch: 2, Steps: 7 | Train Loss: 2.293 Vali Loss: 2.167 Vali Acc: 0.458 Test Loss: 2.167 Test Acc: 0.458
Validation loss decreased (-0.097198 --> -0.458312).  Saving model ...
Epoch: 3 cost time: 0.4828622341156006
Epoch: 3, Steps: 7 | Train Loss: 1.845 Vali Loss: 1.800 Vali Acc: 0.722 Test Loss: 1.800 Test Acc: 0.722
Validation loss decreased (-0.458312 --> -0.722204).  Saving model ...
Epoch: 4 cost time: 0.4457814693450928
Epoch: 4, Steps: 7 | Train Loss: 1.357 Vali Loss: 1.402 Vali Acc: 0.792 Test Loss: 1.402 Test Acc: 0.792
Validation loss decreased (-0.722204 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 0.46240806579589844
Epoch: 5, Steps: 7 | Train Loss: 0.912 Vali Loss: 1.050 Vali Acc: 0.861 Test Loss: 1.050 Test Acc: 0.861
Validation loss decreased (-0.791653 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 0.41649556159973145
Epoch: 6, Steps: 7 | Train Loss: 0.557 Vali Loss: 0.777 Vali Acc: 0.889 Test Loss: 0.777 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888881).  Saving model ...
Epoch: 7 cost time: 0.47762322425842285
Epoch: 7, Steps: 7 | Train Loss: 0.309 Vali Loss: 0.584 Vali Acc: 0.903 Test Loss: 0.584 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 0.44185948371887207
Epoch: 8, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.468 Vali Acc: 0.917 Test Loss: 0.468 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.5217864513397217
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.398 Vali Acc: 0.917 Test Loss: 0.398 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.46848058700561523
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.4607203006744385
Epoch: 11, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.4831268787384033
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 0.46657586097717285
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.4137084484100342
Epoch: 14, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.45684814453125
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.42354774475097656
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.43511271476745605
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.440488338470459
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.41850852966308594
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.43718528747558594
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.4210166931152344
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.39792323112487793
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.4484138488769531
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.4639012813568115
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.44866394996643066
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.4033181667327881
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.4616398811340332
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.4450414180755615
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.39986157417297363
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.47092461585998535
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.40921998023986816
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.4648768901824951
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.47566723823547363
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.4432711601257324
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.5148599147796631
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.45657777786254883
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.42961764335632324
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.44316983222961426
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.3928980827331543
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.4463331699371338
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.4769275188446045
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.4040060043334961
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.46550440788269043
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.4548344612121582
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.44852137565612793
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.40822649002075195
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.4955592155456543
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.43761253356933594
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.429088830947876
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.43671441078186035
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 213836
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5259406566619873
Epoch: 1, Steps: 7 | Train Loss: 2.493 Vali Loss: 2.404 Vali Acc: 0.125 Test Loss: 2.404 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.4099617004394531
Epoch: 2, Steps: 7 | Train Loss: 2.275 Vali Loss: 2.204 Vali Acc: 0.389 Test Loss: 2.204 Test Acc: 0.389
Validation loss decreased (-0.124976 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 0.43857359886169434
Epoch: 3, Steps: 7 | Train Loss: 1.942 Vali Loss: 1.910 Vali Acc: 0.764 Test Loss: 1.910 Test Acc: 0.764
Validation loss decreased (-0.388867 --> -0.763870).  Saving model ...
Epoch: 4 cost time: 0.41170501708984375
Epoch: 4, Steps: 7 | Train Loss: 1.536 Vali Loss: 1.564 Vali Acc: 0.861 Test Loss: 1.564 Test Acc: 0.861
Validation loss decreased (-0.763870 --> -0.861095).  Saving model ...
Epoch: 5 cost time: 0.4772922992706299
Epoch: 5, Steps: 7 | Train Loss: 1.152 Vali Loss: 1.248 Vali Acc: 0.861 Test Loss: 1.248 Test Acc: 0.861
Validation loss decreased (-0.861095 --> -0.861099).  Saving model ...
Epoch: 6 cost time: 0.45796751976013184
Epoch: 6, Steps: 7 | Train Loss: 0.811 Vali Loss: 0.967 Vali Acc: 0.875 Test Loss: 0.967 Test Acc: 0.875
Validation loss decreased (-0.861099 --> -0.874990).  Saving model ...
Epoch: 7 cost time: 0.4296839237213135
Epoch: 7, Steps: 7 | Train Loss: 0.539 Vali Loss: 0.741 Vali Acc: 0.917 Test Loss: 0.741 Test Acc: 0.917
Validation loss decreased (-0.874990 --> -0.916659).  Saving model ...
Epoch: 8 cost time: 0.4591550827026367
Epoch: 8, Steps: 7 | Train Loss: 0.346 Vali Loss: 0.575 Vali Acc: 0.944 Test Loss: 0.575 Test Acc: 0.944
Validation loss decreased (-0.916659 --> -0.944439).  Saving model ...
Epoch: 9 cost time: 0.43157315254211426
Epoch: 9, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.469 Vali Acc: 0.944 Test Loss: 0.469 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 10 cost time: 0.5098812580108643
Epoch: 10, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.413 Vali Acc: 0.931 Test Loss: 0.413 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4827439785003662
Epoch: 11, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.374 Vali Acc: 0.931 Test Loss: 0.374 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.46660780906677246
Epoch: 12, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.350 Vali Acc: 0.944 Test Loss: 0.350 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.4712679386138916
Epoch: 13, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.43561792373657227
Epoch: 14, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.4557623863220215
Epoch: 15, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.4344749450683594
Epoch: 16, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.4777970314025879
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.43812131881713867
Epoch: 18, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.49372386932373047
Epoch: 19, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.4388425350189209
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.46171998977661133
Epoch: 21, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.424929141998291
Epoch: 22, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.4703335762023926
Epoch: 23, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.44095563888549805
Epoch: 24, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.42908334732055664
Epoch: 25, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4112720489501953
Epoch: 26, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.48103761672973633
Epoch: 27, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4200313091278076
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.37870168685913086
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4940035343170166
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.4341576099395752
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.41882967948913574
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5551447868347168
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.4462413787841797
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4917309284210205
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.44627809524536133
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.44701313972473145
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.4640016555786133
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.4642500877380371
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.4393188953399658
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.4350697994232178
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.4331955909729004
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.3877739906311035
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.5104529857635498
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.392636775970459
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4470980167388916
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.43827056884765625
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5732753276824951
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.49269795417785645
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.4870035648345947
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 190028
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7237823009490967
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.487 Vali Acc: 0.028 Test Loss: 2.487 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.42411184310913086
Epoch: 2, Steps: 7 | Train Loss: 2.406 Vali Loss: 2.357 Vali Acc: 0.139 Test Loss: 2.357 Test Acc: 0.139
Validation loss decreased (-0.027753 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 0.4840562343597412
Epoch: 3, Steps: 7 | Train Loss: 2.159 Vali Loss: 2.146 Vali Acc: 0.444 Test Loss: 2.146 Test Acc: 0.444
Validation loss decreased (-0.138865 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 0.43828701972961426
Epoch: 4, Steps: 7 | Train Loss: 1.853 Vali Loss: 1.882 Vali Acc: 0.625 Test Loss: 1.882 Test Acc: 0.625
Validation loss decreased (-0.444423 --> -0.624981).  Saving model ...
Epoch: 5 cost time: 0.46340274810791016
Epoch: 5, Steps: 7 | Train Loss: 1.548 Vali Loss: 1.605 Vali Acc: 0.722 Test Loss: 1.605 Test Acc: 0.722
Validation loss decreased (-0.624981 --> -0.722206).  Saving model ...
Epoch: 6 cost time: 0.46371912956237793
Epoch: 6, Steps: 7 | Train Loss: 1.199 Vali Loss: 1.345 Vali Acc: 0.778 Test Loss: 1.345 Test Acc: 0.778
Validation loss decreased (-0.722206 --> -0.777764).  Saving model ...
Epoch: 7 cost time: 0.4267117977142334
Epoch: 7, Steps: 7 | Train Loss: 0.917 Vali Loss: 1.105 Vali Acc: 0.875 Test Loss: 1.105 Test Acc: 0.875
Validation loss decreased (-0.777764 --> -0.874989).  Saving model ...
Epoch: 8 cost time: 0.46730875968933105
Epoch: 8, Steps: 7 | Train Loss: 0.673 Vali Loss: 0.905 Vali Acc: 0.875 Test Loss: 0.905 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.4963665008544922
Epoch: 9, Steps: 7 | Train Loss: 0.481 Vali Loss: 0.753 Vali Acc: 0.889 Test Loss: 0.753 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888881).  Saving model ...
Epoch: 10 cost time: 0.45755696296691895
Epoch: 10, Steps: 7 | Train Loss: 0.337 Vali Loss: 0.650 Vali Acc: 0.903 Test Loss: 0.650 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902771).  Saving model ...
Epoch: 11 cost time: 0.46143007278442383
Epoch: 11, Steps: 7 | Train Loss: 0.242 Vali Loss: 0.573 Vali Acc: 0.903 Test Loss: 0.573 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 12 cost time: 0.5369465351104736
Epoch: 12, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.527 Vali Acc: 0.903 Test Loss: 0.527 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.42789459228515625
Epoch: 13, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.494 Vali Acc: 0.903 Test Loss: 0.494 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.46315503120422363
Epoch: 14, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 0.44572973251342773
Epoch: 15, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.435 Vali Acc: 0.903 Test Loss: 0.435 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 0.4092409610748291
Epoch: 16, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.424 Vali Acc: 0.903 Test Loss: 0.424 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.44873952865600586
Epoch: 17, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.410 Vali Acc: 0.903 Test Loss: 0.410 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 0.47730278968811035
Epoch: 18, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.44101691246032715
Epoch: 19, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.49443674087524414
Epoch: 20, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 0.5230178833007812
Epoch: 21, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.5225186347961426
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.44116640090942383
Epoch: 23, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.42425107955932617
Epoch: 24, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.4348781108856201
Epoch: 25, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.44612693786621094
Epoch: 26, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.45693135261535645
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.4510042667388916
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.46740126609802246
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.5634620189666748
Epoch: 30, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.4583568572998047
Epoch: 31, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.44162821769714355
Epoch: 32, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 33 cost time: 0.49837398529052734
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 34 cost time: 0.5045199394226074
Epoch: 34, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 35 cost time: 0.5082449913024902
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 36 cost time: 0.4928743839263916
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.44885802268981934
Epoch: 37, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.4875373840332031
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 39 cost time: 0.5323755741119385
Epoch: 39, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 40 cost time: 0.5046966075897217
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 41 cost time: 0.4759342670440674
Epoch: 41, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.47482776641845703
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.46942639350891113
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.5027837753295898
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.47870707511901855
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 46 cost time: 0.44034361839294434
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 47 cost time: 0.48334407806396484
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.4606359004974365
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.4509258270263672
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.44384074211120605
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 175436
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6034464836120605
Epoch: 1, Steps: 7 | Train Loss: 2.485 Vali Loss: 2.509 Vali Acc: 0.042 Test Loss: 2.509 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 0.4712996482849121
Epoch: 2, Steps: 7 | Train Loss: 2.387 Vali Loss: 2.398 Vali Acc: 0.111 Test Loss: 2.398 Test Acc: 0.111
Validation loss decreased (-0.041642 --> -0.111087).  Saving model ...
Epoch: 3 cost time: 0.4454538822174072
Epoch: 3, Steps: 7 | Train Loss: 2.182 Vali Loss: 2.213 Vali Acc: 0.347 Test Loss: 2.213 Test Acc: 0.347
Validation loss decreased (-0.111087 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.47756266593933105
Epoch: 4, Steps: 7 | Train Loss: 1.901 Vali Loss: 1.984 Vali Acc: 0.542 Test Loss: 1.984 Test Acc: 0.542
Validation loss decreased (-0.347200 --> -0.541647).  Saving model ...
Epoch: 5 cost time: 0.4006810188293457
Epoch: 5, Steps: 7 | Train Loss: 1.603 Vali Loss: 1.743 Vali Acc: 0.681 Test Loss: 1.743 Test Acc: 0.681
Validation loss decreased (-0.541647 --> -0.680538).  Saving model ...
Epoch: 6 cost time: 0.41612815856933594
Epoch: 6, Steps: 7 | Train Loss: 1.324 Vali Loss: 1.510 Vali Acc: 0.722 Test Loss: 1.510 Test Acc: 0.722
Validation loss decreased (-0.680538 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.4877192974090576
Epoch: 7, Steps: 7 | Train Loss: 1.078 Vali Loss: 1.294 Vali Acc: 0.750 Test Loss: 1.294 Test Acc: 0.750
Validation loss decreased (-0.722207 --> -0.749987).  Saving model ...
Epoch: 8 cost time: 0.36756420135498047
Epoch: 8, Steps: 7 | Train Loss: 0.846 Vali Loss: 1.115 Vali Acc: 0.819 Test Loss: 1.115 Test Acc: 0.819
Validation loss decreased (-0.749987 --> -0.819433).  Saving model ...
Epoch: 9 cost time: 0.44988036155700684
Epoch: 9, Steps: 7 | Train Loss: 0.629 Vali Loss: 0.950 Vali Acc: 0.833 Test Loss: 0.950 Test Acc: 0.833
Validation loss decreased (-0.819433 --> -0.833324).  Saving model ...
Epoch: 10 cost time: 0.40418338775634766
Epoch: 10, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.825 Vali Acc: 0.847 Test Loss: 0.825 Test Acc: 0.847
Validation loss decreased (-0.833324 --> -0.847214).  Saving model ...
Epoch: 11 cost time: 0.3686347007751465
Epoch: 11, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.714 Vali Acc: 0.861 Test Loss: 0.714 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861104).  Saving model ...
Epoch: 12 cost time: 0.42731666564941406
Epoch: 12, Steps: 7 | Train Loss: 0.255 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.4182150363922119
Epoch: 13, Steps: 7 | Train Loss: 0.186 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4213573932647705
Epoch: 14, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.445936918258667
Epoch: 15, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.522 Vali Acc: 0.889 Test Loss: 0.522 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888884).  Saving model ...
Epoch: 16 cost time: 0.4270346164703369
Epoch: 16, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 0.4435579776763916
Epoch: 17, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 18 cost time: 0.42490386962890625
Epoch: 18, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.462 Vali Acc: 0.903 Test Loss: 0.462 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 19 cost time: 0.4560987949371338
Epoch: 19, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 20 cost time: 0.4540271759033203
Epoch: 20, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.440 Vali Acc: 0.903 Test Loss: 0.440 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 21 cost time: 0.44046854972839355
Epoch: 21, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4440906047821045
Epoch: 22, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.424 Vali Acc: 0.903 Test Loss: 0.424 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.4392523765563965
Epoch: 23, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.421903133392334
Epoch: 24, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.44773387908935547
Epoch: 25, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.4773061275482178
Epoch: 26, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.4771904945373535
Epoch: 27, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4679269790649414
Epoch: 28, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.4403197765350342
Epoch: 29, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 0.44968128204345703
Epoch: 30, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 31 cost time: 0.4557220935821533
Epoch: 31, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.45980000495910645
Epoch: 32, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 33 cost time: 0.45185279846191406
Epoch: 33, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.45117855072021484
Epoch: 34, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 35 cost time: 0.4580972194671631
Epoch: 35, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 36 cost time: 0.46130919456481934
Epoch: 36, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 37 cost time: 0.4225349426269531
Epoch: 37, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 38 cost time: 0.43039464950561523
Epoch: 38, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.44558215141296387
Epoch: 39, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 40 cost time: 0.4206831455230713
Epoch: 40, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.43675875663757324
Epoch: 41, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.42273569107055664
Epoch: 42, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 43 cost time: 0.4589231014251709
Epoch: 43, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 44 cost time: 0.4389839172363281
Epoch: 44, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 45 cost time: 0.461423397064209
Epoch: 45, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4241650104522705
Epoch: 46, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 47 cost time: 0.3891010284423828
Epoch: 47, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4743611812591553
Epoch: 48, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4177706241607666
Epoch: 49, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.42477965354919434
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.903 Test Loss: 0.325 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 170060
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7250657081604004
Epoch: 1, Steps: 7 | Train Loss: 2.458 Vali Loss: 2.354 Vali Acc: 0.222 Test Loss: 2.354 Test Acc: 0.222
Validation loss decreased (inf --> -0.222199).  Saving model ...
Epoch: 2 cost time: 0.46654248237609863
Epoch: 2, Steps: 7 | Train Loss: 2.051 Vali Loss: 1.982 Vali Acc: 0.569 Test Loss: 1.982 Test Acc: 0.569
Validation loss decreased (-0.222199 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 0.4714951515197754
Epoch: 3, Steps: 7 | Train Loss: 1.346 Vali Loss: 1.453 Vali Acc: 0.819 Test Loss: 1.453 Test Acc: 0.819
Validation loss decreased (-0.569425 --> -0.819430).  Saving model ...
Epoch: 4 cost time: 0.454282283782959
Epoch: 4, Steps: 7 | Train Loss: 0.722 Vali Loss: 0.941 Vali Acc: 0.875 Test Loss: 0.941 Test Acc: 0.875
Validation loss decreased (-0.819430 --> -0.874991).  Saving model ...
Epoch: 5 cost time: 0.4851264953613281
Epoch: 5, Steps: 7 | Train Loss: 0.324 Vali Loss: 0.588 Vali Acc: 0.958 Test Loss: 0.588 Test Acc: 0.958
Validation loss decreased (-0.874991 --> -0.958327).  Saving model ...
Epoch: 6 cost time: 0.5045022964477539
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.397 Vali Acc: 0.958 Test Loss: 0.397 Test Acc: 0.958
Validation loss decreased (-0.958327 --> -0.958329).  Saving model ...
Epoch: 7 cost time: 0.4342617988586426
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.308 Vali Acc: 0.958 Test Loss: 0.308 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958330).  Saving model ...
Epoch: 8 cost time: 0.5267107486724854
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.49236369132995605
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5048623085021973
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4526801109313965
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5416722297668457
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4484100341796875
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.5459475517272949
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.5238683223724365
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.530806303024292
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.4716958999633789
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.45781397819519043
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5080204010009766
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.45812535285949707
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.4665191173553467
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.5546045303344727
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.5289075374603271
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.4927496910095215
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.496518611907959
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.513864278793335
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.46179699897766113
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.46481847763061523
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5074362754821777
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.46866822242736816
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.39139246940612793
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.50844407081604
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.461254358291626
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.4189324378967285
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.40642499923706055
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.47656965255737305
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 37 cost time: 0.43239855766296387
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.40110135078430176
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.3900418281555176
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.40520620346069336
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.3952016830444336
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.4433560371398926
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.42592763900756836
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.3937103748321533
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.3824951648712158
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.4224119186401367
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.39629364013671875
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4185032844543457
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.4839437007904053
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.4446415901184082
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 217708
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.651850938796997
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.418 Vali Acc: 0.167 Test Loss: 2.418 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.43266963958740234
Epoch: 2, Steps: 7 | Train Loss: 2.235 Vali Loss: 2.196 Vali Acc: 0.417 Test Loss: 2.196 Test Acc: 0.417
Validation loss decreased (-0.166642 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.49728870391845703
Epoch: 3, Steps: 7 | Train Loss: 1.823 Vali Loss: 1.837 Vali Acc: 0.653 Test Loss: 1.837 Test Acc: 0.653
Validation loss decreased (-0.416645 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.4633197784423828
Epoch: 4, Steps: 7 | Train Loss: 1.295 Vali Loss: 1.416 Vali Acc: 0.792 Test Loss: 1.416 Test Acc: 0.792
Validation loss decreased (-0.652759 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 0.4754953384399414
Epoch: 5, Steps: 7 | Train Loss: 0.862 Vali Loss: 1.027 Vali Acc: 0.847 Test Loss: 1.027 Test Acc: 0.847
Validation loss decreased (-0.791653 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.47351861000061035
Epoch: 6, Steps: 7 | Train Loss: 0.513 Vali Loss: 0.739 Vali Acc: 0.875 Test Loss: 0.739 Test Acc: 0.875
Validation loss decreased (-0.847212 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.42420411109924316
Epoch: 7, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.46564340591430664
Epoch: 8, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.46387672424316406
Epoch: 9, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.45322489738464355
Epoch: 10, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5439097881317139
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.47215795516967773
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.4930136203765869
Epoch: 13, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.5044164657592773
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.4331493377685547
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.45325136184692383
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5305330753326416
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.43491148948669434
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.4373049736022949
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.4463343620300293
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.4530603885650635
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.4236881732940674
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.4753246307373047
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.45237159729003906
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.4568963050842285
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.5124506950378418
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.48769307136535645
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.4575154781341553
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5104973316192627
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.46328091621398926
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4053936004638672
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5112769603729248
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.4852926731109619
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.501234769821167
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.48130154609680176
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.46474170684814453
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.4383208751678467
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.4783308506011963
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.4164769649505615
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.43898558616638184
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 41 cost time: 0.44777607917785645
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 42 cost time: 0.4820282459259033
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 43 cost time: 0.4571399688720703
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 44 cost time: 0.43747687339782715
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4535071849822998
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5033848285675049
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5059604644775391
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 48 cost time: 0.4231278896331787
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 49 cost time: 0.45799756050109863
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 50 cost time: 0.4702575206756592
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 126508
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7158441543579102
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.446 Vali Acc: 0.111 Test Loss: 2.446 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.4075193405151367
Epoch: 2, Steps: 7 | Train Loss: 2.397 Vali Loss: 2.291 Vali Acc: 0.292 Test Loss: 2.291 Test Acc: 0.292
Validation loss decreased (-0.111087 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 0.4219503402709961
Epoch: 3, Steps: 7 | Train Loss: 2.131 Vali Loss: 2.043 Vali Acc: 0.500 Test Loss: 2.043 Test Acc: 0.500
Validation loss decreased (-0.291644 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 0.4748117923736572
Epoch: 4, Steps: 7 | Train Loss: 1.725 Vali Loss: 1.741 Vali Acc: 0.694 Test Loss: 1.741 Test Acc: 0.694
Validation loss decreased (-0.499980 --> -0.694427).  Saving model ...
Epoch: 5 cost time: 0.5257673263549805
Epoch: 5, Steps: 7 | Train Loss: 1.365 Vali Loss: 1.437 Vali Acc: 0.861 Test Loss: 1.437 Test Acc: 0.861
Validation loss decreased (-0.694427 --> -0.861097).  Saving model ...
Epoch: 6 cost time: 0.4904475212097168
Epoch: 6, Steps: 7 | Train Loss: 1.007 Vali Loss: 1.136 Vali Acc: 0.917 Test Loss: 1.136 Test Acc: 0.917
Validation loss decreased (-0.861097 --> -0.916655).  Saving model ...
Epoch: 7 cost time: 0.4719052314758301
Epoch: 7, Steps: 7 | Train Loss: 0.698 Vali Loss: 0.889 Vali Acc: 0.917 Test Loss: 0.889 Test Acc: 0.917
Validation loss decreased (-0.916655 --> -0.916658).  Saving model ...
Epoch: 8 cost time: 0.47045302391052246
Epoch: 8, Steps: 7 | Train Loss: 0.468 Vali Loss: 0.695 Vali Acc: 0.931 Test Loss: 0.695 Test Acc: 0.931
Validation loss decreased (-0.916658 --> -0.930549).  Saving model ...
Epoch: 9 cost time: 0.48824024200439453
Epoch: 9, Steps: 7 | Train Loss: 0.297 Vali Loss: 0.558 Vali Acc: 0.931 Test Loss: 0.558 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930550).  Saving model ...
Epoch: 10 cost time: 0.44902896881103516
Epoch: 10, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.469 Vali Acc: 0.944 Test Loss: 0.469 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 11 cost time: 0.4851715564727783
Epoch: 11, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.410 Vali Acc: 0.944 Test Loss: 0.410 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 12 cost time: 0.5212085247039795
Epoch: 12, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.373 Vali Acc: 0.944 Test Loss: 0.373 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.47690773010253906
Epoch: 13, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.5062234401702881
Epoch: 14, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.4515228271484375
Epoch: 15, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.44599199295043945
Epoch: 16, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.44425368309020996
Epoch: 17, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5096149444580078
Epoch: 18, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.4962308406829834
Epoch: 19, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.4793839454650879
Epoch: 20, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.47960686683654785
Epoch: 21, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.4745817184448242
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.4245414733886719
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.45507001876831055
Epoch: 24, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4943506717681885
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.517509937286377
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.243 Vali Acc: 0.958 Test Loss: 0.243 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.4158437252044678
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.4766535758972168
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.55495285987854
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.448317289352417
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4653284549713135
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.4618659019470215
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.4114103317260742
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.48797059059143066
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4419400691986084
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.4554266929626465
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.46230459213256836
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.5292229652404785
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.5288422107696533
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.44380807876586914
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.41161656379699707
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.4348762035369873
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.46187925338745117
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.42350172996520996
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.45093631744384766
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.43825387954711914
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.47759127616882324
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.4845395088195801
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.46400952339172363
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.45270466804504395
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 97516
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6785969734191895
Epoch: 1, Steps: 7 | Train Loss: 2.465 Vali Loss: 2.472 Vali Acc: 0.111 Test Loss: 2.472 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.4456925392150879
Epoch: 2, Steps: 7 | Train Loss: 2.341 Vali Loss: 2.326 Vali Acc: 0.208 Test Loss: 2.326 Test Acc: 0.208
Validation loss decreased (-0.111086 --> -0.208310).  Saving model ...
Epoch: 3 cost time: 0.4712345600128174
Epoch: 3, Steps: 7 | Train Loss: 2.111 Vali Loss: 2.104 Vali Acc: 0.361 Test Loss: 2.104 Test Acc: 0.361
Validation loss decreased (-0.208310 --> -0.361090).  Saving model ...
Epoch: 4 cost time: 0.5153489112854004
Epoch: 4, Steps: 7 | Train Loss: 1.815 Vali Loss: 1.834 Vali Acc: 0.694 Test Loss: 1.834 Test Acc: 0.694
Validation loss decreased (-0.361090 --> -0.694426).  Saving model ...
Epoch: 5 cost time: 0.48470640182495117
Epoch: 5, Steps: 7 | Train Loss: 1.473 Vali Loss: 1.548 Vali Acc: 0.792 Test Loss: 1.548 Test Acc: 0.792
Validation loss decreased (-0.694426 --> -0.791651).  Saving model ...
Epoch: 6 cost time: 0.47270822525024414
Epoch: 6, Steps: 7 | Train Loss: 1.158 Vali Loss: 1.270 Vali Acc: 0.847 Test Loss: 1.270 Test Acc: 0.847
Validation loss decreased (-0.791651 --> -0.847210).  Saving model ...
Epoch: 7 cost time: 0.46123337745666504
Epoch: 7, Steps: 7 | Train Loss: 0.855 Vali Loss: 1.026 Vali Acc: 0.889 Test Loss: 1.026 Test Acc: 0.889
Validation loss decreased (-0.847210 --> -0.888879).  Saving model ...
Epoch: 8 cost time: 0.4749627113342285
Epoch: 8, Steps: 7 | Train Loss: 0.616 Vali Loss: 0.833 Vali Acc: 0.931 Test Loss: 0.833 Test Acc: 0.931
Validation loss decreased (-0.888879 --> -0.930547).  Saving model ...
Epoch: 9 cost time: 0.5592477321624756
Epoch: 9, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.685 Vali Acc: 0.917 Test Loss: 0.685 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47904443740844727
Epoch: 10, Steps: 7 | Train Loss: 0.297 Vali Loss: 0.576 Vali Acc: 0.903 Test Loss: 0.576 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.40282154083251953
Epoch: 11, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.502 Vali Acc: 0.917 Test Loss: 0.502 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4565577507019043
Epoch: 12, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.447 Vali Acc: 0.917 Test Loss: 0.447 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4566807746887207
Epoch: 13, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.414 Vali Acc: 0.917 Test Loss: 0.414 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5365395545959473
Epoch: 14, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.383 Vali Acc: 0.917 Test Loss: 0.383 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.46807169914245605
Epoch: 15, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.45591235160827637
Epoch: 16, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.468442440032959
Epoch: 17, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.45137763023376465
Epoch: 18, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 82348
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5539650917053223
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.475 Vali Acc: 0.167 Test Loss: 2.475 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.45543599128723145
Epoch: 2, Steps: 7 | Train Loss: 2.432 Vali Loss: 2.393 Vali Acc: 0.167 Test Loss: 2.393 Test Acc: 0.167
Validation loss decreased (-0.166642 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.43665599822998047
Epoch: 3, Steps: 7 | Train Loss: 2.279 Vali Loss: 2.245 Vali Acc: 0.278 Test Loss: 2.245 Test Acc: 0.278
Validation loss decreased (-0.166643 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 0.4763181209564209
Epoch: 4, Steps: 7 | Train Loss: 2.035 Vali Loss: 2.054 Vali Acc: 0.472 Test Loss: 2.054 Test Acc: 0.472
Validation loss decreased (-0.277755 --> -0.472202).  Saving model ...
Epoch: 5 cost time: 0.45344066619873047
Epoch: 5, Steps: 7 | Train Loss: 1.787 Vali Loss: 1.839 Vali Acc: 0.611 Test Loss: 1.839 Test Acc: 0.611
Validation loss decreased (-0.472202 --> -0.611093).  Saving model ...
Epoch: 6 cost time: 0.46929073333740234
Epoch: 6, Steps: 7 | Train Loss: 1.518 Vali Loss: 1.612 Vali Acc: 0.792 Test Loss: 1.612 Test Acc: 0.792
Validation loss decreased (-0.611093 --> -0.791651).  Saving model ...
Epoch: 7 cost time: 0.45630836486816406
Epoch: 7, Steps: 7 | Train Loss: 1.266 Vali Loss: 1.388 Vali Acc: 0.819 Test Loss: 1.388 Test Acc: 0.819
Validation loss decreased (-0.791651 --> -0.819431).  Saving model ...
Epoch: 8 cost time: 0.4727025032043457
Epoch: 8, Steps: 7 | Train Loss: 1.010 Vali Loss: 1.175 Vali Acc: 0.875 Test Loss: 1.175 Test Acc: 0.875
Validation loss decreased (-0.819431 --> -0.874988).  Saving model ...
Epoch: 9 cost time: 0.4620363712310791
Epoch: 9, Steps: 7 | Train Loss: 0.796 Vali Loss: 0.994 Vali Acc: 0.889 Test Loss: 0.994 Test Acc: 0.889
Validation loss decreased (-0.874988 --> -0.888879).  Saving model ...
Epoch: 10 cost time: 0.4407377243041992
Epoch: 10, Steps: 7 | Train Loss: 0.604 Vali Loss: 0.844 Vali Acc: 0.903 Test Loss: 0.844 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902769).  Saving model ...
Epoch: 11 cost time: 0.4246041774749756
Epoch: 11, Steps: 7 | Train Loss: 0.466 Vali Loss: 0.719 Vali Acc: 0.917 Test Loss: 0.719 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916659).  Saving model ...
Epoch: 12 cost time: 0.46456360816955566
Epoch: 12, Steps: 7 | Train Loss: 0.345 Vali Loss: 0.632 Vali Acc: 0.917 Test Loss: 0.632 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916660).  Saving model ...
Epoch: 13 cost time: 0.44873476028442383
Epoch: 13, Steps: 7 | Train Loss: 0.258 Vali Loss: 0.565 Vali Acc: 0.917 Test Loss: 0.565 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916661).  Saving model ...
Epoch: 14 cost time: 0.4724159240722656
Epoch: 14, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.511 Vali Acc: 0.931 Test Loss: 0.511 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930550).  Saving model ...
Epoch: 15 cost time: 0.4111032485961914
Epoch: 15, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.465 Vali Acc: 0.931 Test Loss: 0.465 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 16 cost time: 0.4610331058502197
Epoch: 16, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.442 Vali Acc: 0.931 Test Loss: 0.442 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 17 cost time: 0.43281078338623047
Epoch: 17, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.418 Vali Acc: 0.944 Test Loss: 0.418 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944440).  Saving model ...
Epoch: 18 cost time: 0.43036627769470215
Epoch: 18, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.399 Vali Acc: 0.931 Test Loss: 0.399 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5347752571105957
Epoch: 19, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.383 Vali Acc: 0.944 Test Loss: 0.383 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.4446699619293213
Epoch: 20, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.368 Vali Acc: 0.944 Test Loss: 0.368 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.501849889755249
Epoch: 21, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 22 cost time: 0.48711133003234863
Epoch: 22, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.37528014183044434
Epoch: 23, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.335 Vali Acc: 0.958 Test Loss: 0.335 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 24 cost time: 0.5347402095794678
Epoch: 24, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.326 Vali Acc: 0.958 Test Loss: 0.326 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 25 cost time: 0.459212064743042
Epoch: 25, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.320 Vali Acc: 0.944 Test Loss: 0.320 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.3894681930541992
Epoch: 26, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4645392894744873
Epoch: 27, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.35105085372924805
Epoch: 28, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3695802688598633
Epoch: 29, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4216136932373047
Epoch: 30, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4330174922943115
Epoch: 31, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.43207597732543945
Epoch: 32, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4337785243988037
Epoch: 33, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.49832868576049805
Epoch: 34, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.42287564277648926
Epoch: 35, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4778108596801758
Epoch: 36, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4275665283203125
Epoch: 37, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4496936798095703
Epoch: 38, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4746205806732178
Epoch: 39, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4662647247314453
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.42823338508605957
Epoch: 41, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.503392219543457
Epoch: 42, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5194337368011475
Epoch: 43, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4531083106994629
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 70444
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7154924869537354
Epoch: 1, Steps: 7 | Train Loss: 2.534 Vali Loss: 2.476 Vali Acc: 0.083 Test Loss: 2.476 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.4242880344390869
Epoch: 2, Steps: 7 | Train Loss: 2.451 Vali Loss: 2.393 Vali Acc: 0.153 Test Loss: 2.393 Test Acc: 0.153
Validation loss decreased (-0.083309 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.40769195556640625
Epoch: 3, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.269 Vali Acc: 0.236 Test Loss: 2.269 Test Acc: 0.236
Validation loss decreased (-0.152754 --> -0.236088).  Saving model ...
Epoch: 4 cost time: 0.4119255542755127
Epoch: 4, Steps: 7 | Train Loss: 2.126 Vali Loss: 2.114 Vali Acc: 0.375 Test Loss: 2.114 Test Acc: 0.375
Validation loss decreased (-0.236088 --> -0.374979).  Saving model ...
Epoch: 5 cost time: 0.424910306930542
Epoch: 5, Steps: 7 | Train Loss: 1.932 Vali Loss: 1.939 Vali Acc: 0.583 Test Loss: 1.939 Test Acc: 0.583
Validation loss decreased (-0.374979 --> -0.583314).  Saving model ...
Epoch: 6 cost time: 0.51548171043396
Epoch: 6, Steps: 7 | Train Loss: 1.723 Vali Loss: 1.762 Vali Acc: 0.667 Test Loss: 1.762 Test Acc: 0.667
Validation loss decreased (-0.583314 --> -0.666649).  Saving model ...
Epoch: 7 cost time: 0.42081499099731445
Epoch: 7, Steps: 7 | Train Loss: 1.515 Vali Loss: 1.589 Vali Acc: 0.708 Test Loss: 1.589 Test Acc: 0.708
Validation loss decreased (-0.666649 --> -0.708317).  Saving model ...
Epoch: 8 cost time: 0.4031991958618164
Epoch: 8, Steps: 7 | Train Loss: 1.301 Vali Loss: 1.417 Vali Acc: 0.722 Test Loss: 1.417 Test Acc: 0.722
Validation loss decreased (-0.708317 --> -0.722208).  Saving model ...
Epoch: 9 cost time: 0.4122889041900635
Epoch: 9, Steps: 7 | Train Loss: 1.109 Vali Loss: 1.259 Vali Acc: 0.764 Test Loss: 1.259 Test Acc: 0.764
Validation loss decreased (-0.722208 --> -0.763876).  Saving model ...
Epoch: 10 cost time: 0.4129056930541992
Epoch: 10, Steps: 7 | Train Loss: 0.912 Vali Loss: 1.111 Vali Acc: 0.792 Test Loss: 1.111 Test Acc: 0.792
Validation loss decreased (-0.763876 --> -0.791656).  Saving model ...
Epoch: 11 cost time: 0.4243025779724121
Epoch: 11, Steps: 7 | Train Loss: 0.745 Vali Loss: 0.981 Vali Acc: 0.819 Test Loss: 0.981 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819435).  Saving model ...
Epoch: 12 cost time: 0.40918421745300293
Epoch: 12, Steps: 7 | Train Loss: 0.602 Vali Loss: 0.867 Vali Acc: 0.847 Test Loss: 0.867 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847214).  Saving model ...
Epoch: 13 cost time: 0.47031545639038086
Epoch: 13, Steps: 7 | Train Loss: 0.481 Vali Loss: 0.773 Vali Acc: 0.861 Test Loss: 0.773 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861103).  Saving model ...
Epoch: 14 cost time: 0.4581878185272217
Epoch: 14, Steps: 7 | Train Loss: 0.389 Vali Loss: 0.707 Vali Acc: 0.847 Test Loss: 0.707 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4354071617126465
Epoch: 15, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.653 Vali Acc: 0.861 Test Loss: 0.653 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861105).  Saving model ...
Epoch: 16 cost time: 0.360703706741333
Epoch: 16, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.606 Vali Acc: 0.889 Test Loss: 0.606 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888883).  Saving model ...
Epoch: 17 cost time: 0.5194408893585205
Epoch: 17, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.568 Vali Acc: 0.903 Test Loss: 0.568 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 18 cost time: 0.4355204105377197
Epoch: 18, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.541 Vali Acc: 0.903 Test Loss: 0.541 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 19 cost time: 0.38916611671447754
Epoch: 19, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.523 Vali Acc: 0.903 Test Loss: 0.523 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 20 cost time: 0.4361882209777832
Epoch: 20, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.505 Vali Acc: 0.917 Test Loss: 0.505 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 0.4007530212402344
Epoch: 21, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.486 Vali Acc: 0.917 Test Loss: 0.486 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 22 cost time: 0.41283297538757324
Epoch: 22, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.469 Vali Acc: 0.917 Test Loss: 0.469 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 23 cost time: 0.4043397903442383
Epoch: 23, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.456 Vali Acc: 0.917 Test Loss: 0.456 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 24 cost time: 0.42391014099121094
Epoch: 24, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4180309772491455
Epoch: 25, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.430 Vali Acc: 0.917 Test Loss: 0.430 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 26 cost time: 0.4031405448913574
Epoch: 26, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.417 Vali Acc: 0.917 Test Loss: 0.417 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 27 cost time: 0.45197534561157227
Epoch: 27, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 0.4183378219604492
Epoch: 28, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.404 Vali Acc: 0.917 Test Loss: 0.404 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 0.4556884765625
Epoch: 29, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 30 cost time: 0.41491055488586426
Epoch: 30, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.392 Vali Acc: 0.917 Test Loss: 0.392 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 31 cost time: 0.3935551643371582
Epoch: 31, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 32 cost time: 0.44660210609436035
Epoch: 32, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 33 cost time: 0.44605326652526855
Epoch: 33, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4050273895263672
Epoch: 34, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.44101595878601074
Epoch: 35, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4371757507324219
Epoch: 36, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5186939239501953
Epoch: 37, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 38 cost time: 0.46155619621276855
Epoch: 38, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 39 cost time: 0.4147214889526367
Epoch: 39, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 40 cost time: 0.4505884647369385
Epoch: 40, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 41 cost time: 0.46720409393310547
Epoch: 41, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4282205104827881
Epoch: 42, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 43 cost time: 0.45175647735595703
Epoch: 43, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4416489601135254
Epoch: 44, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4393603801727295
Epoch: 45, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.45224833488464355
Epoch: 46, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4599118232727051
Epoch: 47, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5192599296569824
Epoch: 48, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.4598395824432373
Epoch: 49, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.42484140396118164
Epoch: 50, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 63148
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6256721019744873
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.500 Vali Acc: 0.056 Test Loss: 2.500 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.4274301528930664
Epoch: 2, Steps: 7 | Train Loss: 2.436 Vali Loss: 2.447 Vali Acc: 0.069 Test Loss: 2.447 Test Acc: 0.069
Validation loss decreased (-0.055531 --> -0.069420).  Saving model ...
Epoch: 3 cost time: 0.4562668800354004
Epoch: 3, Steps: 7 | Train Loss: 2.331 Vali Loss: 2.344 Vali Acc: 0.139 Test Loss: 2.344 Test Acc: 0.139
Validation loss decreased (-0.069420 --> -0.138865).  Saving model ...
Epoch: 4 cost time: 0.4294605255126953
Epoch: 4, Steps: 7 | Train Loss: 2.172 Vali Loss: 2.219 Vali Acc: 0.278 Test Loss: 2.219 Test Acc: 0.278
Validation loss decreased (-0.138865 --> -0.277756).  Saving model ...
Epoch: 5 cost time: 0.4886622428894043
Epoch: 5, Steps: 7 | Train Loss: 2.024 Vali Loss: 2.076 Vali Acc: 0.431 Test Loss: 2.076 Test Acc: 0.431
Validation loss decreased (-0.277756 --> -0.430535).  Saving model ...
Epoch: 6 cost time: 0.5160746574401855
Epoch: 6, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.926 Vali Acc: 0.611 Test Loss: 1.926 Test Acc: 0.611
Validation loss decreased (-0.430535 --> -0.611092).  Saving model ...
Epoch: 7 cost time: 0.4376223087310791
Epoch: 7, Steps: 7 | Train Loss: 1.683 Vali Loss: 1.774 Vali Acc: 0.694 Test Loss: 1.774 Test Acc: 0.694
Validation loss decreased (-0.611092 --> -0.694427).  Saving model ...
Epoch: 8 cost time: 0.46805858612060547
Epoch: 8, Steps: 7 | Train Loss: 1.484 Vali Loss: 1.627 Vali Acc: 0.722 Test Loss: 1.627 Test Acc: 0.722
Validation loss decreased (-0.694427 --> -0.722206).  Saving model ...
Epoch: 9 cost time: 0.45981621742248535
Epoch: 9, Steps: 7 | Train Loss: 1.300 Vali Loss: 1.473 Vali Acc: 0.833 Test Loss: 1.473 Test Acc: 0.833
Validation loss decreased (-0.722206 --> -0.833319).  Saving model ...
Epoch: 10 cost time: 0.46632885932922363
Epoch: 10, Steps: 7 | Train Loss: 1.101 Vali Loss: 1.334 Vali Acc: 0.833 Test Loss: 1.334 Test Acc: 0.833
Validation loss decreased (-0.833319 --> -0.833320).  Saving model ...
Epoch: 11 cost time: 0.48175978660583496
Epoch: 11, Steps: 7 | Train Loss: 0.961 Vali Loss: 1.201 Vali Acc: 0.861 Test Loss: 1.201 Test Acc: 0.861
Validation loss decreased (-0.833320 --> -0.861099).  Saving model ...
Epoch: 12 cost time: 0.5095059871673584
Epoch: 12, Steps: 7 | Train Loss: 0.805 Vali Loss: 1.079 Vali Acc: 0.889 Test Loss: 1.079 Test Acc: 0.889
Validation loss decreased (-0.861099 --> -0.888878).  Saving model ...
Epoch: 13 cost time: 0.4703500270843506
Epoch: 13, Steps: 7 | Train Loss: 0.671 Vali Loss: 0.977 Vali Acc: 0.889 Test Loss: 0.977 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888879).  Saving model ...
Epoch: 14 cost time: 0.4640085697174072
Epoch: 14, Steps: 7 | Train Loss: 0.549 Vali Loss: 0.892 Vali Acc: 0.903 Test Loss: 0.892 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902769).  Saving model ...
Epoch: 15 cost time: 0.4657299518585205
Epoch: 15, Steps: 7 | Train Loss: 0.464 Vali Loss: 0.809 Vali Acc: 0.903 Test Loss: 0.809 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902770).  Saving model ...
Epoch: 16 cost time: 0.4588282108306885
Epoch: 16, Steps: 7 | Train Loss: 0.382 Vali Loss: 0.746 Vali Acc: 0.917 Test Loss: 0.746 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916659).  Saving model ...
Epoch: 17 cost time: 0.4920220375061035
Epoch: 17, Steps: 7 | Train Loss: 0.315 Vali Loss: 0.702 Vali Acc: 0.931 Test Loss: 0.702 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930549).  Saving model ...
Epoch: 18 cost time: 0.5491054058074951
Epoch: 18, Steps: 7 | Train Loss: 0.266 Vali Loss: 0.660 Vali Acc: 0.931 Test Loss: 0.660 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930549).  Saving model ...
Epoch: 19 cost time: 0.4542407989501953
Epoch: 19, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.623 Vali Acc: 0.917 Test Loss: 0.623 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4619479179382324
Epoch: 20, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.593 Vali Acc: 0.917 Test Loss: 0.593 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4411015510559082
Epoch: 21, Steps: 7 | Train Loss: 0.169 Vali Loss: 0.568 Vali Acc: 0.917 Test Loss: 0.568 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5089139938354492
Epoch: 22, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.547 Vali Acc: 0.917 Test Loss: 0.547 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4729647636413574
Epoch: 23, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.527 Vali Acc: 0.917 Test Loss: 0.527 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4570159912109375
Epoch: 24, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.510 Vali Acc: 0.917 Test Loss: 0.510 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.45923805236816406
Epoch: 25, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.500 Vali Acc: 0.917 Test Loss: 0.500 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.45465922355651855
Epoch: 26, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.489 Vali Acc: 0.917 Test Loss: 0.489 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.42919230461120605
Epoch: 27, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.476 Vali Acc: 0.917 Test Loss: 0.476 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.46739912033081055
Epoch: 28, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.461 Vali Acc: 0.917 Test Loss: 0.461 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 60460
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7664918899536133
Epoch: 1, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.471 Vali Acc: 0.083 Test Loss: 2.471 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.5573675632476807
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.349 Vali Acc: 0.500 Test Loss: 2.349 Test Acc: 0.500
Validation loss decreased (-0.083309 --> -0.499977).  Saving model ...
Epoch: 3 cost time: 0.5690059661865234
Epoch: 3, Steps: 7 | Train Loss: 2.020 Vali Loss: 2.126 Vali Acc: 0.667 Test Loss: 2.126 Test Acc: 0.667
Validation loss decreased (-0.499977 --> -0.666645).  Saving model ...
Epoch: 4 cost time: 0.5831654071807861
Epoch: 4, Steps: 7 | Train Loss: 1.633 Vali Loss: 1.774 Vali Acc: 0.736 Test Loss: 1.774 Test Acc: 0.736
Validation loss decreased (-0.666645 --> -0.736093).  Saving model ...
Epoch: 5 cost time: 0.6162199974060059
Epoch: 5, Steps: 7 | Train Loss: 1.162 Vali Loss: 1.307 Vali Acc: 0.875 Test Loss: 1.307 Test Acc: 0.875
Validation loss decreased (-0.736093 --> -0.874987).  Saving model ...
Epoch: 6 cost time: 0.569359302520752
Epoch: 6, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.846 Vali Acc: 0.917 Test Loss: 0.846 Test Acc: 0.917
Validation loss decreased (-0.874987 --> -0.916658).  Saving model ...
Epoch: 7 cost time: 0.5363874435424805
Epoch: 7, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.538 Vali Acc: 0.944 Test Loss: 0.538 Test Acc: 0.944
Validation loss decreased (-0.916658 --> -0.944439).  Saving model ...
Epoch: 8 cost time: 0.6216495037078857
Epoch: 8, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.368 Vali Acc: 0.944 Test Loss: 0.368 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.56076979637146
Epoch: 9, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.293 Vali Acc: 0.958 Test Loss: 0.293 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.563239574432373
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6228017807006836
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.5977888107299805
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.665877103805542
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6563053131103516
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5848028659820557
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6216609477996826
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.6001367568969727
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.972 Test Loss: 0.209 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.6508593559265137
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.972 Test Loss: 0.208 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.644660472869873
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.5806660652160645
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.598660945892334
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.5735085010528564
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.5633738040924072
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.5711052417755127
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 25 cost time: 0.5351366996765137
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.5353488922119141
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5219461917877197
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 28 cost time: 0.5513956546783447
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6246745586395264
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 30 cost time: 0.6033935546875
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 31 cost time: 0.5624961853027344
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.6257724761962891
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.6051430702209473
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.6256661415100098
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 35 cost time: 0.5740389823913574
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.5578770637512207
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 0.5534811019897461
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.5642251968383789
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6055426597595215
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5369441509246826
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5667657852172852
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6549255847930908
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.5437493324279785
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.5465006828308105
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.618943452835083
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.5960137844085693
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 0.5663518905639648
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.5761535167694092
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 0.6078004837036133
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.6177418231964111
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 515820
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7725062370300293
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.462 Vali Acc: 0.153 Test Loss: 2.462 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.4497804641723633
Epoch: 2, Steps: 7 | Train Loss: 2.372 Vali Loss: 2.368 Vali Acc: 0.375 Test Loss: 2.368 Test Acc: 0.375
Validation loss decreased (-0.152753 --> -0.374976).  Saving model ...
Epoch: 3 cost time: 0.44671034812927246
Epoch: 3, Steps: 7 | Train Loss: 2.168 Vali Loss: 2.201 Vali Acc: 0.625 Test Loss: 2.201 Test Acc: 0.625
Validation loss decreased (-0.374976 --> -0.624978).  Saving model ...
Epoch: 4 cost time: 0.5576479434967041
Epoch: 4, Steps: 7 | Train Loss: 1.865 Vali Loss: 1.950 Vali Acc: 0.806 Test Loss: 1.950 Test Acc: 0.806
Validation loss decreased (-0.624978 --> -0.805536).  Saving model ...
Epoch: 5 cost time: 0.4476463794708252
Epoch: 5, Steps: 7 | Train Loss: 1.547 Vali Loss: 1.624 Vali Acc: 0.875 Test Loss: 1.624 Test Acc: 0.875
Validation loss decreased (-0.805536 --> -0.874984).  Saving model ...
Epoch: 6 cost time: 0.47472667694091797
Epoch: 6, Steps: 7 | Train Loss: 1.183 Vali Loss: 1.230 Vali Acc: 0.917 Test Loss: 1.230 Test Acc: 0.917
Validation loss decreased (-0.874984 --> -0.916654).  Saving model ...
Epoch: 7 cost time: 0.4297163486480713
Epoch: 7, Steps: 7 | Train Loss: 0.803 Vali Loss: 0.861 Vali Acc: 0.931 Test Loss: 0.861 Test Acc: 0.931
Validation loss decreased (-0.916654 --> -0.930547).  Saving model ...
Epoch: 8 cost time: 0.5238873958587646
Epoch: 8, Steps: 7 | Train Loss: 0.488 Vali Loss: 0.589 Vali Acc: 0.917 Test Loss: 0.589 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4178953170776367
Epoch: 9, Steps: 7 | Train Loss: 0.261 Vali Loss: 0.414 Vali Acc: 0.931 Test Loss: 0.414 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 0.5011696815490723
Epoch: 10, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5635344982147217
Epoch: 11, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.5500903129577637
Epoch: 12, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5381243228912354
Epoch: 13, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5604829788208008
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6685471534729004
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5723025798797607
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6493823528289795
Epoch: 17, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5859720706939697
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5893449783325195
Epoch: 19, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5705633163452148
Epoch: 20, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5523760318756104
Epoch: 21, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5605366230010986
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5635414123535156
Epoch: 23, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6169967651367188
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5496394634246826
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6019279956817627
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.543257474899292
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5447573661804199
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5503325462341309
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.580162525177002
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5874876976013184
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5795338153839111
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5966939926147461
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.557593584060669
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6278963088989258
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.6571409702301025
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.5590090751647949
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.5684139728546143
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.5769121646881104
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.5251052379608154
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5661506652832031
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5662314891815186
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5671083927154541
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5411839485168457
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5172040462493896
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.541356086730957
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.582359790802002
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5366661548614502
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5746598243713379
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5803995132446289
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 424620
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.762608528137207
Epoch: 1, Steps: 7 | Train Loss: 2.455 Vali Loss: 2.466 Vali Acc: 0.153 Test Loss: 2.466 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.5502293109893799
Epoch: 2, Steps: 7 | Train Loss: 2.390 Vali Loss: 2.399 Vali Acc: 0.319 Test Loss: 2.399 Test Acc: 0.319
Validation loss decreased (-0.152753 --> -0.319420).  Saving model ...
Epoch: 3 cost time: 0.5878148078918457
Epoch: 3, Steps: 7 | Train Loss: 2.240 Vali Loss: 2.284 Vali Acc: 0.514 Test Loss: 2.284 Test Acc: 0.514
Validation loss decreased (-0.319420 --> -0.513866).  Saving model ...
Epoch: 4 cost time: 0.5898160934448242
Epoch: 4, Steps: 7 | Train Loss: 2.032 Vali Loss: 2.111 Vali Acc: 0.708 Test Loss: 2.111 Test Acc: 0.708
Validation loss decreased (-0.513866 --> -0.708312).  Saving model ...
Epoch: 5 cost time: 0.5581550598144531
Epoch: 5, Steps: 7 | Train Loss: 1.796 Vali Loss: 1.882 Vali Acc: 0.778 Test Loss: 1.882 Test Acc: 0.778
Validation loss decreased (-0.708312 --> -0.777759).  Saving model ...
Epoch: 6 cost time: 0.5570127964019775
Epoch: 6, Steps: 7 | Train Loss: 1.535 Vali Loss: 1.616 Vali Acc: 0.833 Test Loss: 1.616 Test Acc: 0.833
Validation loss decreased (-0.777759 --> -0.833317).  Saving model ...
Epoch: 7 cost time: 0.5715968608856201
Epoch: 7, Steps: 7 | Train Loss: 1.234 Vali Loss: 1.315 Vali Acc: 0.833 Test Loss: 1.315 Test Acc: 0.833
Validation loss decreased (-0.833317 --> -0.833320).  Saving model ...
Epoch: 8 cost time: 0.578265905380249
Epoch: 8, Steps: 7 | Train Loss: 0.910 Vali Loss: 1.005 Vali Acc: 0.875 Test Loss: 1.005 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.5286571979522705
Epoch: 9, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.734 Vali Acc: 0.931 Test Loss: 0.734 Test Acc: 0.931
Validation loss decreased (-0.874990 --> -0.930548).  Saving model ...
Epoch: 10 cost time: 0.5841436386108398
Epoch: 10, Steps: 7 | Train Loss: 0.373 Vali Loss: 0.560 Vali Acc: 0.889 Test Loss: 0.560 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.527806282043457
Epoch: 11, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.410 Vali Acc: 0.931 Test Loss: 0.410 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930551).  Saving model ...
Epoch: 12 cost time: 0.623525857925415
Epoch: 12, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.349 Vali Acc: 0.931 Test Loss: 0.349 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.6783111095428467
Epoch: 13, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.5061349868774414
Epoch: 14, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5960009098052979
Epoch: 15, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5515542030334473
Epoch: 16, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.532097339630127
Epoch: 17, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5328097343444824
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5643825531005859
Epoch: 19, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.5696275234222412
Epoch: 20, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.5847632884979248
Epoch: 21, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.556006669998169
Epoch: 22, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.5506858825683594
Epoch: 23, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.602078914642334
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5824286937713623
Epoch: 25, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6059818267822266
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.5617034435272217
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.5090417861938477
Epoch: 28, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5426695346832275
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6007676124572754
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5130138397216797
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5347738265991211
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5747740268707275
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.5937964916229248
Epoch: 34, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4972531795501709
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5845060348510742
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6236088275909424
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5058517456054688
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.519162654876709
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5171456336975098
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.51528000831604
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5613479614257812
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.558495283126831
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 397932
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.671982765197754
Epoch: 1, Steps: 7 | Train Loss: 2.538 Vali Loss: 2.495 Vali Acc: 0.083 Test Loss: 2.495 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.5686221122741699
Epoch: 2, Steps: 7 | Train Loss: 2.443 Vali Loss: 2.440 Vali Acc: 0.153 Test Loss: 2.440 Test Acc: 0.153
Validation loss decreased (-0.083308 --> -0.152753).  Saving model ...
Epoch: 3 cost time: 0.5806865692138672
Epoch: 3, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.334 Vali Acc: 0.431 Test Loss: 2.334 Test Acc: 0.431
Validation loss decreased (-0.152753 --> -0.430532).  Saving model ...
Epoch: 4 cost time: 0.5942955017089844
Epoch: 4, Steps: 7 | Train Loss: 2.149 Vali Loss: 2.192 Vali Acc: 0.611 Test Loss: 2.192 Test Acc: 0.611
Validation loss decreased (-0.430532 --> -0.611089).  Saving model ...
Epoch: 5 cost time: 0.538780689239502
Epoch: 5, Steps: 7 | Train Loss: 1.972 Vali Loss: 2.015 Vali Acc: 0.722 Test Loss: 2.015 Test Acc: 0.722
Validation loss decreased (-0.611089 --> -0.722202).  Saving model ...
Epoch: 6 cost time: 0.5321907997131348
Epoch: 6, Steps: 7 | Train Loss: 1.738 Vali Loss: 1.789 Vali Acc: 0.764 Test Loss: 1.789 Test Acc: 0.764
Validation loss decreased (-0.722202 --> -0.763871).  Saving model ...
Epoch: 7 cost time: 0.5303905010223389
Epoch: 7, Steps: 7 | Train Loss: 1.467 Vali Loss: 1.532 Vali Acc: 0.806 Test Loss: 1.532 Test Acc: 0.806
Validation loss decreased (-0.763871 --> -0.805540).  Saving model ...
Epoch: 8 cost time: 0.5882186889648438
Epoch: 8, Steps: 7 | Train Loss: 1.175 Vali Loss: 1.259 Vali Acc: 0.861 Test Loss: 1.259 Test Acc: 0.861
Validation loss decreased (-0.805540 --> -0.861099).  Saving model ...
Epoch: 9 cost time: 0.5659792423248291
Epoch: 9, Steps: 7 | Train Loss: 0.893 Vali Loss: 0.985 Vali Acc: 0.889 Test Loss: 0.985 Test Acc: 0.889
Validation loss decreased (-0.861099 --> -0.888879).  Saving model ...
Epoch: 10 cost time: 0.5700681209564209
Epoch: 10, Steps: 7 | Train Loss: 0.623 Vali Loss: 0.760 Vali Acc: 0.833 Test Loss: 0.760 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6016278266906738
Epoch: 11, Steps: 7 | Train Loss: 0.407 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5405209064483643
Epoch: 12, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.584308385848999
Epoch: 13, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5530173778533936
Epoch: 14, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.5420334339141846
Epoch: 15, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5242693424224854
Epoch: 16, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5470399856567383
Epoch: 17, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5281355381011963
Epoch: 18, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.5543780326843262
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.5053548812866211
Epoch: 20, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.5297291278839111
Epoch: 21, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.5635709762573242
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5638461112976074
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.571732759475708
Epoch: 24, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5471811294555664
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.593766450881958
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.5768656730651855
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.569861888885498
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5434191226959229
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.6357054710388184
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6058464050292969
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.5405900478363037
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.596177339553833
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.5549066066741943
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.5625319480895996
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6136767864227295
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.4897427558898926
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.5801239013671875
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.5116097927093506
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5893497467041016
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.5406525135040283
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.523129940032959
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.5328981876373291
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.5859739780426025
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.5606060028076172
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.5872282981872559
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.5634901523590088
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.6096861362457275
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.5266294479370117
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.5320875644683838
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 380460
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6767983436584473
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.479 Vali Acc: 0.111 Test Loss: 2.479 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5515244007110596
Epoch: 2, Steps: 7 | Train Loss: 2.465 Vali Loss: 2.428 Vali Acc: 0.181 Test Loss: 2.428 Test Acc: 0.181
Validation loss decreased (-0.111086 --> -0.180531).  Saving model ...
Epoch: 3 cost time: 0.5581357479095459
Epoch: 3, Steps: 7 | Train Loss: 2.349 Vali Loss: 2.338 Vali Acc: 0.347 Test Loss: 2.338 Test Acc: 0.347
Validation loss decreased (-0.180531 --> -0.347199).  Saving model ...
Epoch: 4 cost time: 0.5371649265289307
Epoch: 4, Steps: 7 | Train Loss: 2.213 Vali Loss: 2.207 Vali Acc: 0.514 Test Loss: 2.207 Test Acc: 0.514
Validation loss decreased (-0.347199 --> -0.513867).  Saving model ...
Epoch: 5 cost time: 0.6105444431304932
Epoch: 5, Steps: 7 | Train Loss: 2.061 Vali Loss: 2.053 Vali Acc: 0.708 Test Loss: 2.053 Test Acc: 0.708
Validation loss decreased (-0.513867 --> -0.708313).  Saving model ...
Epoch: 6 cost time: 0.5017764568328857
Epoch: 6, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.869 Vali Acc: 0.819 Test Loss: 1.869 Test Acc: 0.819
Validation loss decreased (-0.708313 --> -0.819426).  Saving model ...
Epoch: 7 cost time: 0.5504610538482666
Epoch: 7, Steps: 7 | Train Loss: 1.641 Vali Loss: 1.656 Vali Acc: 0.861 Test Loss: 1.656 Test Acc: 0.861
Validation loss decreased (-0.819426 --> -0.861095).  Saving model ...
Epoch: 8 cost time: 0.5731041431427002
Epoch: 8, Steps: 7 | Train Loss: 1.413 Vali Loss: 1.420 Vali Acc: 0.875 Test Loss: 1.420 Test Acc: 0.875
Validation loss decreased (-0.861095 --> -0.874986).  Saving model ...
Epoch: 9 cost time: 0.5409286022186279
Epoch: 9, Steps: 7 | Train Loss: 1.131 Vali Loss: 1.178 Vali Acc: 0.889 Test Loss: 1.178 Test Acc: 0.889
Validation loss decreased (-0.874986 --> -0.888877).  Saving model ...
Epoch: 10 cost time: 0.5671160221099854
Epoch: 10, Steps: 7 | Train Loss: 0.880 Vali Loss: 0.948 Vali Acc: 0.903 Test Loss: 0.948 Test Acc: 0.903
Validation loss decreased (-0.888877 --> -0.902768).  Saving model ...
Epoch: 11 cost time: 0.5419847965240479
Epoch: 11, Steps: 7 | Train Loss: 0.639 Vali Loss: 0.754 Vali Acc: 0.917 Test Loss: 0.754 Test Acc: 0.917
Validation loss decreased (-0.902768 --> -0.916659).  Saving model ...
Epoch: 12 cost time: 0.5272388458251953
Epoch: 12, Steps: 7 | Train Loss: 0.456 Vali Loss: 0.588 Vali Acc: 0.931 Test Loss: 0.588 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930550).  Saving model ...
Epoch: 13 cost time: 0.5360276699066162
Epoch: 13, Steps: 7 | Train Loss: 0.304 Vali Loss: 0.480 Vali Acc: 0.944 Test Loss: 0.480 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.5842115879058838
Epoch: 14, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.409 Vali Acc: 0.958 Test Loss: 0.409 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958329).  Saving model ...
Epoch: 15 cost time: 0.5866327285766602
Epoch: 15, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.541513204574585
Epoch: 16, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.328 Vali Acc: 0.958 Test Loss: 0.328 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958330).  Saving model ...
Epoch: 17 cost time: 0.5158052444458008
Epoch: 17, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5623130798339844
Epoch: 18, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5857350826263428
Epoch: 19, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5462803840637207
Epoch: 20, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5532212257385254
Epoch: 21, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5679972171783447
Epoch: 22, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.560640811920166
Epoch: 23, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5758495330810547
Epoch: 24, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6202230453491211
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6415877342224121
Epoch: 26, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 373164
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.837310791015625
Epoch: 1, Steps: 7 | Train Loss: 2.487 Vali Loss: 2.483 Vali Acc: 0.083 Test Loss: 2.483 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.5367913246154785
Epoch: 2, Steps: 7 | Train Loss: 2.448 Vali Loss: 2.436 Vali Acc: 0.153 Test Loss: 2.436 Test Acc: 0.153
Validation loss decreased (-0.083309 --> -0.152753).  Saving model ...
Epoch: 3 cost time: 0.4848926067352295
Epoch: 3, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.355 Vali Acc: 0.292 Test Loss: 2.355 Test Acc: 0.292
Validation loss decreased (-0.152753 --> -0.291643).  Saving model ...
Epoch: 4 cost time: 0.5180339813232422
Epoch: 4, Steps: 7 | Train Loss: 2.210 Vali Loss: 2.241 Vali Acc: 0.542 Test Loss: 2.241 Test Acc: 0.542
Validation loss decreased (-0.291643 --> -0.541644).  Saving model ...
Epoch: 5 cost time: 0.5061781406402588
Epoch: 5, Steps: 7 | Train Loss: 2.072 Vali Loss: 2.097 Vali Acc: 0.653 Test Loss: 2.097 Test Acc: 0.653
Validation loss decreased (-0.541644 --> -0.652757).  Saving model ...
Epoch: 6 cost time: 0.4886362552642822
Epoch: 6, Steps: 7 | Train Loss: 1.901 Vali Loss: 1.926 Vali Acc: 0.792 Test Loss: 1.926 Test Acc: 0.792
Validation loss decreased (-0.652757 --> -0.791647).  Saving model ...
Epoch: 7 cost time: 0.5012390613555908
Epoch: 7, Steps: 7 | Train Loss: 1.703 Vali Loss: 1.739 Vali Acc: 0.833 Test Loss: 1.739 Test Acc: 0.833
Validation loss decreased (-0.791647 --> -0.833316).  Saving model ...
Epoch: 8 cost time: 0.5278990268707275
Epoch: 8, Steps: 7 | Train Loss: 1.513 Vali Loss: 1.522 Vali Acc: 0.861 Test Loss: 1.522 Test Acc: 0.861
Validation loss decreased (-0.833316 --> -0.861096).  Saving model ...
Epoch: 9 cost time: 0.5463473796844482
Epoch: 9, Steps: 7 | Train Loss: 1.283 Vali Loss: 1.314 Vali Acc: 0.847 Test Loss: 1.314 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5064265727996826
Epoch: 10, Steps: 7 | Train Loss: 1.043 Vali Loss: 1.087 Vali Acc: 0.903 Test Loss: 1.087 Test Acc: 0.903
Validation loss decreased (-0.861096 --> -0.902767).  Saving model ...
Epoch: 11 cost time: 0.5408599376678467
Epoch: 11, Steps: 7 | Train Loss: 0.819 Vali Loss: 0.886 Vali Acc: 0.931 Test Loss: 0.886 Test Acc: 0.931
Validation loss decreased (-0.902767 --> -0.930547).  Saving model ...
Epoch: 12 cost time: 0.49772000312805176
Epoch: 12, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.715 Vali Acc: 0.931 Test Loss: 0.715 Test Acc: 0.931
Validation loss decreased (-0.930547 --> -0.930548).  Saving model ...
Epoch: 13 cost time: 0.5312161445617676
Epoch: 13, Steps: 7 | Train Loss: 0.444 Vali Loss: 0.586 Vali Acc: 0.944 Test Loss: 0.586 Test Acc: 0.944
Validation loss decreased (-0.930548 --> -0.944439).  Saving model ...
Epoch: 14 cost time: 0.513268232345581
Epoch: 14, Steps: 7 | Train Loss: 0.328 Vali Loss: 0.491 Vali Acc: 0.944 Test Loss: 0.491 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 15 cost time: 0.5598845481872559
Epoch: 15, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.431 Vali Acc: 0.944 Test Loss: 0.431 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 16 cost time: 0.5169639587402344
Epoch: 16, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.393 Vali Acc: 0.944 Test Loss: 0.393 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.5173566341400146
Epoch: 17, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.45973730087280273
Epoch: 18, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.332 Vali Acc: 0.944 Test Loss: 0.332 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.4887382984161377
Epoch: 19, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.317 Vali Acc: 0.958 Test Loss: 0.317 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 20 cost time: 0.4630589485168457
Epoch: 20, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.302 Vali Acc: 0.958 Test Loss: 0.302 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 21 cost time: 0.46385955810546875
Epoch: 21, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.285 Vali Acc: 0.958 Test Loss: 0.285 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 22 cost time: 0.5233855247497559
Epoch: 22, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.4962131977081299
Epoch: 23, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.260 Vali Acc: 0.958 Test Loss: 0.260 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.4559965133666992
Epoch: 24, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.7028987407684326
Epoch: 25, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.46787238121032715
Epoch: 26, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.5115475654602051
Epoch: 27, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.5256192684173584
Epoch: 28, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5171911716461182
Epoch: 29, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.49993467330932617
Epoch: 30, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.4600493907928467
Epoch: 31, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.972 Test Loss: 0.216 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.5100209712982178
Epoch: 32, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.49922871589660645
Epoch: 33, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5429656505584717
Epoch: 34, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.49561500549316406
Epoch: 35, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5213775634765625
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4929990768432617
Epoch: 37, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.4818458557128906
Epoch: 38, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 0.49565720558166504
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 0.5289022922515869
Epoch: 40, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5145506858825684
Epoch: 41, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5170137882232666
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5156471729278564
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.492717981338501
Epoch: 44, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5021836757659912
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4990701675415039
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4995243549346924
Epoch: 47, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.525099515914917
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5307497978210449
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.5524530410766602
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 365868
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.639577865600586
Epoch: 1, Steps: 7 | Train Loss: 2.499 Vali Loss: 2.445 Vali Acc: 0.097 Test Loss: 2.445 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.49463582038879395
Epoch: 2, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.403 Vali Acc: 0.125 Test Loss: 2.403 Test Acc: 0.125
Validation loss decreased (-0.097198 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.4939548969268799
Epoch: 3, Steps: 7 | Train Loss: 2.361 Vali Loss: 2.334 Vali Acc: 0.264 Test Loss: 2.334 Test Acc: 0.264
Validation loss decreased (-0.124976 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 0.46405982971191406
Epoch: 4, Steps: 7 | Train Loss: 2.232 Vali Loss: 2.239 Vali Acc: 0.431 Test Loss: 2.239 Test Acc: 0.431
Validation loss decreased (-0.263866 --> -0.430533).  Saving model ...
Epoch: 5 cost time: 0.5191988945007324
Epoch: 5, Steps: 7 | Train Loss: 2.113 Vali Loss: 2.128 Vali Acc: 0.528 Test Loss: 2.128 Test Acc: 0.528
Validation loss decreased (-0.430533 --> -0.527756).  Saving model ...
Epoch: 6 cost time: 0.49992871284484863
Epoch: 6, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.997 Vali Acc: 0.597 Test Loss: 1.997 Test Acc: 0.597
Validation loss decreased (-0.527756 --> -0.597202).  Saving model ...
Epoch: 7 cost time: 0.5403735637664795
Epoch: 7, Steps: 7 | Train Loss: 1.826 Vali Loss: 1.859 Vali Acc: 0.667 Test Loss: 1.859 Test Acc: 0.667
Validation loss decreased (-0.597202 --> -0.666648).  Saving model ...
Epoch: 8 cost time: 0.499666690826416
Epoch: 8, Steps: 7 | Train Loss: 1.656 Vali Loss: 1.698 Vali Acc: 0.708 Test Loss: 1.698 Test Acc: 0.708
Validation loss decreased (-0.666648 --> -0.708316).  Saving model ...
Epoch: 9 cost time: 0.5150179862976074
Epoch: 9, Steps: 7 | Train Loss: 1.478 Vali Loss: 1.529 Vali Acc: 0.764 Test Loss: 1.529 Test Acc: 0.764
Validation loss decreased (-0.708316 --> -0.763874).  Saving model ...
Epoch: 10 cost time: 0.5303869247436523
Epoch: 10, Steps: 7 | Train Loss: 1.282 Vali Loss: 1.342 Vali Acc: 0.806 Test Loss: 1.342 Test Acc: 0.806
Validation loss decreased (-0.763874 --> -0.805542).  Saving model ...
Epoch: 11 cost time: 0.538994550704956
Epoch: 11, Steps: 7 | Train Loss: 1.080 Vali Loss: 1.171 Vali Acc: 0.819 Test Loss: 1.171 Test Acc: 0.819
Validation loss decreased (-0.805542 --> -0.819433).  Saving model ...
Epoch: 12 cost time: 0.5505490303039551
Epoch: 12, Steps: 7 | Train Loss: 0.884 Vali Loss: 1.008 Vali Acc: 0.875 Test Loss: 1.008 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874990).  Saving model ...
Epoch: 13 cost time: 0.5740339756011963
Epoch: 13, Steps: 7 | Train Loss: 0.709 Vali Loss: 0.862 Vali Acc: 0.903 Test Loss: 0.862 Test Acc: 0.903
Validation loss decreased (-0.874990 --> -0.902769).  Saving model ...
Epoch: 14 cost time: 0.6451339721679688
Epoch: 14, Steps: 7 | Train Loss: 0.560 Vali Loss: 0.746 Vali Acc: 0.903 Test Loss: 0.746 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902770).  Saving model ...
Epoch: 15 cost time: 0.519956111907959
Epoch: 15, Steps: 7 | Train Loss: 0.429 Vali Loss: 0.659 Vali Acc: 0.889 Test Loss: 0.659 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5330438613891602
Epoch: 16, Steps: 7 | Train Loss: 0.338 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5263895988464355
Epoch: 17, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5533947944641113
Epoch: 18, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5095479488372803
Epoch: 19, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.49408984184265137
Epoch: 20, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.437 Vali Acc: 0.917 Test Loss: 0.437 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916662).  Saving model ...
Epoch: 21 cost time: 0.5468149185180664
Epoch: 21, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5488619804382324
Epoch: 22, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5079905986785889
Epoch: 23, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6132311820983887
Epoch: 24, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5298287868499756
Epoch: 25, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.361 Vali Acc: 0.917 Test Loss: 0.361 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.5447483062744141
Epoch: 26, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5954325199127197
Epoch: 27, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6558516025543213
Epoch: 28, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.539095401763916
Epoch: 29, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6359560489654541
Epoch: 30, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5487117767333984
Epoch: 31, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5507299900054932
Epoch: 32, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.540330171585083
Epoch: 33, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5326111316680908
Epoch: 34, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.593966007232666
Epoch: 35, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 358572
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7705390453338623
Epoch: 1, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.478 Vali Acc: 0.097 Test Loss: 2.478 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5335338115692139
Epoch: 2, Steps: 7 | Train Loss: 2.305 Vali Loss: 2.368 Vali Acc: 0.347 Test Loss: 2.368 Test Acc: 0.347
Validation loss decreased (-0.097197 --> -0.347199).  Saving model ...
Epoch: 3 cost time: 0.5403585433959961
Epoch: 3, Steps: 7 | Train Loss: 2.012 Vali Loss: 2.150 Vali Acc: 0.750 Test Loss: 2.150 Test Acc: 0.750
Validation loss decreased (-0.347199 --> -0.749979).  Saving model ...
Epoch: 4 cost time: 0.5489349365234375
Epoch: 4, Steps: 7 | Train Loss: 1.618 Vali Loss: 1.784 Vali Acc: 0.861 Test Loss: 1.784 Test Acc: 0.861
Validation loss decreased (-0.749979 --> -0.861093).  Saving model ...
Epoch: 5 cost time: 0.5039558410644531
Epoch: 5, Steps: 7 | Train Loss: 1.154 Vali Loss: 1.312 Vali Acc: 0.806 Test Loss: 1.312 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5622439384460449
Epoch: 6, Steps: 7 | Train Loss: 0.695 Vali Loss: 0.871 Vali Acc: 0.917 Test Loss: 0.871 Test Acc: 0.917
Validation loss decreased (-0.861093 --> -0.916658).  Saving model ...
Epoch: 7 cost time: 0.6341521739959717
Epoch: 7, Steps: 7 | Train Loss: 0.347 Vali Loss: 0.526 Vali Acc: 0.972 Test Loss: 0.526 Test Acc: 0.972
Validation loss decreased (-0.916658 --> -0.972217).  Saving model ...
Epoch: 8 cost time: 0.5659337043762207
Epoch: 8, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.374 Vali Acc: 0.944 Test Loss: 0.374 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5305676460266113
Epoch: 9, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.312 Vali Acc: 0.958 Test Loss: 0.312 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6053624153137207
Epoch: 10, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.272 Vali Acc: 0.958 Test Loss: 0.272 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5492734909057617
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
Validation loss decreased (-0.972217 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 0.5520155429840088
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.972 Test Loss: 0.233 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.5938510894775391
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 0.552004337310791
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 0.5262560844421387
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.972 Test Loss: 0.216 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 0.5383777618408203
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.5755057334899902
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.5709114074707031
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.972 Test Loss: 0.209 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.5989501476287842
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.972 Test Loss: 0.208 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.5526020526885986
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.5644989013671875
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.5567722320556641
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.5233025550842285
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 24 cost time: 0.5447142124176025
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 25 cost time: 0.5081720352172852
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.49248600006103516
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 27 cost time: 0.5174503326416016
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 28 cost time: 0.4950120449066162
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 29 cost time: 0.4880561828613281
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 30 cost time: 0.5246412754058838
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 31 cost time: 0.5450749397277832
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.5565142631530762
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.5557372570037842
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.5093798637390137
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 35 cost time: 0.5356156826019287
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.5830564498901367
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 0.5884444713592529
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.5534398555755615
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 0.5113239288330078
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 0.5555036067962646
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 41 cost time: 0.5336852073669434
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 42 cost time: 0.5319981575012207
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.5461089611053467
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.5434935092926025
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.5620143413543701
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.554485559463501
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 0.5300297737121582
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.5427441596984863
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 0.5129048824310303
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.6057772636413574
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 510444
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8391797542572021
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.464 Vali Acc: 0.097 Test Loss: 2.464 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6102025508880615
Epoch: 2, Steps: 7 | Train Loss: 2.385 Vali Loss: 2.374 Vali Acc: 0.347 Test Loss: 2.374 Test Acc: 0.347
Validation loss decreased (-0.097198 --> -0.347198).  Saving model ...
Epoch: 3 cost time: 0.5548546314239502
Epoch: 3, Steps: 7 | Train Loss: 2.156 Vali Loss: 2.193 Vali Acc: 0.653 Test Loss: 2.193 Test Acc: 0.653
Validation loss decreased (-0.347198 --> -0.652756).  Saving model ...
Epoch: 4 cost time: 0.5228629112243652
Epoch: 4, Steps: 7 | Train Loss: 1.882 Vali Loss: 1.916 Vali Acc: 0.792 Test Loss: 1.916 Test Acc: 0.792
Validation loss decreased (-0.652756 --> -0.791648).  Saving model ...
Epoch: 5 cost time: 0.5523083209991455
Epoch: 5, Steps: 7 | Train Loss: 1.514 Vali Loss: 1.562 Vali Acc: 0.875 Test Loss: 1.562 Test Acc: 0.875
Validation loss decreased (-0.791648 --> -0.874984).  Saving model ...
Epoch: 6 cost time: 0.5982785224914551
Epoch: 6, Steps: 7 | Train Loss: 1.131 Vali Loss: 1.179 Vali Acc: 0.861 Test Loss: 1.179 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5604195594787598
Epoch: 7, Steps: 7 | Train Loss: 0.758 Vali Loss: 0.827 Vali Acc: 0.903 Test Loss: 0.827 Test Acc: 0.903
Validation loss decreased (-0.874984 --> -0.902770).  Saving model ...
Epoch: 8 cost time: 0.5746252536773682
Epoch: 8, Steps: 7 | Train Loss: 0.441 Vali Loss: 0.553 Vali Acc: 0.917 Test Loss: 0.553 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916661).  Saving model ...
Epoch: 9 cost time: 0.5137317180633545
Epoch: 9, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.378 Vali Acc: 0.944 Test Loss: 0.378 Test Acc: 0.944
Validation loss decreased (-0.916661 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 0.5421562194824219
Epoch: 10, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5583634376525879
Epoch: 11, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6975817680358887
Epoch: 12, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5594360828399658
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5168972015380859
Epoch: 14, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5916750431060791
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5254745483398438
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5245912075042725
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5549395084381104
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.49173998832702637
Epoch: 19, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 419244
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5976135730743408
Epoch: 1, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.472 Vali Acc: 0.056 Test Loss: 2.472 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.5384132862091064
Epoch: 2, Steps: 7 | Train Loss: 2.407 Vali Loss: 2.403 Vali Acc: 0.264 Test Loss: 2.403 Test Acc: 0.264
Validation loss decreased (-0.055531 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 0.509058952331543
Epoch: 3, Steps: 7 | Train Loss: 2.246 Vali Loss: 2.277 Vali Acc: 0.542 Test Loss: 2.277 Test Acc: 0.542
Validation loss decreased (-0.263865 --> -0.541644).  Saving model ...
Epoch: 4 cost time: 0.462982177734375
Epoch: 4, Steps: 7 | Train Loss: 2.060 Vali Loss: 2.105 Vali Acc: 0.722 Test Loss: 2.105 Test Acc: 0.722
Validation loss decreased (-0.541644 --> -0.722201).  Saving model ...
Epoch: 5 cost time: 0.4804530143737793
Epoch: 5, Steps: 7 | Train Loss: 1.814 Vali Loss: 1.883 Vali Acc: 0.819 Test Loss: 1.883 Test Acc: 0.819
Validation loss decreased (-0.722201 --> -0.819426).  Saving model ...
Epoch: 6 cost time: 0.5711209774017334
Epoch: 6, Steps: 7 | Train Loss: 1.551 Vali Loss: 1.612 Vali Acc: 0.847 Test Loss: 1.612 Test Acc: 0.847
Validation loss decreased (-0.819426 --> -0.847206).  Saving model ...
Epoch: 7 cost time: 0.6031949520111084
Epoch: 7, Steps: 7 | Train Loss: 1.229 Vali Loss: 1.299 Vali Acc: 0.861 Test Loss: 1.299 Test Acc: 0.861
Validation loss decreased (-0.847206 --> -0.861098).  Saving model ...
Epoch: 8 cost time: 0.49977588653564453
Epoch: 8, Steps: 7 | Train Loss: 0.911 Vali Loss: 0.977 Vali Acc: 0.875 Test Loss: 0.977 Test Acc: 0.875
Validation loss decreased (-0.861098 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.49147653579711914
Epoch: 9, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.722 Vali Acc: 0.889 Test Loss: 0.722 Test Acc: 0.889
Validation loss decreased (-0.874990 --> -0.888882).  Saving model ...
Epoch: 10 cost time: 0.5307672023773193
Epoch: 10, Steps: 7 | Train Loss: 0.360 Vali Loss: 0.527 Vali Acc: 0.917 Test Loss: 0.527 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916661).  Saving model ...
Epoch: 11 cost time: 0.5222320556640625
Epoch: 11, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 0.5260260105133057
Epoch: 12, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.5393843650817871
Epoch: 13, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.600569486618042
Epoch: 14, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5888128280639648
Epoch: 15, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5334241390228271
Epoch: 16, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5207939147949219
Epoch: 17, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5414755344390869
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5070078372955322
Epoch: 19, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5179634094238281
Epoch: 20, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5762317180633545
Epoch: 21, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5072519779205322
Epoch: 22, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5693228244781494
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5589966773986816
Epoch: 24, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5252711772918701
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.5395212173461914
Epoch: 26, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.5377845764160156
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5494186878204346
Epoch: 28, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.5426051616668701
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5729219913482666
Epoch: 30, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.518552303314209
Epoch: 31, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.5687739849090576
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5286586284637451
Epoch: 33, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.5107300281524658
Epoch: 34, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.50423264503479
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.4696040153503418
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4959595203399658
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 38 cost time: 0.5977909564971924
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 39 cost time: 0.538684606552124
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.5256648063659668
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5516357421875
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.5157082080841064
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.5134439468383789
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 44 cost time: 0.5346438884735107
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.5599966049194336
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.5385158061981201
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.5194587707519531
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.5582339763641357
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.5179927349090576
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5414414405822754
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 392556
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8831706047058105
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.492 Vali Acc: 0.042 Test Loss: 2.492 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 0.5476677417755127
Epoch: 2, Steps: 7 | Train Loss: 2.422 Vali Loss: 2.436 Vali Acc: 0.097 Test Loss: 2.436 Test Acc: 0.097
Validation loss decreased (-0.041642 --> -0.097198).  Saving model ...
Epoch: 3 cost time: 0.6126267910003662
Epoch: 3, Steps: 7 | Train Loss: 2.293 Vali Loss: 2.339 Vali Acc: 0.347 Test Loss: 2.339 Test Acc: 0.347
Validation loss decreased (-0.097198 --> -0.347199).  Saving model ...
Epoch: 4 cost time: 0.635228157043457
Epoch: 4, Steps: 7 | Train Loss: 2.144 Vali Loss: 2.202 Vali Acc: 0.597 Test Loss: 2.202 Test Acc: 0.597
Validation loss decreased (-0.347199 --> -0.597200).  Saving model ...
Epoch: 5 cost time: 0.6268494129180908
Epoch: 5, Steps: 7 | Train Loss: 1.953 Vali Loss: 2.033 Vali Acc: 0.694 Test Loss: 2.033 Test Acc: 0.694
Validation loss decreased (-0.597200 --> -0.694424).  Saving model ...
Epoch: 6 cost time: 0.5225398540496826
Epoch: 6, Steps: 7 | Train Loss: 1.730 Vali Loss: 1.826 Vali Acc: 0.778 Test Loss: 1.826 Test Acc: 0.778
Validation loss decreased (-0.694424 --> -0.777760).  Saving model ...
Epoch: 7 cost time: 0.6017429828643799
Epoch: 7, Steps: 7 | Train Loss: 1.462 Vali Loss: 1.583 Vali Acc: 0.847 Test Loss: 1.583 Test Acc: 0.847
Validation loss decreased (-0.777760 --> -0.847206).  Saving model ...
Epoch: 8 cost time: 0.5123505592346191
Epoch: 8, Steps: 7 | Train Loss: 1.185 Vali Loss: 1.318 Vali Acc: 0.861 Test Loss: 1.318 Test Acc: 0.861
Validation loss decreased (-0.847206 --> -0.861098).  Saving model ...
Epoch: 9 cost time: 0.6753051280975342
Epoch: 9, Steps: 7 | Train Loss: 0.912 Vali Loss: 1.043 Vali Acc: 0.861 Test Loss: 1.043 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861101).  Saving model ...
Epoch: 10 cost time: 0.5259764194488525
Epoch: 10, Steps: 7 | Train Loss: 0.641 Vali Loss: 0.814 Vali Acc: 0.889 Test Loss: 0.814 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888881).  Saving model ...
Epoch: 11 cost time: 0.5503647327423096
Epoch: 11, Steps: 7 | Train Loss: 0.430 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5191471576690674
Epoch: 12, Steps: 7 | Train Loss: 0.270 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.611342191696167
Epoch: 13, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.432 Vali Acc: 0.903 Test Loss: 0.432 Test Acc: 0.903
Validation loss decreased (-0.888881 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.579136848449707
Epoch: 14, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.5837528705596924
Epoch: 15, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.569054365158081
Epoch: 16, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.590402364730835
Epoch: 17, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5497643947601318
Epoch: 18, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.6427443027496338
Epoch: 19, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5886259078979492
Epoch: 20, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5572950839996338
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6610805988311768
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5982935428619385
Epoch: 23, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6072092056274414
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.634845495223999
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6468155384063721
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6661820411682129
Epoch: 27, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.57200026512146
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6003894805908203
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6325664520263672
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5612523555755615
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6144576072692871
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.5931620597839355
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.5590994358062744
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.6718490123748779
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.6585640907287598
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.6352720260620117
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5855920314788818
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.6323866844177246
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6373205184936523
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5992047786712646
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6088948249816895
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.6121139526367188
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6049637794494629
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5149180889129639
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5728764533996582
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.5796792507171631
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.5898036956787109
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6413276195526123
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6238069534301758
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 375084
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5991935729980469
Epoch: 1, Steps: 7 | Train Loss: 2.495 Vali Loss: 2.470 Vali Acc: 0.181 Test Loss: 2.470 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.5179648399353027
Epoch: 2, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.428 Vali Acc: 0.222 Test Loss: 2.428 Test Acc: 0.222
Validation loss decreased (-0.180531 --> -0.222198).  Saving model ...
Epoch: 3 cost time: 0.5284261703491211
Epoch: 3, Steps: 7 | Train Loss: 2.315 Vali Loss: 2.341 Vali Acc: 0.361 Test Loss: 2.341 Test Acc: 0.361
Validation loss decreased (-0.222198 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 0.4941995143890381
Epoch: 4, Steps: 7 | Train Loss: 2.194 Vali Loss: 2.214 Vali Acc: 0.500 Test Loss: 2.214 Test Acc: 0.500
Validation loss decreased (-0.361088 --> -0.499978).  Saving model ...
Epoch: 5 cost time: 0.5552749633789062
Epoch: 5, Steps: 7 | Train Loss: 2.017 Vali Loss: 2.051 Vali Acc: 0.667 Test Loss: 2.051 Test Acc: 0.667
Validation loss decreased (-0.499978 --> -0.666646).  Saving model ...
Epoch: 6 cost time: 0.566169023513794
Epoch: 6, Steps: 7 | Train Loss: 1.820 Vali Loss: 1.846 Vali Acc: 0.736 Test Loss: 1.846 Test Acc: 0.736
Validation loss decreased (-0.666646 --> -0.736093).  Saving model ...
Epoch: 7 cost time: 0.5051498413085938
Epoch: 7, Steps: 7 | Train Loss: 1.582 Vali Loss: 1.626 Vali Acc: 0.778 Test Loss: 1.626 Test Acc: 0.778
Validation loss decreased (-0.736093 --> -0.777762).  Saving model ...
Epoch: 8 cost time: 0.5094344615936279
Epoch: 8, Steps: 7 | Train Loss: 1.353 Vali Loss: 1.370 Vali Acc: 0.806 Test Loss: 1.370 Test Acc: 0.806
Validation loss decreased (-0.777762 --> -0.805542).  Saving model ...
Epoch: 9 cost time: 0.5438532829284668
Epoch: 9, Steps: 7 | Train Loss: 1.094 Vali Loss: 1.126 Vali Acc: 0.875 Test Loss: 1.126 Test Acc: 0.875
Validation loss decreased (-0.805542 --> -0.874989).  Saving model ...
Epoch: 10 cost time: 0.5058248043060303
Epoch: 10, Steps: 7 | Train Loss: 0.823 Vali Loss: 0.899 Vali Acc: 0.875 Test Loss: 0.899 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 0.5122799873352051
Epoch: 11, Steps: 7 | Train Loss: 0.592 Vali Loss: 0.696 Vali Acc: 0.903 Test Loss: 0.696 Test Acc: 0.903
Validation loss decreased (-0.874991 --> -0.902771).  Saving model ...
Epoch: 12 cost time: 0.5353395938873291
Epoch: 12, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.564 Vali Acc: 0.903 Test Loss: 0.564 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 13 cost time: 0.5204908847808838
Epoch: 13, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.458 Vali Acc: 0.903 Test Loss: 0.458 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 14 cost time: 0.5450468063354492
Epoch: 14, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.5402858257293701
Epoch: 15, Steps: 7 | Train Loss: 0.139 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.5518479347229004
Epoch: 16, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.5356762409210205
Epoch: 17, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.5360252857208252
Epoch: 18, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.6272842884063721
Epoch: 19, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5279650688171387
Epoch: 20, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5107631683349609
Epoch: 21, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.509249210357666
Epoch: 22, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.4878976345062256
Epoch: 23, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5224254131317139
Epoch: 24, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5213429927825928
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5252125263214111
Epoch: 26, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5663576126098633
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5495610237121582
Epoch: 28, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5175926685333252
Epoch: 29, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5409655570983887
Epoch: 30, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5307574272155762
Epoch: 31, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5183141231536865
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5092000961303711
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5768952369689941
Epoch: 34, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5046308040618896
Epoch: 35, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5467793941497803
Epoch: 36, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.537926197052002
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5673172473907471
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.519782304763794
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5347867012023926
Epoch: 40, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5297083854675293
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.5139007568359375
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6571247577667236
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5834040641784668
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5637826919555664
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5526978969573975
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.5089011192321777
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5669128894805908
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5271100997924805
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5191583633422852
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 367788
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6765332221984863
Epoch: 1, Steps: 7 | Train Loss: 2.531 Vali Loss: 2.497 Vali Acc: 0.028 Test Loss: 2.497 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.5566778182983398
Epoch: 2, Steps: 7 | Train Loss: 2.484 Vali Loss: 2.458 Vali Acc: 0.056 Test Loss: 2.458 Test Acc: 0.056
Validation loss decreased (-0.027753 --> -0.055531).  Saving model ...
Epoch: 3 cost time: 0.5456583499908447
Epoch: 3, Steps: 7 | Train Loss: 2.403 Vali Loss: 2.379 Vali Acc: 0.194 Test Loss: 2.379 Test Acc: 0.194
Validation loss decreased (-0.055531 --> -0.194421).  Saving model ...
Epoch: 4 cost time: 0.5465707778930664
Epoch: 4, Steps: 7 | Train Loss: 2.256 Vali Loss: 2.266 Vali Acc: 0.458 Test Loss: 2.266 Test Acc: 0.458
Validation loss decreased (-0.194421 --> -0.458311).  Saving model ...
Epoch: 5 cost time: 0.5226655006408691
Epoch: 5, Steps: 7 | Train Loss: 2.102 Vali Loss: 2.122 Vali Acc: 0.653 Test Loss: 2.122 Test Acc: 0.653
Validation loss decreased (-0.458311 --> -0.652757).  Saving model ...
Epoch: 6 cost time: 0.5559933185577393
Epoch: 6, Steps: 7 | Train Loss: 1.933 Vali Loss: 1.948 Vali Acc: 0.722 Test Loss: 1.948 Test Acc: 0.722
Validation loss decreased (-0.652757 --> -0.722203).  Saving model ...
Epoch: 7 cost time: 0.5570762157440186
Epoch: 7, Steps: 7 | Train Loss: 1.726 Vali Loss: 1.756 Vali Acc: 0.750 Test Loss: 1.756 Test Acc: 0.750
Validation loss decreased (-0.722203 --> -0.749982).  Saving model ...
Epoch: 8 cost time: 0.5379493236541748
Epoch: 8, Steps: 7 | Train Loss: 1.522 Vali Loss: 1.551 Vali Acc: 0.764 Test Loss: 1.551 Test Acc: 0.764
Validation loss decreased (-0.749982 --> -0.763873).  Saving model ...
Epoch: 9 cost time: 0.5326261520385742
Epoch: 9, Steps: 7 | Train Loss: 1.308 Vali Loss: 1.334 Vali Acc: 0.889 Test Loss: 1.334 Test Acc: 0.889
Validation loss decreased (-0.763873 --> -0.888876).  Saving model ...
Epoch: 10 cost time: 0.5804226398468018
Epoch: 10, Steps: 7 | Train Loss: 1.054 Vali Loss: 1.120 Vali Acc: 0.889 Test Loss: 1.120 Test Acc: 0.889
Validation loss decreased (-0.888876 --> -0.888878).  Saving model ...
Epoch: 11 cost time: 0.5725505352020264
Epoch: 11, Steps: 7 | Train Loss: 0.843 Vali Loss: 0.920 Vali Acc: 0.889 Test Loss: 0.920 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888880).  Saving model ...
Epoch: 12 cost time: 0.604860782623291
Epoch: 12, Steps: 7 | Train Loss: 0.645 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5443053245544434
Epoch: 13, Steps: 7 | Train Loss: 0.477 Vali Loss: 0.622 Vali Acc: 0.889 Test Loss: 0.622 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888883).  Saving model ...
Epoch: 14 cost time: 0.6054413318634033
Epoch: 14, Steps: 7 | Train Loss: 0.357 Vali Loss: 0.526 Vali Acc: 0.903 Test Loss: 0.526 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 0.5414583683013916
Epoch: 15, Steps: 7 | Train Loss: 0.259 Vali Loss: 0.462 Vali Acc: 0.903 Test Loss: 0.462 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 0.557889461517334
Epoch: 16, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.410 Vali Acc: 0.903 Test Loss: 0.410 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.6040048599243164
Epoch: 17, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.5513472557067871
Epoch: 18, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.5627381801605225
Epoch: 19, Steps: 7 | Train Loss: 0.096 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.5354223251342773
Epoch: 20, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.321 Vali Acc: 0.931 Test Loss: 0.321 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 21 cost time: 0.5120298862457275
Epoch: 21, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 22 cost time: 0.5781948566436768
Epoch: 22, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5581157207489014
Epoch: 23, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5886735916137695
Epoch: 24, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5745959281921387
Epoch: 25, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5468971729278564
Epoch: 26, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5528740882873535
Epoch: 27, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5626933574676514
Epoch: 28, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.530667781829834
Epoch: 29, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5412342548370361
Epoch: 30, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5945143699645996
Epoch: 31, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5863192081451416
Epoch: 32, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6710219383239746
Epoch: 33, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.557671308517456
Epoch: 34, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5225687026977539
Epoch: 35, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5169506072998047
Epoch: 36, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5647165775299072
Epoch: 37, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.49934840202331543
Epoch: 38, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5290095806121826
Epoch: 39, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5336997509002686
Epoch: 40, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5835461616516113
Epoch: 41, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.5970284938812256
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5863142013549805
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5273563861846924
Epoch: 44, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.6175541877746582
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.4944157600402832
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.48671960830688477
Epoch: 47, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.498124361038208
Epoch: 48, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5024089813232422
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.5557661056518555
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 360492
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5705740451812744
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.480 Vali Acc: 0.111 Test Loss: 2.480 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.4594461917877197
Epoch: 2, Steps: 7 | Train Loss: 2.466 Vali Loss: 2.444 Vali Acc: 0.208 Test Loss: 2.444 Test Acc: 0.208
Validation loss decreased (-0.111086 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 0.48119235038757324
Epoch: 3, Steps: 7 | Train Loss: 2.376 Vali Loss: 2.377 Vali Acc: 0.333 Test Loss: 2.377 Test Acc: 0.333
Validation loss decreased (-0.208309 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 0.4633815288543701
Epoch: 4, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.283 Vali Acc: 0.500 Test Loss: 2.283 Test Acc: 0.500
Validation loss decreased (-0.333310 --> -0.499977).  Saving model ...
Epoch: 5 cost time: 0.49155545234680176
Epoch: 5, Steps: 7 | Train Loss: 2.157 Vali Loss: 2.166 Vali Acc: 0.542 Test Loss: 2.166 Test Acc: 0.542
Validation loss decreased (-0.499977 --> -0.541645).  Saving model ...
Epoch: 6 cost time: 0.5034055709838867
Epoch: 6, Steps: 7 | Train Loss: 2.001 Vali Loss: 2.034 Vali Acc: 0.681 Test Loss: 2.034 Test Acc: 0.681
Validation loss decreased (-0.541645 --> -0.680535).  Saving model ...
Epoch: 7 cost time: 0.5363774299621582
Epoch: 7, Steps: 7 | Train Loss: 1.879 Vali Loss: 1.883 Vali Acc: 0.736 Test Loss: 1.883 Test Acc: 0.736
Validation loss decreased (-0.680535 --> -0.736092).  Saving model ...
Epoch: 8 cost time: 0.4827311038970947
Epoch: 8, Steps: 7 | Train Loss: 1.682 Vali Loss: 1.715 Vali Acc: 0.764 Test Loss: 1.715 Test Acc: 0.764
Validation loss decreased (-0.736092 --> -0.763872).  Saving model ...
Epoch: 9 cost time: 0.4997556209564209
Epoch: 9, Steps: 7 | Train Loss: 1.478 Vali Loss: 1.530 Vali Acc: 0.778 Test Loss: 1.530 Test Acc: 0.778
Validation loss decreased (-0.763872 --> -0.777762).  Saving model ...
Epoch: 10 cost time: 0.5926730632781982
Epoch: 10, Steps: 7 | Train Loss: 1.287 Vali Loss: 1.328 Vali Acc: 0.806 Test Loss: 1.328 Test Acc: 0.806
Validation loss decreased (-0.777762 --> -0.805542).  Saving model ...
Epoch: 11 cost time: 0.49245786666870117
Epoch: 11, Steps: 7 | Train Loss: 1.050 Vali Loss: 1.136 Vali Acc: 0.833 Test Loss: 1.136 Test Acc: 0.833
Validation loss decreased (-0.805542 --> -0.833322).  Saving model ...
Epoch: 12 cost time: 0.49865031242370605
Epoch: 12, Steps: 7 | Train Loss: 0.860 Vali Loss: 0.959 Vali Acc: 0.819 Test Loss: 0.959 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.48839521408081055
Epoch: 13, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.808 Vali Acc: 0.875 Test Loss: 0.808 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 0.5058150291442871
Epoch: 14, Steps: 7 | Train Loss: 0.525 Vali Loss: 0.691 Vali Acc: 0.889 Test Loss: 0.691 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 0.6074886322021484
Epoch: 15, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.604 Vali Acc: 0.903 Test Loss: 0.604 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902772).  Saving model ...
Epoch: 16 cost time: 0.507129430770874
Epoch: 16, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.542 Vali Acc: 0.903 Test Loss: 0.542 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 17 cost time: 0.4742300510406494
Epoch: 17, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.483 Vali Acc: 0.903 Test Loss: 0.483 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 18 cost time: 0.4962425231933594
Epoch: 18, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.442 Vali Acc: 0.889 Test Loss: 0.442 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4908101558685303
Epoch: 19, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.4946463108062744
Epoch: 20, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 21 cost time: 0.5256586074829102
Epoch: 21, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.48432326316833496
Epoch: 22, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.5692248344421387
Epoch: 23, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.5680599212646484
Epoch: 24, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.5249068737030029
Epoch: 25, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.535836935043335
Epoch: 26, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 27 cost time: 0.5417907238006592
Epoch: 27, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.48105955123901367
Epoch: 28, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5395300388336182
Epoch: 29, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6163678169250488
Epoch: 30, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.47550153732299805
Epoch: 31, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.48049449920654297
Epoch: 32, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.48865270614624023
Epoch: 33, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.47356367111206055
Epoch: 34, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5262918472290039
Epoch: 35, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.4539506435394287
Epoch: 36, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.5347139835357666
Epoch: 37, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.5447924137115479
Epoch: 38, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.5373258590698242
Epoch: 39, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5029497146606445
Epoch: 40, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.5176942348480225
Epoch: 41, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5822257995605469
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5972094535827637
Epoch: 43, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5588181018829346
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5510313510894775
Epoch: 45, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.49623608589172363
Epoch: 46, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.616511344909668
Epoch: 47, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5036685466766357
Epoch: 48, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.49955224990844727
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5130400657653809
Epoch: 50, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 353196
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6751527786254883
Epoch: 1, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.340 Vali Acc: 0.278 Test Loss: 2.340 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 0.6133573055267334
Epoch: 2, Steps: 7 | Train Loss: 1.769 Vali Loss: 1.629 Vali Acc: 0.764 Test Loss: 1.629 Test Acc: 0.764
Validation loss decreased (-0.277754 --> -0.763873).  Saving model ...
Epoch: 3 cost time: 0.636981725692749
Epoch: 3, Steps: 7 | Train Loss: 0.659 Vali Loss: 0.786 Vali Acc: 0.917 Test Loss: 0.786 Test Acc: 0.917
Validation loss decreased (-0.763873 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 0.5811028480529785
Epoch: 4, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
Validation loss decreased (-0.916659 --> -0.930552).  Saving model ...
Epoch: 5 cost time: 0.6238594055175781
Epoch: 5, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6009602546691895
Epoch: 6, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5941765308380127
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.553936243057251
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5487873554229736
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.609738826751709
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6016030311584473
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6142349243164062
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.6178407669067383
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.635418176651001
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6764755249023438
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.554973840713501
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6181676387786865
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6615331172943115
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6194374561309814
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5453956127166748
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5909421443939209
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6781051158905029
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1878924
model size : 7.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6699914932250977
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.407 Vali Acc: 0.208 Test Loss: 2.407 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.556873083114624
Epoch: 2, Steps: 7 | Train Loss: 2.091 Vali Loss: 1.975 Vali Acc: 0.750 Test Loss: 1.975 Test Acc: 0.750
Validation loss decreased (-0.208309 --> -0.749980).  Saving model ...
Epoch: 3 cost time: 0.600341796875
Epoch: 3, Steps: 7 | Train Loss: 1.321 Vali Loss: 1.330 Vali Acc: 0.875 Test Loss: 1.330 Test Acc: 0.875
Validation loss decreased (-0.749980 --> -0.874987).  Saving model ...
Epoch: 4 cost time: 0.6385056972503662
Epoch: 4, Steps: 7 | Train Loss: 0.604 Vali Loss: 0.709 Vali Acc: 0.903 Test Loss: 0.709 Test Acc: 0.903
Validation loss decreased (-0.874987 --> -0.902771).  Saving model ...
Epoch: 5 cost time: 0.6250553131103516
Epoch: 5, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.626694917678833
Epoch: 6, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 0.6123039722442627
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.5797419548034668
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.51106858253479
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.574458122253418
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5822579860687256
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.554344892501831
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5608201026916504
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5420849323272705
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6101634502410889
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5764355659484863
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5952963829040527
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5836858749389648
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.6063699722290039
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6185417175292969
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5817577838897705
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.572324275970459
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.546630859375
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6200993061065674
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6158430576324463
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5623164176940918
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5706839561462402
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6206731796264648
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5964984893798828
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5659980773925781
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6331086158752441
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5695681571960449
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5410768985748291
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5323352813720703
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5871164798736572
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6285004615783691
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5222160816192627
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1514124
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7688758373260498
Epoch: 1, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.390 Vali Acc: 0.222 Test Loss: 2.390 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.5218124389648438
Epoch: 2, Steps: 7 | Train Loss: 2.159 Vali Loss: 2.068 Vali Acc: 0.792 Test Loss: 2.068 Test Acc: 0.792
Validation loss decreased (-0.222198 --> -0.791646).  Saving model ...
Epoch: 3 cost time: 0.5490632057189941
Epoch: 3, Steps: 7 | Train Loss: 1.593 Vali Loss: 1.555 Vali Acc: 0.819 Test Loss: 1.555 Test Acc: 0.819
Validation loss decreased (-0.791646 --> -0.819429).  Saving model ...
Epoch: 4 cost time: 0.5550971031188965
Epoch: 4, Steps: 7 | Train Loss: 0.956 Vali Loss: 0.990 Vali Acc: 0.944 Test Loss: 0.990 Test Acc: 0.944
Validation loss decreased (-0.819429 --> -0.944435).  Saving model ...
Epoch: 5 cost time: 0.5126492977142334
Epoch: 5, Steps: 7 | Train Loss: 0.433 Vali Loss: 0.553 Vali Acc: 0.917 Test Loss: 0.553 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5310938358306885
Epoch: 6, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
Validation loss decreased (-0.944435 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 0.6020526885986328
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5596761703491211
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5604419708251953
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6417579650878906
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.612783670425415
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.45661139488220215
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6122720241546631
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5128912925720215
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5120978355407715
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5691118240356445
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1388940
model size : 5.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.862074375152588
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.454 Vali Acc: 0.083 Test Loss: 2.454 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.6635007858276367
Epoch: 2, Steps: 7 | Train Loss: 2.314 Vali Loss: 2.225 Vali Acc: 0.556 Test Loss: 2.225 Test Acc: 0.556
Validation loss decreased (-0.083309 --> -0.555533).  Saving model ...
Epoch: 3 cost time: 0.704249382019043
Epoch: 3, Steps: 7 | Train Loss: 1.816 Vali Loss: 1.825 Vali Acc: 0.764 Test Loss: 1.825 Test Acc: 0.764
Validation loss decreased (-0.555533 --> -0.763871).  Saving model ...
Epoch: 4 cost time: 0.551361083984375
Epoch: 4, Steps: 7 | Train Loss: 1.250 Vali Loss: 1.301 Vali Acc: 0.819 Test Loss: 1.301 Test Acc: 0.819
Validation loss decreased (-0.763871 --> -0.819431).  Saving model ...
Epoch: 5 cost time: 0.658726692199707
Epoch: 5, Steps: 7 | Train Loss: 0.705 Vali Loss: 0.795 Vali Acc: 0.861 Test Loss: 0.795 Test Acc: 0.861
Validation loss decreased (-0.819431 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 0.6073381900787354
Epoch: 6, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.485 Vali Acc: 0.903 Test Loss: 0.485 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.7303686141967773
Epoch: 7, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.6843740940093994
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.5317060947418213
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.6147916316986084
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.6001412868499756
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6732852458953857
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5560684204101562
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.566519021987915
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6055583953857422
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6637294292449951
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6609289646148682
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.5676333904266357
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6372849941253662
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5735876560211182
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5567443370819092
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.6597378253936768
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6390876770019531
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.6392025947570801
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5859923362731934
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.5898573398590088
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.6404197216033936
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6128573417663574
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6602370738983154
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6248414516448975
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5875606536865234
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7368483543395996
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6396796703338623
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6393334865570068
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5850601196289062
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.576385498046875
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.5714025497436523
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.6104099750518799
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6082537174224854
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6066386699676514
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.662083625793457
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6451456546783447
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5747051239013672
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.6795682907104492
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.559943437576294
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6658093929290771
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5630300045013428
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5354604721069336
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6054973602294922
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6377198696136475
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1337484
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7682292461395264
Epoch: 1, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.412 Vali Acc: 0.097 Test Loss: 2.412 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.49898338317871094
Epoch: 2, Steps: 7 | Train Loss: 2.273 Vali Loss: 2.214 Vali Acc: 0.514 Test Loss: 2.214 Test Acc: 0.514
Validation loss decreased (-0.097198 --> -0.513867).  Saving model ...
Epoch: 3 cost time: 0.6183176040649414
Epoch: 3, Steps: 7 | Train Loss: 1.921 Vali Loss: 1.898 Vali Acc: 0.736 Test Loss: 1.898 Test Acc: 0.736
Validation loss decreased (-0.513867 --> -0.736092).  Saving model ...
Epoch: 4 cost time: 0.5369014739990234
Epoch: 4, Steps: 7 | Train Loss: 1.474 Vali Loss: 1.483 Vali Acc: 0.833 Test Loss: 1.483 Test Acc: 0.833
Validation loss decreased (-0.736092 --> -0.833319).  Saving model ...
Epoch: 5 cost time: 0.5611145496368408
Epoch: 5, Steps: 7 | Train Loss: 0.963 Vali Loss: 1.036 Vali Acc: 0.861 Test Loss: 1.036 Test Acc: 0.861
Validation loss decreased (-0.833319 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 0.608903169631958
Epoch: 6, Steps: 7 | Train Loss: 0.546 Vali Loss: 0.679 Vali Acc: 0.931 Test Loss: 0.679 Test Acc: 0.931
Validation loss decreased (-0.861101 --> -0.930549).  Saving model ...
Epoch: 7 cost time: 0.5494081974029541
Epoch: 7, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.440 Vali Acc: 0.931 Test Loss: 0.440 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930551).  Saving model ...
Epoch: 8 cost time: 0.607520580291748
Epoch: 8, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.598236083984375
Epoch: 9, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.535250186920166
Epoch: 10, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6091110706329346
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6127588748931885
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.531702995300293
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.599722146987915
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.5209155082702637
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6146924495697021
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5524849891662598
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.6209971904754639
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.5907576084136963
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6387767791748047
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.5439269542694092
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.6725077629089355
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.5710413455963135
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6054842472076416
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.544348955154419
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 26 cost time: 0.6458220481872559
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 27 cost time: 0.5479092597961426
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 28 cost time: 0.4954524040222168
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 29 cost time: 0.6149537563323975
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6185531616210938
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6047353744506836
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5846359729766846
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 33 cost time: 0.6067616939544678
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.635756254196167
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 35 cost time: 0.5430951118469238
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.593449592590332
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6553225517272949
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 38 cost time: 0.6167542934417725
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 39 cost time: 0.5710492134094238
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5898036956787109
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5575754642486572
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.602825403213501
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5505039691925049
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5257108211517334
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6225950717926025
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5603337287902832
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6139693260192871
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5119004249572754
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 1289868
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6333069801330566
Epoch: 1, Steps: 7 | Train Loss: 2.502 Vali Loss: 2.449 Vali Acc: 0.139 Test Loss: 2.449 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.5280802249908447
Epoch: 2, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.282 Vali Acc: 0.319 Test Loss: 2.282 Test Acc: 0.319
Validation loss decreased (-0.138864 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 0.6084301471710205
Epoch: 3, Steps: 7 | Train Loss: 2.014 Vali Loss: 1.999 Vali Acc: 0.708 Test Loss: 1.999 Test Acc: 0.708
Validation loss decreased (-0.319422 --> -0.708313).  Saving model ...
Epoch: 4 cost time: 0.6146104335784912
Epoch: 4, Steps: 7 | Train Loss: 1.629 Vali Loss: 1.633 Vali Acc: 0.819 Test Loss: 1.633 Test Acc: 0.819
Validation loss decreased (-0.708313 --> -0.819428).  Saving model ...
Epoch: 5 cost time: 0.6004416942596436
Epoch: 5, Steps: 7 | Train Loss: 1.177 Vali Loss: 1.217 Vali Acc: 0.861 Test Loss: 1.217 Test Acc: 0.861
Validation loss decreased (-0.819428 --> -0.861099).  Saving model ...
Epoch: 6 cost time: 0.5944325923919678
Epoch: 6, Steps: 7 | Train Loss: 0.764 Vali Loss: 0.855 Vali Acc: 0.833 Test Loss: 0.855 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6205673217773438
Epoch: 7, Steps: 7 | Train Loss: 0.430 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 0.5722413063049316
Epoch: 8, Steps: 7 | Train Loss: 0.218 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.6341760158538818
Epoch: 9, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.5643153190612793
Epoch: 10, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6113998889923096
Epoch: 11, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5465087890625
Epoch: 12, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5990197658538818
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.588660717010498
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6479673385620117
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5397207736968994
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.6009776592254639
Epoch: 17, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.52410888671875
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.49317026138305664
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5029416084289551
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6036529541015625
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5986001491546631
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.6436066627502441
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6225569248199463
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6264441013336182
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.6301074028015137
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5595989227294922
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5869369506835938
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5993609428405762
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.587460994720459
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6697671413421631
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6491782665252686
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6578624248504639
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.6108520030975342
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5587692260742188
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.5165908336639404
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.5240583419799805
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.47521090507507324
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5663449764251709
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5550997257232666
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.5696916580200195
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.5369324684143066
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6343042850494385
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.5612213611602783
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.6228597164154053
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.6286697387695312
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5753023624420166
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5855131149291992
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6455061435699463
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6006758213043213
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1260684
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6863670349121094
Epoch: 1, Steps: 7 | Train Loss: 2.517 Vali Loss: 2.458 Vali Acc: 0.097 Test Loss: 2.458 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.537329912185669
Epoch: 2, Steps: 7 | Train Loss: 2.381 Vali Loss: 2.319 Vali Acc: 0.264 Test Loss: 2.319 Test Acc: 0.264
Validation loss decreased (-0.097198 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.5664980411529541
Epoch: 3, Steps: 7 | Train Loss: 2.116 Vali Loss: 2.089 Vali Acc: 0.597 Test Loss: 2.089 Test Acc: 0.597
Validation loss decreased (-0.263866 --> -0.597201).  Saving model ...
Epoch: 4 cost time: 0.5821349620819092
Epoch: 4, Steps: 7 | Train Loss: 1.772 Vali Loss: 1.792 Vali Acc: 0.722 Test Loss: 1.792 Test Acc: 0.722
Validation loss decreased (-0.597201 --> -0.722204).  Saving model ...
Epoch: 5 cost time: 0.5714840888977051
Epoch: 5, Steps: 7 | Train Loss: 1.399 Vali Loss: 1.455 Vali Acc: 0.778 Test Loss: 1.455 Test Acc: 0.778
Validation loss decreased (-0.722204 --> -0.777763).  Saving model ...
Epoch: 6 cost time: 0.6539115905761719
Epoch: 6, Steps: 7 | Train Loss: 1.003 Vali Loss: 1.119 Vali Acc: 0.833 Test Loss: 1.119 Test Acc: 0.833
Validation loss decreased (-0.777763 --> -0.833322).  Saving model ...
Epoch: 7 cost time: 0.6109464168548584
Epoch: 7, Steps: 7 | Train Loss: 0.648 Vali Loss: 0.806 Vali Acc: 0.875 Test Loss: 0.806 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.5207257270812988
Epoch: 8, Steps: 7 | Train Loss: 0.377 Vali Loss: 0.603 Vali Acc: 0.903 Test Loss: 0.603 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902772).  Saving model ...
Epoch: 9 cost time: 0.5879991054534912
Epoch: 9, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.590726375579834
Epoch: 10, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.601374626159668
Epoch: 11, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.565178632736206
Epoch: 12, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5461106300354004
Epoch: 13, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4891972541809082
Epoch: 14, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 0.6264522075653076
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 0.6408240795135498
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 0.528693437576294
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 18 cost time: 0.5148179531097412
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.5523827075958252
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5314586162567139
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.5457332134246826
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5458903312683105
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.5168230533599854
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5480988025665283
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5996048450469971
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.576948881149292
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.6358687877655029
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 28 cost time: 0.6013810634613037
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.5902457237243652
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 30 cost time: 0.6737532615661621
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.5864481925964355
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 32 cost time: 0.594160795211792
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.5462536811828613
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5429089069366455
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5310344696044922
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5474057197570801
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.5209653377532959
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.5185792446136475
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.5382254123687744
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5617377758026123
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.5708954334259033
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.5570001602172852
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5980684757232666
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.5417830944061279
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.5779557228088379
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5005934238433838
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5586693286895752
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5259819030761719
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.587104082107544
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5575571060180664
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1249932
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6411421298980713
Epoch: 1, Steps: 7 | Train Loss: 2.543 Vali Loss: 2.471 Vali Acc: 0.097 Test Loss: 2.471 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.5335183143615723
Epoch: 2, Steps: 7 | Train Loss: 2.188 Vali Loss: 2.130 Vali Acc: 0.611 Test Loss: 2.130 Test Acc: 0.611
Validation loss decreased (-0.097198 --> -0.611090).  Saving model ...
Epoch: 3 cost time: 0.5386765003204346
Epoch: 3, Steps: 7 | Train Loss: 1.480 Vali Loss: 1.574 Vali Acc: 0.764 Test Loss: 1.574 Test Acc: 0.764
Validation loss decreased (-0.611090 --> -0.763873).  Saving model ...
Epoch: 4 cost time: 0.5292754173278809
Epoch: 4, Steps: 7 | Train Loss: 0.763 Vali Loss: 0.966 Vali Acc: 0.875 Test Loss: 0.966 Test Acc: 0.875
Validation loss decreased (-0.763873 --> -0.874990).  Saving model ...
Epoch: 5 cost time: 0.5300135612487793
Epoch: 5, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.535 Vali Acc: 0.931 Test Loss: 0.535 Test Acc: 0.931
Validation loss decreased (-0.874990 --> -0.930550).  Saving model ...
Epoch: 6 cost time: 0.5501224994659424
Epoch: 6, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.51712965965271
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.4849576950073242
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.5307157039642334
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5031094551086426
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6325709819793701
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5349094867706299
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.45102882385253906
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5718972682952881
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5064151287078857
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5634026527404785
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5367395877838135
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5220935344696045
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 677324
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.740971326828003
Epoch: 1, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.410 Vali Acc: 0.125 Test Loss: 2.410 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.47077274322509766
Epoch: 2, Steps: 7 | Train Loss: 2.254 Vali Loss: 2.150 Vali Acc: 0.597 Test Loss: 2.150 Test Acc: 0.597
Validation loss decreased (-0.124976 --> -0.597201).  Saving model ...
Epoch: 3 cost time: 0.546414852142334
Epoch: 3, Steps: 7 | Train Loss: 1.786 Vali Loss: 1.740 Vali Acc: 0.833 Test Loss: 1.740 Test Acc: 0.833
Validation loss decreased (-0.597201 --> -0.833316).  Saving model ...
Epoch: 4 cost time: 0.501495361328125
Epoch: 4, Steps: 7 | Train Loss: 1.243 Vali Loss: 1.251 Vali Acc: 0.861 Test Loss: 1.251 Test Acc: 0.861
Validation loss decreased (-0.833316 --> -0.861099).  Saving model ...
Epoch: 5 cost time: 0.5322182178497314
Epoch: 5, Steps: 7 | Train Loss: 0.710 Vali Loss: 0.803 Vali Acc: 0.931 Test Loss: 0.803 Test Acc: 0.931
Validation loss decreased (-0.861099 --> -0.930548).  Saving model ...
Epoch: 6 cost time: 0.5868589878082275
Epoch: 6, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.494 Vali Acc: 0.944 Test Loss: 0.494 Test Acc: 0.944
Validation loss decreased (-0.930548 --> -0.944440).  Saving model ...
Epoch: 7 cost time: 0.4945676326751709
Epoch: 7, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46410322189331055
Epoch: 8, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.296 Vali Acc: 0.958 Test Loss: 0.296 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958330).  Saving model ...
Epoch: 9 cost time: 0.46944332122802734
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.255 Vali Acc: 0.958 Test Loss: 0.255 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.5423142910003662
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4881763458251953
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.526404857635498
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.4930734634399414
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.5134491920471191
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.5289645195007324
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.5321931838989258
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5118205547332764
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5575041770935059
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.5179333686828613
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.512279748916626
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.4840404987335205
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.5333483219146729
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.5119726657867432
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.5275044441223145
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.5546565055847168
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.5113227367401123
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5451598167419434
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.5120341777801514
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.4831736087799072
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.5415971279144287
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5055198669433594
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.4821150302886963
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5855090618133545
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.5230002403259277
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4689149856567383
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.4741337299346924
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4901235103607178
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.49552273750305176
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.5295901298522949
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 40 cost time: 0.4789466857910156
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.5173037052154541
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.5376858711242676
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.5614097118377686
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5249598026275635
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.5007121562957764
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.47835707664489746
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.5028738975524902
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.5194206237792969
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.5002377033233643
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.5356838703155518
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 494924
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5496082305908203
Epoch: 1, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.488 Vali Acc: 0.083 Test Loss: 2.488 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.5080239772796631
Epoch: 2, Steps: 7 | Train Loss: 2.416 Vali Loss: 2.335 Vali Acc: 0.361 Test Loss: 2.335 Test Acc: 0.361
Validation loss decreased (-0.083308 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 0.528684139251709
Epoch: 3, Steps: 7 | Train Loss: 2.111 Vali Loss: 2.094 Vali Acc: 0.694 Test Loss: 2.094 Test Acc: 0.694
Validation loss decreased (-0.361088 --> -0.694424).  Saving model ...
Epoch: 4 cost time: 0.4996793270111084
Epoch: 4, Steps: 7 | Train Loss: 1.735 Vali Loss: 1.777 Vali Acc: 0.750 Test Loss: 1.777 Test Acc: 0.750
Validation loss decreased (-0.694424 --> -0.749982).  Saving model ...
Epoch: 5 cost time: 0.5246105194091797
Epoch: 5, Steps: 7 | Train Loss: 1.309 Vali Loss: 1.373 Vali Acc: 0.819 Test Loss: 1.373 Test Acc: 0.819
Validation loss decreased (-0.749982 --> -0.819431).  Saving model ...
Epoch: 6 cost time: 0.4977867603302002
Epoch: 6, Steps: 7 | Train Loss: 0.849 Vali Loss: 0.964 Vali Acc: 0.889 Test Loss: 0.964 Test Acc: 0.889
Validation loss decreased (-0.819431 --> -0.888879).  Saving model ...
Epoch: 7 cost time: 0.5044629573822021
Epoch: 7, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.653 Vali Acc: 0.903 Test Loss: 0.653 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 0.5323326587677002
Epoch: 8, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5606179237365723
Epoch: 9, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.48594045639038086
Epoch: 10, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46857213973999023
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.523679256439209
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4916403293609619
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5027852058410645
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5438730716705322
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5141842365264893
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.5244395732879639
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.48345041275024414
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.48309803009033203
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.5347175598144531
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.522376298904419
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.4815049171447754
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5023019313812256
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.48345327377319336
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5293405055999756
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.5157852172851562
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.5280177593231201
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.4976799488067627
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.5296576023101807
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.47100067138671875
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.6552324295043945
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.5192263126373291
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.5307605266571045
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.5015561580657959
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.46451306343078613
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.452451229095459
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.5361478328704834
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.4505622386932373
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5325024127960205
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.4751620292663574
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.4689669609069824
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4609048366546631
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.4764525890350342
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.5308177471160889
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.505573034286499
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.5216343402862549
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5011312961578369
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.47836899757385254
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5561277866363525
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.5213949680328369
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 432332
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.550248146057129
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.427 Vali Acc: 0.167 Test Loss: 2.427 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.4728221893310547
Epoch: 2, Steps: 7 | Train Loss: 2.315 Vali Loss: 2.287 Vali Acc: 0.458 Test Loss: 2.287 Test Acc: 0.458
Validation loss decreased (-0.166642 --> -0.458310).  Saving model ...
Epoch: 3 cost time: 0.4892845153808594
Epoch: 3, Steps: 7 | Train Loss: 2.077 Vali Loss: 2.055 Vali Acc: 0.708 Test Loss: 2.055 Test Acc: 0.708
Validation loss decreased (-0.458310 --> -0.708313).  Saving model ...
Epoch: 4 cost time: 0.4511263370513916
Epoch: 4, Steps: 7 | Train Loss: 1.769 Vali Loss: 1.740 Vali Acc: 0.833 Test Loss: 1.740 Test Acc: 0.833
Validation loss decreased (-0.708313 --> -0.833316).  Saving model ...
Epoch: 5 cost time: 0.4966108798980713
Epoch: 5, Steps: 7 | Train Loss: 1.374 Vali Loss: 1.377 Vali Acc: 0.861 Test Loss: 1.377 Test Acc: 0.861
Validation loss decreased (-0.833316 --> -0.861097).  Saving model ...
Epoch: 6 cost time: 0.5079653263092041
Epoch: 6, Steps: 7 | Train Loss: 0.957 Vali Loss: 0.997 Vali Acc: 0.875 Test Loss: 0.997 Test Acc: 0.875
Validation loss decreased (-0.861097 --> -0.874990).  Saving model ...
Epoch: 7 cost time: 0.4877352714538574
Epoch: 7, Steps: 7 | Train Loss: 0.590 Vali Loss: 0.691 Vali Acc: 0.889 Test Loss: 0.691 Test Acc: 0.889
Validation loss decreased (-0.874990 --> -0.888882).  Saving model ...
Epoch: 8 cost time: 0.4906644821166992
Epoch: 8, Steps: 7 | Train Loss: 0.321 Vali Loss: 0.497 Vali Acc: 0.903 Test Loss: 0.497 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 9 cost time: 0.48867225646972656
Epoch: 9, Steps: 7 | Train Loss: 0.165 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.4918699264526367
Epoch: 10, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.4866466522216797
Epoch: 11, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.4573538303375244
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.45883631706237793
Epoch: 13, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.4881892204284668
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.4518435001373291
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5308585166931152
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.457733154296875
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.48533105850219727
Epoch: 18, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.48599982261657715
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.4640631675720215
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.484222412109375
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.47449302673339844
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.49164295196533203
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.5030901432037354
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.45810747146606445
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.47220873832702637
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.4669497013092041
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.4593050479888916
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.4806547164916992
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.49359583854675293
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.49551987648010254
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.42911338806152344
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.5171630382537842
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 0.48963022232055664
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.4402182102203369
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 36 cost time: 0.5007002353668213
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.5875463485717773
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 0.44049930572509766
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.47611522674560547
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5032544136047363
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5088491439819336
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5155506134033203
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 0.47817254066467285
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.5134997367858887
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 0.4679074287414551
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4997518062591553
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5272946357727051
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4719414710998535
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 49 cost time: 0.4856376647949219
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 50 cost time: 0.5154917240142822
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 406604
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5089175701141357
Epoch: 1, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.467 Vali Acc: 0.097 Test Loss: 2.467 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.48796820640563965
Epoch: 2, Steps: 7 | Train Loss: 2.348 Vali Loss: 2.354 Vali Acc: 0.306 Test Loss: 2.354 Test Acc: 0.306
Validation loss decreased (-0.097198 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 0.4445793628692627
Epoch: 3, Steps: 7 | Train Loss: 2.144 Vali Loss: 2.171 Vali Acc: 0.458 Test Loss: 2.171 Test Acc: 0.458
Validation loss decreased (-0.305532 --> -0.458312).  Saving model ...
Epoch: 4 cost time: 0.4473414421081543
Epoch: 4, Steps: 7 | Train Loss: 1.907 Vali Loss: 1.928 Vali Acc: 0.694 Test Loss: 1.928 Test Acc: 0.694
Validation loss decreased (-0.458312 --> -0.694425).  Saving model ...
Epoch: 5 cost time: 0.4451909065246582
Epoch: 5, Steps: 7 | Train Loss: 1.620 Vali Loss: 1.634 Vali Acc: 0.819 Test Loss: 1.634 Test Acc: 0.819
Validation loss decreased (-0.694425 --> -0.819428).  Saving model ...
Epoch: 6 cost time: 0.4665365219116211
Epoch: 6, Steps: 7 | Train Loss: 1.269 Vali Loss: 1.315 Vali Acc: 0.875 Test Loss: 1.315 Test Acc: 0.875
Validation loss decreased (-0.819428 --> -0.874987).  Saving model ...
Epoch: 7 cost time: 0.4853382110595703
Epoch: 7, Steps: 7 | Train Loss: 0.920 Vali Loss: 1.003 Vali Acc: 0.861 Test Loss: 1.003 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4687983989715576
Epoch: 8, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.729 Vali Acc: 0.903 Test Loss: 0.729 Test Acc: 0.903
Validation loss decreased (-0.874987 --> -0.902770).  Saving model ...
Epoch: 9 cost time: 0.5038101673126221
Epoch: 9, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.529 Vali Acc: 0.931 Test Loss: 0.529 Test Acc: 0.931
Validation loss decreased (-0.902770 --> -0.930550).  Saving model ...
Epoch: 10 cost time: 0.4981815814971924
Epoch: 10, Steps: 7 | Train Loss: 0.210 Vali Loss: 0.418 Vali Acc: 0.903 Test Loss: 0.418 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.44886350631713867
Epoch: 11, Steps: 7 | Train Loss: 0.126 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.4472320079803467
Epoch: 12, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5151889324188232
Epoch: 13, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.45338010787963867
Epoch: 14, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.463759183883667
Epoch: 15, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.49852871894836426
Epoch: 16, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5359432697296143
Epoch: 17, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4476437568664551
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.46882176399230957
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.48041844367980957
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.45279359817504883
Epoch: 21, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4720613956451416
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.45456933975219727
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.45024585723876953
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.48152732849121094
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4188804626464844
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.47525739669799805
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.47241806983947754
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5200197696685791
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.46277546882629395
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.4496574401855469
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.4228343963623047
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.5153844356536865
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.5145761966705322
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.4983789920806885
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.4352293014526367
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.43831515312194824
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.4937748908996582
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.4570183753967285
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.44184112548828125
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.4667978286743164
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4859285354614258
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.48064279556274414
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.48086118698120117
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.46082544326782227
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.50052809715271
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.46509647369384766
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5163192749023438
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5071182250976562
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.44640350341796875
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 382796
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.631354808807373
Epoch: 1, Steps: 7 | Train Loss: 2.544 Vali Loss: 2.484 Vali Acc: 0.153 Test Loss: 2.484 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.4946770668029785
Epoch: 2, Steps: 7 | Train Loss: 2.439 Vali Loss: 2.403 Vali Acc: 0.264 Test Loss: 2.403 Test Acc: 0.264
Validation loss decreased (-0.152753 --> -0.263865).  Saving model ...
Epoch: 3 cost time: 0.515031099319458
Epoch: 3, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.268 Vali Acc: 0.347 Test Loss: 2.268 Test Acc: 0.347
Validation loss decreased (-0.263865 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.529221773147583
Epoch: 4, Steps: 7 | Train Loss: 2.069 Vali Loss: 2.093 Vali Acc: 0.514 Test Loss: 2.093 Test Acc: 0.514
Validation loss decreased (-0.347200 --> -0.513868).  Saving model ...
Epoch: 5 cost time: 0.511244535446167
Epoch: 5, Steps: 7 | Train Loss: 1.842 Vali Loss: 1.878 Vali Acc: 0.722 Test Loss: 1.878 Test Acc: 0.722
Validation loss decreased (-0.513868 --> -0.722203).  Saving model ...
Epoch: 6 cost time: 0.478532075881958
Epoch: 6, Steps: 7 | Train Loss: 1.577 Vali Loss: 1.639 Vali Acc: 0.833 Test Loss: 1.639 Test Acc: 0.833
Validation loss decreased (-0.722203 --> -0.833317).  Saving model ...
Epoch: 7 cost time: 0.5114679336547852
Epoch: 7, Steps: 7 | Train Loss: 1.287 Vali Loss: 1.384 Vali Acc: 0.903 Test Loss: 1.384 Test Acc: 0.903
Validation loss decreased (-0.833317 --> -0.902764).  Saving model ...
Epoch: 8 cost time: 0.44661712646484375
Epoch: 8, Steps: 7 | Train Loss: 1.010 Vali Loss: 1.117 Vali Acc: 0.889 Test Loss: 1.117 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5119085311889648
Epoch: 9, Steps: 7 | Train Loss: 0.726 Vali Loss: 0.885 Vali Acc: 0.903 Test Loss: 0.885 Test Acc: 0.903
Validation loss decreased (-0.902764 --> -0.902769).  Saving model ...
Epoch: 10 cost time: 0.4905691146850586
Epoch: 10, Steps: 7 | Train Loss: 0.497 Vali Loss: 0.686 Vali Acc: 0.861 Test Loss: 0.686 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4964315891265869
Epoch: 11, Steps: 7 | Train Loss: 0.328 Vali Loss: 0.566 Vali Acc: 0.917 Test Loss: 0.566 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916661).  Saving model ...
Epoch: 12 cost time: 0.513181209564209
Epoch: 12, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.479 Vali Acc: 0.917 Test Loss: 0.479 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 0.5142042636871338
Epoch: 13, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 14 cost time: 0.5161066055297852
Epoch: 14, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.401 Vali Acc: 0.917 Test Loss: 0.401 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.49654650688171387
Epoch: 15, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.5049929618835449
Epoch: 16, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.5131676197052002
Epoch: 17, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.5086705684661865
Epoch: 18, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.5591866970062256
Epoch: 19, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.4877467155456543
Epoch: 20, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.46863698959350586
Epoch: 21, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.4977741241455078
Epoch: 22, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.48990559577941895
Epoch: 23, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.49149560928344727
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5416865348815918
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.47605037689208984
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.47591471672058105
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.5064659118652344
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.49933743476867676
Epoch: 29, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.5290472507476807
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.4755542278289795
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.536644697189331
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.4994807243347168
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.49907398223876953
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.4488680362701416
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.43637609481811523
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.47373390197753906
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.42043232917785645
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.502770185470581
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.5014684200286865
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.4992179870605469
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.4588150978088379
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.4712073802947998
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.5064172744750977
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5405051708221436
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.556666374206543
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.5016796588897705
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.4649784564971924
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5003244876861572
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.4784278869628906
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 368204
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7140800952911377
Epoch: 1, Steps: 7 | Train Loss: 2.474 Vali Loss: 2.463 Vali Acc: 0.125 Test Loss: 2.463 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.49459171295166016
Epoch: 2, Steps: 7 | Train Loss: 2.399 Vali Loss: 2.398 Vali Acc: 0.236 Test Loss: 2.398 Test Acc: 0.236
Validation loss decreased (-0.124975 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 0.5182042121887207
Epoch: 3, Steps: 7 | Train Loss: 2.292 Vali Loss: 2.285 Vali Acc: 0.417 Test Loss: 2.285 Test Acc: 0.417
Validation loss decreased (-0.236087 --> -0.416644).  Saving model ...
Epoch: 4 cost time: 0.47513532638549805
Epoch: 4, Steps: 7 | Train Loss: 2.102 Vali Loss: 2.133 Vali Acc: 0.611 Test Loss: 2.133 Test Acc: 0.611
Validation loss decreased (-0.416644 --> -0.611090).  Saving model ...
Epoch: 5 cost time: 0.4803147315979004
Epoch: 5, Steps: 7 | Train Loss: 1.879 Vali Loss: 1.946 Vali Acc: 0.681 Test Loss: 1.946 Test Acc: 0.681
Validation loss decreased (-0.611090 --> -0.680536).  Saving model ...
Epoch: 6 cost time: 0.5177168846130371
Epoch: 6, Steps: 7 | Train Loss: 1.672 Vali Loss: 1.740 Vali Acc: 0.778 Test Loss: 1.740 Test Acc: 0.778
Validation loss decreased (-0.680536 --> -0.777760).  Saving model ...
Epoch: 7 cost time: 0.4581284523010254
Epoch: 7, Steps: 7 | Train Loss: 1.403 Vali Loss: 1.509 Vali Acc: 0.806 Test Loss: 1.509 Test Acc: 0.806
Validation loss decreased (-0.777760 --> -0.805540).  Saving model ...
Epoch: 8 cost time: 0.4734370708465576
Epoch: 8, Steps: 7 | Train Loss: 1.136 Vali Loss: 1.263 Vali Acc: 0.806 Test Loss: 1.263 Test Acc: 0.806
Validation loss decreased (-0.805540 --> -0.805543).  Saving model ...
Epoch: 9 cost time: 0.48044800758361816
Epoch: 9, Steps: 7 | Train Loss: 0.853 Vali Loss: 1.030 Vali Acc: 0.847 Test Loss: 1.030 Test Acc: 0.847
Validation loss decreased (-0.805543 --> -0.847212).  Saving model ...
Epoch: 10 cost time: 0.5022995471954346
Epoch: 10, Steps: 7 | Train Loss: 0.637 Vali Loss: 0.851 Vali Acc: 0.847 Test Loss: 0.851 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847214).  Saving model ...
Epoch: 11 cost time: 0.49175477027893066
Epoch: 11, Steps: 7 | Train Loss: 0.442 Vali Loss: 0.697 Vali Acc: 0.847 Test Loss: 0.697 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 12 cost time: 0.47880005836486816
Epoch: 12, Steps: 7 | Train Loss: 0.300 Vali Loss: 0.598 Vali Acc: 0.889 Test Loss: 0.598 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888883).  Saving model ...
Epoch: 13 cost time: 0.47603750228881836
Epoch: 13, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.530 Vali Acc: 0.875 Test Loss: 0.530 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.48781704902648926
Epoch: 14, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4772005081176758
Epoch: 15, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.48271703720092773
Epoch: 16, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4884064197540283
Epoch: 17, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5035338401794434
Epoch: 18, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4705080986022949
Epoch: 19, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.5471827983856201
Epoch: 20, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 0.48017382621765137
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 22 cost time: 0.5037319660186768
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 23 cost time: 0.4891974925994873
Epoch: 23, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.45598936080932617
Epoch: 24, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 0.4942646026611328
Epoch: 25, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 0.4841957092285156
Epoch: 26, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 27 cost time: 0.47773313522338867
Epoch: 27, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 28 cost time: 0.4974632263183594
Epoch: 28, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.500262975692749
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 30 cost time: 0.5374124050140381
Epoch: 30, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 31 cost time: 0.48076415061950684
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 32 cost time: 0.450092077255249
Epoch: 32, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.5008504390716553
Epoch: 33, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.4807288646697998
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.5097324848175049
Epoch: 35, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.49776411056518555
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.47867655754089355
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.5322096347808838
Epoch: 38, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5030338764190674
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.48146772384643555
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.47853565216064453
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5194048881530762
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5567131042480469
Epoch: 43, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.5732512474060059
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.5380878448486328
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.5169165134429932
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 47 cost time: 0.5559000968933105
Epoch: 47, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5395684242248535
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5342426300048828
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5660319328308105
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 362828
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5780744552612305
Epoch: 1, Steps: 7 | Train Loss: 2.489 Vali Loss: 2.444 Vali Acc: 0.111 Test Loss: 2.444 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.47320103645324707
Epoch: 2, Steps: 7 | Train Loss: 2.272 Vali Loss: 2.262 Vali Acc: 0.528 Test Loss: 2.262 Test Acc: 0.528
Validation loss decreased (-0.111087 --> -0.527755).  Saving model ...
Epoch: 3 cost time: 0.44351840019226074
Epoch: 3, Steps: 7 | Train Loss: 1.913 Vali Loss: 1.947 Vali Acc: 0.833 Test Loss: 1.947 Test Acc: 0.833
Validation loss decreased (-0.527755 --> -0.833314).  Saving model ...
Epoch: 4 cost time: 0.46016502380371094
Epoch: 4, Steps: 7 | Train Loss: 1.423 Vali Loss: 1.534 Vali Acc: 0.819 Test Loss: 1.534 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.44437623023986816
Epoch: 5, Steps: 7 | Train Loss: 0.938 Vali Loss: 1.090 Vali Acc: 0.889 Test Loss: 1.090 Test Acc: 0.889
Validation loss decreased (-0.833314 --> -0.888878).  Saving model ...
Epoch: 6 cost time: 0.4834322929382324
Epoch: 6, Steps: 7 | Train Loss: 0.505 Vali Loss: 0.719 Vali Acc: 0.917 Test Loss: 0.719 Test Acc: 0.917
Validation loss decreased (-0.888878 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 0.4224834442138672
Epoch: 7, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.470 Vali Acc: 0.917 Test Loss: 0.470 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.4669034481048584
Epoch: 8, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.4795095920562744
Epoch: 9, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 10 cost time: 0.46910762786865234
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.4354238510131836
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.44500207901000977
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.45750904083251953
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.44952964782714844
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.43974971771240234
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4790811538696289
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4597952365875244
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4830148220062256
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4729795455932617
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4792811870574951
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4783668518066406
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4661977291107178
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 273132
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5405449867248535
Epoch: 1, Steps: 7 | Train Loss: 2.511 Vali Loss: 2.424 Vali Acc: 0.083 Test Loss: 2.424 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.4477982521057129
Epoch: 2, Steps: 7 | Train Loss: 2.387 Vali Loss: 2.318 Vali Acc: 0.375 Test Loss: 2.318 Test Acc: 0.375
Validation loss decreased (-0.083309 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.49868035316467285
Epoch: 3, Steps: 7 | Train Loss: 2.155 Vali Loss: 2.143 Vali Acc: 0.667 Test Loss: 2.143 Test Acc: 0.667
Validation loss decreased (-0.374977 --> -0.666645).  Saving model ...
Epoch: 4 cost time: 0.43890380859375
Epoch: 4, Steps: 7 | Train Loss: 1.871 Vali Loss: 1.895 Vali Acc: 0.778 Test Loss: 1.895 Test Acc: 0.778
Validation loss decreased (-0.666645 --> -0.777759).  Saving model ...
Epoch: 5 cost time: 0.5022554397583008
Epoch: 5, Steps: 7 | Train Loss: 1.517 Vali Loss: 1.580 Vali Acc: 0.847 Test Loss: 1.580 Test Acc: 0.847
Validation loss decreased (-0.777759 --> -0.847206).  Saving model ...
Epoch: 6 cost time: 0.43416380882263184
Epoch: 6, Steps: 7 | Train Loss: 1.166 Vali Loss: 1.239 Vali Acc: 0.875 Test Loss: 1.239 Test Acc: 0.875
Validation loss decreased (-0.847206 --> -0.874988).  Saving model ...
Epoch: 7 cost time: 0.4459998607635498
Epoch: 7, Steps: 7 | Train Loss: 0.803 Vali Loss: 0.918 Vali Acc: 0.889 Test Loss: 0.918 Test Acc: 0.889
Validation loss decreased (-0.874988 --> -0.888880).  Saving model ...
Epoch: 8 cost time: 0.46268701553344727
Epoch: 8, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.671 Vali Acc: 0.889 Test Loss: 0.671 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888882).  Saving model ...
Epoch: 9 cost time: 0.5016739368438721
Epoch: 9, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.491 Vali Acc: 0.903 Test Loss: 0.491 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 0.45775485038757324
Epoch: 10, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.5020878314971924
Epoch: 11, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.4558894634246826
Epoch: 12, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.5194497108459473
Epoch: 13, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4904289245605469
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4419066905975342
Epoch: 15, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4632084369659424
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.488631010055542
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4877614974975586
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5321366786956787
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5409286022186279
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5762777328491211
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5283463001251221
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5340054035186768
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5391886234283447
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5256154537200928
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5419049263000488
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.49948906898498535
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5395410060882568
Epoch: 28, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.46438002586364746
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.4778108596801758
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.4982123374938965
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5819904804229736
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5593996047973633
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.5749320983886719
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5366549491882324
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5721654891967773
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.48072338104248047
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.47099852561950684
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5373287200927734
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5234434604644775
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5393297672271729
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5143523216247559
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5517055988311768
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5077733993530273
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5260345935821533
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.533099889755249
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5768120288848877
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.531444787979126
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5583038330078125
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.4908442497253418
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 181932
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.670659065246582
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.476 Vali Acc: 0.097 Test Loss: 2.476 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.4557955265045166
Epoch: 2, Steps: 7 | Train Loss: 2.486 Vali Loss: 2.396 Vali Acc: 0.250 Test Loss: 2.396 Test Acc: 0.250
Validation loss decreased (-0.097197 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.4393749237060547
Epoch: 3, Steps: 7 | Train Loss: 2.329 Vali Loss: 2.265 Vali Acc: 0.403 Test Loss: 2.265 Test Acc: 0.403
Validation loss decreased (-0.249976 --> -0.402755).  Saving model ...
Epoch: 4 cost time: 0.4411296844482422
Epoch: 4, Steps: 7 | Train Loss: 2.120 Vali Loss: 2.088 Vali Acc: 0.708 Test Loss: 2.088 Test Acc: 0.708
Validation loss decreased (-0.402755 --> -0.708312).  Saving model ...
Epoch: 5 cost time: 0.4672586917877197
Epoch: 5, Steps: 7 | Train Loss: 1.888 Vali Loss: 1.868 Vali Acc: 0.764 Test Loss: 1.868 Test Acc: 0.764
Validation loss decreased (-0.708312 --> -0.763870).  Saving model ...
Epoch: 6 cost time: 0.4736900329589844
Epoch: 6, Steps: 7 | Train Loss: 1.589 Vali Loss: 1.593 Vali Acc: 0.819 Test Loss: 1.593 Test Acc: 0.819
Validation loss decreased (-0.763870 --> -0.819429).  Saving model ...
Epoch: 7 cost time: 0.4471702575683594
Epoch: 7, Steps: 7 | Train Loss: 1.281 Vali Loss: 1.307 Vali Acc: 0.889 Test Loss: 1.307 Test Acc: 0.889
Validation loss decreased (-0.819429 --> -0.888876).  Saving model ...
Epoch: 8 cost time: 0.47487783432006836
Epoch: 8, Steps: 7 | Train Loss: 0.970 Vali Loss: 1.013 Vali Acc: 0.903 Test Loss: 1.013 Test Acc: 0.903
Validation loss decreased (-0.888876 --> -0.902768).  Saving model ...
Epoch: 9 cost time: 0.43750548362731934
Epoch: 9, Steps: 7 | Train Loss: 0.661 Vali Loss: 0.762 Vali Acc: 0.944 Test Loss: 0.762 Test Acc: 0.944
Validation loss decreased (-0.902768 --> -0.944437).  Saving model ...
Epoch: 10 cost time: 0.46106982231140137
Epoch: 10, Steps: 7 | Train Loss: 0.428 Vali Loss: 0.556 Vali Acc: 0.931 Test Loss: 0.556 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45879149436950684
Epoch: 11, Steps: 7 | Train Loss: 0.253 Vali Loss: 0.435 Vali Acc: 0.931 Test Loss: 0.435 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.46105051040649414
Epoch: 12, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.364 Vali Acc: 0.931 Test Loss: 0.364 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.46915698051452637
Epoch: 13, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4782531261444092
Epoch: 14, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.47163844108581543
Epoch: 15, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.47487449645996094
Epoch: 16, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.44291210174560547
Epoch: 17, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4467177391052246
Epoch: 18, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.42313313484191895
Epoch: 19, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 150636
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7113981246948242
Epoch: 1, Steps: 7 | Train Loss: 2.494 Vali Loss: 2.452 Vali Acc: 0.097 Test Loss: 2.452 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.4493827819824219
Epoch: 2, Steps: 7 | Train Loss: 2.410 Vali Loss: 2.368 Vali Acc: 0.139 Test Loss: 2.368 Test Acc: 0.139
Validation loss decreased (-0.097198 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 0.4720313549041748
Epoch: 3, Steps: 7 | Train Loss: 2.271 Vali Loss: 2.237 Vali Acc: 0.347 Test Loss: 2.237 Test Acc: 0.347
Validation loss decreased (-0.138865 --> -0.347200).  Saving model ...
Epoch: 4 cost time: 0.49320268630981445
Epoch: 4, Steps: 7 | Train Loss: 2.084 Vali Loss: 2.065 Vali Acc: 0.583 Test Loss: 2.065 Test Acc: 0.583
Validation loss decreased (-0.347200 --> -0.583313).  Saving model ...
Epoch: 5 cost time: 0.4720468521118164
Epoch: 5, Steps: 7 | Train Loss: 1.851 Vali Loss: 1.855 Vali Acc: 0.708 Test Loss: 1.855 Test Acc: 0.708
Validation loss decreased (-0.583313 --> -0.708315).  Saving model ...
Epoch: 6 cost time: 0.4474492073059082
Epoch: 6, Steps: 7 | Train Loss: 1.611 Vali Loss: 1.600 Vali Acc: 0.847 Test Loss: 1.600 Test Acc: 0.847
Validation loss decreased (-0.708315 --> -0.847206).  Saving model ...
Epoch: 7 cost time: 0.485062837600708
Epoch: 7, Steps: 7 | Train Loss: 1.327 Vali Loss: 1.339 Vali Acc: 0.861 Test Loss: 1.339 Test Acc: 0.861
Validation loss decreased (-0.847206 --> -0.861098).  Saving model ...
Epoch: 8 cost time: 0.488955020904541
Epoch: 8, Steps: 7 | Train Loss: 1.038 Vali Loss: 1.087 Vali Acc: 0.889 Test Loss: 1.087 Test Acc: 0.889
Validation loss decreased (-0.861098 --> -0.888878).  Saving model ...
Epoch: 9 cost time: 0.4544639587402344
Epoch: 9, Steps: 7 | Train Loss: 0.765 Vali Loss: 0.856 Vali Acc: 0.889 Test Loss: 0.856 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888880).  Saving model ...
Epoch: 10 cost time: 0.5068471431732178
Epoch: 10, Steps: 7 | Train Loss: 0.535 Vali Loss: 0.668 Vali Acc: 0.917 Test Loss: 0.668 Test Acc: 0.917
Validation loss decreased (-0.888880 --> -0.916660).  Saving model ...
Epoch: 11 cost time: 0.4575843811035156
Epoch: 11, Steps: 7 | Train Loss: 0.348 Vali Loss: 0.535 Vali Acc: 0.917 Test Loss: 0.535 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916661).  Saving model ...
Epoch: 12 cost time: 0.4718022346496582
Epoch: 12, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.439 Vali Acc: 0.917 Test Loss: 0.439 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 0.47954249382019043
Epoch: 13, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.53578782081604
Epoch: 14, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 0.48041749000549316
Epoch: 15, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4669175148010254
Epoch: 16, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.4620933532714844
Epoch: 17, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.4542231559753418
Epoch: 18, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.46155357360839844
Epoch: 19, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.4572570323944092
Epoch: 20, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.4681284427642822
Epoch: 21, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5090136528015137
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.45774126052856445
Epoch: 23, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.48929476737976074
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.49919557571411133
Epoch: 25, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4726722240447998
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.44211792945861816
Epoch: 27, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5973775386810303
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.4519822597503662
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.4605062007904053
Epoch: 30, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.46241283416748047
Epoch: 31, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5067384243011475
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.4409468173980713
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.43978214263916016
Epoch: 34, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.452528715133667
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.4391448497772217
Epoch: 36, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.4616124629974365
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.45458388328552246
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.4663560390472412
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.44709038734436035
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4319031238555908
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4680061340332031
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5412464141845703
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.45255041122436523
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5108978748321533
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.4710652828216553
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.42948460578918457
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5378386974334717
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4759485721588135
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.42473435401916504
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 137772
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5239019393920898
Epoch: 1, Steps: 7 | Train Loss: 2.496 Vali Loss: 2.477 Vali Acc: 0.111 Test Loss: 2.477 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.4451420307159424
Epoch: 2, Steps: 7 | Train Loss: 2.441 Vali Loss: 2.424 Vali Acc: 0.153 Test Loss: 2.424 Test Acc: 0.153
Validation loss decreased (-0.111086 --> -0.152754).  Saving model ...
Epoch: 3 cost time: 0.44063472747802734
Epoch: 3, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.333 Vali Acc: 0.264 Test Loss: 2.333 Test Acc: 0.264
Validation loss decreased (-0.152754 --> -0.263866).  Saving model ...
Epoch: 4 cost time: 0.48137712478637695
Epoch: 4, Steps: 7 | Train Loss: 2.194 Vali Loss: 2.204 Vali Acc: 0.375 Test Loss: 2.204 Test Acc: 0.375
Validation loss decreased (-0.263866 --> -0.374978).  Saving model ...
Epoch: 5 cost time: 0.4758880138397217
Epoch: 5, Steps: 7 | Train Loss: 2.041 Vali Loss: 2.036 Vali Acc: 0.556 Test Loss: 2.036 Test Acc: 0.556
Validation loss decreased (-0.374978 --> -0.555535).  Saving model ...
Epoch: 6 cost time: 0.5038235187530518
Epoch: 6, Steps: 7 | Train Loss: 1.839 Vali Loss: 1.840 Vali Acc: 0.625 Test Loss: 1.840 Test Acc: 0.625
Validation loss decreased (-0.555535 --> -0.624982).  Saving model ...
Epoch: 7 cost time: 0.44606876373291016
Epoch: 7, Steps: 7 | Train Loss: 1.622 Vali Loss: 1.625 Vali Acc: 0.764 Test Loss: 1.625 Test Acc: 0.764
Validation loss decreased (-0.624982 --> -0.763873).  Saving model ...
Epoch: 8 cost time: 0.4844040870666504
Epoch: 8, Steps: 7 | Train Loss: 1.390 Vali Loss: 1.385 Vali Acc: 0.819 Test Loss: 1.385 Test Acc: 0.819
Validation loss decreased (-0.763873 --> -0.819431).  Saving model ...
Epoch: 9 cost time: 0.4422488212585449
Epoch: 9, Steps: 7 | Train Loss: 1.126 Vali Loss: 1.157 Vali Acc: 0.875 Test Loss: 1.157 Test Acc: 0.875
Validation loss decreased (-0.819431 --> -0.874988).  Saving model ...
Epoch: 10 cost time: 0.46822643280029297
Epoch: 10, Steps: 7 | Train Loss: 0.874 Vali Loss: 0.944 Vali Acc: 0.903 Test Loss: 0.944 Test Acc: 0.903
Validation loss decreased (-0.874988 --> -0.902768).  Saving model ...
Epoch: 11 cost time: 0.4321105480194092
Epoch: 11, Steps: 7 | Train Loss: 0.673 Vali Loss: 0.754 Vali Acc: 0.903 Test Loss: 0.754 Test Acc: 0.903
Validation loss decreased (-0.902768 --> -0.902770).  Saving model ...
Epoch: 12 cost time: 0.48012375831604004
Epoch: 12, Steps: 7 | Train Loss: 0.470 Vali Loss: 0.604 Vali Acc: 0.931 Test Loss: 0.604 Test Acc: 0.931
Validation loss decreased (-0.902770 --> -0.930550).  Saving model ...
Epoch: 13 cost time: 0.4476742744445801
Epoch: 13, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.488 Vali Acc: 0.931 Test Loss: 0.488 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 14 cost time: 0.4884626865386963
Epoch: 14, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.412 Vali Acc: 0.944 Test Loss: 0.412 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944440).  Saving model ...
Epoch: 15 cost time: 0.47991228103637695
Epoch: 15, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.48898959159851074
Epoch: 16, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.48610448837280273
Epoch: 17, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.4307570457458496
Epoch: 18, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.45992565155029297
Epoch: 19, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.4940938949584961
Epoch: 20, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5371155738830566
Epoch: 21, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.4803812503814697
Epoch: 22, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.4774467945098877
Epoch: 23, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.4952824115753174
Epoch: 24, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5110316276550293
Epoch: 25, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.48477745056152344
Epoch: 26, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4864840507507324
Epoch: 27, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5196971893310547
Epoch: 28, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.4653353691101074
Epoch: 29, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.4495375156402588
Epoch: 30, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.46108126640319824
Epoch: 31, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.46612048149108887
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.44031381607055664
Epoch: 33, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.4685671329498291
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.439746618270874
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.4788362979888916
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.453777551651001
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.4730722904205322
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.4485297203063965
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.47002506256103516
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.43567824363708496
Epoch: 41, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.4943869113922119
Epoch: 42, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.4497368335723877
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5136611461639404
Epoch: 44, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.4339487552642822
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.4884836673736572
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.4808335304260254
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5935828685760498
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.5132834911346436
Epoch: 49, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5012011528015137
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 125868
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5935311317443848
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.464 Vali Acc: 0.153 Test Loss: 2.464 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.40229177474975586
Epoch: 2, Steps: 7 | Train Loss: 2.471 Vali Loss: 2.417 Vali Acc: 0.250 Test Loss: 2.417 Test Acc: 0.250
Validation loss decreased (-0.152753 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.5073142051696777
Epoch: 3, Steps: 7 | Train Loss: 2.373 Vali Loss: 2.337 Vali Acc: 0.306 Test Loss: 2.337 Test Acc: 0.306
Validation loss decreased (-0.249976 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 0.4458754062652588
Epoch: 4, Steps: 7 | Train Loss: 2.282 Vali Loss: 2.231 Vali Acc: 0.431 Test Loss: 2.231 Test Acc: 0.431
Validation loss decreased (-0.305532 --> -0.430533).  Saving model ...
Epoch: 5 cost time: 0.41304492950439453
Epoch: 5, Steps: 7 | Train Loss: 2.129 Vali Loss: 2.095 Vali Acc: 0.528 Test Loss: 2.095 Test Acc: 0.528
Validation loss decreased (-0.430533 --> -0.527757).  Saving model ...
Epoch: 6 cost time: 0.48461222648620605
Epoch: 6, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.939 Vali Acc: 0.681 Test Loss: 1.939 Test Acc: 0.681
Validation loss decreased (-0.527757 --> -0.680536).  Saving model ...
Epoch: 7 cost time: 0.46255946159362793
Epoch: 7, Steps: 7 | Train Loss: 1.802 Vali Loss: 1.766 Vali Acc: 0.736 Test Loss: 1.766 Test Acc: 0.736
Validation loss decreased (-0.680536 --> -0.736093).  Saving model ...
Epoch: 8 cost time: 0.4493868350982666
Epoch: 8, Steps: 7 | Train Loss: 1.604 Vali Loss: 1.577 Vali Acc: 0.722 Test Loss: 1.577 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4438958168029785
Epoch: 9, Steps: 7 | Train Loss: 1.382 Vali Loss: 1.380 Vali Acc: 0.764 Test Loss: 1.380 Test Acc: 0.764
Validation loss decreased (-0.736093 --> -0.763875).  Saving model ...
Epoch: 10 cost time: 0.4389026165008545
Epoch: 10, Steps: 7 | Train Loss: 1.198 Vali Loss: 1.189 Vali Acc: 0.847 Test Loss: 1.189 Test Acc: 0.847
Validation loss decreased (-0.763875 --> -0.847210).  Saving model ...
Epoch: 11 cost time: 0.4601914882659912
Epoch: 11, Steps: 7 | Train Loss: 0.982 Vali Loss: 1.011 Vali Acc: 0.875 Test Loss: 1.011 Test Acc: 0.875
Validation loss decreased (-0.847210 --> -0.874990).  Saving model ...
Epoch: 12 cost time: 0.4562675952911377
Epoch: 12, Steps: 7 | Train Loss: 0.797 Vali Loss: 0.862 Vali Acc: 0.875 Test Loss: 0.862 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.40352678298950195
Epoch: 13, Steps: 7 | Train Loss: 0.634 Vali Loss: 0.732 Vali Acc: 0.875 Test Loss: 0.732 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.48999476432800293
Epoch: 14, Steps: 7 | Train Loss: 0.491 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.49155473709106445
Epoch: 15, Steps: 7 | Train Loss: 0.378 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 0.48673415184020996
Epoch: 16, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 0.4690251350402832
Epoch: 17, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.4264829158782959
Epoch: 18, Steps: 7 | Train Loss: 0.167 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 19 cost time: 0.4451780319213867
Epoch: 19, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.4376497268676758
Epoch: 20, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.47701597213745117
Epoch: 21, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4375936985015869
Epoch: 22, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5022170543670654
Epoch: 23, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4381389617919922
Epoch: 24, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5140860080718994
Epoch: 25, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.4479641914367676
Epoch: 26, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.4305384159088135
Epoch: 27, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5257377624511719
Epoch: 28, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5181829929351807
Epoch: 29, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.45270442962646484
Epoch: 30, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4422640800476074
Epoch: 31, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4542872905731201
Epoch: 32, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4000115394592285
Epoch: 33, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.41411757469177246
Epoch: 34, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.44310545921325684
Epoch: 35, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.4555788040161133
Epoch: 36, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.44686365127563477
Epoch: 37, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.45287418365478516
Epoch: 38, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.43320441246032715
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.447251558303833
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.46553778648376465
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4481971263885498
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.43657469749450684
Epoch: 43, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.44670677185058594
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.4156200885772705
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.41332554817199707
Epoch: 46, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4414236545562744
Epoch: 47, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.4904491901397705
Epoch: 48, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.44374775886535645
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.43956685066223145
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 118572
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5701680183410645
Epoch: 1, Steps: 7 | Train Loss: 2.465 Vali Loss: 2.499 Vali Acc: 0.125 Test Loss: 2.499 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.48682284355163574
Epoch: 2, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.457 Vali Acc: 0.194 Test Loss: 2.457 Test Acc: 0.194
Validation loss decreased (-0.124975 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.4687530994415283
Epoch: 3, Steps: 7 | Train Loss: 2.365 Vali Loss: 2.386 Vali Acc: 0.306 Test Loss: 2.386 Test Acc: 0.306
Validation loss decreased (-0.194420 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 0.4112210273742676
Epoch: 4, Steps: 7 | Train Loss: 2.267 Vali Loss: 2.292 Vali Acc: 0.389 Test Loss: 2.292 Test Acc: 0.389
Validation loss decreased (-0.305532 --> -0.388866).  Saving model ...
Epoch: 5 cost time: 0.4231703281402588
Epoch: 5, Steps: 7 | Train Loss: 2.152 Vali Loss: 2.181 Vali Acc: 0.528 Test Loss: 2.181 Test Acc: 0.528
Validation loss decreased (-0.388866 --> -0.527756).  Saving model ...
Epoch: 6 cost time: 0.42244505882263184
Epoch: 6, Steps: 7 | Train Loss: 2.000 Vali Loss: 2.046 Vali Acc: 0.611 Test Loss: 2.046 Test Acc: 0.611
Validation loss decreased (-0.527756 --> -0.611091).  Saving model ...
Epoch: 7 cost time: 0.4154222011566162
Epoch: 7, Steps: 7 | Train Loss: 1.841 Vali Loss: 1.892 Vali Acc: 0.681 Test Loss: 1.892 Test Acc: 0.681
Validation loss decreased (-0.611091 --> -0.680537).  Saving model ...
Epoch: 8 cost time: 0.4426536560058594
Epoch: 8, Steps: 7 | Train Loss: 1.670 Vali Loss: 1.723 Vali Acc: 0.708 Test Loss: 1.723 Test Acc: 0.708
Validation loss decreased (-0.680537 --> -0.708316).  Saving model ...
Epoch: 9 cost time: 0.45302557945251465
Epoch: 9, Steps: 7 | Train Loss: 1.476 Vali Loss: 1.535 Vali Acc: 0.764 Test Loss: 1.535 Test Acc: 0.764
Validation loss decreased (-0.708316 --> -0.763874).  Saving model ...
Epoch: 10 cost time: 0.4582223892211914
Epoch: 10, Steps: 7 | Train Loss: 1.296 Vali Loss: 1.358 Vali Acc: 0.792 Test Loss: 1.358 Test Acc: 0.792
Validation loss decreased (-0.763874 --> -0.791653).  Saving model ...
Epoch: 11 cost time: 0.44069576263427734
Epoch: 11, Steps: 7 | Train Loss: 1.092 Vali Loss: 1.196 Vali Acc: 0.833 Test Loss: 1.196 Test Acc: 0.833
Validation loss decreased (-0.791653 --> -0.833321).  Saving model ...
Epoch: 12 cost time: 0.4624788761138916
Epoch: 12, Steps: 7 | Train Loss: 0.897 Vali Loss: 1.026 Vali Acc: 0.833 Test Loss: 1.026 Test Acc: 0.833
Validation loss decreased (-0.833321 --> -0.833323).  Saving model ...
Epoch: 13 cost time: 0.47774696350097656
Epoch: 13, Steps: 7 | Train Loss: 0.727 Vali Loss: 0.883 Vali Acc: 0.847 Test Loss: 0.883 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847213).  Saving model ...
Epoch: 14 cost time: 0.5334300994873047
Epoch: 14, Steps: 7 | Train Loss: 0.579 Vali Loss: 0.772 Vali Acc: 0.847 Test Loss: 0.772 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847215).  Saving model ...
Epoch: 15 cost time: 0.4291079044342041
Epoch: 15, Steps: 7 | Train Loss: 0.437 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5060067176818848
Epoch: 16, Steps: 7 | Train Loss: 0.366 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847216).  Saving model ...
Epoch: 17 cost time: 0.5091028213500977
Epoch: 17, Steps: 7 | Train Loss: 0.291 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.4731919765472412
Epoch: 18, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.47596096992492676
Epoch: 19, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5223870277404785
Epoch: 20, Steps: 7 | Train Loss: 0.156 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.48593926429748535
Epoch: 21, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.42457079887390137
Epoch: 22, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.528618574142456
Epoch: 23, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4705684185028076
Epoch: 24, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 0.46077442169189453
Epoch: 25, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 0.44806385040283203
Epoch: 26, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 0.45696091651916504
Epoch: 27, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.397 Vali Acc: 0.903 Test Loss: 0.397 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.469393253326416
Epoch: 28, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5205910205841064
Epoch: 29, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4805443286895752
Epoch: 30, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.45548057556152344
Epoch: 31, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4622018337249756
Epoch: 32, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.44293642044067383
Epoch: 33, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.46781182289123535
Epoch: 34, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.45169663429260254
Epoch: 35, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5532488822937012
Epoch: 36, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.44814538955688477
Epoch: 37, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 115884
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7943708896636963
Epoch: 1, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.302 Vali Acc: 0.514 Test Loss: 2.302 Test Acc: 0.514
Validation loss decreased (inf --> -0.513866).  Saving model ...
Epoch: 2 cost time: 0.6448523998260498
Epoch: 2, Steps: 7 | Train Loss: 1.763 Vali Loss: 1.552 Vali Acc: 0.833 Test Loss: 1.552 Test Acc: 0.833
Validation loss decreased (-0.513866 --> -0.833318).  Saving model ...
Epoch: 3 cost time: 0.6383781433105469
Epoch: 3, Steps: 7 | Train Loss: 0.681 Vali Loss: 0.731 Vali Acc: 0.944 Test Loss: 0.731 Test Acc: 0.944
Validation loss decreased (-0.833318 --> -0.944437).  Saving model ...
Epoch: 4 cost time: 0.6218805313110352
Epoch: 4, Steps: 7 | Train Loss: 0.138 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6234047412872314
Epoch: 5, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6157715320587158
Epoch: 6, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6057026386260986
Epoch: 7, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6329083442687988
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.620394229888916
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6543412208557129
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6045310497283936
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6397883892059326
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944437 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.5796024799346924
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6941919326782227
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.6293716430664062
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6050338745117188
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7010705471038818
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.6497738361358643
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5912613868713379
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5640742778778076
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.6056900024414062
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.6373374462127686
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6387178897857666
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.6591041088104248
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.5025765895843506
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.6276922225952148
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.6408019065856934
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.5850749015808105
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.6151702404022217
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.6646263599395752
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.5724890232086182
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.6183478832244873
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.5691812038421631
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.5622551441192627
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.5885410308837891
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.6255238056182861
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.5831692218780518
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.6231305599212646
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.5921590328216553
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.5404443740844727
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.5072715282440186
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.5458221435546875
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.5748841762542725
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.519644021987915
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.5221805572509766
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.5619592666625977
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.5487418174743652
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.6424639225006104
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6340570449829102
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.6390769481658936
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1869708
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6495933532714844
Epoch: 1, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.383 Vali Acc: 0.167 Test Loss: 2.383 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.5052914619445801
Epoch: 2, Steps: 7 | Train Loss: 2.082 Vali Loss: 1.916 Vali Acc: 0.792 Test Loss: 1.916 Test Acc: 0.792
Validation loss decreased (-0.166643 --> -0.791648).  Saving model ...
Epoch: 3 cost time: 0.5588560104370117
Epoch: 3, Steps: 7 | Train Loss: 1.261 Vali Loss: 1.224 Vali Acc: 0.917 Test Loss: 1.224 Test Acc: 0.917
Validation loss decreased (-0.791648 --> -0.916654).  Saving model ...
Epoch: 4 cost time: 0.5112709999084473
Epoch: 4, Steps: 7 | Train Loss: 0.547 Vali Loss: 0.661 Vali Acc: 0.931 Test Loss: 0.661 Test Acc: 0.931
Validation loss decreased (-0.916654 --> -0.930549).  Saving model ...
Epoch: 5 cost time: 0.5460834503173828
Epoch: 5, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.340 Vali Acc: 0.931 Test Loss: 0.340 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 0.5429337024688721
Epoch: 6, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5160582065582275
Epoch: 7, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.5264153480529785
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5134127140045166
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5019047260284424
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4898264408111572
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.49172544479370117
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5290749073028564
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5652360916137695
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5090823173522949
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.4650301933288574
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.45821595191955566
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.464519739151001
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.47294139862060547
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5382356643676758
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5023024082183838
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5510940551757812
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.49672532081604004
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5268058776855469
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.5125772953033447
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.5256602764129639
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.5193815231323242
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5130167007446289
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4891183376312256
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5032188892364502
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5353398323059082
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5315215587615967
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5292420387268066
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5199952125549316
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5234434604644775
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5010600090026855
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.4785747528076172
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.47210216522216797
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5245144367218018
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5270681381225586
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.555187463760376
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5151777267456055
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5458886623382568
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.520146369934082
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4978463649749756
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.470522403717041
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5180113315582275
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4841001033782959
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.47515225410461426
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.47167110443115234
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1504908
model size : 5.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6560571193695068
Epoch: 1, Steps: 7 | Train Loss: 2.473 Vali Loss: 2.371 Vali Acc: 0.236 Test Loss: 2.371 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.44436168670654297
Epoch: 2, Steps: 7 | Train Loss: 2.167 Vali Loss: 2.047 Vali Acc: 0.750 Test Loss: 2.047 Test Acc: 0.750
Validation loss decreased (-0.236087 --> -0.749980).  Saving model ...
Epoch: 3 cost time: 0.5195293426513672
Epoch: 3, Steps: 7 | Train Loss: 1.583 Vali Loss: 1.530 Vali Acc: 0.875 Test Loss: 1.530 Test Acc: 0.875
Validation loss decreased (-0.749980 --> -0.874985).  Saving model ...
Epoch: 4 cost time: 0.4856085777282715
Epoch: 4, Steps: 7 | Train Loss: 0.926 Vali Loss: 0.957 Vali Acc: 0.903 Test Loss: 0.957 Test Acc: 0.903
Validation loss decreased (-0.874985 --> -0.902768).  Saving model ...
Epoch: 5 cost time: 0.5003542900085449
Epoch: 5, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.554 Vali Acc: 0.917 Test Loss: 0.554 Test Acc: 0.917
Validation loss decreased (-0.902768 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 0.499772310256958
Epoch: 6, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.4726986885070801
Epoch: 7, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.5247862339019775
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.5563604831695557
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5295348167419434
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5036642551422119
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.5196564197540283
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.553168535232544
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.537848711013794
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5371043682098389
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5633001327514648
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.5271468162536621
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5353972911834717
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5011827945709229
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4975931644439697
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.5144069194793701
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.4862937927246094
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.49703454971313477
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.5231919288635254
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5215566158294678
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5092618465423584
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5018646717071533
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5239713191986084
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5076053142547607
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5236570835113525
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5364675521850586
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.5018084049224854
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.4957606792449951
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.48564743995666504
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.4948232173919678
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.5119786262512207
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.5270788669586182
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.5535759925842285
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.5182790756225586
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.5270445346832275
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5180833339691162
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.49523496627807617
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4900853633880615
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5890598297119141
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4591193199157715
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5134375095367432
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.45835328102111816
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.47867655754089355
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.4807286262512207
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.4987635612487793
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1379724
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.534195899963379
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.422 Vali Acc: 0.181 Test Loss: 2.422 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.5060555934906006
Epoch: 2, Steps: 7 | Train Loss: 2.262 Vali Loss: 2.184 Vali Acc: 0.583 Test Loss: 2.184 Test Acc: 0.583
Validation loss decreased (-0.180531 --> -0.583311).  Saving model ...
Epoch: 3 cost time: 0.5575459003448486
Epoch: 3, Steps: 7 | Train Loss: 1.807 Vali Loss: 1.806 Vali Acc: 0.861 Test Loss: 1.806 Test Acc: 0.861
Validation loss decreased (-0.583311 --> -0.861093).  Saving model ...
Epoch: 4 cost time: 0.5024452209472656
Epoch: 4, Steps: 7 | Train Loss: 1.253 Vali Loss: 1.300 Vali Acc: 0.889 Test Loss: 1.300 Test Acc: 0.889
Validation loss decreased (-0.861093 --> -0.888876).  Saving model ...
Epoch: 5 cost time: 0.4855232238769531
Epoch: 5, Steps: 7 | Train Loss: 0.680 Vali Loss: 0.807 Vali Acc: 0.875 Test Loss: 0.807 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5495624542236328
Epoch: 6, Steps: 7 | Train Loss: 0.292 Vali Loss: 0.491 Vali Acc: 0.903 Test Loss: 0.491 Test Acc: 0.903
Validation loss decreased (-0.888876 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.5181934833526611
Epoch: 7, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
Validation loss decreased (-0.902773 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 0.46343326568603516
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.5076403617858887
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5238220691680908
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5323173999786377
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5838973522186279
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.4796864986419678
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.4499797821044922
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.45795392990112305
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5179529190063477
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.46302199363708496
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4860098361968994
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5231783390045166
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.4715428352355957
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5302817821502686
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.4998283386230469
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5017614364624023
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5407888889312744
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.5054187774658203
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5445330142974854
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5202105045318604
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.5464637279510498
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.4958491325378418
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5313394069671631
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.5387563705444336
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4877188205718994
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4740009307861328
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.4800896644592285
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.4519009590148926
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.613823413848877
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5561583042144775
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.4834885597229004
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.539858341217041
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5009398460388184
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5060782432556152
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4985330104827881
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.4881913661956787
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.48932862281799316
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5705397129058838
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.5156066417694092
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5170783996582031
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5081770420074463
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.45955801010131836
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.46753740310668945
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1328268
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5642359256744385
Epoch: 1, Steps: 7 | Train Loss: 2.539 Vali Loss: 2.453 Vali Acc: 0.069 Test Loss: 2.453 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.5406942367553711
Epoch: 2, Steps: 7 | Train Loss: 2.361 Vali Loss: 2.264 Vali Acc: 0.514 Test Loss: 2.264 Test Acc: 0.514
Validation loss decreased (-0.069420 --> -0.513866).  Saving model ...
Epoch: 3 cost time: 0.51289963722229
Epoch: 3, Steps: 7 | Train Loss: 1.991 Vali Loss: 1.947 Vali Acc: 0.792 Test Loss: 1.947 Test Acc: 0.792
Validation loss decreased (-0.513866 --> -0.791647).  Saving model ...
Epoch: 4 cost time: 0.49838900566101074
Epoch: 4, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.524 Vali Acc: 0.847 Test Loss: 1.524 Test Acc: 0.847
Validation loss decreased (-0.791647 --> -0.847207).  Saving model ...
Epoch: 5 cost time: 0.5209801197052002
Epoch: 5, Steps: 7 | Train Loss: 1.019 Vali Loss: 1.069 Vali Acc: 0.917 Test Loss: 1.069 Test Acc: 0.917
Validation loss decreased (-0.847207 --> -0.916656).  Saving model ...
Epoch: 6 cost time: 0.4842524528503418
Epoch: 6, Steps: 7 | Train Loss: 0.578 Vali Loss: 0.673 Vali Acc: 0.944 Test Loss: 0.673 Test Acc: 0.944
Validation loss decreased (-0.916656 --> -0.944438).  Saving model ...
Epoch: 7 cost time: 0.49615907669067383
Epoch: 7, Steps: 7 | Train Loss: 0.271 Vali Loss: 0.451 Vali Acc: 0.944 Test Loss: 0.451 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 0.49099206924438477
Epoch: 8, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.327 Vali Acc: 0.972 Test Loss: 0.327 Test Acc: 0.972
Validation loss decreased (-0.944440 --> -0.972219).  Saving model ...
Epoch: 9 cost time: 0.4598257541656494
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.273 Vali Acc: 0.972 Test Loss: 0.273 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 10 cost time: 0.5860893726348877
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.251 Vali Acc: 0.972 Test Loss: 0.251 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972220).  Saving model ...
Epoch: 11 cost time: 0.5071210861206055
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.972 Test Loss: 0.237 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 12 cost time: 0.5260400772094727
Epoch: 12, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5311534404754639
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5297296047210693
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5021183490753174
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5312814712524414
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5235123634338379
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.5017235279083252
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5130729675292969
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5016884803771973
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5708403587341309
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.531317949295044
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5225591659545898
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5219662189483643
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5255661010742188
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5196094512939453
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4968414306640625
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 1280652
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5766983032226562
Epoch: 1, Steps: 7 | Train Loss: 2.510 Vali Loss: 2.455 Vali Acc: 0.097 Test Loss: 2.455 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.47683215141296387
Epoch: 2, Steps: 7 | Train Loss: 2.333 Vali Loss: 2.282 Vali Acc: 0.403 Test Loss: 2.282 Test Acc: 0.403
Validation loss decreased (-0.097198 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.5152151584625244
Epoch: 3, Steps: 7 | Train Loss: 2.012 Vali Loss: 2.004 Vali Acc: 0.806 Test Loss: 2.004 Test Acc: 0.806
Validation loss decreased (-0.402755 --> -0.805536).  Saving model ...
Epoch: 4 cost time: 0.4564087390899658
Epoch: 4, Steps: 7 | Train Loss: 1.599 Vali Loss: 1.647 Vali Acc: 0.889 Test Loss: 1.647 Test Acc: 0.889
Validation loss decreased (-0.805536 --> -0.888872).  Saving model ...
Epoch: 5 cost time: 0.47224903106689453
Epoch: 5, Steps: 7 | Train Loss: 1.177 Vali Loss: 1.249 Vali Acc: 0.931 Test Loss: 1.249 Test Acc: 0.931
Validation loss decreased (-0.888872 --> -0.930543).  Saving model ...
Epoch: 6 cost time: 0.47731900215148926
Epoch: 6, Steps: 7 | Train Loss: 0.759 Vali Loss: 0.863 Vali Acc: 0.875 Test Loss: 0.863 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.48311948776245117
Epoch: 7, Steps: 7 | Train Loss: 0.421 Vali Loss: 0.567 Vali Acc: 0.931 Test Loss: 0.567 Test Acc: 0.931
Validation loss decreased (-0.930543 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.4481065273284912
Epoch: 8, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.423 Vali Acc: 0.917 Test Loss: 0.423 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5009844303131104
Epoch: 9, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.370 Vali Acc: 0.931 Test Loss: 0.370 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.5034983158111572
Epoch: 10, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.5183837413787842
Epoch: 11, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5135509967803955
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.49695324897766113
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.5241527557373047
Epoch: 14, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5054521560668945
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5129880905151367
Epoch: 16, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.4840359687805176
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4867546558380127
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.4866058826446533
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.500192403793335
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.5212633609771729
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5274703502655029
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5055937767028809
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.46446800231933594
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4756791591644287
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5050671100616455
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5380518436431885
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4805784225463867
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.46197032928466797
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.5286829471588135
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.476639986038208
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5135412216186523
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.45017242431640625
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.4590301513671875
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.50350022315979
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.47693943977355957
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.551398754119873
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.44753217697143555
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.4972236156463623
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.533780574798584
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5458855628967285
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.505742073059082
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5099987983703613
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5392856597900391
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.4976694583892822
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.47660279273986816
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4968397617340088
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5066714286804199
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5027565956115723
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5251390933990479
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1251468
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.585752010345459
Epoch: 1, Steps: 7 | Train Loss: 2.428 Vali Loss: 2.412 Vali Acc: 0.194 Test Loss: 2.412 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.530731201171875
Epoch: 2, Steps: 7 | Train Loss: 2.293 Vali Loss: 2.261 Vali Acc: 0.458 Test Loss: 2.261 Test Acc: 0.458
Validation loss decreased (-0.194420 --> -0.458311).  Saving model ...
Epoch: 3 cost time: 0.474597692489624
Epoch: 3, Steps: 7 | Train Loss: 2.031 Vali Loss: 2.014 Vali Acc: 0.750 Test Loss: 2.014 Test Acc: 0.750
Validation loss decreased (-0.458311 --> -0.749980).  Saving model ...
Epoch: 4 cost time: 0.5093016624450684
Epoch: 4, Steps: 7 | Train Loss: 1.695 Vali Loss: 1.697 Vali Acc: 0.847 Test Loss: 1.697 Test Acc: 0.847
Validation loss decreased (-0.749980 --> -0.847205).  Saving model ...
Epoch: 5 cost time: 0.5196342468261719
Epoch: 5, Steps: 7 | Train Loss: 1.302 Vali Loss: 1.338 Vali Acc: 0.875 Test Loss: 1.338 Test Acc: 0.875
Validation loss decreased (-0.847205 --> -0.874987).  Saving model ...
Epoch: 6 cost time: 0.5105674266815186
Epoch: 6, Steps: 7 | Train Loss: 0.915 Vali Loss: 0.992 Vali Acc: 0.903 Test Loss: 0.992 Test Acc: 0.903
Validation loss decreased (-0.874987 --> -0.902768).  Saving model ...
Epoch: 7 cost time: 0.47801637649536133
Epoch: 7, Steps: 7 | Train Loss: 0.583 Vali Loss: 0.709 Vali Acc: 0.889 Test Loss: 0.709 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49358582496643066
Epoch: 8, Steps: 7 | Train Loss: 0.333 Vali Loss: 0.519 Vali Acc: 0.931 Test Loss: 0.519 Test Acc: 0.931
Validation loss decreased (-0.902768 --> -0.930550).  Saving model ...
Epoch: 9 cost time: 0.42491745948791504
Epoch: 9, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5018088817596436
Epoch: 10, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5176653861999512
Epoch: 11, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49164891242980957
Epoch: 12, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5103492736816406
Epoch: 13, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5152232646942139
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.47868943214416504
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4626760482788086
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.49584412574768066
Epoch: 17, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4790382385253906
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 1240716
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.6032989025115967
Epoch: 1, Steps: 7 | Train Loss: 2.489 Vali Loss: 2.411 Vali Acc: 0.208 Test Loss: 2.411 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.45553112030029297
Epoch: 2, Steps: 7 | Train Loss: 2.151 Vali Loss: 2.076 Vali Acc: 0.569 Test Loss: 2.076 Test Acc: 0.569
Validation loss decreased (-0.208309 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 0.48006224632263184
Epoch: 3, Steps: 7 | Train Loss: 1.466 Vali Loss: 1.522 Vali Acc: 0.792 Test Loss: 1.522 Test Acc: 0.792
Validation loss decreased (-0.569424 --> -0.791651).  Saving model ...
Epoch: 4 cost time: 0.5050339698791504
Epoch: 4, Steps: 7 | Train Loss: 0.741 Vali Loss: 0.918 Vali Acc: 0.917 Test Loss: 0.918 Test Acc: 0.917
Validation loss decreased (-0.791651 --> -0.916657).  Saving model ...
Epoch: 5 cost time: 0.4773578643798828
Epoch: 5, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.534 Vali Acc: 0.931 Test Loss: 0.534 Test Acc: 0.931
Validation loss decreased (-0.916657 --> -0.930550).  Saving model ...
Epoch: 6 cost time: 0.504145622253418
Epoch: 6, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 0.4720594882965088
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.47759509086608887
Epoch: 8, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.958 Test Loss: 0.270 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 0.4358034133911133
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.5091485977172852
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48624300956726074
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4607503414154053
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.436626672744751
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4434187412261963
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.51796555519104
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.4557528495788574
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.49991321563720703
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.40514397621154785
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4626498222351074
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.482147216796875
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4589712619781494
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.45519137382507324
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.47939586639404297
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.45239925384521484
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.46808409690856934
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.4643585681915283
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.4674861431121826
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.4581577777862549
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.4771137237548828
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.47239017486572266
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.4519641399383545
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.47490644454956055
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.47712063789367676
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.44641971588134766
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4104928970336914
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.41428542137145996
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5206804275512695
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.497957706451416
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.43508434295654297
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.4368600845336914
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4373664855957031
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.499772310256958
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.461397647857666
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.4444620609283447
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.41738367080688477
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4441075325012207
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.47376489639282227
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.4505140781402588
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.49532055854797363
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.4603431224822998
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 672716
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.419304609298706
Epoch: 1, Steps: 7 | Train Loss: 2.521 Vali Loss: 2.456 Vali Acc: 0.181 Test Loss: 2.456 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.4148876667022705
Epoch: 2, Steps: 7 | Train Loss: 2.291 Vali Loss: 2.205 Vali Acc: 0.611 Test Loss: 2.205 Test Acc: 0.611
Validation loss decreased (-0.180531 --> -0.611089).  Saving model ...
Epoch: 3 cost time: 0.42069077491760254
Epoch: 3, Steps: 7 | Train Loss: 1.831 Vali Loss: 1.795 Vali Acc: 0.847 Test Loss: 1.795 Test Acc: 0.847
Validation loss decreased (-0.611089 --> -0.847204).  Saving model ...
Epoch: 4 cost time: 0.46858882904052734
Epoch: 4, Steps: 7 | Train Loss: 1.277 Vali Loss: 1.313 Vali Acc: 0.875 Test Loss: 1.313 Test Acc: 0.875
Validation loss decreased (-0.847204 --> -0.874987).  Saving model ...
Epoch: 5 cost time: 0.44361233711242676
Epoch: 5, Steps: 7 | Train Loss: 0.740 Vali Loss: 0.877 Vali Acc: 0.903 Test Loss: 0.877 Test Acc: 0.903
Validation loss decreased (-0.874987 --> -0.902769).  Saving model ...
Epoch: 6 cost time: 0.470029354095459
Epoch: 6, Steps: 7 | Train Loss: 0.371 Vali Loss: 0.555 Vali Acc: 0.903 Test Loss: 0.555 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.4749629497528076
Epoch: 7, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.43205952644348145
Epoch: 8, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4180924892425537
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.44112300872802734
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.5068161487579346
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.47136902809143066
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.4598815441131592
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.49280238151550293
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5109624862670898
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.44980716705322266
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.48552989959716797
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.47385668754577637
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.47795891761779785
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.456376314163208
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.4622485637664795
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.44158220291137695
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4823601245880127
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.48386073112487793
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.46036219596862793
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4501945972442627
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4871032238006592
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4134376049041748
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4730184078216553
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.43256664276123047
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.48311591148376465
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4881925582885742
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.48558878898620605
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 490316
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.473862648010254
Epoch: 1, Steps: 7 | Train Loss: 2.504 Vali Loss: 2.476 Vali Acc: 0.056 Test Loss: 2.476 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.4362006187438965
Epoch: 2, Steps: 7 | Train Loss: 2.351 Vali Loss: 2.310 Vali Acc: 0.403 Test Loss: 2.310 Test Acc: 0.403
Validation loss decreased (-0.055531 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.42348694801330566
Epoch: 3, Steps: 7 | Train Loss: 2.056 Vali Loss: 2.058 Vali Acc: 0.653 Test Loss: 2.058 Test Acc: 0.653
Validation loss decreased (-0.402755 --> -0.652757).  Saving model ...
Epoch: 4 cost time: 0.44199061393737793
Epoch: 4, Steps: 7 | Train Loss: 1.696 Vali Loss: 1.740 Vali Acc: 0.736 Test Loss: 1.740 Test Acc: 0.736
Validation loss decreased (-0.652757 --> -0.736094).  Saving model ...
Epoch: 5 cost time: 0.42104601860046387
Epoch: 5, Steps: 7 | Train Loss: 1.271 Vali Loss: 1.371 Vali Acc: 0.806 Test Loss: 1.371 Test Acc: 0.806
Validation loss decreased (-0.736094 --> -0.805542).  Saving model ...
Epoch: 6 cost time: 0.43947935104370117
Epoch: 6, Steps: 7 | Train Loss: 0.840 Vali Loss: 0.995 Vali Acc: 0.875 Test Loss: 0.995 Test Acc: 0.875
Validation loss decreased (-0.805542 --> -0.874990).  Saving model ...
Epoch: 7 cost time: 0.5013513565063477
Epoch: 7, Steps: 7 | Train Loss: 0.465 Vali Loss: 0.680 Vali Acc: 0.917 Test Loss: 0.680 Test Acc: 0.917
Validation loss decreased (-0.874990 --> -0.916660).  Saving model ...
Epoch: 8 cost time: 0.4409170150756836
Epoch: 8, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 0.42932653427124023
Epoch: 9, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.398 Vali Acc: 0.944 Test Loss: 0.398 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944440).  Saving model ...
Epoch: 10 cost time: 0.4467489719390869
Epoch: 10, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4221808910369873
Epoch: 11, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.43372607231140137
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4504966735839844
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.42995309829711914
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4137282371520996
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.4232180118560791
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.43417930603027344
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4113643169403076
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.44340968132019043
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.40791940689086914
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.4321582317352295
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.48300623893737793
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4219663143157959
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.5018129348754883
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4613649845123291
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.45765042304992676
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.471271276473999
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.44832301139831543
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.48609161376953125
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.45272040367126465
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4038655757904053
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.4547102451324463
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4744129180908203
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.43844103813171387
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.46811914443969727
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.47011899948120117
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.421677827835083
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.42808008193969727
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4179060459136963
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4465453624725342
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4394996166229248
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4193296432495117
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.46653127670288086
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.4201967716217041
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.4611208438873291
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.438922643661499
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.4598116874694824
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.42801475524902344
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4873068332672119
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4570624828338623
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 427724
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4808597564697266
Epoch: 1, Steps: 7 | Train Loss: 2.481 Vali Loss: 2.449 Vali Acc: 0.153 Test Loss: 2.449 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.49330973625183105
Epoch: 2, Steps: 7 | Train Loss: 2.331 Vali Loss: 2.308 Vali Acc: 0.361 Test Loss: 2.308 Test Acc: 0.361
Validation loss decreased (-0.152753 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 0.4377322196960449
Epoch: 3, Steps: 7 | Train Loss: 2.065 Vali Loss: 2.084 Vali Acc: 0.694 Test Loss: 2.084 Test Acc: 0.694
Validation loss decreased (-0.361088 --> -0.694424).  Saving model ...
Epoch: 4 cost time: 0.4856257438659668
Epoch: 4, Steps: 7 | Train Loss: 1.753 Vali Loss: 1.779 Vali Acc: 0.750 Test Loss: 1.779 Test Acc: 0.750
Validation loss decreased (-0.694424 --> -0.749982).  Saving model ...
Epoch: 5 cost time: 0.4311866760253906
Epoch: 5, Steps: 7 | Train Loss: 1.361 Vali Loss: 1.411 Vali Acc: 0.792 Test Loss: 1.411 Test Acc: 0.792
Validation loss decreased (-0.749982 --> -0.791653).  Saving model ...
Epoch: 6 cost time: 0.43947339057922363
Epoch: 6, Steps: 7 | Train Loss: 0.962 Vali Loss: 1.032 Vali Acc: 0.889 Test Loss: 1.032 Test Acc: 0.889
Validation loss decreased (-0.791653 --> -0.888879).  Saving model ...
Epoch: 7 cost time: 0.5051052570343018
Epoch: 7, Steps: 7 | Train Loss: 0.584 Vali Loss: 0.722 Vali Acc: 0.903 Test Loss: 0.722 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902771).  Saving model ...
Epoch: 8 cost time: 0.4588475227355957
Epoch: 8, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.516 Vali Acc: 0.931 Test Loss: 0.516 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930550).  Saving model ...
Epoch: 9 cost time: 0.4215977191925049
Epoch: 9, Steps: 7 | Train Loss: 0.169 Vali Loss: 0.408 Vali Acc: 0.917 Test Loss: 0.408 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47557663917541504
Epoch: 10, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.351 Vali Acc: 0.917 Test Loss: 0.351 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.41570258140563965
Epoch: 11, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.41912841796875
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.958 Test Loss: 0.280 Test Acc: 0.958
Validation loss decreased (-0.930550 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.4303739070892334
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5016217231750488
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4306323528289795
Epoch: 15, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5115935802459717
Epoch: 16, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5125348567962646
Epoch: 17, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.44986724853515625
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.4902019500732422
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5259175300598145
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.4522669315338135
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.46956300735473633
Epoch: 22, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.44496679306030273
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.475506067276001
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.4347364902496338
Epoch: 25, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.4782416820526123
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.46549153327941895
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.47440004348754883
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4780895709991455
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.46659088134765625
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.4873065948486328
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.4608292579650879
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.48124146461486816
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.4835662841796875
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4346771240234375
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.49809885025024414
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.45577001571655273
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.46568965911865234
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.45479774475097656
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4925272464752197
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.47271251678466797
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5160903930664062
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4557647705078125
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.46641111373901367
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4868035316467285
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.4767308235168457
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.4180154800415039
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.4802219867706299
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.40865564346313477
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4623594284057617
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 401996
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5513691902160645
Epoch: 1, Steps: 7 | Train Loss: 2.464 Vali Loss: 2.469 Vali Acc: 0.083 Test Loss: 2.469 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.43419718742370605
Epoch: 2, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.357 Vali Acc: 0.306 Test Loss: 2.357 Test Acc: 0.306
Validation loss decreased (-0.083309 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 0.4660677909851074
Epoch: 3, Steps: 7 | Train Loss: 2.151 Vali Loss: 2.173 Vali Acc: 0.625 Test Loss: 2.173 Test Acc: 0.625
Validation loss decreased (-0.305532 --> -0.624978).  Saving model ...
Epoch: 4 cost time: 0.519019365310669
Epoch: 4, Steps: 7 | Train Loss: 1.882 Vali Loss: 1.913 Vali Acc: 0.792 Test Loss: 1.913 Test Acc: 0.792
Validation loss decreased (-0.624978 --> -0.791648).  Saving model ...
Epoch: 5 cost time: 0.5015804767608643
Epoch: 5, Steps: 7 | Train Loss: 1.577 Vali Loss: 1.614 Vali Acc: 0.819 Test Loss: 1.614 Test Acc: 0.819
Validation loss decreased (-0.791648 --> -0.819428).  Saving model ...
Epoch: 6 cost time: 0.48949670791625977
Epoch: 6, Steps: 7 | Train Loss: 1.253 Vali Loss: 1.296 Vali Acc: 0.861 Test Loss: 1.296 Test Acc: 0.861
Validation loss decreased (-0.819428 --> -0.861098).  Saving model ...
Epoch: 7 cost time: 0.5631566047668457
Epoch: 7, Steps: 7 | Train Loss: 0.910 Vali Loss: 0.977 Vali Acc: 0.889 Test Loss: 0.977 Test Acc: 0.889
Validation loss decreased (-0.861098 --> -0.888879).  Saving model ...
Epoch: 8 cost time: 0.4648561477661133
Epoch: 8, Steps: 7 | Train Loss: 0.609 Vali Loss: 0.705 Vali Acc: 0.903 Test Loss: 0.705 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902771).  Saving model ...
Epoch: 9 cost time: 0.46039533615112305
Epoch: 9, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.511 Vali Acc: 0.917 Test Loss: 0.511 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 0.4353513717651367
Epoch: 10, Steps: 7 | Train Loss: 0.210 Vali Loss: 0.401 Vali Acc: 0.931 Test Loss: 0.401 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.4872398376464844
Epoch: 11, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4775972366333008
Epoch: 12, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.4198594093322754
Epoch: 13, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.49408793449401855
Epoch: 14, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4668426513671875
Epoch: 15, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4448113441467285
Epoch: 16, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4542727470397949
Epoch: 17, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5330841541290283
Epoch: 18, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.43448686599731445
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.47122645378112793
Epoch: 20, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.4436960220336914
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5038361549377441
Epoch: 22, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.47075605392456055
Epoch: 23, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.45120882987976074
Epoch: 24, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4772052764892578
Epoch: 25, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.47783637046813965
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4651484489440918
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.4520223140716553
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.44232773780822754
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.5381009578704834
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.4661905765533447
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.4961228370666504
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.45705485343933105
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.4463660717010498
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.46631360054016113
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.46430158615112305
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.456728458404541
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.45122265815734863
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.439725399017334
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.5345606803894043
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.46886706352233887
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.4315004348754883
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.5313160419464111
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4226703643798828
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.45746731758117676
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.4187800884246826
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.4411044120788574
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.4596092700958252
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.41613340377807617
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.44995927810668945
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 378188
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4973180294036865
Epoch: 1, Steps: 7 | Train Loss: 2.514 Vali Loss: 2.490 Vali Acc: 0.014 Test Loss: 2.490 Test Acc: 0.014
Validation loss decreased (inf --> -0.013864).  Saving model ...
Epoch: 2 cost time: 0.44391489028930664
Epoch: 2, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.411 Vali Acc: 0.167 Test Loss: 2.411 Test Acc: 0.167
Validation loss decreased (-0.013864 --> -0.166643).  Saving model ...
Epoch: 3 cost time: 0.4304187297821045
Epoch: 3, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.272 Vali Acc: 0.458 Test Loss: 2.272 Test Acc: 0.458
Validation loss decreased (-0.166643 --> -0.458311).  Saving model ...
Epoch: 4 cost time: 0.4204678535461426
Epoch: 4, Steps: 7 | Train Loss: 2.047 Vali Loss: 2.089 Vali Acc: 0.625 Test Loss: 2.089 Test Acc: 0.625
Validation loss decreased (-0.458311 --> -0.624979).  Saving model ...
Epoch: 5 cost time: 0.4458274841308594
Epoch: 5, Steps: 7 | Train Loss: 1.815 Vali Loss: 1.856 Vali Acc: 0.736 Test Loss: 1.856 Test Acc: 0.736
Validation loss decreased (-0.624979 --> -0.736093).  Saving model ...
Epoch: 6 cost time: 0.5173585414886475
Epoch: 6, Steps: 7 | Train Loss: 1.536 Vali Loss: 1.595 Vali Acc: 0.833 Test Loss: 1.595 Test Acc: 0.833
Validation loss decreased (-0.736093 --> -0.833317).  Saving model ...
Epoch: 7 cost time: 0.4334075450897217
Epoch: 7, Steps: 7 | Train Loss: 1.227 Vali Loss: 1.315 Vali Acc: 0.833 Test Loss: 1.315 Test Acc: 0.833
Validation loss decreased (-0.833317 --> -0.833320).  Saving model ...
Epoch: 8 cost time: 0.45566248893737793
Epoch: 8, Steps: 7 | Train Loss: 0.932 Vali Loss: 1.047 Vali Acc: 0.875 Test Loss: 1.047 Test Acc: 0.875
Validation loss decreased (-0.833320 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.48423027992248535
Epoch: 9, Steps: 7 | Train Loss: 0.665 Vali Loss: 0.810 Vali Acc: 0.875 Test Loss: 0.810 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.4228243827819824
Epoch: 10, Steps: 7 | Train Loss: 0.439 Vali Loss: 0.631 Vali Acc: 0.889 Test Loss: 0.631 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.43903660774230957
Epoch: 11, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.46502685546875
Epoch: 12, Steps: 7 | Train Loss: 0.172 Vali Loss: 0.433 Vali Acc: 0.917 Test Loss: 0.433 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 0.4664347171783447
Epoch: 13, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.460784912109375
Epoch: 14, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.48105359077453613
Epoch: 15, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.5300805568695068
Epoch: 16, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.4814317226409912
Epoch: 17, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.49757838249206543
Epoch: 18, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.41972875595092773
Epoch: 19, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4326364994049072
Epoch: 20, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.4379866123199463
Epoch: 21, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.958 Test Loss: 0.267 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.4678153991699219
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4204695224761963
Epoch: 23, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.958 Test Loss: 0.257 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.44542551040649414
Epoch: 24, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4499380588531494
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.41132140159606934
Epoch: 26, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.46274471282958984
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4622931480407715
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.4765045642852783
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.4579324722290039
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.41376447677612305
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.4464597702026367
Epoch: 32, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.4873220920562744
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.421816349029541
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4812736511230469
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.43205881118774414
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.4980466365814209
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.4302990436553955
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.4662916660308838
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.4809231758117676
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.42090821266174316
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.42484140396118164
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.48534059524536133
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.4916846752166748
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4843597412109375
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4736151695251465
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4684419631958008
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4684426784515381
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4710121154785156
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.4814317226409912
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 363596
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5291905403137207
Epoch: 1, Steps: 7 | Train Loss: 2.507 Vali Loss: 2.469 Vali Acc: 0.069 Test Loss: 2.469 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.4368886947631836
Epoch: 2, Steps: 7 | Train Loss: 2.445 Vali Loss: 2.404 Vali Acc: 0.208 Test Loss: 2.404 Test Acc: 0.208
Validation loss decreased (-0.069420 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 0.48902082443237305
Epoch: 3, Steps: 7 | Train Loss: 2.304 Vali Loss: 2.293 Vali Acc: 0.444 Test Loss: 2.293 Test Acc: 0.444
Validation loss decreased (-0.208309 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 0.41948604583740234
Epoch: 4, Steps: 7 | Train Loss: 2.129 Vali Loss: 2.150 Vali Acc: 0.556 Test Loss: 2.150 Test Acc: 0.556
Validation loss decreased (-0.444422 --> -0.555534).  Saving model ...
Epoch: 5 cost time: 0.4196956157684326
Epoch: 5, Steps: 7 | Train Loss: 1.916 Vali Loss: 1.971 Vali Acc: 0.667 Test Loss: 1.971 Test Acc: 0.667
Validation loss decreased (-0.555534 --> -0.666647).  Saving model ...
Epoch: 6 cost time: 0.43826889991760254
Epoch: 6, Steps: 7 | Train Loss: 1.705 Vali Loss: 1.759 Vali Acc: 0.722 Test Loss: 1.759 Test Acc: 0.722
Validation loss decreased (-0.666647 --> -0.722205).  Saving model ...
Epoch: 7 cost time: 0.4103207588195801
Epoch: 7, Steps: 7 | Train Loss: 1.426 Vali Loss: 1.525 Vali Acc: 0.736 Test Loss: 1.525 Test Acc: 0.736
Validation loss decreased (-0.722205 --> -0.736096).  Saving model ...
Epoch: 8 cost time: 0.5586471557617188
Epoch: 8, Steps: 7 | Train Loss: 1.170 Vali Loss: 1.295 Vali Acc: 0.764 Test Loss: 1.295 Test Acc: 0.764
Validation loss decreased (-0.736096 --> -0.763876).  Saving model ...
Epoch: 9 cost time: 0.4403059482574463
Epoch: 9, Steps: 7 | Train Loss: 0.907 Vali Loss: 1.069 Vali Acc: 0.819 Test Loss: 1.069 Test Acc: 0.819
Validation loss decreased (-0.763876 --> -0.819434).  Saving model ...
Epoch: 10 cost time: 0.47746872901916504
Epoch: 10, Steps: 7 | Train Loss: 0.671 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833325).  Saving model ...
Epoch: 11 cost time: 0.5174787044525146
Epoch: 11, Steps: 7 | Train Loss: 0.480 Vali Loss: 0.712 Vali Acc: 0.847 Test Loss: 0.712 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847215).  Saving model ...
Epoch: 12 cost time: 0.4704289436340332
Epoch: 12, Steps: 7 | Train Loss: 0.329 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 0.44803595542907715
Epoch: 13, Steps: 7 | Train Loss: 0.216 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888884).  Saving model ...
Epoch: 14 cost time: 0.42691469192504883
Epoch: 14, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 15 cost time: 0.46553778648376465
Epoch: 15, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.546912431716919
Epoch: 16, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.44742560386657715
Epoch: 17, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4573845863342285
Epoch: 18, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4189913272857666
Epoch: 19, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.43745994567871094
Epoch: 20, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.49291038513183594
Epoch: 21, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 22 cost time: 0.4468851089477539
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.49033069610595703
Epoch: 23, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 0.4555222988128662
Epoch: 24, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 0.45998692512512207
Epoch: 25, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.4753096103668213
Epoch: 26, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.4173614978790283
Epoch: 27, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.44083547592163086
Epoch: 28, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.48339104652404785
Epoch: 29, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4715580940246582
Epoch: 30, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.44111013412475586
Epoch: 31, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.4451565742492676
Epoch: 32, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.486541748046875
Epoch: 33, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.49775004386901855
Epoch: 34, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.4900646209716797
Epoch: 35, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4842417240142822
Epoch: 36, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4278218746185303
Epoch: 37, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.49567127227783203
Epoch: 38, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4304986000061035
Epoch: 39, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5001249313354492
Epoch: 40, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.40935826301574707
Epoch: 41, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4831113815307617
Epoch: 42, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.4699862003326416
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.44007301330566406
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4571857452392578
Epoch: 45, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.409282922744751
Epoch: 46, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.43629884719848633
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5162687301635742
Epoch: 48, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.48082613945007324
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.46234560012817383
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 358220
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5275070667266846
Epoch: 1, Steps: 7 | Train Loss: 2.461 Vali Loss: 2.441 Vali Acc: 0.236 Test Loss: 2.441 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.4254908561706543
Epoch: 2, Steps: 7 | Train Loss: 2.274 Vali Loss: 2.262 Vali Acc: 0.528 Test Loss: 2.262 Test Acc: 0.528
Validation loss decreased (-0.236087 --> -0.527755).  Saving model ...
Epoch: 3 cost time: 0.42354583740234375
Epoch: 3, Steps: 7 | Train Loss: 1.910 Vali Loss: 1.962 Vali Acc: 0.764 Test Loss: 1.962 Test Acc: 0.764
Validation loss decreased (-0.527755 --> -0.763869).  Saving model ...
Epoch: 4 cost time: 0.4714324474334717
Epoch: 4, Steps: 7 | Train Loss: 1.429 Vali Loss: 1.555 Vali Acc: 0.889 Test Loss: 1.555 Test Acc: 0.889
Validation loss decreased (-0.763869 --> -0.888873).  Saving model ...
Epoch: 5 cost time: 0.44855618476867676
Epoch: 5, Steps: 7 | Train Loss: 0.949 Vali Loss: 1.103 Vali Acc: 0.917 Test Loss: 1.103 Test Acc: 0.917
Validation loss decreased (-0.888873 --> -0.916656).  Saving model ...
Epoch: 6 cost time: 0.43778371810913086
Epoch: 6, Steps: 7 | Train Loss: 0.536 Vali Loss: 0.726 Vali Acc: 0.917 Test Loss: 0.726 Test Acc: 0.917
Validation loss decreased (-0.916656 --> -0.916659).  Saving model ...
Epoch: 7 cost time: 0.47055888175964355
Epoch: 7, Steps: 7 | Train Loss: 0.248 Vali Loss: 0.468 Vali Acc: 0.944 Test Loss: 0.468 Test Acc: 0.944
Validation loss decreased (-0.916659 --> -0.944440).  Saving model ...
Epoch: 8 cost time: 0.4748039245605469
Epoch: 8, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.363 Vali Acc: 0.958 Test Loss: 0.363 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958330).  Saving model ...
Epoch: 9 cost time: 0.41525888442993164
Epoch: 9, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.42192888259887695
Epoch: 10, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.46395301818847656
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4159231185913086
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.5452361106872559
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.5074090957641602
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.4969460964202881
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.49396491050720215
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.4137735366821289
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.48069071769714355
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.48913049697875977
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.4843931198120117
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.4593825340270996
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.46138715744018555
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.4265122413635254
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4658980369567871
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.44521141052246094
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.457629919052124
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.47266602516174316
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.44246554374694824
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.45462751388549805
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.47223973274230957
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.4605872631072998
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.43856167793273926
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.45189356803894043
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.44052910804748535
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4634838104248047
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.5454428195953369
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.43978428840637207
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.48839497566223145
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.4290452003479004
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.43488192558288574
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.4788966178894043
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4562368392944336
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 43 cost time: 0.4473106861114502
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.49367260932922363
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.43163585662841797
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.47554636001586914
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.4475555419921875
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.4602394104003906
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 49 cost time: 0.45938777923583984
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.4187030792236328
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 270828
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.497138500213623
Epoch: 1, Steps: 7 | Train Loss: 2.527 Vali Loss: 2.484 Vali Acc: 0.111 Test Loss: 2.484 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.4017469882965088
Epoch: 2, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.383 Vali Acc: 0.250 Test Loss: 2.383 Test Acc: 0.250
Validation loss decreased (-0.111086 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.4516420364379883
Epoch: 3, Steps: 7 | Train Loss: 2.188 Vali Loss: 2.209 Vali Acc: 0.597 Test Loss: 2.209 Test Acc: 0.597
Validation loss decreased (-0.249976 --> -0.597200).  Saving model ...
Epoch: 4 cost time: 0.42206454277038574
Epoch: 4, Steps: 7 | Train Loss: 1.911 Vali Loss: 1.962 Vali Acc: 0.736 Test Loss: 1.962 Test Acc: 0.736
Validation loss decreased (-0.597200 --> -0.736091).  Saving model ...
Epoch: 5 cost time: 0.4504060745239258
Epoch: 5, Steps: 7 | Train Loss: 1.568 Vali Loss: 1.647 Vali Acc: 0.819 Test Loss: 1.647 Test Acc: 0.819
Validation loss decreased (-0.736091 --> -0.819428).  Saving model ...
Epoch: 6 cost time: 0.44394659996032715
Epoch: 6, Steps: 7 | Train Loss: 1.195 Vali Loss: 1.305 Vali Acc: 0.847 Test Loss: 1.305 Test Acc: 0.847
Validation loss decreased (-0.819428 --> -0.847209).  Saving model ...
Epoch: 7 cost time: 0.43995118141174316
Epoch: 7, Steps: 7 | Train Loss: 0.839 Vali Loss: 0.978 Vali Acc: 0.875 Test Loss: 0.978 Test Acc: 0.875
Validation loss decreased (-0.847209 --> -0.874990).  Saving model ...
Epoch: 8 cost time: 0.4734671115875244
Epoch: 8, Steps: 7 | Train Loss: 0.534 Vali Loss: 0.726 Vali Acc: 0.875 Test Loss: 0.726 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.4364330768585205
Epoch: 9, Steps: 7 | Train Loss: 0.295 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888883).  Saving model ...
Epoch: 10 cost time: 0.3882927894592285
Epoch: 10, Steps: 7 | Train Loss: 0.154 Vali Loss: 0.423 Vali Acc: 0.917 Test Loss: 0.423 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 0.4877893924713135
Epoch: 11, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.4622018337249756
Epoch: 12, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.473757266998291
Epoch: 13, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.317 Vali Acc: 0.931 Test Loss: 0.317 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.43413615226745605
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 0.4569547176361084
Epoch: 15, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5296497344970703
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.43241286277770996
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.43570446968078613
Epoch: 18, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.4378550052642822
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5010707378387451
Epoch: 20, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.4681210517883301
Epoch: 21, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.43867039680480957
Epoch: 22, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.5170166492462158
Epoch: 23, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.4428091049194336
Epoch: 24, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.46806788444519043
Epoch: 25, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.5145208835601807
Epoch: 26, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.437103271484375
Epoch: 27, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.4774782657623291
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.44219970703125
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.4723703861236572
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.426389217376709
Epoch: 31, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.44498538970947266
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.47731518745422363
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.46047496795654297
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.4620356559753418
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4986307621002197
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4278535842895508
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4746129512786865
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.44554901123046875
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4727466106414795
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.41084980964660645
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.48369407653808594
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.48558545112609863
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.40302085876464844
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.45530080795288086
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.41539978981018066
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.507293701171875
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.38974499702453613
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.38784146308898926
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.36757802963256836
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 179628
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4939961433410645
Epoch: 1, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.396 Vali Acc: 0.181 Test Loss: 2.396 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.4502091407775879
Epoch: 2, Steps: 7 | Train Loss: 2.383 Vali Loss: 2.311 Vali Acc: 0.319 Test Loss: 2.311 Test Acc: 0.319
Validation loss decreased (-0.180532 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 0.49478888511657715
Epoch: 3, Steps: 7 | Train Loss: 2.221 Vali Loss: 2.170 Vali Acc: 0.472 Test Loss: 2.170 Test Acc: 0.472
Validation loss decreased (-0.319421 --> -0.472201).  Saving model ...
Epoch: 4 cost time: 0.5049383640289307
Epoch: 4, Steps: 7 | Train Loss: 2.009 Vali Loss: 1.979 Vali Acc: 0.722 Test Loss: 1.979 Test Acc: 0.722
Validation loss decreased (-0.472201 --> -0.722202).  Saving model ...
Epoch: 5 cost time: 0.4020564556121826
Epoch: 5, Steps: 7 | Train Loss: 1.753 Vali Loss: 1.738 Vali Acc: 0.792 Test Loss: 1.738 Test Acc: 0.792
Validation loss decreased (-0.722202 --> -0.791649).  Saving model ...
Epoch: 6 cost time: 0.3883194923400879
Epoch: 6, Steps: 7 | Train Loss: 1.446 Vali Loss: 1.449 Vali Acc: 0.847 Test Loss: 1.449 Test Acc: 0.847
Validation loss decreased (-0.791649 --> -0.847208).  Saving model ...
Epoch: 7 cost time: 0.44377636909484863
Epoch: 7, Steps: 7 | Train Loss: 1.116 Vali Loss: 1.159 Vali Acc: 0.833 Test Loss: 1.159 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46515607833862305
Epoch: 8, Steps: 7 | Train Loss: 0.809 Vali Loss: 0.883 Vali Acc: 0.917 Test Loss: 0.883 Test Acc: 0.917
Validation loss decreased (-0.847208 --> -0.916658).  Saving model ...
Epoch: 9 cost time: 0.4620990753173828
Epoch: 9, Steps: 7 | Train Loss: 0.541 Vali Loss: 0.657 Vali Acc: 0.944 Test Loss: 0.657 Test Acc: 0.944
Validation loss decreased (-0.916658 --> -0.944438).  Saving model ...
Epoch: 10 cost time: 0.4698173999786377
Epoch: 10, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.502 Vali Acc: 0.944 Test Loss: 0.502 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944439).  Saving model ...
Epoch: 11 cost time: 0.4080216884613037
Epoch: 11, Steps: 7 | Train Loss: 0.203 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48788905143737793
Epoch: 12, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.363 Vali Acc: 0.958 Test Loss: 0.363 Test Acc: 0.958
Validation loss decreased (-0.944439 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 0.4863770008087158
Epoch: 13, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.321 Vali Acc: 0.958 Test Loss: 0.321 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 14 cost time: 0.41467881202697754
Epoch: 14, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.439861536026001
Epoch: 15, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4495413303375244
Epoch: 16, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.44887471199035645
Epoch: 17, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.42828869819641113
Epoch: 18, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4027059078216553
Epoch: 19, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4300673007965088
Epoch: 20, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5358142852783203
Epoch: 21, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4670727252960205
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4305565357208252
Epoch: 23, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 148332
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4956107139587402
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.509 Vali Acc: 0.083 Test Loss: 2.509 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.43511366844177246
Epoch: 2, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.430 Vali Acc: 0.208 Test Loss: 2.430 Test Acc: 0.208
Validation loss decreased (-0.083308 --> -0.208309).  Saving model ...
Epoch: 3 cost time: 0.4633297920227051
Epoch: 3, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.306 Vali Acc: 0.389 Test Loss: 2.306 Test Acc: 0.389
Validation loss decreased (-0.208309 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 0.4013400077819824
Epoch: 4, Steps: 7 | Train Loss: 2.164 Vali Loss: 2.145 Vali Acc: 0.611 Test Loss: 2.145 Test Acc: 0.611
Validation loss decreased (-0.388866 --> -0.611090).  Saving model ...
Epoch: 5 cost time: 0.45928525924682617
Epoch: 5, Steps: 7 | Train Loss: 1.938 Vali Loss: 1.939 Vali Acc: 0.736 Test Loss: 1.939 Test Acc: 0.736
Validation loss decreased (-0.611090 --> -0.736092).  Saving model ...
Epoch: 6 cost time: 0.4629786014556885
Epoch: 6, Steps: 7 | Train Loss: 1.693 Vali Loss: 1.686 Vali Acc: 0.861 Test Loss: 1.686 Test Acc: 0.861
Validation loss decreased (-0.736092 --> -0.861094).  Saving model ...
Epoch: 7 cost time: 0.42255377769470215
Epoch: 7, Steps: 7 | Train Loss: 1.404 Vali Loss: 1.411 Vali Acc: 0.889 Test Loss: 1.411 Test Acc: 0.889
Validation loss decreased (-0.861094 --> -0.888875).  Saving model ...
Epoch: 8 cost time: 0.4778881072998047
Epoch: 8, Steps: 7 | Train Loss: 1.099 Vali Loss: 1.128 Vali Acc: 0.903 Test Loss: 1.128 Test Acc: 0.903
Validation loss decreased (-0.888875 --> -0.902767).  Saving model ...
Epoch: 9 cost time: 0.476726770401001
Epoch: 9, Steps: 7 | Train Loss: 0.816 Vali Loss: 0.875 Vali Acc: 0.903 Test Loss: 0.875 Test Acc: 0.903
Validation loss decreased (-0.902767 --> -0.902769).  Saving model ...
Epoch: 10 cost time: 0.47159814834594727
Epoch: 10, Steps: 7 | Train Loss: 0.564 Vali Loss: 0.665 Vali Acc: 0.903 Test Loss: 0.665 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902771).  Saving model ...
Epoch: 11 cost time: 0.4540865421295166
Epoch: 11, Steps: 7 | Train Loss: 0.368 Vali Loss: 0.527 Vali Acc: 0.917 Test Loss: 0.527 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 12 cost time: 0.4966304302215576
Epoch: 12, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.439 Vali Acc: 0.917 Test Loss: 0.439 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 13 cost time: 0.48137617111206055
Epoch: 13, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.4210093021392822
Epoch: 14, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.47491908073425293
Epoch: 15, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.41988611221313477
Epoch: 16, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.44225335121154785
Epoch: 17, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.4618875980377197
Epoch: 18, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.4444732666015625
Epoch: 19, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.4373772144317627
Epoch: 20, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.4391751289367676
Epoch: 21, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.43051910400390625
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5117175579071045
Epoch: 23, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.45572972297668457
Epoch: 24, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.41689419746398926
Epoch: 25, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.458204984664917
Epoch: 26, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.4397876262664795
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.43081212043762207
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.41743040084838867
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.4035365581512451
Epoch: 30, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.4372551441192627
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.4854562282562256
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.4928395748138428
Epoch: 33, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.4340858459472656
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.477872371673584
Epoch: 35, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4744102954864502
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.47498011589050293
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.4344520568847656
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.485090970993042
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.3874337673187256
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5053186416625977
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.42665696144104004
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4800240993499756
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4523193836212158
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4270801544189453
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.43541431427001953
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.46471214294433594
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 135468
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5481901168823242
Epoch: 1, Steps: 7 | Train Loss: 2.491 Vali Loss: 2.467 Vali Acc: 0.153 Test Loss: 2.467 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.44051074981689453
Epoch: 2, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.417 Vali Acc: 0.236 Test Loss: 2.417 Test Acc: 0.236
Validation loss decreased (-0.152753 --> -0.236087).  Saving model ...
Epoch: 3 cost time: 0.4036588668823242
Epoch: 3, Steps: 7 | Train Loss: 2.360 Vali Loss: 2.331 Vali Acc: 0.389 Test Loss: 2.331 Test Acc: 0.389
Validation loss decreased (-0.236087 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 0.4503755569458008
Epoch: 4, Steps: 7 | Train Loss: 2.235 Vali Loss: 2.213 Vali Acc: 0.472 Test Loss: 2.213 Test Acc: 0.472
Validation loss decreased (-0.388866 --> -0.472200).  Saving model ...
Epoch: 5 cost time: 0.44379711151123047
Epoch: 5, Steps: 7 | Train Loss: 2.067 Vali Loss: 2.061 Vali Acc: 0.542 Test Loss: 2.061 Test Acc: 0.542
Validation loss decreased (-0.472200 --> -0.541646).  Saving model ...
Epoch: 6 cost time: 0.4215564727783203
Epoch: 6, Steps: 7 | Train Loss: 1.892 Vali Loss: 1.880 Vali Acc: 0.694 Test Loss: 1.880 Test Acc: 0.694
Validation loss decreased (-0.541646 --> -0.694426).  Saving model ...
Epoch: 7 cost time: 0.43706631660461426
Epoch: 7, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.672 Vali Acc: 0.764 Test Loss: 1.672 Test Acc: 0.764
Validation loss decreased (-0.694426 --> -0.763872).  Saving model ...
Epoch: 8 cost time: 0.4086272716522217
Epoch: 8, Steps: 7 | Train Loss: 1.456 Vali Loss: 1.454 Vali Acc: 0.819 Test Loss: 1.454 Test Acc: 0.819
Validation loss decreased (-0.763872 --> -0.819430).  Saving model ...
Epoch: 9 cost time: 0.43354272842407227
Epoch: 9, Steps: 7 | Train Loss: 1.201 Vali Loss: 1.233 Vali Acc: 0.833 Test Loss: 1.233 Test Acc: 0.833
Validation loss decreased (-0.819430 --> -0.833321).  Saving model ...
Epoch: 10 cost time: 0.40410399436950684
Epoch: 10, Steps: 7 | Train Loss: 0.977 Vali Loss: 1.021 Vali Acc: 0.847 Test Loss: 1.021 Test Acc: 0.847
Validation loss decreased (-0.833321 --> -0.847212).  Saving model ...
Epoch: 11 cost time: 0.4233534336090088
Epoch: 11, Steps: 7 | Train Loss: 0.746 Vali Loss: 0.824 Vali Acc: 0.903 Test Loss: 0.824 Test Acc: 0.903
Validation loss decreased (-0.847212 --> -0.902770).  Saving model ...
Epoch: 12 cost time: 0.4260592460632324
Epoch: 12, Steps: 7 | Train Loss: 0.539 Vali Loss: 0.666 Vali Acc: 0.903 Test Loss: 0.666 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902771).  Saving model ...
Epoch: 13 cost time: 0.4176597595214844
Epoch: 13, Steps: 7 | Train Loss: 0.397 Vali Loss: 0.544 Vali Acc: 0.917 Test Loss: 0.544 Test Acc: 0.917
Validation loss decreased (-0.902771 --> -0.916661).  Saving model ...
Epoch: 14 cost time: 0.4561805725097656
Epoch: 14, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.458 Vali Acc: 0.931 Test Loss: 0.458 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930551).  Saving model ...
Epoch: 15 cost time: 0.4416508674621582
Epoch: 15, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.404 Vali Acc: 0.931 Test Loss: 0.404 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.43055057525634766
Epoch: 16, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.366 Vali Acc: 0.931 Test Loss: 0.366 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.4599006175994873
Epoch: 17, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.339 Vali Acc: 0.931 Test Loss: 0.339 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.4455709457397461
Epoch: 18, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 0.3977937698364258
Epoch: 19, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.4533195495605469
Epoch: 20, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.45334649085998535
Epoch: 21, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.44231557846069336
Epoch: 22, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.4312021732330322
Epoch: 23, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.43498969078063965
Epoch: 24, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4273495674133301
Epoch: 25, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4282996654510498
Epoch: 26, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.43820977210998535
Epoch: 27, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4387052059173584
Epoch: 28, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.42470788955688477
Epoch: 29, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.4097926616668701
Epoch: 30, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.4342348575592041
Epoch: 31, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.44732117652893066
Epoch: 32, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.4145791530609131
Epoch: 33, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.40784597396850586
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.39870285987854004
Epoch: 35, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.3911151885986328
Epoch: 36, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.38317084312438965
Epoch: 37, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.3988618850708008
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.4006013870239258
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.40743255615234375
Epoch: 40, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4075324535369873
Epoch: 41, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.42760729789733887
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.41985177993774414
Epoch: 43, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.46096205711364746
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4246997833251953
Epoch: 45, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4287428855895996
Epoch: 46, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4760556221008301
Epoch: 47, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4275205135345459
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5011849403381348
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.39351654052734375
Epoch: 50, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 123564
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5952930450439453
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.481 Vali Acc: 0.056 Test Loss: 2.481 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.42764735221862793
Epoch: 2, Steps: 7 | Train Loss: 2.432 Vali Loss: 2.433 Vali Acc: 0.139 Test Loss: 2.433 Test Acc: 0.139
Validation loss decreased (-0.055531 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 0.43021249771118164
Epoch: 3, Steps: 7 | Train Loss: 2.354 Vali Loss: 2.359 Vali Acc: 0.292 Test Loss: 2.359 Test Acc: 0.292
Validation loss decreased (-0.138865 --> -0.291643).  Saving model ...
Epoch: 4 cost time: 0.4060549736022949
Epoch: 4, Steps: 7 | Train Loss: 2.272 Vali Loss: 2.262 Vali Acc: 0.472 Test Loss: 2.262 Test Acc: 0.472
Validation loss decreased (-0.291643 --> -0.472200).  Saving model ...
Epoch: 5 cost time: 0.4887857437133789
Epoch: 5, Steps: 7 | Train Loss: 2.139 Vali Loss: 2.149 Vali Acc: 0.583 Test Loss: 2.149 Test Acc: 0.583
Validation loss decreased (-0.472200 --> -0.583312).  Saving model ...
Epoch: 6 cost time: 0.45916247367858887
Epoch: 6, Steps: 7 | Train Loss: 1.987 Vali Loss: 2.013 Vali Acc: 0.625 Test Loss: 2.013 Test Acc: 0.625
Validation loss decreased (-0.583312 --> -0.624980).  Saving model ...
Epoch: 7 cost time: 0.4400804042816162
Epoch: 7, Steps: 7 | Train Loss: 1.826 Vali Loss: 1.862 Vali Acc: 0.722 Test Loss: 1.862 Test Acc: 0.722
Validation loss decreased (-0.624980 --> -0.722204).  Saving model ...
Epoch: 8 cost time: 0.36046433448791504
Epoch: 8, Steps: 7 | Train Loss: 1.672 Vali Loss: 1.694 Vali Acc: 0.722 Test Loss: 1.694 Test Acc: 0.722
Validation loss decreased (-0.722204 --> -0.722205).  Saving model ...
Epoch: 9 cost time: 0.42452573776245117
Epoch: 9, Steps: 7 | Train Loss: 1.464 Vali Loss: 1.522 Vali Acc: 0.778 Test Loss: 1.522 Test Acc: 0.778
Validation loss decreased (-0.722205 --> -0.777763).  Saving model ...
Epoch: 10 cost time: 0.4072854518890381
Epoch: 10, Steps: 7 | Train Loss: 1.270 Vali Loss: 1.329 Vali Acc: 0.792 Test Loss: 1.329 Test Acc: 0.792
Validation loss decreased (-0.777763 --> -0.791653).  Saving model ...
Epoch: 11 cost time: 0.5115015506744385
Epoch: 11, Steps: 7 | Train Loss: 1.078 Vali Loss: 1.143 Vali Acc: 0.847 Test Loss: 1.143 Test Acc: 0.847
Validation loss decreased (-0.791653 --> -0.847211).  Saving model ...
Epoch: 12 cost time: 0.4344015121459961
Epoch: 12, Steps: 7 | Train Loss: 0.866 Vali Loss: 0.979 Vali Acc: 0.861 Test Loss: 0.979 Test Acc: 0.861
Validation loss decreased (-0.847211 --> -0.861101).  Saving model ...
Epoch: 13 cost time: 0.40578627586364746
Epoch: 13, Steps: 7 | Train Loss: 0.674 Vali Loss: 0.835 Vali Acc: 0.861 Test Loss: 0.835 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861103).  Saving model ...
Epoch: 14 cost time: 0.4281952381134033
Epoch: 14, Steps: 7 | Train Loss: 0.530 Vali Loss: 0.711 Vali Acc: 0.875 Test Loss: 0.711 Test Acc: 0.875
Validation loss decreased (-0.861103 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.43659186363220215
Epoch: 15, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.616 Vali Acc: 0.889 Test Loss: 0.616 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 0.407900333404541
Epoch: 16, Steps: 7 | Train Loss: 0.314 Vali Loss: 0.547 Vali Acc: 0.903 Test Loss: 0.547 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 17 cost time: 0.3845374584197998
Epoch: 17, Steps: 7 | Train Loss: 0.242 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 18 cost time: 0.44812870025634766
Epoch: 18, Steps: 7 | Train Loss: 0.191 Vali Loss: 0.446 Vali Acc: 0.903 Test Loss: 0.446 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 19 cost time: 0.3923912048339844
Epoch: 19, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.412 Vali Acc: 0.903 Test Loss: 0.412 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 20 cost time: 0.4672126770019531
Epoch: 20, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.4164559841156006
Epoch: 21, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.40699243545532227
Epoch: 22, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 0.43723297119140625
Epoch: 23, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 0.39809441566467285
Epoch: 24, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.43094491958618164
Epoch: 25, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.421830415725708
Epoch: 26, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.4250807762145996
Epoch: 27, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.45914697647094727
Epoch: 28, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.47962236404418945
Epoch: 29, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.4089019298553467
Epoch: 30, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.3867201805114746
Epoch: 31, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.41565823554992676
Epoch: 32, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.3929755687713623
Epoch: 33, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.3967094421386719
Epoch: 34, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.554551362991333
Epoch: 35, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.4435865879058838
Epoch: 36, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.4979879856109619
Epoch: 37, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.45719242095947266
Epoch: 38, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.44025731086730957
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.4339115619659424
Epoch: 40, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.3844432830810547
Epoch: 41, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.40020036697387695
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.4501020908355713
Epoch: 43, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.3826470375061035
Epoch: 44, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.400850772857666
Epoch: 45, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5086376667022705
Epoch: 46, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.46231603622436523
Epoch: 47, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.4239327907562256
Epoch: 48, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.45699357986450195
Epoch: 49, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.4049510955810547
Epoch: 50, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 116268
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.7774512767791748
Epoch: 1, Steps: 7 | Train Loss: 2.512 Vali Loss: 2.474 Vali Acc: 0.111 Test Loss: 2.474 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.46924638748168945
Epoch: 2, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.436 Vali Acc: 0.125 Test Loss: 2.436 Test Acc: 0.125
Validation loss decreased (-0.111086 --> -0.124976).  Saving model ...
Epoch: 3 cost time: 0.44190335273742676
Epoch: 3, Steps: 7 | Train Loss: 2.403 Vali Loss: 2.373 Vali Acc: 0.153 Test Loss: 2.373 Test Acc: 0.153
Validation loss decreased (-0.124976 --> -0.152754).  Saving model ...
Epoch: 4 cost time: 0.46271419525146484
Epoch: 4, Steps: 7 | Train Loss: 2.300 Vali Loss: 2.286 Vali Acc: 0.264 Test Loss: 2.286 Test Acc: 0.264
Validation loss decreased (-0.152754 --> -0.263866).  Saving model ...
Epoch: 5 cost time: 0.45748090744018555
Epoch: 5, Steps: 7 | Train Loss: 2.162 Vali Loss: 2.180 Vali Acc: 0.417 Test Loss: 2.180 Test Acc: 0.417
Validation loss decreased (-0.263866 --> -0.416645).  Saving model ...
Epoch: 6 cost time: 0.5226876735687256
Epoch: 6, Steps: 7 | Train Loss: 2.044 Vali Loss: 2.053 Vali Acc: 0.569 Test Loss: 2.053 Test Acc: 0.569
Validation loss decreased (-0.416645 --> -0.569424).  Saving model ...
Epoch: 7 cost time: 0.5163753032684326
Epoch: 7, Steps: 7 | Train Loss: 1.896 Vali Loss: 1.909 Vali Acc: 0.722 Test Loss: 1.909 Test Acc: 0.722
Validation loss decreased (-0.569424 --> -0.722203).  Saving model ...
Epoch: 8 cost time: 0.41945958137512207
Epoch: 8, Steps: 7 | Train Loss: 1.725 Vali Loss: 1.743 Vali Acc: 0.764 Test Loss: 1.743 Test Acc: 0.764
Validation loss decreased (-0.722203 --> -0.763871).  Saving model ...
Epoch: 9 cost time: 0.45009875297546387
Epoch: 9, Steps: 7 | Train Loss: 1.554 Vali Loss: 1.562 Vali Acc: 0.847 Test Loss: 1.562 Test Acc: 0.847
Validation loss decreased (-0.763871 --> -0.847207).  Saving model ...
Epoch: 10 cost time: 0.49127888679504395
Epoch: 10, Steps: 7 | Train Loss: 1.346 Vali Loss: 1.382 Vali Acc: 0.889 Test Loss: 1.382 Test Acc: 0.889
Validation loss decreased (-0.847207 --> -0.888875).  Saving model ...
Epoch: 11 cost time: 0.5068295001983643
Epoch: 11, Steps: 7 | Train Loss: 1.157 Vali Loss: 1.200 Vali Acc: 0.861 Test Loss: 1.200 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.481494665145874
Epoch: 12, Steps: 7 | Train Loss: 0.954 Vali Loss: 1.033 Vali Acc: 0.889 Test Loss: 1.033 Test Acc: 0.889
Validation loss decreased (-0.888875 --> -0.888879).  Saving model ...
Epoch: 13 cost time: 0.5128858089447021
Epoch: 13, Steps: 7 | Train Loss: 0.775 Vali Loss: 0.876 Vali Acc: 0.889 Test Loss: 0.876 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888880).  Saving model ...
Epoch: 14 cost time: 0.4450814723968506
Epoch: 14, Steps: 7 | Train Loss: 0.624 Vali Loss: 0.752 Vali Acc: 0.917 Test Loss: 0.752 Test Acc: 0.917
Validation loss decreased (-0.888880 --> -0.916659).  Saving model ...
Epoch: 15 cost time: 0.4484410285949707
Epoch: 15, Steps: 7 | Train Loss: 0.480 Vali Loss: 0.646 Vali Acc: 0.917 Test Loss: 0.646 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916660).  Saving model ...
Epoch: 16 cost time: 0.4649240970611572
Epoch: 16, Steps: 7 | Train Loss: 0.386 Vali Loss: 0.567 Vali Acc: 0.931 Test Loss: 0.567 Test Acc: 0.931
Validation loss decreased (-0.916660 --> -0.930550).  Saving model ...
Epoch: 17 cost time: 0.4054572582244873
Epoch: 17, Steps: 7 | Train Loss: 0.302 Vali Loss: 0.508 Vali Acc: 0.931 Test Loss: 0.508 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930550).  Saving model ...
Epoch: 18 cost time: 0.4685978889465332
Epoch: 18, Steps: 7 | Train Loss: 0.240 Vali Loss: 0.471 Vali Acc: 0.917 Test Loss: 0.471 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4536769390106201
Epoch: 19, Steps: 7 | Train Loss: 0.197 Vali Loss: 0.431 Vali Acc: 0.903 Test Loss: 0.431 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4595522880554199
Epoch: 20, Steps: 7 | Train Loss: 0.161 Vali Loss: 0.412 Vali Acc: 0.917 Test Loss: 0.412 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4719069004058838
Epoch: 21, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4493687152862549
Epoch: 22, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4510068893432617
Epoch: 23, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4684915542602539
Epoch: 24, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4983201026916504
Epoch: 25, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.45315098762512207
Epoch: 26, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.44648051261901855
Epoch: 27, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 113580
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5402357578277588
Epoch: 1, Steps: 7 | Train Loss: 2.409 Vali Loss: 1.895 Vali Acc: 0.778 Test Loss: 1.895 Test Acc: 0.778
Validation loss decreased (inf --> -0.777759).  Saving model ...
Epoch: 2 cost time: 0.5742793083190918
Epoch: 2, Steps: 7 | Train Loss: 0.681 Vali Loss: 0.549 Vali Acc: 0.903 Test Loss: 0.549 Test Acc: 0.903
Validation loss decreased (-0.777759 --> -0.902772).  Saving model ...
Epoch: 3 cost time: 0.5675606727600098
Epoch: 3, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902775).  Saving model ...
Epoch: 4 cost time: 0.5480873584747314
Epoch: 4, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 0.57334303855896
Epoch: 5, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 6 cost time: 0.5443923473358154
Epoch: 6, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 7 cost time: 0.5371055603027344
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 0.553980827331543
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 9 cost time: 0.5748426914215088
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 0.527428150177002
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.5864255428314209
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 0.47489476203918457
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 0.4997520446777344
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5029408931732178
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5401546955108643
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5132756233215332
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.56396484375
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6007587909698486
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6110143661499023
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6059932708740234
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5470116138458252
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5586981773376465
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 2309900
model size : 8.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5376195907592773
Epoch: 1, Steps: 7 | Train Loss: 2.515 Vali Loss: 2.192 Vali Acc: 0.528 Test Loss: 2.192 Test Acc: 0.528
Validation loss decreased (inf --> -0.527756).  Saving model ...
Epoch: 2 cost time: 0.4856722354888916
Epoch: 2, Steps: 7 | Train Loss: 1.284 Vali Loss: 1.006 Vali Acc: 0.819 Test Loss: 1.006 Test Acc: 0.819
Validation loss decreased (-0.527756 --> -0.819434).  Saving model ...
Epoch: 3 cost time: 0.5017709732055664
Epoch: 3, Steps: 7 | Train Loss: 0.232 Vali Loss: 0.434 Vali Acc: 0.917 Test Loss: 0.434 Test Acc: 0.917
Validation loss decreased (-0.819434 --> -0.916662).  Saving model ...
Epoch: 4 cost time: 0.4479060173034668
Epoch: 4, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 5 cost time: 0.49820709228515625
Epoch: 5, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 6 cost time: 0.4884953498840332
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 7 cost time: 0.46539974212646484
Epoch: 7, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 8 cost time: 0.4773063659667969
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 9 cost time: 0.44169116020202637
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 0.45795488357543945
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.43789029121398926
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.44709348678588867
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.46949052810668945
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.432528018951416
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4234771728515625
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.42464566230773926
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4335517883300781
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.41353893280029297
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.40020298957824707
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.44724297523498535
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1580300
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4960696697235107
Epoch: 1, Steps: 7 | Train Loss: 2.548 Vali Loss: 2.275 Vali Acc: 0.347 Test Loss: 2.275 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 0.43743062019348145
Epoch: 2, Steps: 7 | Train Loss: 1.579 Vali Loss: 1.340 Vali Acc: 0.819 Test Loss: 1.340 Test Acc: 0.819
Validation loss decreased (-0.347199 --> -0.819431).  Saving model ...
Epoch: 3 cost time: 0.45211172103881836
Epoch: 3, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.599 Vali Acc: 0.944 Test Loss: 0.599 Test Acc: 0.944
Validation loss decreased (-0.819431 --> -0.944438).  Saving model ...
Epoch: 4 cost time: 0.4425389766693115
Epoch: 4, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4307689666748047
Epoch: 5, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5277454853057861
Epoch: 6, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.44872498512268066
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.42746448516845703
Epoch: 8, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.44258856773376465
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.46018362045288086
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.43601441383361816
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.44394540786743164
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.47931551933288574
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1348364
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5755517482757568
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.280 Vali Acc: 0.292 Test Loss: 2.280 Test Acc: 0.292
Validation loss decreased (inf --> -0.291644).  Saving model ...
Epoch: 2 cost time: 0.44771289825439453
Epoch: 2, Steps: 7 | Train Loss: 1.727 Vali Loss: 1.524 Vali Acc: 0.819 Test Loss: 1.524 Test Acc: 0.819
Validation loss decreased (-0.291644 --> -0.819429).  Saving model ...
Epoch: 3 cost time: 0.4784884452819824
Epoch: 3, Steps: 7 | Train Loss: 0.684 Vali Loss: 0.800 Vali Acc: 0.889 Test Loss: 0.800 Test Acc: 0.889
Validation loss decreased (-0.819429 --> -0.888881).  Saving model ...
Epoch: 4 cost time: 0.5034761428833008
Epoch: 4, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.417 Vali Acc: 0.917 Test Loss: 0.417 Test Acc: 0.917
Validation loss decreased (-0.888881 --> -0.916662).  Saving model ...
Epoch: 5 cost time: 0.46500277519226074
Epoch: 5, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944442).  Saving model ...
Epoch: 6 cost time: 0.46057581901550293
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.48975396156311035
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.47995662689208984
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.46707797050476074
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.48750853538513184
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.49389195442199707
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.43718719482421875
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.45472025871276855
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4336090087890625
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4663527011871338
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1227020
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5655624866485596
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.389 Vali Acc: 0.208 Test Loss: 2.389 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.4234151840209961
Epoch: 2, Steps: 7 | Train Loss: 1.960 Vali Loss: 1.796 Vali Acc: 0.750 Test Loss: 1.796 Test Acc: 0.750
Validation loss decreased (-0.208309 --> -0.749982).  Saving model ...
Epoch: 3 cost time: 0.45594358444213867
Epoch: 3, Steps: 7 | Train Loss: 1.033 Vali Loss: 1.097 Vali Acc: 0.847 Test Loss: 1.097 Test Acc: 0.847
Validation loss decreased (-0.749982 --> -0.847211).  Saving model ...
Epoch: 4 cost time: 0.4281134605407715
Epoch: 4, Steps: 7 | Train Loss: 0.418 Vali Loss: 0.645 Vali Acc: 0.917 Test Loss: 0.645 Test Acc: 0.917
Validation loss decreased (-0.847211 --> -0.916660).  Saving model ...
Epoch: 5 cost time: 0.4749717712402344
Epoch: 5, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.436 Vali Acc: 0.944 Test Loss: 0.436 Test Acc: 0.944
Validation loss decreased (-0.916660 --> -0.944440).  Saving model ...
Epoch: 6 cost time: 0.40418267250061035
Epoch: 6, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.320 Vali Acc: 0.944 Test Loss: 0.320 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 0.4604921340942383
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.4554600715637207
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 0.45359039306640625
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.48418617248535156
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.5152568817138672
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.4510946273803711
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.43252062797546387
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.4554572105407715
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4573383331298828
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.444843053817749
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4584050178527832
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.5115647315979004
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.490553617477417
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.43451571464538574
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.4437580108642578
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4738340377807617
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.42891383171081543
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.4528224468231201
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.4574708938598633
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.46051812171936035
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.4605984687805176
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.4829981327056885
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.4506251811981201
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.4504730701446533
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.463451623916626
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.4620497226715088
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4596858024597168
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.4351322650909424
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.4434044361114502
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.498537540435791
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.5317380428314209
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.4355652332305908
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.48476672172546387
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.3964710235595703
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.43681955337524414
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.46474575996398926
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.45516347885131836
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.4373924732208252
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.4576992988586426
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.4581320285797119
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.44635486602783203
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.46508288383483887
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5006284713745117
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.4016282558441162
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1131788
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.3766236305236816
Epoch: 1, Steps: 7 | Train Loss: 2.530 Vali Loss: 2.388 Vali Acc: 0.264 Test Loss: 2.388 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.4514765739440918
Epoch: 2, Steps: 7 | Train Loss: 2.072 Vali Loss: 1.916 Vali Acc: 0.542 Test Loss: 1.916 Test Acc: 0.542
Validation loss decreased (-0.263865 --> -0.541648).  Saving model ...
Epoch: 3 cost time: 0.44550108909606934
Epoch: 3, Steps: 7 | Train Loss: 1.356 Vali Loss: 1.323 Vali Acc: 0.778 Test Loss: 1.323 Test Acc: 0.778
Validation loss decreased (-0.541648 --> -0.777765).  Saving model ...
Epoch: 4 cost time: 0.44245076179504395
Epoch: 4, Steps: 7 | Train Loss: 0.700 Vali Loss: 0.882 Vali Acc: 0.861 Test Loss: 0.882 Test Acc: 0.861
Validation loss decreased (-0.777765 --> -0.861102).  Saving model ...
Epoch: 5 cost time: 0.4495980739593506
Epoch: 5, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.574 Vali Acc: 0.903 Test Loss: 0.574 Test Acc: 0.903
Validation loss decreased (-0.861102 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 0.43701958656311035
Epoch: 6, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 0.4228627681732178
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.45943331718444824
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.47777605056762695
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.414306640625
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.958 Test Loss: 0.302 Test Acc: 0.958
Validation loss decreased (-0.930552 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.4376070499420166
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.958 Test Loss: 0.285 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 12 cost time: 0.4455122947692871
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.4223191738128662
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.958 Test Loss: 0.270 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.3896327018737793
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.958 Test Loss: 0.268 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.46849703788757324
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.958 Test Loss: 0.266 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.40712881088256836
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.958 Test Loss: 0.264 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.5147950649261475
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.4404885768890381
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.45468854904174805
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.46167898178100586
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.46508240699768066
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.4756748676300049
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.43300318717956543
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5001752376556396
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.47252726554870605
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.49481797218322754
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.48744940757751465
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.43176770210266113
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.44008755683898926
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.45399904251098633
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.42552876472473145
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.4331328868865967
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.48072314262390137
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.46814537048339844
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.46683382987976074
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.4540107250213623
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.4463496208190918
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.45025181770324707
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.46126842498779297
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.44060635566711426
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.4336569309234619
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.47633886337280273
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.43593645095825195
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.46871352195739746
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.42728257179260254
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4303419589996338
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.43818116188049316
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.42952418327331543
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4363522529602051
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.45157814025878906
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 1073420
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5236802101135254
Epoch: 1, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.374 Vali Acc: 0.222 Test Loss: 2.374 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.4786701202392578
Epoch: 2, Steps: 7 | Train Loss: 2.071 Vali Loss: 1.980 Vali Acc: 0.597 Test Loss: 1.980 Test Acc: 0.597
Validation loss decreased (-0.222198 --> -0.597202).  Saving model ...
Epoch: 3 cost time: 0.4633324146270752
Epoch: 3, Steps: 7 | Train Loss: 1.473 Vali Loss: 1.456 Vali Acc: 0.750 Test Loss: 1.456 Test Acc: 0.750
Validation loss decreased (-0.597202 --> -0.749985).  Saving model ...
Epoch: 4 cost time: 0.4496445655822754
Epoch: 4, Steps: 7 | Train Loss: 0.864 Vali Loss: 1.000 Vali Acc: 0.889 Test Loss: 1.000 Test Acc: 0.889
Validation loss decreased (-0.749985 --> -0.888879).  Saving model ...
Epoch: 5 cost time: 0.4755854606628418
Epoch: 5, Steps: 7 | Train Loss: 0.425 Vali Loss: 0.704 Vali Acc: 0.903 Test Loss: 0.704 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902771).  Saving model ...
Epoch: 6 cost time: 0.35900282859802246
Epoch: 6, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.495 Vali Acc: 0.931 Test Loss: 0.495 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930551).  Saving model ...
Epoch: 7 cost time: 0.42639923095703125
Epoch: 7, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.45281481742858887
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5482330322265625
Epoch: 9, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.38387346267700195
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.346 Vali Acc: 0.931 Test Loss: 0.346 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.3947734832763672
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.40796446800231934
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.4189417362213135
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.46184277534484863
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.46213483810424805
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.44969820976257324
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.4262862205505371
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.4535975456237793
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.4668147563934326
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.4444100856781006
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.48935437202453613
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.4960367679595947
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.43004679679870605
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.4479105472564697
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4158778190612793
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.3934962749481201
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4996919631958008
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.437511682510376
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.39481592178344727
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.4077913761138916
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.3912930488586426
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4497497081756592
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.4247868061065674
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.44867396354675293
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.42676663398742676
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4098024368286133
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.406919002532959
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.47098207473754883
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.39148664474487305
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.45607805252075195
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.46276068687438965
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.46245384216308594
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.45212626457214355
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.42748332023620605
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4671008586883545
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4329543113708496
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.42510414123535156
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.43056797981262207
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.41316819190979004
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.4688410758972168
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 1051916
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.561997652053833
Epoch: 1, Steps: 7 | Train Loss: 2.580 Vali Loss: 2.224 Vali Acc: 0.389 Test Loss: 2.224 Test Acc: 0.389
Validation loss decreased (inf --> -0.388867).  Saving model ...
Epoch: 2 cost time: 0.4545581340789795
Epoch: 2, Steps: 7 | Train Loss: 1.327 Vali Loss: 1.044 Vali Acc: 0.833 Test Loss: 1.044 Test Acc: 0.833
Validation loss decreased (-0.388867 --> -0.833323).  Saving model ...
Epoch: 3 cost time: 0.43539953231811523
Epoch: 3, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.415 Vali Acc: 0.944 Test Loss: 0.415 Test Acc: 0.944
Validation loss decreased (-0.833323 --> -0.944440).  Saving model ...
Epoch: 4 cost time: 0.42330360412597656
Epoch: 4, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 5 cost time: 0.45691561698913574
Epoch: 5, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4564816951751709
Epoch: 6, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.44090819358825684
Epoch: 7, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4704592227935791
Epoch: 8, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.4697856903076172
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.45131826400756836
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.4558851718902588
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.4496161937713623
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.4700813293457031
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.48471498489379883
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.45120787620544434
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.46045875549316406
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.4819602966308594
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.45635008811950684
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.4440748691558838
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.4420969486236572
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.44548678398132324
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.4824209213256836
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.44437503814697266
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.45923566818237305
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.5194222927093506
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.44155120849609375
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.48165249824523926
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.46353650093078613
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5196506977081299
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4555931091308594
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.42585301399230957
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.42053723335266113
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4196794033050537
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.43967223167419434
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4573502540588379
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.4676346778869629
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.53033447265625
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.4372880458831787
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.4481654167175293
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.5169932842254639
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4562511444091797
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.43433618545532227
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4642066955566406
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4736144542694092
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.48090171813964844
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.3772087097167969
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.42876338958740234
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.43116307258605957
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.42746472358703613
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.43427228927612305
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 958348
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4745876789093018
Epoch: 1, Steps: 7 | Train Loss: 2.460 Vali Loss: 2.293 Vali Acc: 0.375 Test Loss: 2.293 Test Acc: 0.375
Validation loss decreased (inf --> -0.374977).  Saving model ...
Epoch: 2 cost time: 0.47742509841918945
Epoch: 2, Steps: 7 | Train Loss: 1.691 Vali Loss: 1.470 Vali Acc: 0.792 Test Loss: 1.470 Test Acc: 0.792
Validation loss decreased (-0.374977 --> -0.791652).  Saving model ...
Epoch: 3 cost time: 0.44754862785339355
Epoch: 3, Steps: 7 | Train Loss: 0.656 Vali Loss: 0.753 Vali Acc: 0.931 Test Loss: 0.753 Test Acc: 0.931
Validation loss decreased (-0.791652 --> -0.930548).  Saving model ...
Epoch: 4 cost time: 0.4384644031524658
Epoch: 4, Steps: 7 | Train Loss: 0.176 Vali Loss: 0.442 Vali Acc: 0.917 Test Loss: 0.442 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.43147706985473633
Epoch: 5, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930553).  Saving model ...
Epoch: 6 cost time: 0.4525265693664551
Epoch: 6, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 7 cost time: 0.4233686923980713
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4250502586364746
Epoch: 8, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.46889209747314453
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4331982135772705
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 11 cost time: 0.45950961112976074
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4345541000366211
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.391420841217041
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.41389989852905273
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.47924256324768066
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4276745319366455
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.40465593338012695
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4294006824493408
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.43471717834472656
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4617791175842285
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 593548
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4919161796569824
Epoch: 1, Steps: 7 | Train Loss: 2.474 Vali Loss: 2.323 Vali Acc: 0.264 Test Loss: 2.323 Test Acc: 0.264
Validation loss decreased (inf --> -0.263866).  Saving model ...
Epoch: 2 cost time: 0.40712666511535645
Epoch: 2, Steps: 7 | Train Loss: 1.908 Vali Loss: 1.745 Vali Acc: 0.806 Test Loss: 1.745 Test Acc: 0.806
Validation loss decreased (-0.263866 --> -0.805538).  Saving model ...
Epoch: 3 cost time: 0.46244072914123535
Epoch: 3, Steps: 7 | Train Loss: 0.999 Vali Loss: 1.059 Vali Acc: 0.875 Test Loss: 1.059 Test Acc: 0.875
Validation loss decreased (-0.805538 --> -0.874989).  Saving model ...
Epoch: 4 cost time: 0.44614243507385254
Epoch: 4, Steps: 7 | Train Loss: 0.416 Vali Loss: 0.614 Vali Acc: 0.903 Test Loss: 0.614 Test Acc: 0.903
Validation loss decreased (-0.874989 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 0.4094514846801758
Epoch: 5, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.389 Vali Acc: 0.931 Test Loss: 0.389 Test Acc: 0.931
Validation loss decreased (-0.902772 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 0.43048787117004395
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.40102458000183105
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.4238929748535156
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.4168243408203125
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.4234657287597656
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.4572598934173584
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.3887321949005127
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.4371049404144287
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.41933107376098633
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.3956136703491211
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4250929355621338
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.4012458324432373
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.41198229789733887
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.4363672733306885
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.4252665042877197
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.37463808059692383
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.41555309295654297
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.41457557678222656
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.40062594413757324
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.4284627437591553
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.4262557029724121
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.37814927101135254
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4229307174682617
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.4042840003967285
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.44313764572143555
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.37990403175354004
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.4215528964996338
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.40680551528930664
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.4106111526489258
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.41635727882385254
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.43536829948425293
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.44339513778686523
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.42601871490478516
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.4153294563293457
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4248194694519043
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.38062119483947754
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.4280660152435303
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.43324828147888184
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.3950989246368408
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 45 cost time: 0.44307684898376465
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.4028646945953369
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.4226512908935547
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.44588184356689453
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.46260619163513184
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4349219799041748
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 477580
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4495220184326172
Epoch: 1, Steps: 7 | Train Loss: 2.482 Vali Loss: 2.427 Vali Acc: 0.111 Test Loss: 2.427 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.40555310249328613
Epoch: 2, Steps: 7 | Train Loss: 2.044 Vali Loss: 1.993 Vali Acc: 0.597 Test Loss: 1.993 Test Acc: 0.597
Validation loss decreased (-0.111087 --> -0.597202).  Saving model ...
Epoch: 3 cost time: 0.39798569679260254
Epoch: 3, Steps: 7 | Train Loss: 1.340 Vali Loss: 1.413 Vali Acc: 0.819 Test Loss: 1.413 Test Acc: 0.819
Validation loss decreased (-0.597202 --> -0.819430).  Saving model ...
Epoch: 4 cost time: 0.4939262866973877
Epoch: 4, Steps: 7 | Train Loss: 0.683 Vali Loss: 0.890 Vali Acc: 0.903 Test Loss: 0.890 Test Acc: 0.903
Validation loss decreased (-0.819430 --> -0.902769).  Saving model ...
Epoch: 5 cost time: 0.4011821746826172
Epoch: 5, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.555 Vali Acc: 0.917 Test Loss: 0.555 Test Acc: 0.917
Validation loss decreased (-0.902769 --> -0.916661).  Saving model ...
Epoch: 6 cost time: 0.4594707489013672
Epoch: 6, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.400 Vali Acc: 0.931 Test Loss: 0.400 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 0.4283888339996338
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.341 Vali Acc: 0.931 Test Loss: 0.341 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.5226292610168457
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.43274998664855957
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.4180142879486084
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.4488675594329834
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.38001298904418945
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.4420757293701172
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.4373607635498047
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.41382455825805664
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.4177238941192627
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.4793565273284912
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4236128330230713
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.4123237133026123
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.44092512130737305
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.41083717346191406
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.365814208984375
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.44239163398742676
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.44527626037597656
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4042067527770996
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5031533241271973
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.44673633575439453
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.41059279441833496
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.4334840774536133
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.39953136444091797
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.3948507308959961
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.4340500831604004
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.4283158779144287
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.4671666622161865
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.42728710174560547
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.40729331970214844
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.43320703506469727
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.44954371452331543
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4003582000732422
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.41928863525390625
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.41904354095458984
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.41207218170166016
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.4389076232910156
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.41664862632751465
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.4355742931365967
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.4172670841217041
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.3917660713195801
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.47008633613586426
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.44832372665405273
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.37222862243652344
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 416908
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.404123067855835
Epoch: 1, Steps: 7 | Train Loss: 2.625 Vali Loss: 2.438 Vali Acc: 0.125 Test Loss: 2.438 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.4009687900543213
Epoch: 2, Steps: 7 | Train Loss: 2.297 Vali Loss: 2.110 Vali Acc: 0.472 Test Loss: 2.110 Test Acc: 0.472
Validation loss decreased (-0.124976 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 0.39492225646972656
Epoch: 3, Steps: 7 | Train Loss: 1.716 Vali Loss: 1.639 Vali Acc: 0.667 Test Loss: 1.639 Test Acc: 0.667
Validation loss decreased (-0.472201 --> -0.666650).  Saving model ...
Epoch: 4 cost time: 0.36644458770751953
Epoch: 4, Steps: 7 | Train Loss: 1.088 Vali Loss: 1.155 Vali Acc: 0.819 Test Loss: 1.155 Test Acc: 0.819
Validation loss decreased (-0.666650 --> -0.819433).  Saving model ...
Epoch: 5 cost time: 0.4271676540374756
Epoch: 5, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.807 Vali Acc: 0.889 Test Loss: 0.807 Test Acc: 0.889
Validation loss decreased (-0.819433 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 0.3749880790710449
Epoch: 6, Steps: 7 | Train Loss: 0.318 Vali Loss: 0.565 Vali Acc: 0.944 Test Loss: 0.565 Test Acc: 0.944
Validation loss decreased (-0.888881 --> -0.944439).  Saving model ...
Epoch: 7 cost time: 0.37705326080322266
Epoch: 7, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.449 Vali Acc: 0.931 Test Loss: 0.449 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3868849277496338
Epoch: 8, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.357 Vali Acc: 0.944 Test Loss: 0.357 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 0.38237524032592773
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.315 Vali Acc: 0.958 Test Loss: 0.315 Test Acc: 0.958
Validation loss decreased (-0.944441 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.34641218185424805
Epoch: 10, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.289 Vali Acc: 0.958 Test Loss: 0.289 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.3702104091644287
Epoch: 11, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.277 Vali Acc: 0.958 Test Loss: 0.277 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.37050938606262207
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.972 Test Loss: 0.270 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 13 cost time: 0.374269962310791
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.972 Test Loss: 0.264 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 14 cost time: 0.4166100025177002
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.972 Test Loss: 0.258 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 15 cost time: 0.3903543949127197
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.972 Test Loss: 0.253 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 16 cost time: 0.34531569480895996
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.972 Test Loss: 0.251 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 17 cost time: 0.4493076801300049
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.972 Test Loss: 0.248 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 18 cost time: 0.3511531352996826
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.972 Test Loss: 0.242 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.36125850677490234
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.972 Test Loss: 0.238 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.3763248920440674
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.4409303665161133
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.3720364570617676
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.972 Test Loss: 0.228 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 0.37247657775878906
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.39850282669067383
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3598935604095459
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.37752819061279297
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 27 cost time: 0.35661768913269043
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4193897247314453
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.38427281379699707
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.3798635005950928
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.40713071823120117
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.38146352767944336
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.37846827507019043
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.35569214820861816
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.40146350860595703
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.36303067207336426
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 369292
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.5124869346618652
Epoch: 1, Steps: 7 | Train Loss: 2.524 Vali Loss: 2.431 Vali Acc: 0.125 Test Loss: 2.431 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.421889066696167
Epoch: 2, Steps: 7 | Train Loss: 2.276 Vali Loss: 2.189 Vali Acc: 0.333 Test Loss: 2.189 Test Acc: 0.333
Validation loss decreased (-0.124976 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.4262533187866211
Epoch: 3, Steps: 7 | Train Loss: 1.832 Vali Loss: 1.831 Vali Acc: 0.708 Test Loss: 1.831 Test Acc: 0.708
Validation loss decreased (-0.333311 --> -0.708315).  Saving model ...
Epoch: 4 cost time: 0.39980626106262207
Epoch: 4, Steps: 7 | Train Loss: 1.344 Vali Loss: 1.434 Vali Acc: 0.792 Test Loss: 1.434 Test Acc: 0.792
Validation loss decreased (-0.708315 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.3815431594848633
Epoch: 5, Steps: 7 | Train Loss: 0.880 Vali Loss: 1.085 Vali Acc: 0.847 Test Loss: 1.085 Test Acc: 0.847
Validation loss decreased (-0.791652 --> -0.847211).  Saving model ...
Epoch: 6 cost time: 0.42457151412963867
Epoch: 6, Steps: 7 | Train Loss: 0.545 Vali Loss: 0.812 Vali Acc: 0.875 Test Loss: 0.812 Test Acc: 0.875
Validation loss decreased (-0.847211 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.4077415466308594
Epoch: 7, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.603 Vali Acc: 0.931 Test Loss: 0.603 Test Acc: 0.931
Validation loss decreased (-0.874992 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.39867734909057617
Epoch: 8, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.498 Vali Acc: 0.931 Test Loss: 0.498 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 9 cost time: 0.3947880268096924
Epoch: 9, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.447 Vali Acc: 0.917 Test Loss: 0.447 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.3556675910949707
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.405 Vali Acc: 0.917 Test Loss: 0.405 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.38778066635131836
Epoch: 11, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.378 Vali Acc: 0.931 Test Loss: 0.378 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.3798646926879883
Epoch: 12, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.355 Vali Acc: 0.931 Test Loss: 0.355 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.41999173164367676
Epoch: 13, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.335 Vali Acc: 0.931 Test Loss: 0.335 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.35729217529296875
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 0.35996103286743164
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.317 Vali Acc: 0.931 Test Loss: 0.317 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.4037199020385742
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 0.377352237701416
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.3676598072052002
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.3571798801422119
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.38458895683288574
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.4003486633300781
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.40358614921569824
Epoch: 22, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.4295032024383545
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.4092714786529541
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.36398959159851074
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.4245009422302246
Epoch: 26, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.3661983013153076
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.3619065284729004
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.33802151679992676
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.4073474407196045
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.4084146022796631
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.3537452220916748
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.35356879234313965
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.3674335479736328
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.36209845542907715
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.39638257026672363
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.3803536891937256
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.3767669200897217
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.3980522155761719
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.3484842777252197
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.37825536727905273
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.37987709045410156
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.38182973861694336
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.44705867767333984
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.37905430793762207
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.3341250419616699
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.39912867546081543
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.36322546005249023
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.38808608055114746
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.38373661041259766
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 340108
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4213685989379883
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.481 Vali Acc: 0.097 Test Loss: 2.481 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.3894174098968506
Epoch: 2, Steps: 7 | Train Loss: 2.369 Vali Loss: 2.284 Vali Acc: 0.278 Test Loss: 2.284 Test Acc: 0.278
Validation loss decreased (-0.097197 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.46065497398376465
Epoch: 3, Steps: 7 | Train Loss: 1.984 Vali Loss: 1.968 Vali Acc: 0.597 Test Loss: 1.968 Test Acc: 0.597
Validation loss decreased (-0.277755 --> -0.597203).  Saving model ...
Epoch: 4 cost time: 0.4516928195953369
Epoch: 4, Steps: 7 | Train Loss: 1.535 Vali Loss: 1.604 Vali Acc: 0.792 Test Loss: 1.604 Test Acc: 0.792
Validation loss decreased (-0.597203 --> -0.791651).  Saving model ...
Epoch: 5 cost time: 0.47539782524108887
Epoch: 5, Steps: 7 | Train Loss: 1.103 Vali Loss: 1.271 Vali Acc: 0.847 Test Loss: 1.271 Test Acc: 0.847
Validation loss decreased (-0.791651 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 0.41901493072509766
Epoch: 6, Steps: 7 | Train Loss: 0.754 Vali Loss: 0.999 Vali Acc: 0.861 Test Loss: 0.999 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861101).  Saving model ...
Epoch: 7 cost time: 0.4229013919830322
Epoch: 7, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.783 Vali Acc: 0.875 Test Loss: 0.783 Test Acc: 0.875
Validation loss decreased (-0.861101 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.4324917793273926
Epoch: 8, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.632 Vali Acc: 0.889 Test Loss: 0.632 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 0.44565844535827637
Epoch: 9, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.537 Vali Acc: 0.917 Test Loss: 0.537 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916661).  Saving model ...
Epoch: 10 cost time: 0.43271541595458984
Epoch: 10, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.486 Vali Acc: 0.917 Test Loss: 0.486 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 0.41348743438720703
Epoch: 11, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.444 Vali Acc: 0.917 Test Loss: 0.444 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 12 cost time: 0.3981485366821289
Epoch: 12, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43633127212524414
Epoch: 13, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.403 Vali Acc: 0.903 Test Loss: 0.403 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4483344554901123
Epoch: 14, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.422271728515625
Epoch: 15, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.366 Vali Acc: 0.931 Test Loss: 0.366 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 16 cost time: 0.40740251541137695
Epoch: 16, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4125058650970459
Epoch: 17, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.385953426361084
Epoch: 18, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3827486038208008
Epoch: 19, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.345 Vali Acc: 0.931 Test Loss: 0.345 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 0.39261436462402344
Epoch: 20, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 21 cost time: 0.38123250007629395
Epoch: 21, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.333 Vali Acc: 0.931 Test Loss: 0.333 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 22 cost time: 0.4191610813140869
Epoch: 22, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.3853952884674072
Epoch: 23, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.325 Vali Acc: 0.931 Test Loss: 0.325 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 24 cost time: 0.3877120018005371
Epoch: 24, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.931 Test Loss: 0.321 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.3665769100189209
Epoch: 25, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.3963444232940674
Epoch: 26, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.317 Vali Acc: 0.931 Test Loss: 0.317 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.416675329208374
Epoch: 27, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.313 Vali Acc: 0.931 Test Loss: 0.313 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.40963149070739746
Epoch: 28, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 29 cost time: 0.4294722080230713
Epoch: 29, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 30 cost time: 0.380692720413208
Epoch: 30, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4366326332092285
Epoch: 31, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.4973599910736084
Epoch: 32, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.41704559326171875
Epoch: 33, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.3708193302154541
Epoch: 34, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.4020705223083496
Epoch: 35, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.931 Test Loss: 0.295 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.3999817371368408
Epoch: 36, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.42952609062194824
Epoch: 37, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.4433159828186035
Epoch: 38, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.3802821636199951
Epoch: 39, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.4016880989074707
Epoch: 40, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.3916501998901367
Epoch: 41, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.393338680267334
Epoch: 42, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4275379180908203
Epoch: 43, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4151434898376465
Epoch: 44, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.4234919548034668
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.4229867458343506
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.43624114990234375
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.4453272819519043
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.42850303649902344
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.41165924072265625
Epoch: 50, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 329356
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4230518341064453
Epoch: 1, Steps: 7 | Train Loss: 2.520 Vali Loss: 2.364 Vali Acc: 0.208 Test Loss: 2.364 Test Acc: 0.208
Validation loss decreased (inf --> -0.208310).  Saving model ...
Epoch: 2 cost time: 0.38942432403564453
Epoch: 2, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.663 Vali Acc: 0.750 Test Loss: 1.663 Test Acc: 0.750
Validation loss decreased (-0.208310 --> -0.749983).  Saving model ...
Epoch: 3 cost time: 0.42728495597839355
Epoch: 3, Steps: 7 | Train Loss: 0.715 Vali Loss: 0.894 Vali Acc: 0.903 Test Loss: 0.894 Test Acc: 0.903
Validation loss decreased (-0.749983 --> -0.902769).  Saving model ...
Epoch: 4 cost time: 0.38295769691467285
Epoch: 4, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.458 Vali Acc: 0.931 Test Loss: 0.458 Test Acc: 0.931
Validation loss decreased (-0.902769 --> -0.930551).  Saving model ...
Epoch: 5 cost time: 0.3989696502685547
Epoch: 5, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 6 cost time: 0.37224388122558594
Epoch: 6, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 7 cost time: 0.36283254623413086
Epoch: 7, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
Validation loss decreased (-0.930553 --> -0.972220).  Saving model ...
Epoch: 8 cost time: 0.35987234115600586
Epoch: 8, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4123687744140625
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3751716613769531
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3471541404724121
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3409080505371094
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3672215938568115
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.3371765613555908
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.3324916362762451
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.345012903213501
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.360701322555542
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 430028
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4243195056915283
Epoch: 1, Steps: 7 | Train Loss: 2.535 Vali Loss: 2.379 Vali Acc: 0.181 Test Loss: 2.379 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.3719792366027832
Epoch: 2, Steps: 7 | Train Loss: 2.094 Vali Loss: 1.916 Vali Acc: 0.611 Test Loss: 1.916 Test Acc: 0.611
Validation loss decreased (-0.180532 --> -0.611092).  Saving model ...
Epoch: 3 cost time: 0.3994472026824951
Epoch: 3, Steps: 7 | Train Loss: 1.356 Vali Loss: 1.320 Vali Acc: 0.806 Test Loss: 1.320 Test Acc: 0.806
Validation loss decreased (-0.611092 --> -0.805542).  Saving model ...
Epoch: 4 cost time: 0.37288761138916016
Epoch: 4, Steps: 7 | Train Loss: 0.691 Vali Loss: 0.828 Vali Acc: 0.903 Test Loss: 0.828 Test Acc: 0.903
Validation loss decreased (-0.805542 --> -0.902769).  Saving model ...
Epoch: 5 cost time: 0.3918626308441162
Epoch: 5, Steps: 7 | Train Loss: 0.303 Vali Loss: 0.556 Vali Acc: 0.903 Test Loss: 0.556 Test Acc: 0.903
Validation loss decreased (-0.902769 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 0.3687920570373535
Epoch: 6, Steps: 7 | Train Loss: 0.127 Vali Loss: 0.388 Vali Acc: 0.917 Test Loss: 0.388 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.37944912910461426
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.3722364902496338
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.3859727382659912
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.3877441883087158
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.4068882465362549
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.4220089912414551
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.36499738693237305
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.3712794780731201
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.4014577865600586
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.3419761657714844
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.3905313014984131
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.3466603755950928
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.4036378860473633
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.36809849739074707
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.3739359378814697
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 0.4032161235809326
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 0.4085381031036377
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 0.37592339515686035
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 0.39957118034362793
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 0.45139074325561523
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 0.3822622299194336
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 0.39760279655456543
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 0.3710668087005615
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.40808749198913574
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.3629035949707031
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4248960018157959
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 33 cost time: 0.351762056350708
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 34 cost time: 0.3795900344848633
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 35 cost time: 0.39734506607055664
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 36 cost time: 0.3863089084625244
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 37 cost time: 0.39916038513183594
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.36539173126220703
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.3820624351501465
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 40 cost time: 0.37635231018066406
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 41 cost time: 0.36633944511413574
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 42 cost time: 0.3788001537322998
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 43 cost time: 0.37830591201782227
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 44 cost time: 0.3918604850769043
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 45 cost time: 0.3857753276824951
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 46 cost time: 0.3879096508026123
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 47 cost time: 0.4650123119354248
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 48 cost time: 0.37417125701904297
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.39240264892578125
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.40822720527648926
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 247628
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4617502689361572
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.466 Vali Acc: 0.125 Test Loss: 2.466 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.4328615665435791
Epoch: 2, Steps: 7 | Train Loss: 2.260 Vali Loss: 2.160 Vali Acc: 0.417 Test Loss: 2.160 Test Acc: 0.417
Validation loss decreased (-0.124975 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.40087890625
Epoch: 3, Steps: 7 | Train Loss: 1.672 Vali Loss: 1.707 Vali Acc: 0.681 Test Loss: 1.707 Test Acc: 0.681
Validation loss decreased (-0.416645 --> -0.680538).  Saving model ...
Epoch: 4 cost time: 0.36910152435302734
Epoch: 4, Steps: 7 | Train Loss: 1.105 Vali Loss: 1.219 Vali Acc: 0.806 Test Loss: 1.219 Test Acc: 0.806
Validation loss decreased (-0.680538 --> -0.805543).  Saving model ...
Epoch: 5 cost time: 0.4013707637786865
Epoch: 5, Steps: 7 | Train Loss: 0.627 Vali Loss: 0.818 Vali Acc: 0.875 Test Loss: 0.818 Test Acc: 0.875
Validation loss decreased (-0.805543 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.3784012794494629
Epoch: 6, Steps: 7 | Train Loss: 0.313 Vali Loss: 0.577 Vali Acc: 0.903 Test Loss: 0.577 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.3548133373260498
Epoch: 7, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.38461780548095703
Epoch: 8, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.3762662410736084
Epoch: 9, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.3825654983520508
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.3871729373931885
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.3489949703216553
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.38616943359375
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3489797115325928
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.403428316116333
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.38677096366882324
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.35422587394714355
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.3869779109954834
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.39747071266174316
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.4134700298309326
Epoch: 20, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.37982177734375
Epoch: 21, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.4018399715423584
Epoch: 22, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.39617443084716797
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.36671972274780273
Epoch: 24, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.3796834945678711
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.3931288719177246
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.39891481399536133
Epoch: 27, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.3411870002746582
Epoch: 28, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.40465450286865234
Epoch: 29, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.3438589572906494
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.37989091873168945
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.4070441722869873
Epoch: 32, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.3756239414215088
Epoch: 33, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.3653066158294678
Epoch: 34, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4286923408508301
Epoch: 35, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.38298702239990234
Epoch: 36, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.3811008930206299
Epoch: 37, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.3952627182006836
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.35197019577026367
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.3624887466430664
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4006826877593994
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 189644
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4542317390441895
Epoch: 1, Steps: 7 | Train Loss: 2.490 Vali Loss: 2.427 Vali Acc: 0.153 Test Loss: 2.427 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.3841249942779541
Epoch: 2, Steps: 7 | Train Loss: 2.250 Vali Loss: 2.187 Vali Acc: 0.444 Test Loss: 2.187 Test Acc: 0.444
Validation loss decreased (-0.152754 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.3912785053253174
Epoch: 3, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.818 Vali Acc: 0.653 Test Loss: 1.818 Test Acc: 0.653
Validation loss decreased (-0.444423 --> -0.652760).  Saving model ...
Epoch: 4 cost time: 0.3926558494567871
Epoch: 4, Steps: 7 | Train Loss: 1.336 Vali Loss: 1.419 Vali Acc: 0.819 Test Loss: 1.419 Test Acc: 0.819
Validation loss decreased (-0.652760 --> -0.819430).  Saving model ...
Epoch: 5 cost time: 0.4013502597808838
Epoch: 5, Steps: 7 | Train Loss: 0.882 Vali Loss: 1.059 Vali Acc: 0.861 Test Loss: 1.059 Test Acc: 0.861
Validation loss decreased (-0.819430 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 0.3542139530181885
Epoch: 6, Steps: 7 | Train Loss: 0.545 Vali Loss: 0.774 Vali Acc: 0.889 Test Loss: 0.774 Test Acc: 0.889
Validation loss decreased (-0.861101 --> -0.888881).  Saving model ...
Epoch: 7 cost time: 0.3963203430175781
Epoch: 7, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.585 Vali Acc: 0.931 Test Loss: 0.585 Test Acc: 0.931
Validation loss decreased (-0.888881 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.3789372444152832
Epoch: 8, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.476 Vali Acc: 0.903 Test Loss: 0.476 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3580925464630127
Epoch: 9, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.423 Vali Acc: 0.931 Test Loss: 0.423 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 10 cost time: 0.3860819339752197
Epoch: 10, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4621906280517578
Epoch: 11, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.39852285385131836
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.38962793350219727
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.39650726318359375
Epoch: 14, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.293 Vali Acc: 0.931 Test Loss: 0.293 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.4005272388458252
Epoch: 15, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.38050293922424316
Epoch: 16, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.4786860942840576
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.4357120990753174
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.394284725189209
Epoch: 19, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.4274311065673828
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.3691825866699219
Epoch: 21, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.3638885021209717
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.42609167098999023
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.36899518966674805
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.41701579093933105
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.3819160461425781
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.3755955696105957
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.3917520046234131
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.40684938430786133
Epoch: 29, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.3944978713989258
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.3726198673248291
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.3806874752044678
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.4607508182525635
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 0.3921341896057129
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.38106489181518555
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.3571147918701172
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.3856673240661621
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.44626545906066895
Epoch: 38, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.42563366889953613
Epoch: 39, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 0.3898465633392334
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.40257954597473145
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 42 cost time: 0.3893778324127197
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 0.3989827632904053
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.41866517066955566
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.42841124534606934
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.36643123626708984
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.3670947551727295
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.3735992908477783
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.3894002437591553
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.37501096725463867
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 159308
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.470763921737671
Epoch: 1, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.422 Vali Acc: 0.139 Test Loss: 2.422 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.39475560188293457
Epoch: 2, Steps: 7 | Train Loss: 2.305 Vali Loss: 2.232 Vali Acc: 0.333 Test Loss: 2.232 Test Acc: 0.333
Validation loss decreased (-0.138865 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.3736739158630371
Epoch: 3, Steps: 7 | Train Loss: 1.955 Vali Loss: 1.946 Vali Acc: 0.625 Test Loss: 1.946 Test Acc: 0.625
Validation loss decreased (-0.333311 --> -0.624981).  Saving model ...
Epoch: 4 cost time: 0.4054410457611084
Epoch: 4, Steps: 7 | Train Loss: 1.580 Vali Loss: 1.618 Vali Acc: 0.764 Test Loss: 1.618 Test Acc: 0.764
Validation loss decreased (-0.624981 --> -0.763873).  Saving model ...
Epoch: 5 cost time: 0.4176619052886963
Epoch: 5, Steps: 7 | Train Loss: 1.170 Vali Loss: 1.295 Vali Acc: 0.847 Test Loss: 1.295 Test Acc: 0.847
Validation loss decreased (-0.763873 --> -0.847209).  Saving model ...
Epoch: 6 cost time: 0.40238261222839355
Epoch: 6, Steps: 7 | Train Loss: 0.841 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
Validation loss decreased (-0.847209 --> -0.861101).  Saving model ...
Epoch: 7 cost time: 0.3710896968841553
Epoch: 7, Steps: 7 | Train Loss: 0.575 Vali Loss: 0.803 Vali Acc: 0.903 Test Loss: 0.803 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902770).  Saving model ...
Epoch: 8 cost time: 0.3926970958709717
Epoch: 8, Steps: 7 | Train Loss: 0.378 Vali Loss: 0.649 Vali Acc: 0.917 Test Loss: 0.649 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916660).  Saving model ...
Epoch: 9 cost time: 0.3915748596191406
Epoch: 9, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.556 Vali Acc: 0.917 Test Loss: 0.556 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916661).  Saving model ...
Epoch: 10 cost time: 0.36997294425964355
Epoch: 10, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 11 cost time: 0.3898465633392334
Epoch: 11, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.426 Vali Acc: 0.944 Test Loss: 0.426 Test Acc: 0.944
Validation loss decreased (-0.916662 --> -0.944440).  Saving model ...
Epoch: 12 cost time: 0.3668534755706787
Epoch: 12, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.391 Vali Acc: 0.944 Test Loss: 0.391 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.4115865230560303
Epoch: 13, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.41179347038269043
Epoch: 14, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.357 Vali Acc: 0.944 Test Loss: 0.357 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.4028894901275635
Epoch: 15, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.348 Vali Acc: 0.944 Test Loss: 0.348 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.39133787155151367
Epoch: 16, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.336 Vali Acc: 0.944 Test Loss: 0.336 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.37503576278686523
Epoch: 17, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.42000317573547363
Epoch: 18, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.412384033203125
Epoch: 19, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.3648381233215332
Epoch: 20, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.39840173721313477
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 22 cost time: 0.3948981761932373
Epoch: 22, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.41487836837768555
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.41625475883483887
Epoch: 24, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4169151782989502
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.3966679573059082
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.42484021186828613
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.37166595458984375
Epoch: 28, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.42786145210266113
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.39587831497192383
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.3910367488861084
Epoch: 31, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.4655613899230957
Epoch: 32, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.3747279644012451
Epoch: 33, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.41589903831481934
Epoch: 34, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.39957261085510254
Epoch: 35, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.38027381896972656
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.38455915451049805
Epoch: 37, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.41346120834350586
Epoch: 38, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.38900279998779297
Epoch: 39, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3690323829650879
Epoch: 40, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.3904385566711426
Epoch: 41, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.4224064350128174
Epoch: 42, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.4023451805114746
Epoch: 43, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.41067028045654297
Epoch: 44, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.36409831047058105
Epoch: 45, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.3747110366821289
Epoch: 46, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.39017701148986816
Epoch: 47, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.4120044708251953
Epoch: 48, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.3969123363494873
Epoch: 49, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.37047338485717773
Epoch: 50, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 135500
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.3433871269226074
Epoch: 1, Steps: 7 | Train Loss: 2.536 Vali Loss: 2.465 Vali Acc: 0.153 Test Loss: 2.465 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.3751816749572754
Epoch: 2, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.337 Vali Acc: 0.264 Test Loss: 2.337 Test Acc: 0.264
Validation loss decreased (-0.152753 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.3826298713684082
Epoch: 3, Steps: 7 | Train Loss: 2.166 Vali Loss: 2.131 Vali Acc: 0.458 Test Loss: 2.131 Test Acc: 0.458
Validation loss decreased (-0.263866 --> -0.458312).  Saving model ...
Epoch: 4 cost time: 0.3663802146911621
Epoch: 4, Steps: 7 | Train Loss: 1.885 Vali Loss: 1.882 Vali Acc: 0.625 Test Loss: 1.882 Test Acc: 0.625
Validation loss decreased (-0.458312 --> -0.624981).  Saving model ...
Epoch: 5 cost time: 0.39664530754089355
Epoch: 5, Steps: 7 | Train Loss: 1.546 Vali Loss: 1.623 Vali Acc: 0.736 Test Loss: 1.623 Test Acc: 0.736
Validation loss decreased (-0.624981 --> -0.736095).  Saving model ...
Epoch: 6 cost time: 0.3998887538909912
Epoch: 6, Steps: 7 | Train Loss: 1.229 Vali Loss: 1.377 Vali Acc: 0.806 Test Loss: 1.377 Test Acc: 0.806
Validation loss decreased (-0.736095 --> -0.805542).  Saving model ...
Epoch: 7 cost time: 0.40787601470947266
Epoch: 7, Steps: 7 | Train Loss: 0.957 Vali Loss: 1.158 Vali Acc: 0.861 Test Loss: 1.158 Test Acc: 0.861
Validation loss decreased (-0.805542 --> -0.861100).  Saving model ...
Epoch: 8 cost time: 0.3863258361816406
Epoch: 8, Steps: 7 | Train Loss: 0.701 Vali Loss: 0.961 Vali Acc: 0.889 Test Loss: 0.961 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888879).  Saving model ...
Epoch: 9 cost time: 0.3904263973236084
Epoch: 9, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.808 Vali Acc: 0.903 Test Loss: 0.808 Test Acc: 0.903
Validation loss decreased (-0.888879 --> -0.902770).  Saving model ...
Epoch: 10 cost time: 0.37816500663757324
Epoch: 10, Steps: 7 | Train Loss: 0.362 Vali Loss: 0.684 Vali Acc: 0.917 Test Loss: 0.684 Test Acc: 0.917
Validation loss decreased (-0.902770 --> -0.916660).  Saving model ...
Epoch: 11 cost time: 0.38808679580688477
Epoch: 11, Steps: 7 | Train Loss: 0.262 Vali Loss: 0.599 Vali Acc: 0.917 Test Loss: 0.599 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916661).  Saving model ...
Epoch: 12 cost time: 0.4094867706298828
Epoch: 12, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.534 Vali Acc: 0.931 Test Loss: 0.534 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930550).  Saving model ...
Epoch: 13 cost time: 0.39540719985961914
Epoch: 13, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.500 Vali Acc: 0.917 Test Loss: 0.500 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3659632205963135
Epoch: 14, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.473 Vali Acc: 0.917 Test Loss: 0.473 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3682363033294678
Epoch: 15, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.40352559089660645
Epoch: 16, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4246976375579834
Epoch: 17, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.406 Vali Acc: 0.917 Test Loss: 0.406 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.3766038417816162
Epoch: 18, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.392 Vali Acc: 0.917 Test Loss: 0.392 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3714616298675537
Epoch: 19, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.37754154205322266
Epoch: 20, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.376 Vali Acc: 0.917 Test Loss: 0.376 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4035313129425049
Epoch: 21, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.46291041374206543
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 120908
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4898629188537598
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.518 Vali Acc: 0.083 Test Loss: 2.518 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.38219761848449707
Epoch: 2, Steps: 7 | Train Loss: 2.477 Vali Loss: 2.392 Vali Acc: 0.250 Test Loss: 2.392 Test Acc: 0.250
Validation loss decreased (-0.083308 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 0.39272022247314453
Epoch: 3, Steps: 7 | Train Loss: 2.239 Vali Loss: 2.191 Vali Acc: 0.417 Test Loss: 2.191 Test Acc: 0.417
Validation loss decreased (-0.249976 --> -0.416645).  Saving model ...
Epoch: 4 cost time: 0.39766478538513184
Epoch: 4, Steps: 7 | Train Loss: 1.951 Vali Loss: 1.947 Vali Acc: 0.569 Test Loss: 1.947 Test Acc: 0.569
Validation loss decreased (-0.416645 --> -0.569425).  Saving model ...
Epoch: 5 cost time: 0.3933374881744385
Epoch: 5, Steps: 7 | Train Loss: 1.643 Vali Loss: 1.690 Vali Acc: 0.681 Test Loss: 1.690 Test Acc: 0.681
Validation loss decreased (-0.569425 --> -0.680539).  Saving model ...
Epoch: 6 cost time: 0.3784019947052002
Epoch: 6, Steps: 7 | Train Loss: 1.370 Vali Loss: 1.448 Vali Acc: 0.764 Test Loss: 1.448 Test Acc: 0.764
Validation loss decreased (-0.680539 --> -0.763874).  Saving model ...
Epoch: 7 cost time: 0.3774271011352539
Epoch: 7, Steps: 7 | Train Loss: 1.100 Vali Loss: 1.227 Vali Acc: 0.792 Test Loss: 1.227 Test Acc: 0.792
Validation loss decreased (-0.763874 --> -0.791654).  Saving model ...
Epoch: 8 cost time: 0.3942692279815674
Epoch: 8, Steps: 7 | Train Loss: 0.838 Vali Loss: 1.040 Vali Acc: 0.833 Test Loss: 1.040 Test Acc: 0.833
Validation loss decreased (-0.791654 --> -0.833323).  Saving model ...
Epoch: 9 cost time: 0.40709781646728516
Epoch: 9, Steps: 7 | Train Loss: 0.646 Vali Loss: 0.892 Vali Acc: 0.847 Test Loss: 0.892 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847213).  Saving model ...
Epoch: 10 cost time: 0.3974153995513916
Epoch: 10, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.781 Vali Acc: 0.847 Test Loss: 0.781 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847214).  Saving model ...
Epoch: 11 cost time: 0.3791184425354004
Epoch: 11, Steps: 7 | Train Loss: 0.361 Vali Loss: 0.689 Vali Acc: 0.847 Test Loss: 0.689 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847215).  Saving model ...
Epoch: 12 cost time: 0.35134172439575195
Epoch: 12, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.597 Vali Acc: 0.903 Test Loss: 0.597 Test Acc: 0.903
Validation loss decreased (-0.847215 --> -0.902772).  Saving model ...
Epoch: 13 cost time: 0.37530016899108887
Epoch: 13, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.546 Vali Acc: 0.903 Test Loss: 0.546 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 14 cost time: 0.4328734874725342
Epoch: 14, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.515 Vali Acc: 0.903 Test Loss: 0.515 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 15 cost time: 0.3883805274963379
Epoch: 15, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.378556489944458
Epoch: 16, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.38236403465270996
Epoch: 17, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.37209630012512207
Epoch: 18, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.44324445724487305
Epoch: 19, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4172689914703369
Epoch: 20, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4159584045410156
Epoch: 21, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4059891700744629
Epoch: 22, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 23 cost time: 0.3493645191192627
Epoch: 23, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.38568758964538574
Epoch: 24, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4872462749481201
Epoch: 25, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 0.36008501052856445
Epoch: 26, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 0.41608190536499023
Epoch: 27, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 0.37098169326782227
Epoch: 28, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.38138294219970703
Epoch: 29, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4080369472503662
Epoch: 30, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.36130523681640625
Epoch: 31, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 0.36121678352355957
Epoch: 32, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 33 cost time: 0.37856054306030273
Epoch: 33, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 34 cost time: 0.3975954055786133
Epoch: 34, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 35 cost time: 0.37462472915649414
Epoch: 35, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 36 cost time: 0.37696170806884766
Epoch: 36, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 37 cost time: 0.36673951148986816
Epoch: 37, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 38 cost time: 0.3912942409515381
Epoch: 38, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 39 cost time: 0.40651631355285645
Epoch: 39, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 40 cost time: 0.3938913345336914
Epoch: 40, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 41 cost time: 0.3939542770385742
Epoch: 41, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 42 cost time: 0.3670175075531006
Epoch: 42, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 43 cost time: 0.3505859375
Epoch: 43, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 44 cost time: 0.3897743225097656
Epoch: 44, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 45 cost time: 0.36628293991088867
Epoch: 45, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.371234655380249
Epoch: 46, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.37140560150146484
Epoch: 47, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 48 cost time: 0.36612749099731445
Epoch: 48, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 49 cost time: 0.3542044162750244
Epoch: 49, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 50 cost time: 0.38742613792419434
Epoch: 50, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 115532
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.315995454788208
Epoch: 1, Steps: 7 | Train Loss: 2.508 Vali Loss: 2.398 Vali Acc: 0.111 Test Loss: 2.398 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.38409972190856934
Epoch: 2, Steps: 7 | Train Loss: 2.039 Vali Loss: 2.032 Vali Acc: 0.611 Test Loss: 2.032 Test Acc: 0.611
Validation loss decreased (-0.111087 --> -0.611091).  Saving model ...
Epoch: 3 cost time: 0.3639087677001953
Epoch: 3, Steps: 7 | Train Loss: 1.386 Vali Loss: 1.490 Vali Acc: 0.833 Test Loss: 1.490 Test Acc: 0.833
Validation loss decreased (-0.611091 --> -0.833318).  Saving model ...
Epoch: 4 cost time: 0.3878161907196045
Epoch: 4, Steps: 7 | Train Loss: 0.733 Vali Loss: 0.956 Vali Acc: 0.889 Test Loss: 0.956 Test Acc: 0.889
Validation loss decreased (-0.833318 --> -0.888879).  Saving model ...
Epoch: 5 cost time: 0.3578808307647705
Epoch: 5, Steps: 7 | Train Loss: 0.331 Vali Loss: 0.586 Vali Acc: 0.944 Test Loss: 0.586 Test Acc: 0.944
Validation loss decreased (-0.888879 --> -0.944439).  Saving model ...
Epoch: 6 cost time: 0.3809230327606201
Epoch: 6, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.425 Vali Acc: 0.917 Test Loss: 0.425 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4186527729034424
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.38147687911987305
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.3668205738067627
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.4468801021575928
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.4187633991241455
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40050482749938965
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4618873596191406
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.38680362701416016
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.4191300868988037
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.35509467124938965
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.39232611656188965
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.44828009605407715
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.3398416042327881
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.41889500617980957
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.4132394790649414
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.41632938385009766
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.3807649612426758
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.3737030029296875
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.4481973648071289
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.37821269035339355
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4664645195007324
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.41880035400390625
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.39617013931274414
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4087491035461426
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.38898730278015137
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.3884754180908203
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.39542078971862793
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.3997080326080322
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.40107154846191406
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.46442246437072754
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.3796970844268799
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.4028205871582031
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.3817167282104492
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.4085350036621094
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.4130282402038574
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.3702733516693115
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.3877604007720947
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.3942427635192871
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.3930783271789551
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.46563029289245605
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.40282368659973145
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.395460844039917
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.40350818634033203
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.3946683406829834
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps30_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 202732
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.4992272853851318
Epoch: 1, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.419 Vali Acc: 0.153 Test Loss: 2.419 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.38570570945739746
Epoch: 2, Steps: 7 | Train Loss: 2.222 Vali Loss: 2.176 Vali Acc: 0.431 Test Loss: 2.176 Test Acc: 0.431
Validation loss decreased (-0.152754 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.3570556640625
Epoch: 3, Steps: 7 | Train Loss: 1.758 Vali Loss: 1.806 Vali Acc: 0.792 Test Loss: 1.806 Test Acc: 0.792
Validation loss decreased (-0.430534 --> -0.791649).  Saving model ...
Epoch: 4 cost time: 0.3643655776977539
Epoch: 4, Steps: 7 | Train Loss: 1.300 Vali Loss: 1.389 Vali Acc: 0.917 Test Loss: 1.389 Test Acc: 0.917
Validation loss decreased (-0.791649 --> -0.916653).  Saving model ...
Epoch: 5 cost time: 0.3962376117706299
Epoch: 5, Steps: 7 | Train Loss: 0.864 Vali Loss: 1.011 Vali Acc: 0.931 Test Loss: 1.011 Test Acc: 0.931
Validation loss decreased (-0.916653 --> -0.930545).  Saving model ...
Epoch: 6 cost time: 0.38709211349487305
Epoch: 6, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.730 Vali Acc: 0.931 Test Loss: 0.730 Test Acc: 0.931
Validation loss decreased (-0.930545 --> -0.930548).  Saving model ...
Epoch: 7 cost time: 0.36742711067199707
Epoch: 7, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.549 Vali Acc: 0.931 Test Loss: 0.549 Test Acc: 0.931
Validation loss decreased (-0.930548 --> -0.930550).  Saving model ...
Epoch: 8 cost time: 0.38353753089904785
Epoch: 8, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.436 Vali Acc: 0.944 Test Loss: 0.436 Test Acc: 0.944
Validation loss decreased (-0.930550 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 0.3740200996398926
Epoch: 9, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.373 Vali Acc: 0.958 Test Loss: 0.373 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958330).  Saving model ...
Epoch: 10 cost time: 0.38602614402770996
Epoch: 10, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.325 Vali Acc: 0.958 Test Loss: 0.325 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 11 cost time: 0.3631734848022461
Epoch: 11, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.298 Vali Acc: 0.958 Test Loss: 0.298 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 12 cost time: 0.36286282539367676
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.958 Test Loss: 0.285 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 0.4814152717590332
Epoch: 13, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.4027743339538574
Epoch: 14, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.262 Vali Acc: 0.958 Test Loss: 0.262 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.3932342529296875
Epoch: 15, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.3797597885131836
Epoch: 16, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 0.36077141761779785
Epoch: 17, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.4481968879699707
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.38022732734680176
Epoch: 19, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 0.39638710021972656
Epoch: 20, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.40766310691833496
Epoch: 21, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.42171359062194824
Epoch: 22, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 23 cost time: 0.41437292098999023
Epoch: 23, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 24 cost time: 0.4040842056274414
Epoch: 24, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 25 cost time: 0.3689570426940918
Epoch: 25, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 0.39671921730041504
Epoch: 26, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.958 Test Loss: 0.215 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 0.3891267776489258
Epoch: 27, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 28 cost time: 0.4413454532623291
Epoch: 28, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 29 cost time: 0.44084739685058594
Epoch: 29, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.958 Test Loss: 0.210 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 30 cost time: 0.4179975986480713
Epoch: 30, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 31 cost time: 0.4061260223388672
Epoch: 31, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 0.39127492904663086
Epoch: 32, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 33 cost time: 0.39601993560791016
Epoch: 33, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 0.4449310302734375
Epoch: 34, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 35 cost time: 0.43505239486694336
Epoch: 35, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 0.38808321952819824
Epoch: 36, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 0.41147732734680176
Epoch: 37, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 0.40500378608703613
Epoch: 38, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 0.392902135848999
Epoch: 39, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 0.4008631706237793
Epoch: 40, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 0.45512866973876953
Epoch: 41, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 0.3642399311065674
Epoch: 42, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 43 cost time: 0.4124743938446045
Epoch: 43, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 44 cost time: 0.4872570037841797
Epoch: 44, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 0.4176456928253174
Epoch: 45, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 0.39618420600891113
Epoch: 46, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.4249420166015625
Epoch: 47, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 0.4383821487426758
Epoch: 48, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.39966464042663574
Epoch: 49, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 50 cost time: 0.4094710350036621
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps60_str30_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 111532
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.3790252208709717
Epoch: 1, Steps: 7 | Train Loss: 2.590 Vali Loss: 2.527 Vali Acc: 0.042 Test Loss: 2.527 Test Acc: 0.042
Validation loss decreased (inf --> -0.041641).  Saving model ...
Epoch: 2 cost time: 0.3941073417663574
Epoch: 2, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.373 Vali Acc: 0.139 Test Loss: 2.373 Test Acc: 0.139
Validation loss decreased (-0.041641 --> -0.138865).  Saving model ...
Epoch: 3 cost time: 0.3839743137359619
Epoch: 3, Steps: 7 | Train Loss: 2.133 Vali Loss: 2.110 Vali Acc: 0.389 Test Loss: 2.110 Test Acc: 0.389
Validation loss decreased (-0.138865 --> -0.388868).  Saving model ...
Epoch: 4 cost time: 0.3659331798553467
Epoch: 4, Steps: 7 | Train Loss: 1.744 Vali Loss: 1.774 Vali Acc: 0.708 Test Loss: 1.774 Test Acc: 0.708
Validation loss decreased (-0.388868 --> -0.708316).  Saving model ...
Epoch: 5 cost time: 0.3713080883026123
Epoch: 5, Steps: 7 | Train Loss: 1.365 Vali Loss: 1.435 Vali Acc: 0.792 Test Loss: 1.435 Test Acc: 0.792
Validation loss decreased (-0.708316 --> -0.791652).  Saving model ...
Epoch: 6 cost time: 0.40236377716064453
Epoch: 6, Steps: 7 | Train Loss: 1.010 Vali Loss: 1.143 Vali Acc: 0.806 Test Loss: 1.143 Test Acc: 0.806
Validation loss decreased (-0.791652 --> -0.805544).  Saving model ...
Epoch: 7 cost time: 0.4132404327392578
Epoch: 7, Steps: 7 | Train Loss: 0.714 Vali Loss: 0.903 Vali Acc: 0.861 Test Loss: 0.903 Test Acc: 0.861
Validation loss decreased (-0.805544 --> -0.861102).  Saving model ...
Epoch: 8 cost time: 0.370715856552124
Epoch: 8, Steps: 7 | Train Loss: 0.476 Vali Loss: 0.707 Vali Acc: 0.889 Test Loss: 0.707 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888882).  Saving model ...
Epoch: 9 cost time: 0.38993287086486816
Epoch: 9, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.566 Vali Acc: 0.917 Test Loss: 0.566 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916661).  Saving model ...
Epoch: 10 cost time: 0.38814210891723633
Epoch: 10, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.475 Vali Acc: 0.931 Test Loss: 0.475 Test Acc: 0.931
Validation loss decreased (-0.916661 --> -0.930551).  Saving model ...
Epoch: 11 cost time: 0.37334680557250977
Epoch: 11, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.415 Vali Acc: 0.931 Test Loss: 0.415 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 12 cost time: 0.40261054039001465
Epoch: 12, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.372 Vali Acc: 0.931 Test Loss: 0.372 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.36670637130737305
Epoch: 13, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.351604700088501
Epoch: 14, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.42093873023986816
Epoch: 15, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.39043188095092773
Epoch: 16, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.3772468566894531
Epoch: 17, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.3883168697357178
Epoch: 18, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.41459083557128906
Epoch: 19, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.37824296951293945
Epoch: 20, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.3834989070892334
Epoch: 21, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.43976616859436035
Epoch: 22, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4389040470123291
Epoch: 23, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.43097543716430664
Epoch: 24, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4109067916870117
Epoch: 25, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.35558080673217773
Epoch: 26, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.3796882629394531
Epoch: 27, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.38807201385498047
Epoch: 28, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.3688700199127197
Epoch: 29, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.46094465255737305
Epoch: 30, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.36174726486206055
Epoch: 31, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps90_str45_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 82540
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.3209779262542725
Epoch: 1, Steps: 7 | Train Loss: 2.472 Vali Loss: 2.453 Vali Acc: 0.111 Test Loss: 2.453 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.36902761459350586
Epoch: 2, Steps: 7 | Train Loss: 2.306 Vali Loss: 2.310 Vali Acc: 0.236 Test Loss: 2.310 Test Acc: 0.236
Validation loss decreased (-0.111087 --> -0.236088).  Saving model ...
Epoch: 3 cost time: 0.38895726203918457
Epoch: 3, Steps: 7 | Train Loss: 2.071 Vali Loss: 2.085 Vali Acc: 0.583 Test Loss: 2.085 Test Acc: 0.583
Validation loss decreased (-0.236088 --> -0.583312).  Saving model ...
Epoch: 4 cost time: 0.3793466091156006
Epoch: 4, Steps: 7 | Train Loss: 1.766 Vali Loss: 1.804 Vali Acc: 0.750 Test Loss: 1.804 Test Acc: 0.750
Validation loss decreased (-0.583312 --> -0.749982).  Saving model ...
Epoch: 5 cost time: 0.35133814811706543
Epoch: 5, Steps: 7 | Train Loss: 1.416 Vali Loss: 1.507 Vali Acc: 0.806 Test Loss: 1.507 Test Acc: 0.806
Validation loss decreased (-0.749982 --> -0.805540).  Saving model ...
Epoch: 6 cost time: 0.3949754238128662
Epoch: 6, Steps: 7 | Train Loss: 1.124 Vali Loss: 1.232 Vali Acc: 0.861 Test Loss: 1.232 Test Acc: 0.861
Validation loss decreased (-0.805540 --> -0.861099).  Saving model ...
Epoch: 7 cost time: 0.4530625343322754
Epoch: 7, Steps: 7 | Train Loss: 0.834 Vali Loss: 0.986 Vali Acc: 0.875 Test Loss: 0.986 Test Acc: 0.875
Validation loss decreased (-0.861099 --> -0.874990).  Saving model ...
Epoch: 8 cost time: 0.42513442039489746
Epoch: 8, Steps: 7 | Train Loss: 0.604 Vali Loss: 0.789 Vali Acc: 0.889 Test Loss: 0.789 Test Acc: 0.889
Validation loss decreased (-0.874990 --> -0.888881).  Saving model ...
Epoch: 9 cost time: 0.36689114570617676
Epoch: 9, Steps: 7 | Train Loss: 0.433 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.37773895263671875
Epoch: 10, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.571 Vali Acc: 0.889 Test Loss: 0.571 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.3713243007659912
Epoch: 11, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.41056036949157715
Epoch: 12, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.4447767734527588
Epoch: 13, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.3692929744720459
Epoch: 14, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.3829617500305176
Epoch: 15, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.41961240768432617
Epoch: 16, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.38460516929626465
Epoch: 17, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.36475038528442383
Epoch: 18, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 19 cost time: 0.4237806797027588
Epoch: 19, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 0.39606404304504395
Epoch: 20, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 0.42428135871887207
Epoch: 21, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 0.39787769317626953
Epoch: 22, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.3733224868774414
Epoch: 23, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.3742070198059082
Epoch: 24, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.3857135772705078
Epoch: 25, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.38638854026794434
Epoch: 26, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.3854057788848877
Epoch: 27, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.39310336112976074
Epoch: 28, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.3795807361602783
Epoch: 29, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.38839244842529297
Epoch: 30, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.3955237865447998
Epoch: 31, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.38364148139953613
Epoch: 32, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.38578081130981445
Epoch: 33, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.4209921360015869
Epoch: 34, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.4526340961456299
Epoch: 35, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.45398592948913574
Epoch: 36, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.3692171573638916
Epoch: 37, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.36159610748291016
Epoch: 38, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.4018433094024658
Epoch: 39, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.38495421409606934
Epoch: 40, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 0.39931583404541016
Epoch: 41, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 42 cost time: 0.38907861709594727
Epoch: 42, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.37764835357666016
Epoch: 43, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.38194704055786133
Epoch: 44, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.41317296028137207
Epoch: 45, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.3697378635406494
Epoch: 46, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 0.368025541305542
Epoch: 47, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 48 cost time: 0.3824915885925293
Epoch: 48, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 49 cost time: 0.3719966411590576
Epoch: 49, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 50 cost time: 0.3914456367492676
Epoch: 50, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps120_str60_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 67372
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.3383042812347412
Epoch: 1, Steps: 7 | Train Loss: 2.617 Vali Loss: 2.492 Vali Acc: 0.028 Test Loss: 2.492 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.3937094211578369
Epoch: 2, Steps: 7 | Train Loss: 2.506 Vali Loss: 2.395 Vali Acc: 0.083 Test Loss: 2.395 Test Acc: 0.083
Validation loss decreased (-0.027753 --> -0.083309).  Saving model ...
Epoch: 3 cost time: 0.3607604503631592
Epoch: 3, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.230 Vali Acc: 0.278 Test Loss: 2.230 Test Acc: 0.278
Validation loss decreased (-0.083309 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 0.3772773742675781
Epoch: 4, Steps: 7 | Train Loss: 2.087 Vali Loss: 2.016 Vali Acc: 0.583 Test Loss: 2.016 Test Acc: 0.583
Validation loss decreased (-0.277755 --> -0.583313).  Saving model ...
Epoch: 5 cost time: 0.426790714263916
Epoch: 5, Steps: 7 | Train Loss: 1.818 Vali Loss: 1.782 Vali Acc: 0.681 Test Loss: 1.782 Test Acc: 0.681
Validation loss decreased (-0.583313 --> -0.680538).  Saving model ...
Epoch: 6 cost time: 0.43691492080688477
Epoch: 6, Steps: 7 | Train Loss: 1.545 Vali Loss: 1.550 Vali Acc: 0.792 Test Loss: 1.550 Test Acc: 0.792
Validation loss decreased (-0.680538 --> -0.791651).  Saving model ...
Epoch: 7 cost time: 0.3508307933807373
Epoch: 7, Steps: 7 | Train Loss: 1.296 Vali Loss: 1.332 Vali Acc: 0.889 Test Loss: 1.332 Test Acc: 0.889
Validation loss decreased (-0.791651 --> -0.888876).  Saving model ...
Epoch: 8 cost time: 0.41384220123291016
Epoch: 8, Steps: 7 | Train Loss: 1.031 Vali Loss: 1.135 Vali Acc: 0.917 Test Loss: 1.135 Test Acc: 0.917
Validation loss decreased (-0.888876 --> -0.916655).  Saving model ...
Epoch: 9 cost time: 0.3557431697845459
Epoch: 9, Steps: 7 | Train Loss: 0.817 Vali Loss: 0.958 Vali Acc: 0.917 Test Loss: 0.958 Test Acc: 0.917
Validation loss decreased (-0.916655 --> -0.916657).  Saving model ...
Epoch: 10 cost time: 0.3274967670440674
Epoch: 10, Steps: 7 | Train Loss: 0.630 Vali Loss: 0.804 Vali Acc: 0.931 Test Loss: 0.804 Test Acc: 0.931
Validation loss decreased (-0.916657 --> -0.930548).  Saving model ...
Epoch: 11 cost time: 0.36556482315063477
Epoch: 11, Steps: 7 | Train Loss: 0.472 Vali Loss: 0.687 Vali Acc: 0.958 Test Loss: 0.687 Test Acc: 0.958
Validation loss decreased (-0.930548 --> -0.958326).  Saving model ...
Epoch: 12 cost time: 0.391582727432251
Epoch: 12, Steps: 7 | Train Loss: 0.352 Vali Loss: 0.592 Vali Acc: 0.958 Test Loss: 0.592 Test Acc: 0.958
Validation loss decreased (-0.958326 --> -0.958327).  Saving model ...
Epoch: 13 cost time: 0.3510110378265381
Epoch: 13, Steps: 7 | Train Loss: 0.258 Vali Loss: 0.527 Vali Acc: 0.972 Test Loss: 0.527 Test Acc: 0.972
Validation loss decreased (-0.958327 --> -0.972217).  Saving model ...
Epoch: 14 cost time: 0.3538637161254883
Epoch: 14, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.485 Vali Acc: 0.958 Test Loss: 0.485 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3482487201690674
Epoch: 15, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.440 Vali Acc: 0.972 Test Loss: 0.440 Test Acc: 0.972
Validation loss decreased (-0.972217 --> -0.972218).  Saving model ...
Epoch: 16 cost time: 0.38415026664733887
Epoch: 16, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.411 Vali Acc: 0.972 Test Loss: 0.411 Test Acc: 0.972
Validation loss decreased (-0.972218 --> -0.972218).  Saving model ...
Epoch: 17 cost time: 0.34557032585144043
Epoch: 17, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.394 Vali Acc: 0.958 Test Loss: 0.394 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3715522289276123
Epoch: 18, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.375 Vali Acc: 0.972 Test Loss: 0.375 Test Acc: 0.972
Validation loss decreased (-0.972218 --> -0.972218).  Saving model ...
Epoch: 19 cost time: 0.3742332458496094
Epoch: 19, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.358 Vali Acc: 0.972 Test Loss: 0.358 Test Acc: 0.972
Validation loss decreased (-0.972218 --> -0.972219).  Saving model ...
Epoch: 20 cost time: 0.3562626838684082
Epoch: 20, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.344 Vali Acc: 0.972 Test Loss: 0.344 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 21 cost time: 0.37514519691467285
Epoch: 21, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.332 Vali Acc: 0.972 Test Loss: 0.332 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 22 cost time: 0.4164111614227295
Epoch: 22, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.318 Vali Acc: 0.972 Test Loss: 0.318 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 23 cost time: 0.34272241592407227
Epoch: 23, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.312 Vali Acc: 0.972 Test Loss: 0.312 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 24 cost time: 0.4004645347595215
Epoch: 24, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.308 Vali Acc: 0.958 Test Loss: 0.308 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4264945983886719
Epoch: 25, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.303 Vali Acc: 0.958 Test Loss: 0.303 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.34987759590148926
Epoch: 26, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.297 Vali Acc: 0.958 Test Loss: 0.297 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3672208786010742
Epoch: 27, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.288 Vali Acc: 0.972 Test Loss: 0.288 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 28 cost time: 0.36573314666748047
Epoch: 28, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.283 Vali Acc: 0.972 Test Loss: 0.283 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 29 cost time: 0.37276339530944824
Epoch: 29, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.279 Vali Acc: 0.972 Test Loss: 0.279 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 30 cost time: 0.3943157196044922
Epoch: 30, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.972 Test Loss: 0.273 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972219).  Saving model ...
Epoch: 31 cost time: 0.38481974601745605
Epoch: 31, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.267 Vali Acc: 0.972 Test Loss: 0.267 Test Acc: 0.972
Validation loss decreased (-0.972219 --> -0.972220).  Saving model ...
Epoch: 32 cost time: 0.4446084499359131
Epoch: 32, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.972 Test Loss: 0.262 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 33 cost time: 0.41056299209594727
Epoch: 33, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.258 Vali Acc: 0.972 Test Loss: 0.258 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.3637821674346924
Epoch: 34, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.972 Test Loss: 0.257 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 35 cost time: 0.3860468864440918
Epoch: 35, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.253 Vali Acc: 0.972 Test Loss: 0.253 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 36 cost time: 0.38248753547668457
Epoch: 36, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.972 Test Loss: 0.250 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 37 cost time: 0.3403909206390381
Epoch: 37, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.247 Vali Acc: 0.972 Test Loss: 0.247 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.4242730140686035
Epoch: 38, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.244 Vali Acc: 0.972 Test Loss: 0.244 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 39 cost time: 0.38288164138793945
Epoch: 39, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.972 Test Loss: 0.241 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 40 cost time: 0.3722531795501709
Epoch: 40, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.972 Test Loss: 0.238 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 41 cost time: 0.38813185691833496
Epoch: 41, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 42 cost time: 0.4156491756439209
Epoch: 42, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 0.4262120723724365
Epoch: 43, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.231 Vali Acc: 0.972 Test Loss: 0.231 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 0.38340163230895996
Epoch: 44, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 0.4058351516723633
Epoch: 45, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 0.3885197639465332
Epoch: 46, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.972 Test Loss: 0.225 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 47 cost time: 0.38940906524658203
Epoch: 47, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 48 cost time: 0.37950682640075684
Epoch: 48, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 49 cost time: 0.3884918689727783
Epoch: 49, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 50 cost time: 0.37032294273376465
Epoch: 50, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps180_str90_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 55468
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.3209681510925293
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.485 Vali Acc: 0.125 Test Loss: 2.485 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.40183401107788086
Epoch: 2, Steps: 7 | Train Loss: 2.488 Vali Loss: 2.417 Vali Acc: 0.194 Test Loss: 2.417 Test Acc: 0.194
Validation loss decreased (-0.124975 --> -0.194420).  Saving model ...
Epoch: 3 cost time: 0.37721943855285645
Epoch: 3, Steps: 7 | Train Loss: 2.348 Vali Loss: 2.302 Vali Acc: 0.333 Test Loss: 2.302 Test Acc: 0.333
Validation loss decreased (-0.194420 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 0.3822805881500244
Epoch: 4, Steps: 7 | Train Loss: 2.190 Vali Loss: 2.154 Vali Acc: 0.444 Test Loss: 2.154 Test Acc: 0.444
Validation loss decreased (-0.333310 --> -0.444423).  Saving model ...
Epoch: 5 cost time: 0.3553907871246338
Epoch: 5, Steps: 7 | Train Loss: 1.968 Vali Loss: 1.984 Vali Acc: 0.542 Test Loss: 1.984 Test Acc: 0.542
Validation loss decreased (-0.444423 --> -0.541647).  Saving model ...
Epoch: 6 cost time: 0.41288232803344727
Epoch: 6, Steps: 7 | Train Loss: 1.766 Vali Loss: 1.807 Vali Acc: 0.667 Test Loss: 1.807 Test Acc: 0.667
Validation loss decreased (-0.541647 --> -0.666649).  Saving model ...
Epoch: 7 cost time: 0.3851017951965332
Epoch: 7, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.633 Vali Acc: 0.750 Test Loss: 1.633 Test Acc: 0.750
Validation loss decreased (-0.666649 --> -0.749984).  Saving model ...
Epoch: 8 cost time: 0.35907697677612305
Epoch: 8, Steps: 7 | Train Loss: 1.348 Vali Loss: 1.463 Vali Acc: 0.806 Test Loss: 1.463 Test Acc: 0.806
Validation loss decreased (-0.749984 --> -0.805541).  Saving model ...
Epoch: 9 cost time: 0.37050843238830566
Epoch: 9, Steps: 7 | Train Loss: 1.133 Vali Loss: 1.310 Vali Acc: 0.806 Test Loss: 1.310 Test Acc: 0.806
Validation loss decreased (-0.805541 --> -0.805542).  Saving model ...
Epoch: 10 cost time: 0.3869459629058838
Epoch: 10, Steps: 7 | Train Loss: 0.950 Vali Loss: 1.178 Vali Acc: 0.847 Test Loss: 1.178 Test Acc: 0.847
Validation loss decreased (-0.805542 --> -0.847210).  Saving model ...
Epoch: 11 cost time: 0.35231661796569824
Epoch: 11, Steps: 7 | Train Loss: 0.791 Vali Loss: 1.058 Vali Acc: 0.861 Test Loss: 1.058 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861101).  Saving model ...
Epoch: 12 cost time: 0.37061429023742676
Epoch: 12, Steps: 7 | Train Loss: 0.633 Vali Loss: 0.937 Vali Acc: 0.861 Test Loss: 0.937 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861102).  Saving model ...
Epoch: 13 cost time: 0.41536927223205566
Epoch: 13, Steps: 7 | Train Loss: 0.515 Vali Loss: 0.839 Vali Acc: 0.889 Test Loss: 0.839 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888880).  Saving model ...
Epoch: 14 cost time: 0.3583221435546875
Epoch: 14, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.760 Vali Acc: 0.917 Test Loss: 0.760 Test Acc: 0.917
Validation loss decreased (-0.888880 --> -0.916659).  Saving model ...
Epoch: 15 cost time: 0.3879852294921875
Epoch: 15, Steps: 7 | Train Loss: 0.343 Vali Loss: 0.701 Vali Acc: 0.917 Test Loss: 0.701 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916660).  Saving model ...
Epoch: 16 cost time: 0.452146053314209
Epoch: 16, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.649 Vali Acc: 0.931 Test Loss: 0.649 Test Acc: 0.931
Validation loss decreased (-0.916660 --> -0.930549).  Saving model ...
Epoch: 17 cost time: 0.3564572334289551
Epoch: 17, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.614 Vali Acc: 0.931 Test Loss: 0.614 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930549).  Saving model ...
Epoch: 18 cost time: 0.3803384304046631
Epoch: 18, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.582 Vali Acc: 0.931 Test Loss: 0.582 Test Acc: 0.931
Validation loss decreased (-0.930549 --> -0.930550).  Saving model ...
Epoch: 19 cost time: 0.37078070640563965
Epoch: 19, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.550 Vali Acc: 0.931 Test Loss: 0.550 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930550).  Saving model ...
Epoch: 20 cost time: 0.377335786819458
Epoch: 20, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.531 Vali Acc: 0.931 Test Loss: 0.531 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930550).  Saving model ...
Epoch: 21 cost time: 0.3725886344909668
Epoch: 21, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.513 Vali Acc: 0.931 Test Loss: 0.513 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930550).  Saving model ...
Epoch: 22 cost time: 0.4656212329864502
Epoch: 22, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.496 Vali Acc: 0.931 Test Loss: 0.496 Test Acc: 0.931
Validation loss decreased (-0.930550 --> -0.930551).  Saving model ...
Epoch: 23 cost time: 0.37375378608703613
Epoch: 23, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.480 Vali Acc: 0.931 Test Loss: 0.480 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 24 cost time: 0.36211657524108887
Epoch: 24, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.463 Vali Acc: 0.944 Test Loss: 0.463 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944440).  Saving model ...
Epoch: 25 cost time: 0.3704848289489746
Epoch: 25, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.448 Vali Acc: 0.944 Test Loss: 0.448 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 26 cost time: 0.37581324577331543
Epoch: 26, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.435 Vali Acc: 0.958 Test Loss: 0.435 Test Acc: 0.958
Validation loss decreased (-0.944440 --> -0.958329).  Saving model ...
Epoch: 27 cost time: 0.3624849319458008
Epoch: 27, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.426 Vali Acc: 0.958 Test Loss: 0.426 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958329).  Saving model ...
Epoch: 28 cost time: 0.4079244136810303
Epoch: 28, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.413 Vali Acc: 0.931 Test Loss: 0.413 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3938024044036865
Epoch: 29, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.402 Vali Acc: 0.944 Test Loss: 0.402 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.3610527515411377
Epoch: 30, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.397 Vali Acc: 0.944 Test Loss: 0.397 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.36337757110595703
Epoch: 31, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.391 Vali Acc: 0.958 Test Loss: 0.391 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958329).  Saving model ...
Epoch: 32 cost time: 0.34305882453918457
Epoch: 32, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.384 Vali Acc: 0.958 Test Loss: 0.384 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958329).  Saving model ...
Epoch: 33 cost time: 0.4046807289123535
Epoch: 33, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.377 Vali Acc: 0.944 Test Loss: 0.377 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.3748495578765869
Epoch: 34, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.371 Vali Acc: 0.958 Test Loss: 0.371 Test Acc: 0.958
Validation loss decreased (-0.958329 --> -0.958330).  Saving model ...
Epoch: 35 cost time: 0.42701244354248047
Epoch: 35, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.364 Vali Acc: 0.944 Test Loss: 0.364 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4545156955718994
Epoch: 36, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4037964344024658
Epoch: 37, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.358 Vali Acc: 0.958 Test Loss: 0.358 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 38 cost time: 0.37275028228759766
Epoch: 38, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.354 Vali Acc: 0.958 Test Loss: 0.354 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 39 cost time: 0.34680724143981934
Epoch: 39, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.350 Vali Acc: 0.958 Test Loss: 0.350 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 40 cost time: 0.32877111434936523
Epoch: 40, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.346 Vali Acc: 0.958 Test Loss: 0.346 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 41 cost time: 0.3592839241027832
Epoch: 41, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.341 Vali Acc: 0.958 Test Loss: 0.341 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 42 cost time: 0.37593698501586914
Epoch: 42, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.336 Vali Acc: 0.944 Test Loss: 0.336 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.41147613525390625
Epoch: 43, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.333 Vali Acc: 0.958 Test Loss: 0.333 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 44 cost time: 0.4041769504547119
Epoch: 44, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.333 Vali Acc: 0.958 Test Loss: 0.333 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.34892940521240234
Epoch: 45, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.332 Vali Acc: 0.958 Test Loss: 0.332 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 46 cost time: 0.3862769603729248
Epoch: 46, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.328 Vali Acc: 0.958 Test Loss: 0.328 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 47 cost time: 0.39578843116760254
Epoch: 47, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.324 Vali Acc: 0.958 Test Loss: 0.324 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 48 cost time: 0.40139007568359375
Epoch: 48, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.958 Test Loss: 0.320 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 49 cost time: 0.37187743186950684
Epoch: 49, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.958 Test Loss: 0.318 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
Epoch: 50 cost time: 0.3704812526702881
Epoch: 50, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.314 Vali Acc: 0.958 Test Loss: 0.314 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958330).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps240_str120_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 48172
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.2522618770599365
Epoch: 1, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.558 Vali Acc: 0.139 Test Loss: 2.558 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.32453012466430664
Epoch: 2, Steps: 7 | Train Loss: 2.392 Vali Loss: 2.503 Vali Acc: 0.167 Test Loss: 2.503 Test Acc: 0.167
Validation loss decreased (-0.138863 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 0.35962748527526855
Epoch: 3, Steps: 7 | Train Loss: 2.291 Vali Loss: 2.404 Vali Acc: 0.208 Test Loss: 2.404 Test Acc: 0.208
Validation loss decreased (-0.166642 --> -0.208309).  Saving model ...
Epoch: 4 cost time: 0.33669328689575195
Epoch: 4, Steps: 7 | Train Loss: 2.137 Vali Loss: 2.269 Vali Acc: 0.278 Test Loss: 2.269 Test Acc: 0.278
Validation loss decreased (-0.208309 --> -0.277755).  Saving model ...
Epoch: 5 cost time: 0.3747122287750244
Epoch: 5, Steps: 7 | Train Loss: 1.923 Vali Loss: 2.117 Vali Acc: 0.389 Test Loss: 2.117 Test Acc: 0.389
Validation loss decreased (-0.277755 --> -0.388868).  Saving model ...
Epoch: 6 cost time: 0.3549506664276123
Epoch: 6, Steps: 7 | Train Loss: 1.777 Vali Loss: 1.955 Vali Acc: 0.514 Test Loss: 1.955 Test Acc: 0.514
Validation loss decreased (-0.388868 --> -0.513869).  Saving model ...
Epoch: 7 cost time: 0.35727667808532715
Epoch: 7, Steps: 7 | Train Loss: 1.570 Vali Loss: 1.799 Vali Acc: 0.611 Test Loss: 1.799 Test Acc: 0.611
Validation loss decreased (-0.513869 --> -0.611093).  Saving model ...
Epoch: 8 cost time: 0.29674291610717773
Epoch: 8, Steps: 7 | Train Loss: 1.393 Vali Loss: 1.647 Vali Acc: 0.667 Test Loss: 1.647 Test Acc: 0.667
Validation loss decreased (-0.611093 --> -0.666650).  Saving model ...
Epoch: 9 cost time: 0.35611462593078613
Epoch: 9, Steps: 7 | Train Loss: 1.229 Vali Loss: 1.503 Vali Acc: 0.722 Test Loss: 1.503 Test Acc: 0.722
Validation loss decreased (-0.666650 --> -0.722207).  Saving model ...
Epoch: 10 cost time: 0.37223243713378906
Epoch: 10, Steps: 7 | Train Loss: 1.056 Vali Loss: 1.373 Vali Acc: 0.750 Test Loss: 1.373 Test Acc: 0.750
Validation loss decreased (-0.722207 --> -0.749986).  Saving model ...
Epoch: 11 cost time: 0.40814900398254395
Epoch: 11, Steps: 7 | Train Loss: 0.913 Vali Loss: 1.255 Vali Acc: 0.778 Test Loss: 1.255 Test Acc: 0.778
Validation loss decreased (-0.749986 --> -0.777765).  Saving model ...
Epoch: 12 cost time: 0.33981943130493164
Epoch: 12, Steps: 7 | Train Loss: 0.789 Vali Loss: 1.142 Vali Acc: 0.792 Test Loss: 1.142 Test Acc: 0.792
Validation loss decreased (-0.777765 --> -0.791655).  Saving model ...
Epoch: 13 cost time: 0.3986666202545166
Epoch: 13, Steps: 7 | Train Loss: 0.656 Vali Loss: 1.037 Vali Acc: 0.819 Test Loss: 1.037 Test Acc: 0.819
Validation loss decreased (-0.791655 --> -0.819434).  Saving model ...
Epoch: 14 cost time: 0.365154504776001
Epoch: 14, Steps: 7 | Train Loss: 0.548 Vali Loss: 0.951 Vali Acc: 0.819 Test Loss: 0.951 Test Acc: 0.819
Validation loss decreased (-0.819434 --> -0.819435).  Saving model ...
Epoch: 15 cost time: 0.32207155227661133
Epoch: 15, Steps: 7 | Train Loss: 0.467 Vali Loss: 0.878 Vali Acc: 0.819 Test Loss: 0.878 Test Acc: 0.819
Validation loss decreased (-0.819435 --> -0.819436).  Saving model ...
Epoch: 16 cost time: 0.33876681327819824
Epoch: 16, Steps: 7 | Train Loss: 0.383 Vali Loss: 0.815 Vali Acc: 0.833 Test Loss: 0.815 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833325).  Saving model ...
Epoch: 17 cost time: 0.3347938060760498
Epoch: 17, Steps: 7 | Train Loss: 0.329 Vali Loss: 0.761 Vali Acc: 0.847 Test Loss: 0.761 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847215).  Saving model ...
Epoch: 18 cost time: 0.3206918239593506
Epoch: 18, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.714 Vali Acc: 0.861 Test Loss: 0.714 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861104).  Saving model ...
Epoch: 19 cost time: 0.32460451126098633
Epoch: 19, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861104).  Saving model ...
Epoch: 20 cost time: 0.3515293598175049
Epoch: 20, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 0.3675558567047119
Epoch: 21, Steps: 7 | Train Loss: 0.178 Vali Loss: 0.622 Vali Acc: 0.889 Test Loss: 0.622 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888883).  Saving model ...
Epoch: 22 cost time: 0.36194634437561035
Epoch: 22, Steps: 7 | Train Loss: 0.157 Vali Loss: 0.598 Vali Acc: 0.903 Test Loss: 0.598 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902772).  Saving model ...
Epoch: 23 cost time: 0.3630788326263428
Epoch: 23, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.579 Vali Acc: 0.917 Test Loss: 0.579 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916661).  Saving model ...
Epoch: 24 cost time: 0.35486459732055664
Epoch: 24, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.561 Vali Acc: 0.917 Test Loss: 0.561 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916661).  Saving model ...
Epoch: 25 cost time: 0.362048864364624
Epoch: 25, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.548 Vali Acc: 0.917 Test Loss: 0.548 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916661).  Saving model ...
Epoch: 26 cost time: 0.37659430503845215
Epoch: 26, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.539 Vali Acc: 0.917 Test Loss: 0.539 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916661).  Saving model ...
Epoch: 27 cost time: 0.3321518898010254
Epoch: 27, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.524 Vali Acc: 0.917 Test Loss: 0.524 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916661).  Saving model ...
Epoch: 28 cost time: 0.3669857978820801
Epoch: 28, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.512 Vali Acc: 0.917 Test Loss: 0.512 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 29 cost time: 0.31904053688049316
Epoch: 29, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.497 Vali Acc: 0.917 Test Loss: 0.497 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 30 cost time: 0.3093903064727783
Epoch: 30, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.487 Vali Acc: 0.917 Test Loss: 0.487 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 31 cost time: 0.310016393661499
Epoch: 31, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.478 Vali Acc: 0.917 Test Loss: 0.478 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 32 cost time: 0.32502102851867676
Epoch: 32, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.471 Vali Acc: 0.917 Test Loss: 0.471 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 33 cost time: 0.3349425792694092
Epoch: 33, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.464 Vali Acc: 0.931 Test Loss: 0.464 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930551).  Saving model ...
Epoch: 34 cost time: 0.3662855625152588
Epoch: 34, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.459 Vali Acc: 0.931 Test Loss: 0.459 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 35 cost time: 0.31301426887512207
Epoch: 35, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.454 Vali Acc: 0.931 Test Loss: 0.454 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 36 cost time: 0.3210175037384033
Epoch: 36, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.446 Vali Acc: 0.931 Test Loss: 0.446 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 37 cost time: 0.376967191696167
Epoch: 37, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.442 Vali Acc: 0.931 Test Loss: 0.442 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 38 cost time: 0.3554396629333496
Epoch: 38, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.437 Vali Acc: 0.931 Test Loss: 0.437 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 39 cost time: 0.27933502197265625
Epoch: 39, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.431 Vali Acc: 0.931 Test Loss: 0.431 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 40 cost time: 0.3715243339538574
Epoch: 40, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.426 Vali Acc: 0.931 Test Loss: 0.426 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 41 cost time: 0.34132814407348633
Epoch: 41, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.422 Vali Acc: 0.931 Test Loss: 0.422 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 42 cost time: 0.3279085159301758
Epoch: 42, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.414 Vali Acc: 0.931 Test Loss: 0.414 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 43 cost time: 0.339339017868042
Epoch: 43, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.411 Vali Acc: 0.931 Test Loss: 0.411 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 44 cost time: 0.3542177677154541
Epoch: 44, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.408 Vali Acc: 0.931 Test Loss: 0.408 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930551).  Saving model ...
Epoch: 45 cost time: 0.3771378993988037
Epoch: 45, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.405 Vali Acc: 0.931 Test Loss: 0.405 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 46 cost time: 0.34895825386047363
Epoch: 46, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.404 Vali Acc: 0.931 Test Loss: 0.404 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 47 cost time: 0.31981492042541504
Epoch: 47, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.401 Vali Acc: 0.931 Test Loss: 0.401 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 48 cost time: 0.29801034927368164
Epoch: 48, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 49 cost time: 0.3151233196258545
Epoch: 49, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.396 Vali Acc: 0.931 Test Loss: 0.396 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 50 cost time: 0.34125852584838867
Epoch: 50, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.394 Vali Acc: 0.931 Test Loss: 0.394 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_ModernTCN_UEA_ftM_sl1197_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps300_str150_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45484
model size : 0.19MB
