Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.696004152297974
Epoch: 1, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.970 Vali Acc: 0.689 Test Loss: 1.970 Test Acc: 0.689
Validation loss decreased (inf --> -0.689169).  Saving model ...
Epoch: 2 cost time: 2.347886800765991
Epoch: 2, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.053 Vali Acc: 0.911 Test Loss: 1.053 Test Acc: 0.911
Validation loss decreased (-0.689169 --> -0.910800).  Saving model ...
Epoch: 3 cost time: 2.405390501022339
Epoch: 3, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.338 Vali Acc: 0.951 Test Loss: 0.338 Test Acc: 0.951
Validation loss decreased (-0.910800 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 2.063786029815674
Epoch: 4, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.951348 --> -0.964863).  Saving model ...
Epoch: 5 cost time: 2.1678335666656494
Epoch: 5, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 6 cost time: 2.300156354904175
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.964864 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 2.8277885913848877
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 3.2773444652557373
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 3.5715503692626953
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 3.3682444095611572
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0627098083496094
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 3.2867188453674316
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3330392837524414
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7220399379730225
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7255587577819824
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
Validation loss decreased (-0.978378 --> -0.983783).  Saving model ...
Epoch: 16 cost time: 3.744298219680786
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8625714778900146
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3889763355255127
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.753091812133789
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.570875406265259
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.2604329586029053
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.1758804321289062
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.537114143371582
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.695955514907837
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.650569200515747
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 2540489
model size : 9.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.7215611934661865
Epoch: 1, Steps: 17 | Train Loss: 2.044 Vali Loss: 1.967 Vali Acc: 0.703 Test Loss: 1.967 Test Acc: 0.703
Validation loss decreased (inf --> -0.702683).  Saving model ...
Epoch: 2 cost time: 2.8504559993743896
Epoch: 2, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.047 Vali Acc: 0.908 Test Loss: 1.047 Test Acc: 0.908
Validation loss decreased (-0.702683 --> -0.908098).  Saving model ...
Epoch: 3 cost time: 3.0044050216674805
Epoch: 3, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.358 Vali Acc: 0.938 Test Loss: 0.358 Test Acc: 0.938
Validation loss decreased (-0.908098 --> -0.937834).  Saving model ...
Epoch: 4 cost time: 3.3974080085754395
Epoch: 4, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.937834 --> -0.972971).  Saving model ...
Epoch: 5 cost time: 3.0063223838806152
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.662684917449951
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.411299467086792
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 3.107516288757324
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.493971109390259
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 3.5628292560577393
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 3.0122838020324707
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 3.1973705291748047
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.136409282684326
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.506319761276245
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1515142917633057
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2420060634613037
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.4169154167175293
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.300541639328003
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 3.420461416244507
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0465505123138428
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9257900714874268
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.0194742679595947
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.2277979850769043
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.023756742477417
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7637500762939453
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.100907564163208
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.638575792312622
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.355700731277466
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2540521
model size : 9.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.900120496749878
Epoch: 1, Steps: 17 | Train Loss: 2.153 Vali Loss: 2.085 Vali Acc: 0.546 Test Loss: 2.085 Test Acc: 0.546
Validation loss decreased (inf --> -0.545925).  Saving model ...
Epoch: 2 cost time: 2.973867416381836
Epoch: 2, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.584 Vali Acc: 0.862 Test Loss: 1.584 Test Acc: 0.862
Validation loss decreased (-0.545925 --> -0.862146).  Saving model ...
Epoch: 3 cost time: 3.2063939571380615
Epoch: 3, Steps: 17 | Train Loss: 1.081 Vali Loss: 0.847 Vali Acc: 0.924 Test Loss: 0.847 Test Acc: 0.924
Validation loss decreased (-0.862146 --> -0.924316).  Saving model ...
Epoch: 4 cost time: 2.875555992126465
Epoch: 4, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.399 Vali Acc: 0.943 Test Loss: 0.399 Test Acc: 0.943
Validation loss decreased (-0.924316 --> -0.943239).  Saving model ...
Epoch: 5 cost time: 2.817629337310791
Epoch: 5, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.208 Vali Acc: 0.973 Test Loss: 0.208 Test Acc: 0.973
Validation loss decreased (-0.943239 --> -0.972971).  Saving model ...
Epoch: 6 cost time: 2.9850399494171143
Epoch: 6, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1999905109405518
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 3.502645969390869
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 3.270806312561035
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.548739433288574
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9052951335906982
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8166158199310303
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0402705669403076
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1233291625976562
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.762397527694702
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9419612884521484
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.0500240325927734
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.305685043334961
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2485257
model size : 9.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.790578603744507
Epoch: 1, Steps: 17 | Train Loss: 2.105 Vali Loss: 2.074 Vali Acc: 0.451 Test Loss: 2.074 Test Acc: 0.451
Validation loss decreased (inf --> -0.451331).  Saving model ...
Epoch: 2 cost time: 2.903921127319336
Epoch: 2, Steps: 17 | Train Loss: 1.711 Vali Loss: 1.621 Vali Acc: 0.776 Test Loss: 1.621 Test Acc: 0.776
Validation loss decreased (-0.451331 --> -0.775659).  Saving model ...
Epoch: 3 cost time: 2.9030940532684326
Epoch: 3, Steps: 17 | Train Loss: 1.160 Vali Loss: 0.973 Vali Acc: 0.884 Test Loss: 0.973 Test Acc: 0.884
Validation loss decreased (-0.775659 --> -0.883774).  Saving model ...
Epoch: 4 cost time: 3.6379919052124023
Epoch: 4, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.494 Vali Acc: 0.927 Test Loss: 0.494 Test Acc: 0.927
Validation loss decreased (-0.883774 --> -0.927022).  Saving model ...
Epoch: 5 cost time: 2.6657485961914062
Epoch: 5, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.288 Vali Acc: 0.957 Test Loss: 0.288 Test Acc: 0.957
Validation loss decreased (-0.927022 --> -0.956754).  Saving model ...
Epoch: 6 cost time: 3.8160600662231445
Epoch: 6, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.956754 --> -0.970268).  Saving model ...
Epoch: 7 cost time: 3.505629062652588
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972971).  Saving model ...
Epoch: 8 cost time: 3.009708881378174
Epoch: 8, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 3.39563250541687
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 3.195680618286133
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5698962211608887
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 3.302402973175049
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 3.582443952560425
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.88210129737854
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.967474937438965
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1025779247283936
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6649372577667236
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0411221981048584
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 3.205260753631592
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8679540157318115
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.480639696121216
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3240160942077637
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.546905279159546
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.4111571311950684
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9174933433532715
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 3.100006580352783
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0200750827789307
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0209150314331055
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.208404541015625
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5591301918029785
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.140462636947632
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.404871940612793
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4183716773986816
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.415830373764038
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.337956428527832
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2471497
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.861886024475098
Epoch: 1, Steps: 17 | Train Loss: 2.128 Vali Loss: 2.083 Vali Acc: 0.349 Test Loss: 2.083 Test Acc: 0.349
Validation loss decreased (inf --> -0.348628).  Saving model ...
Epoch: 2 cost time: 3.1639773845672607
Epoch: 2, Steps: 17 | Train Loss: 1.758 Vali Loss: 1.651 Vali Acc: 0.800 Test Loss: 1.651 Test Acc: 0.800
Validation loss decreased (-0.348628 --> -0.799983).  Saving model ...
Epoch: 3 cost time: 3.2123863697052
Epoch: 3, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.021 Vali Acc: 0.886 Test Loss: 1.021 Test Acc: 0.886
Validation loss decreased (-0.799983 --> -0.886476).  Saving model ...
Epoch: 4 cost time: 2.787073850631714
Epoch: 4, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.525 Vali Acc: 0.938 Test Loss: 0.525 Test Acc: 0.938
Validation loss decreased (-0.886476 --> -0.937833).  Saving model ...
Epoch: 5 cost time: 2.968132257461548
Epoch: 5, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.288 Vali Acc: 0.951 Test Loss: 0.288 Test Acc: 0.951
Validation loss decreased (-0.937833 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 3.70599627494812
Epoch: 6, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.201 Vali Acc: 0.954 Test Loss: 0.201 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 3.4597253799438477
Epoch: 7, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.954052 --> -0.972971).  Saving model ...
Epoch: 8 cost time: 3.2981104850769043
Epoch: 8, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 3.695833921432495
Epoch: 9, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.195380926132202
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 3.571909189224243
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.243433713912964
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3073341846466064
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 3.1899659633636475
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 3.3581063747406006
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 2.958045482635498
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.217116117477417
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.824721336364746
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.04503059387207
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.990412712097168
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.517529010772705
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.0987355709075928
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.943127155303955
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.302481174468994
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 3.2589080333709717
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 26 cost time: 3.7955005168914795
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 27 cost time: 2.8269848823547363
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2760109901428223
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 29 cost time: 2.725078821182251
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1184027194976807
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.785583257675171
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.000746250152588
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.3753509521484375
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.00030779838562
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.5535545349121094
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.8946876525878906
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.4953882694244385
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.519941568374634
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2471529
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.984035968780518
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.106 Vali Acc: 0.259 Test Loss: 2.106 Test Acc: 0.259
Validation loss decreased (inf --> -0.259438).  Saving model ...
Epoch: 2 cost time: 2.8310067653656006
Epoch: 2, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.717 Vali Acc: 0.795 Test Loss: 1.717 Test Acc: 0.795
Validation loss decreased (-0.259438 --> -0.794577).  Saving model ...
Epoch: 3 cost time: 2.461489200592041
Epoch: 3, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.142 Vali Acc: 0.868 Test Loss: 1.142 Test Acc: 0.868
Validation loss decreased (-0.794577 --> -0.867556).  Saving model ...
Epoch: 4 cost time: 2.951496124267578
Epoch: 4, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.630 Vali Acc: 0.916 Test Loss: 0.630 Test Acc: 0.916
Validation loss decreased (-0.867556 --> -0.916210).  Saving model ...
Epoch: 5 cost time: 2.0486717224121094
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.362 Vali Acc: 0.941 Test Loss: 0.362 Test Acc: 0.941
Validation loss decreased (-0.916210 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 2.4819915294647217
Epoch: 6, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.237 Vali Acc: 0.968 Test Loss: 0.237 Test Acc: 0.968
Validation loss decreased (-0.940537 --> -0.967565).  Saving model ...
Epoch: 7 cost time: 3.2480268478393555
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
Validation loss decreased (-0.967565 --> -0.970268).  Saving model ...
Epoch: 8 cost time: 2.6542694568634033
Epoch: 8, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2622454166412354
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.843658447265625
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 3.431784152984619
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8725380897521973
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.752898931503296
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 3.0570132732391357
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.979156494140625
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.01102614402771
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2146859169006348
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8600106239318848
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 2.8526535034179688
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 2.9270687103271484
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9687039852142334
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 3.1381752490997314
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.948986530303955
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.080376625061035
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.232818603515625
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 2.2812297344207764
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.827451467514038
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8455419540405273
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 2.8950576782226562
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 2.6693968772888184
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.7776806354522705
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.9470787048339844
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.1644604206085205
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 3.0635643005371094
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.203371047973633
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.1074931621551514
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.7452566623687744
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.123767852783203
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 39 cost time: 3.005218267440796
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.264887809753418
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.826885938644409
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.2499444484710693
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.0205349922180176
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.720853328704834
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.9695591926574707
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.9771366119384766
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.9103164672851562
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.3744773864746094
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2457769
model size : 9.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.359477996826172
Epoch: 1, Steps: 17 | Train Loss: 2.075 Vali Loss: 2.001 Vali Acc: 0.551 Test Loss: 2.001 Test Acc: 0.551
Validation loss decreased (inf --> -0.551331).  Saving model ...
Epoch: 2 cost time: 3.051257610321045
Epoch: 2, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.132 Vali Acc: 0.868 Test Loss: 1.132 Test Acc: 0.868
Validation loss decreased (-0.551331 --> -0.867556).  Saving model ...
Epoch: 3 cost time: 2.9352455139160156
Epoch: 3, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.361 Vali Acc: 0.946 Test Loss: 0.361 Test Acc: 0.946
Validation loss decreased (-0.867556 --> -0.945942).  Saving model ...
Epoch: 4 cost time: 3.4691874980926514
Epoch: 4, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3384835720062256
Epoch: 5, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.945942 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.264831781387329
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.868396520614624
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 3.7902612686157227
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5158190727233887
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 3.755882740020752
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.337435245513916
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 3.153122901916504
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.374824047088623
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.220104217529297
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 3.8157646656036377
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5603818893432617
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.155093193054199
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.370259046554565
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3543477058410645
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.348191499710083
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.835374593734741
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9903030395507812
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 23 cost time: 2.2823922634124756
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6572225093841553
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.121694803237915
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.3858516216278076
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.3153202533721924
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.9452357292175293
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.0453131198883057
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.578599214553833
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.798186779022217
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.779292345046997
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2529737
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.713745594024658
Epoch: 1, Steps: 17 | Train Loss: 2.044 Vali Loss: 1.986 Vali Acc: 0.727 Test Loss: 1.986 Test Acc: 0.727
Validation loss decreased (inf --> -0.727007).  Saving model ...
Epoch: 2 cost time: 2.447679042816162
Epoch: 2, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.086 Vali Acc: 0.886 Test Loss: 1.086 Test Acc: 0.886
Validation loss decreased (-0.727007 --> -0.886476).  Saving model ...
Epoch: 3 cost time: 2.881326675415039
Epoch: 3, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.360 Vali Acc: 0.935 Test Loss: 0.360 Test Acc: 0.935
Validation loss decreased (-0.886476 --> -0.935132).  Saving model ...
Epoch: 4 cost time: 2.9314017295837402
Epoch: 4, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956755).  Saving model ...
Epoch: 5 cost time: 3.2705888748168945
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 6 cost time: 2.7201437950134277
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0939085483551025
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 2.419635057449341
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9166276454925537
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 3.0381574630737305
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8310999870300293
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0478549003601074
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 3.150212049484253
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8818843364715576
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2360494136810303
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 2.8702809810638428
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1835501194000244
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9174964427948
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 2.81398606300354
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.116305112838745
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.42095947265625
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4653210639953613
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.580709934234619
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.62544846534729
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 3.530426263809204
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.577883243560791
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.297807455062866
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5838232040405273
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.476104259490967
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.514863967895508
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.6638364791870117
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.5053234100341797
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.643937349319458
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.48335599899292
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2529769
model size : 9.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.378573656082153
Epoch: 1, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.054 Vali Acc: 0.519 Test Loss: 2.054 Test Acc: 0.519
Validation loss decreased (inf --> -0.518898).  Saving model ...
Epoch: 2 cost time: 2.6017699241638184
Epoch: 2, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.534 Vali Acc: 0.851 Test Loss: 1.534 Test Acc: 0.851
Validation loss decreased (-0.518898 --> -0.851336).  Saving model ...
Epoch: 3 cost time: 2.649012327194214
Epoch: 3, Steps: 17 | Train Loss: 1.041 Vali Loss: 0.808 Vali Acc: 0.903 Test Loss: 0.808 Test Acc: 0.903
Validation loss decreased (-0.851336 --> -0.902695).  Saving model ...
Epoch: 4 cost time: 2.884979009628296
Epoch: 4, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.361 Vali Acc: 0.949 Test Loss: 0.361 Test Acc: 0.949
Validation loss decreased (-0.902695 --> -0.948645).  Saving model ...
Epoch: 5 cost time: 3.068166494369507
Epoch: 5, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.208 Vali Acc: 0.965 Test Loss: 0.208 Test Acc: 0.965
Validation loss decreased (-0.948645 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 3.335339069366455
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
Validation loss decreased (-0.964863 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 2.909837007522583
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.291494369506836
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 2.8926210403442383
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 2.957885503768921
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 2.7741851806640625
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.200870990753174
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9722323417663574
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 3.1073496341705322
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.766204833984375
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.355679750442505
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.1901957988739014
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6543636322021484
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2120845317840576
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.947333574295044
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.3255231380462646
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.246408700942993
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.100499391555786
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2474505
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.464545965194702
Epoch: 1, Steps: 17 | Train Loss: 2.124 Vali Loss: 2.101 Vali Acc: 0.378 Test Loss: 2.101 Test Acc: 0.378
Validation loss decreased (inf --> -0.378357).  Saving model ...
Epoch: 2 cost time: 3.174973487854004
Epoch: 2, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.637 Vali Acc: 0.819 Test Loss: 1.637 Test Acc: 0.819
Validation loss decreased (-0.378357 --> -0.818903).  Saving model ...
Epoch: 3 cost time: 3.447965145111084
Epoch: 3, Steps: 17 | Train Loss: 1.188 Vali Loss: 0.979 Vali Acc: 0.884 Test Loss: 0.979 Test Acc: 0.884
Validation loss decreased (-0.818903 --> -0.883774).  Saving model ...
Epoch: 4 cost time: 3.564450740814209
Epoch: 4, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.506 Vali Acc: 0.935 Test Loss: 0.506 Test Acc: 0.935
Validation loss decreased (-0.883774 --> -0.935130).  Saving model ...
Epoch: 5 cost time: 3.156705617904663
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.290 Vali Acc: 0.959 Test Loss: 0.290 Test Acc: 0.959
Validation loss decreased (-0.935130 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 3.070085287094116
Epoch: 6, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.202 Vali Acc: 0.970 Test Loss: 0.202 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970268).  Saving model ...
Epoch: 7 cost time: 4.159614324569702
Epoch: 7, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.154 Vali Acc: 0.978 Test Loss: 0.154 Test Acc: 0.978
Validation loss decreased (-0.970268 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 3.315028667449951
Epoch: 8, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.15608549118042
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2672438621520996
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3067827224731445
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.289801836013794
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2986700534820557
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.285689115524292
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.4493601322174072
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.866196632385254
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.69394850730896
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2460745
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.093379497528076
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.090 Vali Acc: 0.489 Test Loss: 2.090 Test Acc: 0.489
Validation loss decreased (inf --> -0.489168).  Saving model ...
Epoch: 2 cost time: 2.981001615524292
Epoch: 2, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.667 Vali Acc: 0.784 Test Loss: 1.667 Test Acc: 0.784
Validation loss decreased (-0.489168 --> -0.783767).  Saving model ...
Epoch: 3 cost time: 3.0051004886627197
Epoch: 3, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.011 Vali Acc: 0.908 Test Loss: 1.011 Test Acc: 0.908
Validation loss decreased (-0.783767 --> -0.908098).  Saving model ...
Epoch: 4 cost time: 2.945321798324585
Epoch: 4, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.508 Vali Acc: 0.935 Test Loss: 0.508 Test Acc: 0.935
Validation loss decreased (-0.908098 --> -0.935130).  Saving model ...
Epoch: 5 cost time: 3.010129928588867
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.264 Vali Acc: 0.959 Test Loss: 0.264 Test Acc: 0.959
Validation loss decreased (-0.935130 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 3.739795684814453
Epoch: 6, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 7 cost time: 3.5201003551483154
Epoch: 7, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 3.5985074043273926
Epoch: 8, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 3.6597468852996826
Epoch: 9, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3838729858398438
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.964843988418579
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 3.26053786277771
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 3.403594493865967
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4600675106048584
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 3.581488847732544
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9262685775756836
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.672978162765503
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.134885311126709
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6352338790893555
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.540257692337036
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.4105207920074463
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.13373064994812
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8519978523254395
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5964131355285645
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2460777
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.317131519317627
Epoch: 1, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.081 Vali Acc: 0.419 Test Loss: 2.081 Test Acc: 0.419
Validation loss decreased (inf --> -0.418898).  Saving model ...
Epoch: 2 cost time: 3.5656909942626953
Epoch: 2, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.673 Vali Acc: 0.822 Test Loss: 1.673 Test Acc: 0.822
Validation loss decreased (-0.418898 --> -0.821605).  Saving model ...
Epoch: 3 cost time: 3.400294065475464
Epoch: 3, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.103 Vali Acc: 0.873 Test Loss: 1.103 Test Acc: 0.873
Validation loss decreased (-0.821605 --> -0.872962).  Saving model ...
Epoch: 4 cost time: 3.754584789276123
Epoch: 4, Steps: 17 | Train Loss: 0.801 Vali Loss: 0.618 Vali Acc: 0.922 Test Loss: 0.618 Test Acc: 0.922
Validation loss decreased (-0.872962 --> -0.921615).  Saving model ...
Epoch: 5 cost time: 3.8719799518585205
Epoch: 5, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.348 Vali Acc: 0.946 Test Loss: 0.348 Test Acc: 0.946
Validation loss decreased (-0.921615 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 3.427180528640747
Epoch: 6, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
Validation loss decreased (-0.945942 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 3.427973985671997
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
Validation loss decreased (-0.956754 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 3.2598371505737305
Epoch: 8, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.060260534286499
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 3.4909491539001465
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0434930324554443
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.258718729019165
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.450860023498535
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0970959663391113
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.962 Test Loss: 0.088 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4044277667999268
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.962 Test Loss: 0.086 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9658710956573486
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.965 Test Loss: 0.084 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.9624528884887695
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.965 Test Loss: 0.083 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.3198773860931396
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.968 Test Loss: 0.083 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1972546577453613
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2447017
model size : 9.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.957636594772339
Epoch: 1, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.040 Vali Acc: 0.911 Test Loss: 1.040 Test Acc: 0.911
Validation loss decreased (inf --> -0.910800).  Saving model ...
Epoch: 2 cost time: 5.036198616027832
Epoch: 2, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.910800 --> -0.951349).  Saving model ...
Epoch: 3 cost time: 3.974304437637329
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.140 Vali Acc: 0.941 Test Loss: 0.140 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8023602962493896
Epoch: 4, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.951349 --> -0.983783).  Saving model ...
Epoch: 5 cost time: 3.9449069499969482
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.271798372268677
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.1052069664001465
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.171244382858276
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.64291524887085
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.10816502571106
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.954294681549072
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.7802679538726807
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.824171781539917
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.245418071746826
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 8936201
model size : 34.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.707562208175659
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.171 Vali Acc: 0.892 Test Loss: 1.171 Test Acc: 0.892
Validation loss decreased (inf --> -0.891880).  Saving model ...
Epoch: 2 cost time: 4.979427337646484
Epoch: 2, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
Validation loss decreased (-0.891880 --> -0.972971).  Saving model ...
Epoch: 3 cost time: 4.577840328216553
Epoch: 3, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.290432691574097
Epoch: 4, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.741545677185059
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 4.937274932861328
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.8076841831207275
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 4.867982864379883
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.027640104293823
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.10622501373291
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 3.860764741897583
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.3530919551849365
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.922572612762451
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.938148498535156
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.964060306549072
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.8534934520721436
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.497570991516113
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.1944825649261475
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.83225417137146
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.556368589401245
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8936329
model size : 34.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.056483507156372
Epoch: 1, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.630 Vali Acc: 0.838 Test Loss: 1.630 Test Acc: 0.838
Validation loss decreased (inf --> -0.837822).  Saving model ...
Epoch: 2 cost time: 3.7608935832977295
Epoch: 2, Steps: 17 | Train Loss: 0.756 Vali Loss: 0.458 Vali Acc: 0.946 Test Loss: 0.458 Test Acc: 0.946
Validation loss decreased (-0.837822 --> -0.945941).  Saving model ...
Epoch: 3 cost time: 3.5846807956695557
Epoch: 3, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.945941 --> -0.967566).  Saving model ...
Epoch: 4 cost time: 3.653212547302246
Epoch: 4, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 3.1679208278656006
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 6 cost time: 3.309450149536133
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.574876546859741
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.480539321899414
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 4.481107473373413
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.236091613769531
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.420404434204102
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9114575386047363
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.294278860092163
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.116293907165527
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.6280224323272705
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.3977038860321045
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.494617462158203
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.717217445373535
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8715273
model size : 33.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.414183139801025
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.728 Vali Acc: 0.805 Test Loss: 1.728 Test Acc: 0.805
Validation loss decreased (inf --> -0.805388).  Saving model ...
Epoch: 2 cost time: 4.410032749176025
Epoch: 2, Steps: 17 | Train Loss: 0.961 Vali Loss: 0.627 Vali Acc: 0.919 Test Loss: 0.627 Test Acc: 0.919
Validation loss decreased (-0.805388 --> -0.918913).  Saving model ...
Epoch: 3 cost time: 4.553890705108643
Epoch: 3, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
Validation loss decreased (-0.918913 --> -0.954052).  Saving model ...
Epoch: 4 cost time: 4.044023513793945
Epoch: 4, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 4.486168622970581
Epoch: 5, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 6 cost time: 4.509160757064819
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 4.048266649246216
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 4.4713709354400635
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 4.347601890563965
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.114956855773926
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.580237627029419
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.78816556930542
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.816878080368042
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 4.824753284454346
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 4.5357749462127686
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 4.473892450332642
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.3374106884002686
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.7134528160095215
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.483896255493164
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.283369302749634
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 21 cost time: 3.9584333896636963
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.5629723072052
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.70618200302124
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.154619216918945
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.172104597091675
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.958610534667969
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.455775737762451
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.593175172805786
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.769141674041748
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.684709787368774
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8660233
model size : 33.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.651226758956909
Epoch: 1, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.746 Vali Acc: 0.797 Test Loss: 1.746 Test Acc: 0.797
Validation loss decreased (inf --> -0.797280).  Saving model ...
Epoch: 2 cost time: 3.822275161743164
Epoch: 2, Steps: 17 | Train Loss: 0.973 Vali Loss: 0.656 Vali Acc: 0.930 Test Loss: 0.656 Test Acc: 0.930
Validation loss decreased (-0.797280 --> -0.929723).  Saving model ...
Epoch: 3 cost time: 4.230234146118164
Epoch: 3, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
Validation loss decreased (-0.929723 --> -0.962160).  Saving model ...
Epoch: 4 cost time: 3.494091749191284
Epoch: 4, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 5 cost time: 4.170030355453491
Epoch: 5, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.687175512313843
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 4.450884819030762
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.965 Test Loss: 0.082 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.229426145553589
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 3.862067699432373
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8238186836242676
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8910508155822754
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6902456283569336
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 4.215611219406128
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.968 Test Loss: 0.079 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.975323438644409
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.739041328430176
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8407468795776367
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 3.702371120452881
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.190940618515015
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 3.662964105606079
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 3.8918814659118652
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8475191593170166
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.121589422225952
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 23 cost time: 4.234063625335693
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.7171831130981445
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.918616771697998
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.58941388130188
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 27 cost time: 4.51738977432251
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.4153406620025635
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8400256633758545
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.607414484024048
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.575008153915405
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.396955966949463
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.577248573303223
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.303019285202026
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.053566217422485
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.9574549198150635
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 8660361
model size : 33.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.984614849090576
Epoch: 1, Steps: 17 | Train Loss: 2.038 Vali Loss: 1.830 Vali Acc: 0.808 Test Loss: 1.830 Test Acc: 0.808
Validation loss decreased (inf --> -0.808090).  Saving model ...
Epoch: 2 cost time: 4.422165632247925
Epoch: 2, Steps: 17 | Train Loss: 1.129 Vali Loss: 0.819 Vali Acc: 0.908 Test Loss: 0.819 Test Acc: 0.908
Validation loss decreased (-0.808090 --> -0.908100).  Saving model ...
Epoch: 3 cost time: 4.242589235305786
Epoch: 3, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.273 Vali Acc: 0.954 Test Loss: 0.273 Test Acc: 0.954
Validation loss decreased (-0.908100 --> -0.954051).  Saving model ...
Epoch: 4 cost time: 4.150187015533447
Epoch: 4, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.954051 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 3.534773349761963
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 6 cost time: 4.202977657318115
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
Validation loss decreased (-0.978377 --> -0.983783).  Saving model ...
Epoch: 7 cost time: 4.039940357208252
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.686384201049805
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.880656003952026
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.173764944076538
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.077862024307251
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 12 cost time: 4.122525215148926
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 13 cost time: 4.770408630371094
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.5012054443359375
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.140727519989014
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.65791916847229
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.53300142288208
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.6750917434692383
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.278875112533569
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.474735498428345
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.004148721694946
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.107778549194336
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 8632969
model size : 33.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.144357681274414
Epoch: 1, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.696 Vali Acc: 0.889 Test Loss: 1.696 Test Acc: 0.889
Validation loss decreased (inf --> -0.889172).  Saving model ...
Epoch: 2 cost time: 3.2333438396453857
Epoch: 2, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.554 Vali Acc: 0.938 Test Loss: 0.554 Test Acc: 0.938
Validation loss decreased (-0.889172 --> -0.937832).  Saving model ...
Epoch: 3 cost time: 3.248708724975586
Epoch: 3, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.937832 --> -0.959458).  Saving model ...
Epoch: 4 cost time: 3.6697540283203125
Epoch: 4, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.959458 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 3.3855953216552734
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.715801477432251
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 3.95028018951416
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.906707286834717
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.038061141967773
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.722705364227295
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.411973714828491
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6994943618774414
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.362516403198242
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2898881435394287
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9117848873138428
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6915271282196045
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.973 Test Loss: 0.069 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2485641
model size : 9.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.200248956680298
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.621 Vali Acc: 0.854 Test Loss: 1.621 Test Acc: 0.854
Validation loss decreased (inf --> -0.854038).  Saving model ...
Epoch: 2 cost time: 3.2994415760040283
Epoch: 2, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.501 Vali Acc: 0.946 Test Loss: 0.501 Test Acc: 0.946
Validation loss decreased (-0.854038 --> -0.945941).  Saving model ...
Epoch: 3 cost time: 3.4135117530822754
Epoch: 3, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.945941 --> -0.962161).  Saving model ...
Epoch: 4 cost time: 3.9200823307037354
Epoch: 4, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6129400730133057
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 3.165940046310425
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 3.3335580825805664
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2104098796844482
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5218093395233154
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2629294395446777
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.968 Test Loss: 0.081 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.143028974533081
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.062347650527954
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7534143924713135
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8951025009155273
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.880894422531128
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.981584310531616
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2485705
model size : 9.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.334853172302246
Epoch: 1, Steps: 17 | Train Loss: 2.075 Vali Loss: 1.865 Vali Acc: 0.668 Test Loss: 1.865 Test Acc: 0.668
Validation loss decreased (inf --> -0.667549).  Saving model ...
Epoch: 2 cost time: 2.9483044147491455
Epoch: 2, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.001 Vali Acc: 0.908 Test Loss: 1.001 Test Acc: 0.908
Validation loss decreased (-0.667549 --> -0.908098).  Saving model ...
Epoch: 3 cost time: 3.0216195583343506
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.361 Vali Acc: 0.946 Test Loss: 0.361 Test Acc: 0.946
Validation loss decreased (-0.908098 --> -0.945942).  Saving model ...
Epoch: 4 cost time: 2.9498519897460938
Epoch: 4, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 3.2854957580566406
Epoch: 5, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.954052 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 3.2024056911468506
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 3.500537157058716
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.968153476715088
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2319297790527344
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9552457332611084
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.91017484664917
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 2.437288999557495
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 2.620549440383911
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.970 Test Loss: 0.074 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.641759157180786
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 3.0439388751983643
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.970 Test Loss: 0.073 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4229238033294678
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 2.470654010772705
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.940592050552368
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7812299728393555
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.970 Test Loss: 0.074 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.767073154449463
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.773296594619751
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.820528745651245
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.970 Test Loss: 0.073 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7015230655670166
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.7062058448791504
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.970 Test Loss: 0.073 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0216257572174072
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.2655365467071533
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.5342612266540527
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.970 Test Loss: 0.073 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2375177
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.082401752471924
Epoch: 1, Steps: 17 | Train Loss: 2.102 Vali Loss: 1.960 Vali Acc: 0.581 Test Loss: 1.960 Test Acc: 0.581
Validation loss decreased (inf --> -0.581061).  Saving model ...
Epoch: 2 cost time: 2.981597661972046
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.230 Vali Acc: 0.876 Test Loss: 1.230 Test Acc: 0.876
Validation loss decreased (-0.581061 --> -0.875663).  Saving model ...
Epoch: 3 cost time: 2.6525468826293945
Epoch: 3, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.551 Vali Acc: 0.932 Test Loss: 0.551 Test Acc: 0.932
Validation loss decreased (-0.875663 --> -0.932427).  Saving model ...
Epoch: 4 cost time: 2.539546251296997
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.237 Vali Acc: 0.959 Test Loss: 0.237 Test Acc: 0.959
Validation loss decreased (-0.932427 --> -0.959457).  Saving model ...
Epoch: 5 cost time: 2.513247013092041
Epoch: 5, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.455918312072754
Epoch: 6, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.2911293506622314
Epoch: 7, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 1.8230047225952148
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3126864433288574
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5492658615112305
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6666419506073
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.745760440826416
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8802061080932617
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6044232845306396
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5248372554779053
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7123923301696777
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7529125213623047
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2347657
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.490762948989868
Epoch: 1, Steps: 17 | Train Loss: 2.106 Vali Loss: 1.950 Vali Acc: 0.659 Test Loss: 1.950 Test Acc: 0.659
Validation loss decreased (inf --> -0.659440).  Saving model ...
Epoch: 2 cost time: 2.857865810394287
Epoch: 2, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.215 Vali Acc: 0.870 Test Loss: 1.215 Test Acc: 0.870
Validation loss decreased (-0.659440 --> -0.870258).  Saving model ...
Epoch: 3 cost time: 2.7284750938415527
Epoch: 3, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.500 Vali Acc: 0.941 Test Loss: 0.500 Test Acc: 0.941
Validation loss decreased (-0.870258 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 2.5570931434631348
Epoch: 4, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.245 Vali Acc: 0.957 Test Loss: 0.245 Test Acc: 0.957
Validation loss decreased (-0.940536 --> -0.956754).  Saving model ...
Epoch: 5 cost time: 2.857489585876465
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.956754 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.6916918754577637
Epoch: 6, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 3.163705825805664
Epoch: 7, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.851397752761841
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.986048460006714
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 3.105104684829712
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0320699214935303
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9232919216156006
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8941009044647217
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 3.1537303924560547
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1920688152313232
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2770533561706543
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.1164231300354004
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 2.6079397201538086
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.958038091659546
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.259094715118408
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8793423175811768
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 2.462467908859253
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7253918647766113
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8419647216796875
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.208338737487793
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.159144163131714
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 27 cost time: 2.9405784606933594
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.7484960556030273
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 29 cost time: 2.5261342525482178
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7225754261016846
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.1706793308258057
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.985614061355591
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.241567373275757
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.520254373550415
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.2295074462890625
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.2537217140197754
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.0516059398651123
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.9644315242767334
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2347721
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.197529077529907
Epoch: 1, Steps: 17 | Train Loss: 2.149 Vali Loss: 2.025 Vali Acc: 0.524 Test Loss: 2.025 Test Acc: 0.524
Validation loss decreased (inf --> -0.524304).  Saving model ...
Epoch: 2 cost time: 2.9471147060394287
Epoch: 2, Steps: 17 | Train Loss: 1.640 Vali Loss: 1.387 Vali Acc: 0.849 Test Loss: 1.387 Test Acc: 0.849
Validation loss decreased (-0.524304 --> -0.848635).  Saving model ...
Epoch: 3 cost time: 2.87837290763855
Epoch: 3, Steps: 17 | Train Loss: 0.959 Vali Loss: 0.709 Vali Acc: 0.938 Test Loss: 0.709 Test Acc: 0.938
Validation loss decreased (-0.848635 --> -0.937831).  Saving model ...
Epoch: 4 cost time: 2.7515134811401367
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.335 Vali Acc: 0.962 Test Loss: 0.335 Test Acc: 0.962
Validation loss decreased (-0.937831 --> -0.962159).  Saving model ...
Epoch: 5 cost time: 2.5436620712280273
Epoch: 5, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.192 Vali Acc: 0.970 Test Loss: 0.192 Test Acc: 0.970
Validation loss decreased (-0.962159 --> -0.970268).  Saving model ...
Epoch: 6 cost time: 2.4715969562530518
Epoch: 6, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.8053064346313477
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 2.9143033027648926
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 2.8562493324279785
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.8635222911834717
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 2.6513195037841797
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.7793900966644287
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6762351989746094
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.545952320098877
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6230990886688232
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.917571544647217
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7209503650665283
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2318198680877686
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7598164081573486
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.8632805347442627
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9765279293060303
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.970 Test Loss: 0.074 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2334025
model size : 8.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.933096170425415
Epoch: 1, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.852 Vali Acc: 0.738 Test Loss: 1.852 Test Acc: 0.738
Validation loss decreased (inf --> -0.737819).  Saving model ...
Epoch: 2 cost time: 2.3501670360565186
Epoch: 2, Steps: 17 | Train Loss: 1.232 Vali Loss: 0.978 Vali Acc: 0.922 Test Loss: 0.978 Test Acc: 0.922
Validation loss decreased (-0.737819 --> -0.921612).  Saving model ...
Epoch: 3 cost time: 1.8437442779541016
Epoch: 3, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.370 Vali Acc: 0.957 Test Loss: 0.370 Test Acc: 0.957
Validation loss decreased (-0.921612 --> -0.956753).  Saving model ...
Epoch: 4 cost time: 1.8998918533325195
Epoch: 4, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.956753 --> -0.956755).  Saving model ...
Epoch: 5 cost time: 2.4224367141723633
Epoch: 5, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.785494565963745
Epoch: 6, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.967566 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 2.7879765033721924
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7927985191345215
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8215808868408203
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 2.488417863845825
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.708268880844116
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.643388032913208
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5414109230041504
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 2.3270151615142822
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.30329966545105
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2264561653137207
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4410560131073
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.154155731201172
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9545176029205322
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7066519260406494
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8020670413970947
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.718095302581787
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0109708309173584
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 747209
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.601203680038452
Epoch: 1, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.856 Vali Acc: 0.768 Test Loss: 1.856 Test Acc: 0.768
Validation loss decreased (inf --> -0.767549).  Saving model ...
Epoch: 2 cost time: 2.7223398685455322
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.083 Vali Acc: 0.905 Test Loss: 1.083 Test Acc: 0.905
Validation loss decreased (-0.767549 --> -0.905395).  Saving model ...
Epoch: 3 cost time: 2.598701238632202
Epoch: 3, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.413 Vali Acc: 0.951 Test Loss: 0.413 Test Acc: 0.951
Validation loss decreased (-0.905395 --> -0.951347).  Saving model ...
Epoch: 4 cost time: 2.6321473121643066
Epoch: 4, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.951347 --> -0.959457).  Saving model ...
Epoch: 5 cost time: 2.666469097137451
Epoch: 5, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.6646080017089844
Epoch: 6, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.9489588737487793
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.8141918182373047
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.565688371658325
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.1636250019073486
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 2.5442166328430176
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 2.6594598293304443
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.499809741973877
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6154253482818604
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 2.750326633453369
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8558688163757324
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6210174560546875
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.632526397705078
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4991989135742188
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.549586772918701
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0911624431610107
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1754260063171387
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7312347888946533
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.718986749649048
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 747241
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.070910215377808
Epoch: 1, Steps: 17 | Train Loss: 2.150 Vali Loss: 2.050 Vali Acc: 0.403 Test Loss: 2.050 Test Acc: 0.403
Validation loss decreased (inf --> -0.402682).  Saving model ...
Epoch: 2 cost time: 2.827024221420288
Epoch: 2, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.591 Vali Acc: 0.824 Test Loss: 1.591 Test Acc: 0.824
Validation loss decreased (-0.402682 --> -0.824308).  Saving model ...
Epoch: 3 cost time: 2.654849052429199
Epoch: 3, Steps: 17 | Train Loss: 1.167 Vali Loss: 0.973 Vali Acc: 0.916 Test Loss: 0.973 Test Acc: 0.916
Validation loss decreased (-0.824308 --> -0.916206).  Saving model ...
Epoch: 4 cost time: 2.858840227127075
Epoch: 4, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.491 Vali Acc: 0.938 Test Loss: 0.491 Test Acc: 0.938
Validation loss decreased (-0.916206 --> -0.937833).  Saving model ...
Epoch: 5 cost time: 2.555363416671753
Epoch: 5, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.280 Vali Acc: 0.949 Test Loss: 0.280 Test Acc: 0.949
Validation loss decreased (-0.937833 --> -0.948646).  Saving model ...
Epoch: 6 cost time: 2.1809146404266357
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
Validation loss decreased (-0.948646 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 2.2019615173339844
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 2.557349443435669
Epoch: 8, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 2.2090840339660645
Epoch: 9, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2521629333496094
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4177002906799316
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5712711811065674
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7797510623931885
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3665192127227783
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 2.1542067527770996
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.416959047317505
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1392621994018555
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.731578826904297
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5382769107818604
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.353790044784546
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0074715614318848
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.127967119216919
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.968 Test Loss: 0.075 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1994118690490723
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.968 Test Loss: 0.078 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2470481395721436
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 691977
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.2552783489227295
Epoch: 1, Steps: 17 | Train Loss: 2.118 Vali Loss: 2.041 Vali Acc: 0.511 Test Loss: 2.041 Test Acc: 0.511
Validation loss decreased (inf --> -0.510790).  Saving model ...
Epoch: 2 cost time: 2.8251636028289795
Epoch: 2, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.661 Vali Acc: 0.811 Test Loss: 1.661 Test Acc: 0.811
Validation loss decreased (-0.510790 --> -0.810794).  Saving model ...
Epoch: 3 cost time: 2.445781946182251
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.150 Vali Acc: 0.843 Test Loss: 1.150 Test Acc: 0.843
Validation loss decreased (-0.810794 --> -0.843232).  Saving model ...
Epoch: 4 cost time: 2.242997646331787
Epoch: 4, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.687 Vali Acc: 0.924 Test Loss: 0.687 Test Acc: 0.924
Validation loss decreased (-0.843232 --> -0.924317).  Saving model ...
Epoch: 5 cost time: 2.06746244430542
Epoch: 5, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.403 Vali Acc: 0.943 Test Loss: 0.403 Test Acc: 0.943
Validation loss decreased (-0.924317 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 2.2455263137817383
Epoch: 6, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.267 Vali Acc: 0.965 Test Loss: 0.267 Test Acc: 0.965
Validation loss decreased (-0.943239 --> -0.964862).  Saving model ...
Epoch: 7 cost time: 2.2963900566101074
Epoch: 7, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
Validation loss decreased (-0.964862 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 2.3811402320861816
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 2.219257116317749
Epoch: 9, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.225034236907959
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 2.1134982109069824
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 2.487612009048462
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 2.5689432621002197
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 2.288055419921875
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 2.38671612739563
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 2.12035870552063
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 2.1544992923736572
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4022610187530518
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4829046726226807
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 2.56181263923645
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 21 cost time: 2.3409037590026855
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8469488620758057
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 23 cost time: 2.4583559036254883
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.400576591491699
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 25 cost time: 2.3396031856536865
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 2.285912036895752
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.689901113510132
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.318460464477539
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4767074584960938
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.358705759048462
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.4017112255096436
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.394366979598999
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.3757386207580566
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.6174490451812744
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.5530803203582764
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 678217
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.171965599060059
Epoch: 1, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.045 Vali Acc: 0.432 Test Loss: 2.045 Test Acc: 0.432
Validation loss decreased (inf --> -0.432412).  Saving model ...
Epoch: 2 cost time: 2.287104606628418
Epoch: 2, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.646 Vali Acc: 0.749 Test Loss: 1.646 Test Acc: 0.749
Validation loss decreased (-0.432412 --> -0.748632).  Saving model ...
Epoch: 3 cost time: 2.00528883934021
Epoch: 3, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.107 Vali Acc: 0.841 Test Loss: 1.107 Test Acc: 0.841
Validation loss decreased (-0.748632 --> -0.840529).  Saving model ...
Epoch: 4 cost time: 1.962432622909546
Epoch: 4, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.611 Vali Acc: 0.922 Test Loss: 0.611 Test Acc: 0.922
Validation loss decreased (-0.840529 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 2.111767530441284
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.354 Vali Acc: 0.954 Test Loss: 0.354 Test Acc: 0.954
Validation loss decreased (-0.921616 --> -0.954051).  Saving model ...
Epoch: 6 cost time: 2.164196491241455
Epoch: 6, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.241 Vali Acc: 0.962 Test Loss: 0.241 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 7 cost time: 1.8864679336547852
Epoch: 7, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 2.0627660751342773
Epoch: 8, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.267523765563965
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.1527535915374756
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.343533515930176
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 2.112574577331543
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 2.2480015754699707
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9005374908447266
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.101715087890625
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 2.016859292984009
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0580976009368896
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1954641342163086
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3707079887390137
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3276050090789795
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1921911239624023
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2384536266326904
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2834837436676025
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9886188507080078
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.129045009613037
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2530298233032227
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.182809829711914
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.257188320159912
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1453747749328613
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0693085193634033
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.150554656982422
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.172860622406006
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.239394187927246
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.449390172958374
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 678249
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.696295499801636
Epoch: 1, Steps: 17 | Train Loss: 2.153 Vali Loss: 2.104 Vali Acc: 0.316 Test Loss: 2.104 Test Acc: 0.316
Validation loss decreased (inf --> -0.316195).  Saving model ...
Epoch: 2 cost time: 2.3530657291412354
Epoch: 2, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.784 Vali Acc: 0.695 Test Loss: 1.784 Test Acc: 0.695
Validation loss decreased (-0.316195 --> -0.694577).  Saving model ...
Epoch: 3 cost time: 2.489497423171997
Epoch: 3, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.331 Vali Acc: 0.819 Test Loss: 1.331 Test Acc: 0.819
Validation loss decreased (-0.694577 --> -0.818906).  Saving model ...
Epoch: 4 cost time: 2.243096113204956
Epoch: 4, Steps: 17 | Train Loss: 1.034 Vali Loss: 0.881 Vali Acc: 0.884 Test Loss: 0.881 Test Acc: 0.884
Validation loss decreased (-0.818906 --> -0.883775).  Saving model ...
Epoch: 5 cost time: 2.386486053466797
Epoch: 5, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.547 Vali Acc: 0.924 Test Loss: 0.547 Test Acc: 0.924
Validation loss decreased (-0.883775 --> -0.924319).  Saving model ...
Epoch: 6 cost time: 2.584096908569336
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.338 Vali Acc: 0.954 Test Loss: 0.338 Test Acc: 0.954
Validation loss decreased (-0.924319 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 2.2221410274505615
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 2.552529811859131
Epoch: 8, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970268).  Saving model ...
Epoch: 9 cost time: 2.6574110984802246
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.556950330734253
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.287684679031372
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.516042709350586
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 2.435447931289673
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7729735374450684
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5210626125335693
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.502929210662842
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3469910621643066
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.39292311668396
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.472461462020874
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.594768524169922
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4537038803100586
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.451695203781128
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 671401
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.024053573608398
Epoch: 1, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.062 Vali Acc: 0.897 Test Loss: 1.062 Test Acc: 0.897
Validation loss decreased (inf --> -0.897287).  Saving model ...
Epoch: 2 cost time: 5.07921028137207
Epoch: 2, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.225 Vali Acc: 0.932 Test Loss: 0.225 Test Acc: 0.932
Validation loss decreased (-0.897287 --> -0.932430).  Saving model ...
Epoch: 3 cost time: 4.975438594818115
Epoch: 3, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.932430 --> -0.983783).  Saving model ...
Epoch: 4 cost time: 4.452043533325195
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.809929609298706
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.0920679569244385
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.4636993408203125
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.776911735534668
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.408907651901245
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.599996566772461
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.27182149887085
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.842637300491333
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.036108016967773
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 8917769
model size : 34.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.618878126144409
Epoch: 1, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.205 Vali Acc: 0.881 Test Loss: 1.205 Test Acc: 0.881
Validation loss decreased (inf --> -0.881069).  Saving model ...
Epoch: 2 cost time: 5.167636871337891
Epoch: 2, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.271 Vali Acc: 0.914 Test Loss: 0.271 Test Acc: 0.914
Validation loss decreased (-0.881069 --> -0.913511).  Saving model ...
Epoch: 3 cost time: 4.576615571975708
Epoch: 3, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.913511 --> -0.975675).  Saving model ...
Epoch: 4 cost time: 4.0553297996521
Epoch: 4, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.449794292449951
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 6 cost time: 4.391936540603638
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.704695701599121
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.09928297996521
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.097721815109253
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.016301393508911
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.2232067584991455
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.415564060211182
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.950297832489014
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.6817145347595215
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.81005597114563
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8917897
model size : 34.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.21590518951416
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.593 Vali Acc: 0.878 Test Loss: 1.593 Test Acc: 0.878
Validation loss decreased (inf --> -0.878362).  Saving model ...
Epoch: 2 cost time: 3.983905553817749
Epoch: 2, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.408 Vali Acc: 0.943 Test Loss: 0.408 Test Acc: 0.943
Validation loss decreased (-0.878362 --> -0.943239).  Saving model ...
Epoch: 3 cost time: 3.480130195617676
Epoch: 3, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.943239 --> -0.954052).  Saving model ...
Epoch: 4 cost time: 3.402503490447998
Epoch: 4, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.954052 --> -0.978377).  Saving model ...
Epoch: 5 cost time: 4.298527956008911
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.061187267303467
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.658066749572754
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.130498170852661
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.7340281009674072
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.173542737960815
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.546189308166504
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.798372745513916
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.849637269973755
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.016141891479492
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8696841
model size : 33.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.204512119293213
Epoch: 1, Steps: 17 | Train Loss: 1.926 Vali Loss: 1.678 Vali Acc: 0.822 Test Loss: 1.678 Test Acc: 0.822
Validation loss decreased (inf --> -0.821605).  Saving model ...
Epoch: 2 cost time: 3.373528242111206
Epoch: 2, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.596 Vali Acc: 0.935 Test Loss: 0.596 Test Acc: 0.935
Validation loss decreased (-0.821605 --> -0.935129).  Saving model ...
Epoch: 3 cost time: 3.6111392974853516
Epoch: 3, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.186 Vali Acc: 0.965 Test Loss: 0.186 Test Acc: 0.965
Validation loss decreased (-0.935129 --> -0.964863).  Saving model ...
Epoch: 4 cost time: 3.899641990661621
Epoch: 4, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2956326007843018
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 2.9836223125457764
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 3.1239442825317383
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.108886480331421
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 3.7330172061920166
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 3.610753297805786
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 3.715465784072876
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6944773197174072
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.688800811767578
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 3.746042251586914
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5153536796569824
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6994192600250244
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8875911235809326
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.553050994873047
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6498618125915527
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8712387084960938
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8245251178741455
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.59555983543396
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.6604349613189697
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8641801
model size : 33.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.164990425109863
Epoch: 1, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.784 Vali Acc: 0.851 Test Loss: 1.784 Test Acc: 0.851
Validation loss decreased (inf --> -0.851334).  Saving model ...
Epoch: 2 cost time: 4.1065239906311035
Epoch: 2, Steps: 17 | Train Loss: 1.026 Vali Loss: 0.685 Vali Acc: 0.916 Test Loss: 0.685 Test Acc: 0.916
Validation loss decreased (-0.851334 --> -0.916209).  Saving model ...
Epoch: 3 cost time: 3.884415626525879
Epoch: 3, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
Validation loss decreased (-0.916209 --> -0.951349).  Saving model ...
Epoch: 4 cost time: 3.910385847091675
Epoch: 4, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.951349 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 3.7140023708343506
Epoch: 5, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 6 cost time: 3.4696359634399414
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2487006187438965
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5688817501068115
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8015224933624268
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3467891216278076
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4732139110565186
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.3732798099517822
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.051435947418213
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.9303576946258545
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.074826002120972
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8641929
model size : 33.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.600521087646484
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.847 Vali Acc: 0.730 Test Loss: 1.847 Test Acc: 0.730
Validation loss decreased (inf --> -0.729711).  Saving model ...
Epoch: 2 cost time: 3.826664686203003
Epoch: 2, Steps: 17 | Train Loss: 1.100 Vali Loss: 0.788 Vali Acc: 0.905 Test Loss: 0.788 Test Acc: 0.905
Validation loss decreased (-0.729711 --> -0.905398).  Saving model ...
Epoch: 3 cost time: 3.656641721725464
Epoch: 3, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.262 Vali Acc: 0.957 Test Loss: 0.262 Test Acc: 0.957
Validation loss decreased (-0.905398 --> -0.956754).  Saving model ...
Epoch: 4 cost time: 3.7222323417663574
Epoch: 4, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.956754 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 3.555788993835449
Epoch: 5, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.5273048877716064
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 3.829235553741455
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.340632438659668
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 3.0236892700195312
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5279502868652344
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.580819606781006
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8255088329315186
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.8023743629455566
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6917519569396973
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 3.624802827835083
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 4.045270681381226
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.218799114227295
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 18 cost time: 4.132798194885254
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.320940971374512
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2318363189697266
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.765988826751709
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.9241368770599365
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.78847336769104
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.4432361125946045
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.549381971359253
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.6589083671569824
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.015920639038086
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 8614537
model size : 32.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.05048680305481
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.655 Vali Acc: 0.859 Test Loss: 1.655 Test Acc: 0.859
Validation loss decreased (inf --> -0.859443).  Saving model ...
Epoch: 2 cost time: 3.0589797496795654
Epoch: 2, Steps: 17 | Train Loss: 0.807 Vali Loss: 0.492 Vali Acc: 0.949 Test Loss: 0.492 Test Acc: 0.949
Validation loss decreased (-0.859443 --> -0.948644).  Saving model ...
Epoch: 3 cost time: 2.9506709575653076
Epoch: 3, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.948644 --> -0.948647).  Saving model ...
Epoch: 4 cost time: 3.3678524494171143
Epoch: 4, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.948647 --> -0.978378).  Saving model ...
Epoch: 5 cost time: 3.2395033836364746
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7447147369384766
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 3.123836040496826
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0081698894500732
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.226532459259033
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.036499500274658
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.853597640991211
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0422799587249756
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7854506969451904
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.862173557281494
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0353503227233887
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2241456508636475
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2476425
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.243890285491943
Epoch: 1, Steps: 17 | Train Loss: 1.871 Vali Loss: 1.589 Vali Acc: 0.795 Test Loss: 1.589 Test Acc: 0.795
Validation loss decreased (inf --> -0.794579).  Saving model ...
Epoch: 2 cost time: 2.947402238845825
Epoch: 2, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.484 Vali Acc: 0.941 Test Loss: 0.484 Test Acc: 0.941
Validation loss decreased (-0.794579 --> -0.940536).  Saving model ...
Epoch: 3 cost time: 3.037112236022949
Epoch: 3, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
Validation loss decreased (-0.940536 --> -0.975674).  Saving model ...
Epoch: 4 cost time: 2.9961671829223633
Epoch: 4, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2614669799804688
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4118101596832275
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 3.393350601196289
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.381812572479248
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4653406143188477
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 3.3396477699279785
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2445759773254395
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.055783987045288
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3872151374816895
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 3.200866460800171
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 3.2478432655334473
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4101738929748535
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5393946170806885
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.381171941757202
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3926713466644287
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.082326650619507
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0351040363311768
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.064168930053711
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.1021687984466553
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9068081378936768
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2476489
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.0799171924591064
Epoch: 1, Steps: 17 | Train Loss: 2.056 Vali Loss: 1.881 Vali Acc: 0.705 Test Loss: 1.881 Test Acc: 0.705
Validation loss decreased (inf --> -0.705387).  Saving model ...
Epoch: 2 cost time: 2.883866548538208
Epoch: 2, Steps: 17 | Train Loss: 1.284 Vali Loss: 0.967 Vali Acc: 0.889 Test Loss: 0.967 Test Acc: 0.889
Validation loss decreased (-0.705387 --> -0.889180).  Saving model ...
Epoch: 3 cost time: 2.90205979347229
Epoch: 3, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.366 Vali Acc: 0.946 Test Loss: 0.366 Test Acc: 0.946
Validation loss decreased (-0.889180 --> -0.945942).  Saving model ...
Epoch: 4 cost time: 2.9264533519744873
Epoch: 4, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
Validation loss decreased (-0.945942 --> -0.967566).  Saving model ...
Epoch: 5 cost time: 2.9052319526672363
Epoch: 5, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.687288999557495
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 2.636776924133301
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 2.323460817337036
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6625030040740967
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6665594577789307
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.03598690032959
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5645058155059814
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.781003475189209
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.471536636352539
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4284913539886475
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.662806749343872
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4590630531311035
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2365961
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.855839729309082
Epoch: 1, Steps: 17 | Train Loss: 2.078 Vali Loss: 1.938 Vali Acc: 0.684 Test Loss: 1.938 Test Acc: 0.684
Validation loss decreased (inf --> -0.683764).  Saving model ...
Epoch: 2 cost time: 2.7900259494781494
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.166 Vali Acc: 0.895 Test Loss: 1.166 Test Acc: 0.895
Validation loss decreased (-0.683764 --> -0.894583).  Saving model ...
Epoch: 3 cost time: 2.585667133331299
Epoch: 3, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.505 Vali Acc: 0.922 Test Loss: 0.505 Test Acc: 0.922
Validation loss decreased (-0.894583 --> -0.921617).  Saving model ...
Epoch: 4 cost time: 2.6209027767181396
Epoch: 4, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
Validation loss decreased (-0.921617 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 2.5381252765655518
Epoch: 5, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
Validation loss decreased (-0.943241 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.7005038261413574
Epoch: 6, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.621302366256714
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.538264036178589
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7693896293640137
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.574808120727539
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 2.879152297973633
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.447659730911255
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 2.3667232990264893
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.3407552242279053
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 2.739623546600342
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.807410478591919
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 2.943218231201172
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8693742752075195
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4426865577697754
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1082193851470947
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.595271110534668
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.373514175415039
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5513548851013184
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7725648880004883
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.666015625
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 26 cost time: 2.687027931213379
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6591310501098633
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 28 cost time: 2.398583173751831
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5606114864349365
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 30 cost time: 2.537536144256592
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2213220596313477
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 32 cost time: 2.337057113647461
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.301302194595337
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.600775957107544
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.819141149520874
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.5716006755828857
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.6068572998046875
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.824435234069824
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.5707671642303467
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.5000576972961426
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.655846118927002
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2338441
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.253743886947632
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.912 Vali Acc: 0.692 Test Loss: 1.912 Test Acc: 0.692
Validation loss decreased (inf --> -0.691873).  Saving model ...
Epoch: 2 cost time: 2.4826302528381348
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.158 Vali Acc: 0.889 Test Loss: 1.158 Test Acc: 0.889
Validation loss decreased (-0.691873 --> -0.889178).  Saving model ...
Epoch: 3 cost time: 2.608274459838867
Epoch: 3, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.495 Vali Acc: 0.938 Test Loss: 0.495 Test Acc: 0.938
Validation loss decreased (-0.889178 --> -0.937833).  Saving model ...
Epoch: 4 cost time: 2.8888750076293945
Epoch: 4, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.229 Vali Acc: 0.954 Test Loss: 0.229 Test Acc: 0.954
Validation loss decreased (-0.937833 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 2.5411510467529297
Epoch: 5, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.954052 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.2823567390441895
Epoch: 6, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 2.37499737739563
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 2.974874973297119
Epoch: 8, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 2.7722363471984863
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6349282264709473
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.844968318939209
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.6545426845550537
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 2.716287136077881
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 2.5457544326782227
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.742163896560669
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9320120811462402
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6500351428985596
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7820682525634766
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.825915813446045
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7616007328033447
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.7130112648010254
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4178318977355957
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.4993772506713867
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2338505
model size : 8.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.109850883483887
Epoch: 1, Steps: 17 | Train Loss: 2.098 Vali Loss: 1.974 Vali Acc: 0.654 Test Loss: 1.974 Test Acc: 0.654
Validation loss decreased (inf --> -0.654034).  Saving model ...
Epoch: 2 cost time: 2.3836376667022705
Epoch: 2, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.356 Vali Acc: 0.876 Test Loss: 1.356 Test Acc: 0.876
Validation loss decreased (-0.654034 --> -0.875662).  Saving model ...
Epoch: 3 cost time: 2.504204750061035
Epoch: 3, Steps: 17 | Train Loss: 0.899 Vali Loss: 0.685 Vali Acc: 0.916 Test Loss: 0.685 Test Acc: 0.916
Validation loss decreased (-0.875662 --> -0.916209).  Saving model ...
Epoch: 4 cost time: 2.492281675338745
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.320 Vali Acc: 0.973 Test Loss: 0.320 Test Acc: 0.973
Validation loss decreased (-0.916209 --> -0.972970).  Saving model ...
Epoch: 5 cost time: 2.4472084045410156
Epoch: 5, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
Validation loss decreased (-0.972970 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 2.722377300262451
Epoch: 6, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.769760847091675
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 2.4007468223571777
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 2.6547703742980957
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8175840377807617
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5666332244873047
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.695155620574951
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6053121089935303
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4176812171936035
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6898748874664307
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4728705883026123
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6424338817596436
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6245248317718506
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2324809
model size : 8.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.964072942733765
Epoch: 1, Steps: 17 | Train Loss: 2.084 Vali Loss: 1.923 Vali Acc: 0.627 Test Loss: 1.923 Test Acc: 0.627
Validation loss decreased (inf --> -0.627008).  Saving model ...
Epoch: 2 cost time: 2.640080690383911
Epoch: 2, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.058 Vali Acc: 0.922 Test Loss: 1.058 Test Acc: 0.922
Validation loss decreased (-0.627008 --> -0.921611).  Saving model ...
Epoch: 3 cost time: 2.395291805267334
Epoch: 3, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.382 Vali Acc: 0.965 Test Loss: 0.382 Test Acc: 0.965
Validation loss decreased (-0.921611 --> -0.964861).  Saving model ...
Epoch: 4 cost time: 2.5136055946350098
Epoch: 4, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4149162769317627
Epoch: 5, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.964861 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.4773108959198
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 2.386474609375
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.477433919906616
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 2.3706564903259277
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6523687839508057
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.555340051651001
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.656909465789795
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0818135738372803
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7450947761535645
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.27414870262146
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.343174934387207
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 2.6483852863311768
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.574561834335327
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.982091188430786
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.63012957572937
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.434539794921875
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2448108196258545
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0819218158721924
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3519985675811768
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3424205780029297
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4433987140655518
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 742601
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.3910017013549805
Epoch: 1, Steps: 17 | Train Loss: 2.085 Vali Loss: 1.898 Vali Acc: 0.689 Test Loss: 1.898 Test Acc: 0.689
Validation loss decreased (inf --> -0.689170).  Saving model ...
Epoch: 2 cost time: 2.341747999191284
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.089 Vali Acc: 0.886 Test Loss: 1.089 Test Acc: 0.886
Validation loss decreased (-0.689170 --> -0.886476).  Saving model ...
Epoch: 3 cost time: 1.9370365142822266
Epoch: 3, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.432 Vali Acc: 0.938 Test Loss: 0.432 Test Acc: 0.938
Validation loss decreased (-0.886476 --> -0.937834).  Saving model ...
Epoch: 4 cost time: 2.3090968132019043
Epoch: 4, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
Validation loss decreased (-0.937834 --> -0.962160).  Saving model ...
Epoch: 5 cost time: 1.9668772220611572
Epoch: 5, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
Validation loss decreased (-0.962160 --> -0.981080).  Saving model ...
Epoch: 6 cost time: 2.503153085708618
Epoch: 6, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 3.007439613342285
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6331911087036133
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.721433639526367
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3481757640838623
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4058446884155273
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2906126976013184
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6141388416290283
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.472446918487549
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.471703290939331
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0201973915100098
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 742633
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.45589280128479
Epoch: 1, Steps: 17 | Train Loss: 2.061 Vali Loss: 1.991 Vali Acc: 0.584 Test Loss: 1.991 Test Acc: 0.584
Validation loss decreased (inf --> -0.583764).  Saving model ...
Epoch: 2 cost time: 2.5805420875549316
Epoch: 2, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.504 Vali Acc: 0.878 Test Loss: 1.504 Test Acc: 0.878
Validation loss decreased (-0.583764 --> -0.878363).  Saving model ...
Epoch: 3 cost time: 2.3310813903808594
Epoch: 3, Steps: 17 | Train Loss: 1.111 Vali Loss: 0.916 Vali Acc: 0.927 Test Loss: 0.916 Test Acc: 0.927
Validation loss decreased (-0.878363 --> -0.927018).  Saving model ...
Epoch: 4 cost time: 2.1385295391082764
Epoch: 4, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.459 Vali Acc: 0.941 Test Loss: 0.459 Test Acc: 0.941
Validation loss decreased (-0.927018 --> -0.940536).  Saving model ...
Epoch: 5 cost time: 2.147296667098999
Epoch: 5, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.261 Vali Acc: 0.954 Test Loss: 0.261 Test Acc: 0.954
Validation loss decreased (-0.940536 --> -0.954051).  Saving model ...
Epoch: 6 cost time: 2.0842697620391846
Epoch: 6, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.183 Vali Acc: 0.968 Test Loss: 0.183 Test Acc: 0.968
Validation loss decreased (-0.954051 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.8349823951721191
Epoch: 7, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.4894170761108398
Epoch: 8, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 1.9041056632995605
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.1401102542877197
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2967185974121094
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.04561710357666
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.302527904510498
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.316175699234009
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 2.4085114002227783
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6513009071350098
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7667946815490723
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4459755420684814
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4268503189086914
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0120763778686523
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1348989009857178
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.968 Test Loss: 0.078 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.183467388153076
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4315245151519775
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6642332077026367
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 687369
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.442543268203735
Epoch: 1, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.086 Vali Acc: 0.281 Test Loss: 2.086 Test Acc: 0.281
Validation loss decreased (inf --> -0.281060).  Saving model ...
Epoch: 2 cost time: 2.129533529281616
Epoch: 2, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.697 Vali Acc: 0.797 Test Loss: 1.697 Test Acc: 0.797
Validation loss decreased (-0.281060 --> -0.797280).  Saving model ...
Epoch: 3 cost time: 2.1914219856262207
Epoch: 3, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.165 Vali Acc: 0.884 Test Loss: 1.165 Test Acc: 0.884
Validation loss decreased (-0.797280 --> -0.883772).  Saving model ...
Epoch: 4 cost time: 1.9988064765930176
Epoch: 4, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.686 Vali Acc: 0.924 Test Loss: 0.686 Test Acc: 0.924
Validation loss decreased (-0.883772 --> -0.924317).  Saving model ...
Epoch: 5 cost time: 1.7878713607788086
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.387 Vali Acc: 0.938 Test Loss: 0.387 Test Acc: 0.938
Validation loss decreased (-0.924317 --> -0.937834).  Saving model ...
Epoch: 6 cost time: 1.9806602001190186
Epoch: 6, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.242 Vali Acc: 0.965 Test Loss: 0.242 Test Acc: 0.965
Validation loss decreased (-0.937834 --> -0.964862).  Saving model ...
Epoch: 7 cost time: 1.977219581604004
Epoch: 7, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
Validation loss decreased (-0.964862 --> -0.972971).  Saving model ...
Epoch: 8 cost time: 2.313894271850586
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.332902431488037
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.885955572128296
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.235055685043335
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.7485957145690918
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0150887966156006
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3938398361206055
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.6704647541046143
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8326621055603027
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.815392255783081
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.348322629928589
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5300705432891846
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.30171537399292
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.310680389404297
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.462876558303833
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.799116849899292
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.960198163986206
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9969983100891113
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8782365322113037
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.0502827167510986
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.970 Test Loss: 0.072 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 673609
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.322974681854248
Epoch: 1, Steps: 17 | Train Loss: 2.143 Vali Loss: 2.061 Vali Acc: 0.419 Test Loss: 2.061 Test Acc: 0.419
Validation loss decreased (inf --> -0.418898).  Saving model ...
Epoch: 2 cost time: 2.5635664463043213
Epoch: 2, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.657 Vali Acc: 0.792 Test Loss: 1.657 Test Acc: 0.792
Validation loss decreased (-0.418898 --> -0.791875).  Saving model ...
Epoch: 3 cost time: 2.6122360229492188
Epoch: 3, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.108 Vali Acc: 0.865 Test Loss: 1.108 Test Acc: 0.865
Validation loss decreased (-0.791875 --> -0.864854).  Saving model ...
Epoch: 4 cost time: 2.6854047775268555
Epoch: 4, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.630 Vali Acc: 0.908 Test Loss: 0.630 Test Acc: 0.908
Validation loss decreased (-0.864854 --> -0.908102).  Saving model ...
Epoch: 5 cost time: 2.3844950199127197
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.352 Vali Acc: 0.957 Test Loss: 0.352 Test Acc: 0.957
Validation loss decreased (-0.908102 --> -0.956753).  Saving model ...
Epoch: 6 cost time: 2.395902633666992
Epoch: 6, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.231 Vali Acc: 0.973 Test Loss: 0.231 Test Acc: 0.973
Validation loss decreased (-0.956753 --> -0.972971).  Saving model ...
Epoch: 7 cost time: 1.8806462287902832
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7861418724060059
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1050865650177
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.8969011306762695
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.133129596710205
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.287396192550659
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 2.4512906074523926
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.287933349609375
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 2.236514091491699
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 2.2261364459991455
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.359588146209717
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.605380058288574
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 2.3369269371032715
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.3737151622772217
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 2.395240545272827
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.374152183532715
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.49839186668396
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.280372142791748
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 2.1282975673675537
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 26 cost time: 2.057978630065918
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 27 cost time: 2.1784961223602295
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.060546398162842
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2220618724823
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.966169834136963
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9985930919647217
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0004332065582275
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.4545490741729736
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.5068557262420654
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.2447264194488525
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.0697271823883057
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 673641
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.926870822906494
Epoch: 1, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.095 Vali Acc: 0.262 Test Loss: 2.095 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 2.102602481842041
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.774 Vali Acc: 0.673 Test Loss: 1.774 Test Acc: 0.673
Validation loss decreased (-0.262141 --> -0.672955).  Saving model ...
Epoch: 3 cost time: 2.439631700515747
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.325 Vali Acc: 0.832 Test Loss: 1.325 Test Acc: 0.832
Validation loss decreased (-0.672955 --> -0.832419).  Saving model ...
Epoch: 4 cost time: 2.2272021770477295
Epoch: 4, Steps: 17 | Train Loss: 1.023 Vali Loss: 0.869 Vali Acc: 0.903 Test Loss: 0.869 Test Acc: 0.903
Validation loss decreased (-0.832419 --> -0.902694).  Saving model ...
Epoch: 5 cost time: 2.0218329429626465
Epoch: 5, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.539 Vali Acc: 0.927 Test Loss: 0.539 Test Acc: 0.927
Validation loss decreased (-0.902694 --> -0.927022).  Saving model ...
Epoch: 6 cost time: 2.0096042156219482
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940537).  Saving model ...
Epoch: 7 cost time: 1.7889907360076904
Epoch: 7, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
Validation loss decreased (-0.940537 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 1.8460347652435303
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.191 Vali Acc: 0.968 Test Loss: 0.191 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.4446756839752197
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.463829278945923
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.6371753215789795
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975674).  Saving model ...
Epoch: 12 cost time: 2.6461737155914307
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.603193521499634
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.619527578353882
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 2.607649564743042
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2031850814819336
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.8387584686279297
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.7033188343048096
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7384300231933594
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 1.7305498123168945
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7677958011627197
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.802577018737793
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 1.9520611763000488
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8954451084136963
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 1.5741713047027588
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1258785724639893
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 27 cost time: 2.0736472606658936
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 28 cost time: 2.160895347595215
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5921847820281982
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.7615959644317627
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.52927303314209
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.2368977069854736
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.3525030612945557
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.427950620651245
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 35 cost time: 2.2486090660095215
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.312263011932373
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 37 cost time: 2.3357512950897217
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.3606717586517334
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.3394289016723633
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.041717529296875
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.997925043106079
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.152442455291748
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.1568305492401123
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.442514657974243
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.822421073913574
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.7317707538604736
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 666793
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.6248955726623535
Epoch: 1, Steps: 17 | Train Loss: 1.277 Vali Loss: 0.468 Vali Acc: 0.897 Test Loss: 0.468 Test Acc: 0.897
Validation loss decreased (inf --> -0.897293).  Saving model ...
Epoch: 2 cost time: 4.524911403656006
Epoch: 2, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.897293 --> -0.972972).  Saving model ...
Epoch: 3 cost time: 4.927216529846191
Epoch: 3, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.27953577041626
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.954 Test Loss: 0.100 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.500549554824829
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 6 cost time: 4.840705394744873
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.681593418121338
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.14579439163208
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.102564334869385
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9641976356506348
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.437292814254761
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.988426446914673
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.687530517578125
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.594160795211792
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.575122117996216
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 4.7825822830200195
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.395765542984009
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.945016622543335
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.479516506195068
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.7371368408203125
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.5411810874938965
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 4.824268341064453
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 23 cost time: 4.27923059463501
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 24 cost time: 3.6971445083618164
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7268097400665283
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 4.576212406158447
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 27 cost time: 4.346482753753662
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.488309383392334
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.820145845413208
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.418991565704346
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.324598789215088
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.352682828903198
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.340314626693726
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.087785720825195
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.2715003490448
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.018733263015747
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 7488009
model size : 28.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.19832444190979
Epoch: 1, Steps: 17 | Train Loss: 1.284 Vali Loss: 0.403 Vali Acc: 0.938 Test Loss: 0.403 Test Acc: 0.938
Validation loss decreased (inf --> -0.937834).  Saving model ...
Epoch: 2 cost time: 4.241956472396851
Epoch: 2, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943242).  Saving model ...
Epoch: 3 cost time: 4.184034585952759
Epoch: 3, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.946 Test Loss: 0.121 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945945).  Saving model ...
Epoch: 4 cost time: 4.403855323791504
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.945945 --> -0.978378).  Saving model ...
Epoch: 5 cost time: 4.3500378131866455
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2070958614349365
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.965 Test Loss: 0.082 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3431029319763184
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.128972053527832
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.4777679443359375
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.447557210922241
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.376414775848389
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.471216678619385
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.028985500335693
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.9949474334716797
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 7488265
model size : 28.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.436940908432007
Epoch: 1, Steps: 17 | Train Loss: 1.575 Vali Loss: 0.832 Vali Acc: 0.884 Test Loss: 0.832 Test Acc: 0.884
Validation loss decreased (inf --> -0.883775).  Saving model ...
Epoch: 2 cost time: 3.1921701431274414
Epoch: 2, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.249 Vali Acc: 0.927 Test Loss: 0.249 Test Acc: 0.927
Validation loss decreased (-0.883775 --> -0.927025).  Saving model ...
Epoch: 3 cost time: 2.9228172302246094
Epoch: 3, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.927025 --> -0.956755).  Saving model ...
Epoch: 4 cost time: 3.1942262649536133
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 5 cost time: 2.6298253536224365
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3525807857513428
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.218714475631714
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 8 cost time: 2.610539436340332
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 2.6649436950683594
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.762660503387451
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.955207109451294
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.607576847076416
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5591371059417725
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7660679817199707
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.1164157390594482
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.514373302459717
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1639134883880615
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1340975761413574
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.158144235610962
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.696321964263916
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 7073801
model size : 27.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.490779161453247
Epoch: 1, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.080 Vali Acc: 0.870 Test Loss: 1.080 Test Acc: 0.870
Validation loss decreased (inf --> -0.870259).  Saving model ...
Epoch: 2 cost time: 3.399394989013672
Epoch: 2, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.282 Vali Acc: 0.954 Test Loss: 0.282 Test Acc: 0.954
Validation loss decreased (-0.870259 --> -0.954051).  Saving model ...
Epoch: 3 cost time: 3.037419319152832
Epoch: 3, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959458).  Saving model ...
Epoch: 4 cost time: 3.1551332473754883
Epoch: 4, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 5 cost time: 2.9537339210510254
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 6 cost time: 3.1770365238189697
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 2.7719619274139404
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 3.226691722869873
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9839038848876953
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0659847259521484
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.348633050918579
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.847012758255005
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3280231952667236
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8347389698028564
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5322442054748535
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9179484844207764
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.518336534500122
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 6936073
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1946868896484375
Epoch: 1, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.088 Vali Acc: 0.903 Test Loss: 1.088 Test Acc: 0.903
Validation loss decreased (inf --> -0.902692).  Saving model ...
Epoch: 2 cost time: 2.8273279666900635
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.238 Vali Acc: 0.968 Test Loss: 0.238 Test Acc: 0.968
Validation loss decreased (-0.902692 --> -0.967565).  Saving model ...
Epoch: 3 cost time: 2.53267765045166
Epoch: 3, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.667494058609009
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.967565 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 2.718503952026367
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.0257568359375
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8087046146392822
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 3.071834087371826
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.988668918609619
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5930349826812744
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.865964651107788
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.78261137008667
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6358180046081543
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.937305450439453
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 2.7992827892303467
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.672421455383301
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.680544853210449
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.05945086479187
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9625086784362793
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 20 cost time: 2.5665242671966553
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5644216537475586
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5343003273010254
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5911173820495605
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.834930658340454
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9545812606811523
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.155547618865967
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.2211556434631348
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.0640082359313965
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.6565401554107666
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 6936329
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.751620054244995
Epoch: 1, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.274 Vali Acc: 0.851 Test Loss: 1.274 Test Acc: 0.851
Validation loss decreased (inf --> -0.851339).  Saving model ...
Epoch: 2 cost time: 2.7486464977264404
Epoch: 2, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.329 Vali Acc: 0.954 Test Loss: 0.329 Test Acc: 0.954
Validation loss decreased (-0.851339 --> -0.954051).  Saving model ...
Epoch: 3 cost time: 2.9423015117645264
Epoch: 3, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7923877239227295
Epoch: 4, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.954051 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 2.764721632003784
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.693570375442505
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 2.453479290008545
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4448204040527344
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8870155811309814
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.826096773147583
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.903200626373291
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9968864917755127
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9362685680389404
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6387970447540283
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9889776706695557
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6803531646728516
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0463922023773193
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6869609355926514
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.674095869064331
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 6881545
model size : 26.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9313840866088867
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 0.716 Vali Acc: 0.908 Test Loss: 0.716 Test Acc: 0.908
Validation loss decreased (inf --> -0.908101).  Saving model ...
Epoch: 2 cost time: 2.5916543006896973
Epoch: 2, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.908101 --> -0.956755).  Saving model ...
Epoch: 3 cost time: 2.083282470703125
Epoch: 3, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.956755 --> -0.978377).  Saving model ...
Epoch: 4 cost time: 2.3707292079925537
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.962 Test Loss: 0.086 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2763869762420654
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.54154896736145
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.444779396057129
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.445331335067749
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.368303060531616
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4923582077026367
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3156509399414062
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.430114269256592
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.384652853012085
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2171145
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.60917854309082
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 0.751 Vali Acc: 0.924 Test Loss: 0.751 Test Acc: 0.924
Validation loss decreased (inf --> -0.924317).  Saving model ...
Epoch: 2 cost time: 2.4674179553985596
Epoch: 2, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.924317 --> -0.972971).  Saving model ...
Epoch: 3 cost time: 2.2619078159332275
Epoch: 3, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.263627290725708
Epoch: 4, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3292245864868164
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3977861404418945
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.384911298751831
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.260664463043213
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2725541591644287
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1131229400634766
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1496493816375732
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.4280343055725098
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.365370273590088
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3673155307769775
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2476651668548584
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 2.0837795734405518
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.190899610519409
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4217538833618164
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2885327339172363
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2575087547302246
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.436371088027954
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.344078302383423
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2281126976013184
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3358707427978516
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.482424259185791
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2171273
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.49727725982666
Epoch: 1, Steps: 17 | Train Loss: 1.826 Vali Loss: 1.325 Vali Acc: 0.827 Test Loss: 1.325 Test Acc: 0.827
Validation loss decreased (inf --> -0.827014).  Saving model ...
Epoch: 2 cost time: 2.1789839267730713
Epoch: 2, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
Validation loss decreased (-0.827014 --> -0.929726).  Saving model ...
Epoch: 3 cost time: 2.1140296459198
Epoch: 3, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.929726 --> -0.970269).  Saving model ...
Epoch: 4 cost time: 1.9494860172271729
Epoch: 4, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 2.0495054721832275
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 2.066727638244629
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.059900999069214
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.806408405303955
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 1.9976770877838135
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.9289934635162354
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8755683898925781
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8590946197509766
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.808758020401001
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 1.8154842853546143
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8058655261993408
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.099560022354126
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.922947883605957
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.011035919189453
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0514588356018066
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.034291982650757
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6912884712219238
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7012953758239746
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.579477310180664
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1964041
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8577730655670166
Epoch: 1, Steps: 17 | Train Loss: 1.871 Vali Loss: 1.477 Vali Acc: 0.846 Test Loss: 1.477 Test Acc: 0.846
Validation loss decreased (inf --> -0.845931).  Saving model ...
Epoch: 2 cost time: 2.176086902618408
Epoch: 2, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.520 Vali Acc: 0.919 Test Loss: 0.520 Test Acc: 0.919
Validation loss decreased (-0.845931 --> -0.918914).  Saving model ...
Epoch: 3 cost time: 1.9393084049224854
Epoch: 3, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.232 Vali Acc: 0.957 Test Loss: 0.232 Test Acc: 0.957
Validation loss decreased (-0.918914 --> -0.956754).  Saving model ...
Epoch: 4 cost time: 1.9164714813232422
Epoch: 4, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 5 cost time: 1.6292362213134766
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 1.7196612358093262
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.6661920547485352
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.7502896785736084
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.9393541812896729
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.5368461608886719
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.6156320571899414
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.062568187713623
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0976009368896484
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.9274637699127197
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.9710159301757812
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8888652324676514
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7880661487579346
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6524863243103027
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9212253093719482
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.1858103275299072
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 1.9014198780059814
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8134784698486328
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 1.9079787731170654
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7007083892822266
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6841940879821777
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9189355373382568
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 27 cost time: 1.8531341552734375
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 28 cost time: 1.7137641906738281
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7688446044921875
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8357396125793457
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9260551929473877
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.2793922424316406
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.838197946548462
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 34 cost time: 1.758547306060791
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7285656929016113
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6687848567962646
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9163196086883545
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.7870397567749023
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7049732208251953
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8526761531829834
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8996386528015137
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8659846782684326
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.012256145477295
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1895177
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.112612724304199
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.561 Vali Acc: 0.770 Test Loss: 1.561 Test Acc: 0.770
Validation loss decreased (inf --> -0.770255).  Saving model ...
Epoch: 2 cost time: 1.1146578788757324
Epoch: 2, Steps: 17 | Train Loss: 0.779 Vali Loss: 0.550 Vali Acc: 0.935 Test Loss: 0.550 Test Acc: 0.935
Validation loss decreased (-0.770255 --> -0.935130).  Saving model ...
Epoch: 3 cost time: 1.9413692951202393
Epoch: 3, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.229 Vali Acc: 0.959 Test Loss: 0.229 Test Acc: 0.959
Validation loss decreased (-0.935130 --> -0.959457).  Saving model ...
Epoch: 4 cost time: 1.9959232807159424
Epoch: 4, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
Validation loss decreased (-0.959457 --> -0.975674).  Saving model ...
Epoch: 5 cost time: 1.7629618644714355
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 1.5571796894073486
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7250192165374756
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.7692182064056396
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.0608479976654053
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.6949489116668701
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.5459802150726318
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 1.456449270248413
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 1.5167739391326904
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 1.6685309410095215
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9066853523254395
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 1.8296992778778076
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0303122997283936
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8880255222320557
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6613397598266602
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6159486770629883
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7328991889953613
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8158066272735596
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7559857368469238
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6950349807739258
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 1.7376973628997803
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 1.7579936981201172
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8491714000701904
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8646867275238037
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1769516468048096
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8479933738708496
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9224216938018799
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0550811290740967
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8978393077850342
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0396311283111572
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.008915424346924
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1895305
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9751179218292236
Epoch: 1, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.617 Vali Acc: 0.730 Test Loss: 1.617 Test Acc: 0.730
Validation loss decreased (inf --> -0.729714).  Saving model ...
Epoch: 2 cost time: 1.8411083221435547
Epoch: 2, Steps: 17 | Train Loss: 0.879 Vali Loss: 0.674 Vali Acc: 0.914 Test Loss: 0.674 Test Acc: 0.914
Validation loss decreased (-0.729714 --> -0.913507).  Saving model ...
Epoch: 3 cost time: 1.7930865287780762
Epoch: 3, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.306 Vali Acc: 0.951 Test Loss: 0.306 Test Acc: 0.951
Validation loss decreased (-0.913507 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 1.883819818496704
Epoch: 4, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 2.0522804260253906
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
Validation loss decreased (-0.959458 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 2.07989501953125
Epoch: 6, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 1.9801692962646484
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 8 cost time: 1.963667392730713
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.088609457015991
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1829655170440674
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.109225273132324
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.194598913192749
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.023832082748413
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0509111881256104
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0357885360717773
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.865164041519165
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7811057567596436
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1867913
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.660642623901367
Epoch: 1, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.158 Vali Acc: 0.876 Test Loss: 1.158 Test Acc: 0.876
Validation loss decreased (inf --> -0.875664).  Saving model ...
Epoch: 2 cost time: 2.055213212966919
Epoch: 2, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.314 Vali Acc: 0.962 Test Loss: 0.314 Test Acc: 0.962
Validation loss decreased (-0.875664 --> -0.962159).  Saving model ...
Epoch: 3 cost time: 1.807802677154541
Epoch: 3, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.962159 --> -0.967566).  Saving model ...
Epoch: 4 cost time: 1.9083280563354492
Epoch: 4, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 1.8150947093963623
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 1.783475637435913
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.261307716369629
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8845558166503906
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9142143726348877
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9422626495361328
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8899781703948975
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9957823753356934
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.974520206451416
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6164929866790771
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.6232683658599854
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 1.9522464275360107
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8002328872680664
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.844599723815918
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9633123874664307
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8954811096191406
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 21 cost time: 1.7967300415039062
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 22 cost time: 1.7553694248199463
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.835303544998169
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 24 cost time: 1.971557378768921
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0575027465820312
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9409263134002686
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0819385051727295
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1796395778656006
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9629075527191162
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.0096044540405273
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8594939708709717
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.968106746673584
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7567689418792725
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 692361
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9957785606384277
Epoch: 1, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.205 Vali Acc: 0.876 Test Loss: 1.205 Test Acc: 0.876
Validation loss decreased (inf --> -0.875664).  Saving model ...
Epoch: 2 cost time: 2.0528883934020996
Epoch: 2, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.328 Vali Acc: 0.949 Test Loss: 0.328 Test Acc: 0.949
Validation loss decreased (-0.875664 --> -0.948645).  Saving model ...
Epoch: 3 cost time: 2.1104331016540527
Epoch: 3, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954052).  Saving model ...
Epoch: 4 cost time: 2.02358341217041
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.954052 --> -0.978377).  Saving model ...
Epoch: 5 cost time: 1.9777626991271973
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.00124192237854
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8286700248718262
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9939587116241455
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8289940357208252
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.083977222442627
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.035256862640381
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9802625179290771
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1025497913360596
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.066175937652588
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 692425
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.504762887954712
Epoch: 1, Steps: 17 | Train Loss: 2.093 Vali Loss: 1.747 Vali Acc: 0.697 Test Loss: 1.747 Test Acc: 0.697
Validation loss decreased (inf --> -0.697280).  Saving model ...
Epoch: 2 cost time: 1.6201586723327637
Epoch: 2, Steps: 17 | Train Loss: 1.008 Vali Loss: 0.749 Vali Acc: 0.911 Test Loss: 0.749 Test Acc: 0.911
Validation loss decreased (-0.697280 --> -0.910803).  Saving model ...
Epoch: 3 cost time: 1.5748751163482666
Epoch: 3, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.323 Vali Acc: 0.941 Test Loss: 0.323 Test Acc: 0.941
Validation loss decreased (-0.910803 --> -0.940537).  Saving model ...
Epoch: 4 cost time: 1.5309052467346191
Epoch: 4, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.940537 --> -0.959457).  Saving model ...
Epoch: 5 cost time: 1.4968295097351074
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 1.554600477218628
Epoch: 6, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 1.4466018676757812
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 1.5393764972686768
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.795060157775879
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.5713870525360107
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.618070363998413
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 1.5392091274261475
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5078604221343994
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.4811694622039795
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5907115936279297
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6533482074737549
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5742108821868896
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.805445909500122
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.720625638961792
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.616715669631958
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6428630352020264
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.552995204925537
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3701651096343994
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 588809
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.607056140899658
Epoch: 1, Steps: 17 | Train Loss: 2.061 Vali Loss: 1.825 Vali Acc: 0.635 Test Loss: 1.825 Test Acc: 0.635
Validation loss decreased (inf --> -0.635117).  Saving model ...
Epoch: 2 cost time: 1.7539544105529785
Epoch: 2, Steps: 17 | Train Loss: 1.241 Vali Loss: 0.989 Vali Acc: 0.903 Test Loss: 0.989 Test Acc: 0.903
Validation loss decreased (-0.635117 --> -0.902693).  Saving model ...
Epoch: 3 cost time: 1.8089048862457275
Epoch: 3, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.475 Vali Acc: 0.946 Test Loss: 0.475 Test Acc: 0.946
Validation loss decreased (-0.902693 --> -0.945941).  Saving model ...
Epoch: 4 cost time: 1.6274340152740479
Epoch: 4, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.277 Vali Acc: 0.968 Test Loss: 0.277 Test Acc: 0.968
Validation loss decreased (-0.945941 --> -0.967565).  Saving model ...
Epoch: 5 cost time: 1.529297113418579
Epoch: 5, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7165374755859375
Epoch: 6, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.5599312782287598
Epoch: 7, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.4727702140808105
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6929371356964111
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.5882694721221924
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.6817128658294678
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7172415256500244
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8405423164367676
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 1.6988756656646729
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6721932888031006
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 16 cost time: 1.814530849456787
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7830586433410645
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.763124942779541
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6698644161224365
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4519734382629395
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5874927043914795
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4715487957000732
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4949278831481934
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6884894371032715
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8095457553863525
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 554377
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3293185234069824
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.754 Vali Acc: 0.697 Test Loss: 1.754 Test Acc: 0.697
Validation loss decreased (inf --> -0.697280).  Saving model ...
Epoch: 2 cost time: 1.6055283546447754
Epoch: 2, Steps: 17 | Train Loss: 1.166 Vali Loss: 0.931 Vali Acc: 0.897 Test Loss: 0.931 Test Acc: 0.897
Validation loss decreased (-0.697280 --> -0.897288).  Saving model ...
Epoch: 3 cost time: 1.606980323791504
Epoch: 3, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.452 Vali Acc: 0.957 Test Loss: 0.452 Test Acc: 0.957
Validation loss decreased (-0.897288 --> -0.956752).  Saving model ...
Epoch: 4 cost time: 1.4034829139709473
Epoch: 4, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.288 Vali Acc: 0.951 Test Loss: 0.288 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5487148761749268
Epoch: 5, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
Validation loss decreased (-0.956752 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 1.3587653636932373
Epoch: 6, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8162989616394043
Epoch: 7, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 1.6317479610443115
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4680652618408203
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.645897388458252
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5666134357452393
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5828678607940674
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6056876182556152
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5863451957702637
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4694478511810303
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.662053108215332
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8122155666351318
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.5702333450317383
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.647270679473877
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.62953782081604
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5851070880889893
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6856496334075928
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.753227949142456
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5512499809265137
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6137397289276123
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6314928531646729
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.584446907043457
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 554441
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2474069595336914
Epoch: 1, Steps: 17 | Train Loss: 2.051 Vali Loss: 1.834 Vali Acc: 0.581 Test Loss: 1.834 Test Acc: 0.581
Validation loss decreased (inf --> -0.581063).  Saving model ...
Epoch: 2 cost time: 1.6340968608856201
Epoch: 2, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.114 Vali Acc: 0.870 Test Loss: 1.114 Test Acc: 0.870
Validation loss decreased (-0.581063 --> -0.870259).  Saving model ...
Epoch: 3 cost time: 1.5147604942321777
Epoch: 3, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.627 Vali Acc: 0.908 Test Loss: 0.627 Test Acc: 0.908
Validation loss decreased (-0.870259 --> -0.908102).  Saving model ...
Epoch: 4 cost time: 1.4549448490142822
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.362 Vali Acc: 0.951 Test Loss: 0.362 Test Acc: 0.951
Validation loss decreased (-0.908102 --> -0.951348).  Saving model ...
Epoch: 5 cost time: 1.5844993591308594
Epoch: 5, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.269 Vali Acc: 0.946 Test Loss: 0.269 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5409157276153564
Epoch: 6, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
Validation loss decreased (-0.951348 --> -0.972971).  Saving model ...
Epoch: 7 cost time: 1.594115972518921
Epoch: 7, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.538921594619751
Epoch: 8, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
Validation loss decreased (-0.972971 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 1.6361687183380127
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 1.4448130130767822
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5103752613067627
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 1.425995111465454
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.368072509765625
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4180119037628174
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 15 cost time: 1.6114721298217773
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6922874450683594
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5747051239013672
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.592606544494629
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5510027408599854
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5567231178283691
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 21 cost time: 1.5466904640197754
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7541017532348633
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.52946138381958
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7211780548095703
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6723926067352295
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8132374286651611
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.558030128479004
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6894333362579346
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4799602031707764
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6385126113891602
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 540745
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.634458065032959
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.607 Vali Acc: 0.795 Test Loss: 1.607 Test Acc: 0.795
Validation loss decreased (inf --> -0.794579).  Saving model ...
Epoch: 2 cost time: 2.1150434017181396
Epoch: 2, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.614 Vali Acc: 0.938 Test Loss: 0.614 Test Acc: 0.938
Validation loss decreased (-0.794579 --> -0.937832).  Saving model ...
Epoch: 3 cost time: 1.7923109531402588
Epoch: 3, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.275 Vali Acc: 0.954 Test Loss: 0.275 Test Acc: 0.954
Validation loss decreased (-0.937832 --> -0.954051).  Saving model ...
Epoch: 4 cost time: 1.9660768508911133
Epoch: 4, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.954051 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 1.7763614654541016
Epoch: 5, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9714035987854004
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 1.6157503128051758
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 1.6743173599243164
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7532861232757568
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5427563190460205
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.972959041595459
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.728189468383789
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.854412317276001
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.4372167587280273
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.882650375366211
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6133766174316406
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6464176177978516
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 1.523982048034668
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.6323022842407227
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.968 Test Loss: 0.077 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8043148517608643
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7379567623138428
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9819729328155518
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7135319709777832
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.970 Test Loss: 0.074 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0152292251586914
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.970 Test Loss: 0.074 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8477416038513184
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9224696159362793
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6111555099487305
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 1.908376693725586
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5867302417755127
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.802443027496338
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.970 Test Loss: 0.074 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.844810962677002
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7014098167419434
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8351435661315918
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.6343247890472412
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8875489234924316
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6973669528961182
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.8862969875335693
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5492897033691406
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.8685104846954346
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.9058749675750732
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8698194026947021
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.0566864013671875
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.970 Test Loss: 0.074 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.6977410316467285
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 247881
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7383837699890137
Epoch: 1, Steps: 17 | Train Loss: 2.021 Vali Loss: 1.680 Vali Acc: 0.684 Test Loss: 1.680 Test Acc: 0.684
Validation loss decreased (inf --> -0.683767).  Saving model ...
Epoch: 2 cost time: 1.6049363613128662
Epoch: 2, Steps: 17 | Train Loss: 0.932 Vali Loss: 0.679 Vali Acc: 0.924 Test Loss: 0.679 Test Acc: 0.924
Validation loss decreased (-0.683767 --> -0.924318).  Saving model ...
Epoch: 3 cost time: 1.8195202350616455
Epoch: 3, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.308 Vali Acc: 0.951 Test Loss: 0.308 Test Acc: 0.951
Validation loss decreased (-0.924318 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 1.7697694301605225
Epoch: 4, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 5 cost time: 1.931349515914917
Epoch: 5, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 1.6831495761871338
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.8815650939941406
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 1.6180286407470703
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 1.5489513874053955
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.5511479377746582
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.575495958328247
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.500504970550537
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3422627449035645
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.795163631439209
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.7292907238006592
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.666029930114746
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6267027854919434
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8973500728607178
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8999605178833008
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5051093101501465
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.69551420211792
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2935476303100586
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7402782440185547
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9134809970855713
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 1.910613775253296
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7119691371917725
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.782999038696289
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.781627893447876
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3472139835357666
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5056867599487305
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5553791522979736
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2924559116363525
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.5542676448822021
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7504456043243408
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 247913
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0169217586517334
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 1.990 Vali Acc: 0.389 Test Loss: 1.990 Test Acc: 0.389
Validation loss decreased (inf --> -0.389169).  Saving model ...
Epoch: 2 cost time: 1.3209588527679443
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.285 Vali Acc: 0.797 Test Loss: 1.285 Test Acc: 0.797
Validation loss decreased (-0.389169 --> -0.797284).  Saving model ...
Epoch: 3 cost time: 1.2246792316436768
Epoch: 3, Steps: 17 | Train Loss: 0.851 Vali Loss: 0.694 Vali Acc: 0.900 Test Loss: 0.694 Test Acc: 0.900
Validation loss decreased (-0.797284 --> -0.899993).  Saving model ...
Epoch: 4 cost time: 1.2977604866027832
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.424 Vali Acc: 0.935 Test Loss: 0.424 Test Acc: 0.935
Validation loss decreased (-0.899993 --> -0.935131).  Saving model ...
Epoch: 5 cost time: 1.5330054759979248
Epoch: 5, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.292 Vali Acc: 0.954 Test Loss: 0.292 Test Acc: 0.954
Validation loss decreased (-0.935131 --> -0.954051).  Saving model ...
Epoch: 6 cost time: 1.4353737831115723
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
Validation loss decreased (-0.954051 --> -0.970268).  Saving model ...
Epoch: 7 cost time: 1.4512484073638916
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4777750968933105
Epoch: 8, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.541250228881836
Epoch: 9, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.4865965843200684
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.2969310283660889
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.47147798538208
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.570791482925415
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.6481883525848389
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.3670260906219482
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.515608310699463
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5065882205963135
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5802924633026123
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4439058303833008
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4555189609527588
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3725371360778809
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5698468685150146
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3004426956176758
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.959 Test Loss: 0.099 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3679382801055908
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 196105
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.914477586746216
Epoch: 1, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.041 Vali Acc: 0.292 Test Loss: 2.041 Test Acc: 0.292
Validation loss decreased (inf --> -0.291871).  Saving model ...
Epoch: 2 cost time: 1.5667972564697266
Epoch: 2, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.453 Vali Acc: 0.762 Test Loss: 1.453 Test Acc: 0.762
Validation loss decreased (-0.291871 --> -0.762148).  Saving model ...
Epoch: 3 cost time: 1.4994606971740723
Epoch: 3, Steps: 17 | Train Loss: 1.078 Vali Loss: 0.948 Vali Acc: 0.854 Test Loss: 0.948 Test Acc: 0.854
Validation loss decreased (-0.762148 --> -0.854045).  Saving model ...
Epoch: 4 cost time: 1.6616990566253662
Epoch: 4, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.616 Vali Acc: 0.908 Test Loss: 0.616 Test Acc: 0.908
Validation loss decreased (-0.854045 --> -0.908102).  Saving model ...
Epoch: 5 cost time: 1.7145435810089111
Epoch: 5, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.407 Vali Acc: 0.946 Test Loss: 0.407 Test Acc: 0.946
Validation loss decreased (-0.908102 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 1.4439899921417236
Epoch: 6, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.306 Vali Acc: 0.962 Test Loss: 0.306 Test Acc: 0.962
Validation loss decreased (-0.945942 --> -0.962159).  Saving model ...
Epoch: 7 cost time: 1.3587620258331299
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.253 Vali Acc: 0.968 Test Loss: 0.253 Test Acc: 0.968
Validation loss decreased (-0.962159 --> -0.967565).  Saving model ...
Epoch: 8 cost time: 1.3006792068481445
Epoch: 8, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.210 Vali Acc: 0.973 Test Loss: 0.210 Test Acc: 0.973
Validation loss decreased (-0.967565 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 1.3168981075286865
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975674).  Saving model ...
Epoch: 10 cost time: 1.2471508979797363
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.1142570972442627
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4025073051452637
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3755040168762207
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5925006866455078
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.628042459487915
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4151294231414795
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3978800773620605
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.486647605895996
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5711708068847656
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 20 cost time: 1.3338499069213867
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 21 cost time: 1.4051311016082764
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5343835353851318
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5540716648101807
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6992855072021484
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6722979545593262
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.448577642440796
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.389183759689331
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 28 cost time: 1.5632390975952148
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6801819801330566
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6349155902862549
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5582265853881836
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5941722393035889
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.631077527999878
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.538111686706543
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.612614393234253
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.6113612651824951
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7010691165924072
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 178889
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.794888973236084
Epoch: 1, Steps: 17 | Train Loss: 2.225 Vali Loss: 2.048 Vali Acc: 0.289 Test Loss: 2.048 Test Acc: 0.289
Validation loss decreased (inf --> -0.289169).  Saving model ...
Epoch: 2 cost time: 1.2510535717010498
Epoch: 2, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.453 Vali Acc: 0.827 Test Loss: 1.453 Test Acc: 0.827
Validation loss decreased (-0.289169 --> -0.827012).  Saving model ...
Epoch: 3 cost time: 1.471357822418213
Epoch: 3, Steps: 17 | Train Loss: 1.065 Vali Loss: 0.900 Vali Acc: 0.922 Test Loss: 0.900 Test Acc: 0.922
Validation loss decreased (-0.827012 --> -0.921613).  Saving model ...
Epoch: 4 cost time: 1.5878164768218994
Epoch: 4, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.551 Vali Acc: 0.935 Test Loss: 0.551 Test Acc: 0.935
Validation loss decreased (-0.921613 --> -0.935130).  Saving model ...
Epoch: 5 cost time: 1.7124199867248535
Epoch: 5, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.383 Vali Acc: 0.957 Test Loss: 0.383 Test Acc: 0.957
Validation loss decreased (-0.935130 --> -0.956753).  Saving model ...
Epoch: 6 cost time: 1.6434311866760254
Epoch: 6, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.279 Vali Acc: 0.968 Test Loss: 0.279 Test Acc: 0.968
Validation loss decreased (-0.956753 --> -0.967565).  Saving model ...
Epoch: 7 cost time: 1.3170397281646729
Epoch: 7, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.232 Vali Acc: 0.957 Test Loss: 0.232 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7437500953674316
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.203 Vali Acc: 0.965 Test Loss: 0.203 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4826600551605225
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5054543018341064
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 1.447072982788086
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.4589135646820068
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975674).  Saving model ...
Epoch: 13 cost time: 1.362443447113037
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5626659393310547
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.53086256980896
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 1.7272040843963623
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.4630649089813232
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7074296474456787
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 1.6601107120513916
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 1.754605770111084
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2827327251434326
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3576436042785645
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5730969905853271
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 1.417116641998291
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4973797798156738
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.502241611480713
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6997933387756348
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.746476650238037
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7214820384979248
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.968 Test Loss: 0.081 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6217267513275146
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 1.5986511707305908
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.512207269668579
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3280093669891357
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3960216045379639
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.424316167831421
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4516849517822266
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4836070537567139
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.6246187686920166
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6384198665618896
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.4707424640655518
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 178921
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.949615716934204
Epoch: 1, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.016 Vali Acc: 0.357 Test Loss: 2.016 Test Acc: 0.357
Validation loss decreased (inf --> -0.356737).  Saving model ...
Epoch: 2 cost time: 1.295053482055664
Epoch: 2, Steps: 17 | Train Loss: 1.708 Vali Loss: 1.573 Vali Acc: 0.757 Test Loss: 1.573 Test Acc: 0.757
Validation loss decreased (-0.356737 --> -0.756741).  Saving model ...
Epoch: 3 cost time: 1.4176030158996582
Epoch: 3, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.121 Vali Acc: 0.870 Test Loss: 1.121 Test Acc: 0.870
Validation loss decreased (-0.756741 --> -0.870259).  Saving model ...
Epoch: 4 cost time: 1.2245500087738037
Epoch: 4, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.768 Vali Acc: 0.908 Test Loss: 0.768 Test Acc: 0.908
Validation loss decreased (-0.870259 --> -0.908100).  Saving model ...
Epoch: 5 cost time: 1.312938928604126
Epoch: 5, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.540 Vali Acc: 0.935 Test Loss: 0.540 Test Acc: 0.935
Validation loss decreased (-0.908100 --> -0.935130).  Saving model ...
Epoch: 6 cost time: 1.1135108470916748
Epoch: 6, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.400 Vali Acc: 0.946 Test Loss: 0.400 Test Acc: 0.946
Validation loss decreased (-0.935130 --> -0.945942).  Saving model ...
Epoch: 7 cost time: 1.5269927978515625
Epoch: 7, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.316 Vali Acc: 0.959 Test Loss: 0.316 Test Acc: 0.959
Validation loss decreased (-0.945942 --> -0.959456).  Saving model ...
Epoch: 8 cost time: 1.5713856220245361
Epoch: 8, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
Validation loss decreased (-0.959456 --> -0.970268).  Saving model ...
Epoch: 9 cost time: 1.5881142616271973
Epoch: 9, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5315070152282715
Epoch: 10, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970268).  Saving model ...
Epoch: 11 cost time: 1.4944682121276855
Epoch: 11, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975674).  Saving model ...
Epoch: 12 cost time: 1.0816984176635742
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 13 cost time: 1.3421428203582764
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.3091790676116943
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4447615146636963
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 1.4048993587493896
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4788563251495361
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4262545108795166
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4307358264923096
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6606552600860596
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.395223617553711
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.466306209564209
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4521396160125732
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 24 cost time: 1.4332613945007324
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.439540147781372
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.483062744140625
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 27 cost time: 1.4264130592346191
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 28 cost time: 1.4117107391357422
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.469749927520752
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3373382091522217
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 31 cost time: 1.497471809387207
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2482612133026123
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2862951755523682
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2179086208343506
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.281264066696167
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.563241720199585
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.269092321395874
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.973 Test Loss: 0.067 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4442651271820068
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3286826610565186
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6172239780426025
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 172073
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.054337739944458
Epoch: 1, Steps: 17 | Train Loss: 2.009 Vali Loss: 1.941 Vali Acc: 0.805 Test Loss: 1.941 Test Acc: 0.805
Validation loss decreased (inf --> -0.805386).  Saving model ...
Epoch: 2 cost time: 2.4548208713531494
Epoch: 2, Steps: 17 | Train Loss: 1.252 Vali Loss: 0.978 Vali Acc: 0.932 Test Loss: 0.978 Test Acc: 0.932
Validation loss decreased (-0.805386 --> -0.932423).  Saving model ...
Epoch: 3 cost time: 2.924386978149414
Epoch: 3, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.294 Vali Acc: 0.951 Test Loss: 0.294 Test Acc: 0.951
Validation loss decreased (-0.932423 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 2.6294102668762207
Epoch: 4, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 2.569988965988159
Epoch: 5, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.959458 --> -0.978377).  Saving model ...
Epoch: 6 cost time: 2.719329833984375
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4554996490478516
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2838551998138428
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 2.3053598403930664
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.810028314590454
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.515347480773926
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6646382808685303
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8575503826141357
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6189615726470947
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.617999792098999
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.503988742828369
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.642735481262207
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6442935466766357
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1368521
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.484337091445923
Epoch: 1, Steps: 17 | Train Loss: 2.134 Vali Loss: 2.031 Vali Acc: 0.603 Test Loss: 2.031 Test Acc: 0.603
Validation loss decreased (inf --> -0.602682).  Saving model ...
Epoch: 2 cost time: 2.4984381198883057
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.140 Vali Acc: 0.878 Test Loss: 1.140 Test Acc: 0.878
Validation loss decreased (-0.602682 --> -0.878367).  Saving model ...
Epoch: 3 cost time: 2.8343818187713623
Epoch: 3, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.878367 --> -0.940537).  Saving model ...
Epoch: 4 cost time: 2.9509034156799316
Epoch: 4, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948647).  Saving model ...
Epoch: 5 cost time: 2.9040772914886475
Epoch: 5, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.948647 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 2.535240650177002
Epoch: 6, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.4459872245788574
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 2.6523728370666504
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.781644821166992
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 2.9902474880218506
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 2.558028221130371
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4751834869384766
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4060797691345215
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.630877733230591
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.817643880844116
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6101715564727783
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4918384552001953
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6665611267089844
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.510256767272949
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.718022584915161
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1368553
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.526685476303101
Epoch: 1, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.090 Vali Acc: 0.351 Test Loss: 2.090 Test Acc: 0.351
Validation loss decreased (inf --> -0.351330).  Saving model ...
Epoch: 2 cost time: 2.690694570541382
Epoch: 2, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.626 Vali Acc: 0.846 Test Loss: 1.626 Test Acc: 0.846
Validation loss decreased (-0.351330 --> -0.845930).  Saving model ...
Epoch: 3 cost time: 2.851125478744507
Epoch: 3, Steps: 17 | Train Loss: 1.169 Vali Loss: 0.886 Vali Acc: 0.908 Test Loss: 0.886 Test Acc: 0.908
Validation loss decreased (-0.845930 --> -0.908099).  Saving model ...
Epoch: 4 cost time: 2.1942858695983887
Epoch: 4, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.406 Vali Acc: 0.943 Test Loss: 0.406 Test Acc: 0.943
Validation loss decreased (-0.908099 --> -0.943239).  Saving model ...
Epoch: 5 cost time: 2.397090435028076
Epoch: 5, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
Validation loss decreased (-0.943239 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 2.401573657989502
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.4927971363067627
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 2.512908935546875
Epoch: 8, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 2.4688456058502197
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.726879596710205
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 2.569547176361084
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.795886754989624
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.263599157333374
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.429675579071045
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.982370138168335
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.122224807739258
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4557371139526367
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.667973518371582
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5946176052093506
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3986599445343018
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1313289
model size : 5.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.803330659866333
Epoch: 1, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.077 Vali Acc: 0.538 Test Loss: 2.077 Test Acc: 0.538
Validation loss decreased (inf --> -0.537817).  Saving model ...
Epoch: 2 cost time: 2.5583364963531494
Epoch: 2, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.653 Vali Acc: 0.830 Test Loss: 1.653 Test Acc: 0.830
Validation loss decreased (-0.537817 --> -0.829713).  Saving model ...
Epoch: 3 cost time: 2.2996716499328613
Epoch: 3, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.040 Vali Acc: 0.911 Test Loss: 1.040 Test Acc: 0.911
Validation loss decreased (-0.829713 --> -0.910800).  Saving model ...
Epoch: 4 cost time: 2.4987716674804688
Epoch: 4, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.515 Vali Acc: 0.938 Test Loss: 0.515 Test Acc: 0.938
Validation loss decreased (-0.910800 --> -0.937833).  Saving model ...
Epoch: 5 cost time: 2.4284021854400635
Epoch: 5, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.281 Vali Acc: 0.959 Test Loss: 0.281 Test Acc: 0.959
Validation loss decreased (-0.937833 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 2.573401927947998
Epoch: 6, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
Validation loss decreased (-0.959457 --> -0.972971).  Saving model ...
Epoch: 7 cost time: 2.3259005546569824
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.314134120941162
Epoch: 8, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.369098424911499
Epoch: 9, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.355883836746216
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.462902784347534
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.239325761795044
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.965780735015869
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.639721155166626
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 2.6625454425811768
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7002222537994385
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.542085886001587
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.559950351715088
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6019694805145264
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.67879056930542
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.649458646774292
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7766544818878174
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1250531673431396
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4428186416625977
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1299529
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.025418996810913
Epoch: 1, Steps: 17 | Train Loss: 2.190 Vali Loss: 2.126 Vali Acc: 0.357 Test Loss: 2.126 Test Acc: 0.357
Validation loss decreased (inf --> -0.356735).  Saving model ...
Epoch: 2 cost time: 2.6547389030456543
Epoch: 2, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.708 Vali Acc: 0.795 Test Loss: 1.708 Test Acc: 0.795
Validation loss decreased (-0.356735 --> -0.794578).  Saving model ...
Epoch: 3 cost time: 2.657034158706665
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.071 Vali Acc: 0.878 Test Loss: 1.071 Test Acc: 0.878
Validation loss decreased (-0.794578 --> -0.878368).  Saving model ...
Epoch: 4 cost time: 2.364386796951294
Epoch: 4, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.554 Vali Acc: 0.930 Test Loss: 0.554 Test Acc: 0.930
Validation loss decreased (-0.878368 --> -0.929724).  Saving model ...
Epoch: 5 cost time: 2.3513388633728027
Epoch: 5, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.305 Vali Acc: 0.957 Test Loss: 0.305 Test Acc: 0.957
Validation loss decreased (-0.929724 --> -0.956754).  Saving model ...
Epoch: 6 cost time: 2.4062769412994385
Epoch: 6, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.202 Vali Acc: 0.965 Test Loss: 0.202 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 2.2660586833953857
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 2.152992010116577
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.464460611343384
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6395456790924072
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.564202308654785
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.723602056503296
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.558002233505249
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.525266647338867
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3774948120117188
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.412733793258667
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1660573482513428
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1299561
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.027938365936279
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.098 Vali Acc: 0.341 Test Loss: 2.098 Test Acc: 0.341
Validation loss decreased (inf --> -0.340520).  Saving model ...
Epoch: 2 cost time: 2.6055283546447754
Epoch: 2, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.756 Vali Acc: 0.759 Test Loss: 1.756 Test Acc: 0.759
Validation loss decreased (-0.340520 --> -0.759442).  Saving model ...
Epoch: 3 cost time: 2.584185838699341
Epoch: 3, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.226 Vali Acc: 0.865 Test Loss: 1.226 Test Acc: 0.865
Validation loss decreased (-0.759442 --> -0.864853).  Saving model ...
Epoch: 4 cost time: 2.6335103511810303
Epoch: 4, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.709 Vali Acc: 0.916 Test Loss: 0.709 Test Acc: 0.916
Validation loss decreased (-0.864853 --> -0.916209).  Saving model ...
Epoch: 5 cost time: 2.614461660385132
Epoch: 5, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.406 Vali Acc: 0.943 Test Loss: 0.406 Test Acc: 0.943
Validation loss decreased (-0.916209 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 2.4305779933929443
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.261 Vali Acc: 0.954 Test Loss: 0.261 Test Acc: 0.954
Validation loss decreased (-0.943239 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 2.3884639739990234
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
Validation loss decreased (-0.954051 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 2.373828887939453
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.3156063556671143
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.383014678955078
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.585081100463867
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.692807197570801
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5050058364868164
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5250539779663086
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.5204436779022217
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3424808979034424
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.307199716567993
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.212963342666626
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.358656406402588
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.965 Test Loss: 0.081 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5149171352386475
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.41691255569458
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2963976860046387
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 2.3764569759368896
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.968 Test Loss: 0.081 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3701677322387695
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.2299866676330566
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.5631253719329834
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7156050205230713
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.663238286972046
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.968 Test Loss: 0.079 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6205222606658936
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.968 Test Loss: 0.078 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3289716243743896
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.968 Test Loss: 0.079 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.3739373683929443
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3592076301574707
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.46311092376709
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.388637065887451
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.488765001296997
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1285801
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.194728851318359
Epoch: 1, Steps: 17 | Train Loss: 2.077 Vali Loss: 1.945 Vali Acc: 0.730 Test Loss: 1.945 Test Acc: 0.730
Validation loss decreased (inf --> -0.729710).  Saving model ...
Epoch: 2 cost time: 2.4212276935577393
Epoch: 2, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.034 Vali Acc: 0.914 Test Loss: 1.034 Test Acc: 0.914
Validation loss decreased (-0.729710 --> -0.913503).  Saving model ...
Epoch: 3 cost time: 2.438624382019043
Epoch: 3, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.913503 --> -0.940537).  Saving model ...
Epoch: 4 cost time: 2.665780782699585
Epoch: 4, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.940537 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 2.5468194484710693
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.435835361480713
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.970269 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 2.5526578426361084
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 8 cost time: 2.6500561237335205
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.415057897567749
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.411513090133667
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7067043781280518
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4139583110809326
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8621442317962646
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.56988263130188
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.416351079940796
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.403536558151245
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5676333904266357
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 1357769
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.458859443664551
Epoch: 1, Steps: 17 | Train Loss: 2.089 Vali Loss: 1.977 Vali Acc: 0.711 Test Loss: 1.977 Test Acc: 0.711
Validation loss decreased (inf --> -0.710791).  Saving model ...
Epoch: 2 cost time: 2.7914042472839355
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.113 Vali Acc: 0.889 Test Loss: 1.113 Test Acc: 0.889
Validation loss decreased (-0.710791 --> -0.889178).  Saving model ...
Epoch: 3 cost time: 2.7885124683380127
Epoch: 3, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.381 Vali Acc: 0.924 Test Loss: 0.381 Test Acc: 0.924
Validation loss decreased (-0.889178 --> -0.924321).  Saving model ...
Epoch: 4 cost time: 2.606351852416992
Epoch: 4, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
Validation loss decreased (-0.924321 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 2.4891464710235596
Epoch: 5, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.959458 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 2.415165901184082
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7575490474700928
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8754706382751465
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.6985464096069336
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.790839195251465
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.618007183074951
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.435131549835205
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.870971202850342
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.745849370956421
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 2.8644728660583496
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 2.984757900238037
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.635430335998535
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4311318397521973
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 2.5427889823913574
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.651308298110962
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.702800750732422
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7859833240509033
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8187882900238037
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8073763847351074
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5410492420196533
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.399721384048462
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.4886274337768555
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7173779010772705
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1357801
model size : 5.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.737950563430786
Epoch: 1, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.095 Vali Acc: 0.465 Test Loss: 2.095 Test Acc: 0.465
Validation loss decreased (inf --> -0.464844).  Saving model ...
Epoch: 2 cost time: 2.12969708442688
Epoch: 2, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.640 Vali Acc: 0.843 Test Loss: 1.640 Test Acc: 0.843
Validation loss decreased (-0.464844 --> -0.843227).  Saving model ...
Epoch: 3 cost time: 2.386012554168701
Epoch: 3, Steps: 17 | Train Loss: 1.172 Vali Loss: 0.921 Vali Acc: 0.903 Test Loss: 0.921 Test Acc: 0.903
Validation loss decreased (-0.843227 --> -0.902693).  Saving model ...
Epoch: 4 cost time: 2.3779091835021973
Epoch: 4, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.424 Vali Acc: 0.941 Test Loss: 0.424 Test Acc: 0.941
Validation loss decreased (-0.902693 --> -0.940536).  Saving model ...
Epoch: 5 cost time: 2.609041452407837
Epoch: 5, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.231 Vali Acc: 0.957 Test Loss: 0.231 Test Acc: 0.957
Validation loss decreased (-0.940536 --> -0.956754).  Saving model ...
Epoch: 6 cost time: 2.090576171875
Epoch: 6, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
Validation loss decreased (-0.956754 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.4330990314483643
Epoch: 7, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 2.549726724624634
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.967566 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 2.296468496322632
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 2.3995132446289062
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.47942852973938
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 2.4924468994140625
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.584245204925537
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.349350929260254
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 2.426917791366577
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 2.6887927055358887
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.387789726257324
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 2.2993295192718506
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 19 cost time: 2.2717316150665283
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 20 cost time: 2.4176034927368164
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 21 cost time: 2.633390426635742
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.481752634048462
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5746710300445557
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6692562103271484
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 25 cost time: 2.3811845779418945
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3178625106811523
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3297884464263916
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 28 cost time: 2.409905433654785
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3107190132141113
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2967612743377686
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.168701171875
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.150439977645874
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.481102705001831
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.577559471130371
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.5266284942626953
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.5368659496307373
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.2606146335601807
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 1302537
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8846991062164307
Epoch: 1, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.052 Vali Acc: 0.486 Test Loss: 2.052 Test Acc: 0.486
Validation loss decreased (inf --> -0.486466).  Saving model ...
Epoch: 2 cost time: 2.480088472366333
Epoch: 2, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.594 Vali Acc: 0.827 Test Loss: 1.594 Test Acc: 0.827
Validation loss decreased (-0.486466 --> -0.827011).  Saving model ...
Epoch: 3 cost time: 2.532182455062866
Epoch: 3, Steps: 17 | Train Loss: 1.180 Vali Loss: 0.935 Vali Acc: 0.892 Test Loss: 0.935 Test Acc: 0.892
Validation loss decreased (-0.827011 --> -0.891883).  Saving model ...
Epoch: 4 cost time: 2.4572372436523438
Epoch: 4, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.482 Vali Acc: 0.935 Test Loss: 0.482 Test Acc: 0.935
Validation loss decreased (-0.891883 --> -0.935130).  Saving model ...
Epoch: 5 cost time: 2.34232497215271
Epoch: 5, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.264 Vali Acc: 0.959 Test Loss: 0.264 Test Acc: 0.959
Validation loss decreased (-0.935130 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 2.104067325592041
Epoch: 6, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.4195895195007324
Epoch: 7, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 2.3265881538391113
Epoch: 8, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.502779006958008
Epoch: 9, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.527371644973755
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3867623805999756
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4957714080810547
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4445624351501465
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3735249042510986
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4740617275238037
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.650028705596924
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.692294120788574
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.640763759613037
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4751553535461426
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4604313373565674
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5722477436065674
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4701108932495117
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4260988235473633
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5330891609191895
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5486092567443848
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.4966070652008057
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6338014602661133
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1288777
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.012824535369873
Epoch: 1, Steps: 17 | Train Loss: 2.108 Vali Loss: 2.050 Vali Acc: 0.524 Test Loss: 2.050 Test Acc: 0.524
Validation loss decreased (inf --> -0.524304).  Saving model ...
Epoch: 2 cost time: 2.5659472942352295
Epoch: 2, Steps: 17 | Train Loss: 1.771 Vali Loss: 1.627 Vali Acc: 0.854 Test Loss: 1.627 Test Acc: 0.854
Validation loss decreased (-0.524304 --> -0.854038).  Saving model ...
Epoch: 3 cost time: 2.5221047401428223
Epoch: 3, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.024 Vali Acc: 0.897 Test Loss: 1.024 Test Acc: 0.897
Validation loss decreased (-0.854038 --> -0.897287).  Saving model ...
Epoch: 4 cost time: 2.5539345741271973
Epoch: 4, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.526 Vali Acc: 0.946 Test Loss: 0.526 Test Acc: 0.946
Validation loss decreased (-0.897287 --> -0.945941).  Saving model ...
Epoch: 5 cost time: 2.5469772815704346
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.280 Vali Acc: 0.954 Test Loss: 0.280 Test Acc: 0.954
Validation loss decreased (-0.945941 --> -0.954051).  Saving model ...
Epoch: 6 cost time: 2.51556396484375
Epoch: 6, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 7 cost time: 2.5647523403167725
Epoch: 7, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 2.6276607513427734
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.6451096534729004
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.6402502059936523
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.547358989715576
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.5456504821777344
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 2.372225522994995
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.361797571182251
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.514413356781006
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.367565870285034
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3094842433929443
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.393069267272949
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 2.5503082275390625
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.555180549621582
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 2.314812421798706
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4285030364990234
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.380492925643921
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3598248958587646
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5275816917419434
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.434227466583252
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.462057113647461
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4666125774383545
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3694002628326416
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.4336867332458496
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 2.562814474105835
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.377627372741699
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.3357763290405273
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.3560798168182373
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.436021089553833
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.373671531677246
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.612814426422119
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.5413706302642822
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.6265780925750732
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.9345779418945312
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1288809
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7615127563476562
Epoch: 1, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.104 Vali Acc: 0.386 Test Loss: 2.104 Test Acc: 0.386
Validation loss decreased (inf --> -0.386465).  Saving model ...
Epoch: 2 cost time: 2.3398475646972656
Epoch: 2, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.724 Vali Acc: 0.832 Test Loss: 1.724 Test Acc: 0.832
Validation loss decreased (-0.386465 --> -0.832415).  Saving model ...
Epoch: 3 cost time: 2.615330696105957
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.178 Vali Acc: 0.900 Test Loss: 1.178 Test Acc: 0.900
Validation loss decreased (-0.832415 --> -0.899988).  Saving model ...
Epoch: 4 cost time: 2.391366720199585
Epoch: 4, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.695 Vali Acc: 0.927 Test Loss: 0.695 Test Acc: 0.927
Validation loss decreased (-0.899988 --> -0.927020).  Saving model ...
Epoch: 5 cost time: 2.676254987716675
Epoch: 5, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.382 Vali Acc: 0.951 Test Loss: 0.382 Test Acc: 0.951
Validation loss decreased (-0.927020 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 2.5237081050872803
Epoch: 6, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.246 Vali Acc: 0.951 Test Loss: 0.246 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 2.786419153213501
Epoch: 7, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 2.8692243099212646
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.5565273761749268
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.4553451538085938
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.4531710147857666
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 2.3436920642852783
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.495997905731201
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3503150939941406
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4932398796081543
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.519930601119995
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.657010078430176
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3701863288879395
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.505509376525879
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6529321670532227
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.609546661376953
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1275049
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.583603143692017
Epoch: 1, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.101 Vali Acc: 0.884 Test Loss: 1.101 Test Acc: 0.884
Validation loss decreased (inf --> -0.883773).  Saving model ...
Epoch: 2 cost time: 2.9363818168640137
Epoch: 2, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.883773 --> -0.929727).  Saving model ...
Epoch: 3 cost time: 3.138270378112793
Epoch: 3, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.929727 --> -0.975675).  Saving model ...
Epoch: 4 cost time: 3.378710985183716
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3581454753875732
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.358694553375244
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.343898296356201
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.17948317527771
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 2.893308401107788
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.938849925994873
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.976262092590332
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.187664747238159
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.331700325012207
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1335220336914062
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.004211187362671
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.324753522872925
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.46008563041687
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.282867431640625
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 4764425
model size : 18.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.182550668716431
Epoch: 1, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.202 Vali Acc: 0.908 Test Loss: 1.202 Test Acc: 0.908
Validation loss decreased (inf --> -0.908096).  Saving model ...
Epoch: 2 cost time: 3.1044833660125732
Epoch: 2, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
Validation loss decreased (-0.908096 --> -0.927025).  Saving model ...
Epoch: 3 cost time: 3.3238258361816406
Epoch: 3, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.927025 --> -0.972972).  Saving model ...
Epoch: 4 cost time: 3.2526283264160156
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 5 cost time: 3.2602741718292236
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1985044479370117
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.924360513687134
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.93353009223938
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0235109329223633
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9779210090637207
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.78574275970459
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0540943145751953
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.321258068084717
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.159787893295288
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 4764553
model size : 18.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.399027109146118
Epoch: 1, Steps: 17 | Train Loss: 1.978 Vali Loss: 1.647 Vali Acc: 0.895 Test Loss: 1.647 Test Acc: 0.895
Validation loss decreased (inf --> -0.894578).  Saving model ...
Epoch: 2 cost time: 2.7709832191467285
Epoch: 2, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.447 Vali Acc: 0.943 Test Loss: 0.447 Test Acc: 0.943
Validation loss decreased (-0.894578 --> -0.943239).  Saving model ...
Epoch: 3 cost time: 2.789677858352661
Epoch: 3, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945944).  Saving model ...
Epoch: 4 cost time: 2.635033369064331
Epoch: 4, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.945944 --> -0.981080).  Saving model ...
Epoch: 5 cost time: 2.455148696899414
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4676806926727295
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.10661244392395
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7953734397888184
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9070544242858887
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 2.717742681503296
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8879754543304443
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7314703464508057
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5624420642852783
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5237646102905273
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5825016498565674
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5669448375701904
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5382142066955566
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6978437900543213
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8330299854278564
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 4543497
model size : 17.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.061376333236694
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.749 Vali Acc: 0.816 Test Loss: 1.749 Test Acc: 0.816
Validation loss decreased (inf --> -0.816199).  Saving model ...
Epoch: 2 cost time: 2.7342329025268555
Epoch: 2, Steps: 17 | Train Loss: 1.017 Vali Loss: 0.667 Vali Acc: 0.922 Test Loss: 0.667 Test Acc: 0.922
Validation loss decreased (-0.816199 --> -0.921615).  Saving model ...
Epoch: 3 cost time: 3.196427822113037
Epoch: 3, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.921615 --> -0.943241).  Saving model ...
Epoch: 4 cost time: 3.0027952194213867
Epoch: 4, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.943241 --> -0.964864).  Saving model ...
Epoch: 5 cost time: 3.083186626434326
Epoch: 5, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 3.048231363296509
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 3.1267402172088623
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3621299266815186
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 3.3246405124664307
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2897109985351562
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2617976665496826
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.308422565460205
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 3.2232396602630615
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 2.838160514831543
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 2.9025990962982178
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7626447677612305
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.911759376525879
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 3.20542311668396
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2774577140808105
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.298825740814209
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.113313913345337
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.1364989280700684
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.235633134841919
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.1041648387908936
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.973579168319702
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8771347999572754
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9252569675445557
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 4488457
model size : 17.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.238544940948486
Epoch: 1, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.808 Vali Acc: 0.738 Test Loss: 1.808 Test Acc: 0.738
Validation loss decreased (inf --> -0.737820).  Saving model ...
Epoch: 2 cost time: 2.9784650802612305
Epoch: 2, Steps: 17 | Train Loss: 1.067 Vali Loss: 0.724 Vali Acc: 0.919 Test Loss: 0.724 Test Acc: 0.919
Validation loss decreased (-0.737820 --> -0.918912).  Saving model ...
Epoch: 3 cost time: 3.0144760608673096
Epoch: 3, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.237 Vali Acc: 0.946 Test Loss: 0.237 Test Acc: 0.946
Validation loss decreased (-0.918912 --> -0.945944).  Saving model ...
Epoch: 4 cost time: 3.004218816757202
Epoch: 4, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.945944 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 2.81630277633667
Epoch: 5, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.90313458442688
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 2.8873395919799805
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 3.012255907058716
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1891188621520996
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1128902435302734
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.259727716445923
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8464629650115967
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.248426675796509
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.246286153793335
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.0964553356170654
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.8328030109405518
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7099595069885254
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 4488585
model size : 17.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.642594337463379
Epoch: 1, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.836 Vali Acc: 0.830 Test Loss: 1.836 Test Acc: 0.830
Validation loss decreased (inf --> -0.829711).  Saving model ...
Epoch: 2 cost time: 3.1746973991394043
Epoch: 2, Steps: 17 | Train Loss: 1.151 Vali Loss: 0.832 Vali Acc: 0.916 Test Loss: 0.832 Test Acc: 0.916
Validation loss decreased (-0.829711 --> -0.916208).  Saving model ...
Epoch: 3 cost time: 3.2918412685394287
Epoch: 3, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.289 Vali Acc: 0.951 Test Loss: 0.289 Test Acc: 0.951
Validation loss decreased (-0.916208 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 3.304292678833008
Epoch: 4, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.951348 --> -0.962161).  Saving model ...
Epoch: 5 cost time: 3.1642091274261475
Epoch: 5, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.100721597671509
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 3.0614230632781982
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.231724500656128
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.326678514480591
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 3.06950044631958
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9782073497772217
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1801140308380127
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 2.923788070678711
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 3.014543294906616
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8750216960906982
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0509541034698486
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2537381649017334
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1668765544891357
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 3.056839942932129
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.126648426055908
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1323769092559814
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1343414783477783
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1818759441375732
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2480690479278564
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1571826934814453
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1340198516845703
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.996574878692627
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.881659746170044
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 4461193
model size : 17.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8955485820770264
Epoch: 1, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.676 Vali Acc: 0.824 Test Loss: 1.676 Test Acc: 0.824
Validation loss decreased (inf --> -0.824308).  Saving model ...
Epoch: 2 cost time: 2.513801097869873
Epoch: 2, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.492 Vali Acc: 0.922 Test Loss: 0.492 Test Acc: 0.922
Validation loss decreased (-0.824308 --> -0.921617).  Saving model ...
Epoch: 3 cost time: 2.5863170623779297
Epoch: 3, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.921617 --> -0.948647).  Saving model ...
Epoch: 4 cost time: 2.503401041030884
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.948647 --> -0.978377).  Saving model ...
Epoch: 5 cost time: 2.513312816619873
Epoch: 5, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.355259895324707
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3680055141448975
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4505653381347656
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.381890058517456
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3433618545532227
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1445419788360596
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3471994400024414
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3364193439483643
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.29109263420105
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1382793
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.836613893508911
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.615 Vali Acc: 0.846 Test Loss: 1.615 Test Acc: 0.846
Validation loss decreased (inf --> -0.845930).  Saving model ...
Epoch: 2 cost time: 2.291238307952881
Epoch: 2, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.502 Vali Acc: 0.935 Test Loss: 0.502 Test Acc: 0.935
Validation loss decreased (-0.845930 --> -0.935130).  Saving model ...
Epoch: 3 cost time: 2.323420286178589
Epoch: 3, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.935130 --> -0.956755).  Saving model ...
Epoch: 4 cost time: 2.609002113342285
Epoch: 4, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.956755 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 2.4885008335113525
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.643813371658325
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.469298839569092
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.461674928665161
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5527727603912354
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5648655891418457
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7422945499420166
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.840056896209717
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.76609468460083
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.681213617324829
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3974955081939697
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.416618824005127
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3879356384277344
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1382857
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9540929794311523
Epoch: 1, Steps: 17 | Train Loss: 2.052 Vali Loss: 1.891 Vali Acc: 0.573 Test Loss: 1.891 Test Acc: 0.573
Validation loss decreased (inf --> -0.572954).  Saving model ...
Epoch: 2 cost time: 2.302077293395996
Epoch: 2, Steps: 17 | Train Loss: 1.278 Vali Loss: 0.987 Vali Acc: 0.924 Test Loss: 0.987 Test Acc: 0.924
Validation loss decreased (-0.572954 --> -0.924314).  Saving model ...
Epoch: 3 cost time: 2.4426560401916504
Epoch: 3, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.350 Vali Acc: 0.946 Test Loss: 0.350 Test Acc: 0.946
Validation loss decreased (-0.924314 --> -0.945942).  Saving model ...
Epoch: 4 cost time: 2.5703442096710205
Epoch: 4, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.945942 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 2.629507541656494
Epoch: 5, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.5765445232391357
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 2.4640371799468994
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 2.4116148948669434
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1765642166137695
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1508870124816895
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0070066452026367
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1802892684936523
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.288461923599243
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 2.4527361392974854
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.402414083480835
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2535488605499268
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3251960277557373
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3940258026123047
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.366344928741455
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3530659675598145
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 21 cost time: 2.339059829711914
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.389598846435547
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4680588245391846
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3204383850097656
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.457087755203247
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4647486209869385
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.600186824798584
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.6660819053649902
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6303324699401855
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.6465203762054443
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1272329
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.956127166748047
Epoch: 1, Steps: 17 | Train Loss: 2.091 Vali Loss: 1.922 Vali Acc: 0.668 Test Loss: 1.922 Test Acc: 0.668
Validation loss decreased (inf --> -0.667548).  Saving model ...
Epoch: 2 cost time: 2.28235125541687
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.241 Vali Acc: 0.876 Test Loss: 1.241 Test Acc: 0.876
Validation loss decreased (-0.667548 --> -0.875663).  Saving model ...
Epoch: 3 cost time: 2.133876085281372
Epoch: 3, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.553 Vali Acc: 0.924 Test Loss: 0.553 Test Acc: 0.924
Validation loss decreased (-0.875663 --> -0.924319).  Saving model ...
Epoch: 4 cost time: 2.070124626159668
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.254 Vali Acc: 0.957 Test Loss: 0.254 Test Acc: 0.957
Validation loss decreased (-0.924319 --> -0.956754).  Saving model ...
Epoch: 5 cost time: 2.087230920791626
Epoch: 5, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
Validation loss decreased (-0.956754 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.2654521465301514
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975674).  Saving model ...
Epoch: 7 cost time: 2.494779586791992
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.269757032394409
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3486242294311523
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 2.3681583404541016
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 2.569793939590454
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.375981092453003
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.347201347351074
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 2.3722403049468994
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.255784034729004
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 2.060688018798828
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 2.098458766937256
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.318525552749634
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3584861755371094
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4060170650482178
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5783331394195557
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.321471691131592
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.258312225341797
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2935805320739746
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.249622106552124
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 2.315509080886841
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0238451957702637
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1736044883728027
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2502334117889404
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.220698595046997
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.1824214458465576
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3618102073669434
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 33 cost time: 2.4092679023742676
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.545823097229004
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 35 cost time: 2.4389374256134033
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 36 cost time: 2.5132853984832764
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3911819458007812
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.4134914875030518
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.647266149520874
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.334527015686035
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.2820990085601807
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9918875694274902
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.194317102432251
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.1030025482177734
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.224479913711548
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1244809
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8834915161132812
Epoch: 1, Steps: 17 | Train Loss: 2.106 Vali Loss: 1.974 Vali Acc: 0.668 Test Loss: 1.974 Test Acc: 0.668
Validation loss decreased (inf --> -0.667548).  Saving model ...
Epoch: 2 cost time: 2.353123426437378
Epoch: 2, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.244 Vali Acc: 0.900 Test Loss: 1.244 Test Acc: 0.900
Validation loss decreased (-0.667548 --> -0.899988).  Saving model ...
Epoch: 3 cost time: 2.2925057411193848
Epoch: 3, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.557 Vali Acc: 0.930 Test Loss: 0.557 Test Acc: 0.930
Validation loss decreased (-0.899988 --> -0.929724).  Saving model ...
Epoch: 4 cost time: 2.515707015991211
Epoch: 4, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.243 Vali Acc: 0.965 Test Loss: 0.243 Test Acc: 0.965
Validation loss decreased (-0.929724 --> -0.964862).  Saving model ...
Epoch: 5 cost time: 2.4134280681610107
Epoch: 5, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.964862 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 2.3196170330047607
Epoch: 6, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.2214059829711914
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 2.2731215953826904
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1381754875183105
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 2.1965489387512207
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.191011667251587
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2198023796081543
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2370972633361816
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.383019208908081
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.332026243209839
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1845507621765137
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.248626708984375
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.164776563644409
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.211496353149414
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1244873
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4501254558563232
Epoch: 1, Steps: 17 | Train Loss: 2.159 Vali Loss: 2.050 Vali Acc: 0.449 Test Loss: 2.050 Test Acc: 0.449
Validation loss decreased (inf --> -0.448628).  Saving model ...
Epoch: 2 cost time: 2.590081214904785
Epoch: 2, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.452 Vali Acc: 0.835 Test Loss: 1.452 Test Acc: 0.835
Validation loss decreased (-0.448628 --> -0.835121).  Saving model ...
Epoch: 3 cost time: 2.491957902908325
Epoch: 3, Steps: 17 | Train Loss: 0.986 Vali Loss: 0.760 Vali Acc: 0.908 Test Loss: 0.760 Test Acc: 0.908
Validation loss decreased (-0.835121 --> -0.908101).  Saving model ...
Epoch: 4 cost time: 2.4636240005493164
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.342 Vali Acc: 0.954 Test Loss: 0.342 Test Acc: 0.954
Validation loss decreased (-0.908101 --> -0.954051).  Saving model ...
Epoch: 5 cost time: 2.396308422088623
Epoch: 5, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 2.4626336097717285
Epoch: 6, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 2.320645332336426
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 2.369690418243408
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.970269 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 2.500319719314575
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3390345573425293
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.210977077484131
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2064871788024902
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 2.218322992324829
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.210082530975342
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.243492841720581
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.434338092803955
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.446983814239502
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3574016094207764
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5359153747558594
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3889572620391846
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3270585536956787
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.391528367996216
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1231177
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.627220392227173
Epoch: 1, Steps: 17 | Train Loss: 2.047 Vali Loss: 1.912 Vali Acc: 0.614 Test Loss: 1.912 Test Acc: 0.614
Validation loss decreased (inf --> -0.613494).  Saving model ...
Epoch: 2 cost time: 2.3634421825408936
Epoch: 2, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.071 Vali Acc: 0.892 Test Loss: 1.071 Test Acc: 0.892
Validation loss decreased (-0.613494 --> -0.891881).  Saving model ...
Epoch: 3 cost time: 2.2333414554595947
Epoch: 3, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.416 Vali Acc: 0.943 Test Loss: 0.416 Test Acc: 0.943
Validation loss decreased (-0.891881 --> -0.943239).  Saving model ...
Epoch: 4 cost time: 2.369100570678711
Epoch: 4, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
Validation loss decreased (-0.943239 --> -0.964863).  Saving model ...
Epoch: 5 cost time: 2.1900718212127686
Epoch: 5, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 2.0450010299682617
Epoch: 6, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 2.0472114086151123
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.3792169094085693
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.2516860961914062
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.242035388946533
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 2.0957958698272705
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 1.8402726650238037
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 2.1349143981933594
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9943227767944336
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8228857517242432
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 2.1475019454956055
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.321341037750244
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1920557022094727
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5361006259918213
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.568366050720215
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4239087104797363
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5296313762664795
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 23 cost time: 2.5428173542022705
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.780787467956543
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.551487922668457
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.285244941711426
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.218724250793457
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1987338066101074
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3735554218292236
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3845291137695312
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7161641120910645
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2168476581573486
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 441545
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.871077299118042
Epoch: 1, Steps: 17 | Train Loss: 2.086 Vali Loss: 1.885 Vali Acc: 0.689 Test Loss: 1.885 Test Acc: 0.689
Validation loss decreased (inf --> -0.689170).  Saving model ...
Epoch: 2 cost time: 2.311347007751465
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.115 Vali Acc: 0.900 Test Loss: 1.115 Test Acc: 0.900
Validation loss decreased (-0.689170 --> -0.899989).  Saving model ...
Epoch: 3 cost time: 2.3796932697296143
Epoch: 3, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.444 Vali Acc: 0.941 Test Loss: 0.444 Test Acc: 0.941
Validation loss decreased (-0.899989 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 2.4559433460235596
Epoch: 4, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
Validation loss decreased (-0.940536 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 2.2317557334899902
Epoch: 5, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
Validation loss decreased (-0.954052 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 2.180382251739502
Epoch: 6, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.046072244644165
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.308229923248291
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3605995178222656
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.273193359375
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 2.260248899459839
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.3698980808258057
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 2.303238868713379
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 2.3086721897125244
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.520432710647583
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.441567897796631
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2468454837799072
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 2.2002389430999756
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.163489580154419
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0601232051849365
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.063413381576538
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1925158500671387
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2302863597869873
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4085500240325928
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.413994312286377
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.141997814178467
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.511521100997925
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 441577
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.732144594192505
Epoch: 1, Steps: 17 | Train Loss: 2.155 Vali Loss: 2.070 Vali Acc: 0.359 Test Loss: 2.070 Test Acc: 0.359
Validation loss decreased (inf --> -0.359439).  Saving model ...
Epoch: 2 cost time: 2.051868438720703
Epoch: 2, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.626 Vali Acc: 0.797 Test Loss: 1.626 Test Acc: 0.797
Validation loss decreased (-0.359439 --> -0.797281).  Saving model ...
Epoch: 3 cost time: 1.991896152496338
Epoch: 3, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.013 Vali Acc: 0.897 Test Loss: 1.013 Test Acc: 0.897
Validation loss decreased (-0.797281 --> -0.897287).  Saving model ...
Epoch: 4 cost time: 2.0108728408813477
Epoch: 4, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.537 Vali Acc: 0.943 Test Loss: 0.537 Test Acc: 0.943
Validation loss decreased (-0.897287 --> -0.943238).  Saving model ...
Epoch: 5 cost time: 2.0321896076202393
Epoch: 5, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.298 Vali Acc: 0.957 Test Loss: 0.298 Test Acc: 0.957
Validation loss decreased (-0.943238 --> -0.956754).  Saving model ...
Epoch: 6 cost time: 2.208899974822998
Epoch: 6, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.203 Vali Acc: 0.954 Test Loss: 0.203 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9627130031585693
Epoch: 7, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
Validation loss decreased (-0.956754 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 1.765209674835205
Epoch: 8, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9471635818481445
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7730982303619385
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.9584932327270508
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 1.7599799633026123
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 1.9782919883728027
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.8933451175689697
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.19579815864563
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0636227130889893
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1563785076141357
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2411959171295166
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0423171520233154
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0559141635894775
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.062316656112671
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.17775821685791
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.15559983253479
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 386313
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.436066150665283
Epoch: 1, Steps: 17 | Train Loss: 2.069 Vali Loss: 2.045 Vali Acc: 0.351 Test Loss: 2.045 Test Acc: 0.351
Validation loss decreased (inf --> -0.351331).  Saving model ...
Epoch: 2 cost time: 2.02575945854187
Epoch: 2, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.621 Vali Acc: 0.841 Test Loss: 1.621 Test Acc: 0.841
Validation loss decreased (-0.351331 --> -0.840524).  Saving model ...
Epoch: 3 cost time: 2.2858080863952637
Epoch: 3, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.101 Vali Acc: 0.911 Test Loss: 1.101 Test Acc: 0.911
Validation loss decreased (-0.840524 --> -0.910800).  Saving model ...
Epoch: 4 cost time: 2.0209317207336426
Epoch: 4, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.642 Vali Acc: 0.927 Test Loss: 0.642 Test Acc: 0.927
Validation loss decreased (-0.910800 --> -0.927021).  Saving model ...
Epoch: 5 cost time: 2.062068223953247
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.372 Vali Acc: 0.949 Test Loss: 0.372 Test Acc: 0.949
Validation loss decreased (-0.927021 --> -0.948645).  Saving model ...
Epoch: 6 cost time: 1.818265438079834
Epoch: 6, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.254 Vali Acc: 0.962 Test Loss: 0.254 Test Acc: 0.962
Validation loss decreased (-0.948645 --> -0.962160).  Saving model ...
Epoch: 7 cost time: 1.7289612293243408
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9041962623596191
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 2.1300079822540283
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0649726390838623
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9322350025177002
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1068289279937744
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.9957478046417236
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.1392223834991455
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.1017346382141113
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.169785499572754
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 2.0338897705078125
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0449843406677246
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.9354207515716553
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 1.884258508682251
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0737690925598145
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.235703468322754
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2962756156921387
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 2.285322904586792
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.2394051551818848
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.10636305809021
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.778667688369751
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0080080032348633
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.914921760559082
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.8991587162017822
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.894728660583496
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8295788764953613
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 1.8019115924835205
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.8246421813964844
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8714652061462402
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.9447779655456543
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.156312942504883
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.889455795288086
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.778252363204956
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 40 cost time: 1.718869924545288
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9501335620880127
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.0678703784942627
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.0169577598571777
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.04245662689209
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.096107006072998
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.964029312133789
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.0678369998931885
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.0951600074768066
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.114173412322998
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 372553
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3448193073272705
Epoch: 1, Steps: 17 | Train Loss: 2.150 Vali Loss: 2.091 Vali Acc: 0.289 Test Loss: 2.091 Test Acc: 0.289
Validation loss decreased (inf --> -0.289168).  Saving model ...
Epoch: 2 cost time: 1.695054531097412
Epoch: 2, Steps: 17 | Train Loss: 1.842 Vali Loss: 1.708 Vali Acc: 0.781 Test Loss: 1.708 Test Acc: 0.781
Validation loss decreased (-0.289168 --> -0.781064).  Saving model ...
Epoch: 3 cost time: 1.9524478912353516
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.179 Vali Acc: 0.897 Test Loss: 1.179 Test Acc: 0.897
Validation loss decreased (-0.781064 --> -0.897286).  Saving model ...
Epoch: 4 cost time: 2.0337283611297607
Epoch: 4, Steps: 17 | Train Loss: 0.865 Vali Loss: 0.684 Vali Acc: 0.927 Test Loss: 0.684 Test Acc: 0.927
Validation loss decreased (-0.897286 --> -0.927020).  Saving model ...
Epoch: 5 cost time: 2.0310919284820557
Epoch: 5, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.396 Vali Acc: 0.943 Test Loss: 0.396 Test Acc: 0.943
Validation loss decreased (-0.927020 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 2.123063564300537
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.259 Vali Acc: 0.957 Test Loss: 0.259 Test Acc: 0.957
Validation loss decreased (-0.943239 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 2.185767412185669
Epoch: 7, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 1.9303112030029297
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 1.9201583862304688
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.8665099143981934
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.9052228927612305
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.9262654781341553
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.8362438678741455
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.99113130569458
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.9997153282165527
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 1.9275014400482178
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9683411121368408
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.953303337097168
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 2.0632431507110596
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 1.7238271236419678
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8667445182800293
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8473892211914062
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7734761238098145
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8941974639892578
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9327852725982666
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9383649826049805
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.040081262588501
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.126784563064575
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1159212589263916
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 372585
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.582557439804077
Epoch: 1, Steps: 17 | Train Loss: 2.151 Vali Loss: 2.099 Vali Acc: 0.289 Test Loss: 2.099 Test Acc: 0.289
Validation loss decreased (inf --> -0.289168).  Saving model ...
Epoch: 2 cost time: 2.110153913497925
Epoch: 2, Steps: 17 | Train Loss: 1.877 Vali Loss: 1.775 Vali Acc: 0.727 Test Loss: 1.775 Test Acc: 0.727
Validation loss decreased (-0.289168 --> -0.727009).  Saving model ...
Epoch: 3 cost time: 2.061676025390625
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.320 Vali Acc: 0.857 Test Loss: 1.320 Test Acc: 0.857
Validation loss decreased (-0.727009 --> -0.856744).  Saving model ...
Epoch: 4 cost time: 2.080714225769043
Epoch: 4, Steps: 17 | Train Loss: 1.012 Vali Loss: 0.871 Vali Acc: 0.897 Test Loss: 0.871 Test Acc: 0.897
Validation loss decreased (-0.856744 --> -0.897289).  Saving model ...
Epoch: 5 cost time: 2.0002388954162598
Epoch: 5, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.513 Vali Acc: 0.922 Test Loss: 0.513 Test Acc: 0.922
Validation loss decreased (-0.897289 --> -0.921616).  Saving model ...
Epoch: 6 cost time: 2.2615411281585693
Epoch: 6, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.335 Vali Acc: 0.957 Test Loss: 0.335 Test Acc: 0.957
Validation loss decreased (-0.921616 --> -0.956753).  Saving model ...
Epoch: 7 cost time: 2.125279426574707
Epoch: 7, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.251 Vali Acc: 0.968 Test Loss: 0.251 Test Acc: 0.968
Validation loss decreased (-0.956753 --> -0.967565).  Saving model ...
Epoch: 8 cost time: 2.2085254192352295
Epoch: 8, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.196 Vali Acc: 0.973 Test Loss: 0.196 Test Acc: 0.973
Validation loss decreased (-0.967565 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 2.0911340713500977
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
Validation loss decreased (-0.972971 --> -0.981079).  Saving model ...
Epoch: 10 cost time: 2.0885677337646484
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8859469890594482
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8454694747924805
Epoch: 12, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.981079 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.5750432014465332
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.735790491104126
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.984 Test Loss: 0.107 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 15 cost time: 1.9348781108856201
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 16 cost time: 1.864924430847168
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8861353397369385
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.903881549835205
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.116560220718384
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1742565631866455
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.118330478668213
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0693466663360596
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0842113494873047
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1176598072052
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1812589168548584
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 365737
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.064073085784912
Epoch: 1, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.082 Vali Acc: 0.895 Test Loss: 1.082 Test Acc: 0.895
Validation loss decreased (inf --> -0.894584).  Saving model ...
Epoch: 2 cost time: 3.831603527069092
Epoch: 2, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
Validation loss decreased (-0.894584 --> -0.954052).  Saving model ...
Epoch: 3 cost time: 3.8188393115997314
Epoch: 3, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967567).  Saving model ...
Epoch: 4 cost time: 3.579944610595703
Epoch: 4, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.394623279571533
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 6 cost time: 3.4905154705047607
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.967567 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 3.440701723098755
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.541724681854248
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.641636610031128
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9361774921417236
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8190739154815674
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.717679738998413
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.837207078933716
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.7580068111419678
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.683694839477539
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.799220561981201
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 4745993
model size : 18.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.707180738449097
Epoch: 1, Steps: 17 | Train Loss: 1.785 Vali Loss: 1.225 Vali Acc: 0.895 Test Loss: 1.225 Test Acc: 0.895
Validation loss decreased (inf --> -0.894582).  Saving model ...
Epoch: 2 cost time: 2.9252727031707764
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
Validation loss decreased (-0.894582 --> -0.945944).  Saving model ...
Epoch: 3 cost time: 3.2973146438598633
Epoch: 3, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.945944 --> -0.964864).  Saving model ...
Epoch: 4 cost time: 3.12113356590271
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0711722373962402
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.303795337677002
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.55686092376709
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 3.6966235637664795
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 3.768122911453247
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0899736881256104
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1646382808685303
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.375450849533081
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 3.645656108856201
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7442853450775146
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8050341606140137
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3804283142089844
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5353524684906006
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.5115468502044678
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.145045042037964
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.283954620361328
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4859073162078857
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7308924198150635
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 4746121
model size : 18.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.670015335083008
Epoch: 1, Steps: 17 | Train Loss: 1.954 Vali Loss: 1.633 Vali Acc: 0.843 Test Loss: 1.633 Test Acc: 0.843
Validation loss decreased (inf --> -0.843227).  Saving model ...
Epoch: 2 cost time: 3.2936882972717285
Epoch: 2, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.500 Vali Acc: 0.932 Test Loss: 0.500 Test Acc: 0.932
Validation loss decreased (-0.843227 --> -0.932427).  Saving model ...
Epoch: 3 cost time: 3.111597776412964
Epoch: 3, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
Validation loss decreased (-0.932427 --> -0.954053).  Saving model ...
Epoch: 4 cost time: 3.1628615856170654
Epoch: 4, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.954053 --> -0.967567).  Saving model ...
Epoch: 5 cost time: 3.232489585876465
Epoch: 5, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2687692642211914
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 3.0657310485839844
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.951307535171509
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2376458644866943
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0831997394561768
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1417129039764404
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7918171882629395
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.270395517349243
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.3740339279174805
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.3077316284179688
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.433245897293091
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 4525065
model size : 17.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.685281753540039
Epoch: 1, Steps: 17 | Train Loss: 2.057 Vali Loss: 1.788 Vali Acc: 0.811 Test Loss: 1.788 Test Acc: 0.811
Validation loss decreased (inf --> -0.810793).  Saving model ...
Epoch: 2 cost time: 2.850353956222534
Epoch: 2, Steps: 17 | Train Loss: 1.060 Vali Loss: 0.683 Vali Acc: 0.930 Test Loss: 0.683 Test Acc: 0.930
Validation loss decreased (-0.810793 --> -0.929723).  Saving model ...
Epoch: 3 cost time: 3.0333356857299805
Epoch: 3, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
Validation loss decreased (-0.929723 --> -0.959457).  Saving model ...
Epoch: 4 cost time: 3.0430445671081543
Epoch: 4, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 3.117241144180298
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 3.1290013790130615
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 2.675342559814453
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7460379600524902
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.778470516204834
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.652172327041626
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.557053565979004
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.6661365032196045
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 3.1897964477539062
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1348981857299805
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 2.972381353378296
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 3.1451945304870605
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9801688194274902
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0114972591400146
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.943976640701294
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.92637300491333
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8510780334472656
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.9686551094055176
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.8593926429748535
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.7014546394348145
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7366533279418945
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 4470025
model size : 17.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.827224493026733
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.754 Vali Acc: 0.824 Test Loss: 1.754 Test Acc: 0.824
Validation loss decreased (inf --> -0.824307).  Saving model ...
Epoch: 2 cost time: 3.050539255142212
Epoch: 2, Steps: 17 | Train Loss: 1.025 Vali Loss: 0.677 Vali Acc: 0.908 Test Loss: 0.677 Test Acc: 0.908
Validation loss decreased (-0.824307 --> -0.908101).  Saving model ...
Epoch: 3 cost time: 3.423076868057251
Epoch: 3, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
Validation loss decreased (-0.908101 --> -0.964863).  Saving model ...
Epoch: 4 cost time: 3.3267667293548584
Epoch: 4, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 3.1570820808410645
Epoch: 5, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 6 cost time: 3.317286729812622
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 3.297319173812866
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 8 cost time: 3.2102837562561035
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 9 cost time: 3.098353385925293
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 10 cost time: 3.4039392471313477
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3150224685668945
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 12 cost time: 3.0664992332458496
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 13 cost time: 3.2143445014953613
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 14 cost time: 3.2654900550842285
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0338733196258545
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 16 cost time: 3.2704100608825684
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3559372425079346
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 18 cost time: 3.233654499053955
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2696261405944824
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3220643997192383
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3057150840759277
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.177159070968628
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.4532320499420166
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3213679790496826
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.2350573539733887
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3078463077545166
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.206333637237549
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 4470153
model size : 17.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.389392137527466
Epoch: 1, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.797 Vali Acc: 0.784 Test Loss: 1.797 Test Acc: 0.784
Validation loss decreased (inf --> -0.783766).  Saving model ...
Epoch: 2 cost time: 3.0890893936157227
Epoch: 2, Steps: 17 | Train Loss: 1.106 Vali Loss: 0.788 Vali Acc: 0.916 Test Loss: 0.788 Test Acc: 0.916
Validation loss decreased (-0.783766 --> -0.916208).  Saving model ...
Epoch: 3 cost time: 2.9281482696533203
Epoch: 3, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.254 Vali Acc: 0.951 Test Loss: 0.254 Test Acc: 0.951
Validation loss decreased (-0.916208 --> -0.951349).  Saving model ...
Epoch: 4 cost time: 2.8467941284179688
Epoch: 4, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
Validation loss decreased (-0.951349 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 3.1602072715759277
Epoch: 5, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.12033748626709
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 3.159140110015869
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.405796766281128
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2270517349243164
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.350162982940674
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.336503028869629
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1607556343078613
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2189080715179443
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.9463086128234863
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9033215045928955
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1525156497955322
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 4442761
model size : 17.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.001361131668091
Epoch: 1, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.659 Vali Acc: 0.819 Test Loss: 1.659 Test Acc: 0.819
Validation loss decreased (inf --> -0.818902).  Saving model ...
Epoch: 2 cost time: 2.1035943031311035
Epoch: 2, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.546 Vali Acc: 0.927 Test Loss: 0.546 Test Acc: 0.927
Validation loss decreased (-0.818902 --> -0.927022).  Saving model ...
Epoch: 3 cost time: 2.475074052810669
Epoch: 3, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.927022 --> -0.962161).  Saving model ...
Epoch: 4 cost time: 2.5048506259918213
Epoch: 4, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 2.419314384460449
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 2.6637091636657715
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4751639366149902
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.226383686065674
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.968 Test Loss: 0.081 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.463059425354004
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6342577934265137
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 2.3053274154663086
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.13869571685791
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2400455474853516
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.572455406188965
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3596079349517822
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3677432537078857
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.705463171005249
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.528547763824463
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4686951637268066
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 2.30009388923645
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.380143642425537
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.682650089263916
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.8232436180114746
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.412750244140625
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4251084327697754
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7473833560943604
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7239317893981934
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7103066444396973
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.431663990020752
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1373577
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.097742319107056
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.642 Vali Acc: 0.876 Test Loss: 1.642 Test Acc: 0.876
Validation loss decreased (inf --> -0.875659).  Saving model ...
Epoch: 2 cost time: 2.478285312652588
Epoch: 2, Steps: 17 | Train Loss: 0.849 Vali Loss: 0.548 Vali Acc: 0.916 Test Loss: 0.548 Test Acc: 0.916
Validation loss decreased (-0.875659 --> -0.916211).  Saving model ...
Epoch: 3 cost time: 2.6439101696014404
Epoch: 3, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
Validation loss decreased (-0.916211 --> -0.935133).  Saving model ...
Epoch: 4 cost time: 2.3524718284606934
Epoch: 4, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.935133 --> -0.978377).  Saving model ...
Epoch: 5 cost time: 2.4643261432647705
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4963760375976562
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7224302291870117
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 2.626753807067871
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.968 Test Loss: 0.083 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4868409633636475
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3880741596221924
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.580162763595581
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7416598796844482
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5920794010162354
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.318413257598877
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.968 Test Loss: 0.079 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.509678602218628
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.965 Test Loss: 0.082 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4934866428375244
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.497286081314087
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1373641
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.128072261810303
Epoch: 1, Steps: 17 | Train Loss: 2.054 Vali Loss: 1.863 Vali Acc: 0.722 Test Loss: 1.863 Test Acc: 0.722
Validation loss decreased (inf --> -0.721603).  Saving model ...
Epoch: 2 cost time: 2.504225015640259
Epoch: 2, Steps: 17 | Train Loss: 1.301 Vali Loss: 0.994 Vali Acc: 0.908 Test Loss: 0.994 Test Acc: 0.908
Validation loss decreased (-0.721603 --> -0.908098).  Saving model ...
Epoch: 3 cost time: 2.551889657974243
Epoch: 3, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.368 Vali Acc: 0.938 Test Loss: 0.368 Test Acc: 0.938
Validation loss decreased (-0.908098 --> -0.937834).  Saving model ...
Epoch: 4 cost time: 2.572676420211792
Epoch: 4, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
Validation loss decreased (-0.937834 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 2.3213233947753906
Epoch: 5, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 2.3317763805389404
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.956755 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 2.289977550506592
Epoch: 7, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1333587169647217
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.084087610244751
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0259227752685547
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.827399492263794
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3423240184783936
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.228994369506836
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.244032144546509
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4522180557250977
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.588747262954712
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1263113
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.046158790588379
Epoch: 1, Steps: 17 | Train Loss: 2.077 Vali Loss: 1.944 Vali Acc: 0.584 Test Loss: 1.944 Test Acc: 0.584
Validation loss decreased (inf --> -0.583764).  Saving model ...
Epoch: 2 cost time: 2.6877219676971436
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.220 Vali Acc: 0.876 Test Loss: 1.220 Test Acc: 0.876
Validation loss decreased (-0.583764 --> -0.875663).  Saving model ...
Epoch: 3 cost time: 2.5409889221191406
Epoch: 3, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.534 Vali Acc: 0.919 Test Loss: 0.534 Test Acc: 0.919
Validation loss decreased (-0.875663 --> -0.918914).  Saving model ...
Epoch: 4 cost time: 2.436821699142456
Epoch: 4, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.252 Vali Acc: 0.949 Test Loss: 0.252 Test Acc: 0.949
Validation loss decreased (-0.918914 --> -0.948646).  Saving model ...
Epoch: 5 cost time: 2.19459867477417
Epoch: 5, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.948646 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 2.1290931701660156
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975674).  Saving model ...
Epoch: 7 cost time: 2.1381044387817383
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.3338623046875
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.4272985458374023
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 2.39766263961792
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5273406505584717
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.483950138092041
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 2.4515323638916016
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.341067314147949
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 2.325395345687866
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 2.38163685798645
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3719398975372314
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5085806846618652
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6654064655303955
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.627938985824585
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.42360782623291
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5813848972320557
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4840002059936523
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.683255910873413
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5535144805908203
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1235593
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.854754686355591
Epoch: 1, Steps: 17 | Train Loss: 2.075 Vali Loss: 1.961 Vali Acc: 0.662 Test Loss: 1.961 Test Acc: 0.662
Validation loss decreased (inf --> -0.662143).  Saving model ...
Epoch: 2 cost time: 2.2082056999206543
Epoch: 2, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.253 Vali Acc: 0.862 Test Loss: 1.253 Test Acc: 0.862
Validation loss decreased (-0.662143 --> -0.862150).  Saving model ...
Epoch: 3 cost time: 2.376795530319214
Epoch: 3, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.544 Vali Acc: 0.941 Test Loss: 0.544 Test Acc: 0.941
Validation loss decreased (-0.862150 --> -0.940535).  Saving model ...
Epoch: 4 cost time: 2.4035472869873047
Epoch: 4, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.243 Vali Acc: 0.962 Test Loss: 0.243 Test Acc: 0.962
Validation loss decreased (-0.940535 --> -0.962160).  Saving model ...
Epoch: 5 cost time: 2.347851037979126
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3371827602386475
Epoch: 6, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.962160 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 2.417180061340332
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.4131226539611816
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.380563735961914
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 2.3558349609375
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 2.495143413543701
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4012742042541504
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5588955879211426
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.649967670440674
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5257277488708496
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4124526977539062
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3454225063323975
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3827123641967773
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 2.257082462310791
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 20 cost time: 2.3789520263671875
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3932156562805176
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2696681022644043
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4099254608154297
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 24 cost time: 2.576977491378784
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4160969257354736
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 2.4184844493865967
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3594019412994385
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.241858959197998
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2897558212280273
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4325132369995117
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2810535430908203
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.667703866958618
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.4996020793914795
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.479987859725952
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.372427225112915
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1235657
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.69213604927063
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.025 Vali Acc: 0.511 Test Loss: 2.025 Test Acc: 0.511
Validation loss decreased (inf --> -0.510791).  Saving model ...
Epoch: 2 cost time: 2.1988236904144287
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.444 Vali Acc: 0.830 Test Loss: 1.444 Test Acc: 0.830
Validation loss decreased (-0.510791 --> -0.829715).  Saving model ...
Epoch: 3 cost time: 2.303833246231079
Epoch: 3, Steps: 17 | Train Loss: 0.984 Vali Loss: 0.767 Vali Acc: 0.911 Test Loss: 0.767 Test Acc: 0.911
Validation loss decreased (-0.829715 --> -0.910803).  Saving model ...
Epoch: 4 cost time: 2.1881656646728516
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.372 Vali Acc: 0.927 Test Loss: 0.372 Test Acc: 0.927
Validation loss decreased (-0.910803 --> -0.927023).  Saving model ...
Epoch: 5 cost time: 2.326227903366089
Epoch: 5, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.927023 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 2.3674070835113525
Epoch: 6, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 2.200317144393921
Epoch: 7, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3212151527404785
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 2.1136631965637207
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.2532765865325928
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 2.286923885345459
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.540386199951172
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.387986421585083
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3548026084899902
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3188138008117676
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.335226058959961
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4469096660614014
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3450348377227783
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4780361652374268
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.462878942489624
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1221961
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6378512382507324
Epoch: 1, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.879 Vali Acc: 0.692 Test Loss: 1.879 Test Acc: 0.692
Validation loss decreased (inf --> -0.691873).  Saving model ...
Epoch: 2 cost time: 2.0496151447296143
Epoch: 2, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.018 Vali Acc: 0.892 Test Loss: 1.018 Test Acc: 0.892
Validation loss decreased (-0.691873 --> -0.891882).  Saving model ...
Epoch: 3 cost time: 2.0884616374969482
Epoch: 3, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.388 Vali Acc: 0.941 Test Loss: 0.388 Test Acc: 0.941
Validation loss decreased (-0.891882 --> -0.940537).  Saving model ...
Epoch: 4 cost time: 2.1535611152648926
Epoch: 4, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.940537 --> -0.970268).  Saving model ...
Epoch: 5 cost time: 1.8391411304473877
Epoch: 5, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.091945171356201
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.2850089073181152
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.091574192047119
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 2.119614601135254
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9107589721679688
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.877701997756958
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1753523349761963
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 2.258188247680664
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.195662498474121
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0881998538970947
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2492873668670654
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3354363441467285
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.376098394393921
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.069768190383911
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.054354190826416
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3416879177093506
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1066765785217285
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 436937
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6653478145599365
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 1.976 Vali Acc: 0.581 Test Loss: 1.976 Test Acc: 0.581
Validation loss decreased (inf --> -0.581061).  Saving model ...
Epoch: 2 cost time: 2.237546920776367
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.190 Vali Acc: 0.905 Test Loss: 1.190 Test Acc: 0.905
Validation loss decreased (-0.581061 --> -0.905394).  Saving model ...
Epoch: 3 cost time: 2.2510030269622803
Epoch: 3, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.477 Vali Acc: 0.951 Test Loss: 0.477 Test Acc: 0.951
Validation loss decreased (-0.905394 --> -0.951347).  Saving model ...
Epoch: 4 cost time: 2.2757270336151123
Epoch: 4, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
Validation loss decreased (-0.951347 --> -0.956755).  Saving model ...
Epoch: 5 cost time: 2.3272342681884766
Epoch: 5, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.956755 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.384211778640747
Epoch: 6, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4751272201538086
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 2.172508716583252
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 1.814453363418579
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0426337718963623
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.884472370147705
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0726065635681152
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.112708806991577
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1406362056732178
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2085540294647217
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3371388912200928
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4581146240234375
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3478446006774902
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 436969
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.788698196411133
Epoch: 1, Steps: 17 | Train Loss: 2.124 Vali Loss: 2.054 Vali Acc: 0.376 Test Loss: 2.054 Test Acc: 0.376
Validation loss decreased (inf --> -0.375655).  Saving model ...
Epoch: 2 cost time: 1.8107612133026123
Epoch: 2, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.573 Vali Acc: 0.857 Test Loss: 1.573 Test Acc: 0.857
Validation loss decreased (-0.375655 --> -0.856741).  Saving model ...
Epoch: 3 cost time: 1.963669776916504
Epoch: 3, Steps: 17 | Train Loss: 1.147 Vali Loss: 0.952 Vali Acc: 0.900 Test Loss: 0.952 Test Acc: 0.900
Validation loss decreased (-0.856741 --> -0.899990).  Saving model ...
Epoch: 4 cost time: 2.097362518310547
Epoch: 4, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.515 Vali Acc: 0.927 Test Loss: 0.515 Test Acc: 0.927
Validation loss decreased (-0.899990 --> -0.927022).  Saving model ...
Epoch: 5 cost time: 1.9369773864746094
Epoch: 5, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.287 Vali Acc: 0.951 Test Loss: 0.287 Test Acc: 0.951
Validation loss decreased (-0.927022 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 1.9623682498931885
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959457).  Saving model ...
Epoch: 7 cost time: 1.9906671047210693
Epoch: 7, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 2.154716730117798
Epoch: 8, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0937397480010986
Epoch: 9, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 2.02744197845459
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.039707660675049
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0678281784057617
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.257450580596924
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2159264087677
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.31697940826416
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.36421537399292
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2531282901763916
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.162750005722046
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0064504146575928
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 381705
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4132277965545654
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.061 Vali Acc: 0.376 Test Loss: 2.061 Test Acc: 0.376
Validation loss decreased (inf --> -0.375655).  Saving model ...
Epoch: 2 cost time: 2.0015366077423096
Epoch: 2, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.689 Vali Acc: 0.795 Test Loss: 1.689 Test Acc: 0.795
Validation loss decreased (-0.375655 --> -0.794578).  Saving model ...
Epoch: 3 cost time: 2.0204803943634033
Epoch: 3, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.175 Vali Acc: 0.886 Test Loss: 1.175 Test Acc: 0.886
Validation loss decreased (-0.794578 --> -0.886475).  Saving model ...
Epoch: 4 cost time: 1.9413597583770752
Epoch: 4, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.699 Vali Acc: 0.922 Test Loss: 0.699 Test Acc: 0.922
Validation loss decreased (-0.886475 --> -0.921615).  Saving model ...
Epoch: 5 cost time: 2.0016872882843018
Epoch: 5, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.403 Vali Acc: 0.941 Test Loss: 0.403 Test Acc: 0.941
Validation loss decreased (-0.921615 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 2.1836142539978027
Epoch: 6, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.264 Vali Acc: 0.968 Test Loss: 0.264 Test Acc: 0.968
Validation loss decreased (-0.940537 --> -0.967565).  Saving model ...
Epoch: 7 cost time: 1.9632537364959717
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0401508808135986
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.9153711795806885
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.811497688293457
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.6810462474822998
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.7779872417449951
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 1.6976556777954102
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.0606579780578613
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 15 cost time: 2.0567336082458496
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.136143684387207
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2260940074920654
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0938334465026855
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 2.2814292907714844
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2398154735565186
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 21 cost time: 2.311183452606201
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2414445877075195
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2235701084136963
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9508371353149414
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9811460971832275
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.909092903137207
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 27 cost time: 1.797602891921997
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.942918062210083
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7691068649291992
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8165521621704102
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.988656759262085
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.045245409011841
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.095611572265625
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.1389966011047363
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.1445252895355225
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.0386745929718018
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 367945
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.558884620666504
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.111 Vali Acc: 0.351 Test Loss: 2.111 Test Acc: 0.351
Validation loss decreased (inf --> -0.351330).  Saving model ...
Epoch: 2 cost time: 1.9011383056640625
Epoch: 2, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.732 Vali Acc: 0.776 Test Loss: 1.732 Test Acc: 0.776
Validation loss decreased (-0.351330 --> -0.775658).  Saving model ...
Epoch: 3 cost time: 1.6935532093048096
Epoch: 3, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.194 Vali Acc: 0.878 Test Loss: 1.194 Test Acc: 0.878
Validation loss decreased (-0.775658 --> -0.878366).  Saving model ...
Epoch: 4 cost time: 1.725966215133667
Epoch: 4, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.681 Vali Acc: 0.922 Test Loss: 0.681 Test Acc: 0.922
Validation loss decreased (-0.878366 --> -0.921615).  Saving model ...
Epoch: 5 cost time: 1.7634992599487305
Epoch: 5, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.387 Vali Acc: 0.941 Test Loss: 0.387 Test Acc: 0.941
Validation loss decreased (-0.921615 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 1.8551764488220215
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.250 Vali Acc: 0.954 Test Loss: 0.250 Test Acc: 0.954
Validation loss decreased (-0.940537 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 1.8647611141204834
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 1.7828211784362793
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.8164253234863281
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.090048313140869
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.930894374847412
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.1172478199005127
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.186457633972168
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.0195562839508057
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.889352798461914
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.791299819946289
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.8785884380340576
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.872541904449463
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8785555362701416
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8161430358886719
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8908123970031738
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.13493013381958
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.105628252029419
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 24 cost time: 2.016894578933716
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9991140365600586
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0493361949920654
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6757056713104248
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9520564079284668
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9947795867919922
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7364177703857422
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.868422031402588
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9924848079681396
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8610131740570068
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 367977
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3843915462493896
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.108 Vali Acc: 0.295 Test Loss: 2.108 Test Acc: 0.295
Validation loss decreased (inf --> -0.294574).  Saving model ...
Epoch: 2 cost time: 1.899956226348877
Epoch: 2, Steps: 17 | Train Loss: 1.909 Vali Loss: 1.794 Vali Acc: 0.708 Test Loss: 1.794 Test Acc: 0.708
Validation loss decreased (-0.294574 --> -0.708090).  Saving model ...
Epoch: 3 cost time: 1.6666126251220703
Epoch: 3, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.345 Vali Acc: 0.862 Test Loss: 1.345 Test Acc: 0.862
Validation loss decreased (-0.708090 --> -0.862149).  Saving model ...
Epoch: 4 cost time: 1.8133649826049805
Epoch: 4, Steps: 17 | Train Loss: 1.043 Vali Loss: 0.890 Vali Acc: 0.897 Test Loss: 0.890 Test Acc: 0.897
Validation loss decreased (-0.862149 --> -0.897288).  Saving model ...
Epoch: 5 cost time: 1.8561675548553467
Epoch: 5, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.564 Vali Acc: 0.924 Test Loss: 0.564 Test Acc: 0.924
Validation loss decreased (-0.897288 --> -0.924319).  Saving model ...
Epoch: 6 cost time: 1.9379465579986572
Epoch: 6, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.357 Vali Acc: 0.946 Test Loss: 0.357 Test Acc: 0.946
Validation loss decreased (-0.924319 --> -0.945942).  Saving model ...
Epoch: 7 cost time: 1.759303092956543
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.246 Vali Acc: 0.976 Test Loss: 0.246 Test Acc: 0.976
Validation loss decreased (-0.945942 --> -0.975673).  Saving model ...
Epoch: 8 cost time: 1.8935062885284424
Epoch: 8, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
Validation loss decreased (-0.975673 --> -0.978376).  Saving model ...
Epoch: 9 cost time: 1.6582236289978027
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.164 Vali Acc: 0.978 Test Loss: 0.164 Test Acc: 0.978
Validation loss decreased (-0.978376 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 1.8560819625854492
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.738797664642334
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 1.6945769786834717
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 1.8629107475280762
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 1.8550500869750977
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.883023977279663
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 1.9317026138305664
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 1.8312017917633057
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 1.950538158416748
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9466273784637451
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8478515148162842
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.842585802078247
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.765183687210083
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8721096515655518
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8003580570220947
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8415722846984863
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7133893966674805
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6658785343170166
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 361129
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.06987738609314
Epoch: 1, Steps: 17 | Train Loss: 1.204 Vali Loss: 0.360 Vali Acc: 0.941 Test Loss: 0.360 Test Acc: 0.941
Validation loss decreased (inf --> -0.940537).  Saving model ...
Epoch: 2 cost time: 2.5273537635803223
Epoch: 2, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.630645751953125
Epoch: 3, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.940537 --> -0.975675).  Saving model ...
Epoch: 4 cost time: 2.62400221824646
Epoch: 4, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.464535713195801
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.631615400314331
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.425215721130371
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6726555824279785
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5259974002838135
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5046274662017822
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.951 Test Loss: 0.227 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1724414825439453
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2483017444610596
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.318 Vali Acc: 0.816 Test Loss: 1.318 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.416472911834717
Epoch: 13, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.433 Vali Acc: 0.927 Test Loss: 0.433 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 4182537
model size : 16.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.325949668884277
Epoch: 1, Steps: 17 | Train Loss: 1.355 Vali Loss: 0.458 Vali Acc: 0.908 Test Loss: 0.458 Test Acc: 0.908
Validation loss decreased (inf --> -0.908104).  Saving model ...
Epoch: 2 cost time: 2.482123851776123
Epoch: 2, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.908104 --> -0.964864).  Saving model ...
Epoch: 3 cost time: 2.6780545711517334
Epoch: 3, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.158 Vali Acc: 0.935 Test Loss: 0.158 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3170151710510254
Epoch: 4, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.445993185043335
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2876152992248535
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.943 Test Loss: 0.260 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2376177310943604
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.418175458908081
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 2.0261893272399902
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 10 cost time: 2.2450907230377197
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4094183444976807
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 2.09525465965271
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 13 cost time: 2.250196695327759
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 2.369051456451416
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 2.5352354049682617
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 16 cost time: 2.5700807571411133
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 17 cost time: 2.6197078227996826
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 18 cost time: 2.5154917240142822
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5176432132720947
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4146926403045654
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.423821449279785
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.3838484287261963
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 2.4517104625701904
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.4796714782714844
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 2.4480316638946533
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 2.4277474880218506
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.5342612266540527
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4408257007598877
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 2.500767230987549
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.435915470123291
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.3044075965881348
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 2.216346025466919
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.423813581466675
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.24316668510437
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.429335117340088
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 2.4695029258728027
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 2.6853928565979004
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.728271961212158
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 2.523953676223755
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 2.345586061477661
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.3299596309661865
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4254794120788574
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.3414454460144043
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.4316275119781494
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 2.452120780944824
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.4389805793762207
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.546058177947998
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 48 cost time: 2.497739791870117
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.4337406158447266
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 50 cost time: 2.542928457260132
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 4182793
model size : 16.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.636951446533203
Epoch: 1, Steps: 17 | Train Loss: 1.608 Vali Loss: 0.822 Vali Acc: 0.927 Test Loss: 0.822 Test Acc: 0.927
Validation loss decreased (inf --> -0.927019).  Saving model ...
Epoch: 2 cost time: 2.0995867252349854
Epoch: 2, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
Validation loss decreased (-0.927019 --> -0.964863).  Saving model ...
Epoch: 3 cost time: 2.006340742111206
Epoch: 3, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 4 cost time: 2.236447811126709
Epoch: 4, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 5 cost time: 2.136178731918335
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4394404888153076
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.241264820098877
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.2990517616271973
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1269145011901855
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.331717014312744
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4823343753814697
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.267735242843628
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2689263820648193
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1971287727355957
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2740237712860107
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.343191385269165
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2345705032348633
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3768329
model size : 14.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7308120727539062
Epoch: 1, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.120 Vali Acc: 0.889 Test Loss: 1.120 Test Acc: 0.889
Validation loss decreased (inf --> -0.889178).  Saving model ...
Epoch: 2 cost time: 2.2040305137634277
Epoch: 2, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.290 Vali Acc: 0.932 Test Loss: 0.290 Test Acc: 0.932
Validation loss decreased (-0.889178 --> -0.932430).  Saving model ...
Epoch: 3 cost time: 2.1100149154663086
Epoch: 3, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.932430 --> -0.964864).  Saving model ...
Epoch: 4 cost time: 2.0866496562957764
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.192439079284668
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2911994457244873
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 7 cost time: 2.282447576522827
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4075303077697754
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 9 cost time: 2.3418450355529785
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3478946685791016
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.27504301071167
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 2.3014469146728516
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.261723518371582
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.362267017364502
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.3045811653137207
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2449417114257812
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1268820762634277
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.11358904838562
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1897332668304443
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.437575340270996
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3844850063323975
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.542764902114868
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3826117515563965
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3654112815856934
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 3630601
model size : 13.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5505659580230713
Epoch: 1, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.139 Vali Acc: 0.892 Test Loss: 1.139 Test Acc: 0.892
Validation loss decreased (inf --> -0.891880).  Saving model ...
Epoch: 2 cost time: 2.162024974822998
Epoch: 2, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.275 Vali Acc: 0.962 Test Loss: 0.275 Test Acc: 0.962
Validation loss decreased (-0.891880 --> -0.962159).  Saving model ...
Epoch: 3 cost time: 2.165980577468872
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.962159 --> -0.970269).  Saving model ...
Epoch: 4 cost time: 2.1994659900665283
Epoch: 4, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 2.2468464374542236
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 2.311307191848755
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 2.179957151412964
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.142030954360962
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.298414707183838
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.156930685043335
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.067952871322632
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0948448181152344
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9334602355957031
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0010342597961426
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0297181606292725
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0651493072509766
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 3630857
model size : 13.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.795692205429077
Epoch: 1, Steps: 17 | Train Loss: 1.772 Vali Loss: 1.302 Vali Acc: 0.849 Test Loss: 1.302 Test Acc: 0.849
Validation loss decreased (inf --> -0.848636).  Saving model ...
Epoch: 2 cost time: 2.243644952774048
Epoch: 2, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.357 Vali Acc: 0.943 Test Loss: 0.357 Test Acc: 0.943
Validation loss decreased (-0.848636 --> -0.943240).  Saving model ...
Epoch: 3 cost time: 2.0699429512023926
Epoch: 3, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.943240 --> -0.959458).  Saving model ...
Epoch: 4 cost time: 1.9810361862182617
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.959458 --> -0.978377).  Saving model ...
Epoch: 5 cost time: 2.0121870040893555
Epoch: 5, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9155757427215576
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0354011058807373
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.046522855758667
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1416921615600586
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0962748527526855
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1041510105133057
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.183040142059326
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.152219772338867
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9922101497650146
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 3576073
model size : 13.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1875014305114746
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 0.669 Vali Acc: 0.946 Test Loss: 0.669 Test Acc: 0.946
Validation loss decreased (inf --> -0.945939).  Saving model ...
Epoch: 2 cost time: 1.669060468673706
Epoch: 2, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
Validation loss decreased (-0.945939 --> -0.954052).  Saving model ...
Epoch: 3 cost time: 1.7573025226593018
Epoch: 3, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 4 cost time: 1.5764617919921875
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.962161 --> -0.978378).  Saving model ...
Epoch: 5 cost time: 1.6643755435943604
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7160694599151611
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7589657306671143
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9415671825408936
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8331925868988037
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.743661642074585
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6861670017242432
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6200337409973145
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.768786907196045
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5803210735321045
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 1.5910909175872803
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6507062911987305
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8084490299224854
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6485402584075928
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.66093111038208
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8632924556732178
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6319317817687988
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9289772510528564
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7045481204986572
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7989201545715332
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1304841
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.196819543838501
Epoch: 1, Steps: 17 | Train Loss: 1.557 Vali Loss: 0.741 Vali Acc: 0.900 Test Loss: 0.741 Test Acc: 0.900
Validation loss decreased (inf --> -0.899993).  Saving model ...
Epoch: 2 cost time: 1.794609785079956
Epoch: 2, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
Validation loss decreased (-0.899993 --> -0.945944).  Saving model ...
Epoch: 3 cost time: 1.7107133865356445
Epoch: 3, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.945944 --> -0.962161).  Saving model ...
Epoch: 4 cost time: 1.6817471981048584
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 5 cost time: 1.7028801441192627
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 1.834122657775879
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.916764736175537
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.7837488651275635
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7207012176513672
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.777662992477417
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7806575298309326
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6787261962890625
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8189582824707031
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7446904182434082
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7352509498596191
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6983036994934082
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8429689407348633
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1304969
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0559654235839844
Epoch: 1, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.331 Vali Acc: 0.832 Test Loss: 1.331 Test Acc: 0.832
Validation loss decreased (inf --> -0.832419).  Saving model ...
Epoch: 2 cost time: 1.4085958003997803
Epoch: 2, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.340 Vali Acc: 0.951 Test Loss: 0.340 Test Acc: 0.951
Validation loss decreased (-0.832419 --> -0.951348).  Saving model ...
Epoch: 3 cost time: 1.4669818878173828
Epoch: 3, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.951348 --> -0.970269).  Saving model ...
Epoch: 4 cost time: 1.4658374786376953
Epoch: 4, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.262132167816162
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 1.6426169872283936
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6598095893859863
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7624084949493408
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.770869493484497
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7150108814239502
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6545753479003906
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6592984199523926
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5528407096862793
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6441099643707275
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.728600263595581
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1097737
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2954516410827637
Epoch: 1, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.519 Vali Acc: 0.819 Test Loss: 1.519 Test Acc: 0.819
Validation loss decreased (inf --> -0.818904).  Saving model ...
Epoch: 2 cost time: 1.7371330261230469
Epoch: 2, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.545 Vali Acc: 0.943 Test Loss: 0.545 Test Acc: 0.943
Validation loss decreased (-0.818904 --> -0.943238).  Saving model ...
Epoch: 3 cost time: 1.6991560459136963
Epoch: 3, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.230 Vali Acc: 0.962 Test Loss: 0.230 Test Acc: 0.962
Validation loss decreased (-0.943238 --> -0.962160).  Saving model ...
Epoch: 4 cost time: 1.8368463516235352
Epoch: 4, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.962160 --> -0.972971).  Saving model ...
Epoch: 5 cost time: 1.71563720703125
Epoch: 5, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 1.7052867412567139
Epoch: 6, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 1.6444730758666992
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6594102382659912
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 1.6302740573883057
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5405147075653076
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7256138324737549
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.578620195388794
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.304487705230713
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6230320930480957
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6495089530944824
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.755936622619629
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5163979530334473
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5115976333618164
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1028873
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.939244270324707
Epoch: 1, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.540 Vali Acc: 0.805 Test Loss: 1.540 Test Acc: 0.805
Validation loss decreased (inf --> -0.805390).  Saving model ...
Epoch: 2 cost time: 1.5388014316558838
Epoch: 2, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.550 Vali Acc: 0.927 Test Loss: 0.550 Test Acc: 0.927
Validation loss decreased (-0.805390 --> -0.927022).  Saving model ...
Epoch: 3 cost time: 1.6152000427246094
Epoch: 3, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.221 Vali Acc: 0.965 Test Loss: 0.221 Test Acc: 0.965
Validation loss decreased (-0.927022 --> -0.964863).  Saving model ...
Epoch: 4 cost time: 1.569887399673462
Epoch: 4, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.633800745010376
Epoch: 5, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 1.572129487991333
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5557756423950195
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.5509302616119385
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5653228759765625
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5837743282318115
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.6347019672393799
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.563990592956543
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 1.6157386302947998
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5218336582183838
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.598055362701416
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5858988761901855
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5811362266540527
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.6322550773620605
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6383452415466309
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7602171897888184
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6414737701416016
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 1.606424331665039
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6815991401672363
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6056299209594727
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.615030288696289
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4060163497924805
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6267247200012207
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.450286626815796
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4256641864776611
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5333960056304932
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4185917377471924
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1029001
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1144161224365234
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.643 Vali Acc: 0.708 Test Loss: 1.643 Test Acc: 0.708
Validation loss decreased (inf --> -0.708092).  Saving model ...
Epoch: 2 cost time: 1.613996982574463
Epoch: 2, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.715 Vali Acc: 0.889 Test Loss: 0.715 Test Acc: 0.889
Validation loss decreased (-0.708092 --> -0.889182).  Saving model ...
Epoch: 3 cost time: 1.6311125755310059
Epoch: 3, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.311 Vali Acc: 0.951 Test Loss: 0.311 Test Acc: 0.951
Validation loss decreased (-0.889182 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 1.5620479583740234
Epoch: 4, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.202 Vali Acc: 0.965 Test Loss: 0.202 Test Acc: 0.965
Validation loss decreased (-0.951348 --> -0.964863).  Saving model ...
Epoch: 5 cost time: 1.5119199752807617
Epoch: 5, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
Validation loss decreased (-0.964863 --> -0.981080).  Saving model ...
Epoch: 6 cost time: 1.612205982208252
Epoch: 6, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 1.5376489162445068
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5662405490875244
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.984 Test Loss: 0.107 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 9 cost time: 1.621553659439087
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7527532577514648
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7216293811798096
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.735433578491211
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7210488319396973
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7263619899749756
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6366713047027588
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.637035608291626
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5620794296264648
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.674161672592163
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 1001609
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0989394187927246
Epoch: 1, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.228 Vali Acc: 0.859 Test Loss: 1.228 Test Acc: 0.859
Validation loss decreased (inf --> -0.859447).  Saving model ...
Epoch: 2 cost time: 1.569439172744751
Epoch: 2, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.334 Vali Acc: 0.941 Test Loss: 0.334 Test Acc: 0.941
Validation loss decreased (-0.859447 --> -0.940537).  Saving model ...
Epoch: 3 cost time: 1.5701446533203125
Epoch: 3, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.940537 --> -0.967566).  Saving model ...
Epoch: 4 cost time: 1.688525676727295
Epoch: 4, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
Validation loss decreased (-0.967566 --> -0.981080).  Saving model ...
Epoch: 5 cost time: 1.6754560470581055
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5934038162231445
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4439630508422852
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5116791725158691
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3878264427185059
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3545377254486084
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.371561050415039
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5298359394073486
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3801229000091553
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5294568538665771
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 455817
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.533050775527954
Epoch: 1, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.267 Vali Acc: 0.843 Test Loss: 1.267 Test Acc: 0.843
Validation loss decreased (inf --> -0.843231).  Saving model ...
Epoch: 2 cost time: 1.5406208038330078
Epoch: 2, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.355 Vali Acc: 0.932 Test Loss: 0.355 Test Acc: 0.932
Validation loss decreased (-0.843231 --> -0.932429).  Saving model ...
Epoch: 3 cost time: 1.492668867111206
Epoch: 3, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.932429 --> -0.970269).  Saving model ...
Epoch: 4 cost time: 1.49503755569458
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.544879674911499
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 1.5786693096160889
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6283926963806152
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.6320490837097168
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4898250102996826
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.5870540142059326
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.5910453796386719
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.764892339706421
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6037638187408447
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7399966716766357
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5755565166473389
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7415673732757568
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6060099601745605
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7451109886169434
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4934666156768799
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4380786418914795
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 455881
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4220364093780518
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.617 Vali Acc: 0.795 Test Loss: 1.617 Test Acc: 0.795
Validation loss decreased (inf --> -0.794578).  Saving model ...
Epoch: 2 cost time: 1.6552786827087402
Epoch: 2, Steps: 17 | Train Loss: 0.972 Vali Loss: 0.712 Vali Acc: 0.919 Test Loss: 0.712 Test Acc: 0.919
Validation loss decreased (-0.794578 --> -0.918912).  Saving model ...
Epoch: 3 cost time: 1.5882184505462646
Epoch: 3, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.312 Vali Acc: 0.943 Test Loss: 0.312 Test Acc: 0.943
Validation loss decreased (-0.918912 --> -0.943240).  Saving model ...
Epoch: 4 cost time: 1.5403938293457031
Epoch: 4, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 1.5265865325927734
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 1.4089500904083252
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975674).  Saving model ...
Epoch: 7 cost time: 1.4318692684173584
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4520294666290283
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5256307125091553
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5105903148651123
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4194529056549072
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4318106174468994
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5600998401641846
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5256681442260742
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8260302543640137
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5882678031921387
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 352265
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.051112174987793
Epoch: 1, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.800 Vali Acc: 0.616 Test Loss: 1.800 Test Acc: 0.616
Validation loss decreased (inf --> -0.616198).  Saving model ...
Epoch: 2 cost time: 1.6402325630187988
Epoch: 2, Steps: 17 | Train Loss: 1.222 Vali Loss: 0.987 Vali Acc: 0.878 Test Loss: 0.987 Test Acc: 0.878
Validation loss decreased (-0.616198 --> -0.878369).  Saving model ...
Epoch: 3 cost time: 1.4638853073120117
Epoch: 3, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.487 Vali Acc: 0.938 Test Loss: 0.487 Test Acc: 0.938
Validation loss decreased (-0.878369 --> -0.937833).  Saving model ...
Epoch: 4 cost time: 1.5258002281188965
Epoch: 4, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.292 Vali Acc: 0.951 Test Loss: 0.292 Test Acc: 0.951
Validation loss decreased (-0.937833 --> -0.951348).  Saving model ...
Epoch: 5 cost time: 1.6507916450500488
Epoch: 5, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.204 Vali Acc: 0.976 Test Loss: 0.204 Test Acc: 0.976
Validation loss decreased (-0.951348 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 1.6905465126037598
Epoch: 6, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 7 cost time: 1.6968114376068115
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 1.8397023677825928
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 1.6310396194458008
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 1.8026690483093262
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8129422664642334
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 1.603398084640503
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7070233821868896
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.7585737705230713
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.707899570465088
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6452703475952148
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7395200729370117
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7551825046539307
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7121953964233398
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8218436241149902
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7283880710601807
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9188859462738037
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.986208200454712
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 317833
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.486511468887329
Epoch: 1, Steps: 17 | Train Loss: 2.083 Vali Loss: 1.834 Vali Acc: 0.589 Test Loss: 1.834 Test Acc: 0.589
Validation loss decreased (inf --> -0.589171).  Saving model ...
Epoch: 2 cost time: 1.6921443939208984
Epoch: 2, Steps: 17 | Train Loss: 1.241 Vali Loss: 0.971 Vali Acc: 0.897 Test Loss: 0.971 Test Acc: 0.897
Validation loss decreased (-0.589171 --> -0.897288).  Saving model ...
Epoch: 3 cost time: 1.697629451751709
Epoch: 3, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.459 Vali Acc: 0.941 Test Loss: 0.459 Test Acc: 0.941
Validation loss decreased (-0.897288 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 1.5705008506774902
Epoch: 4, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.280 Vali Acc: 0.951 Test Loss: 0.280 Test Acc: 0.951
Validation loss decreased (-0.940536 --> -0.951349).  Saving model ...
Epoch: 5 cost time: 1.847144365310669
Epoch: 5, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
Validation loss decreased (-0.951349 --> -0.970268).  Saving model ...
Epoch: 6 cost time: 1.6155884265899658
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.756385087966919
Epoch: 7, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 1.766176462173462
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 9 cost time: 1.6825110912322998
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 1.6075458526611328
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.768845558166504
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.71608304977417
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5639843940734863
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8486709594726562
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6410934925079346
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5933952331542969
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3942961692810059
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 18 cost time: 1.5237689018249512
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6373543739318848
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7909338474273682
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6308567523956299
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5184032917022705
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4337763786315918
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4218170642852783
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.603175163269043
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5048954486846924
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8157649040222168
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 317897
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.45690655708313
Epoch: 1, Steps: 17 | Train Loss: 2.119 Vali Loss: 1.964 Vali Acc: 0.359 Test Loss: 1.964 Test Acc: 0.359
Validation loss decreased (inf --> -0.359440).  Saving model ...
Epoch: 2 cost time: 1.6289899349212646
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.172 Vali Acc: 0.870 Test Loss: 1.172 Test Acc: 0.870
Validation loss decreased (-0.359440 --> -0.870259).  Saving model ...
Epoch: 3 cost time: 1.401498556137085
Epoch: 3, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.626 Vali Acc: 0.951 Test Loss: 0.626 Test Acc: 0.951
Validation loss decreased (-0.870259 --> -0.951345).  Saving model ...
Epoch: 4 cost time: 1.4251079559326172
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.374 Vali Acc: 0.959 Test Loss: 0.374 Test Acc: 0.959
Validation loss decreased (-0.951345 --> -0.959456).  Saving model ...
Epoch: 5 cost time: 1.3517448902130127
Epoch: 5, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.247 Vali Acc: 0.965 Test Loss: 0.247 Test Acc: 0.965
Validation loss decreased (-0.959456 --> -0.964862).  Saving model ...
Epoch: 6 cost time: 1.6153192520141602
Epoch: 6, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.210 Vali Acc: 0.962 Test Loss: 0.210 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.290201187133789
Epoch: 7, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
Validation loss decreased (-0.964862 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 1.395237922668457
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5953211784362793
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
Validation loss decreased (-0.975674 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 1.7463774681091309
Epoch: 10, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8502197265625
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5437588691711426
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.639204740524292
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7244136333465576
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5221059322357178
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.419274091720581
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6438112258911133
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6694114208221436
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4552674293518066
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 304201
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2705681324005127
Epoch: 1, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.567 Vali Acc: 0.786 Test Loss: 1.567 Test Acc: 0.786
Validation loss decreased (inf --> -0.786471).  Saving model ...
Epoch: 2 cost time: 1.545198678970337
Epoch: 2, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.619 Vali Acc: 0.935 Test Loss: 0.619 Test Acc: 0.935
Validation loss decreased (-0.786471 --> -0.935129).  Saving model ...
Epoch: 3 cost time: 1.4146482944488525
Epoch: 3, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
Validation loss decreased (-0.935129 --> -0.956754).  Saving model ...
Epoch: 4 cost time: 1.4955434799194336
Epoch: 4, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.169 Vali Acc: 0.978 Test Loss: 0.169 Test Acc: 0.978
Validation loss decreased (-0.956754 --> -0.978377).  Saving model ...
Epoch: 5 cost time: 1.561187744140625
Epoch: 5, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6501400470733643
Epoch: 6, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5363314151763916
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6987221240997314
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4125468730926514
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4302735328674316
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5427634716033936
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6135613918304443
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.764641523361206
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6644258499145508
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 178761
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.995159864425659
Epoch: 1, Steps: 17 | Train Loss: 2.019 Vali Loss: 1.636 Vali Acc: 0.765 Test Loss: 1.636 Test Acc: 0.765
Validation loss decreased (inf --> -0.764849).  Saving model ...
Epoch: 2 cost time: 1.5321030616760254
Epoch: 2, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.665 Vali Acc: 0.938 Test Loss: 0.665 Test Acc: 0.938
Validation loss decreased (-0.764849 --> -0.937831).  Saving model ...
Epoch: 3 cost time: 1.597482681274414
Epoch: 3, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.281 Vali Acc: 0.965 Test Loss: 0.281 Test Acc: 0.965
Validation loss decreased (-0.937831 --> -0.964862).  Saving model ...
Epoch: 4 cost time: 1.4258451461791992
Epoch: 4, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4273641109466553
Epoch: 5, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
Validation loss decreased (-0.964862 --> -0.981080).  Saving model ...
Epoch: 6 cost time: 1.3750429153442383
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.611196756362915
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 8 cost time: 1.5616660118103027
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.571497917175293
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7887296676635742
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7475788593292236
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.027956008911133
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9239590167999268
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6516656875610352
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6991877555847168
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6449987888336182
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6607253551483154
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 178793
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5610406398773193
Epoch: 1, Steps: 17 | Train Loss: 2.159 Vali Loss: 1.997 Vali Acc: 0.403 Test Loss: 1.997 Test Acc: 0.403
Validation loss decreased (inf --> -0.402683).  Saving model ...
Epoch: 2 cost time: 1.6189844608306885
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.294 Vali Acc: 0.824 Test Loss: 1.294 Test Acc: 0.824
Validation loss decreased (-0.402683 --> -0.824311).  Saving model ...
Epoch: 3 cost time: 1.5780692100524902
Epoch: 3, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.690 Vali Acc: 0.924 Test Loss: 0.690 Test Acc: 0.924
Validation loss decreased (-0.824311 --> -0.924317).  Saving model ...
Epoch: 4 cost time: 1.8730227947235107
Epoch: 4, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.408 Vali Acc: 0.943 Test Loss: 0.408 Test Acc: 0.943
Validation loss decreased (-0.924317 --> -0.943239).  Saving model ...
Epoch: 5 cost time: 1.6276905536651611
Epoch: 5, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.282 Vali Acc: 0.959 Test Loss: 0.282 Test Acc: 0.959
Validation loss decreased (-0.943239 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 1.4967761039733887
Epoch: 6, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.212 Vali Acc: 0.970 Test Loss: 0.212 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970268).  Saving model ...
Epoch: 7 cost time: 1.484140157699585
Epoch: 7, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2165281772613525
Epoch: 8, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2441353797912598
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
Validation loss decreased (-0.970268 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 1.3259155750274658
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4261090755462646
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5448529720306396
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7610013484954834
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7549595832824707
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.538287878036499
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5974204540252686
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4165759086608887
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.57621431350708
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5048720836639404
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 126985
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9192421436309814
Epoch: 1, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.017 Vali Acc: 0.341 Test Loss: 2.017 Test Acc: 0.341
Validation loss decreased (inf --> -0.340520).  Saving model ...
Epoch: 2 cost time: 1.5910520553588867
Epoch: 2, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.457 Vali Acc: 0.803 Test Loss: 1.457 Test Acc: 0.803
Validation loss decreased (-0.340520 --> -0.802688).  Saving model ...
Epoch: 3 cost time: 1.6394412517547607
Epoch: 3, Steps: 17 | Train Loss: 1.089 Vali Loss: 0.919 Vali Acc: 0.884 Test Loss: 0.919 Test Acc: 0.884
Validation loss decreased (-0.802688 --> -0.883775).  Saving model ...
Epoch: 4 cost time: 1.4700045585632324
Epoch: 4, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.610 Vali Acc: 0.922 Test Loss: 0.610 Test Acc: 0.922
Validation loss decreased (-0.883775 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 1.462388515472412
Epoch: 5, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.410 Vali Acc: 0.943 Test Loss: 0.410 Test Acc: 0.943
Validation loss decreased (-0.921616 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 1.6095662117004395
Epoch: 6, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.312 Vali Acc: 0.957 Test Loss: 0.312 Test Acc: 0.957
Validation loss decreased (-0.943239 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 1.4604105949401855
Epoch: 7, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.258 Vali Acc: 0.959 Test Loss: 0.258 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 1.3911199569702148
Epoch: 8, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970268).  Saving model ...
Epoch: 9 cost time: 1.4034109115600586
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5356199741363525
Epoch: 10, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.169 Vali Acc: 0.978 Test Loss: 0.169 Test Acc: 0.978
Validation loss decreased (-0.970268 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.5986123085021973
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.608139991760254
Epoch: 12, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 1.836240291595459
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.6959259510040283
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6431748867034912
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4563021659851074
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5413379669189453
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5696909427642822
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 1.5982730388641357
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.460031270980835
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5344772338867188
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3310489654541016
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3360812664031982
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8415229320526123
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.70357084274292
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 1.7789249420166016
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6118178367614746
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8788723945617676
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5312349796295166
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5582754611968994
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4993674755096436
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.530195951461792
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6378533840179443
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8025355339050293
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6167089939117432
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 109769
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7876458168029785
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 1.999 Vali Acc: 0.349 Test Loss: 1.999 Test Acc: 0.349
Validation loss decreased (inf --> -0.348629).  Saving model ...
Epoch: 2 cost time: 1.5008549690246582
Epoch: 2, Steps: 17 | Train Loss: 1.596 Vali Loss: 1.451 Vali Acc: 0.776 Test Loss: 1.451 Test Acc: 0.776
Validation loss decreased (-0.348629 --> -0.775661).  Saving model ...
Epoch: 3 cost time: 1.531395435333252
Epoch: 3, Steps: 17 | Train Loss: 1.042 Vali Loss: 0.937 Vali Acc: 0.886 Test Loss: 0.937 Test Acc: 0.886
Validation loss decreased (-0.775661 --> -0.886477).  Saving model ...
Epoch: 4 cost time: 1.4450697898864746
Epoch: 4, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.574 Vali Acc: 0.941 Test Loss: 0.574 Test Acc: 0.941
Validation loss decreased (-0.886477 --> -0.940535).  Saving model ...
Epoch: 5 cost time: 1.519486904144287
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.407 Vali Acc: 0.949 Test Loss: 0.407 Test Acc: 0.949
Validation loss decreased (-0.940535 --> -0.948645).  Saving model ...
Epoch: 6 cost time: 1.51328444480896
Epoch: 6, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.306 Vali Acc: 0.962 Test Loss: 0.306 Test Acc: 0.962
Validation loss decreased (-0.948645 --> -0.962159).  Saving model ...
Epoch: 7 cost time: 1.5235836505889893
Epoch: 7, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.257 Vali Acc: 0.962 Test Loss: 0.257 Test Acc: 0.962
Validation loss decreased (-0.962159 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 1.6303651332855225
Epoch: 8, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
Validation loss decreased (-0.962160 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 1.5982744693756104
Epoch: 9, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975674).  Saving model ...
Epoch: 10 cost time: 1.7736008167266846
Epoch: 10, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6593732833862305
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 12 cost time: 1.5277950763702393
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 13 cost time: 1.6418626308441162
Epoch: 13, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.6966478824615479
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 15 cost time: 1.5100793838500977
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 1.6453588008880615
Epoch: 16, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3741543292999268
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4482471942901611
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4192678928375244
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 1.3948378562927246
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5039339065551758
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 1.5511806011199951
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 23 cost time: 1.9052696228027344
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7147858142852783
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 25 cost time: 1.685065507888794
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5824165344238281
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5546035766601562
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5911281108856201
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4773881435394287
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 30 cost time: 1.540379524230957
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5073397159576416
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.473710060119629
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5446655750274658
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6369061470031738
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5696864128112793
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.55727219581604
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6892871856689453
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6403093338012695
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8060002326965332
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 109801
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3086705207824707
Epoch: 1, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.051 Vali Acc: 0.286 Test Loss: 2.051 Test Acc: 0.286
Validation loss decreased (inf --> -0.286466).  Saving model ...
Epoch: 2 cost time: 1.5988810062408447
Epoch: 2, Steps: 17 | Train Loss: 1.791 Vali Loss: 1.603 Vali Acc: 0.719 Test Loss: 1.603 Test Acc: 0.719
Validation loss decreased (-0.286466 --> -0.718903).  Saving model ...
Epoch: 3 cost time: 1.517336368560791
Epoch: 3, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.151 Vali Acc: 0.862 Test Loss: 1.151 Test Acc: 0.862
Validation loss decreased (-0.718903 --> -0.862151).  Saving model ...
Epoch: 4 cost time: 1.372460126876831
Epoch: 4, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.793 Vali Acc: 0.900 Test Loss: 0.793 Test Acc: 0.900
Validation loss decreased (-0.862151 --> -0.899992).  Saving model ...
Epoch: 5 cost time: 1.7807643413543701
Epoch: 5, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.536 Vali Acc: 0.932 Test Loss: 0.536 Test Acc: 0.932
Validation loss decreased (-0.899992 --> -0.932427).  Saving model ...
Epoch: 6 cost time: 1.5913398265838623
Epoch: 6, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.398 Vali Acc: 0.957 Test Loss: 0.398 Test Acc: 0.957
Validation loss decreased (-0.932427 --> -0.956753).  Saving model ...
Epoch: 7 cost time: 1.6435089111328125
Epoch: 7, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.318 Vali Acc: 0.962 Test Loss: 0.318 Test Acc: 0.962
Validation loss decreased (-0.956753 --> -0.962159).  Saving model ...
Epoch: 8 cost time: 1.5431621074676514
Epoch: 8, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.260 Vali Acc: 0.976 Test Loss: 0.260 Test Acc: 0.976
Validation loss decreased (-0.962159 --> -0.975673).  Saving model ...
Epoch: 9 cost time: 1.581660270690918
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.232 Vali Acc: 0.970 Test Loss: 0.232 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.796053171157837
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7248191833496094
Epoch: 11, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.174 Vali Acc: 0.978 Test Loss: 0.174 Test Acc: 0.978
Validation loss decreased (-0.975673 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 1.7052626609802246
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 1.6271092891693115
Epoch: 13, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.650709629058838
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5211243629455566
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 16 cost time: 1.3856289386749268
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4402894973754883
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 18 cost time: 1.5589795112609863
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 1.212599277496338
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 1.3503880500793457
Epoch: 20, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 21 cost time: 1.301438331604004
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 1.7824277877807617
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 23 cost time: 1.3018269538879395
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7058894634246826
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 25 cost time: 1.561267614364624
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.777090311050415
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 27 cost time: 1.6240344047546387
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7374334335327148
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6672484874725342
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6720635890960693
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7596867084503174
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6579315662384033
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.748718500137329
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.427483081817627
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5176513195037842
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3927326202392578
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 102953
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.9728076457977295
Epoch: 1, Steps: 17 | Train Loss: 2.051 Vali Loss: 1.964 Vali Acc: 0.654 Test Loss: 1.964 Test Acc: 0.654
Validation loss decreased (inf --> -0.654034).  Saving model ...
Epoch: 2 cost time: 3.150750160217285
Epoch: 2, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.086 Vali Acc: 0.908 Test Loss: 1.086 Test Acc: 0.908
Validation loss decreased (-0.654034 --> -0.908097).  Saving model ...
Epoch: 3 cost time: 3.1521413326263428
Epoch: 3, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.329 Vali Acc: 0.943 Test Loss: 0.329 Test Acc: 0.943
Validation loss decreased (-0.908097 --> -0.943240).  Saving model ...
Epoch: 4 cost time: 2.798985004425049
Epoch: 4, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.943240 --> -0.967566).  Saving model ...
Epoch: 5 cost time: 2.730457067489624
Epoch: 5, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.699617862701416
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 2.9354236125946045
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9600932598114014
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 3.2699499130249023
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 3.014181137084961
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.125093698501587
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.964629650115967
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.67913556098938
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8286356925964355
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 2.78489089012146
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0117099285125732
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.240191698074341
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8972113132476807
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.932094097137451
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8331737518310547
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9383225440979004
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8176584243774414
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9670188426971436
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.2023346424102783
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 782537
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.934061527252197
Epoch: 1, Steps: 17 | Train Loss: 2.117 Vali Loss: 2.017 Vali Acc: 0.681 Test Loss: 2.017 Test Acc: 0.681
Validation loss decreased (inf --> -0.681061).  Saving model ...
Epoch: 2 cost time: 3.1038708686828613
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.184 Vali Acc: 0.884 Test Loss: 1.184 Test Acc: 0.884
Validation loss decreased (-0.681061 --> -0.883772).  Saving model ...
Epoch: 3 cost time: 2.711716413497925
Epoch: 3, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.405 Vali Acc: 0.941 Test Loss: 0.405 Test Acc: 0.941
Validation loss decreased (-0.883772 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 2.58447265625
Epoch: 4, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
Validation loss decreased (-0.940536 --> -0.975674).  Saving model ...
Epoch: 5 cost time: 2.6892142295837402
Epoch: 5, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8923134803771973
Epoch: 6, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.928941488265991
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 2.900752305984497
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8431191444396973
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9743709564208984
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 2.9616475105285645
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.89723801612854
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7744524478912354
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.665311574935913
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.79532790184021
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0540332794189453
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.937664747238159
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 2.9213366508483887
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.941467523574829
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7864885330200195
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8777546882629395
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.9195194244384766
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.0225465297698975
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.9004993438720703
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6265945434570312
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5574629306793213
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.7962679862976074
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 782569
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.071835279464722
Epoch: 1, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.106 Vali Acc: 0.395 Test Loss: 2.106 Test Acc: 0.395
Validation loss decreased (inf --> -0.394574).  Saving model ...
Epoch: 2 cost time: 2.850027561187744
Epoch: 2, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.685 Vali Acc: 0.811 Test Loss: 1.685 Test Acc: 0.811
Validation loss decreased (-0.394574 --> -0.810794).  Saving model ...
Epoch: 3 cost time: 2.81705379486084
Epoch: 3, Steps: 17 | Train Loss: 1.216 Vali Loss: 0.964 Vali Acc: 0.876 Test Loss: 0.964 Test Acc: 0.876
Validation loss decreased (-0.810794 --> -0.875666).  Saving model ...
Epoch: 4 cost time: 2.5256426334381104
Epoch: 4, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.438 Vali Acc: 0.951 Test Loss: 0.438 Test Acc: 0.951
Validation loss decreased (-0.875666 --> -0.951347).  Saving model ...
Epoch: 5 cost time: 2.5175373554229736
Epoch: 5, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.238 Vali Acc: 0.946 Test Loss: 0.238 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.672307252883911
Epoch: 6, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.951347 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.7962026596069336
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9618582725524902
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.705641508102417
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.9467735290527344
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5598363876342773
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.684257745742798
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 2.8806374073028564
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.4449820518493652
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6117002964019775
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.851271152496338
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8297903537750244
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.769266366958618
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8809547424316406
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 2.85546612739563
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 2.5666403770446777
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 22 cost time: 2.635809898376465
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.925985813140869
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3856687545776367
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 2.256253719329834
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8808786869049072
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.12481689453125
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.644109010696411
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.7593533992767334
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2736713886260986
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.5849108695983887
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.5042693614959717
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.816624164581299
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.8132081031799316
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 727305
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.576929330825806
Epoch: 1, Steps: 17 | Train Loss: 2.151 Vali Loss: 2.091 Vali Acc: 0.405 Test Loss: 2.091 Test Acc: 0.405
Validation loss decreased (inf --> -0.405384).  Saving model ...
Epoch: 2 cost time: 2.959460496902466
Epoch: 2, Steps: 17 | Train Loss: 1.823 Vali Loss: 1.700 Vali Acc: 0.808 Test Loss: 1.700 Test Acc: 0.808
Validation loss decreased (-0.405384 --> -0.808091).  Saving model ...
Epoch: 3 cost time: 2.4578075408935547
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.105 Vali Acc: 0.886 Test Loss: 1.105 Test Acc: 0.886
Validation loss decreased (-0.808091 --> -0.886475).  Saving model ...
Epoch: 4 cost time: 2.4649546146392822
Epoch: 4, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.580 Vali Acc: 0.922 Test Loss: 0.580 Test Acc: 0.922
Validation loss decreased (-0.886475 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 2.5275144577026367
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.323 Vali Acc: 0.946 Test Loss: 0.323 Test Acc: 0.946
Validation loss decreased (-0.921616 --> -0.945943).  Saving model ...
Epoch: 6 cost time: 2.394747018814087
Epoch: 6, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
Validation loss decreased (-0.945943 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 2.8140060901641846
Epoch: 7, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 2.9445042610168457
Epoch: 8, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.8347556591033936
Epoch: 9, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.794743537902832
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.5945212841033936
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7273125648498535
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6017649173736572
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.483917474746704
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.942856788635254
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 2.7305290699005127
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.064972162246704
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 3.1255292892456055
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.871285915374756
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.75295352935791
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5240683555603027
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6481266021728516
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.549733877182007
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.618426561355591
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.9127471446990967
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.829085111618042
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.963545322418213
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.623819589614868
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.656890392303467
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.73549485206604
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 2.3935089111328125
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.7376976013183594
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.860629081726074
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.7171192169189453
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.062708616256714
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.7182869911193848
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.7140870094299316
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.5532143115997314
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.683748960494995
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.583519220352173
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 713545
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.298028469085693
Epoch: 1, Steps: 17 | Train Loss: 2.096 Vali Loss: 2.071 Vali Acc: 0.438 Test Loss: 2.071 Test Acc: 0.438
Validation loss decreased (inf --> -0.437817).  Saving model ...
Epoch: 2 cost time: 2.4552595615386963
Epoch: 2, Steps: 17 | Train Loss: 1.795 Vali Loss: 1.657 Vali Acc: 0.846 Test Loss: 1.657 Test Acc: 0.846
Validation loss decreased (-0.437817 --> -0.845929).  Saving model ...
Epoch: 3 cost time: 2.226717472076416
Epoch: 3, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.061 Vali Acc: 0.897 Test Loss: 1.061 Test Acc: 0.897
Validation loss decreased (-0.845929 --> -0.897287).  Saving model ...
Epoch: 4 cost time: 2.323160171508789
Epoch: 4, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.565 Vali Acc: 0.930 Test Loss: 0.565 Test Acc: 0.930
Validation loss decreased (-0.897287 --> -0.929724).  Saving model ...
Epoch: 5 cost time: 2.0504040718078613
Epoch: 5, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.303 Vali Acc: 0.954 Test Loss: 0.303 Test Acc: 0.954
Validation loss decreased (-0.929724 --> -0.954051).  Saving model ...
Epoch: 6 cost time: 2.160689353942871
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.192 Vali Acc: 0.968 Test Loss: 0.192 Test Acc: 0.968
Validation loss decreased (-0.954051 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.6029365062713623
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7216720581054688
Epoch: 8, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.6242780685424805
Epoch: 9, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.6757900714874268
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5136396884918213
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.4709534645080566
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.624451160430908
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.5874528884887695
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.8488364219665527
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7871997356414795
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.674922227859497
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 2.749281644821167
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7362565994262695
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6341240406036377
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 2.6004483699798584
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5882415771484375
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6938109397888184
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7249560356140137
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.7610480785369873
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.5158348083496094
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7078754901885986
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3875060081481934
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0625853538513184
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 2.3793487548828125
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.5709872245788574
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.071074962615967
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.789053440093994
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.827054262161255
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.724714994430542
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.6627278327941895
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.3815503120422363
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.2134621143341064
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.069721221923828
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 713577
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.574105262756348
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.110 Vali Acc: 0.335 Test Loss: 2.110 Test Acc: 0.335
Validation loss decreased (inf --> -0.335114).  Saving model ...
Epoch: 2 cost time: 2.5510239601135254
Epoch: 2, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.795 Vali Acc: 0.768 Test Loss: 1.795 Test Acc: 0.768
Validation loss decreased (-0.335114 --> -0.767550).  Saving model ...
Epoch: 3 cost time: 2.3786544799804688
Epoch: 3, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.328 Vali Acc: 0.849 Test Loss: 1.328 Test Acc: 0.849
Validation loss decreased (-0.767550 --> -0.848635).  Saving model ...
Epoch: 4 cost time: 2.5052547454833984
Epoch: 4, Steps: 17 | Train Loss: 0.992 Vali Loss: 0.805 Vali Acc: 0.911 Test Loss: 0.805 Test Acc: 0.911
Validation loss decreased (-0.848635 --> -0.910803).  Saving model ...
Epoch: 5 cost time: 2.390577554702759
Epoch: 5, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.439 Vali Acc: 0.927 Test Loss: 0.439 Test Acc: 0.927
Validation loss decreased (-0.910803 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 2.2343666553497314
Epoch: 6, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.273 Vali Acc: 0.954 Test Loss: 0.273 Test Acc: 0.954
Validation loss decreased (-0.927023 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 2.3548173904418945
Epoch: 7, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 2.534062147140503
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 2.6708552837371826
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 2.911494016647339
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 2.4466474056243896
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.4755587577819824
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.085951566696167
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3142716884613037
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3878750801086426
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 2.414407968521118
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.7373783588409424
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5413105487823486
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7205753326416016
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.965 Test Loss: 0.089 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5296056270599365
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.768714666366577
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.418025255203247
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6321377754211426
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.666351318359375
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.7115566730499268
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.786837577819824
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.791080951690674
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.4868154525756836
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.469442367553711
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 2.452805757522583
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.786695718765259
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8882298469543457
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.793733835220337
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.8033528327941895
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 2.5029709339141846
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.196650505065918
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.282304048538208
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.478503465652466
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.599130630493164
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 40 cost time: 2.8770103454589844
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.9038360118865967
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 42 cost time: 2.677279233932495
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.71287202835083
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.35477614402771
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.628131628036499
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.5236105918884277
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.5199058055877686
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.7179880142211914
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.848480224609375
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.8153767585754395
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 699817
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.238044500350952
Epoch: 1, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.003 Vali Acc: 0.568 Test Loss: 2.003 Test Acc: 0.568
Validation loss decreased (inf --> -0.567548).  Saving model ...
Epoch: 2 cost time: 2.6304352283477783
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.125 Vali Acc: 0.914 Test Loss: 1.125 Test Acc: 0.914
Validation loss decreased (-0.567548 --> -0.913502).  Saving model ...
Epoch: 3 cost time: 2.590482234954834
Epoch: 3, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.346 Vali Acc: 0.943 Test Loss: 0.346 Test Acc: 0.943
Validation loss decreased (-0.913502 --> -0.943240).  Saving model ...
Epoch: 4 cost time: 2.935345411300659
Epoch: 4, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
Validation loss decreased (-0.943240 --> -0.967566).  Saving model ...
Epoch: 5 cost time: 2.734987258911133
Epoch: 5, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.8452465534210205
Epoch: 6, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.7322475910186768
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.970269 --> -0.983783).  Saving model ...
Epoch: 8 cost time: 2.383310079574585
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.501565456390381
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.320303201675415
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.582634210586548
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.364132881164551
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5806732177734375
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9549028873443604
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.819681167602539
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7607691287994385
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.953437089920044
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 771785
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.776604413986206
Epoch: 1, Steps: 17 | Train Loss: 2.101 Vali Loss: 1.973 Vali Acc: 0.632 Test Loss: 1.973 Test Acc: 0.632
Validation loss decreased (inf --> -0.632413).  Saving model ...
Epoch: 2 cost time: 2.8855717182159424
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.150 Vali Acc: 0.911 Test Loss: 1.150 Test Acc: 0.911
Validation loss decreased (-0.632413 --> -0.910799).  Saving model ...
Epoch: 3 cost time: 2.93153977394104
Epoch: 3, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.375 Vali Acc: 0.935 Test Loss: 0.375 Test Acc: 0.935
Validation loss decreased (-0.910799 --> -0.935131).  Saving model ...
Epoch: 4 cost time: 2.7670063972473145
Epoch: 4, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
Validation loss decreased (-0.935131 --> -0.951349).  Saving model ...
Epoch: 5 cost time: 3.066767930984497
Epoch: 5, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964864).  Saving model ...
Epoch: 6 cost time: 2.6585888862609863
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.7165045738220215
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3962979316711426
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 2.41219425201416
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.681201696395874
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.054597854614258
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0452864170074463
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9710354804992676
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.8695566654205322
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.344527244567871
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5099260807037354
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 2.5213959217071533
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2288734912872314
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8688278198242188
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.780566692352295
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.9157016277313232
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.909184455871582
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3458070755004883
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.689922571182251
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 2.330932140350342
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 26 cost time: 2.4183099269866943
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5786287784576416
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.6429293155670166
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.745652914047241
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6715681552886963
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.894815444946289
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.461555004119873
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.627004623413086
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.821194887161255
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.6669654846191406
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 771817
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.249673128128052
Epoch: 1, Steps: 17 | Train Loss: 2.200 Vali Loss: 2.092 Vali Acc: 0.441 Test Loss: 2.092 Test Acc: 0.441
Validation loss decreased (inf --> -0.440520).  Saving model ...
Epoch: 2 cost time: 2.429833173751831
Epoch: 2, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.665 Vali Acc: 0.881 Test Loss: 1.665 Test Acc: 0.881
Validation loss decreased (-0.440520 --> -0.881064).  Saving model ...
Epoch: 3 cost time: 2.2523410320281982
Epoch: 3, Steps: 17 | Train Loss: 1.226 Vali Loss: 0.958 Vali Acc: 0.919 Test Loss: 0.958 Test Acc: 0.919
Validation loss decreased (-0.881064 --> -0.918909).  Saving model ...
Epoch: 4 cost time: 2.4915285110473633
Epoch: 4, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.437 Vali Acc: 0.943 Test Loss: 0.437 Test Acc: 0.943
Validation loss decreased (-0.918909 --> -0.943239).  Saving model ...
Epoch: 5 cost time: 2.2883338928222656
Epoch: 5, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.243 Vali Acc: 0.954 Test Loss: 0.243 Test Acc: 0.954
Validation loss decreased (-0.943239 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 2.543243169784546
Epoch: 6, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.155 Vali Acc: 0.978 Test Loss: 0.155 Test Acc: 0.978
Validation loss decreased (-0.954052 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 2.5567171573638916
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 2.621569871902466
Epoch: 8, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5329477787017822
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 2.343751907348633
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.442349910736084
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.416111946105957
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5236921310424805
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4503867626190186
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.541480779647827
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6817517280578613
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6081292629241943
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7533223628997803
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6738357543945312
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 716553
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.586447477340698
Epoch: 1, Steps: 17 | Train Loss: 2.130 Vali Loss: 2.068 Vali Acc: 0.535 Test Loss: 2.068 Test Acc: 0.535
Validation loss decreased (inf --> -0.535114).  Saving model ...
Epoch: 2 cost time: 2.6091363430023193
Epoch: 2, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.661 Vali Acc: 0.822 Test Loss: 1.661 Test Acc: 0.822
Validation loss decreased (-0.535114 --> -0.821605).  Saving model ...
Epoch: 3 cost time: 2.5875778198242188
Epoch: 3, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.067 Vali Acc: 0.897 Test Loss: 1.067 Test Acc: 0.897
Validation loss decreased (-0.821605 --> -0.897287).  Saving model ...
Epoch: 4 cost time: 2.780435562133789
Epoch: 4, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.550 Vali Acc: 0.924 Test Loss: 0.550 Test Acc: 0.924
Validation loss decreased (-0.897287 --> -0.924319).  Saving model ...
Epoch: 5 cost time: 2.6219236850738525
Epoch: 5, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.314 Vali Acc: 0.951 Test Loss: 0.314 Test Acc: 0.951
Validation loss decreased (-0.924319 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 2.446798801422119
Epoch: 6, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.209 Vali Acc: 0.965 Test Loss: 0.209 Test Acc: 0.965
Validation loss decreased (-0.951348 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 2.3589041233062744
Epoch: 7, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 2.21303653717041
Epoch: 8, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 2.3906524181365967
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.5930936336517334
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7524631023406982
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.6471240520477295
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6518330574035645
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7519545555114746
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.364447832107544
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3406641483306885
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3107776641845703
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4059410095214844
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 2.6193957328796387
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.597348213195801
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6646854877471924
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.745016574859619
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 23 cost time: 2.6437480449676514
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6058480739593506
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4285166263580322
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.369194746017456
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.440537929534912
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4683334827423096
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.569357395172119
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3199000358581543
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2886836528778076
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.106870174407959
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 702793
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.567328453063965
Epoch: 1, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.099 Vali Acc: 0.435 Test Loss: 2.099 Test Acc: 0.435
Validation loss decreased (inf --> -0.435114).  Saving model ...
Epoch: 2 cost time: 2.779694080352783
Epoch: 2, Steps: 17 | Train Loss: 1.855 Vali Loss: 1.749 Vali Acc: 0.811 Test Loss: 1.749 Test Acc: 0.811
Validation loss decreased (-0.435114 --> -0.810793).  Saving model ...
Epoch: 3 cost time: 2.523629665374756
Epoch: 3, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.170 Vali Acc: 0.889 Test Loss: 1.170 Test Acc: 0.889
Validation loss decreased (-0.810793 --> -0.889177).  Saving model ...
Epoch: 4 cost time: 2.4615068435668945
Epoch: 4, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.646 Vali Acc: 0.935 Test Loss: 0.646 Test Acc: 0.935
Validation loss decreased (-0.889177 --> -0.935129).  Saving model ...
Epoch: 5 cost time: 2.1979429721832275
Epoch: 5, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.349 Vali Acc: 0.959 Test Loss: 0.349 Test Acc: 0.959
Validation loss decreased (-0.935129 --> -0.959456).  Saving model ...
Epoch: 6 cost time: 2.447937488555908
Epoch: 6, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.231 Vali Acc: 0.957 Test Loss: 0.231 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3860890865325928
Epoch: 7, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
Validation loss decreased (-0.959456 --> -0.972971).  Saving model ...
Epoch: 8 cost time: 2.705122232437134
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.663539409637451
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.6671204566955566
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7003698348999023
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6162214279174805
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 2.505796432495117
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.337033987045288
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4759867191314697
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7359161376953125
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7723405361175537
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7997169494628906
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 2.450206756591797
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.583428144454956
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.520880699157715
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3601934909820557
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.412726879119873
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.355799436569214
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5454206466674805
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.510413646697998
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.8224568367004395
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.5414602756500244
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 702825
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.706495761871338
Epoch: 1, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.132 Vali Acc: 0.278 Test Loss: 2.132 Test Acc: 0.278
Validation loss decreased (inf --> -0.278357).  Saving model ...
Epoch: 2 cost time: 2.3250157833099365
Epoch: 2, Steps: 17 | Train Loss: 1.930 Vali Loss: 1.823 Vali Acc: 0.776 Test Loss: 1.823 Test Acc: 0.776
Validation loss decreased (-0.278357 --> -0.775657).  Saving model ...
Epoch: 3 cost time: 2.3819522857666016
Epoch: 3, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.317 Vali Acc: 0.884 Test Loss: 1.317 Test Acc: 0.884
Validation loss decreased (-0.775657 --> -0.883771).  Saving model ...
Epoch: 4 cost time: 2.317009210586548
Epoch: 4, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.760 Vali Acc: 0.919 Test Loss: 0.760 Test Acc: 0.919
Validation loss decreased (-0.883771 --> -0.918911).  Saving model ...
Epoch: 5 cost time: 2.6248748302459717
Epoch: 5, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.412 Vali Acc: 0.941 Test Loss: 0.412 Test Acc: 0.941
Validation loss decreased (-0.918911 --> -0.940536).  Saving model ...
Epoch: 6 cost time: 2.7729687690734863
Epoch: 6, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.264 Vali Acc: 0.949 Test Loss: 0.264 Test Acc: 0.949
Validation loss decreased (-0.940536 --> -0.948646).  Saving model ...
Epoch: 7 cost time: 2.8249905109405518
Epoch: 7, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 2.81571102142334
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.7255170345306396
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.572448492050171
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.325002431869507
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.546963691711426
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4051637649536133
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5556814670562744
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6772994995117188
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.507277488708496
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6373939514160156
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7808051109313965
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6146836280822754
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.617835283279419
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.4037325382232666
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4293839931488037
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4383859634399414
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 2.682605743408203
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6135199069976807
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.733818292617798
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.959 Test Loss: 0.086 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.704785108566284
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.152928590774536
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.962 Test Loss: 0.087 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.5184693336486816
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.3789684772491455
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.43668270111084
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.6717100143432617
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.6908891201019287
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 689065
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.919137716293335
Epoch: 1, Steps: 17 | Train Loss: 1.687 Vali Loss: 1.102 Vali Acc: 0.838 Test Loss: 1.102 Test Acc: 0.838
Validation loss decreased (inf --> -0.837827).  Saving model ...
Epoch: 2 cost time: 2.739624261856079
Epoch: 2, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
Validation loss decreased (-0.837827 --> -0.954052).  Saving model ...
Epoch: 3 cost time: 2.7215280532836914
Epoch: 3, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6249775886535645
Epoch: 4, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.954052 --> -0.978378).  Saving model ...
Epoch: 5 cost time: 3.094576835632324
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.125795364379883
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0682907104492188
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9658634662628174
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.978378 --> -0.983783).  Saving model ...
Epoch: 9 cost time: 3.0145771503448486
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.886016845703125
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6857926845550537
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8268611431121826
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9565553665161133
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2269554138183594
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.927902936935425
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8878684043884277
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.760653018951416
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8715908527374268
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 2678537
model size : 10.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.7523462772369385
Epoch: 1, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.230 Vali Acc: 0.881 Test Loss: 1.230 Test Acc: 0.881
Validation loss decreased (inf --> -0.881069).  Saving model ...
Epoch: 2 cost time: 3.0231666564941406
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
Validation loss decreased (-0.881069 --> -0.951349).  Saving model ...
Epoch: 3 cost time: 2.8517231941223145
Epoch: 3, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
Validation loss decreased (-0.951349 --> -0.967567).  Saving model ...
Epoch: 4 cost time: 2.983497142791748
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.938 Test Loss: 0.156 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.164747953414917
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.967567 --> -0.981080).  Saving model ...
Epoch: 6 cost time: 2.9900970458984375
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.964301586151123
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.984575033187866
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1183743476867676
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2182860374450684
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3942747116088867
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.250714063644409
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8351101875305176
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9486277103424072
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4631752967834473
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2678665
model size : 10.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.983631610870361
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.658 Vali Acc: 0.800 Test Loss: 1.658 Test Acc: 0.800
Validation loss decreased (inf --> -0.799983).  Saving model ...
Epoch: 2 cost time: 2.8860435485839844
Epoch: 2, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.483 Vali Acc: 0.932 Test Loss: 0.483 Test Acc: 0.932
Validation loss decreased (-0.799983 --> -0.932428).  Saving model ...
Epoch: 3 cost time: 2.68986439704895
Epoch: 3, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.932428 --> -0.972971).  Saving model ...
Epoch: 4 cost time: 2.544168710708618
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.603280544281006
Epoch: 5, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 2.9073400497436523
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0585525035858154
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0871829986572266
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2170791625976562
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0173394680023193
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0637147426605225
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1322269439697266
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.3678832054138184
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.983274221420288
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1139156818389893
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2457609
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.538703441619873
Epoch: 1, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.762 Vali Acc: 0.770 Test Loss: 1.762 Test Acc: 0.770
Validation loss decreased (inf --> -0.770253).  Saving model ...
Epoch: 2 cost time: 3.704096794128418
Epoch: 2, Steps: 17 | Train Loss: 1.045 Vali Loss: 0.686 Vali Acc: 0.916 Test Loss: 0.686 Test Acc: 0.916
Validation loss decreased (-0.770253 --> -0.916209).  Saving model ...
Epoch: 3 cost time: 3.7307164669036865
Epoch: 3, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
Validation loss decreased (-0.916209 --> -0.951349).  Saving model ...
Epoch: 4 cost time: 3.876209259033203
Epoch: 4, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 3.5126869678497314
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 3.249056577682495
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.176215410232544
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2650492191314697
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 3.1883339881896973
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 3.3907992839813232
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4794442653656006
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4436092376708984
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6514928340911865
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3391387462615967
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4517593383789062
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.5124921798706055
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.571655511856079
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 18 cost time: 3.691934585571289
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 3.637416362762451
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.45089054107666
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.605306625366211
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4431660175323486
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1591856479644775
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.128265619277954
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.2080860137939453
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.7138538360595703
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.6743102073669434
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.881770610809326
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2402569
model size : 9.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.5697021484375
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.819 Vali Acc: 0.757 Test Loss: 1.819 Test Acc: 0.757
Validation loss decreased (inf --> -0.756739).  Saving model ...
Epoch: 2 cost time: 3.114018201828003
Epoch: 2, Steps: 17 | Train Loss: 1.065 Vali Loss: 0.722 Vali Acc: 0.919 Test Loss: 0.722 Test Acc: 0.919
Validation loss decreased (-0.756739 --> -0.918912).  Saving model ...
Epoch: 3 cost time: 3.3593497276306152
Epoch: 3, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.224 Vali Acc: 0.951 Test Loss: 0.224 Test Acc: 0.951
Validation loss decreased (-0.918912 --> -0.951349).  Saving model ...
Epoch: 4 cost time: 3.613243341445923
Epoch: 4, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.951349 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 3.598470687866211
Epoch: 5, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 3.4941956996917725
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7745554447174072
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 3.6092910766601562
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.374823808670044
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3898279666900635
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2113165855407715
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1897284984588623
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2903409004211426
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.350092887878418
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.6905109882354736
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4999489784240723
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.769150972366333
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2402697
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.433814764022827
Epoch: 1, Steps: 17 | Train Loss: 2.057 Vali Loss: 1.867 Vali Acc: 0.770 Test Loss: 1.867 Test Acc: 0.770
Validation loss decreased (inf --> -0.770252).  Saving model ...
Epoch: 2 cost time: 3.062518358230591
Epoch: 2, Steps: 17 | Train Loss: 1.202 Vali Loss: 0.860 Vali Acc: 0.903 Test Loss: 0.860 Test Acc: 0.903
Validation loss decreased (-0.770252 --> -0.902694).  Saving model ...
Epoch: 3 cost time: 3.2032198905944824
Epoch: 3, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.291 Vali Acc: 0.951 Test Loss: 0.291 Test Acc: 0.951
Validation loss decreased (-0.902694 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 3.2884299755096436
Epoch: 4, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 3.1300580501556396
Epoch: 5, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.959458 --> -0.981080).  Saving model ...
Epoch: 6 cost time: 2.929252862930298
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.20028018951416
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8803510665893555
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.820876121520996
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.94415545463562
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0835092067718506
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2370707988739014
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.052978992462158
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.994457721710205
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.4173402786254883
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2375305
model size : 9.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.108148097991943
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.702 Vali Acc: 0.792 Test Loss: 1.702 Test Acc: 0.792
Validation loss decreased (inf --> -0.791875).  Saving model ...
Epoch: 2 cost time: 2.096742630004883
Epoch: 2, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.589 Vali Acc: 0.924 Test Loss: 0.589 Test Acc: 0.924
Validation loss decreased (-0.791875 --> -0.924318).  Saving model ...
Epoch: 3 cost time: 2.20011043548584
Epoch: 3, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.924318 --> -0.962161).  Saving model ...
Epoch: 4 cost time: 2.3627912998199463
Epoch: 4, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 2.201235055923462
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.760051727294922
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.975675 --> -0.983783).  Saving model ...
Epoch: 7 cost time: 2.7056868076324463
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.005419969558716
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.691540002822876
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4720215797424316
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3653156757354736
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.437033176422119
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4997317790985107
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.627479314804077
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7910289764404297
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.746394634246826
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 831369
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.343205690383911
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.653 Vali Acc: 0.862 Test Loss: 1.653 Test Acc: 0.862
Validation loss decreased (inf --> -0.862146).  Saving model ...
Epoch: 2 cost time: 2.6007893085479736
Epoch: 2, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.537 Vali Acc: 0.927 Test Loss: 0.537 Test Acc: 0.927
Validation loss decreased (-0.862146 --> -0.927022).  Saving model ...
Epoch: 3 cost time: 2.494119167327881
Epoch: 3, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.927022 --> -0.959458).  Saving model ...
Epoch: 4 cost time: 2.262911081314087
Epoch: 4, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 5 cost time: 2.3137142658233643
Epoch: 5, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.4316182136535645
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5429491996765137
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.695338010787964
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.602452039718628
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.962 Test Loss: 0.089 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.797388792037964
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8516597747802734
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.0783276557922363
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.965 Test Loss: 0.081 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.187668800354004
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.965 Test Loss: 0.080 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.472614049911499
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.965 Test Loss: 0.083 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.385500907897949
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 2.5087504386901855
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.713430166244507
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 2.7292191982269287
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.622117757797241
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.685743808746338
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9150214195251465
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.748929262161255
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.546109676361084
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3880677223205566
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5644114017486572
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.346132755279541
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.365586996078491
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 831433
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7308835983276367
Epoch: 1, Steps: 17 | Train Loss: 2.106 Vali Loss: 1.877 Vali Acc: 0.708 Test Loss: 1.877 Test Acc: 0.708
Validation loss decreased (inf --> -0.708089).  Saving model ...
Epoch: 2 cost time: 2.455857515335083
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.043 Vali Acc: 0.903 Test Loss: 1.043 Test Acc: 0.903
Validation loss decreased (-0.708089 --> -0.902692).  Saving model ...
Epoch: 3 cost time: 2.453735113143921
Epoch: 3, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.375 Vali Acc: 0.951 Test Loss: 0.375 Test Acc: 0.951
Validation loss decreased (-0.902692 --> -0.951348).  Saving model ...
Epoch: 4 cost time: 2.5868356227874756
Epoch: 4, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
Validation loss decreased (-0.951348 --> -0.967566).  Saving model ...
Epoch: 5 cost time: 2.524634838104248
Epoch: 5, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.35595440864563
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.967566 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 2.4068033695220947
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 8 cost time: 2.3828928470611572
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.463404417037964
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.586728811264038
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.496729850769043
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6280317306518555
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 13 cost time: 2.398345947265625
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0507047176361084
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3954966068267822
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2241649627685547
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.251689910888672
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5742721557617188
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4979183673858643
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 20 cost time: 2.4151663780212402
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6115407943725586
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.644120216369629
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2926688194274902
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4603145122528076
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3296616077423096
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.208209276199341
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.6246840953826904
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.438882827758789
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.290178060531616
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 720905
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.148625612258911
Epoch: 1, Steps: 17 | Train Loss: 2.144 Vali Loss: 1.980 Vali Acc: 0.584 Test Loss: 1.980 Test Acc: 0.584
Validation loss decreased (inf --> -0.583764).  Saving model ...
Epoch: 2 cost time: 2.3672547340393066
Epoch: 2, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.296 Vali Acc: 0.868 Test Loss: 1.296 Test Acc: 0.868
Validation loss decreased (-0.583764 --> -0.867555).  Saving model ...
Epoch: 3 cost time: 2.3622167110443115
Epoch: 3, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.552 Vali Acc: 0.938 Test Loss: 0.552 Test Acc: 0.938
Validation loss decreased (-0.867555 --> -0.937832).  Saving model ...
Epoch: 4 cost time: 2.4278035163879395
Epoch: 4, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.249 Vali Acc: 0.962 Test Loss: 0.249 Test Acc: 0.962
Validation loss decreased (-0.937832 --> -0.962160).  Saving model ...
Epoch: 5 cost time: 2.5553014278411865
Epoch: 5, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 2.3052890300750732
Epoch: 6, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
Validation loss decreased (-0.967566 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 2.3013153076171875
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 2.5910797119140625
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 2.2422773838043213
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.411221981048584
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 2.242706537246704
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 2.3164126873016357
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 2.4861884117126465
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 2.428406000137329
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3946104049682617
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.335399627685547
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4114654064178467
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.260044813156128
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.507488250732422
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4857194423675537
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.413004159927368
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.613631010055542
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.499021053314209
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 693385
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.754452705383301
Epoch: 1, Steps: 17 | Train Loss: 2.083 Vali Loss: 1.982 Vali Acc: 0.605 Test Loss: 1.982 Test Acc: 0.605
Validation loss decreased (inf --> -0.605386).  Saving model ...
Epoch: 2 cost time: 2.0175790786743164
Epoch: 2, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.256 Vali Acc: 0.857 Test Loss: 1.256 Test Acc: 0.857
Validation loss decreased (-0.605386 --> -0.856744).  Saving model ...
Epoch: 3 cost time: 2.198796033859253
Epoch: 3, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.544 Vali Acc: 0.935 Test Loss: 0.544 Test Acc: 0.935
Validation loss decreased (-0.856744 --> -0.935130).  Saving model ...
Epoch: 4 cost time: 2.228867530822754
Epoch: 4, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.243 Vali Acc: 0.962 Test Loss: 0.243 Test Acc: 0.962
Validation loss decreased (-0.935130 --> -0.962160).  Saving model ...
Epoch: 5 cost time: 2.547149419784546
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 2.4411654472351074
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.476245164871216
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.4619126319885254
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.2575583457946777
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 2.300417900085449
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 2.474213123321533
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.414757251739502
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 2.652454376220703
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 2.519397497177124
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2916274070739746
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.295196533203125
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 2.245356798171997
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.077136516571045
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.054225206375122
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.617375373840332
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.632364273071289
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.458462953567505
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.7031383514404297
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4674267768859863
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3460233211517334
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2781028747558594
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 693449
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.049502849578857
Epoch: 1, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.060 Vali Acc: 0.408 Test Loss: 2.060 Test Acc: 0.408
Validation loss decreased (inf --> -0.408088).  Saving model ...
Epoch: 2 cost time: 2.5330913066864014
Epoch: 2, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.507 Vali Acc: 0.816 Test Loss: 1.507 Test Acc: 0.816
Validation loss decreased (-0.408088 --> -0.816201).  Saving model ...
Epoch: 3 cost time: 2.3291938304901123
Epoch: 3, Steps: 17 | Train Loss: 1.055 Vali Loss: 0.813 Vali Acc: 0.908 Test Loss: 0.813 Test Acc: 0.908
Validation loss decreased (-0.816201 --> -0.908100).  Saving model ...
Epoch: 4 cost time: 2.1153550148010254
Epoch: 4, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.387 Vali Acc: 0.941 Test Loss: 0.387 Test Acc: 0.941
Validation loss decreased (-0.908100 --> -0.940537).  Saving model ...
Epoch: 5 cost time: 2.070300817489624
Epoch: 5, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.216 Vali Acc: 0.968 Test Loss: 0.216 Test Acc: 0.968
Validation loss decreased (-0.940537 --> -0.967565).  Saving model ...
Epoch: 6 cost time: 1.9983189105987549
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.4880497455596924
Epoch: 7, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 2.3760974407196045
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6549129486083984
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.4695956707000732
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.485541343688965
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.5140175819396973
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3276584148406982
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 2.469804048538208
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.453192710876465
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 2.4972074031829834
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 2.3319311141967773
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3352444171905518
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 2.3704674243927
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 2.1969194412231445
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4994213581085205
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2345519065856934
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4207496643066406
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2799458503723145
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.6198225021362305
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.5530526638031006
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5595736503601074
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.5361990928649902
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.537442445755005
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 679753
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.403898000717163
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.871 Vali Acc: 0.724 Test Loss: 1.871 Test Acc: 0.724
Validation loss decreased (inf --> -0.724306).  Saving model ...
Epoch: 2 cost time: 1.699747085571289
Epoch: 2, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.049 Vali Acc: 0.884 Test Loss: 1.049 Test Acc: 0.884
Validation loss decreased (-0.724306 --> -0.883773).  Saving model ...
Epoch: 3 cost time: 1.8858423233032227
Epoch: 3, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.404 Vali Acc: 0.941 Test Loss: 0.404 Test Acc: 0.941
Validation loss decreased (-0.883773 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 1.9535887241363525
Epoch: 4, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.940536 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 1.814758062362671
Epoch: 5, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 1.9208862781524658
Epoch: 6, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967567).  Saving model ...
Epoch: 7 cost time: 1.8457601070404053
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.729121208190918
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 1.8117434978485107
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 1.7611610889434814
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0050857067108154
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9174017906188965
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.202526092529297
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.08124041557312
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9113171100616455
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1431798934936523
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8943536281585693
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7717196941375732
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7220227718353271
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 288713
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.571805715560913
Epoch: 1, Steps: 17 | Train Loss: 2.060 Vali Loss: 1.884 Vali Acc: 0.732 Test Loss: 1.884 Test Acc: 0.732
Validation loss decreased (inf --> -0.732414).  Saving model ...
Epoch: 2 cost time: 1.917060136795044
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.126 Vali Acc: 0.919 Test Loss: 1.126 Test Acc: 0.919
Validation loss decreased (-0.732414 --> -0.918908).  Saving model ...
Epoch: 3 cost time: 2.016418218612671
Epoch: 3, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.460 Vali Acc: 0.938 Test Loss: 0.460 Test Acc: 0.938
Validation loss decreased (-0.918908 --> -0.937833).  Saving model ...
Epoch: 4 cost time: 1.9503002166748047
Epoch: 4, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
Validation loss decreased (-0.937833 --> -0.962160).  Saving model ...
Epoch: 5 cost time: 1.901228427886963
Epoch: 5, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.962160 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 1.9966182708740234
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 1.8155934810638428
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8368699550628662
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 1.793651819229126
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.9568250179290771
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7749090194702148
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.218867540359497
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7868101596832275
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6076736450195312
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0203354358673096
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8110015392303467
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8118631839752197
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.949237585067749
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1229348182678223
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 288745
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3271396160125732
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.030 Vali Acc: 0.481 Test Loss: 2.030 Test Acc: 0.481
Validation loss decreased (inf --> -0.481061).  Saving model ...
Epoch: 2 cost time: 1.919914960861206
Epoch: 2, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.580 Vali Acc: 0.805 Test Loss: 1.580 Test Acc: 0.805
Validation loss decreased (-0.481061 --> -0.805390).  Saving model ...
Epoch: 3 cost time: 1.7344636917114258
Epoch: 3, Steps: 17 | Train Loss: 1.174 Vali Loss: 0.975 Vali Acc: 0.895 Test Loss: 0.975 Test Acc: 0.895
Validation loss decreased (-0.805390 --> -0.894585).  Saving model ...
Epoch: 4 cost time: 1.6930122375488281
Epoch: 4, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.491 Vali Acc: 0.938 Test Loss: 0.491 Test Acc: 0.938
Validation loss decreased (-0.894585 --> -0.937833).  Saving model ...
Epoch: 5 cost time: 1.7425758838653564
Epoch: 5, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
Validation loss decreased (-0.937833 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.9344253540039062
Epoch: 6, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 1.737633228302002
Epoch: 7, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 1.8097021579742432
Epoch: 8, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
Validation loss decreased (-0.962161 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 1.798720121383667
Epoch: 9, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6479129791259766
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.7163050174713135
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6809403896331787
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.805422306060791
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.803205966949463
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3845136165618896
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.572359561920166
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3355512619018555
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3897836208343506
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.306034803390503
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4024641513824463
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 233481
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3287429809570312
Epoch: 1, Steps: 17 | Train Loss: 2.079 Vali Loss: 2.015 Vali Acc: 0.457 Test Loss: 2.015 Test Acc: 0.457
Validation loss decreased (inf --> -0.456737).  Saving model ...
Epoch: 2 cost time: 1.9496266841888428
Epoch: 2, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.635 Vali Acc: 0.778 Test Loss: 1.635 Test Acc: 0.778
Validation loss decreased (-0.456737 --> -0.778362).  Saving model ...
Epoch: 3 cost time: 1.8224563598632812
Epoch: 3, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.136 Vali Acc: 0.859 Test Loss: 1.136 Test Acc: 0.859
Validation loss decreased (-0.778362 --> -0.859448).  Saving model ...
Epoch: 4 cost time: 1.7716903686523438
Epoch: 4, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.696 Vali Acc: 0.914 Test Loss: 0.696 Test Acc: 0.914
Validation loss decreased (-0.859448 --> -0.913507).  Saving model ...
Epoch: 5 cost time: 1.5810348987579346
Epoch: 5, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.396 Vali Acc: 0.951 Test Loss: 0.396 Test Acc: 0.951
Validation loss decreased (-0.913507 --> -0.951347).  Saving model ...
Epoch: 6 cost time: 1.5561866760253906
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.261 Vali Acc: 0.965 Test Loss: 0.261 Test Acc: 0.965
Validation loss decreased (-0.951347 --> -0.964862).  Saving model ...
Epoch: 7 cost time: 1.7963111400604248
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
Validation loss decreased (-0.964862 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.6610479354858398
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.9513754844665527
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.8275270462036133
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 1.800874948501587
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8066861629486084
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.7202754020690918
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7612271308898926
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6035130023956299
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6687114238739014
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7348425388336182
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.715874433517456
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9543485641479492
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8373253345489502
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8365070819854736
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.700547695159912
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 219721
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.54933500289917
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.048 Vali Acc: 0.476 Test Loss: 2.048 Test Acc: 0.476
Validation loss decreased (inf --> -0.475655).  Saving model ...
Epoch: 2 cost time: 1.6629784107208252
Epoch: 2, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.677 Vali Acc: 0.770 Test Loss: 1.677 Test Acc: 0.770
Validation loss decreased (-0.475655 --> -0.770253).  Saving model ...
Epoch: 3 cost time: 2.004225730895996
Epoch: 3, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.166 Vali Acc: 0.849 Test Loss: 1.166 Test Acc: 0.849
Validation loss decreased (-0.770253 --> -0.848637).  Saving model ...
Epoch: 4 cost time: 1.7640173435211182
Epoch: 4, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.669 Vali Acc: 0.927 Test Loss: 0.669 Test Acc: 0.927
Validation loss decreased (-0.848637 --> -0.927020).  Saving model ...
Epoch: 5 cost time: 1.8602259159088135
Epoch: 5, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.384 Vali Acc: 0.951 Test Loss: 0.384 Test Acc: 0.951
Validation loss decreased (-0.927020 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 1.8456697463989258
Epoch: 6, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.242 Vali Acc: 0.968 Test Loss: 0.242 Test Acc: 0.968
Validation loss decreased (-0.951348 --> -0.967565).  Saving model ...
Epoch: 7 cost time: 1.81197190284729
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8160698413848877
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
Validation loss decreased (-0.967565 --> -0.975674).  Saving model ...
Epoch: 9 cost time: 1.8338637351989746
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 10 cost time: 1.8041274547576904
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.6503148078918457
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 1.7012934684753418
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7857379913330078
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.65724778175354
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 15 cost time: 1.7648305892944336
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7511768341064453
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7323052883148193
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6816565990447998
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 1.6652657985687256
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7449333667755127
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.763434648513794
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7381634712219238
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8973808288574219
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8358652591705322
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8535490036010742
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.944545030593872
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8773033618927002
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7278072834014893
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 29 cost time: 1.810645341873169
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7093746662139893
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6817445755004883
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7452268600463867
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8180739879608154
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 34 cost time: 1.6025304794311523
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8085367679595947
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.905299186706543
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.8431735038757324
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 38 cost time: 1.7209508419036865
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.766312599182129
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6232383251190186
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6688613891601562
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6677427291870117
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7358112335205078
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.8029966354370117
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.9398720264434814
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.8472049236297607
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.6506645679473877
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 219753
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.546293020248413
Epoch: 1, Steps: 17 | Train Loss: 2.128 Vali Loss: 2.084 Vali Acc: 0.341 Test Loss: 2.084 Test Acc: 0.341
Validation loss decreased (inf --> -0.340520).  Saving model ...
Epoch: 2 cost time: 1.7278437614440918
Epoch: 2, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.771 Vali Acc: 0.735 Test Loss: 1.771 Test Acc: 0.735
Validation loss decreased (-0.340520 --> -0.735117).  Saving model ...
Epoch: 3 cost time: 1.5184919834136963
Epoch: 3, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.356 Vali Acc: 0.830 Test Loss: 1.356 Test Acc: 0.830
Validation loss decreased (-0.735117 --> -0.829716).  Saving model ...
Epoch: 4 cost time: 1.5000598430633545
Epoch: 4, Steps: 17 | Train Loss: 1.052 Vali Loss: 0.890 Vali Acc: 0.892 Test Loss: 0.890 Test Acc: 0.892
Validation loss decreased (-0.829716 --> -0.891883).  Saving model ...
Epoch: 5 cost time: 1.1099658012390137
Epoch: 5, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.555 Vali Acc: 0.911 Test Loss: 0.555 Test Acc: 0.911
Validation loss decreased (-0.891883 --> -0.910805).  Saving model ...
Epoch: 6 cost time: 1.4952044486999512
Epoch: 6, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.355 Vali Acc: 0.935 Test Loss: 0.355 Test Acc: 0.935
Validation loss decreased (-0.910805 --> -0.935132).  Saving model ...
Epoch: 7 cost time: 1.6340529918670654
Epoch: 7, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.254 Vali Acc: 0.954 Test Loss: 0.254 Test Acc: 0.954
Validation loss decreased (-0.935132 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.6498394012451172
Epoch: 8, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.6258642673492432
Epoch: 9, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.54732084274292
Epoch: 10, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.8634886741638184
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.7358057498931885
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7820544242858887
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 1.6017637252807617
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 15 cost time: 1.7659978866577148
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7071075439453125
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6954989433288574
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7591540813446045
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7281005382537842
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6609666347503662
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6568694114685059
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.745077133178711
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6213152408599854
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7021541595458984
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 212905
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.4194324016571045
Epoch: 1, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.014 Vali Acc: 0.878 Test Loss: 1.014 Test Acc: 0.878
Validation loss decreased (inf --> -0.878368).  Saving model ...
Epoch: 2 cost time: 2.7521798610687256
Epoch: 2, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.262 Vali Acc: 0.914 Test Loss: 0.262 Test Acc: 0.914
Validation loss decreased (-0.878368 --> -0.913511).  Saving model ...
Epoch: 3 cost time: 3.1003451347351074
Epoch: 3, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
Validation loss decreased (-0.913511 --> -0.962161).  Saving model ...
Epoch: 4 cost time: 3.250166654586792
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0781431198120117
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 2.7996435165405273
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7032651901245117
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.7132997512817383
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.906689405441284
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.009218692779541
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.924 Test Loss: 0.234 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0165464878082275
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0160346031188965
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7595014572143555
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0411221981048584
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1176328659057617
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.146569013595581
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8679566383361816
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2660105
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.567373037338257
Epoch: 1, Steps: 17 | Train Loss: 1.709 Vali Loss: 1.185 Vali Acc: 0.905 Test Loss: 1.185 Test Acc: 0.905
Validation loss decreased (inf --> -0.905394).  Saving model ...
Epoch: 2 cost time: 3.0910067558288574
Epoch: 2, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.288 Vali Acc: 0.908 Test Loss: 0.288 Test Acc: 0.908
Validation loss decreased (-0.905394 --> -0.908105).  Saving model ...
Epoch: 3 cost time: 3.0348901748657227
Epoch: 3, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.181 Vali Acc: 0.935 Test Loss: 0.181 Test Acc: 0.935
Validation loss decreased (-0.908105 --> -0.935133).  Saving model ...
Epoch: 4 cost time: 3.27168869972229
Epoch: 4, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.935133 --> -0.978378).  Saving model ...
Epoch: 5 cost time: 3.029944896697998
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.71103572845459
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.288736581802368
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 3.295598030090332
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 3.189332962036133
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 2.9386820793151855
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8434510231018066
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8975942134857178
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.9421796798706055
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 3.0532166957855225
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.189453125
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 3.0559940338134766
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0919973850250244
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.026655673980713
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9398694038391113
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.080209732055664
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1027705669403076
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 22 cost time: 3.247079849243164
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.683687448501587
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7455379962921143
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3263490200042725
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2438178062438965
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.168454885482788
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.2116267681121826
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.058225631713867
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.143956184387207
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.035188913345337
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 2660233
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.466454744338989
Epoch: 1, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.619 Vali Acc: 0.792 Test Loss: 1.619 Test Acc: 0.792
Validation loss decreased (inf --> -0.791876).  Saving model ...
Epoch: 2 cost time: 2.6382534503936768
Epoch: 2, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.489 Vali Acc: 0.932 Test Loss: 0.489 Test Acc: 0.932
Validation loss decreased (-0.791876 --> -0.932428).  Saving model ...
Epoch: 3 cost time: 2.7493104934692383
Epoch: 3, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.932428 --> -0.954052).  Saving model ...
Epoch: 4 cost time: 2.932347536087036
Epoch: 4, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 2.977228879928589
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.036184310913086
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 3.085609197616577
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7948811054229736
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.745950937271118
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.8040425777435303
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8597567081451416
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9765617847442627
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 2.8356783390045166
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.763901948928833
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 2.7060325145721436
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7969350814819336
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 2.8566136360168457
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.942138671875
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9384865760803223
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.879843235015869
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0132744312286377
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.925605297088623
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9678897857666016
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.9804911613464355
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.82403302192688
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.712238073348999
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2439177
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.687038898468018
Epoch: 1, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.735 Vali Acc: 0.824 Test Loss: 1.735 Test Acc: 0.824
Validation loss decreased (inf --> -0.824307).  Saving model ...
Epoch: 2 cost time: 3.0124802589416504
Epoch: 2, Steps: 17 | Train Loss: 1.016 Vali Loss: 0.655 Vali Acc: 0.927 Test Loss: 0.655 Test Acc: 0.927
Validation loss decreased (-0.824307 --> -0.927020).  Saving model ...
Epoch: 3 cost time: 3.015700101852417
Epoch: 3, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
Validation loss decreased (-0.927020 --> -0.956755).  Saving model ...
Epoch: 4 cost time: 3.004166841506958
Epoch: 4, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 2.9553442001342773
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 6 cost time: 2.903552770614624
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.9235312938690186
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 2.608710289001465
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 2.635201930999756
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.732790470123291
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.068366289138794
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 2.8643269538879395
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.856072425842285
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7438032627105713
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.00460147857666
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 2.887085437774658
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9792017936706543
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8386785984039307
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8508739471435547
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8058412075042725
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7591328620910645
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8319201469421387
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9819717407226562
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9046883583068848
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8265602588653564
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2384137
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.515711307525635
Epoch: 1, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.840 Vali Acc: 0.759 Test Loss: 1.840 Test Acc: 0.759
Validation loss decreased (inf --> -0.759441).  Saving model ...
Epoch: 2 cost time: 2.8008368015289307
Epoch: 2, Steps: 17 | Train Loss: 1.105 Vali Loss: 0.760 Vali Acc: 0.895 Test Loss: 0.760 Test Acc: 0.895
Validation loss decreased (-0.759441 --> -0.894587).  Saving model ...
Epoch: 3 cost time: 2.443669557571411
Epoch: 3, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.236 Vali Acc: 0.959 Test Loss: 0.236 Test Acc: 0.959
Validation loss decreased (-0.894587 --> -0.959457).  Saving model ...
Epoch: 4 cost time: 2.451660394668579
Epoch: 4, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.959457 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 2.321139097213745
Epoch: 5, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 6 cost time: 2.6238999366760254
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4282381534576416
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7286312580108643
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.787837028503418
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6422312259674072
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5551908016204834
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5853867530822754
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 2.6658999919891357
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7327396869659424
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.713820219039917
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.888927698135376
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.970 Test Loss: 0.071 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.57112979888916
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 2.3873708248138428
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.519064426422119
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4893646240234375
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 21 cost time: 2.768010139465332
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8131537437438965
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8964755535125732
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.638659954071045
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.646820068359375
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.695610523223877
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5629897117614746
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.6223936080932617
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.8917973041534424
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.8131885528564453
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 31 cost time: 2.4227383136749268
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4565982818603516
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.518625259399414
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.5600922107696533
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.6570398807525635
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.7456624507904053
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.753990650177002
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.84077525138855
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.4806997776031494
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.4773921966552734
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 2384265
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.308675050735474
Epoch: 1, Steps: 17 | Train Loss: 2.070 Vali Loss: 1.873 Vali Acc: 0.773 Test Loss: 1.873 Test Acc: 0.773
Validation loss decreased (inf --> -0.772954).  Saving model ...
Epoch: 2 cost time: 2.811328411102295
Epoch: 2, Steps: 17 | Train Loss: 1.250 Vali Loss: 0.921 Vali Acc: 0.916 Test Loss: 0.921 Test Acc: 0.916
Validation loss decreased (-0.772954 --> -0.916207).  Saving model ...
Epoch: 3 cost time: 2.673957347869873
Epoch: 3, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.286 Vali Acc: 0.949 Test Loss: 0.286 Test Acc: 0.949
Validation loss decreased (-0.916207 --> -0.948646).  Saving model ...
Epoch: 4 cost time: 2.6281299591064453
Epoch: 4, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959458).  Saving model ...
Epoch: 5 cost time: 2.791736602783203
Epoch: 5, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.959458 --> -0.978377).  Saving model ...
Epoch: 6 cost time: 2.697293758392334
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.884777784347534
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.056175947189331
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.99589467048645
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9183499813079834
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8095672130584717
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8155999183654785
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.876995801925659
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.474766969680786
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.517469644546509
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2356873
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7640633583068848
Epoch: 1, Steps: 17 | Train Loss: 1.959 Vali Loss: 1.703 Vali Acc: 0.862 Test Loss: 1.703 Test Acc: 0.862
Validation loss decreased (inf --> -0.862145).  Saving model ...
Epoch: 2 cost time: 2.2051761150360107
Epoch: 2, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.548 Vali Acc: 0.941 Test Loss: 0.548 Test Acc: 0.941
Validation loss decreased (-0.862145 --> -0.940535).  Saving model ...
Epoch: 3 cost time: 2.0795772075653076
Epoch: 3, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.940535 --> -0.951350).  Saving model ...
Epoch: 4 cost time: 2.1028051376342773
Epoch: 4, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.951350 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 2.3080291748046875
Epoch: 5, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.283190965652466
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 7 cost time: 2.299220085144043
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3363490104675293
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.330460786819458
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.033886194229126
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0630340576171875
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0286967754364014
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.066967248916626
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2900123596191406
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1423614025115967
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3300492763519287
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 822153
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.527418613433838
Epoch: 1, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.598 Vali Acc: 0.827 Test Loss: 1.598 Test Acc: 0.827
Validation loss decreased (inf --> -0.827011).  Saving model ...
Epoch: 2 cost time: 2.295559883117676
Epoch: 2, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.488 Vali Acc: 0.927 Test Loss: 0.488 Test Acc: 0.927
Validation loss decreased (-0.827011 --> -0.927022).  Saving model ...
Epoch: 3 cost time: 2.3064184188842773
Epoch: 3, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.927022 --> -0.945944).  Saving model ...
Epoch: 4 cost time: 2.3907861709594727
Epoch: 4, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.945944 --> -0.964864).  Saving model ...
Epoch: 5 cost time: 2.0575380325317383
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 1.9723913669586182
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.874723196029663
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0303502082824707
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 1.9957647323608398
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.2277557849884033
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3198657035827637
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2623491287231445
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2371666431427
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0782530307769775
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.131239414215088
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.300452470779419
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2868354320526123
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.236732244491577
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1803395748138428
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 822217
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.236891508102417
Epoch: 1, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.880 Vali Acc: 0.643 Test Loss: 1.880 Test Acc: 0.643
Validation loss decreased (inf --> -0.643224).  Saving model ...
Epoch: 2 cost time: 1.9351582527160645
Epoch: 2, Steps: 17 | Train Loss: 1.285 Vali Loss: 0.965 Vali Acc: 0.919 Test Loss: 0.965 Test Acc: 0.919
Validation loss decreased (-0.643224 --> -0.918909).  Saving model ...
Epoch: 3 cost time: 2.0963995456695557
Epoch: 3, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.339 Vali Acc: 0.949 Test Loss: 0.339 Test Acc: 0.949
Validation loss decreased (-0.918909 --> -0.948645).  Saving model ...
Epoch: 4 cost time: 2.2043609619140625
Epoch: 4, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.948645 --> -0.967566).  Saving model ...
Epoch: 5 cost time: 2.0439858436584473
Epoch: 5, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 2.1428163051605225
Epoch: 6, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 2.0255799293518066
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 8 cost time: 2.0479395389556885
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.166410207748413
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 2.1377639770507812
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9838311672210693
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 1.9205005168914795
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9417524337768555
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8112387657165527
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 1.9100425243377686
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 1.9846749305725098
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9746310710906982
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.180368661880493
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 2.1102118492126465
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9318554401397705
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.049290180206299
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0123164653778076
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0896074771881104
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1239798069000244
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.043713092803955
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1534764766693115
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.05845046043396
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.095499277114868
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 711689
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5976476669311523
Epoch: 1, Steps: 17 | Train Loss: 2.126 Vali Loss: 1.969 Vali Acc: 0.608 Test Loss: 1.969 Test Acc: 0.608
Validation loss decreased (inf --> -0.608088).  Saving model ...
Epoch: 2 cost time: 2.0288617610931396
Epoch: 2, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.283 Vali Acc: 0.884 Test Loss: 1.283 Test Acc: 0.884
Validation loss decreased (-0.608088 --> -0.883771).  Saving model ...
Epoch: 3 cost time: 1.9130020141601562
Epoch: 3, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.565 Vali Acc: 0.932 Test Loss: 0.565 Test Acc: 0.932
Validation loss decreased (-0.883771 --> -0.932427).  Saving model ...
Epoch: 4 cost time: 1.9292030334472656
Epoch: 4, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.252 Vali Acc: 0.962 Test Loss: 0.252 Test Acc: 0.962
Validation loss decreased (-0.932427 --> -0.962160).  Saving model ...
Epoch: 5 cost time: 1.5472071170806885
Epoch: 5, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 2.11987566947937
Epoch: 6, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975674).  Saving model ...
Epoch: 7 cost time: 2.170602560043335
Epoch: 7, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 2.093982458114624
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.1103570461273193
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 2.0264968872070312
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.905759572982788
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8751754760742188
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7817842960357666
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1043426990509033
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9874494075775146
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.17569637298584
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.096195936203003
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0814294815063477
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0289909839630127
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 684169
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.615553140640259
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 1.973 Vali Acc: 0.670 Test Loss: 1.973 Test Acc: 0.670
Validation loss decreased (inf --> -0.670251).  Saving model ...
Epoch: 2 cost time: 2.015225648880005
Epoch: 2, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.285 Vali Acc: 0.862 Test Loss: 1.285 Test Acc: 0.862
Validation loss decreased (-0.670251 --> -0.862149).  Saving model ...
Epoch: 3 cost time: 2.0114188194274902
Epoch: 3, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.572 Vali Acc: 0.927 Test Loss: 0.572 Test Acc: 0.927
Validation loss decreased (-0.862149 --> -0.927021).  Saving model ...
Epoch: 4 cost time: 2.049741268157959
Epoch: 4, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.252 Vali Acc: 0.954 Test Loss: 0.252 Test Acc: 0.954
Validation loss decreased (-0.927021 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 2.0550928115844727
Epoch: 5, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 1.8906927108764648
Epoch: 6, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975674).  Saving model ...
Epoch: 7 cost time: 1.9927911758422852
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.064115524291992
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0667474269866943
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.0792315006256104
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 2.0449347496032715
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0598201751708984
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9400711059570312
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.060333490371704
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1489837169647217
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0769901275634766
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9359323978424072
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.045031785964966
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.079909086227417
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0581283569335938
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 684233
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.604273796081543
Epoch: 1, Steps: 17 | Train Loss: 2.098 Vali Loss: 1.997 Vali Acc: 0.459 Test Loss: 1.997 Test Acc: 0.459
Validation loss decreased (inf --> -0.459439).  Saving model ...
Epoch: 2 cost time: 1.9407031536102295
Epoch: 2, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.433 Vali Acc: 0.814 Test Loss: 1.433 Test Acc: 0.814
Validation loss decreased (-0.459439 --> -0.813499).  Saving model ...
Epoch: 3 cost time: 2.095822811126709
Epoch: 3, Steps: 17 | Train Loss: 0.991 Vali Loss: 0.785 Vali Acc: 0.889 Test Loss: 0.785 Test Acc: 0.889
Validation loss decreased (-0.813499 --> -0.889181).  Saving model ...
Epoch: 4 cost time: 2.0328197479248047
Epoch: 4, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.375 Vali Acc: 0.935 Test Loss: 0.375 Test Acc: 0.935
Validation loss decreased (-0.889181 --> -0.935131).  Saving model ...
Epoch: 5 cost time: 2.032240629196167
Epoch: 5, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 2.0940208435058594
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.940538 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 2.112679958343506
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 2.034731864929199
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.260061025619507
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 2.0968689918518066
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.9858043193817139
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 1.967083215713501
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 2.0330305099487305
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.910548448562622
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 1.9580285549163818
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 2.078287363052368
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 2.0572242736816406
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9896624088287354
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 2.0637125968933105
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 1.8859763145446777
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.078735828399658
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9862756729125977
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.441831350326538
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0186991691589355
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2523396015167236
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.301891803741455
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0635762214660645
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.113443374633789
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9943368434906006
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 30 cost time: 1.997122049331665
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0179717540740967
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 32 cost time: 2.3949637413024902
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.3359270095825195
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.52815318107605
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.4108104705810547
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.27540922164917
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.2185158729553223
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.1706151962280273
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.197960138320923
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.4322094917297363
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.3945350646972656
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 670537
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1226842403411865
Epoch: 1, Steps: 17 | Train Loss: 2.115 Vali Loss: 1.927 Vali Acc: 0.659 Test Loss: 1.927 Test Acc: 0.659
Validation loss decreased (inf --> -0.659440).  Saving model ...
Epoch: 2 cost time: 1.7779183387756348
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.113 Vali Acc: 0.876 Test Loss: 1.113 Test Acc: 0.876
Validation loss decreased (-0.659440 --> -0.875665).  Saving model ...
Epoch: 3 cost time: 2.0283756256103516
Epoch: 3, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.426 Vali Acc: 0.943 Test Loss: 0.426 Test Acc: 0.943
Validation loss decreased (-0.875665 --> -0.943239).  Saving model ...
Epoch: 4 cost time: 2.0052366256713867
Epoch: 4, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
Validation loss decreased (-0.943239 --> -0.964863).  Saving model ...
Epoch: 5 cost time: 2.039548397064209
Epoch: 5, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 1.9177279472351074
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 1.7991602420806885
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.8909707069396973
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 1.6387498378753662
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 1.7494425773620605
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7369801998138428
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 1.773118257522583
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.9261858463287354
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9238808155059814
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 2.026226758956909
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7334961891174316
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7249610424041748
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7816596031188965
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7229678630828857
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8749263286590576
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8024330139160156
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.774339199066162
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8313500881195068
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.787325143814087
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 284105
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.282393455505371
Epoch: 1, Steps: 17 | Train Loss: 2.054 Vali Loss: 1.895 Vali Acc: 0.700 Test Loss: 1.895 Test Acc: 0.700
Validation loss decreased (inf --> -0.699981).  Saving model ...
Epoch: 2 cost time: 1.9154837131500244
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.115 Vali Acc: 0.886 Test Loss: 1.115 Test Acc: 0.886
Validation loss decreased (-0.699981 --> -0.886475).  Saving model ...
Epoch: 3 cost time: 1.9807252883911133
Epoch: 3, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.441 Vali Acc: 0.949 Test Loss: 0.441 Test Acc: 0.949
Validation loss decreased (-0.886475 --> -0.948644).  Saving model ...
Epoch: 4 cost time: 2.0241005420684814
Epoch: 4, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
Validation loss decreased (-0.948644 --> -0.970268).  Saving model ...
Epoch: 5 cost time: 1.9420289993286133
Epoch: 5, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 1.7274603843688965
Epoch: 6, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 1.579031229019165
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 1.4617807865142822
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5391662120819092
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.515577793121338
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 1.9357616901397705
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9877376556396484
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9913499355316162
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0603208541870117
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8689591884613037
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.795525074005127
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 1.7237038612365723
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7391278743743896
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6872384548187256
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.95292329788208
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9260342121124268
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.950197696685791
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.025117874145508
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8522875308990479
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.730865716934204
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5233488082885742
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 284137
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.266244649887085
Epoch: 1, Steps: 17 | Train Loss: 2.137 Vali Loss: 2.037 Vali Acc: 0.411 Test Loss: 2.037 Test Acc: 0.411
Validation loss decreased (inf --> -0.410790).  Saving model ...
Epoch: 2 cost time: 1.4222075939178467
Epoch: 2, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.578 Vali Acc: 0.870 Test Loss: 1.578 Test Acc: 0.870
Validation loss decreased (-0.410790 --> -0.870254).  Saving model ...
Epoch: 3 cost time: 1.4549086093902588
Epoch: 3, Steps: 17 | Train Loss: 1.187 Vali Loss: 0.961 Vali Acc: 0.892 Test Loss: 0.961 Test Acc: 0.892
Validation loss decreased (-0.870254 --> -0.891882).  Saving model ...
Epoch: 4 cost time: 1.531062126159668
Epoch: 4, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.511 Vali Acc: 0.946 Test Loss: 0.511 Test Acc: 0.946
Validation loss decreased (-0.891882 --> -0.945941).  Saving model ...
Epoch: 5 cost time: 1.5704517364501953
Epoch: 5, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.282 Vali Acc: 0.962 Test Loss: 0.282 Test Acc: 0.962
Validation loss decreased (-0.945941 --> -0.962159).  Saving model ...
Epoch: 6 cost time: 1.8763468265533447
Epoch: 6, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
Validation loss decreased (-0.962159 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 1.802905797958374
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 2.018263578414917
Epoch: 8, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8232173919677734
Epoch: 9, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.7023038864135742
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.841947317123413
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 1.414053201675415
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 1.72481369972229
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7917397022247314
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.822659969329834
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9286603927612305
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.9134531021118164
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6832685470581055
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 1.6945981979370117
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 1.5757431983947754
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.529662847518921
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8215217590332031
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7410039901733398
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9286127090454102
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.000440835952759
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9891595840454102
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9072396755218506
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 28 cost time: 2.176987648010254
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8464159965515137
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 1.801961898803711
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8537421226501465
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.731785774230957
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7961103916168213
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.066542863845825
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8089466094970703
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9781172275543213
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.86521577835083
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6852459907531738
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8077418804168701
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 228873
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5483181476593018
Epoch: 1, Steps: 17 | Train Loss: 2.139 Vali Loss: 2.055 Vali Acc: 0.419 Test Loss: 2.055 Test Acc: 0.419
Validation loss decreased (inf --> -0.418898).  Saving model ...
Epoch: 2 cost time: 1.808823585510254
Epoch: 2, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.684 Vali Acc: 0.803 Test Loss: 1.684 Test Acc: 0.803
Validation loss decreased (-0.418898 --> -0.802686).  Saving model ...
Epoch: 3 cost time: 1.9485194683074951
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.178 Vali Acc: 0.884 Test Loss: 1.178 Test Acc: 0.884
Validation loss decreased (-0.802686 --> -0.883772).  Saving model ...
Epoch: 4 cost time: 1.9532427787780762
Epoch: 4, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.707 Vali Acc: 0.919 Test Loss: 0.707 Test Acc: 0.919
Validation loss decreased (-0.883772 --> -0.918912).  Saving model ...
Epoch: 5 cost time: 1.7824225425720215
Epoch: 5, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.411 Vali Acc: 0.943 Test Loss: 0.411 Test Acc: 0.943
Validation loss decreased (-0.918912 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 1.837693452835083
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.270 Vali Acc: 0.962 Test Loss: 0.270 Test Acc: 0.962
Validation loss decreased (-0.943239 --> -0.962159).  Saving model ...
Epoch: 7 cost time: 1.8875529766082764
Epoch: 7, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.198 Vali Acc: 0.962 Test Loss: 0.198 Test Acc: 0.962
Validation loss decreased (-0.962159 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 1.8759191036224365
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 1.8818678855895996
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.7864701747894287
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.6963889598846436
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.657350778579712
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.7003929615020752
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.7437655925750732
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.737847089767456
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.8121397495269775
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 1.9296538829803467
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7411766052246094
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.733522891998291
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6237893104553223
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.489534854888916
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6080069541931152
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9158143997192383
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.895644187927246
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 1.9323668479919434
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 1.772324800491333
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 27 cost time: 1.903064489364624
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7367236614227295
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6685214042663574
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 1.7914676666259766
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 1.858999490737915
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.883972406387329
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9561913013458252
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.816845178604126
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 1.840075969696045
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 36 cost time: 1.8667733669281006
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9683759212493896
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 38 cost time: 1.7734718322753906
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 39 cost time: 1.7980375289916992
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7805860042572021
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.9167702198028564
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 42 cost time: 1.8111157417297363
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6854126453399658
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8648364543914795
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.7002062797546387
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.7503266334533691
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.013550281524658
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7528712749481201
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.6999471187591553
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.9561481475830078
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 215113
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.364199161529541
Epoch: 1, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.087 Vali Acc: 0.311 Test Loss: 2.087 Test Acc: 0.311
Validation loss decreased (inf --> -0.310790).  Saving model ...
Epoch: 2 cost time: 1.8529536724090576
Epoch: 2, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.719 Vali Acc: 0.765 Test Loss: 1.719 Test Acc: 0.765
Validation loss decreased (-0.310790 --> -0.764848).  Saving model ...
Epoch: 3 cost time: 1.775144338607788
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.180 Vali Acc: 0.876 Test Loss: 1.180 Test Acc: 0.876
Validation loss decreased (-0.764848 --> -0.875664).  Saving model ...
Epoch: 4 cost time: 1.8326289653778076
Epoch: 4, Steps: 17 | Train Loss: 0.860 Vali Loss: 0.698 Vali Acc: 0.919 Test Loss: 0.698 Test Acc: 0.919
Validation loss decreased (-0.875664 --> -0.918912).  Saving model ...
Epoch: 5 cost time: 1.758514165878296
Epoch: 5, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.387 Vali Acc: 0.951 Test Loss: 0.387 Test Acc: 0.951
Validation loss decreased (-0.918912 --> -0.951347).  Saving model ...
Epoch: 6 cost time: 1.7648897171020508
Epoch: 6, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.254 Vali Acc: 0.962 Test Loss: 0.254 Test Acc: 0.962
Validation loss decreased (-0.951347 --> -0.962160).  Saving model ...
Epoch: 7 cost time: 1.8421485424041748
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.193 Vali Acc: 0.973 Test Loss: 0.193 Test Acc: 0.973
Validation loss decreased (-0.962160 --> -0.972971).  Saving model ...
Epoch: 8 cost time: 1.7902565002441406
Epoch: 8, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 1.608778953552246
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.607398509979248
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.680457592010498
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.746384859085083
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 1.6069512367248535
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6060457229614258
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.7623229026794434
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 1.9241759777069092
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 17 cost time: 1.927340030670166
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.792144775390625
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.732231616973877
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7055692672729492
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7556414604187012
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7916293144226074
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.791229486465454
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7900819778442383
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9119760990142822
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 26 cost time: 1.7483603954315186
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.75248122215271
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7824695110321045
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.86507248878479
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8526146411895752
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9320447444915771
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9740633964538574
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7865355014801025
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8649725914001465
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8446948528289795
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 36 cost time: 2.012798547744751
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.830594539642334
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.8339014053344727
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8912253379821777
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7751333713531494
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 41 cost time: 1.713998794555664
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.715562343597412
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7075283527374268
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7745897769927979
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9519903659820557
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.8560476303100586
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 47 cost time: 1.8992412090301514
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8325481414794922
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.828212022781372
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8711087703704834
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 215145
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3693947792053223
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.128 Vali Acc: 0.203 Test Loss: 2.128 Test Acc: 0.203
Validation loss decreased (inf --> -0.202681).  Saving model ...
Epoch: 2 cost time: 1.6757934093475342
Epoch: 2, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.824 Vali Acc: 0.732 Test Loss: 1.824 Test Acc: 0.732
Validation loss decreased (-0.202681 --> -0.732414).  Saving model ...
Epoch: 3 cost time: 1.7913427352905273
Epoch: 3, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.407 Vali Acc: 0.862 Test Loss: 1.407 Test Acc: 0.862
Validation loss decreased (-0.732414 --> -0.862148).  Saving model ...
Epoch: 4 cost time: 1.8677113056182861
Epoch: 4, Steps: 17 | Train Loss: 1.095 Vali Loss: 0.951 Vali Acc: 0.903 Test Loss: 0.951 Test Acc: 0.903
Validation loss decreased (-0.862148 --> -0.902693).  Saving model ...
Epoch: 5 cost time: 1.5337879657745361
Epoch: 5, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.589 Vali Acc: 0.927 Test Loss: 0.589 Test Acc: 0.927
Validation loss decreased (-0.902693 --> -0.927021).  Saving model ...
Epoch: 6 cost time: 1.6366932392120361
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.372 Vali Acc: 0.957 Test Loss: 0.372 Test Acc: 0.957
Validation loss decreased (-0.927021 --> -0.956753).  Saving model ...
Epoch: 7 cost time: 1.6389667987823486
Epoch: 7, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
Validation loss decreased (-0.956753 --> -0.970268).  Saving model ...
Epoch: 8 cost time: 1.7444093227386475
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.202 Vali Acc: 0.968 Test Loss: 0.202 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8269855976104736
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.168 Vali Acc: 0.976 Test Loss: 0.168 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975674).  Saving model ...
Epoch: 10 cost time: 1.9588003158569336
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 11 cost time: 1.6945199966430664
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 12 cost time: 1.7228705883026123
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 1.573617935180664
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.6062557697296143
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8069522380828857
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.825775384902954
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 1.8573737144470215
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8461394309997559
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9319512844085693
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7343387603759766
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.730424404144287
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7097878456115723
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6385955810546875
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.694652795791626
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.678786039352417
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8376612663269043
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 208297
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.843074083328247
Epoch: 1, Steps: 17 | Train Loss: 1.245 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
Validation loss decreased (inf --> -0.929726).  Saving model ...
Epoch: 2 cost time: 2.1647465229034424
Epoch: 2, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937836).  Saving model ...
Epoch: 3 cost time: 2.3263957500457764
Epoch: 3, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.937836 --> -0.964864).  Saving model ...
Epoch: 4 cost time: 2.3429832458496094
Epoch: 4, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 5 cost time: 2.3169519901275635
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3255324363708496
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2548227310180664
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.31615948677063
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.124584197998047
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.968 Test Loss: 0.185 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.045958995819092
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.968 Test Loss: 0.183 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9941647052764893
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1934478282928467
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.968 Test Loss: 0.181 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4049196243286133
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.476348400115967
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2529801
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6870923042297363
Epoch: 1, Steps: 17 | Train Loss: 1.338 Vali Loss: 0.385 Vali Acc: 0.932 Test Loss: 0.385 Test Acc: 0.932
Validation loss decreased (inf --> -0.932429).  Saving model ...
Epoch: 2 cost time: 2.3909246921539307
Epoch: 2, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
Validation loss decreased (-0.932429 --> -0.983783).  Saving model ...
Epoch: 3 cost time: 2.3894670009613037
Epoch: 3, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3550267219543457
Epoch: 4, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.938 Test Loss: 0.166 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.077240467071533
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.150452136993408
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2736334800720215
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.916 Test Loss: 0.235 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1911144256591797
Epoch: 8, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.938 Test Loss: 0.235 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.406439781188965
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.446868419647217
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.482271671295166
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.341 Vali Acc: 0.930 Test Loss: 0.341 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2994940280914307
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.949 Test Loss: 0.278 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 2530057
model size : 9.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3104240894317627
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 0.775 Vali Acc: 0.924 Test Loss: 0.775 Test Acc: 0.924
Validation loss decreased (inf --> -0.924317).  Saving model ...
Epoch: 2 cost time: 2.120584726333618
Epoch: 2, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
Validation loss decreased (-0.924317 --> -0.954052).  Saving model ...
Epoch: 3 cost time: 2.0545263290405273
Epoch: 3, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.954052 --> -0.972972).  Saving model ...
Epoch: 4 cost time: 1.9941861629486084
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0010340213775635
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.178563356399536
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1625001430511475
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.295071601867676
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.358452558517456
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1591715812683105
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.267946720123291
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.199045181274414
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2214279174804688
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2115593
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7455384731292725
Epoch: 1, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.127 Vali Acc: 0.881 Test Loss: 1.127 Test Acc: 0.881
Validation loss decreased (inf --> -0.881070).  Saving model ...
Epoch: 2 cost time: 2.059814691543579
Epoch: 2, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
Validation loss decreased (-0.881070 --> -0.940538).  Saving model ...
Epoch: 3 cost time: 1.9902093410491943
Epoch: 3, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.940538 --> -0.978377).  Saving model ...
Epoch: 4 cost time: 1.9464681148529053
Epoch: 4, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.956942081451416
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.838714838027954
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1307530403137207
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1593267917633057
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1062119007110596
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0421204566955566
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.152435779571533
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.017284631729126
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9805848598480225
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1977865
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7259156703948975
Epoch: 1, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.206 Vali Acc: 0.857 Test Loss: 1.206 Test Acc: 0.857
Validation loss decreased (inf --> -0.856745).  Saving model ...
Epoch: 2 cost time: 2.2350008487701416
Epoch: 2, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.299 Vali Acc: 0.946 Test Loss: 0.299 Test Acc: 0.946
Validation loss decreased (-0.856745 --> -0.945943).  Saving model ...
Epoch: 3 cost time: 2.1673946380615234
Epoch: 3, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.140385150909424
Epoch: 4, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.945943 --> -0.962161).  Saving model ...
Epoch: 5 cost time: 2.2056233882904053
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 6 cost time: 2.1674046516418457
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 2.19743013381958
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1468024253845215
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.276259183883667
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2684412002563477
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1909987926483154
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.253108263015747
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2912564277648926
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1681602001190186
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1821844577789307
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.178605794906616
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1978121
model size : 7.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4225614070892334
Epoch: 1, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.296 Vali Acc: 0.862 Test Loss: 1.296 Test Acc: 0.862
Validation loss decreased (inf --> -0.862149).  Saving model ...
Epoch: 2 cost time: 2.101337432861328
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.363 Vali Acc: 0.938 Test Loss: 0.363 Test Acc: 0.938
Validation loss decreased (-0.862149 --> -0.937834).  Saving model ...
Epoch: 3 cost time: 1.9284477233886719
Epoch: 3, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.937834 --> -0.964863).  Saving model ...
Epoch: 4 cost time: 1.8601789474487305
Epoch: 4, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 5 cost time: 1.8937628269195557
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 2.006875514984131
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 7 cost time: 1.9391648769378662
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1052703857421875
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9891467094421387
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9394183158874512
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0410828590393066
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.873094081878662
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9259016513824463
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8227992057800293
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5714490413665771
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.824842929840088
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 2.0177459716796875
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.13395619392395
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.065246105194092
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0894052982330322
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9620413780212402
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9140381813049316
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8824803829193115
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.859114170074463
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8905858993530273
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.882645606994629
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1923337
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3173046112060547
Epoch: 1, Steps: 17 | Train Loss: 1.415 Vali Loss: 0.724 Vali Acc: 0.892 Test Loss: 0.724 Test Acc: 0.892
Validation loss decreased (inf --> -0.891885).  Saving model ...
Epoch: 2 cost time: 1.8620038032531738
Epoch: 2, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.172 Vali Acc: 0.949 Test Loss: 0.172 Test Acc: 0.949
Validation loss decreased (-0.891885 --> -0.948647).  Saving model ...
Epoch: 3 cost time: 1.6944377422332764
Epoch: 3, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.938 Test Loss: 0.148 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6097712516784668
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.986 Test Loss: 0.079 Test Acc: 0.986
Validation loss decreased (-0.948647 --> -0.986486).  Saving model ...
Epoch: 5 cost time: 1.7457025051116943
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8747849464416504
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8469269275665283
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.006486654281616
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.965 Test Loss: 0.084 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9580082893371582
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.02128529548645
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0696141719818115
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8826603889465332
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6570312976837158
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7397875785827637
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9864864864864865
model parameter : 871689
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5772645473480225
Epoch: 1, Steps: 17 | Train Loss: 1.551 Vali Loss: 0.802 Vali Acc: 0.881 Test Loss: 0.802 Test Acc: 0.881
Validation loss decreased (inf --> -0.881073).  Saving model ...
Epoch: 2 cost time: 1.9416968822479248
Epoch: 2, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
Validation loss decreased (-0.881073 --> -0.935133).  Saving model ...
Epoch: 3 cost time: 1.982762336730957
Epoch: 3, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.935133 --> -0.962161).  Saving model ...
Epoch: 4 cost time: 1.863295078277588
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 5 cost time: 1.7730977535247803
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 1.6720774173736572
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 1.9036810398101807
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.948009967803955
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 1.9631016254425049
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8894569873809814
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 1.9318435192108154
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8346080780029297
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7957258224487305
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.656229019165039
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6051287651062012
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7921478748321533
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.808398962020874
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.860381841659546
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9229111671447754
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9063847064971924
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 871817
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3170132637023926
Epoch: 1, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.328 Vali Acc: 0.846 Test Loss: 1.328 Test Acc: 0.846
Validation loss decreased (inf --> -0.845933).  Saving model ...
Epoch: 2 cost time: 1.6667439937591553
Epoch: 2, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.352 Vali Acc: 0.943 Test Loss: 0.352 Test Acc: 0.943
Validation loss decreased (-0.845933 --> -0.943240).  Saving model ...
Epoch: 3 cost time: 1.6276540756225586
Epoch: 3, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954053).  Saving model ...
Epoch: 4 cost time: 1.60023832321167
Epoch: 4, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.954053 --> -0.975675).  Saving model ...
Epoch: 5 cost time: 1.7321510314941406
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7295646667480469
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.778207778930664
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.7908375263214111
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8446359634399414
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8265151977539062
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.8221030235290527
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7908225059509277
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8183724880218506
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8293895721435547
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8793644905090332
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.856760025024414
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9439611434936523
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8250880241394043
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7473063468933105
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8206932544708252
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 664585
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1854538917541504
Epoch: 1, Steps: 17 | Train Loss: 1.858 Vali Loss: 1.521 Vali Acc: 0.757 Test Loss: 1.521 Test Acc: 0.757
Validation loss decreased (inf --> -0.756742).  Saving model ...
Epoch: 2 cost time: 1.905717372894287
Epoch: 2, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.529 Vali Acc: 0.932 Test Loss: 0.529 Test Acc: 0.932
Validation loss decreased (-0.756742 --> -0.932427).  Saving model ...
Epoch: 3 cost time: 1.7940187454223633
Epoch: 3, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.262 Vali Acc: 0.959 Test Loss: 0.262 Test Acc: 0.959
Validation loss decreased (-0.932427 --> -0.959457).  Saving model ...
Epoch: 4 cost time: 1.811342477798462
Epoch: 4, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970269).  Saving model ...
Epoch: 5 cost time: 1.6766748428344727
Epoch: 5, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975674).  Saving model ...
Epoch: 6 cost time: 1.7300844192504883
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 1.731801986694336
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 8 cost time: 1.7117719650268555
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7002954483032227
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.834479570388794
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 1.6788249015808105
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 1.564521312713623
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.5557312965393066
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6489989757537842
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 1.6605219841003418
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7232840061187744
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 1.7349941730499268
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6385321617126465
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7044615745544434
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.818568468093872
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7832376956939697
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7813141345977783
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8369269371032715
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8306248188018799
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7454376220703125
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6737968921661377
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 595721
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.853238582611084
Epoch: 1, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.530 Vali Acc: 0.746 Test Loss: 1.530 Test Acc: 0.746
Validation loss decreased (inf --> -0.745931).  Saving model ...
Epoch: 2 cost time: 1.6395037174224854
Epoch: 2, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.550 Vali Acc: 0.916 Test Loss: 0.550 Test Acc: 0.916
Validation loss decreased (-0.745931 --> -0.916211).  Saving model ...
Epoch: 3 cost time: 1.6765353679656982
Epoch: 3, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.231 Vali Acc: 0.962 Test Loss: 0.231 Test Acc: 0.962
Validation loss decreased (-0.916211 --> -0.962160).  Saving model ...
Epoch: 4 cost time: 1.6188476085662842
Epoch: 4, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5872879028320312
Epoch: 5, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.618830680847168
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.962160 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 1.6546909809112549
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7409868240356445
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7029547691345215
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8394455909729004
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.7372949123382568
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.761559247970581
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7551603317260742
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.7584095001220703
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6063835620880127
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5965373516082764
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 17 cost time: 1.5541903972625732
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 18 cost time: 1.5565783977508545
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5081133842468262
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6603646278381348
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7782232761383057
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6664204597473145
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7161827087402344
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7566969394683838
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6913774013519287
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.624044418334961
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5812301635742188
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 595849
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2735626697540283
Epoch: 1, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.671 Vali Acc: 0.757 Test Loss: 1.671 Test Acc: 0.757
Validation loss decreased (inf --> -0.756740).  Saving model ...
Epoch: 2 cost time: 1.6988260746002197
Epoch: 2, Steps: 17 | Train Loss: 0.980 Vali Loss: 0.717 Vali Acc: 0.905 Test Loss: 0.717 Test Acc: 0.905
Validation loss decreased (-0.756740 --> -0.905398).  Saving model ...
Epoch: 3 cost time: 1.7854795455932617
Epoch: 3, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.309 Vali Acc: 0.954 Test Loss: 0.309 Test Acc: 0.954
Validation loss decreased (-0.905398 --> -0.954051).  Saving model ...
Epoch: 4 cost time: 1.7381858825683594
Epoch: 4, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 5 cost time: 1.670616626739502
Epoch: 5, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
Validation loss decreased (-0.956755 --> -0.978377).  Saving model ...
Epoch: 6 cost time: 1.5408787727355957
Epoch: 6, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 1.5750315189361572
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6149609088897705
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 1.6121580600738525
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5245540142059326
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5956659317016602
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 12 cost time: 1.511831283569336
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5434083938598633
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 14 cost time: 1.519662857055664
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5879154205322266
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7725560665130615
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7790577411651611
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7368197441101074
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7384114265441895
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4727766513824463
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 21 cost time: 1.5014235973358154
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.493725061416626
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5039992332458496
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5562744140625
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7100181579589844
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7371869087219238
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.774156093597412
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.693068027496338
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.808863639831543
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6612741947174072
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 568457
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8832054138183594
Epoch: 1, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.189 Vali Acc: 0.876 Test Loss: 1.189 Test Acc: 0.876
Validation loss decreased (inf --> -0.875664).  Saving model ...
Epoch: 2 cost time: 1.539569616317749
Epoch: 2, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
Validation loss decreased (-0.875664 --> -0.940537).  Saving model ...
Epoch: 3 cost time: 1.544581413269043
Epoch: 3, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
Validation loss decreased (-0.940537 --> -0.962160).  Saving model ...
Epoch: 4 cost time: 1.4990005493164062
Epoch: 4, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.962160 --> -0.978377).  Saving model ...
Epoch: 5 cost time: 1.4453396797180176
Epoch: 5, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.451352834701538
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 1.3104486465454102
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3921277523040771
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.556152105331421
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3568124771118164
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.541189432144165
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5337448120117188
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.498967170715332
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4302988052368164
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3045544624328613
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3667097091674805
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 337545
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.146967649459839
Epoch: 1, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.240 Vali Acc: 0.857 Test Loss: 1.240 Test Acc: 0.857
Validation loss decreased (inf --> -0.856744).  Saving model ...
Epoch: 2 cost time: 1.7045750617980957
Epoch: 2, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.361 Vali Acc: 0.932 Test Loss: 0.361 Test Acc: 0.932
Validation loss decreased (-0.856744 --> -0.932429).  Saving model ...
Epoch: 3 cost time: 1.340928077697754
Epoch: 3, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
Validation loss decreased (-0.932429 --> -0.975674).  Saving model ...
Epoch: 4 cost time: 1.3864586353302002
Epoch: 4, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2106707096099854
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 6 cost time: 1.3860819339752197
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.362253189086914
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5465724468231201
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6027686595916748
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7549467086791992
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6453933715820312
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5679352283477783
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5927104949951172
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.567875862121582
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5253992080688477
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.968 Test Loss: 0.083 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 337609
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.090996265411377
Epoch: 1, Steps: 17 | Train Loss: 2.037 Vali Loss: 1.686 Vali Acc: 0.724 Test Loss: 1.686 Test Acc: 0.724
Validation loss decreased (inf --> -0.724307).  Saving model ...
Epoch: 2 cost time: 1.4647045135498047
Epoch: 2, Steps: 17 | Train Loss: 0.967 Vali Loss: 0.730 Vali Acc: 0.911 Test Loss: 0.730 Test Acc: 0.911
Validation loss decreased (-0.724307 --> -0.910804).  Saving model ...
Epoch: 3 cost time: 1.3672218322753906
Epoch: 3, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.910804 --> -0.940537).  Saving model ...
Epoch: 4 cost time: 1.5035912990570068
Epoch: 4, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.940537 --> -0.959457).  Saving model ...
Epoch: 5 cost time: 1.4949216842651367
Epoch: 5, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962161).  Saving model ...
Epoch: 6 cost time: 1.3822526931762695
Epoch: 6, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 1.4496879577636719
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.4922137260437012
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3556978702545166
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.214540958404541
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3436341285705566
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5265789031982422
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.589954137802124
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5287857055664062
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3549082279205322
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.486689805984497
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.461331844329834
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 233993
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8834195137023926
Epoch: 1, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.756 Vali Acc: 0.657 Test Loss: 1.756 Test Acc: 0.657
Validation loss decreased (inf --> -0.656739).  Saving model ...
Epoch: 2 cost time: 1.49196457862854
Epoch: 2, Steps: 17 | Train Loss: 1.204 Vali Loss: 0.958 Vali Acc: 0.889 Test Loss: 0.958 Test Acc: 0.889
Validation loss decreased (-0.656739 --> -0.889180).  Saving model ...
Epoch: 3 cost time: 1.5733165740966797
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.475 Vali Acc: 0.924 Test Loss: 0.475 Test Acc: 0.924
Validation loss decreased (-0.889180 --> -0.924320).  Saving model ...
Epoch: 4 cost time: 1.4500837326049805
Epoch: 4, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.296 Vali Acc: 0.938 Test Loss: 0.296 Test Acc: 0.938
Validation loss decreased (-0.924320 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.3661479949951172
Epoch: 5, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.210 Vali Acc: 0.965 Test Loss: 0.210 Test Acc: 0.965
Validation loss decreased (-0.937835 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 1.445420742034912
Epoch: 6, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 1.3596928119659424
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.372462272644043
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.3105497360229492
Epoch: 9, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.6052250862121582
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.5175669193267822
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.4323766231536865
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.554826259613037
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.509913682937622
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 15 cost time: 1.3568809032440186
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4712519645690918
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5437748432159424
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.439976453781128
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 19 cost time: 1.4207794666290283
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5541610717773438
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4648008346557617
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.48807954788208
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4687952995300293
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2335844039916992
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3301608562469482
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3961918354034424
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4235796928405762
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3583030700683594
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 199561
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.255070924758911
Epoch: 1, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.744 Vali Acc: 0.697 Test Loss: 1.744 Test Acc: 0.697
Validation loss decreased (inf --> -0.697280).  Saving model ...
Epoch: 2 cost time: 1.5519859790802002
Epoch: 2, Steps: 17 | Train Loss: 1.168 Vali Loss: 0.930 Vali Acc: 0.916 Test Loss: 0.930 Test Acc: 0.916
Validation loss decreased (-0.697280 --> -0.916207).  Saving model ...
Epoch: 3 cost time: 1.3815433979034424
Epoch: 3, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.455 Vali Acc: 0.946 Test Loss: 0.455 Test Acc: 0.946
Validation loss decreased (-0.916207 --> -0.945941).  Saving model ...
Epoch: 4 cost time: 1.4092903137207031
Epoch: 4, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.281 Vali Acc: 0.959 Test Loss: 0.281 Test Acc: 0.959
Validation loss decreased (-0.945941 --> -0.959457).  Saving model ...
Epoch: 5 cost time: 1.402282476425171
Epoch: 5, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 1.4896354675292969
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 1.5117392539978027
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3746533393859863
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4490106105804443
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.2924540042877197
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.5116872787475586
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4203252792358398
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2977445125579834
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4629371166229248
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.27988600730896
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4436097145080566
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.576514482498169
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 18 cost time: 1.4886105060577393
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5767285823822021
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5049724578857422
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.574965000152588
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5435287952423096
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3142993450164795
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 24 cost time: 1.4366014003753662
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 1.401090145111084
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5210607051849365
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5007290840148926
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4201607704162598
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3486254215240479
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4443111419677734
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.298149585723877
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.452974557876587
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4504022598266602
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4188601970672607
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 199625
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.80057430267334
Epoch: 1, Steps: 17 | Train Loss: 2.182 Vali Loss: 1.917 Vali Acc: 0.508 Test Loss: 1.917 Test Acc: 0.508
Validation loss decreased (inf --> -0.508089).  Saving model ...
Epoch: 2 cost time: 1.490731954574585
Epoch: 2, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.183 Vali Acc: 0.835 Test Loss: 1.183 Test Acc: 0.835
Validation loss decreased (-0.508089 --> -0.835123).  Saving model ...
Epoch: 3 cost time: 1.340972900390625
Epoch: 3, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.655 Vali Acc: 0.922 Test Loss: 0.655 Test Acc: 0.922
Validation loss decreased (-0.835123 --> -0.921615).  Saving model ...
Epoch: 4 cost time: 1.292694330215454
Epoch: 4, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.384 Vali Acc: 0.954 Test Loss: 0.384 Test Acc: 0.954
Validation loss decreased (-0.921615 --> -0.954050).  Saving model ...
Epoch: 5 cost time: 1.3442649841308594
Epoch: 5, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.265 Vali Acc: 0.957 Test Loss: 0.265 Test Acc: 0.957
Validation loss decreased (-0.954050 --> -0.956754).  Saving model ...
Epoch: 6 cost time: 1.4097332954406738
Epoch: 6, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 1.4728312492370605
Epoch: 7, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.4417998790740967
Epoch: 8, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 1.4196887016296387
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 10 cost time: 1.3361780643463135
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 1.347926378250122
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5374820232391357
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.4511287212371826
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 1.3932409286499023
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 1.347078561782837
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 1.4492628574371338
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 1.5022408962249756
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 1.5202746391296387
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4485528469085693
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4618167877197266
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 21 cost time: 1.3497300148010254
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 1.4801321029663086
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 23 cost time: 1.5067219734191895
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3907051086425781
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 25 cost time: 1.410689115524292
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 1.2763097286224365
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5202605724334717
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 28 cost time: 1.3964600563049316
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4305696487426758
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3130543231964111
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 31 cost time: 1.4066803455352783
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4430136680603027
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4698538780212402
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4814822673797607
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4891765117645264
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 36 cost time: 1.4920198917388916
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 37 cost time: 1.5545649528503418
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.587939977645874
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4321630001068115
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3169093132019043
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3191895484924316
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3996291160583496
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3937764167785645
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3171634674072266
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.355663537979126
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 46 cost time: 1.4987497329711914
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4773776531219482
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5587232112884521
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.48974609375
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.392575979232788
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 185929
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.669790267944336
Epoch: 1, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.607 Vali Acc: 0.768 Test Loss: 1.607 Test Acc: 0.768
Validation loss decreased (inf --> -0.767551).  Saving model ...
Epoch: 2 cost time: 1.5922372341156006
Epoch: 2, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.665 Vali Acc: 0.932 Test Loss: 0.665 Test Acc: 0.932
Validation loss decreased (-0.767551 --> -0.932426).  Saving model ...
Epoch: 3 cost time: 1.4072463512420654
Epoch: 3, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.276 Vali Acc: 0.968 Test Loss: 0.276 Test Acc: 0.968
Validation loss decreased (-0.932426 --> -0.967565).  Saving model ...
Epoch: 4 cost time: 1.3893013000488281
Epoch: 4, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
Validation loss decreased (-0.967565 --> -0.970268).  Saving model ...
Epoch: 5 cost time: 1.3140912055969238
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 1.2362840175628662
Epoch: 6, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
Validation loss decreased (-0.970269 --> -0.981080).  Saving model ...
Epoch: 7 cost time: 1.2446277141571045
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2498118877410889
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.166351079940796
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4289231300354004
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3987975120544434
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4761359691619873
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3242783546447754
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2553951740264893
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4094524383544922
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3573246002197266
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 144201
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.872978448867798
Epoch: 1, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.657 Vali Acc: 0.768 Test Loss: 1.657 Test Acc: 0.768
Validation loss decreased (inf --> -0.767551).  Saving model ...
Epoch: 2 cost time: 1.327164888381958
Epoch: 2, Steps: 17 | Train Loss: 0.913 Vali Loss: 0.676 Vali Acc: 0.935 Test Loss: 0.676 Test Acc: 0.935
Validation loss decreased (-0.767551 --> -0.935128).  Saving model ...
Epoch: 3 cost time: 1.474186897277832
Epoch: 3, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.306 Vali Acc: 0.954 Test Loss: 0.306 Test Acc: 0.954
Validation loss decreased (-0.935128 --> -0.954051).  Saving model ...
Epoch: 4 cost time: 1.317772626876831
Epoch: 4, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.954051 --> -0.970268).  Saving model ...
Epoch: 5 cost time: 1.1570565700531006
Epoch: 5, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972971).  Saving model ...
Epoch: 6 cost time: 1.2055904865264893
Epoch: 6, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 1.2184255123138428
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 1.605025291442871
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.464524269104004
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.2896268367767334
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.383068323135376
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.400200366973877
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2953274250030518
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3038966655731201
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.228691816329956
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1951344013214111
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.329252004623413
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.562058687210083
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3043298721313477
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 144233
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.801757574081421
Epoch: 1, Steps: 17 | Train Loss: 2.074 Vali Loss: 1.908 Vali Acc: 0.538 Test Loss: 1.908 Test Acc: 0.538
Validation loss decreased (inf --> -0.537819).  Saving model ...
Epoch: 2 cost time: 1.4645421504974365
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.196 Vali Acc: 0.876 Test Loss: 1.196 Test Acc: 0.876
Validation loss decreased (-0.537819 --> -0.875664).  Saving model ...
Epoch: 3 cost time: 1.4374079704284668
Epoch: 3, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.658 Vali Acc: 0.930 Test Loss: 0.658 Test Acc: 0.930
Validation loss decreased (-0.875664 --> -0.929723).  Saving model ...
Epoch: 4 cost time: 1.4469499588012695
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.385 Vali Acc: 0.954 Test Loss: 0.385 Test Acc: 0.954
Validation loss decreased (-0.929723 --> -0.954050).  Saving model ...
Epoch: 5 cost time: 1.4204211235046387
Epoch: 5, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.278 Vali Acc: 0.962 Test Loss: 0.278 Test Acc: 0.962
Validation loss decreased (-0.954050 --> -0.962159).  Saving model ...
Epoch: 6 cost time: 1.4530322551727295
Epoch: 6, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4501440525054932
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
Validation loss decreased (-0.962159 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 1.4231359958648682
Epoch: 8, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4263455867767334
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4673099517822266
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.554351568222046
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5612223148345947
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 1.5721707344055176
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.4979243278503418
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1265106201171875
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4396252632141113
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3537399768829346
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2938740253448486
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4364583492279053
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4589698314666748
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4369487762451172
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4315927028656006
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5761923789978027
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 92425
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7168562412261963
Epoch: 1, Steps: 17 | Train Loss: 2.136 Vali Loss: 1.960 Vali Acc: 0.451 Test Loss: 1.960 Test Acc: 0.451
Validation loss decreased (inf --> -0.451332).  Saving model ...
Epoch: 2 cost time: 1.3414645195007324
Epoch: 2, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.428 Vali Acc: 0.789 Test Loss: 1.428 Test Acc: 0.789
Validation loss decreased (-0.451332 --> -0.789175).  Saving model ...
Epoch: 3 cost time: 1.2179460525512695
Epoch: 3, Steps: 17 | Train Loss: 1.068 Vali Loss: 0.938 Vali Acc: 0.873 Test Loss: 0.938 Test Acc: 0.873
Validation loss decreased (-0.789175 --> -0.872964).  Saving model ...
Epoch: 4 cost time: 1.4194371700286865
Epoch: 4, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.605 Vali Acc: 0.919 Test Loss: 0.605 Test Acc: 0.919
Validation loss decreased (-0.872964 --> -0.918913).  Saving model ...
Epoch: 5 cost time: 1.4337334632873535
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.424 Vali Acc: 0.949 Test Loss: 0.424 Test Acc: 0.949
Validation loss decreased (-0.918913 --> -0.948644).  Saving model ...
Epoch: 6 cost time: 1.1659090518951416
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.324 Vali Acc: 0.957 Test Loss: 0.324 Test Acc: 0.957
Validation loss decreased (-0.948644 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 1.2197628021240234
Epoch: 7, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.258 Vali Acc: 0.957 Test Loss: 0.258 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 8 cost time: 1.2341248989105225
Epoch: 8, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
Validation loss decreased (-0.956754 --> -0.970268).  Saving model ...
Epoch: 9 cost time: 1.2632629871368408
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2944917678833008
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3567264080047607
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.2376527786254883
Epoch: 12, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.2273845672607422
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.2491493225097656
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975674).  Saving model ...
Epoch: 15 cost time: 1.175851821899414
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 16 cost time: 1.3518896102905273
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.336423635482788
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3586573600769043
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.296604871749878
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 20 cost time: 1.3961615562438965
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4146223068237305
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4248003959655762
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 23 cost time: 1.2551507949829102
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.183237075805664
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1817030906677246
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2130208015441895
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.317007064819336
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3673818111419678
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 29 cost time: 1.3370428085327148
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.235954761505127
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.217541217803955
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2607746124267578
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3188807964324951
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 34 cost time: 1.3188512325286865
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4099876880645752
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3343467712402344
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3568267822265625
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3685259819030762
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2996771335601807
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.292891263961792
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2956018447875977
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1611692905426025
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1565425395965576
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 75209
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9656898975372314
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.020 Vali Acc: 0.335 Test Loss: 2.020 Test Acc: 0.335
Validation loss decreased (inf --> -0.335115).  Saving model ...
Epoch: 2 cost time: 1.2621939182281494
Epoch: 2, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.461 Vali Acc: 0.786 Test Loss: 1.461 Test Acc: 0.786
Validation loss decreased (-0.335115 --> -0.786472).  Saving model ...
Epoch: 3 cost time: 1.3027267456054688
Epoch: 3, Steps: 17 | Train Loss: 1.089 Vali Loss: 0.944 Vali Acc: 0.881 Test Loss: 0.944 Test Acc: 0.881
Validation loss decreased (-0.786472 --> -0.881072).  Saving model ...
Epoch: 4 cost time: 1.2998147010803223
Epoch: 4, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.593 Vali Acc: 0.938 Test Loss: 0.593 Test Acc: 0.938
Validation loss decreased (-0.881072 --> -0.937832).  Saving model ...
Epoch: 5 cost time: 1.2647151947021484
Epoch: 5, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.408 Vali Acc: 0.943 Test Loss: 0.408 Test Acc: 0.943
Validation loss decreased (-0.937832 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 1.412588119506836
Epoch: 6, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.305 Vali Acc: 0.951 Test Loss: 0.305 Test Acc: 0.951
Validation loss decreased (-0.943239 --> -0.951348).  Saving model ...
Epoch: 7 cost time: 1.2583863735198975
Epoch: 7, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.248 Vali Acc: 0.957 Test Loss: 0.248 Test Acc: 0.957
Validation loss decreased (-0.951348 --> -0.956754).  Saving model ...
Epoch: 8 cost time: 1.309814214706421
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.2570078372955322
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970268).  Saving model ...
Epoch: 10 cost time: 1.3343751430511475
Epoch: 10, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.4582772254943848
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972971).  Saving model ...
Epoch: 12 cost time: 1.3969943523406982
Epoch: 12, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.2726781368255615
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.07110595703125
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.111166000366211
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 16 cost time: 1.1047632694244385
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1299896240234375
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.336543321609497
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 1.3331859111785889
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3729875087738037
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.400604248046875
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4189136028289795
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3422765731811523
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 24 cost time: 1.2880761623382568
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3222570419311523
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2238247394561768
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 27 cost time: 1.2841401100158691
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3443927764892578
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3630053997039795
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 30 cost time: 1.3935105800628662
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2053921222686768
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1598870754241943
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1483361721038818
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2314701080322266
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 35 cost time: 1.1564712524414062
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 36 cost time: 1.4424700736999512
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 37 cost time: 1.4570121765136719
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4331915378570557
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3286104202270508
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 40 cost time: 1.3757920265197754
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3053553104400635
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3288354873657227
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3665733337402344
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4119012355804443
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4536230564117432
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2598462104797363
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3486707210540771
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3218052387237549
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.225785255432129
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 75241
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8668973445892334
Epoch: 1, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.014 Vali Acc: 0.297 Test Loss: 2.014 Test Acc: 0.297
Validation loss decreased (inf --> -0.297277).  Saving model ...
Epoch: 2 cost time: 1.3069076538085938
Epoch: 2, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.536 Vali Acc: 0.757 Test Loss: 1.536 Test Acc: 0.757
Validation loss decreased (-0.297277 --> -0.756741).  Saving model ...
Epoch: 3 cost time: 1.4169824123382568
Epoch: 3, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.083 Vali Acc: 0.886 Test Loss: 1.083 Test Acc: 0.886
Validation loss decreased (-0.756741 --> -0.886476).  Saving model ...
Epoch: 4 cost time: 1.3797006607055664
Epoch: 4, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.756 Vali Acc: 0.908 Test Loss: 0.756 Test Acc: 0.908
Validation loss decreased (-0.886476 --> -0.908101).  Saving model ...
Epoch: 5 cost time: 1.1902246475219727
Epoch: 5, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.543 Vali Acc: 0.938 Test Loss: 0.543 Test Acc: 0.938
Validation loss decreased (-0.908101 --> -0.937832).  Saving model ...
Epoch: 6 cost time: 1.3300483226776123
Epoch: 6, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.400 Vali Acc: 0.951 Test Loss: 0.400 Test Acc: 0.951
Validation loss decreased (-0.937832 --> -0.951347).  Saving model ...
Epoch: 7 cost time: 1.2516624927520752
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.316 Vali Acc: 0.962 Test Loss: 0.316 Test Acc: 0.962
Validation loss decreased (-0.951347 --> -0.962159).  Saving model ...
Epoch: 8 cost time: 1.2944049835205078
Epoch: 8, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.268 Vali Acc: 0.968 Test Loss: 0.268 Test Acc: 0.968
Validation loss decreased (-0.962159 --> -0.967565).  Saving model ...
Epoch: 9 cost time: 1.3236932754516602
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.226 Vali Acc: 0.973 Test Loss: 0.226 Test Acc: 0.973
Validation loss decreased (-0.967565 --> -0.972971).  Saving model ...
Epoch: 10 cost time: 1.264073371887207
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972971).  Saving model ...
Epoch: 11 cost time: 1.2786815166473389
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972971).  Saving model ...
Epoch: 12 cost time: 1.2304105758666992
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.175 Vali Acc: 0.976 Test Loss: 0.175 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975674).  Saving model ...
Epoch: 13 cost time: 1.2705724239349365
Epoch: 13, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1495177745819092
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 15 cost time: 1.1971864700317383
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 16 cost time: 1.2644531726837158
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2803351879119873
Epoch: 17, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
Epoch: 18 cost time: 1.4390292167663574
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3635482788085938
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 20 cost time: 1.3473443984985352
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 21 cost time: 1.3566224575042725
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 22 cost time: 1.2751498222351074
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2583715915679932
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 24 cost time: 1.2370202541351318
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2692184448242188
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 26 cost time: 1.3138272762298584
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 27 cost time: 1.1902556419372559
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 28 cost time: 1.2545621395111084
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2777867317199707
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 30 cost time: 1.2735950946807861
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 31 cost time: 1.2907929420471191
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 32 cost time: 1.1913962364196777
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 33 cost time: 1.1824018955230713
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 34 cost time: 1.1443803310394287
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 35 cost time: 1.1908748149871826
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 36 cost time: 1.3384292125701904
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 37 cost time: 1.2932817935943604
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 38 cost time: 1.2817847728729248
Epoch: 38, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3571255207061768
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 40 cost time: 1.323218584060669
Epoch: 40, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 41 cost time: 1.3448874950408936
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3058586120605469
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2494142055511475
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2589366436004639
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2333214282989502
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.286010980606079
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3654158115386963
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3520238399505615
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.183605670928955
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1736299991607666
Epoch: 50, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ModernTCN_UEA_ftM_sl29_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 68393
model size : 0.28MB
