Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         200                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6473381519317627
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.360 Vali Acc: 0.297 Test Loss: 1.360 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.8921294212341309
Epoch: 2, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.302 Vali Acc: 0.514 Test Loss: 1.302 Test Acc: 0.514
Validation loss decreased (-0.297284 --> -0.513500).  Saving model ...
Epoch: 3 cost time: 1.0122296810150146
Epoch: 3, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.247 Vali Acc: 0.473 Test Loss: 1.247 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.944566011428833
Epoch: 4, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
Validation loss decreased (-0.513500 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.9834573268890381
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.0837762355804443
Epoch: 6, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 1.164665937423706
Epoch: 7, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 1.0759122371673584
Epoch: 8, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.13718843460083
Epoch: 9, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 10 cost time: 1.0862586498260498
Epoch: 10, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.019 Vali Acc: 0.635 Test Loss: 1.019 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 11 cost time: 0.8951036930084229
Epoch: 11, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.07243013381958
Epoch: 12, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.020 Vali Acc: 0.622 Test Loss: 1.020 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9480373859405518
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9718382358551025
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.093 Vali Acc: 0.608 Test Loss: 1.093 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0265202522277832
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.127 Vali Acc: 0.608 Test Loss: 1.127 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.986461877822876
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.152 Vali Acc: 0.608 Test Loss: 1.152 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0797343254089355
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.170 Vali Acc: 0.608 Test Loss: 1.170 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1202433109283447
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.212 Vali Acc: 0.622 Test Loss: 1.212 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0389995574951172
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.245 Vali Acc: 0.608 Test Loss: 1.245 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2447235584259033
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.269 Vali Acc: 0.608 Test Loss: 1.269 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6979153156280518
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.1468138694763184
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.302 Vali Acc: 0.514 Test Loss: 1.302 Test Acc: 0.514
Validation loss decreased (-0.324311 --> -0.513500).  Saving model ...
Epoch: 3 cost time: 1.1111900806427002
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4169163703918457
Epoch: 4, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2266395092010498
Epoch: 5, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
Validation loss decreased (-0.513500 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.0500438213348389
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.4827275276184082
Epoch: 7, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 1.4617455005645752
Epoch: 8, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.026 Vali Acc: 0.622 Test Loss: 1.026 Test Acc: 0.622
Validation loss decreased (-0.581071 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 1.200178861618042
Epoch: 9, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.014 Vali Acc: 0.608 Test Loss: 1.014 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1299610137939453
Epoch: 10, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 1.1751275062561035
Epoch: 11, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2946808338165283
Epoch: 12, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.021 Vali Acc: 0.635 Test Loss: 1.021 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 13 cost time: 1.2596945762634277
Epoch: 13, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.052 Vali Acc: 0.622 Test Loss: 1.052 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3706488609313965
Epoch: 14, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.098 Vali Acc: 0.595 Test Loss: 1.098 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2357401847839355
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.132 Vali Acc: 0.622 Test Loss: 1.132 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1465063095092773
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.156 Vali Acc: 0.622 Test Loss: 1.156 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.421618938446045
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.171 Vali Acc: 0.622 Test Loss: 1.171 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1798677444458008
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5945560932159424
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.246 Vali Acc: 0.635 Test Loss: 1.246 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2922155857086182
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.271 Vali Acc: 0.635 Test Loss: 1.271 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2269353866577148
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.289 Vali Acc: 0.635 Test Loss: 1.289 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.199134349822998
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.316 Vali Acc: 0.622 Test Loss: 1.316 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         160                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6735317707061768
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.1127686500549316
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.301 Vali Acc: 0.514 Test Loss: 1.301 Test Acc: 0.514
Validation loss decreased (-0.324311 --> -0.513500).  Saving model ...
Epoch: 3 cost time: 1.4421343803405762
Epoch: 3, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.247 Vali Acc: 0.459 Test Loss: 1.247 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2247734069824219
Epoch: 4, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.175 Vali Acc: 0.486 Test Loss: 1.175 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.383235216140747
Epoch: 5, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2162129878997803
Epoch: 6, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
Validation loss decreased (-0.513500 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.530303955078125
Epoch: 7, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 1.221660852432251
Epoch: 8, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.040 Vali Acc: 0.541 Test Loss: 1.040 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2305197715759277
Epoch: 9, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.032 Vali Acc: 0.581 Test Loss: 1.032 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.1260201930999756
Epoch: 10, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 1.229978322982788
Epoch: 11, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.049 Vali Acc: 0.608 Test Loss: 1.049 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.40443754196167
Epoch: 12, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 1.2258903980255127
Epoch: 13, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.078 Vali Acc: 0.608 Test Loss: 1.078 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2121217250823975
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.127 Vali Acc: 0.608 Test Loss: 1.127 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.282623052597046
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.163 Vali Acc: 0.622 Test Loss: 1.163 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621610).  Saving model ...
Epoch: 16 cost time: 1.2081029415130615
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.191 Vali Acc: 0.635 Test Loss: 1.191 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635123).  Saving model ...
Epoch: 17 cost time: 1.2322564125061035
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.207 Vali Acc: 0.635 Test Loss: 1.207 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2697663307189941
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.251 Vali Acc: 0.649 Test Loss: 1.251 Test Acc: 0.649
Validation loss decreased (-0.635123 --> -0.648636).  Saving model ...
Epoch: 19 cost time: 1.071274757385254
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.284 Vali Acc: 0.662 Test Loss: 1.284 Test Acc: 0.662
Validation loss decreased (-0.648636 --> -0.662149).  Saving model ...
Epoch: 20 cost time: 1.477724313735962
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.311 Vali Acc: 0.649 Test Loss: 1.311 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2889437675476074
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.330 Vali Acc: 0.622 Test Loss: 1.330 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.372309923171997
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.357 Vali Acc: 0.622 Test Loss: 1.357 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2509939670562744
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.392 Vali Acc: 0.635 Test Loss: 1.392 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4645617008209229
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.410 Vali Acc: 0.608 Test Loss: 1.410 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.34220552444458
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.424 Vali Acc: 0.608 Test Loss: 1.424 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5006709098815918
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.437 Vali Acc: 0.622 Test Loss: 1.437 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4509029388427734
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.470 Vali Acc: 0.622 Test Loss: 1.470 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.44417405128479
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.486 Vali Acc: 0.608 Test Loss: 1.486 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1968269348144531
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.508 Vali Acc: 0.608 Test Loss: 1.508 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         140                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma140_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7177093029022217
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.361 Vali Acc: 0.311 Test Loss: 1.361 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.234609603881836
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.303 Vali Acc: 0.486 Test Loss: 1.303 Test Acc: 0.486
Validation loss decreased (-0.310797 --> -0.486473).  Saving model ...
Epoch: 3 cost time: 1.3295888900756836
Epoch: 3, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.251 Vali Acc: 0.446 Test Loss: 1.251 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.034923791885376
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
Validation loss decreased (-0.486473 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.2650203704833984
Epoch: 5, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.0363821983337402
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.278308391571045
Epoch: 7, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.068 Vali Acc: 0.514 Test Loss: 1.068 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2374200820922852
Epoch: 8, Steps: 10 | Train Loss: 0.530 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.3234379291534424
Epoch: 9, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.075 Vali Acc: 0.568 Test Loss: 1.075 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.0172655582427979
Epoch: 10, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3372089862823486
Epoch: 11, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 1.1428799629211426
Epoch: 12, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.2460083961486816
Epoch: 13, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3806955814361572
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.188 Vali Acc: 0.581 Test Loss: 1.188 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1090528964996338
Epoch: 15, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3471827507019043
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.263 Vali Acc: 0.595 Test Loss: 1.263 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 1.29034423828125
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.280 Vali Acc: 0.581 Test Loss: 1.280 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0598502159118652
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.327 Vali Acc: 0.581 Test Loss: 1.327 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7673335075378418
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.362 Vali Acc: 0.595 Test Loss: 1.362 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3918285369873047
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.392 Vali Acc: 0.595 Test Loss: 1.392 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2719650268554688
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.412 Vali Acc: 0.595 Test Loss: 1.412 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1969671249389648
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.439 Vali Acc: 0.595 Test Loss: 1.439 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4566404819488525
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.480 Vali Acc: 0.595 Test Loss: 1.480 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.207035779953003
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.497 Vali Acc: 0.595 Test Loss: 1.497 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2506957054138184
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.511 Vali Acc: 0.595 Test Loss: 1.511 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4442124366760254
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.526 Vali Acc: 0.595 Test Loss: 1.526 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma140_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         120                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4858217239379883
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.361 Vali Acc: 0.311 Test Loss: 1.361 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.120802640914917
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.305 Vali Acc: 0.473 Test Loss: 1.305 Test Acc: 0.473
Validation loss decreased (-0.310797 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.015594720840454
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.254 Vali Acc: 0.459 Test Loss: 1.254 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1384165287017822
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.0152342319488525
Epoch: 5, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.144679069519043
Epoch: 6, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.105 Vali Acc: 0.514 Test Loss: 1.105 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.2964773178100586
Epoch: 7, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.088 Vali Acc: 0.486 Test Loss: 1.088 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1100144386291504
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0852329730987549
Epoch: 9, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.108 Vali Acc: 0.473 Test Loss: 1.108 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2362315654754639
Epoch: 10, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9538931846618652
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.070507526397705
Epoch: 12, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0133192539215088
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 14 cost time: 0.9654390811920166
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.240 Vali Acc: 0.527 Test Loss: 1.240 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.912858247756958
Epoch: 15, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.283 Vali Acc: 0.541 Test Loss: 1.283 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8387742042541504
Epoch: 16, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.321 Vali Acc: 0.541 Test Loss: 1.321 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9863862991333008
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.339 Vali Acc: 0.541 Test Loss: 1.339 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1277806758880615
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.389 Vali Acc: 0.541 Test Loss: 1.389 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0325901508331299
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.425 Vali Acc: 0.541 Test Loss: 1.425 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.108247995376587
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.456 Vali Acc: 0.527 Test Loss: 1.456 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0557866096496582
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.477 Vali Acc: 0.541 Test Loss: 1.477 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1327171325683594
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.504 Vali Acc: 0.541 Test Loss: 1.504 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9112358093261719
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.547 Vali Acc: 0.541 Test Loss: 1.547 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         100                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5953047275543213
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.361 Vali Acc: 0.270 Test Loss: 1.361 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.1177430152893066
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.305 Vali Acc: 0.486 Test Loss: 1.305 Test Acc: 0.486
Validation loss decreased (-0.270257 --> -0.486473).  Saving model ...
Epoch: 3 cost time: 1.1676561832427979
Epoch: 3, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4292881488800049
Epoch: 4, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.153141975402832
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2550911903381348
Epoch: 6, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.094 Vali Acc: 0.527 Test Loss: 1.094 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.2664790153503418
Epoch: 7, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.074 Vali Acc: 0.500 Test Loss: 1.074 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.147902011871338
Epoch: 8, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.086 Vali Acc: 0.486 Test Loss: 1.086 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1655821800231934
Epoch: 9, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2324483394622803
Epoch: 10, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6563470363616943
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5439021587371826
Epoch: 12, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3174293041229248
Epoch: 13, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3777551651000977
Epoch: 14, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3547372817993164
Epoch: 15, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.303297996520996
Epoch: 16, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.311 Vali Acc: 0.514 Test Loss: 1.311 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         80                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.153842926025391
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.361 Vali Acc: 0.284 Test Loss: 1.361 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1738669872283936
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
Validation loss decreased (-0.283770 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.2339580059051514
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1751148700714111
Epoch: 4, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.0881187915802002
Epoch: 5, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 1.0314173698425293
Epoch: 6, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.0844128131866455
Epoch: 7, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2170038223266602
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.071 Vali Acc: 0.514 Test Loss: 1.071 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3520405292510986
Epoch: 9, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.070 Vali Acc: 0.514 Test Loss: 1.070 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4568772315979004
Epoch: 10, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.185676097869873
Epoch: 11, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2291553020477295
Epoch: 12, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1609575748443604
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.315500020980835
Epoch: 14, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0882670879364014
Epoch: 15, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.04130220413208
Epoch: 16, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.284 Vali Acc: 0.541 Test Loss: 1.284 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         60                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7547104358673096
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.361 Vali Acc: 0.284 Test Loss: 1.361 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.2895824909210205
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.303 Vali Acc: 0.514 Test Loss: 1.303 Test Acc: 0.514
Validation loss decreased (-0.283770 --> -0.513500).  Saving model ...
Epoch: 3 cost time: 1.1125812530517578
Epoch: 3, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.249 Vali Acc: 0.514 Test Loss: 1.249 Test Acc: 0.514
Validation loss decreased (-0.513500 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.1957132816314697
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.181 Vali Acc: 0.554 Test Loss: 1.181 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 1.363199234008789
Epoch: 5, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.130 Vali Acc: 0.581 Test Loss: 1.130 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 1.192582368850708
Epoch: 6, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.076 Vali Acc: 0.581 Test Loss: 1.076 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.0685045719146729
Epoch: 7, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.052 Vali Acc: 0.595 Test Loss: 1.052 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 1.294222116470337
Epoch: 8, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2172632217407227
Epoch: 9, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.054 Vali Acc: 0.581 Test Loss: 1.054 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.15842866897583
Epoch: 10, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.074 Vali Acc: 0.581 Test Loss: 1.074 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2681858539581299
Epoch: 11, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4961209297180176
Epoch: 12, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.088 Vali Acc: 0.581 Test Loss: 1.088 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2579927444458008
Epoch: 13, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.128 Vali Acc: 0.568 Test Loss: 1.128 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3088972568511963
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.181 Vali Acc: 0.581 Test Loss: 1.181 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5452985763549805
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.212 Vali Acc: 0.595 Test Loss: 1.212 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1657447814941406
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.242 Vali Acc: 0.595 Test Loss: 1.242 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.252593755722046
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.267 Vali Acc: 0.595 Test Loss: 1.267 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.975815773010254
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.361 Vali Acc: 0.284 Test Loss: 1.361 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1466598510742188
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.302 Vali Acc: 0.486 Test Loss: 1.302 Test Acc: 0.486
Validation loss decreased (-0.283770 --> -0.486473).  Saving model ...
Epoch: 3 cost time: 1.0843737125396729
Epoch: 3, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
Validation loss decreased (-0.486473 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.9567701816558838
Epoch: 4, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 1.199331283569336
Epoch: 5, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.126 Vali Acc: 0.595 Test Loss: 1.126 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 1.0609118938446045
Epoch: 6, Steps: 10 | Train Loss: 0.766 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0743725299835205
Epoch: 7, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.059 Vali Acc: 0.581 Test Loss: 1.059 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0983409881591797
Epoch: 8, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.071 Vali Acc: 0.581 Test Loss: 1.071 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9572250843048096
Epoch: 9, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.072 Vali Acc: 0.568 Test Loss: 1.072 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1063263416290283
Epoch: 10, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.094 Vali Acc: 0.581 Test Loss: 1.094 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.107804775238037
Epoch: 11, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2481164932250977
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.113 Vali Acc: 0.595 Test Loss: 1.113 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 1.0632052421569824
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.149 Vali Acc: 0.568 Test Loss: 1.149 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9932701587677002
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.203 Vali Acc: 0.568 Test Loss: 1.203 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9406464099884033
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.242 Vali Acc: 0.581 Test Loss: 1.242 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.274148941040039
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.275 Vali Acc: 0.568 Test Loss: 1.275 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2522461414337158
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.297 Vali Acc: 0.581 Test Loss: 1.297 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.114837884902954
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.338 Vali Acc: 0.581 Test Loss: 1.338 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2497541904449463
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.374 Vali Acc: 0.581 Test Loss: 1.374 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3195161819458008
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.407 Vali Acc: 0.581 Test Loss: 1.407 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3797352313995361
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.430 Vali Acc: 0.581 Test Loss: 1.430 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4104375839233398
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.451 Vali Acc: 0.568 Test Loss: 1.451 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3887221813201904
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.1344029903411865
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.307 Vali Acc: 0.459 Test Loss: 1.307 Test Acc: 0.459
Validation loss decreased (-0.270257 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.107661485671997
Epoch: 3, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0151679515838623
Epoch: 4, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8482742309570312
Epoch: 5, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.7999005317687988
Epoch: 6, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.090 Vali Acc: 0.541 Test Loss: 1.090 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.1316111087799072
Epoch: 7, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.0610744953155518
Epoch: 8, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.077 Vali Acc: 0.568 Test Loss: 1.077 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.9934375286102295
Epoch: 9, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0891294479370117
Epoch: 10, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.304652452468872
Epoch: 11, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2325937747955322
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9864826202392578
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4904181957244873
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.177760124206543
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.220 Vali Acc: 0.568 Test Loss: 1.220 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1515920162200928
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.247 Vali Acc: 0.581 Test Loss: 1.247 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 17 cost time: 0.9775035381317139
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.268 Vali Acc: 0.554 Test Loss: 1.268 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0784294605255127
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.300 Vali Acc: 0.527 Test Loss: 1.300 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.469637155532837
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.329 Vali Acc: 0.527 Test Loss: 1.329 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3716533184051514
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.361 Vali Acc: 0.541 Test Loss: 1.361 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.251331090927124
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.381 Vali Acc: 0.554 Test Loss: 1.381 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3549420833587646
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.399 Vali Acc: 0.541 Test Loss: 1.399 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.545501470565796
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.430 Vali Acc: 0.541 Test Loss: 1.430 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1895794868469238
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.450 Vali Acc: 0.527 Test Loss: 1.450 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7066607475280762
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.463 Vali Acc: 0.541 Test Loss: 1.463 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2631921768188477
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.480 Vali Acc: 0.554 Test Loss: 1.480 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.2272748947143555
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.2911067008972168
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.307 Vali Acc: 0.459 Test Loss: 1.307 Test Acc: 0.459
Validation loss decreased (-0.270257 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.3357868194580078
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.519158124923706
Epoch: 4, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.482600212097168
Epoch: 5, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.1403727531433105
Epoch: 6, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.264314889907837
Epoch: 7, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.462583065032959
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.072 Vali Acc: 0.568 Test Loss: 1.072 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.1524765491485596
Epoch: 9, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.068 Vali Acc: 0.527 Test Loss: 1.068 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2752854824066162
Epoch: 10, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2071561813354492
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4475388526916504
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1127595901489258
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1817653179168701
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3686347007751465
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6905603408813477
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.229 Vali Acc: 0.568 Test Loss: 1.229 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3720083236694336
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.249 Vali Acc: 0.554 Test Loss: 1.249 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3043584823608398
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.279 Vali Acc: 0.568 Test Loss: 1.279 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.768805742263794
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.603940725326538
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.308 Vali Acc: 0.446 Test Loss: 1.308 Test Acc: 0.446
Validation loss decreased (-0.270257 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.5151095390319824
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.256 Vali Acc: 0.459 Test Loss: 1.256 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.4945261478424072
Epoch: 4, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.434894323348999
Epoch: 5, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.1920061111450195
Epoch: 6, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5656864643096924
Epoch: 7, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.4098901748657227
Epoch: 8, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.338273286819458
Epoch: 9, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.059 Vali Acc: 0.554 Test Loss: 1.059 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6238763332366943
Epoch: 10, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4396064281463623
Epoch: 11, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.082 Vali Acc: 0.595 Test Loss: 1.082 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.3889119625091553
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5915107727050781
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.097 Vali Acc: 0.608 Test Loss: 1.097 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 1.414825677871704
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.136 Vali Acc: 0.595 Test Loss: 1.136 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.272932767868042
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.171 Vali Acc: 0.581 Test Loss: 1.171 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4967701435089111
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.207 Vali Acc: 0.581 Test Loss: 1.207 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2514755725860596
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.227 Vali Acc: 0.581 Test Loss: 1.227 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5981066226959229
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.252 Vali Acc: 0.581 Test Loss: 1.252 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2382807731628418
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.272 Vali Acc: 0.581 Test Loss: 1.272 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.381700038909912
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.527078628540039
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.334 Vali Acc: 0.581 Test Loss: 1.334 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.414968490600586
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.348 Vali Acc: 0.581 Test Loss: 1.348 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4913687705993652
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.374 Vali Acc: 0.581 Test Loss: 1.374 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.61669921875
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.3721659183502197
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.309 Vali Acc: 0.446 Test Loss: 1.309 Test Acc: 0.446
Validation loss decreased (-0.270257 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.2118234634399414
Epoch: 3, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.151540994644165
Epoch: 4, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.3861870765686035
Epoch: 5, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.142 Vali Acc: 0.554 Test Loss: 1.142 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.4578325748443604
Epoch: 6, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.5573327541351318
Epoch: 7, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.2612371444702148
Epoch: 8, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.063 Vali Acc: 0.581 Test Loss: 1.063 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.1708247661590576
Epoch: 9, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.056 Vali Acc: 0.595 Test Loss: 1.056 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.3231580257415771
Epoch: 10, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.070 Vali Acc: 0.595 Test Loss: 1.070 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6060056686401367
Epoch: 11, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.079 Vali Acc: 0.622 Test Loss: 1.079 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 1.3512070178985596
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6240782737731934
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7156198024749756
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.130 Vali Acc: 0.608 Test Loss: 1.130 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1426212787628174
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.162 Vali Acc: 0.635 Test Loss: 1.162 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635124).  Saving model ...
Epoch: 16 cost time: 1.3715786933898926
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.195 Vali Acc: 0.595 Test Loss: 1.195 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4886407852172852
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.216 Vali Acc: 0.608 Test Loss: 1.216 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3357949256896973
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.241 Vali Acc: 0.595 Test Loss: 1.241 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3376107215881348
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.260 Vali Acc: 0.595 Test Loss: 1.260 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3335237503051758
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.289 Vali Acc: 0.608 Test Loss: 1.289 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6845223903656006
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.315 Vali Acc: 0.595 Test Loss: 1.315 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.270808458328247
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.333 Vali Acc: 0.595 Test Loss: 1.333 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7303037643432617
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.357 Vali Acc: 0.595 Test Loss: 1.357 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7141783237457275
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.372 Vali Acc: 0.595 Test Loss: 1.372 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2828733921051025
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.383 Vali Acc: 0.595 Test Loss: 1.383 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.194812536239624
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.363 Vali Acc: 0.257 Test Loss: 1.363 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.104872226715088
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.313 Vali Acc: 0.459 Test Loss: 1.313 Test Acc: 0.459
Validation loss decreased (-0.256743 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.2535459995269775
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.0476689338684082
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.202 Vali Acc: 0.459 Test Loss: 1.202 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.2226977348327637
Epoch: 5, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.150 Vali Acc: 0.568 Test Loss: 1.150 Test Acc: 0.568
Validation loss decreased (-0.459447 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.1946144104003906
Epoch: 6, Steps: 10 | Train Loss: 0.797 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.386441946029663
Epoch: 7, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.071 Vali Acc: 0.554 Test Loss: 1.071 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2312283515930176
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.071 Vali Acc: 0.581 Test Loss: 1.071 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.292107343673706
Epoch: 9, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.312969446182251
Epoch: 10, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 1.2237873077392578
Epoch: 11, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.094 Vali Acc: 0.608 Test Loss: 1.094 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 1.5487849712371826
Epoch: 12, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.094 Vali Acc: 0.595 Test Loss: 1.094 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1679635047912598
Epoch: 13, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.110 Vali Acc: 0.608 Test Loss: 1.110 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.428185224533081
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.149 Vali Acc: 0.595 Test Loss: 1.149 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0480902194976807
Epoch: 15, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.184 Vali Acc: 0.595 Test Loss: 1.184 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9978818893432617
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.215 Vali Acc: 0.595 Test Loss: 1.215 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.289945125579834
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.237 Vali Acc: 0.595 Test Loss: 1.237 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2134637832641602
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.266 Vali Acc: 0.595 Test Loss: 1.266 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.052192211151123
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.292 Vali Acc: 0.595 Test Loss: 1.292 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1823806762695312
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.321 Vali Acc: 0.608 Test Loss: 1.321 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3268203735351562
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.344 Vali Acc: 0.595 Test Loss: 1.344 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 336804
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9065909385681152
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.364 Vali Acc: 0.257 Test Loss: 1.364 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.2957854270935059
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.316 Vali Acc: 0.459 Test Loss: 1.316 Test Acc: 0.459
Validation loss decreased (-0.256743 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.0514845848083496
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.269 Vali Acc: 0.473 Test Loss: 1.269 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.9588983058929443
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 1.0918054580688477
Epoch: 5, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
Validation loss decreased (-0.472961 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 1.214022159576416
Epoch: 6, Steps: 10 | Train Loss: 0.804 Vali Loss: 1.105 Vali Acc: 0.527 Test Loss: 1.105 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3870184421539307
Epoch: 7, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.2140495777130127
Epoch: 8, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.3015074729919434
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.075 Vali Acc: 0.554 Test Loss: 1.075 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3652863502502441
Epoch: 10, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.094 Vali Acc: 0.608 Test Loss: 1.094 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 1.1499247550964355
Epoch: 11, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.105 Vali Acc: 0.595 Test Loss: 1.105 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4527180194854736
Epoch: 12, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2450261116027832
Epoch: 13, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.126 Vali Acc: 0.581 Test Loss: 1.126 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2940704822540283
Epoch: 14, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3169174194335938
Epoch: 15, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4491078853607178
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.233 Vali Acc: 0.554 Test Loss: 1.233 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7393789291381836
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.257 Vali Acc: 0.568 Test Loss: 1.257 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5050959587097168
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.288 Vali Acc: 0.554 Test Loss: 1.288 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5941905975341797
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.312 Vali Acc: 0.554 Test Loss: 1.312 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.543015718460083
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.341 Vali Acc: 0.554 Test Loss: 1.341 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_DLinear_UEA_ftM_sl400_ll0_pl0_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 336804
model size : 1.29MB
