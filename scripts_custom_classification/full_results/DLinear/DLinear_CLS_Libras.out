Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.487285852432251
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.7311980724334717
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.732 Vali Acc: 0.094 Test Loss: 2.732 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.358522653579712
Epoch: 3, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.710 Vali Acc: 0.106 Test Loss: 2.710 Test Acc: 0.106
Validation loss decreased (-0.094417 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.4768812656402588
Epoch: 4, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.686 Vali Acc: 0.106 Test Loss: 2.686 Test Acc: 0.106
Validation loss decreased (-0.105528 --> -0.105529).  Saving model ...
Epoch: 5 cost time: 1.4176654815673828
Epoch: 5, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.660 Vali Acc: 0.122 Test Loss: 2.660 Test Acc: 0.122
Validation loss decreased (-0.105529 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.3034696578979492
Epoch: 6, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.633 Vali Acc: 0.128 Test Loss: 2.633 Test Acc: 0.128
Validation loss decreased (-0.122196 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 1.3609578609466553
Epoch: 7, Steps: 12 | Train Loss: 2.569 Vali Loss: 2.602 Vali Acc: 0.189 Test Loss: 2.602 Test Acc: 0.189
Validation loss decreased (-0.127751 --> -0.188863).  Saving model ...
Epoch: 8 cost time: 1.1934306621551514
Epoch: 8, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.572 Vali Acc: 0.222 Test Loss: 2.572 Test Acc: 0.222
Validation loss decreased (-0.188863 --> -0.222197).  Saving model ...
Epoch: 9 cost time: 1.3915245532989502
Epoch: 9, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.540 Vali Acc: 0.250 Test Loss: 2.540 Test Acc: 0.250
Validation loss decreased (-0.222197 --> -0.249975).  Saving model ...
Epoch: 10 cost time: 1.1199061870574951
Epoch: 10, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.502 Vali Acc: 0.283 Test Loss: 2.502 Test Acc: 0.283
Validation loss decreased (-0.249975 --> -0.283308).  Saving model ...
Epoch: 11 cost time: 1.4881784915924072
Epoch: 11, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.467 Vali Acc: 0.300 Test Loss: 2.467 Test Acc: 0.300
Validation loss decreased (-0.283308 --> -0.299975).  Saving model ...
Epoch: 12 cost time: 1.4932446479797363
Epoch: 12, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.432 Vali Acc: 0.300 Test Loss: 2.432 Test Acc: 0.300
Validation loss decreased (-0.299975 --> -0.299976).  Saving model ...
Epoch: 13 cost time: 1.277008056640625
Epoch: 13, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.388 Vali Acc: 0.344 Test Loss: 2.388 Test Acc: 0.344
Validation loss decreased (-0.299976 --> -0.344421).  Saving model ...
Epoch: 14 cost time: 1.2057597637176514
Epoch: 14, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.345 Vali Acc: 0.372 Test Loss: 2.345 Test Acc: 0.372
Validation loss decreased (-0.344421 --> -0.372199).  Saving model ...
Epoch: 15 cost time: 1.2685916423797607
Epoch: 15, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.303 Vali Acc: 0.400 Test Loss: 2.303 Test Acc: 0.400
Validation loss decreased (-0.372199 --> -0.399977).  Saving model ...
Epoch: 16 cost time: 1.0824930667877197
Epoch: 16, Steps: 12 | Train Loss: 2.123 Vali Loss: 2.255 Vali Acc: 0.417 Test Loss: 2.255 Test Acc: 0.417
Validation loss decreased (-0.399977 --> -0.416644).  Saving model ...
Epoch: 17 cost time: 1.297037124633789
Epoch: 17, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.199 Vali Acc: 0.450 Test Loss: 2.199 Test Acc: 0.450
Validation loss decreased (-0.416644 --> -0.449978).  Saving model ...
Epoch: 18 cost time: 1.3326740264892578
Epoch: 18, Steps: 12 | Train Loss: 2.017 Vali Loss: 2.152 Vali Acc: 0.478 Test Loss: 2.152 Test Acc: 0.478
Validation loss decreased (-0.449978 --> -0.477756).  Saving model ...
Epoch: 19 cost time: 1.1074681282043457
Epoch: 19, Steps: 12 | Train Loss: 1.968 Vali Loss: 2.098 Vali Acc: 0.494 Test Loss: 2.098 Test Acc: 0.494
Validation loss decreased (-0.477756 --> -0.494423).  Saving model ...
Epoch: 20 cost time: 1.2622029781341553
Epoch: 20, Steps: 12 | Train Loss: 1.875 Vali Loss: 2.043 Vali Acc: 0.511 Test Loss: 2.043 Test Acc: 0.511
Validation loss decreased (-0.494423 --> -0.511091).  Saving model ...
Epoch: 21 cost time: 1.5781221389770508
Epoch: 21, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.986 Vali Acc: 0.533 Test Loss: 1.986 Test Acc: 0.533
Validation loss decreased (-0.511091 --> -0.533313).  Saving model ...
Epoch: 22 cost time: 1.1744160652160645
Epoch: 22, Steps: 12 | Train Loss: 1.763 Vali Loss: 1.937 Vali Acc: 0.550 Test Loss: 1.937 Test Acc: 0.550
Validation loss decreased (-0.533313 --> -0.549981).  Saving model ...
Epoch: 23 cost time: 1.3474946022033691
Epoch: 23, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.892 Vali Acc: 0.550 Test Loss: 1.892 Test Acc: 0.550
Validation loss decreased (-0.549981 --> -0.549981).  Saving model ...
Epoch: 24 cost time: 1.0045623779296875
Epoch: 24, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.854 Vali Acc: 0.556 Test Loss: 1.854 Test Acc: 0.556
Validation loss decreased (-0.549981 --> -0.555537).  Saving model ...
Epoch: 25 cost time: 1.2320945262908936
Epoch: 25, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.810 Vali Acc: 0.550 Test Loss: 1.810 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3804347515106201
Epoch: 26, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.777 Vali Acc: 0.544 Test Loss: 1.777 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0858757495880127
Epoch: 27, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.744 Vali Acc: 0.550 Test Loss: 1.744 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0340263843536377
Epoch: 28, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.715 Vali Acc: 0.556 Test Loss: 1.715 Test Acc: 0.556
Validation loss decreased (-0.555537 --> -0.555538).  Saving model ...
Epoch: 29 cost time: 1.5664706230163574
Epoch: 29, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.696 Vali Acc: 0.556 Test Loss: 1.696 Test Acc: 0.556
Validation loss decreased (-0.555538 --> -0.555539).  Saving model ...
Epoch: 30 cost time: 1.369917392730713
Epoch: 30, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.672 Vali Acc: 0.583 Test Loss: 1.672 Test Acc: 0.583
Validation loss decreased (-0.555539 --> -0.583317).  Saving model ...
Epoch: 31 cost time: 1.2012910842895508
Epoch: 31, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.633 Vali Acc: 0.578 Test Loss: 1.633 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4685792922973633
Epoch: 32, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.613 Vali Acc: 0.583 Test Loss: 1.613 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 33 cost time: 1.3095016479492188
Epoch: 33, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.599 Vali Acc: 0.589 Test Loss: 1.599 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 34 cost time: 1.1170995235443115
Epoch: 34, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.577 Vali Acc: 0.600 Test Loss: 1.577 Test Acc: 0.600
Validation loss decreased (-0.588873 --> -0.599984).  Saving model ...
Epoch: 35 cost time: 1.0440723896026611
Epoch: 35, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.564 Vali Acc: 0.606 Test Loss: 1.564 Test Acc: 0.606
Validation loss decreased (-0.599984 --> -0.605540).  Saving model ...
Epoch: 36 cost time: 1.288221836090088
Epoch: 36, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.541 Vali Acc: 0.622 Test Loss: 1.541 Test Acc: 0.622
Validation loss decreased (-0.605540 --> -0.622207).  Saving model ...
Epoch: 37 cost time: 1.3315160274505615
Epoch: 37, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.511 Vali Acc: 0.622 Test Loss: 1.511 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622207).  Saving model ...
Epoch: 38 cost time: 1.1945219039916992
Epoch: 38, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.492 Vali Acc: 0.628 Test Loss: 1.492 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627763).  Saving model ...
Epoch: 39 cost time: 1.1457595825195312
Epoch: 39, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.481 Vali Acc: 0.617 Test Loss: 1.481 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3941214084625244
Epoch: 40, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.466 Vali Acc: 0.611 Test Loss: 1.466 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3908684253692627
Epoch: 41, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.445 Vali Acc: 0.622 Test Loss: 1.445 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1484811305999756
Epoch: 42, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.439 Vali Acc: 0.628 Test Loss: 1.439 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627763).  Saving model ...
Epoch: 43 cost time: 1.5533089637756348
Epoch: 43, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.426 Vali Acc: 0.633 Test Loss: 1.426 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 1.3764829635620117
Epoch: 44, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.410 Vali Acc: 0.639 Test Loss: 1.410 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638875).  Saving model ...
Epoch: 45 cost time: 1.2932095527648926
Epoch: 45, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.395 Vali Acc: 0.639 Test Loss: 1.395 Test Acc: 0.639
Validation loss decreased (-0.638875 --> -0.638875).  Saving model ...
Epoch: 46 cost time: 1.1517648696899414
Epoch: 46, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.385 Vali Acc: 0.633 Test Loss: 1.385 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.451796054840088
Epoch: 47, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.371 Vali Acc: 0.639 Test Loss: 1.371 Test Acc: 0.639
Validation loss decreased (-0.638875 --> -0.638875).  Saving model ...
Epoch: 48 cost time: 1.1830394268035889
Epoch: 48, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.364 Vali Acc: 0.644 Test Loss: 1.364 Test Acc: 0.644
Validation loss decreased (-0.638875 --> -0.644431).  Saving model ...
Epoch: 49 cost time: 1.3941028118133545
Epoch: 49, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.357 Vali Acc: 0.644 Test Loss: 1.357 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 50 cost time: 1.514554738998413
Epoch: 50, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.353 Vali Acc: 0.650 Test Loss: 1.353 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649986).  Saving model ...
Epoch: 51 cost time: 1.4595818519592285
Epoch: 51, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.343 Vali Acc: 0.644 Test Loss: 1.343 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7807319164276123
Epoch: 52, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.340 Vali Acc: 0.644 Test Loss: 1.340 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.7046945095062256
Epoch: 53, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.338 Vali Acc: 0.644 Test Loss: 1.338 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.4974660873413086
Epoch: 54, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.323 Vali Acc: 0.656 Test Loss: 1.323 Test Acc: 0.656
Validation loss decreased (-0.649986 --> -0.655542).  Saving model ...
Epoch: 55 cost time: 1.5421395301818848
Epoch: 55, Steps: 12 | Train Loss: 0.843 Vali Loss: 1.311 Vali Acc: 0.656 Test Loss: 1.311 Test Acc: 0.656
Validation loss decreased (-0.655542 --> -0.655542).  Saving model ...
Epoch: 56 cost time: 1.2836968898773193
Epoch: 56, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.300 Vali Acc: 0.661 Test Loss: 1.300 Test Acc: 0.661
Validation loss decreased (-0.655542 --> -0.661098).  Saving model ...
Epoch: 57 cost time: 1.3407726287841797
Epoch: 57, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.299 Vali Acc: 0.656 Test Loss: 1.299 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.779097080230713
Epoch: 58, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.289 Vali Acc: 0.661 Test Loss: 1.289 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 59 cost time: 1.4126965999603271
Epoch: 59, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.281 Vali Acc: 0.661 Test Loss: 1.281 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 60 cost time: 1.0573420524597168
Epoch: 60, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.279 Vali Acc: 0.672 Test Loss: 1.279 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672209).  Saving model ...
Epoch: 61 cost time: 1.6153221130371094
Epoch: 61, Steps: 12 | Train Loss: 0.818 Vali Loss: 1.267 Vali Acc: 0.672 Test Loss: 1.267 Test Acc: 0.672
Validation loss decreased (-0.672209 --> -0.672210).  Saving model ...
Epoch: 62 cost time: 1.3036363124847412
Epoch: 62, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.268 Vali Acc: 0.672 Test Loss: 1.268 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3065836429595947
Epoch: 63, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.266 Vali Acc: 0.678 Test Loss: 1.266 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677765).  Saving model ...
Epoch: 64 cost time: 1.1193344593048096
Epoch: 64, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.267 Vali Acc: 0.678 Test Loss: 1.267 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2159173488616943
Epoch: 65, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.263 Vali Acc: 0.683 Test Loss: 1.263 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683321).  Saving model ...
Epoch: 66 cost time: 1.194486379623413
Epoch: 66, Steps: 12 | Train Loss: 0.737 Vali Loss: 1.265 Vali Acc: 0.694 Test Loss: 1.265 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694432).  Saving model ...
Epoch: 67 cost time: 1.1763627529144287
Epoch: 67, Steps: 12 | Train Loss: 0.731 Vali Loss: 1.263 Vali Acc: 0.700 Test Loss: 1.263 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699987).  Saving model ...
Epoch: 68 cost time: 1.1516809463500977
Epoch: 68, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.250 Vali Acc: 0.694 Test Loss: 1.250 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.218691349029541
Epoch: 69, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.253 Vali Acc: 0.689 Test Loss: 1.253 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.1909794807434082
Epoch: 70, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.250 Vali Acc: 0.683 Test Loss: 1.250 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.1564571857452393
Epoch: 71, Steps: 12 | Train Loss: 0.696 Vali Loss: 1.253 Vali Acc: 0.689 Test Loss: 1.253 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.4615635871887207
Epoch: 72, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.249 Vali Acc: 0.689 Test Loss: 1.249 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.1430845260620117
Epoch: 73, Steps: 12 | Train Loss: 0.686 Vali Loss: 1.256 Vali Acc: 0.694 Test Loss: 1.256 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.337712287902832
Epoch: 74, Steps: 12 | Train Loss: 0.692 Vali Loss: 1.247 Vali Acc: 0.689 Test Loss: 1.247 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.5104153156280518
Epoch: 75, Steps: 12 | Train Loss: 0.695 Vali Loss: 1.251 Vali Acc: 0.689 Test Loss: 1.251 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.3947248458862305
Epoch: 76, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.244 Vali Acc: 0.683 Test Loss: 1.244 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.2515716552734375
Epoch: 77, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.239 Vali Acc: 0.683 Test Loss: 1.239 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.978832244873047
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.3469343185424805
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.732 Vali Acc: 0.094 Test Loss: 2.732 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.3324768543243408
Epoch: 3, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.711 Vali Acc: 0.106 Test Loss: 2.711 Test Acc: 0.106
Validation loss decreased (-0.094417 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.0096685886383057
Epoch: 4, Steps: 12 | Train Loss: 2.654 Vali Loss: 2.687 Vali Acc: 0.106 Test Loss: 2.687 Test Acc: 0.106
Validation loss decreased (-0.105528 --> -0.105529).  Saving model ...
Epoch: 5 cost time: 1.583893060684204
Epoch: 5, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.661 Vali Acc: 0.122 Test Loss: 2.661 Test Acc: 0.122
Validation loss decreased (-0.105529 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.4449448585510254
Epoch: 6, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.634 Vali Acc: 0.128 Test Loss: 2.634 Test Acc: 0.128
Validation loss decreased (-0.122196 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 1.2558701038360596
Epoch: 7, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.604 Vali Acc: 0.183 Test Loss: 2.604 Test Acc: 0.183
Validation loss decreased (-0.127751 --> -0.183307).  Saving model ...
Epoch: 8 cost time: 1.352919340133667
Epoch: 8, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.573 Vali Acc: 0.217 Test Loss: 2.573 Test Acc: 0.217
Validation loss decreased (-0.183307 --> -0.216641).  Saving model ...
Epoch: 9 cost time: 1.4804487228393555
Epoch: 9, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.542 Vali Acc: 0.250 Test Loss: 2.542 Test Acc: 0.250
Validation loss decreased (-0.216641 --> -0.249975).  Saving model ...
Epoch: 10 cost time: 1.3896088600158691
Epoch: 10, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.504 Vali Acc: 0.289 Test Loss: 2.504 Test Acc: 0.289
Validation loss decreased (-0.249975 --> -0.288864).  Saving model ...
Epoch: 11 cost time: 1.301598072052002
Epoch: 11, Steps: 12 | Train Loss: 2.398 Vali Loss: 2.469 Vali Acc: 0.300 Test Loss: 2.469 Test Acc: 0.300
Validation loss decreased (-0.288864 --> -0.299975).  Saving model ...
Epoch: 12 cost time: 1.1514136791229248
Epoch: 12, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.435 Vali Acc: 0.300 Test Loss: 2.435 Test Acc: 0.300
Validation loss decreased (-0.299975 --> -0.299976).  Saving model ...
Epoch: 13 cost time: 1.3765745162963867
Epoch: 13, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.391 Vali Acc: 0.339 Test Loss: 2.391 Test Acc: 0.339
Validation loss decreased (-0.299976 --> -0.338865).  Saving model ...
Epoch: 14 cost time: 1.558957576751709
Epoch: 14, Steps: 12 | Train Loss: 2.253 Vali Loss: 2.349 Vali Acc: 0.372 Test Loss: 2.349 Test Acc: 0.372
Validation loss decreased (-0.338865 --> -0.372199).  Saving model ...
Epoch: 15 cost time: 1.3080365657806396
Epoch: 15, Steps: 12 | Train Loss: 2.189 Vali Loss: 2.306 Vali Acc: 0.383 Test Loss: 2.306 Test Acc: 0.383
Validation loss decreased (-0.372199 --> -0.383310).  Saving model ...
Epoch: 16 cost time: 1.3460078239440918
Epoch: 16, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.258 Vali Acc: 0.428 Test Loss: 2.258 Test Acc: 0.428
Validation loss decreased (-0.383310 --> -0.427755).  Saving model ...
Epoch: 17 cost time: 1.3735339641571045
Epoch: 17, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.202 Vali Acc: 0.444 Test Loss: 2.202 Test Acc: 0.444
Validation loss decreased (-0.427755 --> -0.444422).  Saving model ...
Epoch: 18 cost time: 1.3660500049591064
Epoch: 18, Steps: 12 | Train Loss: 2.025 Vali Loss: 2.155 Vali Acc: 0.456 Test Loss: 2.155 Test Acc: 0.456
Validation loss decreased (-0.444422 --> -0.455534).  Saving model ...
Epoch: 19 cost time: 1.2300543785095215
Epoch: 19, Steps: 12 | Train Loss: 1.971 Vali Loss: 2.102 Vali Acc: 0.494 Test Loss: 2.102 Test Acc: 0.494
Validation loss decreased (-0.455534 --> -0.494423).  Saving model ...
Epoch: 20 cost time: 1.0827245712280273
Epoch: 20, Steps: 12 | Train Loss: 1.883 Vali Loss: 2.047 Vali Acc: 0.522 Test Loss: 2.047 Test Acc: 0.522
Validation loss decreased (-0.494423 --> -0.522202).  Saving model ...
Epoch: 21 cost time: 1.356701135635376
Epoch: 21, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.990 Vali Acc: 0.539 Test Loss: 1.990 Test Acc: 0.539
Validation loss decreased (-0.522202 --> -0.538869).  Saving model ...
Epoch: 22 cost time: 1.40810227394104
Epoch: 22, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.941 Vali Acc: 0.556 Test Loss: 1.941 Test Acc: 0.556
Validation loss decreased (-0.538869 --> -0.555536).  Saving model ...
Epoch: 23 cost time: 1.4140725135803223
Epoch: 23, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.896 Vali Acc: 0.561 Test Loss: 1.896 Test Acc: 0.561
Validation loss decreased (-0.555536 --> -0.561092).  Saving model ...
Epoch: 24 cost time: 1.4567344188690186
Epoch: 24, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.857 Vali Acc: 0.561 Test Loss: 1.857 Test Acc: 0.561
Validation loss decreased (-0.561092 --> -0.561093).  Saving model ...
Epoch: 25 cost time: 1.202840805053711
Epoch: 25, Steps: 12 | Train Loss: 1.571 Vali Loss: 1.812 Vali Acc: 0.550 Test Loss: 1.812 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.250150442123413
Epoch: 26, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.779 Vali Acc: 0.550 Test Loss: 1.779 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.488435983657837
Epoch: 27, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.745 Vali Acc: 0.550 Test Loss: 1.745 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3828740119934082
Epoch: 28, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.716 Vali Acc: 0.561 Test Loss: 1.716 Test Acc: 0.561
Validation loss decreased (-0.561093 --> -0.561094).  Saving model ...
Epoch: 29 cost time: 1.464874029159546
Epoch: 29, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.696 Vali Acc: 0.556 Test Loss: 1.696 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5314183235168457
Epoch: 30, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.672 Vali Acc: 0.583 Test Loss: 1.672 Test Acc: 0.583
Validation loss decreased (-0.561094 --> -0.583317).  Saving model ...
Epoch: 31 cost time: 1.5575945377349854
Epoch: 31, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.633 Vali Acc: 0.578 Test Loss: 1.633 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7287001609802246
Epoch: 32, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.612 Vali Acc: 0.594 Test Loss: 1.612 Test Acc: 0.594
Validation loss decreased (-0.583317 --> -0.594428).  Saving model ...
Epoch: 33 cost time: 1.89198899269104
Epoch: 33, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.598 Vali Acc: 0.583 Test Loss: 1.598 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4093122482299805
Epoch: 34, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.576 Vali Acc: 0.611 Test Loss: 1.576 Test Acc: 0.611
Validation loss decreased (-0.594428 --> -0.611095).  Saving model ...
Epoch: 35 cost time: 1.2453725337982178
Epoch: 35, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.562 Vali Acc: 0.617 Test Loss: 1.562 Test Acc: 0.617
Validation loss decreased (-0.611095 --> -0.616651).  Saving model ...
Epoch: 36 cost time: 1.2971560955047607
Epoch: 36, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.540 Vali Acc: 0.622 Test Loss: 1.540 Test Acc: 0.622
Validation loss decreased (-0.616651 --> -0.622207).  Saving model ...
Epoch: 37 cost time: 1.2779717445373535
Epoch: 37, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.510 Vali Acc: 0.622 Test Loss: 1.510 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622207).  Saving model ...
Epoch: 38 cost time: 1.1997706890106201
Epoch: 38, Steps: 12 | Train Loss: 1.141 Vali Loss: 1.491 Vali Acc: 0.622 Test Loss: 1.491 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622207).  Saving model ...
Epoch: 39 cost time: 1.477461338043213
Epoch: 39, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.480 Vali Acc: 0.622 Test Loss: 1.480 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622207).  Saving model ...
Epoch: 40 cost time: 1.436204195022583
Epoch: 40, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.465 Vali Acc: 0.617 Test Loss: 1.465 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.518247127532959
Epoch: 41, Steps: 12 | Train Loss: 1.125 Vali Loss: 1.444 Vali Acc: 0.628 Test Loss: 1.444 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627763).  Saving model ...
Epoch: 42 cost time: 1.3510046005249023
Epoch: 42, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.438 Vali Acc: 0.628 Test Loss: 1.438 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627763).  Saving model ...
Epoch: 43 cost time: 1.2418992519378662
Epoch: 43, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.425 Vali Acc: 0.633 Test Loss: 1.425 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 1.2185378074645996
Epoch: 44, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.410 Vali Acc: 0.633 Test Loss: 1.410 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 45 cost time: 1.3927273750305176
Epoch: 45, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.394 Vali Acc: 0.644 Test Loss: 1.394 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644431).  Saving model ...
Epoch: 46 cost time: 1.428981065750122
Epoch: 46, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.385 Vali Acc: 0.633 Test Loss: 1.385 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3682434558868408
Epoch: 47, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.370 Vali Acc: 0.639 Test Loss: 1.370 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2785046100616455
Epoch: 48, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.364 Vali Acc: 0.650 Test Loss: 1.364 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649986).  Saving model ...
Epoch: 49 cost time: 1.1198091506958008
Epoch: 49, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.357 Vali Acc: 0.650 Test Loss: 1.357 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 50 cost time: 1.28824782371521
Epoch: 50, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.352 Vali Acc: 0.650 Test Loss: 1.352 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649986).  Saving model ...
Epoch: 51 cost time: 1.2963953018188477
Epoch: 51, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.342 Vali Acc: 0.644 Test Loss: 1.342 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2731733322143555
Epoch: 52, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.340 Vali Acc: 0.644 Test Loss: 1.340 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.061319351196289
Epoch: 53, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.338 Vali Acc: 0.644 Test Loss: 1.338 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.4604442119598389
Epoch: 54, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.324 Vali Acc: 0.656 Test Loss: 1.324 Test Acc: 0.656
Validation loss decreased (-0.649986 --> -0.655542).  Saving model ...
Epoch: 55 cost time: 1.1366355419158936
Epoch: 55, Steps: 12 | Train Loss: 0.843 Vali Loss: 1.312 Vali Acc: 0.656 Test Loss: 1.312 Test Acc: 0.656
Validation loss decreased (-0.655542 --> -0.655542).  Saving model ...
Epoch: 56 cost time: 1.3880231380462646
Epoch: 56, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.301 Vali Acc: 0.661 Test Loss: 1.301 Test Acc: 0.661
Validation loss decreased (-0.655542 --> -0.661098).  Saving model ...
Epoch: 57 cost time: 1.1871671676635742
Epoch: 57, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.300 Vali Acc: 0.656 Test Loss: 1.300 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1800727844238281
Epoch: 58, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.289 Vali Acc: 0.661 Test Loss: 1.289 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 59 cost time: 1.2520062923431396
Epoch: 59, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.282 Vali Acc: 0.661 Test Loss: 1.282 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 60 cost time: 1.2675096988677979
Epoch: 60, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.280 Vali Acc: 0.678 Test Loss: 1.280 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677765).  Saving model ...
Epoch: 61 cost time: 1.392028570175171
Epoch: 61, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.268 Vali Acc: 0.678 Test Loss: 1.268 Test Acc: 0.678
Validation loss decreased (-0.677765 --> -0.677765).  Saving model ...
Epoch: 62 cost time: 1.2336361408233643
Epoch: 62, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.270 Vali Acc: 0.678 Test Loss: 1.270 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1794066429138184
Epoch: 63, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.268 Vali Acc: 0.678 Test Loss: 1.268 Test Acc: 0.678
Validation loss decreased (-0.677765 --> -0.677765).  Saving model ...
Epoch: 64 cost time: 1.2086622714996338
Epoch: 64, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.269 Vali Acc: 0.672 Test Loss: 1.269 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.267773151397705
Epoch: 65, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.266 Vali Acc: 0.683 Test Loss: 1.266 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683321).  Saving model ...
Epoch: 66 cost time: 1.49739670753479
Epoch: 66, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.267 Vali Acc: 0.694 Test Loss: 1.267 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694432).  Saving model ...
Epoch: 67 cost time: 1.1279230117797852
Epoch: 67, Steps: 12 | Train Loss: 0.732 Vali Loss: 1.265 Vali Acc: 0.689 Test Loss: 1.265 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.5371224880218506
Epoch: 68, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.252 Vali Acc: 0.689 Test Loss: 1.252 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.4269206523895264
Epoch: 69, Steps: 12 | Train Loss: 0.715 Vali Loss: 1.256 Vali Acc: 0.689 Test Loss: 1.256 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.215376377105713
Epoch: 70, Steps: 12 | Train Loss: 0.687 Vali Loss: 1.252 Vali Acc: 0.683 Test Loss: 1.252 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.1510045528411865
Epoch: 71, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.255 Vali Acc: 0.689 Test Loss: 1.255 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.4055509567260742
Epoch: 72, Steps: 12 | Train Loss: 0.689 Vali Loss: 1.251 Vali Acc: 0.689 Test Loss: 1.251 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.3659346103668213
Epoch: 73, Steps: 12 | Train Loss: 0.687 Vali Loss: 1.258 Vali Acc: 0.689 Test Loss: 1.258 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.284292221069336
Epoch: 74, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.249 Vali Acc: 0.694 Test Loss: 1.249 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 75 cost time: 1.3101978302001953
Epoch: 75, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.252 Vali Acc: 0.694 Test Loss: 1.252 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.3102238178253174
Epoch: 76, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.246 Vali Acc: 0.683 Test Loss: 1.246 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.296186923980713
Epoch: 77, Steps: 12 | Train Loss: 0.660 Vali Loss: 1.240 Vali Acc: 0.683 Test Loss: 1.240 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.37337064743042
Epoch: 78, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.238 Vali Acc: 0.689 Test Loss: 1.238 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.492600440979004
Epoch: 79, Steps: 12 | Train Loss: 0.622 Vali Loss: 1.236 Vali Acc: 0.689 Test Loss: 1.236 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.1726882457733154
Epoch: 80, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.229 Vali Acc: 0.694 Test Loss: 1.229 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 81 cost time: 1.1868338584899902
Epoch: 81, Steps: 12 | Train Loss: 0.664 Vali Loss: 1.225 Vali Acc: 0.694 Test Loss: 1.225 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 82 cost time: 1.6363544464111328
Epoch: 82, Steps: 12 | Train Loss: 0.657 Vali Loss: 1.221 Vali Acc: 0.689 Test Loss: 1.221 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.304844617843628
Epoch: 83, Steps: 12 | Train Loss: 0.631 Vali Loss: 1.213 Vali Acc: 0.689 Test Loss: 1.213 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.0788905620574951
Epoch: 84, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.218 Vali Acc: 0.694 Test Loss: 1.218 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 85 cost time: 1.6261379718780518
Epoch: 85, Steps: 12 | Train Loss: 0.667 Vali Loss: 1.210 Vali Acc: 0.694 Test Loss: 1.210 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 86 cost time: 1.216642141342163
Epoch: 86, Steps: 12 | Train Loss: 0.576 Vali Loss: 1.212 Vali Acc: 0.689 Test Loss: 1.212 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.1467206478118896
Epoch: 87, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.205 Vali Acc: 0.700 Test Loss: 1.205 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699988).  Saving model ...
Epoch: 88 cost time: 1.5180838108062744
Epoch: 88, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 89 cost time: 1.1942157745361328
Epoch: 89, Steps: 12 | Train Loss: 0.629 Vali Loss: 1.205 Vali Acc: 0.683 Test Loss: 1.205 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.2724952697753906
Epoch: 90, Steps: 12 | Train Loss: 0.577 Vali Loss: 1.200 Vali Acc: 0.694 Test Loss: 1.200 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.1273396015167236
Epoch: 91, Steps: 12 | Train Loss: 0.556 Vali Loss: 1.195 Vali Acc: 0.700 Test Loss: 1.195 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 92 cost time: 1.2436556816101074
Epoch: 92, Steps: 12 | Train Loss: 0.568 Vali Loss: 1.193 Vali Acc: 0.694 Test Loss: 1.193 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.193587303161621
Epoch: 93, Steps: 12 | Train Loss: 0.555 Vali Loss: 1.205 Vali Acc: 0.694 Test Loss: 1.205 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.2366383075714111
Epoch: 94, Steps: 12 | Train Loss: 0.558 Vali Loss: 1.191 Vali Acc: 0.694 Test Loss: 1.191 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.2508766651153564
Epoch: 95, Steps: 12 | Train Loss: 0.550 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.4070501327514648
Epoch: 96, Steps: 12 | Train Loss: 0.542 Vali Loss: 1.201 Vali Acc: 0.706 Test Loss: 1.201 Test Acc: 0.706
Validation loss decreased (-0.699988 --> -0.705544).  Saving model ...
Epoch: 97 cost time: 1.5385515689849854
Epoch: 97, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.199 Vali Acc: 0.689 Test Loss: 1.199 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.4611363410949707
Epoch: 98, Steps: 12 | Train Loss: 0.547 Vali Loss: 1.200 Vali Acc: 0.694 Test Loss: 1.200 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.428828239440918
Epoch: 99, Steps: 12 | Train Loss: 0.533 Vali Loss: 1.191 Vali Acc: 0.706 Test Loss: 1.191 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705544).  Saving model ...
Epoch: 100 cost time: 1.1154725551605225
Epoch: 100, Steps: 12 | Train Loss: 0.514 Vali Loss: 1.201 Vali Acc: 0.706 Test Loss: 1.201 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7055555555555556
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6628384590148926
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.2305922508239746
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.733 Vali Acc: 0.094 Test Loss: 2.733 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.1924355030059814
Epoch: 3, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.711 Vali Acc: 0.106 Test Loss: 2.711 Test Acc: 0.106
Validation loss decreased (-0.094417 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.2712476253509521
Epoch: 4, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.688 Vali Acc: 0.106 Test Loss: 2.688 Test Acc: 0.106
Validation loss decreased (-0.105528 --> -0.105529).  Saving model ...
Epoch: 5 cost time: 1.5028376579284668
Epoch: 5, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.663 Vali Acc: 0.122 Test Loss: 2.663 Test Acc: 0.122
Validation loss decreased (-0.105529 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.0623588562011719
Epoch: 6, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.636 Vali Acc: 0.128 Test Loss: 2.636 Test Acc: 0.128
Validation loss decreased (-0.122196 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 1.1788122653961182
Epoch: 7, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.606 Vali Acc: 0.172 Test Loss: 2.606 Test Acc: 0.172
Validation loss decreased (-0.127751 --> -0.172196).  Saving model ...
Epoch: 8 cost time: 1.2610957622528076
Epoch: 8, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.577 Vali Acc: 0.206 Test Loss: 2.577 Test Acc: 0.206
Validation loss decreased (-0.172196 --> -0.205530).  Saving model ...
Epoch: 9 cost time: 1.2626304626464844
Epoch: 9, Steps: 12 | Train Loss: 2.494 Vali Loss: 2.546 Vali Acc: 0.233 Test Loss: 2.546 Test Acc: 0.233
Validation loss decreased (-0.205530 --> -0.233308).  Saving model ...
Epoch: 10 cost time: 1.4279415607452393
Epoch: 10, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.509 Vali Acc: 0.278 Test Loss: 2.509 Test Acc: 0.278
Validation loss decreased (-0.233308 --> -0.277753).  Saving model ...
Epoch: 11 cost time: 1.4557723999023438
Epoch: 11, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.474 Vali Acc: 0.300 Test Loss: 2.474 Test Acc: 0.300
Validation loss decreased (-0.277753 --> -0.299975).  Saving model ...
Epoch: 12 cost time: 1.5695116519927979
Epoch: 12, Steps: 12 | Train Loss: 2.363 Vali Loss: 2.441 Vali Acc: 0.306 Test Loss: 2.441 Test Acc: 0.306
Validation loss decreased (-0.299975 --> -0.305531).  Saving model ...
Epoch: 13 cost time: 1.430462121963501
Epoch: 13, Steps: 12 | Train Loss: 2.318 Vali Loss: 2.398 Vali Acc: 0.328 Test Loss: 2.398 Test Acc: 0.328
Validation loss decreased (-0.305531 --> -0.327754).  Saving model ...
Epoch: 14 cost time: 1.172743797302246
Epoch: 14, Steps: 12 | Train Loss: 2.261 Vali Loss: 2.356 Vali Acc: 0.361 Test Loss: 2.356 Test Acc: 0.361
Validation loss decreased (-0.327754 --> -0.361088).  Saving model ...
Epoch: 15 cost time: 1.1243896484375
Epoch: 15, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.313 Vali Acc: 0.389 Test Loss: 2.313 Test Acc: 0.389
Validation loss decreased (-0.361088 --> -0.388866).  Saving model ...
Epoch: 16 cost time: 1.454857349395752
Epoch: 16, Steps: 12 | Train Loss: 2.138 Vali Loss: 2.266 Vali Acc: 0.406 Test Loss: 2.266 Test Acc: 0.406
Validation loss decreased (-0.388866 --> -0.405533).  Saving model ...
Epoch: 17 cost time: 1.1055629253387451
Epoch: 17, Steps: 12 | Train Loss: 2.114 Vali Loss: 2.211 Vali Acc: 0.439 Test Loss: 2.211 Test Acc: 0.439
Validation loss decreased (-0.405533 --> -0.438867).  Saving model ...
Epoch: 18 cost time: 1.2202794551849365
Epoch: 18, Steps: 12 | Train Loss: 2.040 Vali Loss: 2.164 Vali Acc: 0.456 Test Loss: 2.164 Test Acc: 0.456
Validation loss decreased (-0.438867 --> -0.455534).  Saving model ...
Epoch: 19 cost time: 1.158393383026123
Epoch: 19, Steps: 12 | Train Loss: 1.979 Vali Loss: 2.111 Vali Acc: 0.489 Test Loss: 2.111 Test Acc: 0.489
Validation loss decreased (-0.455534 --> -0.488868).  Saving model ...
Epoch: 20 cost time: 1.3857998847961426
Epoch: 20, Steps: 12 | Train Loss: 1.898 Vali Loss: 2.057 Vali Acc: 0.511 Test Loss: 2.057 Test Acc: 0.511
Validation loss decreased (-0.488868 --> -0.511091).  Saving model ...
Epoch: 21 cost time: 1.0969464778900146
Epoch: 21, Steps: 12 | Train Loss: 1.836 Vali Loss: 2.000 Vali Acc: 0.533 Test Loss: 2.000 Test Acc: 0.533
Validation loss decreased (-0.511091 --> -0.533313).  Saving model ...
Epoch: 22 cost time: 1.2528026103973389
Epoch: 22, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.951 Vali Acc: 0.550 Test Loss: 1.951 Test Acc: 0.550
Validation loss decreased (-0.533313 --> -0.549980).  Saving model ...
Epoch: 23 cost time: 1.0262041091918945
Epoch: 23, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.906 Vali Acc: 0.561 Test Loss: 1.906 Test Acc: 0.561
Validation loss decreased (-0.549980 --> -0.561092).  Saving model ...
Epoch: 24 cost time: 1.0788331031799316
Epoch: 24, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.866 Vali Acc: 0.556 Test Loss: 1.866 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2690722942352295
Epoch: 25, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.821 Vali Acc: 0.544 Test Loss: 1.821 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0292584896087646
Epoch: 26, Steps: 12 | Train Loss: 1.524 Vali Loss: 1.786 Vali Acc: 0.556 Test Loss: 1.786 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9879441261291504
Epoch: 27, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.751 Vali Acc: 0.550 Test Loss: 1.751 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4560437202453613
Epoch: 28, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.719 Vali Acc: 0.567 Test Loss: 1.719 Test Acc: 0.567
Validation loss decreased (-0.561092 --> -0.566649).  Saving model ...
Epoch: 29 cost time: 1.2439582347869873
Epoch: 29, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.699 Vali Acc: 0.561 Test Loss: 1.699 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.018270492553711
Epoch: 30, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.673 Vali Acc: 0.583 Test Loss: 1.673 Test Acc: 0.583
Validation loss decreased (-0.566649 --> -0.583317).  Saving model ...
Epoch: 31 cost time: 1.2849962711334229
Epoch: 31, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.634 Vali Acc: 0.583 Test Loss: 1.634 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 32 cost time: 1.3942532539367676
Epoch: 32, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.612 Vali Acc: 0.578 Test Loss: 1.612 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2039377689361572
Epoch: 33, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.597 Vali Acc: 0.589 Test Loss: 1.597 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 34 cost time: 1.30503249168396
Epoch: 34, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.575 Vali Acc: 0.606 Test Loss: 1.575 Test Acc: 0.606
Validation loss decreased (-0.588873 --> -0.605540).  Saving model ...
Epoch: 35 cost time: 1.3577208518981934
Epoch: 35, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.561 Vali Acc: 0.617 Test Loss: 1.561 Test Acc: 0.617
Validation loss decreased (-0.605540 --> -0.616651).  Saving model ...
Epoch: 36 cost time: 1.2893946170806885
Epoch: 36, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.538 Vali Acc: 0.617 Test Loss: 1.538 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 37 cost time: 1.0801398754119873
Epoch: 37, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.508 Vali Acc: 0.611 Test Loss: 1.508 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1464786529541016
Epoch: 38, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.490 Vali Acc: 0.611 Test Loss: 1.490 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.256279706954956
Epoch: 39, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.478 Vali Acc: 0.622 Test Loss: 1.478 Test Acc: 0.622
Validation loss decreased (-0.616651 --> -0.622207).  Saving model ...
Epoch: 40 cost time: 1.355548620223999
Epoch: 40, Steps: 12 | Train Loss: 1.174 Vali Loss: 1.463 Vali Acc: 0.617 Test Loss: 1.463 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2199935913085938
Epoch: 41, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.442 Vali Acc: 0.622 Test Loss: 1.442 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622208).  Saving model ...
Epoch: 42 cost time: 1.5833992958068848
Epoch: 42, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.437 Vali Acc: 0.633 Test Loss: 1.437 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633319).  Saving model ...
Epoch: 43 cost time: 1.2459874153137207
Epoch: 43, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.425 Vali Acc: 0.633 Test Loss: 1.425 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 1.2960829734802246
Epoch: 44, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.409 Vali Acc: 0.633 Test Loss: 1.409 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 45 cost time: 1.3576037883758545
Epoch: 45, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.394 Vali Acc: 0.639 Test Loss: 1.394 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638875).  Saving model ...
Epoch: 46 cost time: 1.1942460536956787
Epoch: 46, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.384 Vali Acc: 0.633 Test Loss: 1.384 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1547291278839111
Epoch: 47, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.369 Vali Acc: 0.633 Test Loss: 1.369 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2849435806274414
Epoch: 48, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.363 Vali Acc: 0.644 Test Loss: 1.363 Test Acc: 0.644
Validation loss decreased (-0.638875 --> -0.644431).  Saving model ...
Epoch: 49 cost time: 1.1072328090667725
Epoch: 49, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.357 Vali Acc: 0.644 Test Loss: 1.357 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 50 cost time: 1.2354965209960938
Epoch: 50, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.353 Vali Acc: 0.650 Test Loss: 1.353 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649986).  Saving model ...
Epoch: 51 cost time: 1.2902576923370361
Epoch: 51, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.343 Vali Acc: 0.650 Test Loss: 1.343 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649987).  Saving model ...
Epoch: 52 cost time: 1.2255046367645264
Epoch: 52, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.340 Vali Acc: 0.650 Test Loss: 1.340 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 53 cost time: 1.2420070171356201
Epoch: 53, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.339 Vali Acc: 0.644 Test Loss: 1.339 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.233734369277954
Epoch: 54, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.325 Vali Acc: 0.661 Test Loss: 1.325 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 55 cost time: 1.101419448852539
Epoch: 55, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.312 Vali Acc: 0.656 Test Loss: 1.312 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3816516399383545
Epoch: 56, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.302 Vali Acc: 0.656 Test Loss: 1.302 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2297534942626953
Epoch: 57, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.300 Vali Acc: 0.661 Test Loss: 1.300 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 58 cost time: 1.2528951168060303
Epoch: 58, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.289 Vali Acc: 0.661 Test Loss: 1.289 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 59 cost time: 1.205362319946289
Epoch: 59, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.282 Vali Acc: 0.672 Test Loss: 1.282 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672209).  Saving model ...
Epoch: 60 cost time: 1.244821548461914
Epoch: 60, Steps: 12 | Train Loss: 0.857 Vali Loss: 1.280 Vali Acc: 0.683 Test Loss: 1.280 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683321).  Saving model ...
Epoch: 61 cost time: 1.4203271865844727
Epoch: 61, Steps: 12 | Train Loss: 0.820 Vali Loss: 1.269 Vali Acc: 0.683 Test Loss: 1.269 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 62 cost time: 1.335298776626587
Epoch: 62, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.271 Vali Acc: 0.672 Test Loss: 1.271 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.4590823650360107
Epoch: 63, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.269 Vali Acc: 0.672 Test Loss: 1.269 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2870433330535889
Epoch: 64, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.270 Vali Acc: 0.672 Test Loss: 1.270 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.2754545211791992
Epoch: 65, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.267 Vali Acc: 0.678 Test Loss: 1.267 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.265104055404663
Epoch: 66, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.268 Vali Acc: 0.683 Test Loss: 1.268 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 67 cost time: 1.3764939308166504
Epoch: 67, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.266 Vali Acc: 0.694 Test Loss: 1.266 Test Acc: 0.694
Validation loss decreased (-0.683321 --> -0.694432).  Saving model ...
Epoch: 68 cost time: 1.5324921607971191
Epoch: 68, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.252 Vali Acc: 0.694 Test Loss: 1.252 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 69 cost time: 1.5826857089996338
Epoch: 69, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.256 Vali Acc: 0.694 Test Loss: 1.256 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.2099874019622803
Epoch: 70, Steps: 12 | Train Loss: 0.690 Vali Loss: 1.253 Vali Acc: 0.689 Test Loss: 1.253 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.3242924213409424
Epoch: 71, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.255 Vali Acc: 0.694 Test Loss: 1.255 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.5583715438842773
Epoch: 72, Steps: 12 | Train Loss: 0.692 Vali Loss: 1.251 Vali Acc: 0.683 Test Loss: 1.251 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.5384643077850342
Epoch: 73, Steps: 12 | Train Loss: 0.690 Vali Loss: 1.259 Vali Acc: 0.689 Test Loss: 1.259 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.3828496932983398
Epoch: 74, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.249 Vali Acc: 0.694 Test Loss: 1.249 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 75 cost time: 1.2385807037353516
Epoch: 75, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.251 Vali Acc: 0.694 Test Loss: 1.251 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.5966858863830566
Epoch: 76, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.245 Vali Acc: 0.694 Test Loss: 1.245 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 77 cost time: 1.2759144306182861
Epoch: 77, Steps: 12 | Train Loss: 0.663 Vali Loss: 1.240 Vali Acc: 0.694 Test Loss: 1.240 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 78 cost time: 1.2572050094604492
Epoch: 78, Steps: 12 | Train Loss: 0.637 Vali Loss: 1.237 Vali Acc: 0.694 Test Loss: 1.237 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 79 cost time: 1.1155951023101807
Epoch: 79, Steps: 12 | Train Loss: 0.626 Vali Loss: 1.235 Vali Acc: 0.694 Test Loss: 1.235 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 80 cost time: 1.2803215980529785
Epoch: 80, Steps: 12 | Train Loss: 0.699 Vali Loss: 1.228 Vali Acc: 0.700 Test Loss: 1.228 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699988).  Saving model ...
Epoch: 81 cost time: 1.3483095169067383
Epoch: 81, Steps: 12 | Train Loss: 0.664 Vali Loss: 1.224 Vali Acc: 0.694 Test Loss: 1.224 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.621812343597412
Epoch: 82, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.221 Vali Acc: 0.689 Test Loss: 1.221 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.2656571865081787
Epoch: 83, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.213 Vali Acc: 0.689 Test Loss: 1.213 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.4003515243530273
Epoch: 84, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.217 Vali Acc: 0.694 Test Loss: 1.217 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.3042855262756348
Epoch: 85, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.209 Vali Acc: 0.689 Test Loss: 1.209 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.2200627326965332
Epoch: 86, Steps: 12 | Train Loss: 0.578 Vali Loss: 1.211 Vali Acc: 0.694 Test Loss: 1.211 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.4241793155670166
Epoch: 87, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.204 Vali Acc: 0.694 Test Loss: 1.204 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.2245478630065918
Epoch: 88, Steps: 12 | Train Loss: 0.565 Vali Loss: 1.201 Vali Acc: 0.694 Test Loss: 1.201 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.2292020320892334
Epoch: 89, Steps: 12 | Train Loss: 0.631 Vali Loss: 1.203 Vali Acc: 0.689 Test Loss: 1.203 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.3161628246307373
Epoch: 90, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.199 Vali Acc: 0.694 Test Loss: 1.199 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         16                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2280538082122803
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.1482293605804443
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.733 Vali Acc: 0.094 Test Loss: 2.733 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.0444729328155518
Epoch: 3, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.712 Vali Acc: 0.106 Test Loss: 2.712 Test Acc: 0.106
Validation loss decreased (-0.094417 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 1.053421974182129
Epoch: 4, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.689 Vali Acc: 0.106 Test Loss: 2.689 Test Acc: 0.106
Validation loss decreased (-0.105528 --> -0.105529).  Saving model ...
Epoch: 5 cost time: 1.311418056488037
Epoch: 5, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.664 Vali Acc: 0.122 Test Loss: 2.664 Test Acc: 0.122
Validation loss decreased (-0.105529 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.4473741054534912
Epoch: 6, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.638 Vali Acc: 0.128 Test Loss: 2.638 Test Acc: 0.128
Validation loss decreased (-0.122196 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 1.2564125061035156
Epoch: 7, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.608 Vali Acc: 0.167 Test Loss: 2.608 Test Acc: 0.167
Validation loss decreased (-0.127751 --> -0.166641).  Saving model ...
Epoch: 8 cost time: 1.153362512588501
Epoch: 8, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.579 Vali Acc: 0.200 Test Loss: 2.579 Test Acc: 0.200
Validation loss decreased (-0.166641 --> -0.199974).  Saving model ...
Epoch: 9 cost time: 1.4073455333709717
Epoch: 9, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.549 Vali Acc: 0.239 Test Loss: 2.549 Test Acc: 0.239
Validation loss decreased (-0.199974 --> -0.238863).  Saving model ...
Epoch: 10 cost time: 1.0765762329101562
Epoch: 10, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.512 Vali Acc: 0.267 Test Loss: 2.512 Test Acc: 0.267
Validation loss decreased (-0.238863 --> -0.266642).  Saving model ...
Epoch: 11 cost time: 1.2413301467895508
Epoch: 11, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.478 Vali Acc: 0.294 Test Loss: 2.478 Test Acc: 0.294
Validation loss decreased (-0.266642 --> -0.294420).  Saving model ...
Epoch: 12 cost time: 1.317079782485962
Epoch: 12, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.444 Vali Acc: 0.306 Test Loss: 2.444 Test Acc: 0.306
Validation loss decreased (-0.294420 --> -0.305531).  Saving model ...
Epoch: 13 cost time: 1.2852613925933838
Epoch: 13, Steps: 12 | Train Loss: 2.323 Vali Loss: 2.402 Vali Acc: 0.333 Test Loss: 2.402 Test Acc: 0.333
Validation loss decreased (-0.305531 --> -0.333309).  Saving model ...
Epoch: 14 cost time: 1.1612837314605713
Epoch: 14, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.360 Vali Acc: 0.372 Test Loss: 2.360 Test Acc: 0.372
Validation loss decreased (-0.333309 --> -0.372199).  Saving model ...
Epoch: 15 cost time: 1.2305915355682373
Epoch: 15, Steps: 12 | Train Loss: 2.206 Vali Loss: 2.318 Vali Acc: 0.378 Test Loss: 2.318 Test Acc: 0.378
Validation loss decreased (-0.372199 --> -0.377755).  Saving model ...
Epoch: 16 cost time: 1.1533937454223633
Epoch: 16, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.271 Vali Acc: 0.406 Test Loss: 2.271 Test Acc: 0.406
Validation loss decreased (-0.377755 --> -0.405533).  Saving model ...
Epoch: 17 cost time: 1.219998836517334
Epoch: 17, Steps: 12 | Train Loss: 2.122 Vali Loss: 2.216 Vali Acc: 0.428 Test Loss: 2.216 Test Acc: 0.428
Validation loss decreased (-0.405533 --> -0.427756).  Saving model ...
Epoch: 18 cost time: 1.0869884490966797
Epoch: 18, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.170 Vali Acc: 0.439 Test Loss: 2.170 Test Acc: 0.439
Validation loss decreased (-0.427756 --> -0.438867).  Saving model ...
Epoch: 19 cost time: 1.1897475719451904
Epoch: 19, Steps: 12 | Train Loss: 1.985 Vali Loss: 2.117 Vali Acc: 0.478 Test Loss: 2.117 Test Acc: 0.478
Validation loss decreased (-0.438867 --> -0.477757).  Saving model ...
Epoch: 20 cost time: 1.331709623336792
Epoch: 20, Steps: 12 | Train Loss: 1.909 Vali Loss: 2.063 Vali Acc: 0.500 Test Loss: 2.063 Test Acc: 0.500
Validation loss decreased (-0.477757 --> -0.499979).  Saving model ...
Epoch: 21 cost time: 1.2984347343444824
Epoch: 21, Steps: 12 | Train Loss: 1.846 Vali Loss: 2.007 Vali Acc: 0.511 Test Loss: 2.007 Test Acc: 0.511
Validation loss decreased (-0.499979 --> -0.511091).  Saving model ...
Epoch: 22 cost time: 1.110640287399292
Epoch: 22, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.958 Vali Acc: 0.539 Test Loss: 1.958 Test Acc: 0.539
Validation loss decreased (-0.511091 --> -0.538869).  Saving model ...
Epoch: 23 cost time: 1.30613112449646
Epoch: 23, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.914 Vali Acc: 0.544 Test Loss: 1.914 Test Acc: 0.544
Validation loss decreased (-0.538869 --> -0.544425).  Saving model ...
Epoch: 24 cost time: 1.2608108520507812
Epoch: 24, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.874 Vali Acc: 0.556 Test Loss: 1.874 Test Acc: 0.556
Validation loss decreased (-0.544425 --> -0.555537).  Saving model ...
Epoch: 25 cost time: 1.3229689598083496
Epoch: 25, Steps: 12 | Train Loss: 1.604 Vali Loss: 1.828 Vali Acc: 0.544 Test Loss: 1.828 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3182106018066406
Epoch: 26, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.793 Vali Acc: 0.567 Test Loss: 1.793 Test Acc: 0.567
Validation loss decreased (-0.555537 --> -0.566649).  Saving model ...
Epoch: 27 cost time: 1.4445080757141113
Epoch: 27, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.757 Vali Acc: 0.561 Test Loss: 1.757 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6013925075531006
Epoch: 28, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.725 Vali Acc: 0.572 Test Loss: 1.725 Test Acc: 0.572
Validation loss decreased (-0.566649 --> -0.572205).  Saving model ...
Epoch: 29 cost time: 1.2978050708770752
Epoch: 29, Steps: 12 | Train Loss: 1.434 Vali Loss: 1.703 Vali Acc: 0.572 Test Loss: 1.703 Test Acc: 0.572
Validation loss decreased (-0.572205 --> -0.572205).  Saving model ...
Epoch: 30 cost time: 1.5337259769439697
Epoch: 30, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.677 Vali Acc: 0.583 Test Loss: 1.677 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583317).  Saving model ...
Epoch: 31 cost time: 1.38568115234375
Epoch: 31, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.637 Vali Acc: 0.578 Test Loss: 1.637 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.36509108543396
Epoch: 32, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.615 Vali Acc: 0.583 Test Loss: 1.615 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 33 cost time: 1.1113598346710205
Epoch: 33, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.599 Vali Acc: 0.583 Test Loss: 1.599 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 34 cost time: 1.2248294353485107
Epoch: 34, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.577 Vali Acc: 0.600 Test Loss: 1.577 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599984).  Saving model ...
Epoch: 35 cost time: 1.3939592838287354
Epoch: 35, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.562 Vali Acc: 0.606 Test Loss: 1.562 Test Acc: 0.606
Validation loss decreased (-0.599984 --> -0.605540).  Saving model ...
Epoch: 36 cost time: 1.5438060760498047
Epoch: 36, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.540 Vali Acc: 0.600 Test Loss: 1.540 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1622822284698486
Epoch: 37, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.509 Vali Acc: 0.594 Test Loss: 1.509 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6881828308105469
Epoch: 38, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.491 Vali Acc: 0.600 Test Loss: 1.491 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3730831146240234
Epoch: 39, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.479 Vali Acc: 0.611 Test Loss: 1.479 Test Acc: 0.611
Validation loss decreased (-0.605540 --> -0.611096).  Saving model ...
Epoch: 40 cost time: 1.826676607131958
Epoch: 40, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.464 Vali Acc: 0.622 Test Loss: 1.464 Test Acc: 0.622
Validation loss decreased (-0.611096 --> -0.622208).  Saving model ...
Epoch: 41 cost time: 1.395827293395996
Epoch: 41, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.443 Vali Acc: 0.622 Test Loss: 1.443 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622208).  Saving model ...
Epoch: 42 cost time: 1.4941768646240234
Epoch: 42, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.438 Vali Acc: 0.622 Test Loss: 1.438 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622208).  Saving model ...
Epoch: 43 cost time: 1.3306152820587158
Epoch: 43, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.425 Vali Acc: 0.628 Test Loss: 1.425 Test Acc: 0.628
Validation loss decreased (-0.622208 --> -0.627764).  Saving model ...
Epoch: 44 cost time: 1.419365644454956
Epoch: 44, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.409 Vali Acc: 0.633 Test Loss: 1.409 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633319).  Saving model ...
Epoch: 45 cost time: 1.3646817207336426
Epoch: 45, Steps: 12 | Train Loss: 1.037 Vali Loss: 1.394 Vali Acc: 0.639 Test Loss: 1.394 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638875).  Saving model ...
Epoch: 46 cost time: 1.4570565223693848
Epoch: 46, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.384 Vali Acc: 0.633 Test Loss: 1.384 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7831122875213623
Epoch: 47, Steps: 12 | Train Loss: 1.043 Vali Loss: 1.369 Vali Acc: 0.622 Test Loss: 1.369 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5980429649353027
Epoch: 48, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.363 Vali Acc: 0.633 Test Loss: 1.363 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.7838754653930664
Epoch: 49, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.357 Vali Acc: 0.644 Test Loss: 1.357 Test Acc: 0.644
Validation loss decreased (-0.638875 --> -0.644431).  Saving model ...
Epoch: 50 cost time: 1.6271235942840576
Epoch: 50, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.353 Vali Acc: 0.644 Test Loss: 1.353 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 51 cost time: 1.5877127647399902
Epoch: 51, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.342 Vali Acc: 0.650 Test Loss: 1.342 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649987).  Saving model ...
Epoch: 52 cost time: 1.5210411548614502
Epoch: 52, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.339 Vali Acc: 0.644 Test Loss: 1.339 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3857800960540771
Epoch: 53, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.338 Vali Acc: 0.650 Test Loss: 1.338 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 54 cost time: 1.5451247692108154
Epoch: 54, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.324 Vali Acc: 0.661 Test Loss: 1.324 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 55 cost time: 1.1988310813903809
Epoch: 55, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.311 Vali Acc: 0.656 Test Loss: 1.311 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.5630481243133545
Epoch: 56, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.300 Vali Acc: 0.661 Test Loss: 1.300 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 57 cost time: 1.5912165641784668
Epoch: 57, Steps: 12 | Train Loss: 0.853 Vali Loss: 1.299 Vali Acc: 0.661 Test Loss: 1.299 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 58 cost time: 1.8040790557861328
Epoch: 58, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.287 Vali Acc: 0.672 Test Loss: 1.287 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672209).  Saving model ...
Epoch: 59 cost time: 1.3066604137420654
Epoch: 59, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.280 Vali Acc: 0.667 Test Loss: 1.280 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.5305454730987549
Epoch: 60, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.278 Vali Acc: 0.683 Test Loss: 1.278 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683321).  Saving model ...
Epoch: 61 cost time: 1.4943959712982178
Epoch: 61, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.266 Vali Acc: 0.683 Test Loss: 1.266 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 62 cost time: 1.431483507156372
Epoch: 62, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.268 Vali Acc: 0.667 Test Loss: 1.268 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.199476957321167
Epoch: 63, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.266 Vali Acc: 0.678 Test Loss: 1.266 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.3146357536315918
Epoch: 64, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.268 Vali Acc: 0.678 Test Loss: 1.268 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.3584754467010498
Epoch: 65, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.265 Vali Acc: 0.683 Test Loss: 1.265 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 66 cost time: 1.4798705577850342
Epoch: 66, Steps: 12 | Train Loss: 0.745 Vali Loss: 1.266 Vali Acc: 0.689 Test Loss: 1.266 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688876).  Saving model ...
Epoch: 67 cost time: 1.3233067989349365
Epoch: 67, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.263 Vali Acc: 0.694 Test Loss: 1.263 Test Acc: 0.694
Validation loss decreased (-0.688876 --> -0.694432).  Saving model ...
Epoch: 68 cost time: 1.4833006858825684
Epoch: 68, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.249 Vali Acc: 0.694 Test Loss: 1.249 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 69 cost time: 1.2389109134674072
Epoch: 69, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.253 Vali Acc: 0.694 Test Loss: 1.253 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.301072597503662
Epoch: 70, Steps: 12 | Train Loss: 0.694 Vali Loss: 1.250 Vali Acc: 0.694 Test Loss: 1.250 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.280576467514038
Epoch: 71, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.252 Vali Acc: 0.694 Test Loss: 1.252 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.3893978595733643
Epoch: 72, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.248 Vali Acc: 0.683 Test Loss: 1.248 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.343247890472412
Epoch: 73, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.256 Vali Acc: 0.689 Test Loss: 1.256 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.2406723499298096
Epoch: 74, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.246 Vali Acc: 0.694 Test Loss: 1.246 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 75 cost time: 1.3616352081298828
Epoch: 75, Steps: 12 | Train Loss: 0.705 Vali Loss: 1.248 Vali Acc: 0.694 Test Loss: 1.248 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.1583900451660156
Epoch: 76, Steps: 12 | Train Loss: 0.680 Vali Loss: 1.242 Vali Acc: 0.694 Test Loss: 1.242 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 77 cost time: 1.265629529953003
Epoch: 77, Steps: 12 | Train Loss: 0.667 Vali Loss: 1.237 Vali Acc: 0.694 Test Loss: 1.237 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 78 cost time: 1.1601440906524658
Epoch: 78, Steps: 12 | Train Loss: 0.640 Vali Loss: 1.233 Vali Acc: 0.694 Test Loss: 1.233 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 79 cost time: 1.2093188762664795
Epoch: 79, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.232 Vali Acc: 0.694 Test Loss: 1.232 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 80 cost time: 1.3223588466644287
Epoch: 80, Steps: 12 | Train Loss: 0.703 Vali Loss: 1.224 Vali Acc: 0.706 Test Loss: 1.224 Test Acc: 0.706
Validation loss decreased (-0.694432 --> -0.705543).  Saving model ...
Epoch: 81 cost time: 1.348419427871704
Epoch: 81, Steps: 12 | Train Loss: 0.666 Vali Loss: 1.221 Vali Acc: 0.694 Test Loss: 1.221 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.708369255065918
Epoch: 82, Steps: 12 | Train Loss: 0.663 Vali Loss: 1.218 Vali Acc: 0.694 Test Loss: 1.218 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.3121440410614014
Epoch: 83, Steps: 12 | Train Loss: 0.637 Vali Loss: 1.210 Vali Acc: 0.694 Test Loss: 1.210 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.4756157398223877
Epoch: 84, Steps: 12 | Train Loss: 0.678 Vali Loss: 1.214 Vali Acc: 0.694 Test Loss: 1.214 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.5270404815673828
Epoch: 85, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.206 Vali Acc: 0.689 Test Loss: 1.206 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.2455871105194092
Epoch: 86, Steps: 12 | Train Loss: 0.581 Vali Loss: 1.208 Vali Acc: 0.694 Test Loss: 1.208 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.4317655563354492
Epoch: 87, Steps: 12 | Train Loss: 0.587 Vali Loss: 1.201 Vali Acc: 0.700 Test Loss: 1.201 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.2187199592590332
Epoch: 88, Steps: 12 | Train Loss: 0.568 Vali Loss: 1.198 Vali Acc: 0.700 Test Loss: 1.198 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.3208894729614258
Epoch: 89, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.200 Vali Acc: 0.694 Test Loss: 1.200 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.618323564529419
Epoch: 90, Steps: 12 | Train Loss: 0.581 Vali Loss: 1.197 Vali Acc: 0.700 Test Loss: 1.197 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7055555555555556
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.140404939651489
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.5056354999542236
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.733 Vali Acc: 0.094 Test Loss: 2.733 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.6087000370025635
Epoch: 3, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.712 Vali Acc: 0.111 Test Loss: 2.712 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.553926706314087
Epoch: 4, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.689 Vali Acc: 0.106 Test Loss: 2.689 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4622266292572021
Epoch: 5, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.665 Vali Acc: 0.122 Test Loss: 2.665 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.5917813777923584
Epoch: 6, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.639 Vali Acc: 0.128 Test Loss: 2.639 Test Acc: 0.128
Validation loss decreased (-0.122196 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 1.4607303142547607
Epoch: 7, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.610 Vali Acc: 0.156 Test Loss: 2.610 Test Acc: 0.156
Validation loss decreased (-0.127751 --> -0.155529).  Saving model ...
Epoch: 8 cost time: 1.3825933933258057
Epoch: 8, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.581 Vali Acc: 0.194 Test Loss: 2.581 Test Acc: 0.194
Validation loss decreased (-0.155529 --> -0.194419).  Saving model ...
Epoch: 9 cost time: 1.6376748085021973
Epoch: 9, Steps: 12 | Train Loss: 2.501 Vali Loss: 2.551 Vali Acc: 0.228 Test Loss: 2.551 Test Acc: 0.228
Validation loss decreased (-0.194419 --> -0.227752).  Saving model ...
Epoch: 10 cost time: 1.3007287979125977
Epoch: 10, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.514 Vali Acc: 0.267 Test Loss: 2.514 Test Acc: 0.267
Validation loss decreased (-0.227752 --> -0.266642).  Saving model ...
Epoch: 11 cost time: 1.8262648582458496
Epoch: 11, Steps: 12 | Train Loss: 2.415 Vali Loss: 2.481 Vali Acc: 0.294 Test Loss: 2.481 Test Acc: 0.294
Validation loss decreased (-0.266642 --> -0.294420).  Saving model ...
Epoch: 12 cost time: 1.4264185428619385
Epoch: 12, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.448 Vali Acc: 0.300 Test Loss: 2.448 Test Acc: 0.300
Validation loss decreased (-0.294420 --> -0.299976).  Saving model ...
Epoch: 13 cost time: 1.6624994277954102
Epoch: 13, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.406 Vali Acc: 0.333 Test Loss: 2.406 Test Acc: 0.333
Validation loss decreased (-0.299976 --> -0.333309).  Saving model ...
Epoch: 14 cost time: 1.3053233623504639
Epoch: 14, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.364 Vali Acc: 0.372 Test Loss: 2.364 Test Acc: 0.372
Validation loss decreased (-0.333309 --> -0.372199).  Saving model ...
Epoch: 15 cost time: 1.5848407745361328
Epoch: 15, Steps: 12 | Train Loss: 2.214 Vali Loss: 2.323 Vali Acc: 0.378 Test Loss: 2.323 Test Acc: 0.378
Validation loss decreased (-0.372199 --> -0.377755).  Saving model ...
Epoch: 16 cost time: 1.475649356842041
Epoch: 16, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.277 Vali Acc: 0.389 Test Loss: 2.277 Test Acc: 0.389
Validation loss decreased (-0.377755 --> -0.388866).  Saving model ...
Epoch: 17 cost time: 1.5316050052642822
Epoch: 17, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.222 Vali Acc: 0.428 Test Loss: 2.222 Test Acc: 0.428
Validation loss decreased (-0.388866 --> -0.427756).  Saving model ...
Epoch: 18 cost time: 1.8475961685180664
Epoch: 18, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.176 Vali Acc: 0.428 Test Loss: 2.176 Test Acc: 0.428
Validation loss decreased (-0.427756 --> -0.427756).  Saving model ...
Epoch: 19 cost time: 1.5284829139709473
Epoch: 19, Steps: 12 | Train Loss: 1.993 Vali Loss: 2.124 Vali Acc: 0.456 Test Loss: 2.124 Test Acc: 0.456
Validation loss decreased (-0.427756 --> -0.455534).  Saving model ...
Epoch: 20 cost time: 1.5111567974090576
Epoch: 20, Steps: 12 | Train Loss: 1.920 Vali Loss: 2.071 Vali Acc: 0.494 Test Loss: 2.071 Test Acc: 0.494
Validation loss decreased (-0.455534 --> -0.494424).  Saving model ...
Epoch: 21 cost time: 1.4154181480407715
Epoch: 21, Steps: 12 | Train Loss: 1.857 Vali Loss: 2.015 Vali Acc: 0.511 Test Loss: 2.015 Test Acc: 0.511
Validation loss decreased (-0.494424 --> -0.511091).  Saving model ...
Epoch: 22 cost time: 1.3594062328338623
Epoch: 22, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.966 Vali Acc: 0.533 Test Loss: 1.966 Test Acc: 0.533
Validation loss decreased (-0.511091 --> -0.533314).  Saving model ...
Epoch: 23 cost time: 1.2811274528503418
Epoch: 23, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.922 Vali Acc: 0.544 Test Loss: 1.922 Test Acc: 0.544
Validation loss decreased (-0.533314 --> -0.544425).  Saving model ...
Epoch: 24 cost time: 1.5054912567138672
Epoch: 24, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.882 Vali Acc: 0.539 Test Loss: 1.882 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2399427890777588
Epoch: 25, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.836 Vali Acc: 0.539 Test Loss: 1.836 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3439197540283203
Epoch: 26, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.801 Vali Acc: 0.561 Test Loss: 1.801 Test Acc: 0.561
Validation loss decreased (-0.544425 --> -0.561093).  Saving model ...
Epoch: 27 cost time: 1.4864346981048584
Epoch: 27, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.765 Vali Acc: 0.561 Test Loss: 1.765 Test Acc: 0.561
Validation loss decreased (-0.561093 --> -0.561093).  Saving model ...
Epoch: 28 cost time: 1.474815845489502
Epoch: 28, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.732 Vali Acc: 0.572 Test Loss: 1.732 Test Acc: 0.572
Validation loss decreased (-0.561093 --> -0.572205).  Saving model ...
Epoch: 29 cost time: 1.4912989139556885
Epoch: 29, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.710 Vali Acc: 0.567 Test Loss: 1.710 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6340792179107666
Epoch: 30, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.683 Vali Acc: 0.572 Test Loss: 1.683 Test Acc: 0.572
Validation loss decreased (-0.572205 --> -0.572205).  Saving model ...
Epoch: 31 cost time: 1.5414979457855225
Epoch: 31, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.642 Vali Acc: 0.583 Test Loss: 1.642 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583317).  Saving model ...
Epoch: 32 cost time: 1.429246425628662
Epoch: 32, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.619 Vali Acc: 0.578 Test Loss: 1.619 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3021738529205322
Epoch: 33, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.603 Vali Acc: 0.567 Test Loss: 1.603 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6554698944091797
Epoch: 34, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.580 Vali Acc: 0.578 Test Loss: 1.580 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.538581132888794
Epoch: 35, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.565 Vali Acc: 0.600 Test Loss: 1.565 Test Acc: 0.600
Validation loss decreased (-0.583317 --> -0.599984).  Saving model ...
Epoch: 36 cost time: 1.3309051990509033
Epoch: 36, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.542 Vali Acc: 0.606 Test Loss: 1.542 Test Acc: 0.606
Validation loss decreased (-0.599984 --> -0.605540).  Saving model ...
Epoch: 37 cost time: 1.400214433670044
Epoch: 37, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.512 Vali Acc: 0.611 Test Loss: 1.512 Test Acc: 0.611
Validation loss decreased (-0.605540 --> -0.611096).  Saving model ...
Epoch: 38 cost time: 1.5021770000457764
Epoch: 38, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.493 Vali Acc: 0.594 Test Loss: 1.493 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2516834735870361
Epoch: 39, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.481 Vali Acc: 0.606 Test Loss: 1.481 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.402284860610962
Epoch: 40, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.466 Vali Acc: 0.622 Test Loss: 1.466 Test Acc: 0.622
Validation loss decreased (-0.611096 --> -0.622208).  Saving model ...
Epoch: 41 cost time: 1.7035267353057861
Epoch: 41, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.445 Vali Acc: 0.622 Test Loss: 1.445 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622208).  Saving model ...
Epoch: 42 cost time: 1.1999998092651367
Epoch: 42, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.440 Vali Acc: 0.622 Test Loss: 1.440 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622208).  Saving model ...
Epoch: 43 cost time: 1.262824296951294
Epoch: 43, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.427 Vali Acc: 0.622 Test Loss: 1.427 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622208).  Saving model ...
Epoch: 44 cost time: 1.3889429569244385
Epoch: 44, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.410 Vali Acc: 0.628 Test Loss: 1.410 Test Acc: 0.628
Validation loss decreased (-0.622208 --> -0.627764).  Saving model ...
Epoch: 45 cost time: 1.413684606552124
Epoch: 45, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.395 Vali Acc: 0.628 Test Loss: 1.395 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627764).  Saving model ...
Epoch: 46 cost time: 1.4319038391113281
Epoch: 46, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.385 Vali Acc: 0.639 Test Loss: 1.385 Test Acc: 0.639
Validation loss decreased (-0.627764 --> -0.638875).  Saving model ...
Epoch: 47 cost time: 1.556269645690918
Epoch: 47, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.369 Vali Acc: 0.628 Test Loss: 1.369 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5116353034973145
Epoch: 48, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.364 Vali Acc: 0.628 Test Loss: 1.364 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2993626594543457
Epoch: 49, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.357 Vali Acc: 0.639 Test Loss: 1.357 Test Acc: 0.639
Validation loss decreased (-0.638875 --> -0.638875).  Saving model ...
Epoch: 50 cost time: 1.0545077323913574
Epoch: 50, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.353 Vali Acc: 0.639 Test Loss: 1.353 Test Acc: 0.639
Validation loss decreased (-0.638875 --> -0.638875).  Saving model ...
Epoch: 51 cost time: 1.820176124572754
Epoch: 51, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.343 Vali Acc: 0.650 Test Loss: 1.343 Test Acc: 0.650
Validation loss decreased (-0.638875 --> -0.649987).  Saving model ...
Epoch: 52 cost time: 1.6247174739837646
Epoch: 52, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.339 Vali Acc: 0.644 Test Loss: 1.339 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5685522556304932
Epoch: 53, Steps: 12 | Train Loss: 0.899 Vali Loss: 1.337 Vali Acc: 0.650 Test Loss: 1.337 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 54 cost time: 1.2512235641479492
Epoch: 54, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.323 Vali Acc: 0.667 Test Loss: 1.323 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666653).  Saving model ...
Epoch: 55 cost time: 1.4184479713439941
Epoch: 55, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.310 Vali Acc: 0.656 Test Loss: 1.310 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.4258506298065186
Epoch: 56, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.298 Vali Acc: 0.661 Test Loss: 1.298 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.3256502151489258
Epoch: 57, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.297 Vali Acc: 0.656 Test Loss: 1.297 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.156923532485962
Epoch: 58, Steps: 12 | Train Loss: 0.828 Vali Loss: 1.285 Vali Acc: 0.667 Test Loss: 1.285 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666654).  Saving model ...
Epoch: 59 cost time: 1.2790107727050781
Epoch: 59, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.278 Vali Acc: 0.667 Test Loss: 1.278 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 60 cost time: 1.2259774208068848
Epoch: 60, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.275 Vali Acc: 0.683 Test Loss: 1.275 Test Acc: 0.683
Validation loss decreased (-0.666654 --> -0.683321).  Saving model ...
Epoch: 61 cost time: 1.198470115661621
Epoch: 61, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.263 Vali Acc: 0.683 Test Loss: 1.263 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 62 cost time: 1.237097978591919
Epoch: 62, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.264 Vali Acc: 0.667 Test Loss: 1.264 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.286055326461792
Epoch: 63, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.262 Vali Acc: 0.672 Test Loss: 1.262 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.6140146255493164
Epoch: 64, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.265 Vali Acc: 0.678 Test Loss: 1.265 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.4483704566955566
Epoch: 65, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.261 Vali Acc: 0.683 Test Loss: 1.261 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 66 cost time: 1.4253718852996826
Epoch: 66, Steps: 12 | Train Loss: 0.752 Vali Loss: 1.261 Vali Acc: 0.689 Test Loss: 1.261 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688876).  Saving model ...
Epoch: 67 cost time: 1.4068388938903809
Epoch: 67, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.258 Vali Acc: 0.689 Test Loss: 1.258 Test Acc: 0.689
Validation loss decreased (-0.688876 --> -0.688876).  Saving model ...
Epoch: 68 cost time: 1.3444795608520508
Epoch: 68, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.243 Vali Acc: 0.689 Test Loss: 1.243 Test Acc: 0.689
Validation loss decreased (-0.688876 --> -0.688876).  Saving model ...
Epoch: 69 cost time: 1.4587244987487793
Epoch: 69, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.248 Vali Acc: 0.700 Test Loss: 1.248 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 70 cost time: 1.390143632888794
Epoch: 70, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.246 Vali Acc: 0.689 Test Loss: 1.246 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.6051342487335205
Epoch: 71, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.247 Vali Acc: 0.694 Test Loss: 1.247 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.4624865055084229
Epoch: 72, Steps: 12 | Train Loss: 0.703 Vali Loss: 1.243 Vali Acc: 0.689 Test Loss: 1.243 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.2652900218963623
Epoch: 73, Steps: 12 | Train Loss: 0.698 Vali Loss: 1.250 Vali Acc: 0.689 Test Loss: 1.250 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 2.1345560550689697
Epoch: 74, Steps: 12 | Train Loss: 0.707 Vali Loss: 1.240 Vali Acc: 0.694 Test Loss: 1.240 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.2825350761413574
Epoch: 75, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.242 Vali Acc: 0.694 Test Loss: 1.242 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.6729836463928223
Epoch: 76, Steps: 12 | Train Loss: 0.685 Vali Loss: 1.236 Vali Acc: 0.694 Test Loss: 1.236 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.7397675514221191
Epoch: 77, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.231 Vali Acc: 0.694 Test Loss: 1.231 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.1708972454071045
Epoch: 78, Steps: 12 | Train Loss: 0.644 Vali Loss: 1.228 Vali Acc: 0.700 Test Loss: 1.228 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 79 cost time: 1.5380363464355469
Epoch: 79, Steps: 12 | Train Loss: 0.635 Vali Loss: 1.226 Vali Acc: 0.700 Test Loss: 1.226 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 80 cost time: 1.2502193450927734
Epoch: 80, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.218 Vali Acc: 0.706 Test Loss: 1.218 Test Acc: 0.706
Validation loss decreased (-0.699988 --> -0.705543).  Saving model ...
Epoch: 81 cost time: 1.2292046546936035
Epoch: 81, Steps: 12 | Train Loss: 0.670 Vali Loss: 1.215 Vali Acc: 0.694 Test Loss: 1.215 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.8997561931610107
Epoch: 82, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.212 Vali Acc: 0.694 Test Loss: 1.212 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.7314794063568115
Epoch: 83, Steps: 12 | Train Loss: 0.641 Vali Loss: 1.205 Vali Acc: 0.694 Test Loss: 1.205 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.566044569015503
Epoch: 84, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.208 Vali Acc: 0.694 Test Loss: 1.208 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.503380298614502
Epoch: 85, Steps: 12 | Train Loss: 0.673 Vali Loss: 1.201 Vali Acc: 0.689 Test Loss: 1.201 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.376657247543335
Epoch: 86, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.203 Vali Acc: 0.694 Test Loss: 1.203 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.2680344581604004
Epoch: 87, Steps: 12 | Train Loss: 0.591 Vali Loss: 1.196 Vali Acc: 0.700 Test Loss: 1.196 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.5428462028503418
Epoch: 88, Steps: 12 | Train Loss: 0.571 Vali Loss: 1.193 Vali Acc: 0.700 Test Loss: 1.193 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.5558364391326904
Epoch: 89, Steps: 12 | Train Loss: 0.638 Vali Loss: 1.196 Vali Acc: 0.700 Test Loss: 1.196 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.5272104740142822
Epoch: 90, Steps: 12 | Train Loss: 0.585 Vali Loss: 1.192 Vali Acc: 0.694 Test Loss: 1.192 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7055555555555556
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.550757169723511
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.5290298461914062
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.733 Vali Acc: 0.094 Test Loss: 2.733 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.85829496383667
Epoch: 3, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.713 Vali Acc: 0.111 Test Loss: 2.713 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.8104376792907715
Epoch: 4, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.690 Vali Acc: 0.106 Test Loss: 2.690 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.647529125213623
Epoch: 5, Steps: 12 | Train Loss: 2.640 Vali Loss: 2.666 Vali Acc: 0.122 Test Loss: 2.666 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 2.470938205718994
Epoch: 6, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.640 Vali Acc: 0.128 Test Loss: 2.640 Test Acc: 0.128
Validation loss decreased (-0.122196 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 1.8647406101226807
Epoch: 7, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.611 Vali Acc: 0.156 Test Loss: 2.611 Test Acc: 0.156
Validation loss decreased (-0.127751 --> -0.155529).  Saving model ...
Epoch: 8 cost time: 1.7300934791564941
Epoch: 8, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.583 Vali Acc: 0.183 Test Loss: 2.583 Test Acc: 0.183
Validation loss decreased (-0.155529 --> -0.183308).  Saving model ...
Epoch: 9 cost time: 1.9534761905670166
Epoch: 9, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.554 Vali Acc: 0.233 Test Loss: 2.554 Test Acc: 0.233
Validation loss decreased (-0.183308 --> -0.233308).  Saving model ...
Epoch: 10 cost time: 1.681800127029419
Epoch: 10, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.517 Vali Acc: 0.261 Test Loss: 2.517 Test Acc: 0.261
Validation loss decreased (-0.233308 --> -0.261086).  Saving model ...
Epoch: 11 cost time: 2.067793607711792
Epoch: 11, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.484 Vali Acc: 0.294 Test Loss: 2.484 Test Acc: 0.294
Validation loss decreased (-0.261086 --> -0.294420).  Saving model ...
Epoch: 12 cost time: 1.6539976596832275
Epoch: 12, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.452 Vali Acc: 0.300 Test Loss: 2.452 Test Acc: 0.300
Validation loss decreased (-0.294420 --> -0.299975).  Saving model ...
Epoch: 13 cost time: 1.7845420837402344
Epoch: 13, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.410 Vali Acc: 0.333 Test Loss: 2.410 Test Acc: 0.333
Validation loss decreased (-0.299975 --> -0.333309).  Saving model ...
Epoch: 14 cost time: 2.0330607891082764
Epoch: 14, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.369 Vali Acc: 0.372 Test Loss: 2.369 Test Acc: 0.372
Validation loss decreased (-0.333309 --> -0.372199).  Saving model ...
Epoch: 15 cost time: 1.5855679512023926
Epoch: 15, Steps: 12 | Train Loss: 2.222 Vali Loss: 2.328 Vali Acc: 0.383 Test Loss: 2.328 Test Acc: 0.383
Validation loss decreased (-0.372199 --> -0.383310).  Saving model ...
Epoch: 16 cost time: 1.506669521331787
Epoch: 16, Steps: 12 | Train Loss: 2.162 Vali Loss: 2.283 Vali Acc: 0.389 Test Loss: 2.283 Test Acc: 0.389
Validation loss decreased (-0.383310 --> -0.388866).  Saving model ...
Epoch: 17 cost time: 1.3498175144195557
Epoch: 17, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.229 Vali Acc: 0.422 Test Loss: 2.229 Test Acc: 0.422
Validation loss decreased (-0.388866 --> -0.422200).  Saving model ...
Epoch: 18 cost time: 1.656378984451294
Epoch: 18, Steps: 12 | Train Loss: 2.070 Vali Loss: 2.183 Vali Acc: 0.433 Test Loss: 2.183 Test Acc: 0.433
Validation loss decreased (-0.422200 --> -0.433312).  Saving model ...
Epoch: 19 cost time: 1.807241678237915
Epoch: 19, Steps: 12 | Train Loss: 2.002 Vali Loss: 2.131 Vali Acc: 0.450 Test Loss: 2.131 Test Acc: 0.450
Validation loss decreased (-0.433312 --> -0.449979).  Saving model ...
Epoch: 20 cost time: 1.7246339321136475
Epoch: 20, Steps: 12 | Train Loss: 1.932 Vali Loss: 2.079 Vali Acc: 0.472 Test Loss: 2.079 Test Acc: 0.472
Validation loss decreased (-0.449979 --> -0.472201).  Saving model ...
Epoch: 21 cost time: 1.6549220085144043
Epoch: 21, Steps: 12 | Train Loss: 1.868 Vali Loss: 2.023 Vali Acc: 0.494 Test Loss: 2.023 Test Acc: 0.494
Validation loss decreased (-0.472201 --> -0.494424).  Saving model ...
Epoch: 22 cost time: 2.0159311294555664
Epoch: 22, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.975 Vali Acc: 0.522 Test Loss: 1.975 Test Acc: 0.522
Validation loss decreased (-0.494424 --> -0.522202).  Saving model ...
Epoch: 23 cost time: 1.9392249584197998
Epoch: 23, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.931 Vali Acc: 0.539 Test Loss: 1.931 Test Acc: 0.539
Validation loss decreased (-0.522202 --> -0.538870).  Saving model ...
Epoch: 24 cost time: 2.11785626411438
Epoch: 24, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.892 Vali Acc: 0.533 Test Loss: 1.892 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8682334423065186
Epoch: 25, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.846 Vali Acc: 0.522 Test Loss: 1.846 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0360140800476074
Epoch: 26, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.810 Vali Acc: 0.561 Test Loss: 1.810 Test Acc: 0.561
Validation loss decreased (-0.538870 --> -0.561093).  Saving model ...
Epoch: 27 cost time: 1.5861575603485107
Epoch: 27, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.774 Vali Acc: 0.567 Test Loss: 1.774 Test Acc: 0.567
Validation loss decreased (-0.561093 --> -0.566649).  Saving model ...
Epoch: 28 cost time: 1.684873342514038
Epoch: 28, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.740 Vali Acc: 0.567 Test Loss: 1.740 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566649).  Saving model ...
Epoch: 29 cost time: 2.057996988296509
Epoch: 29, Steps: 12 | Train Loss: 1.461 Vali Loss: 1.718 Vali Acc: 0.567 Test Loss: 1.718 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566649).  Saving model ...
Epoch: 30 cost time: 1.6809139251708984
Epoch: 30, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.691 Vali Acc: 0.578 Test Loss: 1.691 Test Acc: 0.578
Validation loss decreased (-0.566649 --> -0.577761).  Saving model ...
Epoch: 31 cost time: 1.5071797370910645
Epoch: 31, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.649 Vali Acc: 0.572 Test Loss: 1.649 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5238397121429443
Epoch: 32, Steps: 12 | Train Loss: 1.399 Vali Loss: 1.625 Vali Acc: 0.578 Test Loss: 1.625 Test Acc: 0.578
Validation loss decreased (-0.577761 --> -0.577762).  Saving model ...
Epoch: 33 cost time: 2.090359687805176
Epoch: 33, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.608 Vali Acc: 0.578 Test Loss: 1.608 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577762).  Saving model ...
Epoch: 34 cost time: 1.9923779964447021
Epoch: 34, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.584 Vali Acc: 0.578 Test Loss: 1.584 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577762).  Saving model ...
Epoch: 35 cost time: 1.8706181049346924
Epoch: 35, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.569 Vali Acc: 0.589 Test Loss: 1.569 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588873).  Saving model ...
Epoch: 36 cost time: 1.758190393447876
Epoch: 36, Steps: 12 | Train Loss: 1.270 Vali Loss: 1.546 Vali Acc: 0.589 Test Loss: 1.546 Test Acc: 0.589
Validation loss decreased (-0.588873 --> -0.588873).  Saving model ...
Epoch: 37 cost time: 1.4702885150909424
Epoch: 37, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.516 Vali Acc: 0.600 Test Loss: 1.516 Test Acc: 0.600
Validation loss decreased (-0.588873 --> -0.599985).  Saving model ...
Epoch: 38 cost time: 1.6503243446350098
Epoch: 38, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.497 Vali Acc: 0.594 Test Loss: 1.497 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5054380893707275
Epoch: 39, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.484 Vali Acc: 0.611 Test Loss: 1.484 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611096).  Saving model ...
Epoch: 40 cost time: 1.6739532947540283
Epoch: 40, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.469 Vali Acc: 0.628 Test Loss: 1.469 Test Acc: 0.628
Validation loss decreased (-0.611096 --> -0.627763).  Saving model ...
Epoch: 41 cost time: 1.7687819004058838
Epoch: 41, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.447 Vali Acc: 0.628 Test Loss: 1.447 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627763).  Saving model ...
Epoch: 42 cost time: 1.557770013809204
Epoch: 42, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.442 Vali Acc: 0.628 Test Loss: 1.442 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627763).  Saving model ...
Epoch: 43 cost time: 1.8299534320831299
Epoch: 43, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.429 Vali Acc: 0.622 Test Loss: 1.429 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.801429033279419
Epoch: 44, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.412 Vali Acc: 0.622 Test Loss: 1.412 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.9128258228302002
Epoch: 45, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.397 Vali Acc: 0.628 Test Loss: 1.397 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627764).  Saving model ...
Epoch: 46 cost time: 1.520475149154663
Epoch: 46, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.387 Vali Acc: 0.633 Test Loss: 1.387 Test Acc: 0.633
Validation loss decreased (-0.627764 --> -0.633319).  Saving model ...
Epoch: 47 cost time: 1.8801493644714355
Epoch: 47, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.371 Vali Acc: 0.628 Test Loss: 1.371 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.457322120666504
Epoch: 48, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.365 Vali Acc: 0.628 Test Loss: 1.365 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.0952842235565186
Epoch: 49, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.359 Vali Acc: 0.628 Test Loss: 1.359 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8548336029052734
Epoch: 50, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.355 Vali Acc: 0.628 Test Loss: 1.355 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.9916470050811768
Epoch: 51, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.344 Vali Acc: 0.644 Test Loss: 1.344 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644431).  Saving model ...
Epoch: 52 cost time: 1.8470051288604736
Epoch: 52, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.339 Vali Acc: 0.644 Test Loss: 1.339 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 53 cost time: 1.5871822834014893
Epoch: 53, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.337 Vali Acc: 0.650 Test Loss: 1.337 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649987).  Saving model ...
Epoch: 54 cost time: 2.178823232650757
Epoch: 54, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.323 Vali Acc: 0.661 Test Loss: 1.323 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 55 cost time: 1.775467872619629
Epoch: 55, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.309 Vali Acc: 0.656 Test Loss: 1.309 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.9974474906921387
Epoch: 56, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.297 Vali Acc: 0.661 Test Loss: 1.297 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 57 cost time: 1.8641321659088135
Epoch: 57, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.296 Vali Acc: 0.661 Test Loss: 1.296 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 58 cost time: 1.9072155952453613
Epoch: 58, Steps: 12 | Train Loss: 0.840 Vali Loss: 1.283 Vali Acc: 0.672 Test Loss: 1.283 Test Acc: 0.672
Validation loss decreased (-0.661098 --> -0.672209).  Saving model ...
Epoch: 59 cost time: 1.8281347751617432
Epoch: 59, Steps: 12 | Train Loss: 0.877 Vali Loss: 1.276 Vali Acc: 0.667 Test Loss: 1.276 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4551692008972168
Epoch: 60, Steps: 12 | Train Loss: 0.890 Vali Loss: 1.272 Vali Acc: 0.683 Test Loss: 1.272 Test Acc: 0.683
Validation loss decreased (-0.672209 --> -0.683321).  Saving model ...
Epoch: 61 cost time: 1.6382319927215576
Epoch: 61, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.259 Vali Acc: 0.689 Test Loss: 1.259 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688876).  Saving model ...
Epoch: 62 cost time: 1.383103609085083
Epoch: 62, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.259 Vali Acc: 0.672 Test Loss: 1.259 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.6187858581542969
Epoch: 63, Steps: 12 | Train Loss: 0.797 Vali Loss: 1.257 Vali Acc: 0.672 Test Loss: 1.257 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.949359655380249
Epoch: 64, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.260 Vali Acc: 0.672 Test Loss: 1.260 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.2380077838897705
Epoch: 65, Steps: 12 | Train Loss: 0.816 Vali Loss: 1.256 Vali Acc: 0.678 Test Loss: 1.256 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.9710557460784912
Epoch: 66, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.255 Vali Acc: 0.689 Test Loss: 1.255 Test Acc: 0.689
Validation loss decreased (-0.688876 --> -0.688876).  Saving model ...
Epoch: 67 cost time: 1.8205695152282715
Epoch: 67, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.251 Vali Acc: 0.683 Test Loss: 1.251 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.5812673568725586
Epoch: 68, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.236 Vali Acc: 0.683 Test Loss: 1.236 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.884704351425171
Epoch: 69, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.241 Vali Acc: 0.694 Test Loss: 1.241 Test Acc: 0.694
Validation loss decreased (-0.688876 --> -0.694432).  Saving model ...
Epoch: 70 cost time: 1.4785544872283936
Epoch: 70, Steps: 12 | Train Loss: 0.709 Vali Loss: 1.239 Vali Acc: 0.689 Test Loss: 1.239 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.6293375492095947
Epoch: 71, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.241 Vali Acc: 0.683 Test Loss: 1.241 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.7085018157958984
Epoch: 72, Steps: 12 | Train Loss: 0.710 Vali Loss: 1.236 Vali Acc: 0.683 Test Loss: 1.236 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.9088754653930664
Epoch: 73, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.243 Vali Acc: 0.683 Test Loss: 1.243 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.631901502609253
Epoch: 74, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.231 Vali Acc: 0.694 Test Loss: 1.231 Test Acc: 0.694
Validation loss decreased (-0.694432 --> -0.694432).  Saving model ...
Epoch: 75 cost time: 1.9522337913513184
Epoch: 75, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.233 Vali Acc: 0.694 Test Loss: 1.233 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.1867425441741943
Epoch: 76, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.228 Vali Acc: 0.689 Test Loss: 1.228 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.6571495532989502
Epoch: 77, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.223 Vali Acc: 0.689 Test Loss: 1.223 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.627936840057373
Epoch: 78, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.219 Vali Acc: 0.700 Test Loss: 1.219 Test Acc: 0.700
Validation loss decreased (-0.694432 --> -0.699988).  Saving model ...
Epoch: 79 cost time: 1.4888699054718018
Epoch: 79, Steps: 12 | Train Loss: 0.640 Vali Loss: 1.218 Vali Acc: 0.700 Test Loss: 1.218 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 80 cost time: 1.8079383373260498
Epoch: 80, Steps: 12 | Train Loss: 0.714 Vali Loss: 1.209 Vali Acc: 0.706 Test Loss: 1.209 Test Acc: 0.706
Validation loss decreased (-0.699988 --> -0.705543).  Saving model ...
Epoch: 81 cost time: 2.3275740146636963
Epoch: 81, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.207 Vali Acc: 0.694 Test Loss: 1.207 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.6247272491455078
Epoch: 82, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.204 Vali Acc: 0.694 Test Loss: 1.204 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.718519926071167
Epoch: 83, Steps: 12 | Train Loss: 0.646 Vali Loss: 1.197 Vali Acc: 0.700 Test Loss: 1.197 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.8069982528686523
Epoch: 84, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.200 Vali Acc: 0.694 Test Loss: 1.200 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.5706169605255127
Epoch: 85, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.193 Vali Acc: 0.694 Test Loss: 1.193 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.6623964309692383
Epoch: 86, Steps: 12 | Train Loss: 0.588 Vali Loss: 1.195 Vali Acc: 0.694 Test Loss: 1.195 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.4898076057434082
Epoch: 87, Steps: 12 | Train Loss: 0.595 Vali Loss: 1.188 Vali Acc: 0.700 Test Loss: 1.188 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.7522029876708984
Epoch: 88, Steps: 12 | Train Loss: 0.576 Vali Loss: 1.186 Vali Acc: 0.700 Test Loss: 1.186 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.776557445526123
Epoch: 89, Steps: 12 | Train Loss: 0.642 Vali Loss: 1.189 Vali Acc: 0.700 Test Loss: 1.189 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 2.120781660079956
Epoch: 90, Steps: 12 | Train Loss: 0.589 Vali Loss: 1.185 Vali Acc: 0.694 Test Loss: 1.185 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7055555555555556
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6487982273101807
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.5058929920196533
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.734 Vali Acc: 0.094 Test Loss: 2.734 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.3035366535186768
Epoch: 3, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.714 Vali Acc: 0.111 Test Loss: 2.714 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.1183266639709473
Epoch: 4, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.692 Vali Acc: 0.106 Test Loss: 2.692 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5067355632781982
Epoch: 5, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.668 Vali Acc: 0.122 Test Loss: 2.668 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.1711204051971436
Epoch: 6, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.643 Vali Acc: 0.133 Test Loss: 2.643 Test Acc: 0.133
Validation loss decreased (-0.122196 --> -0.133307).  Saving model ...
Epoch: 7 cost time: 1.15767502784729
Epoch: 7, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.614 Vali Acc: 0.156 Test Loss: 2.614 Test Acc: 0.156
Validation loss decreased (-0.133307 --> -0.155529).  Saving model ...
Epoch: 8 cost time: 1.3035252094268799
Epoch: 8, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.587 Vali Acc: 0.178 Test Loss: 2.587 Test Acc: 0.178
Validation loss decreased (-0.155529 --> -0.177752).  Saving model ...
Epoch: 9 cost time: 1.369612693786621
Epoch: 9, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.558 Vali Acc: 0.222 Test Loss: 2.558 Test Acc: 0.222
Validation loss decreased (-0.177752 --> -0.222197).  Saving model ...
Epoch: 10 cost time: 1.280120611190796
Epoch: 10, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.523 Vali Acc: 0.256 Test Loss: 2.523 Test Acc: 0.256
Validation loss decreased (-0.222197 --> -0.255530).  Saving model ...
Epoch: 11 cost time: 1.560046672821045
Epoch: 11, Steps: 12 | Train Loss: 2.429 Vali Loss: 2.491 Vali Acc: 0.283 Test Loss: 2.491 Test Acc: 0.283
Validation loss decreased (-0.255530 --> -0.283308).  Saving model ...
Epoch: 12 cost time: 1.1825850009918213
Epoch: 12, Steps: 12 | Train Loss: 2.392 Vali Loss: 2.459 Vali Acc: 0.289 Test Loss: 2.459 Test Acc: 0.289
Validation loss decreased (-0.283308 --> -0.288864).  Saving model ...
Epoch: 13 cost time: 1.558011770248413
Epoch: 13, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.419 Vali Acc: 0.322 Test Loss: 2.419 Test Acc: 0.322
Validation loss decreased (-0.288864 --> -0.322198).  Saving model ...
Epoch: 14 cost time: 1.2831473350524902
Epoch: 14, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.379 Vali Acc: 0.356 Test Loss: 2.379 Test Acc: 0.356
Validation loss decreased (-0.322198 --> -0.355532).  Saving model ...
Epoch: 15 cost time: 1.209885597229004
Epoch: 15, Steps: 12 | Train Loss: 2.237 Vali Loss: 2.339 Vali Acc: 0.372 Test Loss: 2.339 Test Acc: 0.372
Validation loss decreased (-0.355532 --> -0.372199).  Saving model ...
Epoch: 16 cost time: 1.2002007961273193
Epoch: 16, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.295 Vali Acc: 0.389 Test Loss: 2.295 Test Acc: 0.389
Validation loss decreased (-0.372199 --> -0.388866).  Saving model ...
Epoch: 17 cost time: 1.3269925117492676
Epoch: 17, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.241 Vali Acc: 0.422 Test Loss: 2.241 Test Acc: 0.422
Validation loss decreased (-0.388866 --> -0.422200).  Saving model ...
Epoch: 18 cost time: 1.3583273887634277
Epoch: 18, Steps: 12 | Train Loss: 2.089 Vali Loss: 2.197 Vali Acc: 0.433 Test Loss: 2.197 Test Acc: 0.433
Validation loss decreased (-0.422200 --> -0.433311).  Saving model ...
Epoch: 19 cost time: 1.38480544090271
Epoch: 19, Steps: 12 | Train Loss: 2.020 Vali Loss: 2.146 Vali Acc: 0.444 Test Loss: 2.146 Test Acc: 0.444
Validation loss decreased (-0.433311 --> -0.444423).  Saving model ...
Epoch: 20 cost time: 1.1865956783294678
Epoch: 20, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.095 Vali Acc: 0.467 Test Loss: 2.095 Test Acc: 0.467
Validation loss decreased (-0.444423 --> -0.466646).  Saving model ...
Epoch: 21 cost time: 1.6670174598693848
Epoch: 21, Steps: 12 | Train Loss: 1.892 Vali Loss: 2.040 Vali Acc: 0.489 Test Loss: 2.040 Test Acc: 0.489
Validation loss decreased (-0.466646 --> -0.488868).  Saving model ...
Epoch: 22 cost time: 1.3065762519836426
Epoch: 22, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.993 Vali Acc: 0.511 Test Loss: 1.993 Test Acc: 0.511
Validation loss decreased (-0.488868 --> -0.511091).  Saving model ...
Epoch: 23 cost time: 1.5133488178253174
Epoch: 23, Steps: 12 | Train Loss: 1.749 Vali Loss: 1.950 Vali Acc: 0.517 Test Loss: 1.950 Test Acc: 0.517
Validation loss decreased (-0.511091 --> -0.516647).  Saving model ...
Epoch: 24 cost time: 1.5622351169586182
Epoch: 24, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.911 Vali Acc: 0.522 Test Loss: 1.911 Test Acc: 0.522
Validation loss decreased (-0.516647 --> -0.522203).  Saving model ...
Epoch: 25 cost time: 1.5536892414093018
Epoch: 25, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.866 Vali Acc: 0.528 Test Loss: 1.866 Test Acc: 0.528
Validation loss decreased (-0.522203 --> -0.527759).  Saving model ...
Epoch: 26 cost time: 1.531132459640503
Epoch: 26, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.830 Vali Acc: 0.550 Test Loss: 1.830 Test Acc: 0.550
Validation loss decreased (-0.527759 --> -0.549982).  Saving model ...
Epoch: 27 cost time: 1.3789262771606445
Epoch: 27, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.793 Vali Acc: 0.561 Test Loss: 1.793 Test Acc: 0.561
Validation loss decreased (-0.549982 --> -0.561093).  Saving model ...
Epoch: 28 cost time: 1.0701868534088135
Epoch: 28, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.760 Vali Acc: 0.572 Test Loss: 1.760 Test Acc: 0.572
Validation loss decreased (-0.561093 --> -0.572205).  Saving model ...
Epoch: 29 cost time: 1.1881048679351807
Epoch: 29, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.736 Vali Acc: 0.567 Test Loss: 1.736 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3304400444030762
Epoch: 30, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.709 Vali Acc: 0.572 Test Loss: 1.709 Test Acc: 0.572
Validation loss decreased (-0.572205 --> -0.572205).  Saving model ...
Epoch: 31 cost time: 1.4168643951416016
Epoch: 31, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.666 Vali Acc: 0.583 Test Loss: 1.666 Test Acc: 0.583
Validation loss decreased (-0.572205 --> -0.583317).  Saving model ...
Epoch: 32 cost time: 1.2872562408447266
Epoch: 32, Steps: 12 | Train Loss: 1.430 Vali Loss: 1.642 Vali Acc: 0.589 Test Loss: 1.642 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588872).  Saving model ...
Epoch: 33 cost time: 1.4337921142578125
Epoch: 33, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.623 Vali Acc: 0.578 Test Loss: 1.623 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1501665115356445
Epoch: 34, Steps: 12 | Train Loss: 1.352 Vali Loss: 1.599 Vali Acc: 0.583 Test Loss: 1.599 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.4489679336547852
Epoch: 35, Steps: 12 | Train Loss: 1.344 Vali Loss: 1.581 Vali Acc: 0.594 Test Loss: 1.581 Test Acc: 0.594
Validation loss decreased (-0.588872 --> -0.594429).  Saving model ...
Epoch: 36 cost time: 1.1450450420379639
Epoch: 36, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.559 Vali Acc: 0.600 Test Loss: 1.559 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599984).  Saving model ...
Epoch: 37 cost time: 1.1930270195007324
Epoch: 37, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.527 Vali Acc: 0.600 Test Loss: 1.527 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599985).  Saving model ...
Epoch: 38 cost time: 1.3957710266113281
Epoch: 38, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.508 Vali Acc: 0.600 Test Loss: 1.508 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599985).  Saving model ...
Epoch: 39 cost time: 1.1167786121368408
Epoch: 39, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.494 Vali Acc: 0.611 Test Loss: 1.494 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611096).  Saving model ...
Epoch: 40 cost time: 1.156801700592041
Epoch: 40, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.478 Vali Acc: 0.617 Test Loss: 1.478 Test Acc: 0.617
Validation loss decreased (-0.611096 --> -0.616652).  Saving model ...
Epoch: 41 cost time: 1.2586665153503418
Epoch: 41, Steps: 12 | Train Loss: 1.183 Vali Loss: 1.456 Vali Acc: 0.639 Test Loss: 1.456 Test Acc: 0.639
Validation loss decreased (-0.616652 --> -0.638874).  Saving model ...
Epoch: 42 cost time: 1.4468650817871094
Epoch: 42, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.450 Vali Acc: 0.633 Test Loss: 1.450 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1263141632080078
Epoch: 43, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.436 Vali Acc: 0.633 Test Loss: 1.436 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3732004165649414
Epoch: 44, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.418 Vali Acc: 0.622 Test Loss: 1.418 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2596607208251953
Epoch: 45, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.402 Vali Acc: 0.628 Test Loss: 1.402 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.3563179969787598
Epoch: 46, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.392 Vali Acc: 0.622 Test Loss: 1.392 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2445261478424072
Epoch: 47, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.375 Vali Acc: 0.628 Test Loss: 1.375 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7127532958984375
Epoch: 48, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.369 Vali Acc: 0.628 Test Loss: 1.369 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4249694347381592
Epoch: 49, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.363 Vali Acc: 0.617 Test Loss: 1.363 Test Acc: 0.617
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3056354522705078
Epoch: 50, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.359 Vali Acc: 0.622 Test Loss: 1.359 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4814820289611816
Epoch: 51, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.348 Vali Acc: 0.633 Test Loss: 1.348 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6388888888888888
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.126646041870117
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.6823959350585938
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.734 Vali Acc: 0.094 Test Loss: 2.734 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 2.1287975311279297
Epoch: 3, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.714 Vali Acc: 0.111 Test Loss: 2.714 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.603935718536377
Epoch: 4, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.692 Vali Acc: 0.106 Test Loss: 2.692 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5055453777313232
Epoch: 5, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.669 Vali Acc: 0.122 Test Loss: 2.669 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.4853880405426025
Epoch: 6, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.644 Vali Acc: 0.133 Test Loss: 2.644 Test Acc: 0.133
Validation loss decreased (-0.122196 --> -0.133307).  Saving model ...
Epoch: 7 cost time: 1.6907398700714111
Epoch: 7, Steps: 12 | Train Loss: 2.589 Vali Loss: 2.616 Vali Acc: 0.156 Test Loss: 2.616 Test Acc: 0.156
Validation loss decreased (-0.133307 --> -0.155529).  Saving model ...
Epoch: 8 cost time: 1.389535903930664
Epoch: 8, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.589 Vali Acc: 0.172 Test Loss: 2.589 Test Acc: 0.172
Validation loss decreased (-0.155529 --> -0.172196).  Saving model ...
Epoch: 9 cost time: 1.689784049987793
Epoch: 9, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.561 Vali Acc: 0.222 Test Loss: 2.561 Test Acc: 0.222
Validation loss decreased (-0.172196 --> -0.222197).  Saving model ...
Epoch: 10 cost time: 1.9265773296356201
Epoch: 10, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.526 Vali Acc: 0.256 Test Loss: 2.526 Test Acc: 0.256
Validation loss decreased (-0.222197 --> -0.255530).  Saving model ...
Epoch: 11 cost time: 1.7507500648498535
Epoch: 11, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.494 Vali Acc: 0.278 Test Loss: 2.494 Test Acc: 0.278
Validation loss decreased (-0.255530 --> -0.277753).  Saving model ...
Epoch: 12 cost time: 1.8899576663970947
Epoch: 12, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.464 Vali Acc: 0.289 Test Loss: 2.464 Test Acc: 0.289
Validation loss decreased (-0.277753 --> -0.288864).  Saving model ...
Epoch: 13 cost time: 2.0577847957611084
Epoch: 13, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.424 Vali Acc: 0.317 Test Loss: 2.424 Test Acc: 0.317
Validation loss decreased (-0.288864 --> -0.316642).  Saving model ...
Epoch: 14 cost time: 1.546247959136963
Epoch: 14, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.384 Vali Acc: 0.350 Test Loss: 2.384 Test Acc: 0.350
Validation loss decreased (-0.316642 --> -0.349976).  Saving model ...
Epoch: 15 cost time: 1.6004493236541748
Epoch: 15, Steps: 12 | Train Loss: 2.245 Vali Loss: 2.345 Vali Acc: 0.367 Test Loss: 2.345 Test Acc: 0.367
Validation loss decreased (-0.349976 --> -0.366643).  Saving model ...
Epoch: 16 cost time: 1.6491203308105469
Epoch: 16, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.301 Vali Acc: 0.383 Test Loss: 2.301 Test Acc: 0.383
Validation loss decreased (-0.366643 --> -0.383310).  Saving model ...
Epoch: 17 cost time: 1.6267004013061523
Epoch: 17, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.249 Vali Acc: 0.428 Test Loss: 2.249 Test Acc: 0.428
Validation loss decreased (-0.383310 --> -0.427755).  Saving model ...
Epoch: 18 cost time: 1.9452123641967773
Epoch: 18, Steps: 12 | Train Loss: 2.098 Vali Loss: 2.205 Vali Acc: 0.433 Test Loss: 2.205 Test Acc: 0.433
Validation loss decreased (-0.427755 --> -0.433311).  Saving model ...
Epoch: 19 cost time: 1.5758118629455566
Epoch: 19, Steps: 12 | Train Loss: 2.030 Vali Loss: 2.155 Vali Acc: 0.444 Test Loss: 2.155 Test Acc: 0.444
Validation loss decreased (-0.433311 --> -0.444423).  Saving model ...
Epoch: 20 cost time: 1.4575459957122803
Epoch: 20, Steps: 12 | Train Loss: 1.966 Vali Loss: 2.104 Vali Acc: 0.467 Test Loss: 2.104 Test Acc: 0.467
Validation loss decreased (-0.444423 --> -0.466646).  Saving model ...
Epoch: 21 cost time: 1.757289171218872
Epoch: 21, Steps: 12 | Train Loss: 1.904 Vali Loss: 2.050 Vali Acc: 0.483 Test Loss: 2.050 Test Acc: 0.483
Validation loss decreased (-0.466646 --> -0.483313).  Saving model ...
Epoch: 22 cost time: 1.5852103233337402
Epoch: 22, Steps: 12 | Train Loss: 1.857 Vali Loss: 2.003 Vali Acc: 0.511 Test Loss: 2.003 Test Acc: 0.511
Validation loss decreased (-0.483313 --> -0.511091).  Saving model ...
Epoch: 23 cost time: 1.5138065814971924
Epoch: 23, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.960 Vali Acc: 0.517 Test Loss: 1.960 Test Acc: 0.517
Validation loss decreased (-0.511091 --> -0.516647).  Saving model ...
Epoch: 24 cost time: 2.1930365562438965
Epoch: 24, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.921 Vali Acc: 0.517 Test Loss: 1.921 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516647).  Saving model ...
Epoch: 25 cost time: 1.8591432571411133
Epoch: 25, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.876 Vali Acc: 0.517 Test Loss: 1.876 Test Acc: 0.517
Validation loss decreased (-0.516647 --> -0.516648).  Saving model ...
Epoch: 26 cost time: 1.775158405303955
Epoch: 26, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.841 Vali Acc: 0.544 Test Loss: 1.841 Test Acc: 0.544
Validation loss decreased (-0.516648 --> -0.544426).  Saving model ...
Epoch: 27 cost time: 1.8131036758422852
Epoch: 27, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.804 Vali Acc: 0.544 Test Loss: 1.804 Test Acc: 0.544
Validation loss decreased (-0.544426 --> -0.544426).  Saving model ...
Epoch: 28 cost time: 1.4833426475524902
Epoch: 28, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.770 Vali Acc: 0.567 Test Loss: 1.770 Test Acc: 0.567
Validation loss decreased (-0.544426 --> -0.566649).  Saving model ...
Epoch: 29 cost time: 1.810811996459961
Epoch: 29, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.747 Vali Acc: 0.556 Test Loss: 1.747 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0083255767822266
Epoch: 30, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.719 Vali Acc: 0.567 Test Loss: 1.719 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566649).  Saving model ...
Epoch: 31 cost time: 1.8462023735046387
Epoch: 31, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.676 Vali Acc: 0.583 Test Loss: 1.676 Test Acc: 0.583
Validation loss decreased (-0.566649 --> -0.583317).  Saving model ...
Epoch: 32 cost time: 1.6193511486053467
Epoch: 32, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.651 Vali Acc: 0.578 Test Loss: 1.651 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2040226459503174
Epoch: 33, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.632 Vali Acc: 0.572 Test Loss: 1.632 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0095787048339844
Epoch: 34, Steps: 12 | Train Loss: 1.366 Vali Loss: 1.607 Vali Acc: 0.578 Test Loss: 1.607 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6950352191925049
Epoch: 35, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.590 Vali Acc: 0.583 Test Loss: 1.590 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 36 cost time: 1.3941233158111572
Epoch: 36, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.566 Vali Acc: 0.589 Test Loss: 1.566 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 37 cost time: 1.6131253242492676
Epoch: 37, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.535 Vali Acc: 0.594 Test Loss: 1.535 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594429).  Saving model ...
Epoch: 38 cost time: 1.92673659324646
Epoch: 38, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.514 Vali Acc: 0.589 Test Loss: 1.514 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5939033031463623
Epoch: 39, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.501 Vali Acc: 0.600 Test Loss: 1.501 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599985).  Saving model ...
Epoch: 40 cost time: 1.6888501644134521
Epoch: 40, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.484 Vali Acc: 0.611 Test Loss: 1.484 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611096).  Saving model ...
Epoch: 41 cost time: 1.501899003982544
Epoch: 41, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.462 Vali Acc: 0.628 Test Loss: 1.462 Test Acc: 0.628
Validation loss decreased (-0.611096 --> -0.627763).  Saving model ...
Epoch: 42 cost time: 1.5552456378936768
Epoch: 42, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.455 Vali Acc: 0.639 Test Loss: 1.455 Test Acc: 0.639
Validation loss decreased (-0.627763 --> -0.638874).  Saving model ...
Epoch: 43 cost time: 1.9381272792816162
Epoch: 43, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.441 Vali Acc: 0.633 Test Loss: 1.441 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.580719232559204
Epoch: 44, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.423 Vali Acc: 0.611 Test Loss: 1.423 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.6261897087097168
Epoch: 45, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.407 Vali Acc: 0.622 Test Loss: 1.407 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3475799560546875
Epoch: 46, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.396 Vali Acc: 0.633 Test Loss: 1.396 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.543114185333252
Epoch: 47, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.379 Vali Acc: 0.633 Test Loss: 1.379 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.7004046440124512
Epoch: 48, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.373 Vali Acc: 0.622 Test Loss: 1.373 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.6449546813964844
Epoch: 49, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.367 Vali Acc: 0.617 Test Loss: 1.367 Test Acc: 0.617
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.5949795246124268
Epoch: 50, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.363 Vali Acc: 0.622 Test Loss: 1.363 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.5454919338226318
Epoch: 51, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.351 Vali Acc: 0.633 Test Loss: 1.351 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.6094551086425781
Epoch: 52, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.346 Vali Acc: 0.622 Test Loss: 1.346 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6388888888888888
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.848222017288208
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.74497389793396
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.734 Vali Acc: 0.094 Test Loss: 2.734 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.4195332527160645
Epoch: 3, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.714 Vali Acc: 0.111 Test Loss: 2.714 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.6929404735565186
Epoch: 4, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.693 Vali Acc: 0.106 Test Loss: 2.693 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4378464221954346
Epoch: 5, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.670 Vali Acc: 0.122 Test Loss: 2.670 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.6423959732055664
Epoch: 6, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.645 Vali Acc: 0.133 Test Loss: 2.645 Test Acc: 0.133
Validation loss decreased (-0.122196 --> -0.133307).  Saving model ...
Epoch: 7 cost time: 1.5085434913635254
Epoch: 7, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.618 Vali Acc: 0.156 Test Loss: 2.618 Test Acc: 0.156
Validation loss decreased (-0.133307 --> -0.155529).  Saving model ...
Epoch: 8 cost time: 1.6401381492614746
Epoch: 8, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.591 Vali Acc: 0.167 Test Loss: 2.591 Test Acc: 0.167
Validation loss decreased (-0.155529 --> -0.166641).  Saving model ...
Epoch: 9 cost time: 1.5713403224945068
Epoch: 9, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.563 Vali Acc: 0.200 Test Loss: 2.563 Test Acc: 0.200
Validation loss decreased (-0.166641 --> -0.199974).  Saving model ...
Epoch: 10 cost time: 1.4139058589935303
Epoch: 10, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.529 Vali Acc: 0.250 Test Loss: 2.529 Test Acc: 0.250
Validation loss decreased (-0.199974 --> -0.249975).  Saving model ...
Epoch: 11 cost time: 1.430393934249878
Epoch: 11, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.497 Vali Acc: 0.272 Test Loss: 2.497 Test Acc: 0.272
Validation loss decreased (-0.249975 --> -0.272197).  Saving model ...
Epoch: 12 cost time: 1.4756009578704834
Epoch: 12, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.467 Vali Acc: 0.278 Test Loss: 2.467 Test Acc: 0.278
Validation loss decreased (-0.272197 --> -0.277753).  Saving model ...
Epoch: 13 cost time: 1.3400087356567383
Epoch: 13, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.427 Vali Acc: 0.317 Test Loss: 2.427 Test Acc: 0.317
Validation loss decreased (-0.277753 --> -0.316642).  Saving model ...
Epoch: 14 cost time: 1.4426724910736084
Epoch: 14, Steps: 12 | Train Loss: 2.305 Vali Loss: 2.388 Vali Acc: 0.350 Test Loss: 2.388 Test Acc: 0.350
Validation loss decreased (-0.316642 --> -0.349976).  Saving model ...
Epoch: 15 cost time: 1.458186388015747
Epoch: 15, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.350 Vali Acc: 0.361 Test Loss: 2.350 Test Acc: 0.361
Validation loss decreased (-0.349976 --> -0.361088).  Saving model ...
Epoch: 16 cost time: 1.5657103061676025
Epoch: 16, Steps: 12 | Train Loss: 2.193 Vali Loss: 2.307 Vali Acc: 0.383 Test Loss: 2.307 Test Acc: 0.383
Validation loss decreased (-0.361088 --> -0.383310).  Saving model ...
Epoch: 17 cost time: 1.6297030448913574
Epoch: 17, Steps: 12 | Train Loss: 2.176 Vali Loss: 2.255 Vali Acc: 0.428 Test Loss: 2.255 Test Acc: 0.428
Validation loss decreased (-0.383310 --> -0.427755).  Saving model ...
Epoch: 18 cost time: 1.4134714603424072
Epoch: 18, Steps: 12 | Train Loss: 2.104 Vali Loss: 2.211 Vali Acc: 0.428 Test Loss: 2.211 Test Acc: 0.428
Validation loss decreased (-0.427755 --> -0.427756).  Saving model ...
Epoch: 19 cost time: 1.671433925628662
Epoch: 19, Steps: 12 | Train Loss: 2.039 Vali Loss: 2.161 Vali Acc: 0.444 Test Loss: 2.161 Test Acc: 0.444
Validation loss decreased (-0.427756 --> -0.444423).  Saving model ...
Epoch: 20 cost time: 1.7516934871673584
Epoch: 20, Steps: 12 | Train Loss: 1.975 Vali Loss: 2.111 Vali Acc: 0.456 Test Loss: 2.111 Test Acc: 0.456
Validation loss decreased (-0.444423 --> -0.455534).  Saving model ...
Epoch: 21 cost time: 1.5385596752166748
Epoch: 21, Steps: 12 | Train Loss: 1.913 Vali Loss: 2.057 Vali Acc: 0.483 Test Loss: 2.057 Test Acc: 0.483
Validation loss decreased (-0.455534 --> -0.483313).  Saving model ...
Epoch: 22 cost time: 1.4623305797576904
Epoch: 22, Steps: 12 | Train Loss: 1.866 Vali Loss: 2.011 Vali Acc: 0.511 Test Loss: 2.011 Test Acc: 0.511
Validation loss decreased (-0.483313 --> -0.511091).  Saving model ...
Epoch: 23 cost time: 1.5015244483947754
Epoch: 23, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.968 Vali Acc: 0.506 Test Loss: 1.968 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5126655101776123
Epoch: 24, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.929 Vali Acc: 0.511 Test Loss: 1.929 Test Acc: 0.511
Validation loss decreased (-0.511091 --> -0.511092).  Saving model ...
Epoch: 25 cost time: 1.5476186275482178
Epoch: 25, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.884 Vali Acc: 0.500 Test Loss: 1.884 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6431424617767334
Epoch: 26, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.849 Vali Acc: 0.544 Test Loss: 1.849 Test Acc: 0.544
Validation loss decreased (-0.511092 --> -0.544426).  Saving model ...
Epoch: 27 cost time: 1.442805290222168
Epoch: 27, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.812 Vali Acc: 0.533 Test Loss: 1.812 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4253957271575928
Epoch: 28, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.778 Vali Acc: 0.572 Test Loss: 1.778 Test Acc: 0.572
Validation loss decreased (-0.544426 --> -0.572204).  Saving model ...
Epoch: 29 cost time: 1.425346851348877
Epoch: 29, Steps: 12 | Train Loss: 1.516 Vali Loss: 1.755 Vali Acc: 0.556 Test Loss: 1.755 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6622023582458496
Epoch: 30, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.727 Vali Acc: 0.567 Test Loss: 1.727 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5080702304840088
Epoch: 31, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.684 Vali Acc: 0.583 Test Loss: 1.684 Test Acc: 0.583
Validation loss decreased (-0.572204 --> -0.583316).  Saving model ...
Epoch: 32 cost time: 1.7897779941558838
Epoch: 32, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.660 Vali Acc: 0.583 Test Loss: 1.660 Test Acc: 0.583
Validation loss decreased (-0.583316 --> -0.583317).  Saving model ...
Epoch: 33 cost time: 1.5566067695617676
Epoch: 33, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.641 Vali Acc: 0.578 Test Loss: 1.641 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6520891189575195
Epoch: 34, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.615 Vali Acc: 0.583 Test Loss: 1.615 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 35 cost time: 1.6418344974517822
Epoch: 35, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.597 Vali Acc: 0.583 Test Loss: 1.597 Test Acc: 0.583
Validation loss decreased (-0.583317 --> -0.583317).  Saving model ...
Epoch: 36 cost time: 1.918175220489502
Epoch: 36, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.574 Vali Acc: 0.589 Test Loss: 1.574 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 37 cost time: 1.247988224029541
Epoch: 37, Steps: 12 | Train Loss: 1.258 Vali Loss: 1.542 Vali Acc: 0.589 Test Loss: 1.542 Test Acc: 0.589
Validation loss decreased (-0.588873 --> -0.588873).  Saving model ...
Epoch: 38 cost time: 1.2582247257232666
Epoch: 38, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.522 Vali Acc: 0.583 Test Loss: 1.522 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4389698505401611
Epoch: 39, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.508 Vali Acc: 0.594 Test Loss: 1.508 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594429).  Saving model ...
Epoch: 40 cost time: 1.5689759254455566
Epoch: 40, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.491 Vali Acc: 0.606 Test Loss: 1.491 Test Acc: 0.606
Validation loss decreased (-0.594429 --> -0.605541).  Saving model ...
Epoch: 41 cost time: 1.7165203094482422
Epoch: 41, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.468 Vali Acc: 0.628 Test Loss: 1.468 Test Acc: 0.628
Validation loss decreased (-0.605541 --> -0.627763).  Saving model ...
Epoch: 42 cost time: 1.4870336055755615
Epoch: 42, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.461 Vali Acc: 0.633 Test Loss: 1.461 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633319).  Saving model ...
Epoch: 43 cost time: 1.6570980548858643
Epoch: 43, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.446 Vali Acc: 0.633 Test Loss: 1.446 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 1.6502156257629395
Epoch: 44, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.428 Vali Acc: 0.606 Test Loss: 1.428 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.420983076095581
Epoch: 45, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.412 Vali Acc: 0.622 Test Loss: 1.412 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6148755550384521
Epoch: 46, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.402 Vali Acc: 0.628 Test Loss: 1.402 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1794617176055908
Epoch: 47, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.384 Vali Acc: 0.617 Test Loss: 1.384 Test Acc: 0.617
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3090813159942627
Epoch: 48, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.378 Vali Acc: 0.628 Test Loss: 1.378 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.5042760372161865
Epoch: 49, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.372 Vali Acc: 0.628 Test Loss: 1.372 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.443263292312622
Epoch: 50, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.367 Vali Acc: 0.633 Test Loss: 1.367 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 51 cost time: 1.2984797954559326
Epoch: 51, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.356 Vali Acc: 0.633 Test Loss: 1.356 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 52 cost time: 1.3637111186981201
Epoch: 52, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.350 Vali Acc: 0.622 Test Loss: 1.350 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.5157999992370605
Epoch: 53, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.346 Vali Acc: 0.628 Test Loss: 1.346 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.762810230255127
Epoch: 54, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.331 Vali Acc: 0.633 Test Loss: 1.331 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 55 cost time: 1.692535400390625
Epoch: 55, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.316 Vali Acc: 0.633 Test Loss: 1.316 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633320).  Saving model ...
Epoch: 56 cost time: 1.4899470806121826
Epoch: 56, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.304 Vali Acc: 0.650 Test Loss: 1.304 Test Acc: 0.650
Validation loss decreased (-0.633320 --> -0.649987).  Saving model ...
Epoch: 57 cost time: 1.5428009033203125
Epoch: 57, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.302 Vali Acc: 0.639 Test Loss: 1.302 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2681000232696533
Epoch: 58, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.289 Vali Acc: 0.661 Test Loss: 1.289 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 59 cost time: 1.550797939300537
Epoch: 59, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.281 Vali Acc: 0.650 Test Loss: 1.281 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.475510597229004
Epoch: 60, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.274 Vali Acc: 0.661 Test Loss: 1.274 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 61 cost time: 1.5602519512176514
Epoch: 61, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.260 Vali Acc: 0.667 Test Loss: 1.260 Test Acc: 0.667
Validation loss decreased (-0.661098 --> -0.666654).  Saving model ...
Epoch: 62 cost time: 1.4684042930603027
Epoch: 62, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.256 Vali Acc: 0.667 Test Loss: 1.256 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 63 cost time: 1.6175086498260498
Epoch: 63, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.252 Vali Acc: 0.661 Test Loss: 1.252 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.8863887786865234
Epoch: 64, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.255 Vali Acc: 0.661 Test Loss: 1.255 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.5583515167236328
Epoch: 65, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.248 Vali Acc: 0.678 Test Loss: 1.248 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677765).  Saving model ...
Epoch: 66 cost time: 1.8047072887420654
Epoch: 66, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.245 Vali Acc: 0.678 Test Loss: 1.245 Test Acc: 0.678
Validation loss decreased (-0.677765 --> -0.677765).  Saving model ...
Epoch: 67 cost time: 1.5133450031280518
Epoch: 67, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.239 Vali Acc: 0.683 Test Loss: 1.239 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683321).  Saving model ...
Epoch: 68 cost time: 1.8211452960968018
Epoch: 68, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.223 Vali Acc: 0.683 Test Loss: 1.223 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 69 cost time: 2.0297653675079346
Epoch: 69, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.225 Vali Acc: 0.683 Test Loss: 1.225 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.7735271453857422
Epoch: 70, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.225 Vali Acc: 0.683 Test Loss: 1.225 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.6711535453796387
Epoch: 71, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.224 Vali Acc: 0.678 Test Loss: 1.224 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.4669785499572754
Epoch: 72, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.216 Vali Acc: 0.683 Test Loss: 1.216 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 73 cost time: 1.4405276775360107
Epoch: 73, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.219 Vali Acc: 0.672 Test Loss: 1.219 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.625654697418213
Epoch: 74, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.206 Vali Acc: 0.689 Test Loss: 1.206 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688877).  Saving model ...
Epoch: 75 cost time: 1.4467811584472656
Epoch: 75, Steps: 12 | Train Loss: 0.760 Vali Loss: 1.207 Vali Acc: 0.689 Test Loss: 1.207 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.7028558254241943
Epoch: 76, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.202 Vali Acc: 0.689 Test Loss: 1.202 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 77 cost time: 1.5464608669281006
Epoch: 77, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.194 Vali Acc: 0.700 Test Loss: 1.194 Test Acc: 0.700
Validation loss decreased (-0.688877 --> -0.699988).  Saving model ...
Epoch: 78 cost time: 1.515242576599121
Epoch: 78, Steps: 12 | Train Loss: 0.689 Vali Loss: 1.189 Vali Acc: 0.689 Test Loss: 1.189 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.5082826614379883
Epoch: 79, Steps: 12 | Train Loss: 0.674 Vali Loss: 1.186 Vali Acc: 0.694 Test Loss: 1.186 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.2797424793243408
Epoch: 80, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.177 Vali Acc: 0.694 Test Loss: 1.177 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.503875970840454
Epoch: 81, Steps: 12 | Train Loss: 0.720 Vali Loss: 1.176 Vali Acc: 0.689 Test Loss: 1.176 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.4066672325134277
Epoch: 82, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.172 Vali Acc: 0.689 Test Loss: 1.172 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.609260082244873
Epoch: 83, Steps: 12 | Train Loss: 0.680 Vali Loss: 1.163 Vali Acc: 0.694 Test Loss: 1.163 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.4509305953979492
Epoch: 84, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.166 Vali Acc: 0.694 Test Loss: 1.166 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.1921491622924805
Epoch: 85, Steps: 12 | Train Loss: 0.704 Vali Loss: 1.159 Vali Acc: 0.689 Test Loss: 1.159 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 1.417886734008789
Epoch: 86, Steps: 12 | Train Loss: 0.619 Vali Loss: 1.160 Vali Acc: 0.683 Test Loss: 1.160 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 1.3107621669769287
Epoch: 87, Steps: 12 | Train Loss: 0.627 Vali Loss: 1.152 Vali Acc: 0.694 Test Loss: 1.152 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.37678599357605
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.3189685344696045
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.734 Vali Acc: 0.094 Test Loss: 2.734 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.479740858078003
Epoch: 3, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.715 Vali Acc: 0.111 Test Loss: 2.715 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.4020025730133057
Epoch: 4, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.693 Vali Acc: 0.106 Test Loss: 2.693 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4621777534484863
Epoch: 5, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.670 Vali Acc: 0.122 Test Loss: 2.670 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.591118335723877
Epoch: 6, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.646 Vali Acc: 0.133 Test Loss: 2.646 Test Acc: 0.133
Validation loss decreased (-0.122196 --> -0.133307).  Saving model ...
Epoch: 7 cost time: 1.6271324157714844
Epoch: 7, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.618 Vali Acc: 0.144 Test Loss: 2.618 Test Acc: 0.144
Validation loss decreased (-0.133307 --> -0.144418).  Saving model ...
Epoch: 8 cost time: 1.3056080341339111
Epoch: 8, Steps: 12 | Train Loss: 2.557 Vali Loss: 2.592 Vali Acc: 0.167 Test Loss: 2.592 Test Acc: 0.167
Validation loss decreased (-0.144418 --> -0.166641).  Saving model ...
Epoch: 9 cost time: 1.4633731842041016
Epoch: 9, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.564 Vali Acc: 0.206 Test Loss: 2.564 Test Acc: 0.206
Validation loss decreased (-0.166641 --> -0.205530).  Saving model ...
Epoch: 10 cost time: 1.7251670360565186
Epoch: 10, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.530 Vali Acc: 0.233 Test Loss: 2.530 Test Acc: 0.233
Validation loss decreased (-0.205530 --> -0.233308).  Saving model ...
Epoch: 11 cost time: 1.5058326721191406
Epoch: 11, Steps: 12 | Train Loss: 2.440 Vali Loss: 2.499 Vali Acc: 0.272 Test Loss: 2.499 Test Acc: 0.272
Validation loss decreased (-0.233308 --> -0.272197).  Saving model ...
Epoch: 12 cost time: 1.810875654220581
Epoch: 12, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.469 Vali Acc: 0.278 Test Loss: 2.469 Test Acc: 0.278
Validation loss decreased (-0.272197 --> -0.277753).  Saving model ...
Epoch: 13 cost time: 1.1657469272613525
Epoch: 13, Steps: 12 | Train Loss: 2.359 Vali Loss: 2.430 Vali Acc: 0.311 Test Loss: 2.430 Test Acc: 0.311
Validation loss decreased (-0.277753 --> -0.311087).  Saving model ...
Epoch: 14 cost time: 1.5371532440185547
Epoch: 14, Steps: 12 | Train Loss: 2.309 Vali Loss: 2.391 Vali Acc: 0.350 Test Loss: 2.391 Test Acc: 0.350
Validation loss decreased (-0.311087 --> -0.349976).  Saving model ...
Epoch: 15 cost time: 1.2363321781158447
Epoch: 15, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.353 Vali Acc: 0.367 Test Loss: 2.353 Test Acc: 0.367
Validation loss decreased (-0.349976 --> -0.366643).  Saving model ...
Epoch: 16 cost time: 1.5050334930419922
Epoch: 16, Steps: 12 | Train Loss: 2.198 Vali Loss: 2.310 Vali Acc: 0.378 Test Loss: 2.310 Test Acc: 0.378
Validation loss decreased (-0.366643 --> -0.377755).  Saving model ...
Epoch: 17 cost time: 1.3290979862213135
Epoch: 17, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.258 Vali Acc: 0.428 Test Loss: 2.258 Test Acc: 0.428
Validation loss decreased (-0.377755 --> -0.427755).  Saving model ...
Epoch: 18 cost time: 1.3957788944244385
Epoch: 18, Steps: 12 | Train Loss: 2.108 Vali Loss: 2.215 Vali Acc: 0.422 Test Loss: 2.215 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.52238130569458
Epoch: 19, Steps: 12 | Train Loss: 2.044 Vali Loss: 2.165 Vali Acc: 0.439 Test Loss: 2.165 Test Acc: 0.439
Validation loss decreased (-0.427755 --> -0.438867).  Saving model ...
Epoch: 20 cost time: 1.4937076568603516
Epoch: 20, Steps: 12 | Train Loss: 1.981 Vali Loss: 2.115 Vali Acc: 0.450 Test Loss: 2.115 Test Acc: 0.450
Validation loss decreased (-0.438867 --> -0.449979).  Saving model ...
Epoch: 21 cost time: 1.4206781387329102
Epoch: 21, Steps: 12 | Train Loss: 1.919 Vali Loss: 2.061 Vali Acc: 0.472 Test Loss: 2.061 Test Acc: 0.472
Validation loss decreased (-0.449979 --> -0.472202).  Saving model ...
Epoch: 22 cost time: 1.2461366653442383
Epoch: 22, Steps: 12 | Train Loss: 1.872 Vali Loss: 2.015 Vali Acc: 0.500 Test Loss: 2.015 Test Acc: 0.500
Validation loss decreased (-0.472202 --> -0.499980).  Saving model ...
Epoch: 23 cost time: 1.3112008571624756
Epoch: 23, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.972 Vali Acc: 0.500 Test Loss: 1.972 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499980).  Saving model ...
Epoch: 24 cost time: 1.3915462493896484
Epoch: 24, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.934 Vali Acc: 0.506 Test Loss: 1.934 Test Acc: 0.506
Validation loss decreased (-0.499980 --> -0.505536).  Saving model ...
Epoch: 25 cost time: 1.3480238914489746
Epoch: 25, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.889 Vali Acc: 0.494 Test Loss: 1.889 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6103479862213135
Epoch: 26, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.854 Vali Acc: 0.528 Test Loss: 1.854 Test Acc: 0.528
Validation loss decreased (-0.505536 --> -0.527759).  Saving model ...
Epoch: 27 cost time: 1.4243195056915283
Epoch: 27, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.817 Vali Acc: 0.544 Test Loss: 1.817 Test Acc: 0.544
Validation loss decreased (-0.527759 --> -0.544426).  Saving model ...
Epoch: 28 cost time: 1.268869400024414
Epoch: 28, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.783 Vali Acc: 0.550 Test Loss: 1.783 Test Acc: 0.550
Validation loss decreased (-0.544426 --> -0.549982).  Saving model ...
Epoch: 29 cost time: 1.0640490055084229
Epoch: 29, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.760 Vali Acc: 0.544 Test Loss: 1.760 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2800631523132324
Epoch: 30, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.732 Vali Acc: 0.556 Test Loss: 1.732 Test Acc: 0.556
Validation loss decreased (-0.549982 --> -0.555538).  Saving model ...
Epoch: 31 cost time: 1.2786099910736084
Epoch: 31, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.690 Vali Acc: 0.572 Test Loss: 1.690 Test Acc: 0.572
Validation loss decreased (-0.555538 --> -0.572205).  Saving model ...
Epoch: 32 cost time: 1.31876802444458
Epoch: 32, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.665 Vali Acc: 0.567 Test Loss: 1.665 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.587477445602417
Epoch: 33, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.646 Vali Acc: 0.550 Test Loss: 1.646 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1691510677337646
Epoch: 34, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.620 Vali Acc: 0.578 Test Loss: 1.620 Test Acc: 0.578
Validation loss decreased (-0.572205 --> -0.577762).  Saving model ...
Epoch: 35 cost time: 1.3155298233032227
Epoch: 35, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.602 Vali Acc: 0.583 Test Loss: 1.602 Test Acc: 0.583
Validation loss decreased (-0.577762 --> -0.583317).  Saving model ...
Epoch: 36 cost time: 1.521052598953247
Epoch: 36, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.579 Vali Acc: 0.589 Test Loss: 1.579 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 37 cost time: 1.603388786315918
Epoch: 37, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.547 Vali Acc: 0.594 Test Loss: 1.547 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594429).  Saving model ...
Epoch: 38 cost time: 1.530639410018921
Epoch: 38, Steps: 12 | Train Loss: 1.244 Vali Loss: 1.527 Vali Acc: 0.589 Test Loss: 1.527 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4753780364990234
Epoch: 39, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.513 Vali Acc: 0.583 Test Loss: 1.513 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1996655464172363
Epoch: 40, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.496 Vali Acc: 0.589 Test Loss: 1.496 Test Acc: 0.589
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3787219524383545
Epoch: 41, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.473 Vali Acc: 0.617 Test Loss: 1.473 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616652).  Saving model ...
Epoch: 42 cost time: 1.3404450416564941
Epoch: 42, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.466 Vali Acc: 0.628 Test Loss: 1.466 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627763).  Saving model ...
Epoch: 43 cost time: 1.3921523094177246
Epoch: 43, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.451 Vali Acc: 0.633 Test Loss: 1.451 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 1.3408644199371338
Epoch: 44, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.432 Vali Acc: 0.617 Test Loss: 1.432 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2518267631530762
Epoch: 45, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.416 Vali Acc: 0.611 Test Loss: 1.416 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.496919870376587
Epoch: 46, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.406 Vali Acc: 0.633 Test Loss: 1.406 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 47 cost time: 1.5444014072418213
Epoch: 47, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.388 Vali Acc: 0.611 Test Loss: 1.388 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4353928565979004
Epoch: 48, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.382 Vali Acc: 0.617 Test Loss: 1.382 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.4084346294403076
Epoch: 49, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.376 Vali Acc: 0.628 Test Loss: 1.376 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.4222028255462646
Epoch: 50, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.371 Vali Acc: 0.633 Test Loss: 1.371 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 51 cost time: 1.3762304782867432
Epoch: 51, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.360 Vali Acc: 0.639 Test Loss: 1.360 Test Acc: 0.639
Validation loss decreased (-0.633320 --> -0.638875).  Saving model ...
Epoch: 52 cost time: 1.3348066806793213
Epoch: 52, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.354 Vali Acc: 0.628 Test Loss: 1.354 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3711977005004883
Epoch: 53, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.350 Vali Acc: 0.628 Test Loss: 1.350 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3961799144744873
Epoch: 54, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.335 Vali Acc: 0.633 Test Loss: 1.335 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3024637699127197
Epoch: 55, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.319 Vali Acc: 0.633 Test Loss: 1.319 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.3003442287445068
Epoch: 56, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.307 Vali Acc: 0.650 Test Loss: 1.307 Test Acc: 0.650
Validation loss decreased (-0.638875 --> -0.649987).  Saving model ...
Epoch: 57 cost time: 1.246309518814087
Epoch: 57, Steps: 12 | Train Loss: 0.938 Vali Loss: 1.305 Vali Acc: 0.628 Test Loss: 1.305 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.3078930377960205
Epoch: 58, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.293 Vali Acc: 0.661 Test Loss: 1.293 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 59 cost time: 1.3725104331970215
Epoch: 59, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.285 Vali Acc: 0.650 Test Loss: 1.285 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4070613384246826
Epoch: 60, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.278 Vali Acc: 0.656 Test Loss: 1.278 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.244858980178833
Epoch: 61, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.263 Vali Acc: 0.661 Test Loss: 1.263 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661098).  Saving model ...
Epoch: 62 cost time: 1.4084064960479736
Epoch: 62, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.259 Vali Acc: 0.667 Test Loss: 1.259 Test Acc: 0.667
Validation loss decreased (-0.661098 --> -0.666654).  Saving model ...
Epoch: 63 cost time: 1.2110357284545898
Epoch: 63, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.254 Vali Acc: 0.667 Test Loss: 1.254 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 64 cost time: 1.1579711437225342
Epoch: 64, Steps: 12 | Train Loss: 0.825 Vali Loss: 1.257 Vali Acc: 0.661 Test Loss: 1.257 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.244229793548584
Epoch: 65, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.251 Vali Acc: 0.672 Test Loss: 1.251 Test Acc: 0.672
Validation loss decreased (-0.666654 --> -0.672210).  Saving model ...
Epoch: 66 cost time: 1.1068942546844482
Epoch: 66, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.248 Vali Acc: 0.672 Test Loss: 1.248 Test Acc: 0.672
Validation loss decreased (-0.672210 --> -0.672210).  Saving model ...
Epoch: 67 cost time: 1.4491500854492188
Epoch: 67, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.241 Vali Acc: 0.683 Test Loss: 1.241 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683321).  Saving model ...
Epoch: 68 cost time: 1.31099534034729
Epoch: 68, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.225 Vali Acc: 0.683 Test Loss: 1.225 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 69 cost time: 1.320800542831421
Epoch: 69, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.227 Vali Acc: 0.678 Test Loss: 1.227 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.406080961227417
Epoch: 70, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.226 Vali Acc: 0.678 Test Loss: 1.226 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.3968265056610107
Epoch: 71, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.226 Vali Acc: 0.672 Test Loss: 1.226 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.3899588584899902
Epoch: 72, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.217 Vali Acc: 0.678 Test Loss: 1.217 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.415823221206665
Epoch: 73, Steps: 12 | Train Loss: 0.756 Vali Loss: 1.219 Vali Acc: 0.667 Test Loss: 1.219 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.193465232849121
Epoch: 74, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.206 Vali Acc: 0.683 Test Loss: 1.206 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 75 cost time: 1.4914276599884033
Epoch: 75, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.207 Vali Acc: 0.683 Test Loss: 1.207 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.5914642810821533
Epoch: 76, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.202 Vali Acc: 0.683 Test Loss: 1.202 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683321).  Saving model ...
Epoch: 77 cost time: 1.3735289573669434
Epoch: 77, Steps: 12 | Train Loss: 0.733 Vali Loss: 1.193 Vali Acc: 0.689 Test Loss: 1.193 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688877).  Saving model ...
Epoch: 78 cost time: 1.5728001594543457
Epoch: 78, Steps: 12 | Train Loss: 0.699 Vali Loss: 1.188 Vali Acc: 0.678 Test Loss: 1.188 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.5192022323608398
Epoch: 79, Steps: 12 | Train Loss: 0.683 Vali Loss: 1.185 Vali Acc: 0.689 Test Loss: 1.185 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 80 cost time: 1.3745622634887695
Epoch: 80, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.176 Vali Acc: 0.689 Test Loss: 1.176 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 81 cost time: 1.6494338512420654
Epoch: 81, Steps: 12 | Train Loss: 0.733 Vali Loss: 1.175 Vali Acc: 0.689 Test Loss: 1.175 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 82 cost time: 1.4414863586425781
Epoch: 82, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.170 Vali Acc: 0.689 Test Loss: 1.170 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 83 cost time: 1.7072420120239258
Epoch: 83, Steps: 12 | Train Loss: 0.690 Vali Loss: 1.161 Vali Acc: 0.694 Test Loss: 1.161 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694433).  Saving model ...
Epoch: 84 cost time: 1.6166534423828125
Epoch: 84, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.164 Vali Acc: 0.689 Test Loss: 1.164 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.7927465438842773
Epoch: 85, Steps: 12 | Train Loss: 0.713 Vali Loss: 1.157 Vali Acc: 0.683 Test Loss: 1.157 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.456061840057373
Epoch: 86, Steps: 12 | Train Loss: 0.628 Vali Loss: 1.158 Vali Acc: 0.683 Test Loss: 1.158 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.5548877716064453
Epoch: 87, Steps: 12 | Train Loss: 0.636 Vali Loss: 1.150 Vali Acc: 0.689 Test Loss: 1.150 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.4696369171142578
Epoch: 88, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.148 Vali Acc: 0.689 Test Loss: 1.148 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.2465624809265137
Epoch: 89, Steps: 12 | Train Loss: 0.677 Vali Loss: 1.153 Vali Acc: 0.689 Test Loss: 1.153 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.3783907890319824
Epoch: 90, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.146 Vali Acc: 0.694 Test Loss: 1.146 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694433).  Saving model ...
Epoch: 91 cost time: 1.4521095752716064
Epoch: 91, Steps: 12 | Train Loss: 0.608 Vali Loss: 1.141 Vali Acc: 0.694 Test Loss: 1.141 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694433).  Saving model ...
Epoch: 92 cost time: 1.1430001258850098
Epoch: 92, Steps: 12 | Train Loss: 0.619 Vali Loss: 1.140 Vali Acc: 0.694 Test Loss: 1.140 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694433).  Saving model ...
Epoch: 93 cost time: 1.216794490814209
Epoch: 93, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.150 Vali Acc: 0.689 Test Loss: 1.150 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.3286771774291992
Epoch: 94, Steps: 12 | Train Loss: 0.603 Vali Loss: 1.141 Vali Acc: 0.683 Test Loss: 1.141 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.3539412021636963
Epoch: 95, Steps: 12 | Train Loss: 0.591 Vali Loss: 1.143 Vali Acc: 0.683 Test Loss: 1.143 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.4758949279785156
Epoch: 96, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.145 Vali Acc: 0.683 Test Loss: 1.145 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.409179925918579
Epoch: 97, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.145 Vali Acc: 0.683 Test Loss: 1.145 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 1.3899874687194824
Epoch: 98, Steps: 12 | Train Loss: 0.589 Vali Loss: 1.148 Vali Acc: 0.683 Test Loss: 1.148 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 1.7170135974884033
Epoch: 99, Steps: 12 | Train Loss: 0.570 Vali Loss: 1.138 Vali Acc: 0.683 Test Loss: 1.138 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 1.4529798030853271
Epoch: 100, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.145 Vali Acc: 0.689 Test Loss: 1.145 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6944444444444444
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1087496280670166
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.325021505355835
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.733 Vali Acc: 0.094 Test Loss: 2.733 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.3663344383239746
Epoch: 3, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.713 Vali Acc: 0.117 Test Loss: 2.713 Test Acc: 0.117
Validation loss decreased (-0.094417 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 1.381788730621338
Epoch: 4, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.691 Vali Acc: 0.111 Test Loss: 2.691 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1549336910247803
Epoch: 5, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.667 Vali Acc: 0.133 Test Loss: 2.667 Test Acc: 0.133
Validation loss decreased (-0.116640 --> -0.133307).  Saving model ...
Epoch: 6 cost time: 1.257390022277832
Epoch: 6, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.642 Vali Acc: 0.133 Test Loss: 2.642 Test Acc: 0.133
Validation loss decreased (-0.133307 --> -0.133307).  Saving model ...
Epoch: 7 cost time: 1.0403802394866943
Epoch: 7, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.613 Vali Acc: 0.150 Test Loss: 2.613 Test Acc: 0.150
Validation loss decreased (-0.133307 --> -0.149974).  Saving model ...
Epoch: 8 cost time: 1.3330821990966797
Epoch: 8, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.585 Vali Acc: 0.172 Test Loss: 2.585 Test Acc: 0.172
Validation loss decreased (-0.149974 --> -0.172196).  Saving model ...
Epoch: 9 cost time: 1.3061418533325195
Epoch: 9, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.556 Vali Acc: 0.228 Test Loss: 2.556 Test Acc: 0.228
Validation loss decreased (-0.172196 --> -0.227752).  Saving model ...
Epoch: 10 cost time: 1.2178428173065186
Epoch: 10, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.520 Vali Acc: 0.267 Test Loss: 2.520 Test Acc: 0.267
Validation loss decreased (-0.227752 --> -0.266641).  Saving model ...
Epoch: 11 cost time: 1.3658673763275146
Epoch: 11, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.487 Vali Acc: 0.283 Test Loss: 2.487 Test Acc: 0.283
Validation loss decreased (-0.266641 --> -0.283308).  Saving model ...
Epoch: 12 cost time: 1.1567199230194092
Epoch: 12, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.455 Vali Acc: 0.294 Test Loss: 2.455 Test Acc: 0.294
Validation loss decreased (-0.283308 --> -0.294420).  Saving model ...
Epoch: 13 cost time: 1.2384355068206787
Epoch: 13, Steps: 12 | Train Loss: 2.343 Vali Loss: 2.414 Vali Acc: 0.322 Test Loss: 2.414 Test Acc: 0.322
Validation loss decreased (-0.294420 --> -0.322198).  Saving model ...
Epoch: 14 cost time: 1.3127954006195068
Epoch: 14, Steps: 12 | Train Loss: 2.288 Vali Loss: 2.374 Vali Acc: 0.367 Test Loss: 2.374 Test Acc: 0.367
Validation loss decreased (-0.322198 --> -0.366643).  Saving model ...
Epoch: 15 cost time: 1.4782593250274658
Epoch: 15, Steps: 12 | Train Loss: 2.230 Vali Loss: 2.333 Vali Acc: 0.383 Test Loss: 2.333 Test Acc: 0.383
Validation loss decreased (-0.366643 --> -0.383310).  Saving model ...
Epoch: 16 cost time: 1.3611674308776855
Epoch: 16, Steps: 12 | Train Loss: 2.174 Vali Loss: 2.288 Vali Acc: 0.411 Test Loss: 2.288 Test Acc: 0.411
Validation loss decreased (-0.383310 --> -0.411088).  Saving model ...
Epoch: 17 cost time: 1.4575073719024658
Epoch: 17, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.235 Vali Acc: 0.428 Test Loss: 2.235 Test Acc: 0.428
Validation loss decreased (-0.411088 --> -0.427755).  Saving model ...
Epoch: 18 cost time: 1.167823314666748
Epoch: 18, Steps: 12 | Train Loss: 2.078 Vali Loss: 2.189 Vali Acc: 0.433 Test Loss: 2.189 Test Acc: 0.433
Validation loss decreased (-0.427755 --> -0.433311).  Saving model ...
Epoch: 19 cost time: 1.310462236404419
Epoch: 19, Steps: 12 | Train Loss: 2.015 Vali Loss: 2.138 Vali Acc: 0.450 Test Loss: 2.138 Test Acc: 0.450
Validation loss decreased (-0.433311 --> -0.449979).  Saving model ...
Epoch: 20 cost time: 1.3318984508514404
Epoch: 20, Steps: 12 | Train Loss: 1.943 Vali Loss: 2.085 Vali Acc: 0.483 Test Loss: 2.085 Test Acc: 0.483
Validation loss decreased (-0.449979 --> -0.483312).  Saving model ...
Epoch: 21 cost time: 1.324995517730713
Epoch: 21, Steps: 12 | Train Loss: 1.882 Vali Loss: 2.029 Vali Acc: 0.517 Test Loss: 2.029 Test Acc: 0.517
Validation loss decreased (-0.483312 --> -0.516646).  Saving model ...
Epoch: 22 cost time: 1.2285888195037842
Epoch: 22, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.981 Vali Acc: 0.533 Test Loss: 1.981 Test Acc: 0.533
Validation loss decreased (-0.516646 --> -0.533314).  Saving model ...
Epoch: 23 cost time: 1.1614935398101807
Epoch: 23, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.936 Vali Acc: 0.539 Test Loss: 1.936 Test Acc: 0.539
Validation loss decreased (-0.533314 --> -0.538870).  Saving model ...
Epoch: 24 cost time: 1.316735029220581
Epoch: 24, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.896 Vali Acc: 0.522 Test Loss: 1.896 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3848199844360352
Epoch: 25, Steps: 12 | Train Loss: 1.644 Vali Loss: 1.850 Vali Acc: 0.506 Test Loss: 1.850 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4338867664337158
Epoch: 26, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.815 Vali Acc: 0.539 Test Loss: 1.815 Test Acc: 0.539
Validation loss decreased (-0.538870 --> -0.538871).  Saving model ...
Epoch: 27 cost time: 1.4095923900604248
Epoch: 27, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.778 Vali Acc: 0.544 Test Loss: 1.778 Test Acc: 0.544
Validation loss decreased (-0.538871 --> -0.544427).  Saving model ...
Epoch: 28 cost time: 1.1728169918060303
Epoch: 28, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.744 Vali Acc: 0.556 Test Loss: 1.744 Test Acc: 0.556
Validation loss decreased (-0.544427 --> -0.555538).  Saving model ...
Epoch: 29 cost time: 1.0073049068450928
Epoch: 29, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.721 Vali Acc: 0.561 Test Loss: 1.721 Test Acc: 0.561
Validation loss decreased (-0.555538 --> -0.561094).  Saving model ...
Epoch: 30 cost time: 1.7464852333068848
Epoch: 30, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.694 Vali Acc: 0.567 Test Loss: 1.694 Test Acc: 0.567
Validation loss decreased (-0.561094 --> -0.566650).  Saving model ...
Epoch: 31 cost time: 1.5797476768493652
Epoch: 31, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.653 Vali Acc: 0.572 Test Loss: 1.653 Test Acc: 0.572
Validation loss decreased (-0.566650 --> -0.572206).  Saving model ...
Epoch: 32 cost time: 1.6053564548492432
Epoch: 32, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.630 Vali Acc: 0.572 Test Loss: 1.630 Test Acc: 0.572
Validation loss decreased (-0.572206 --> -0.572206).  Saving model ...
Epoch: 33 cost time: 1.4703285694122314
Epoch: 33, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.613 Vali Acc: 0.567 Test Loss: 1.613 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4886341094970703
Epoch: 34, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.589 Vali Acc: 0.589 Test Loss: 1.589 Test Acc: 0.589
Validation loss decreased (-0.572206 --> -0.588873).  Saving model ...
Epoch: 35 cost time: 1.1912896633148193
Epoch: 35, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.573 Vali Acc: 0.594 Test Loss: 1.573 Test Acc: 0.594
Validation loss decreased (-0.588873 --> -0.594429).  Saving model ...
Epoch: 36 cost time: 1.2643322944641113
Epoch: 36, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.550 Vali Acc: 0.606 Test Loss: 1.550 Test Acc: 0.606
Validation loss decreased (-0.594429 --> -0.605540).  Saving model ...
Epoch: 37 cost time: 1.3388588428497314
Epoch: 37, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.520 Vali Acc: 0.606 Test Loss: 1.520 Test Acc: 0.606
Validation loss decreased (-0.605540 --> -0.605540).  Saving model ...
Epoch: 38 cost time: 1.193352460861206
Epoch: 38, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.501 Vali Acc: 0.600 Test Loss: 1.501 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2579913139343262
Epoch: 39, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.489 Vali Acc: 0.617 Test Loss: 1.489 Test Acc: 0.617
Validation loss decreased (-0.605540 --> -0.616652).  Saving model ...
Epoch: 40 cost time: 1.1090478897094727
Epoch: 40, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.474 Vali Acc: 0.622 Test Loss: 1.474 Test Acc: 0.622
Validation loss decreased (-0.616652 --> -0.622207).  Saving model ...
Epoch: 41 cost time: 1.185168981552124
Epoch: 41, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.452 Vali Acc: 0.628 Test Loss: 1.452 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627763).  Saving model ...
Epoch: 42 cost time: 1.3213255405426025
Epoch: 42, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.446 Vali Acc: 0.628 Test Loss: 1.446 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627763).  Saving model ...
Epoch: 43 cost time: 1.1558647155761719
Epoch: 43, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.432 Vali Acc: 0.628 Test Loss: 1.432 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627763).  Saving model ...
Epoch: 44 cost time: 1.3352625370025635
Epoch: 44, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.415 Vali Acc: 0.617 Test Loss: 1.415 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2798340320587158
Epoch: 45, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.400 Vali Acc: 0.622 Test Loss: 1.400 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2944121360778809
Epoch: 46, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.391 Vali Acc: 0.611 Test Loss: 1.391 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2115919589996338
Epoch: 47, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.375 Vali Acc: 0.622 Test Loss: 1.375 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.353754997253418
Epoch: 48, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.368 Vali Acc: 0.628 Test Loss: 1.368 Test Acc: 0.628
Validation loss decreased (-0.627763 --> -0.627764).  Saving model ...
Epoch: 49 cost time: 1.558354139328003
Epoch: 49, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.363 Vali Acc: 0.622 Test Loss: 1.363 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3011958599090576
Epoch: 50, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.359 Vali Acc: 0.628 Test Loss: 1.359 Test Acc: 0.628
Validation loss decreased (-0.627764 --> -0.627764).  Saving model ...
Epoch: 51 cost time: 1.290093183517456
Epoch: 51, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.348 Vali Acc: 0.639 Test Loss: 1.348 Test Acc: 0.639
Validation loss decreased (-0.627764 --> -0.638875).  Saving model ...
Epoch: 52 cost time: 1.2355921268463135
Epoch: 52, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.343 Vali Acc: 0.628 Test Loss: 1.343 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3544862270355225
Epoch: 53, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.339 Vali Acc: 0.644 Test Loss: 1.339 Test Acc: 0.644
Validation loss decreased (-0.638875 --> -0.644431).  Saving model ...
Epoch: 54 cost time: 1.1633648872375488
Epoch: 54, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.325 Vali Acc: 0.650 Test Loss: 1.325 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649987).  Saving model ...
Epoch: 55 cost time: 1.2152414321899414
Epoch: 55, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.310 Vali Acc: 0.667 Test Loss: 1.310 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666654).  Saving model ...
Epoch: 56 cost time: 1.2325403690338135
Epoch: 56, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.298 Vali Acc: 0.656 Test Loss: 1.298 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3729865550994873
Epoch: 57, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.297 Vali Acc: 0.644 Test Loss: 1.297 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1382277011871338
Epoch: 58, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.285 Vali Acc: 0.656 Test Loss: 1.285 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.40940260887146
Epoch: 59, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.277 Vali Acc: 0.656 Test Loss: 1.277 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.063209056854248
Epoch: 60, Steps: 12 | Train Loss: 0.926 Vali Loss: 1.272 Vali Acc: 0.678 Test Loss: 1.272 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677765).  Saving model ...
Epoch: 61 cost time: 1.3590366840362549
Epoch: 61, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.257 Vali Acc: 0.678 Test Loss: 1.257 Test Acc: 0.678
Validation loss decreased (-0.677765 --> -0.677765).  Saving model ...
Epoch: 62 cost time: 1.319676399230957
Epoch: 62, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.254 Vali Acc: 0.672 Test Loss: 1.254 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3166165351867676
Epoch: 63, Steps: 12 | Train Loss: 0.824 Vali Loss: 1.250 Vali Acc: 0.667 Test Loss: 1.250 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2214255332946777
Epoch: 64, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.253 Vali Acc: 0.661 Test Loss: 1.253 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.152764081954956
Epoch: 65, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.247 Vali Acc: 0.683 Test Loss: 1.247 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683321).  Saving model ...
Epoch: 66 cost time: 1.1073453426361084
Epoch: 66, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.245 Vali Acc: 0.678 Test Loss: 1.245 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.6391501426696777
Epoch: 67, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.240 Vali Acc: 0.689 Test Loss: 1.240 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688876).  Saving model ...
Epoch: 68 cost time: 1.3179428577423096
Epoch: 68, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.224 Vali Acc: 0.678 Test Loss: 1.224 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1837732791900635
Epoch: 69, Steps: 12 | Train Loss: 0.765 Vali Loss: 1.227 Vali Acc: 0.700 Test Loss: 1.227 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 70 cost time: 1.3195116519927979
Epoch: 70, Steps: 12 | Train Loss: 0.733 Vali Loss: 1.226 Vali Acc: 0.694 Test Loss: 1.226 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.46915864944458
Epoch: 71, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.226 Vali Acc: 0.689 Test Loss: 1.226 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.5196576118469238
Epoch: 72, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.220 Vali Acc: 0.672 Test Loss: 1.220 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.2742152214050293
Epoch: 73, Steps: 12 | Train Loss: 0.726 Vali Loss: 1.223 Vali Acc: 0.678 Test Loss: 1.223 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.3543274402618408
Epoch: 74, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.211 Vali Acc: 0.689 Test Loss: 1.211 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.1512267589569092
Epoch: 75, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.213 Vali Acc: 0.694 Test Loss: 1.213 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.5465664863586426
Epoch: 76, Steps: 12 | Train Loss: 0.721 Vali Loss: 1.208 Vali Acc: 0.689 Test Loss: 1.208 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.3207814693450928
Epoch: 77, Steps: 12 | Train Loss: 0.702 Vali Loss: 1.201 Vali Acc: 0.689 Test Loss: 1.201 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.3047306537628174
Epoch: 78, Steps: 12 | Train Loss: 0.669 Vali Loss: 1.197 Vali Acc: 0.683 Test Loss: 1.197 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.0853207111358643
Epoch: 79, Steps: 12 | Train Loss: 0.656 Vali Loss: 1.194 Vali Acc: 0.694 Test Loss: 1.194 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7
model parameter : 5505
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6374285221099854
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.748 Vali Acc: 0.083 Test Loss: 2.748 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.404250144958496
Epoch: 2, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.734 Vali Acc: 0.094 Test Loss: 2.734 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 1.5156748294830322
Epoch: 3, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.715 Vali Acc: 0.111 Test Loss: 2.715 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 1.4736316204071045
Epoch: 4, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.693 Vali Acc: 0.106 Test Loss: 2.693 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3654592037200928
Epoch: 5, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.671 Vali Acc: 0.122 Test Loss: 2.671 Test Acc: 0.122
Validation loss decreased (-0.111084 --> -0.122196).  Saving model ...
Epoch: 6 cost time: 1.1388797760009766
Epoch: 6, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.646 Vali Acc: 0.133 Test Loss: 2.646 Test Acc: 0.133
Validation loss decreased (-0.122196 --> -0.133307).  Saving model ...
Epoch: 7 cost time: 1.26953125
Epoch: 7, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.619 Vali Acc: 0.144 Test Loss: 2.619 Test Acc: 0.144
Validation loss decreased (-0.133307 --> -0.144418).  Saving model ...
Epoch: 8 cost time: 1.017552137374878
Epoch: 8, Steps: 12 | Train Loss: 2.558 Vali Loss: 2.592 Vali Acc: 0.172 Test Loss: 2.592 Test Acc: 0.172
Validation loss decreased (-0.144418 --> -0.172196).  Saving model ...
Epoch: 9 cost time: 1.3872942924499512
Epoch: 9, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.565 Vali Acc: 0.206 Test Loss: 2.565 Test Acc: 0.206
Validation loss decreased (-0.172196 --> -0.205530).  Saving model ...
Epoch: 10 cost time: 1.2067623138427734
Epoch: 10, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.530 Vali Acc: 0.239 Test Loss: 2.530 Test Acc: 0.239
Validation loss decreased (-0.205530 --> -0.238864).  Saving model ...
Epoch: 11 cost time: 1.3080615997314453
Epoch: 11, Steps: 12 | Train Loss: 2.441 Vali Loss: 2.499 Vali Acc: 0.272 Test Loss: 2.499 Test Acc: 0.272
Validation loss decreased (-0.238864 --> -0.272197).  Saving model ...
Epoch: 12 cost time: 1.388232946395874
Epoch: 12, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.469 Vali Acc: 0.278 Test Loss: 2.469 Test Acc: 0.278
Validation loss decreased (-0.272197 --> -0.277753).  Saving model ...
Epoch: 13 cost time: 1.2549989223480225
Epoch: 13, Steps: 12 | Train Loss: 2.361 Vali Loss: 2.430 Vali Acc: 0.306 Test Loss: 2.430 Test Acc: 0.306
Validation loss decreased (-0.277753 --> -0.305531).  Saving model ...
Epoch: 14 cost time: 1.0999042987823486
Epoch: 14, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.392 Vali Acc: 0.350 Test Loss: 2.392 Test Acc: 0.350
Validation loss decreased (-0.305531 --> -0.349976).  Saving model ...
Epoch: 15 cost time: 1.2036387920379639
Epoch: 15, Steps: 12 | Train Loss: 2.255 Vali Loss: 2.353 Vali Acc: 0.367 Test Loss: 2.353 Test Acc: 0.367
Validation loss decreased (-0.349976 --> -0.366643).  Saving model ...
Epoch: 16 cost time: 1.2834148406982422
Epoch: 16, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.311 Vali Acc: 0.383 Test Loss: 2.311 Test Acc: 0.383
Validation loss decreased (-0.366643 --> -0.383310).  Saving model ...
Epoch: 17 cost time: 1.3020834922790527
Epoch: 17, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.259 Vali Acc: 0.422 Test Loss: 2.259 Test Acc: 0.422
Validation loss decreased (-0.383310 --> -0.422200).  Saving model ...
Epoch: 18 cost time: 1.420100450515747
Epoch: 18, Steps: 12 | Train Loss: 2.111 Vali Loss: 2.216 Vali Acc: 0.422 Test Loss: 2.216 Test Acc: 0.422
Validation loss decreased (-0.422200 --> -0.422200).  Saving model ...
Epoch: 19 cost time: 1.5750243663787842
Epoch: 19, Steps: 12 | Train Loss: 2.047 Vali Loss: 2.166 Vali Acc: 0.433 Test Loss: 2.166 Test Acc: 0.433
Validation loss decreased (-0.422200 --> -0.433312).  Saving model ...
Epoch: 20 cost time: 1.1647346019744873
Epoch: 20, Steps: 12 | Train Loss: 1.983 Vali Loss: 2.116 Vali Acc: 0.456 Test Loss: 2.116 Test Acc: 0.456
Validation loss decreased (-0.433312 --> -0.455534).  Saving model ...
Epoch: 21 cost time: 1.286085844039917
Epoch: 21, Steps: 12 | Train Loss: 1.921 Vali Loss: 2.062 Vali Acc: 0.472 Test Loss: 2.062 Test Acc: 0.472
Validation loss decreased (-0.455534 --> -0.472202).  Saving model ...
Epoch: 22 cost time: 1.1448283195495605
Epoch: 22, Steps: 12 | Train Loss: 1.875 Vali Loss: 2.016 Vali Acc: 0.500 Test Loss: 2.016 Test Acc: 0.500
Validation loss decreased (-0.472202 --> -0.499980).  Saving model ...
Epoch: 23 cost time: 1.170447826385498
Epoch: 23, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.973 Vali Acc: 0.500 Test Loss: 1.973 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499980).  Saving model ...
Epoch: 24 cost time: 1.1274309158325195
Epoch: 24, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.935 Vali Acc: 0.500 Test Loss: 1.935 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499981).  Saving model ...
Epoch: 25 cost time: 1.2087574005126953
Epoch: 25, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.890 Vali Acc: 0.489 Test Loss: 1.890 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3633441925048828
Epoch: 26, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.855 Vali Acc: 0.539 Test Loss: 1.855 Test Acc: 0.539
Validation loss decreased (-0.499981 --> -0.538870).  Saving model ...
Epoch: 27 cost time: 1.2296316623687744
Epoch: 27, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.818 Vali Acc: 0.539 Test Loss: 1.818 Test Acc: 0.539
Validation loss decreased (-0.538870 --> -0.538871).  Saving model ...
Epoch: 28 cost time: 1.019428014755249
Epoch: 28, Steps: 12 | Train Loss: 1.606 Vali Loss: 1.784 Vali Acc: 0.533 Test Loss: 1.784 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9030649662017822
Epoch: 29, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.761 Vali Acc: 0.533 Test Loss: 1.761 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0852348804473877
Epoch: 30, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.733 Vali Acc: 0.550 Test Loss: 1.733 Test Acc: 0.550
Validation loss decreased (-0.538871 --> -0.549983).  Saving model ...
Epoch: 31 cost time: 1.014674186706543
Epoch: 31, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.690 Vali Acc: 0.567 Test Loss: 1.690 Test Acc: 0.567
Validation loss decreased (-0.549983 --> -0.566650).  Saving model ...
Epoch: 32 cost time: 0.9963529109954834
Epoch: 32, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.666 Vali Acc: 0.561 Test Loss: 1.666 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.037642478942871
Epoch: 33, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.647 Vali Acc: 0.556 Test Loss: 1.647 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.079014539718628
Epoch: 34, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.621 Vali Acc: 0.556 Test Loss: 1.621 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1191890239715576
Epoch: 35, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.604 Vali Acc: 0.567 Test Loss: 1.604 Test Acc: 0.567
Validation loss decreased (-0.566650 --> -0.566651).  Saving model ...
Epoch: 36 cost time: 1.2678678035736084
Epoch: 36, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.580 Vali Acc: 0.594 Test Loss: 1.580 Test Acc: 0.594
Validation loss decreased (-0.566651 --> -0.594429).  Saving model ...
Epoch: 37 cost time: 1.2916820049285889
Epoch: 37, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.549 Vali Acc: 0.594 Test Loss: 1.549 Test Acc: 0.594
Validation loss decreased (-0.594429 --> -0.594429).  Saving model ...
Epoch: 38 cost time: 1.119133472442627
Epoch: 38, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.528 Vali Acc: 0.594 Test Loss: 1.528 Test Acc: 0.594
Validation loss decreased (-0.594429 --> -0.594429).  Saving model ...
Epoch: 39 cost time: 1.0704810619354248
Epoch: 39, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.515 Vali Acc: 0.583 Test Loss: 1.515 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0597560405731201
Epoch: 40, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.498 Vali Acc: 0.594 Test Loss: 1.498 Test Acc: 0.594
Validation loss decreased (-0.594429 --> -0.594429).  Saving model ...
Epoch: 41 cost time: 1.034686803817749
Epoch: 41, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.475 Vali Acc: 0.617 Test Loss: 1.475 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616652).  Saving model ...
Epoch: 42 cost time: 1.093531608581543
Epoch: 42, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.467 Vali Acc: 0.628 Test Loss: 1.467 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627763).  Saving model ...
Epoch: 43 cost time: 1.403442621231079
Epoch: 43, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.453 Vali Acc: 0.633 Test Loss: 1.453 Test Acc: 0.633
Validation loss decreased (-0.627763 --> -0.633319).  Saving model ...
Epoch: 44 cost time: 1.269195795059204
Epoch: 44, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.434 Vali Acc: 0.617 Test Loss: 1.434 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2889878749847412
Epoch: 45, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.418 Vali Acc: 0.611 Test Loss: 1.418 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4487385749816895
Epoch: 46, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.408 Vali Acc: 0.628 Test Loss: 1.408 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3714702129364014
Epoch: 47, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.390 Vali Acc: 0.611 Test Loss: 1.390 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.102224588394165
Epoch: 48, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.383 Vali Acc: 0.617 Test Loss: 1.383 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0052149295806885
Epoch: 49, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.378 Vali Acc: 0.622 Test Loss: 1.378 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.083921194076538
Epoch: 50, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.373 Vali Acc: 0.628 Test Loss: 1.373 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0392324924468994
Epoch: 51, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.362 Vali Acc: 0.639 Test Loss: 1.362 Test Acc: 0.639
Validation loss decreased (-0.633319 --> -0.638875).  Saving model ...
Epoch: 52 cost time: 1.0378618240356445
Epoch: 52, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.356 Vali Acc: 0.628 Test Loss: 1.356 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.135350227355957
Epoch: 53, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.352 Vali Acc: 0.628 Test Loss: 1.352 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.1781792640686035
Epoch: 54, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.337 Vali Acc: 0.628 Test Loss: 1.337 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.5140130519866943
Epoch: 55, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.321 Vali Acc: 0.633 Test Loss: 1.321 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.6811115741729736
Epoch: 56, Steps: 12 | Train Loss: 0.954 Vali Loss: 1.309 Vali Acc: 0.650 Test Loss: 1.309 Test Acc: 0.650
Validation loss decreased (-0.638875 --> -0.649987).  Saving model ...
Epoch: 57 cost time: 1.2140474319458008
Epoch: 57, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.307 Vali Acc: 0.628 Test Loss: 1.307 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.034130334854126
Epoch: 58, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.295 Vali Acc: 0.656 Test Loss: 1.295 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655543).  Saving model ...
Epoch: 59 cost time: 1.0358469486236572
Epoch: 59, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.287 Vali Acc: 0.650 Test Loss: 1.287 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2985174655914307
Epoch: 60, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.280 Vali Acc: 0.661 Test Loss: 1.280 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661098).  Saving model ...
Epoch: 61 cost time: 1.1348817348480225
Epoch: 61, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.266 Vali Acc: 0.667 Test Loss: 1.266 Test Acc: 0.667
Validation loss decreased (-0.661098 --> -0.666654).  Saving model ...
Epoch: 62 cost time: 1.1168451309204102
Epoch: 62, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.262 Vali Acc: 0.667 Test Loss: 1.262 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 63 cost time: 1.2806892395019531
Epoch: 63, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.257 Vali Acc: 0.667 Test Loss: 1.257 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666654).  Saving model ...
Epoch: 64 cost time: 1.275606393814087
Epoch: 64, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.260 Vali Acc: 0.661 Test Loss: 1.260 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1775014400482178
Epoch: 65, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.253 Vali Acc: 0.678 Test Loss: 1.253 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677765).  Saving model ...
Epoch: 66 cost time: 1.3046905994415283
Epoch: 66, Steps: 12 | Train Loss: 0.830 Vali Loss: 1.251 Vali Acc: 0.683 Test Loss: 1.251 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683321).  Saving model ...
Epoch: 67 cost time: 1.2805144786834717
Epoch: 67, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.244 Vali Acc: 0.689 Test Loss: 1.244 Test Acc: 0.689
Validation loss decreased (-0.683321 --> -0.688876).  Saving model ...
Epoch: 68 cost time: 1.1983325481414795
Epoch: 68, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.228 Vali Acc: 0.683 Test Loss: 1.228 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9955589771270752
Epoch: 69, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.230 Vali Acc: 0.683 Test Loss: 1.230 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.0870943069458008
Epoch: 70, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.229 Vali Acc: 0.683 Test Loss: 1.229 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.0785038471221924
Epoch: 71, Steps: 12 | Train Loss: 0.786 Vali Loss: 1.229 Vali Acc: 0.672 Test Loss: 1.229 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9861047267913818
Epoch: 72, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.220 Vali Acc: 0.672 Test Loss: 1.220 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.211256504058838
Epoch: 73, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.223 Vali Acc: 0.667 Test Loss: 1.223 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.1146738529205322
Epoch: 74, Steps: 12 | Train Loss: 0.778 Vali Loss: 1.210 Vali Acc: 0.683 Test Loss: 1.210 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.1671631336212158
Epoch: 75, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.211 Vali Acc: 0.683 Test Loss: 1.211 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.077120304107666
Epoch: 76, Steps: 12 | Train Loss: 0.773 Vali Loss: 1.206 Vali Acc: 0.683 Test Loss: 1.206 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.2190179824829102
Epoch: 77, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.197 Vali Acc: 0.689 Test Loss: 1.197 Test Acc: 0.689
Validation loss decreased (-0.688876 --> -0.688877).  Saving model ...
Epoch: 78 cost time: 0.9572539329528809
Epoch: 78, Steps: 12 | Train Loss: 0.709 Vali Loss: 1.192 Vali Acc: 0.683 Test Loss: 1.192 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9569706916809082
Epoch: 79, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.188 Vali Acc: 0.689 Test Loss: 1.188 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 80 cost time: 1.0958137512207031
Epoch: 80, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.180 Vali Acc: 0.689 Test Loss: 1.180 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 81 cost time: 1.1589365005493164
Epoch: 81, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.178 Vali Acc: 0.683 Test Loss: 1.178 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.396394968032837
Epoch: 82, Steps: 12 | Train Loss: 0.734 Vali Loss: 1.174 Vali Acc: 0.689 Test Loss: 1.174 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 83 cost time: 1.1202912330627441
Epoch: 83, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.164 Vali Acc: 0.689 Test Loss: 1.164 Test Acc: 0.689
Validation loss decreased (-0.688877 --> -0.688877).  Saving model ...
Epoch: 84 cost time: 1.181748390197754
Epoch: 84, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.168 Vali Acc: 0.689 Test Loss: 1.168 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.205461025238037
Epoch: 85, Steps: 12 | Train Loss: 0.725 Vali Loss: 1.160 Vali Acc: 0.683 Test Loss: 1.160 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.1828067302703857
Epoch: 86, Steps: 12 | Train Loss: 0.640 Vali Loss: 1.161 Vali Acc: 0.683 Test Loss: 1.161 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.062272071838379
Epoch: 87, Steps: 12 | Train Loss: 0.648 Vali Loss: 1.154 Vali Acc: 0.694 Test Loss: 1.154 Test Acc: 0.694
Validation loss decreased (-0.688877 --> -0.694433).  Saving model ...
Epoch: 88 cost time: 1.2427947521209717
Epoch: 88, Steps: 12 | Train Loss: 0.628 Vali Loss: 1.152 Vali Acc: 0.689 Test Loss: 1.152 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.9876935482025146
Epoch: 89, Steps: 12 | Train Loss: 0.693 Vali Loss: 1.156 Vali Acc: 0.683 Test Loss: 1.156 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.0046658515930176
Epoch: 90, Steps: 12 | Train Loss: 0.642 Vali Loss: 1.150 Vali Acc: 0.694 Test Loss: 1.150 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694433).  Saving model ...
Epoch: 91 cost time: 0.983344554901123
Epoch: 91, Steps: 12 | Train Loss: 0.620 Vali Loss: 1.145 Vali Acc: 0.683 Test Loss: 1.145 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.1476762294769287
Epoch: 92, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.144 Vali Acc: 0.689 Test Loss: 1.144 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.0345804691314697
Epoch: 93, Steps: 12 | Train Loss: 0.614 Vali Loss: 1.154 Vali Acc: 0.678 Test Loss: 1.154 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.0692954063415527
Epoch: 94, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.144 Vali Acc: 0.683 Test Loss: 1.144 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.2144112586975098
Epoch: 95, Steps: 12 | Train Loss: 0.604 Vali Loss: 1.147 Vali Acc: 0.683 Test Loss: 1.147 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 1.2698264122009277
Epoch: 96, Steps: 12 | Train Loss: 0.595 Vali Loss: 1.148 Vali Acc: 0.672 Test Loss: 1.148 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 1.1396245956420898
Epoch: 97, Steps: 12 | Train Loss: 0.610 Vali Loss: 1.149 Vali Acc: 0.683 Test Loss: 1.149 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 1.092487096786499
Epoch: 98, Steps: 12 | Train Loss: 0.603 Vali Loss: 1.151 Vali Acc: 0.683 Test Loss: 1.151 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 1.1725633144378662
Epoch: 99, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.141 Vali Acc: 0.683 Test Loss: 1.141 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 1.2803046703338623
Epoch: 100, Steps: 12 | Train Loss: 0.565 Vali Loss: 1.148 Vali Acc: 0.689 Test Loss: 1.148 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_DLinear_UEA_ftM_sl45_ll0_pl0_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6944444444444444
model parameter : 5505
model size : 0.02MB
